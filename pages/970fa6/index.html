<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java 缓存中间件 | JAVA-TUTORIAL</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/java-tutorial/img/favicon.ico">
    <meta name="description" content="☕ java-tutorial 是一个 Java 教程，汇集一个老司机在 Java 领域的十年积累。">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/java-tutorial/assets/css/0.styles.9b18bf92.css" as="style"><link rel="preload" href="/java-tutorial/assets/js/app.1905b9e7.js" as="script"><link rel="preload" href="/java-tutorial/assets/js/2.fd3e179e.js" as="script"><link rel="preload" href="/java-tutorial/assets/js/75.a7709b48.js" as="script"><link rel="prefetch" href="/java-tutorial/assets/js/10.4f444ad9.js"><link rel="prefetch" href="/java-tutorial/assets/js/11.bcba717a.js"><link rel="prefetch" href="/java-tutorial/assets/js/12.8fe18c68.js"><link rel="prefetch" href="/java-tutorial/assets/js/13.ac6b35ed.js"><link rel="prefetch" href="/java-tutorial/assets/js/14.d9be7dd1.js"><link rel="prefetch" href="/java-tutorial/assets/js/15.658a6d64.js"><link rel="prefetch" href="/java-tutorial/assets/js/16.0eacd8a6.js"><link rel="prefetch" href="/java-tutorial/assets/js/17.456002b9.js"><link rel="prefetch" href="/java-tutorial/assets/js/18.355372f4.js"><link rel="prefetch" href="/java-tutorial/assets/js/19.ec6f4848.js"><link rel="prefetch" href="/java-tutorial/assets/js/20.f4728706.js"><link rel="prefetch" href="/java-tutorial/assets/js/21.07934a6e.js"><link rel="prefetch" href="/java-tutorial/assets/js/22.04bea09d.js"><link rel="prefetch" href="/java-tutorial/assets/js/23.bded5cf6.js"><link rel="prefetch" href="/java-tutorial/assets/js/24.36e55145.js"><link rel="prefetch" href="/java-tutorial/assets/js/25.af635b06.js"><link rel="prefetch" href="/java-tutorial/assets/js/26.3eb5129e.js"><link rel="prefetch" href="/java-tutorial/assets/js/27.76ca98fe.js"><link rel="prefetch" href="/java-tutorial/assets/js/28.8ccbcac6.js"><link rel="prefetch" href="/java-tutorial/assets/js/29.ef9e7225.js"><link rel="prefetch" href="/java-tutorial/assets/js/3.13829456.js"><link rel="prefetch" href="/java-tutorial/assets/js/30.d9cc6dc8.js"><link rel="prefetch" href="/java-tutorial/assets/js/31.a4970b6b.js"><link rel="prefetch" href="/java-tutorial/assets/js/32.c1e5ef11.js"><link rel="prefetch" href="/java-tutorial/assets/js/33.dc8ab04b.js"><link rel="prefetch" href="/java-tutorial/assets/js/34.27064eb2.js"><link rel="prefetch" href="/java-tutorial/assets/js/35.e2658c44.js"><link rel="prefetch" href="/java-tutorial/assets/js/36.5dfe8359.js"><link rel="prefetch" href="/java-tutorial/assets/js/37.9bed175b.js"><link rel="prefetch" href="/java-tutorial/assets/js/38.442a0821.js"><link rel="prefetch" href="/java-tutorial/assets/js/39.ee700231.js"><link rel="prefetch" href="/java-tutorial/assets/js/4.6d986bfe.js"><link rel="prefetch" href="/java-tutorial/assets/js/40.c70d0291.js"><link rel="prefetch" href="/java-tutorial/assets/js/41.c2c82a49.js"><link rel="prefetch" href="/java-tutorial/assets/js/42.d1251607.js"><link rel="prefetch" href="/java-tutorial/assets/js/43.521ef6e4.js"><link rel="prefetch" href="/java-tutorial/assets/js/44.66b2dcf2.js"><link rel="prefetch" href="/java-tutorial/assets/js/45.c588e7c8.js"><link rel="prefetch" href="/java-tutorial/assets/js/46.a2092b84.js"><link rel="prefetch" href="/java-tutorial/assets/js/47.e1a8c216.js"><link rel="prefetch" href="/java-tutorial/assets/js/48.aeba6e1f.js"><link rel="prefetch" href="/java-tutorial/assets/js/49.3978dfc3.js"><link rel="prefetch" href="/java-tutorial/assets/js/5.dfc39999.js"><link rel="prefetch" href="/java-tutorial/assets/js/50.6d98df1d.js"><link rel="prefetch" href="/java-tutorial/assets/js/51.2bfd5e00.js"><link rel="prefetch" href="/java-tutorial/assets/js/52.62d88abb.js"><link rel="prefetch" href="/java-tutorial/assets/js/53.155f15a2.js"><link rel="prefetch" href="/java-tutorial/assets/js/54.266cf2d7.js"><link rel="prefetch" href="/java-tutorial/assets/js/55.d1ed211f.js"><link rel="prefetch" href="/java-tutorial/assets/js/56.cd84ef92.js"><link rel="prefetch" href="/java-tutorial/assets/js/57.e4428de4.js"><link rel="prefetch" href="/java-tutorial/assets/js/58.54f14446.js"><link rel="prefetch" href="/java-tutorial/assets/js/59.b528093b.js"><link rel="prefetch" href="/java-tutorial/assets/js/6.39027bda.js"><link rel="prefetch" href="/java-tutorial/assets/js/60.0b2f58d0.js"><link rel="prefetch" href="/java-tutorial/assets/js/61.7ec5c991.js"><link rel="prefetch" href="/java-tutorial/assets/js/62.2241309a.js"><link rel="prefetch" href="/java-tutorial/assets/js/63.ac4e1e0a.js"><link rel="prefetch" href="/java-tutorial/assets/js/64.d106193a.js"><link rel="prefetch" href="/java-tutorial/assets/js/65.b6c04d51.js"><link rel="prefetch" href="/java-tutorial/assets/js/66.36025271.js"><link rel="prefetch" href="/java-tutorial/assets/js/67.c231dad8.js"><link rel="prefetch" href="/java-tutorial/assets/js/68.b1d2c18d.js"><link rel="prefetch" href="/java-tutorial/assets/js/69.c541140a.js"><link rel="prefetch" href="/java-tutorial/assets/js/7.3fbeea1c.js"><link rel="prefetch" href="/java-tutorial/assets/js/70.50e92823.js"><link rel="prefetch" href="/java-tutorial/assets/js/71.cfe6e344.js"><link rel="prefetch" href="/java-tutorial/assets/js/72.82532df7.js"><link rel="prefetch" href="/java-tutorial/assets/js/73.987e4182.js"><link rel="prefetch" href="/java-tutorial/assets/js/74.06ab1615.js"><link rel="prefetch" href="/java-tutorial/assets/js/76.d2a08353.js"><link rel="prefetch" href="/java-tutorial/assets/js/77.0141ff0a.js"><link rel="prefetch" href="/java-tutorial/assets/js/78.8d33fcf7.js"><link rel="prefetch" href="/java-tutorial/assets/js/79.132f7978.js"><link rel="prefetch" href="/java-tutorial/assets/js/8.49ad1637.js"><link rel="prefetch" href="/java-tutorial/assets/js/80.be1fa7c9.js"><link rel="prefetch" href="/java-tutorial/assets/js/81.5f384a58.js"><link rel="prefetch" href="/java-tutorial/assets/js/82.ac3a3a26.js"><link rel="prefetch" href="/java-tutorial/assets/js/83.4af5435b.js"><link rel="prefetch" href="/java-tutorial/assets/js/84.bcb557f7.js"><link rel="prefetch" href="/java-tutorial/assets/js/85.501d4ca7.js"><link rel="prefetch" href="/java-tutorial/assets/js/86.facca23f.js"><link rel="prefetch" href="/java-tutorial/assets/js/9.e7534b6c.js">
    <link rel="stylesheet" href="/java-tutorial/assets/css/0.styles.9b18bf92.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/java-tutorial/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo.png" alt="JAVA-TUTORIAL" class="logo"> <span class="site-name can-hide">JAVA-TUTORIAL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaEE" class="dropdown-title"><!----> <span class="title" style="display:;">JavaEE</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java-tutorial/02.JavaEE/01.JavaWeb/" class="nav-link">JavaWeb</a></li><li class="dropdown-item"><!----> <a href="/java-tutorial/02.JavaEE/02.服务器/" class="nav-link">服务器</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java软件" class="dropdown-title"><a href="/java-tutorial/11.软件/" class="link-title">Java软件</a> <span class="title" style="display:none;">Java软件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java-tutorial/11.软件/01.构建/" class="nav-link">Java构建</a></li><li class="dropdown-item"><!----> <a href="/java-tutorial/11.软件/02.IDE/" class="nav-link">Java IDE</a></li><li class="dropdown-item"><!----> <a href="/java-tutorial/11.软件/03.监控诊断/" class="nav-link">Java监控诊断</a></li></ul></div></div><div class="nav-item"><a href="/java-tutorial/12.工具/" class="nav-link">Java工具</a></div><div class="nav-item"><a href="/java-tutorial/13.框架/" class="nav-link">Java框架</a></div><div class="nav-item"><a href="/java-tutorial/14.中间件/" class="nav-link">Java中间件</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">✨ Java系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/dunwu/java-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaEE" class="dropdown-title"><!----> <span class="title" style="display:;">JavaEE</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java-tutorial/02.JavaEE/01.JavaWeb/" class="nav-link">JavaWeb</a></li><li class="dropdown-item"><!----> <a href="/java-tutorial/02.JavaEE/02.服务器/" class="nav-link">服务器</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java软件" class="dropdown-title"><a href="/java-tutorial/11.软件/" class="link-title">Java软件</a> <span class="title" style="display:none;">Java软件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java-tutorial/11.软件/01.构建/" class="nav-link">Java构建</a></li><li class="dropdown-item"><!----> <a href="/java-tutorial/11.软件/02.IDE/" class="nav-link">Java IDE</a></li><li class="dropdown-item"><!----> <a href="/java-tutorial/11.软件/03.监控诊断/" class="nav-link">Java监控诊断</a></li></ul></div></div><div class="nav-item"><a href="/java-tutorial/12.工具/" class="nav-link">Java工具</a></div><div class="nav-item"><a href="/java-tutorial/13.框架/" class="nav-link">Java框架</a></div><div class="nav-item"><a href="/java-tutorial/14.中间件/" class="nav-link">Java中间件</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">✨ Java系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/dunwu/java-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MQ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-tutorial/pages/5a6cf3/" class="sidebar-link">消息队列面试</a></li><li><a href="/java-tutorial/pages/055069/" class="sidebar-link">消息队列基本原理</a></li><li><a href="/java-tutorial/pages/f56a96/" class="sidebar-link">RocketMQ 快速入门</a></li><li><a href="/java-tutorial/pages/3f7c49/" class="sidebar-link">ActiveMQ 快速入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>缓存</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-tutorial/pages/eb30d6/" class="sidebar-link">缓存夺命连环问</a></li><li><a href="/java-tutorial/pages/970fa6/" aria-current="page" class="active sidebar-link">Java 缓存中间件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#一-、jsr-107" class="sidebar-link">一 、JSR 107</a></li><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#二、spring-cache" class="sidebar-link">二、Spring Cache</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-tutorial/pages/970fa6/#开启缓存注解" class="sidebar-link">开启缓存注解</a></li><li class="sidebar-sub-header level3"><a href="/java-tutorial/pages/970fa6/#spring-缓存注解-api" class="sidebar-link">spring 缓存注解 API</a></li><li class="sidebar-sub-header level4"><a href="/java-tutorial/pages/970fa6/#cacheable" class="sidebar-link">@Cacheable</a></li><li class="sidebar-sub-header level4"><a href="/java-tutorial/pages/970fa6/#cacheput" class="sidebar-link">@CachePut</a></li><li class="sidebar-sub-header level4"><a href="/java-tutorial/pages/970fa6/#cacheevict" class="sidebar-link">@CacheEvict</a></li><li class="sidebar-sub-header level4"><a href="/java-tutorial/pages/970fa6/#caching" class="sidebar-link">@Caching</a></li><li class="sidebar-sub-header level4"><a href="/java-tutorial/pages/970fa6/#cacheconfig" class="sidebar-link">@CacheConfig</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#三、spring-boot-cache" class="sidebar-link">三、Spring Boot Cache</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-tutorial/pages/970fa6/#spring-boot-cache-快速入门" class="sidebar-link">Spring Boot Cache 快速入门</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#四、jetcache" class="sidebar-link">四、JetCache</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/java-tutorial/pages/970fa6/#jetcache-快速入门" class="sidebar-link">jetcache 快速入门</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#五、j2cache" class="sidebar-link">五、j2cache</a></li><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#六、总结" class="sidebar-link">六、总结</a></li><li class="sidebar-sub-header level2"><a href="/java-tutorial/pages/970fa6/#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/java-tutorial/pages/25a710/" class="sidebar-link">Memcached 快速入门</a></li><li><a href="/java-tutorial/pages/c4647d/" class="sidebar-link">Ehcache 快速入门</a></li><li><a href="/java-tutorial/pages/9632fd/" class="sidebar-link">Java 进程内缓存</a></li><li><a href="/java-tutorial/pages/c09100/" class="sidebar-link">http-cache</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>流量控制</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java-tutorial/pages/f2ebed/" class="sidebar-link">Hystrix 快速入门</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/java-tutorial/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/java-tutorial/categories/?category=%E4%B8%AD%E9%97%B4%E4%BB%B6" title="分类" data-v-06225672>中间件</a></li><li data-v-06225672><a href="/java-tutorial/categories/?category=%E7%BC%93%E5%AD%98" title="分类" data-v-06225672>缓存</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/dunwu" target="_blank" title="作者" class="beLink" data-v-06225672>dunwu</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-02-17</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Java 缓存中间件<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="java-缓存中间件"><a href="#java-缓存中间件" class="header-anchor">#</a> Java 缓存中间件</h1> <blockquote><p>关键词：Spring Cache、J2Cache、JetCache</p></blockquote> <h2 id="一-、jsr-107"><a href="#一-、jsr-107" class="header-anchor">#</a> 一 、JSR 107</h2> <p><a href="https://www.jcp.org/en/jsr/detail?id=107" target="_blank" rel="noopener noreferrer">JSR107<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中制订了 Java 缓存的规范。</p> <p>因此，在很多缓存框架、缓存库中，其 API 都参考了 JSR 107 规范。</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200709174139.png" alt="img"></p> <p>Java Caching 定义了 5 个核心接口</p> <ul><li><strong>CachingProvider</strong> - 定义了创建、配置、获取、管理和控制多个 <code>CacheManager</code>。一个应用可以在运行期访问多个 <code>CachingProvider</code>。</li> <li><strong>CacheManager</strong> - 定义了创建、配置、获取、管理和控制多个唯一命名的 Cache，这些 Cache 存在于 CacheManager 的上下文中。一个 CacheManager 仅被一个 CachingProvider 所拥有。</li> <li><strong>Cache</strong> - 是一个类似 Map 的数据结构并临时存储以 Key 为索引的值。一个 Cache 仅被一个 CacheManager 所拥有。</li> <li><strong>Entry</strong> - 是一个存储在 Cache 中的 key-value 对。</li> <li><strong>Expiry</strong> - 每一个存储在 Cache 中的条目有一个定义的有效期，即 Expiry Duration。一旦超过这个时间，条目为过期的状态。一旦过期，条目将不可访问、更新和删除。缓存有效期可以通过 ExpiryPolicy 设置。</li></ul> <h2 id="二、spring-cache"><a href="#二、spring-cache" class="header-anchor">#</a> 二、Spring Cache</h2> <blockquote><p>详见：<a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html#cache" target="_blank" rel="noopener noreferrer">Spring Cache 官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>Spring 作为 Java 开发最著名的框架，也提供了缓存功能的框架—— Spring Cache。</p> <p>Spring 支持基于注释（annotation）的缓存（cache）技术，它本质上不是一个具体的缓存实现方案（例如：EHCache 或 OSCache），而是一个对缓存使用的抽象，通过在既有代码中添加少量它定义的各种 annotation，即能够达到缓存方法的返回对象的效果。</p> <p>Spring Cache 的特点：</p> <ul><li>通过缓存注解即可支持缓存功能</li> <li>支持 Spring EL 表达式</li> <li>支持 AspectJ</li> <li>支持自定义 key 和缓存管理</li></ul> <h3 id="开启缓存注解"><a href="#开启缓存注解" class="header-anchor">#</a> 开启缓存注解</h3> <p>Spring 为缓存功能提供了注解功能，但是你必须启动注解。</p> <p>有两种方式：</p> <p>（一）使用标记注解 <code>@EnableCaching</code></p> <p>这种方式对于 Spring 或 Spring Boot 项目都适用。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableCaching</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（二）在 xml 中声明</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">cache:</span>annotation-driven</span> <span class="token attr-name">cache-manager</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cacheManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="spring-缓存注解-api"><a href="#spring-缓存注解-api" class="header-anchor">#</a> spring 缓存注解 API</h3> <p>Spring 对缓存的支持类似于对事务的支持。</p> <p>首先使用注解标记方法，相当于定义了切点，然后使用 Aop 技术在这个方法的调用前、调用后获取方法的入参和返回值，进而实现了缓存的逻辑。</p> <h4 id="cacheable"><a href="#cacheable" class="header-anchor">#</a> @Cacheable</h4> <p><strong><code>@Cacheable</code> 用于触发缓存</strong>。</p> <p>表明所修饰的方法是可以缓存的：当第一次调用这个方法时，它的结果会被缓存下来，在缓存的有效时间内，以后访问这个方法都直接返回缓存结果，不再执行方法中的代码段。</p> <p>这个注解可以用<code>condition</code>属性来设置条件，如果不满足条件，就不使用缓存能力，直接执行方法。</p> <p>可以使用<code>key</code>属性来指定 key 的生成规则。</p> <h4 id="cacheput"><a href="#cacheput" class="header-anchor">#</a> @CachePut</h4> <p><strong><code>@CachePut</code> 用于更新缓存</strong>。</p> <p>与<code>@Cacheable</code>不同，<code>@CachePut</code>不仅会缓存方法的结果，还会执行方法的代码段。</p> <p>它支持的属性和用法都与<code>@Cacheable</code>一致。</p> <h4 id="cacheevict"><a href="#cacheevict" class="header-anchor">#</a> @CacheEvict</h4> <p><strong><code>@CacheEvict</code> 用于清除缓存</strong>。</p> <p>与<code>@Cacheable</code>功能相反，<code>@CacheEvict</code>表明所修饰的方法是用来删除失效或无用的缓存数据。</p> <p>下面是<code>@Cacheable</code>、<code>@CacheEvict</code>和<code>@CachePut</code>基本使用方法的一个集中展示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token comment">// @Cacheable可以设置多个缓存，形式如：@Cacheable({&quot;books&quot;, &quot;isbns&quot;})</span>
    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token string">&quot;#user.id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">findUserInDB</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> condition <span class="token operator">=</span> <span class="token string">&quot;#user.getId() &lt;= 2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findUserInLimit</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">findUserInDB</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">&quot;#user.getId()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">updateUserInDB</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">removeUserInDB</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> allEntries <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">removeAllInDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="caching"><a href="#caching" class="header-anchor">#</a> @Caching</h4> <p><strong><code>@Caching</code> 用于组合定义多种缓存功能</strong>。</p> <p>如果需要使用同一个缓存注解（<code>@Cacheable</code>、<code>@CacheEvict</code>或<code>@CachePut</code>）多次修饰一个方法，就需要用到<code>@Caching</code>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Caching</span><span class="token punctuation">(</span>evict <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span><span class="token string">&quot;primary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>cacheNames<span class="token operator">=</span><span class="token string">&quot;secondary&quot;</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token string">&quot;#p0&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Book</span> <span class="token function">importBooks</span><span class="token punctuation">(</span><span class="token class-name">String</span> deposit<span class="token punctuation">,</span> <span class="token class-name">Date</span> date<span class="token punctuation">)</span>
</code></pre></div><h4 id="cacheconfig"><a href="#cacheconfig" class="header-anchor">#</a> @CacheConfig</h4> <p><strong><code>@CacheConfig</code> 用于定义公共缓存配置</strong>。</p> <p>与前面的缓存注解不同，这是一个类级别的注解。</p> <p>如果类的所有操作都是缓存操作，你可以使用<code>@CacheConfig</code>来指定类，省去一些配置。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@CacheConfig</span><span class="token punctuation">(</span><span class="token string">&quot;books&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookRepositoryImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BookRepository</span> <span class="token punctuation">{</span>
 <span class="token annotation punctuation">@Cacheable</span>
 <span class="token keyword">public</span> <span class="token class-name">Book</span> <span class="token function">findBook</span><span class="token punctuation">(</span><span class="token class-name">ISBN</span> isbn<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="三、spring-boot-cache"><a href="#三、spring-boot-cache" class="header-anchor">#</a> 三、Spring Boot Cache</h2> <blockquote><p>详见：<a href="https://docs.spring.io/spring-boot/docs/2.3.1.RELEASE/reference/html/spring-boot-features.html#boot-features-caching" target="_blank" rel="noopener noreferrer">Spring Boot Cache 特性官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>Spring Boot Cache 是在 Spring Cache 的基础上做了封装，使得使用更为便捷。</p> <h3 id="spring-boot-cache-快速入门"><a href="#spring-boot-cache-快速入门" class="header-anchor">#</a> Spring Boot Cache 快速入门</h3> <p>（1）引入依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-cache<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 按序引入需要的缓存库 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>（2）缓存配置</p> <p>例如，选用缓存为 redis，则需要配置 redis 相关的配置项（如：数据源、连接池等配置信息）</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment"># 缓存类型，支持类型：GENERIC、JCACHE、EHCACHE、HAZELCAST、INFINISPAN、COUCHBASE、REDIS、CAFFEINE、SIMPLE</span>
<span class="token key attr-name">spring.cache.type</span> <span class="token punctuation">=</span> <span class="token value attr-value">redis</span>
<span class="token comment"># 全局缓存时间</span>
<span class="token key attr-name">spring.cache.redis.time-to-live</span> <span class="token punctuation">=</span> <span class="token value attr-value">60s</span>

<span class="token comment"># Redis 配置</span>
<span class="token key attr-name">spring.redis.database</span> <span class="token punctuation">=</span> <span class="token value attr-value">0</span>
<span class="token key attr-name">spring.redis.host</span> <span class="token punctuation">=</span> <span class="token value attr-value">localhost</span>
<span class="token key attr-name">spring.redis.port</span> <span class="token punctuation">=</span> <span class="token value attr-value">6379</span>
<span class="token key attr-name">spring.redis.password</span> <span class="token value attr-value">=</span>
</code></pre></div><p>（3）使用 <code>@EnableCaching</code> 开启缓存</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EnableCaching</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（4）缓存注解（<code>@Cacheable</code>、<code>@CachePut</code>、<code>@CacheEvit</code> 等）使用方式与 Spring Cache 完全一样</p> <h2 id="四、jetcache"><a href="#四、jetcache" class="header-anchor">#</a> 四、JetCache</h2> <blockquote><p>JetCache 是一个基于 Java 的缓存系统封装，提供统一的 API 和注解来简化缓存的使用。 JetCache 提供了比 SpringCache 更加强大的注解，可以原生的支持 TTL、两级缓存、分布式自动刷新，还提供了<code>Cache</code>接口用于手工缓存操作。 当前有四个实现，<code>RedisCache</code>、<code>TairCache</code>（此部分未在 github 开源）、<code>CaffeineCache</code>(in memory)和一个简易的<code>LinkedHashMapCache</code>(in memory)，要添加新的实现也是非常简单的。</p> <p>详见：<a href="https://github.com/alibaba/jetcache" target="_blank" rel="noopener noreferrer">jetcache Github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="jetcache-快速入门"><a href="#jetcache-快速入门" class="header-anchor">#</a> jetcache 快速入门</h3> <p>如果使用 Spring Boot，可以按如下的方式配置（这里使用了 jedis 客户端连接 redis，如果需要集群、读写分离、异步等特性支持请使用<a href="https://github.com/alibaba/jetcache/wiki/RedisWithLettuce_CN" target="_blank" rel="noopener noreferrer">lettuce<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>客户端）。</p> <p>（1）引入 POM</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alicp.jetcache<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jetcache-starter-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.14<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>（2）配置</p> <p>配置一个 spring boot 风格的 application.yml 文件，把他放到资源目录中</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">jetcache</span><span class="token punctuation">:</span>
  <span class="token key atrule">statIntervalMinutes</span><span class="token punctuation">:</span> <span class="token number">15</span>
  <span class="token key atrule">areaInCacheName</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">local</span><span class="token punctuation">:</span>
    <span class="token key atrule">default</span><span class="token punctuation">:</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> linkedhashmap
      <span class="token key atrule">keyConvertor</span><span class="token punctuation">:</span> fastjson
  <span class="token key atrule">remote</span><span class="token punctuation">:</span>
    <span class="token key atrule">default</span><span class="token punctuation">:</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> redis
      <span class="token key atrule">keyConvertor</span><span class="token punctuation">:</span> fastjson
      <span class="token key atrule">valueEncoder</span><span class="token punctuation">:</span> java
      <span class="token key atrule">valueDecoder</span><span class="token punctuation">:</span> java
      <span class="token key atrule">poolConfig</span><span class="token punctuation">:</span>
        <span class="token key atrule">minIdle</span><span class="token punctuation">:</span> <span class="token number">5</span>
        <span class="token key atrule">maxIdle</span><span class="token punctuation">:</span> <span class="token number">20</span>
        <span class="token key atrule">maxTotal</span><span class="token punctuation">:</span> <span class="token number">50</span>
      <span class="token key atrule">host</span><span class="token punctuation">:</span> 127.0.0.1
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
</code></pre></div><p>（3）开启缓存</p> <p>然后创建一个 App 类放在业务包的根下，EnableMethodCache，EnableCreateCacheAnnotation 这两个注解分别激活 Cached 和 CreateCache 注解，其他和标准的 Spring Boot 程序是一样的。这个类可以直接 main 方法运行。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>company<span class="token punctuation">.</span>mypackage</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alicp<span class="token punctuation">.</span>jetcache<span class="token punctuation">.</span>anno<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">EnableCreateCacheAnnotation</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alicp<span class="token punctuation">.</span>jetcache<span class="token punctuation">.</span>anno<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">EnableMethodCache</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableMethodCache</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;com.company.mypackage&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableCreateCacheAnnotation</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySpringBootApp</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MySpringBootApp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（4）API 基本使用</p> <p>创建缓存实例</p> <p>通过 @CreateCache 注解创建一个缓存实例，默认超时时间是 100 秒</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@CreateCache</span><span class="token punctuation">(</span>expire <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Cache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">UserDO</span><span class="token punctuation">&gt;</span></span> userCache<span class="token punctuation">;</span>
</code></pre></div><p>用起来就像 map 一样</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">UserDO</span> user <span class="token operator">=</span> userCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">123L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
userCache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">123L</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
userCache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">123L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>创建一个两级（内存+远程）的缓存，内存中的元素个数限制在 50 个。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@CreateCache</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;UserService.userCache&quot;</span><span class="token punctuation">,</span> expire <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> cacheType <span class="token operator">=</span> <span class="token class-name">CacheType</span><span class="token punctuation">.</span>BOTH<span class="token punctuation">,</span> localLimit <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Cache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">UserDO</span><span class="token punctuation">&gt;</span></span> userCache<span class="token punctuation">;</span>
</code></pre></div><p>name 属性不是必须的，但是起个名字是个好习惯，展示统计数据的使用，会使用这个名字。如果同一个 area 两个 @CreateCache 的 name 配置一样，它们生成的 Cache 将指向同一个实例。</p> <p>创建方法缓存</p> <p>使用 @Cached 方法可以为一个方法添加上缓存。JetCache 通过 Spring AOP 生成代理，来支持缓存功能。注解可以加在接口方法上也可以加在类方法上，但需要保证是个 Spring bean。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Cached</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;UserService.getUserById&quot;</span><span class="token punctuation">,</span> expire <span class="token operator">=</span> <span class="token number">3600</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token keyword">long</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="五、j2cache"><a href="#五、j2cache" class="header-anchor">#</a> 五、j2cache</h2> <h2 id="六、总结"><a href="#六、总结" class="header-anchor">#</a> 六、总结</h2> <p>使用缓存框架，使得开发缓存功能非常便捷。</p> <p>如果你的系统只需要使用一种缓存，那么推荐使用 Spring Boot Cache。Spring Boot Cache 在 Spring Cache 基础上做了封装，使用更简单、方便。</p> <p>如果你的系统需要使用多级缓存，那么推荐使用 jetcache。</p> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li><a href="https://www.jcp.org/en/jsr/detail?id=107" target="_blank" rel="noopener noreferrer">JSR107<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html#cache" target="_blank" rel="noopener noreferrer">Spring Cache 官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.spring.io/spring-boot/docs/2.3.1.RELEASE/reference/html/spring-boot-features.html#boot-features-caching" target="_blank" rel="noopener noreferrer">Spring Boot Cache 特性官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://gitee.com/ld/J2Cache" target="_blank" rel="noopener noreferrer">J2Cache Gitee<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/alibaba/jetcache" target="_blank" rel="noopener noreferrer">jetcache Github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/alibaba/jetcache/wiki/Home_CN" target="_blank" rel="noopener noreferrer">jetcache wiki<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <div class="page-slot page-slot-bottom">
  <div class="wwads-cn wwads-horizontal pageB" data-id="136" style="width:100%;max-height:80px;min-height:auto;"></div>
  <style>
    .pageB img{width:80px!important;}
    .wwads-horizontal .wwads-text, .wwads-content .wwads-text{line-height:1;}
  </style>
  </div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/java-tutorial/edit/master/docs/14.中间件/02.缓存/02.Java缓存中间件.md" target="_blank" rel="noopener noreferrer">📝 帮助改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/java-tutorial/tags/?tag=Java" title="标签">#Java</a><a href="/java-tutorial/tags/?tag=%E4%B8%AD%E9%97%B4%E4%BB%B6" title="标签">#中间件</a><a href="/java-tutorial/tags/?tag=%E7%BC%93%E5%AD%98" title="标签">#缓存</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/07/08, 19:00:16</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/java-tutorial/pages/eb30d6/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">缓存夺命连环问</div></a> <a href="/java-tutorial/pages/25a710/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Memcached 快速入门</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/java-tutorial/pages/eb30d6/" class="prev">缓存夺命连环问</a></span> <span class="next"><a href="/java-tutorial/pages/25a710/">Memcached 快速入门</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/java-tutorial/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/java-tutorial/pages/3cbcff/"><div>
            Java 中间件
            <!----></div></a> <span class="date">04-09</span></dt></dl><dl><dd>02</dd> <dt><a href="/java-tutorial/pages/86288e/"><div>
            Tomcat 教程
            <!----></div></a> <span class="date">02-18</span></dt></dl><dl><dd>03</dd> <dt><a href="/java-tutorial/pages/ca58e7/"><div>
            JavaEE
            <!----></div></a> <span class="date">02-18</span></dt></dl> <dl><dd></dd> <dt><a href="/java-tutorial/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:forbreak@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/dunwu" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>钝悟（dunwu） | CC-BY-SA-4.0</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div>
    <div class="wwads-cn wwads-vertical windowRB" data-id="136" style="max-width:160px;
    min-width: auto;min-height:auto;"></div>
    <style>
      .windowRB{ padding: 0;}
      .windowRB .wwads-img{margin-top: 10px;}
      .windowRB .wwads-content{margin: 0 10px 10px 10px;}
      .custom-html-window-rb .close-but{
        display: none;
      }
    </style>
  </div></div></div></div><div class="global-ui"></div></div>
    <script src="/java-tutorial/assets/js/app.1905b9e7.js" defer></script><script src="/java-tutorial/assets/js/2.fd3e179e.js" defer></script><script src="/java-tutorial/assets/js/75.a7709b48.js" defer></script>
  </body>
</html>
