(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(n){function e(e){for(var a,o,s=e[0],l=e[1],c=e[2],d=0,m=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(n[a]=l[a]);for(p&&p(e);m.length;)m.shift()();return i.push.apply(i,c||[]),t()}function t(){for(var n,e=0;e<i.length;e++){for(var t=i[e],a=!0,s=1;s<t.length;s++){var l=t[s];0!==r[l]&&(a=!1)}a&&(i.splice(e--,1),n=o(o.s=t[0]))}return n}var a={},r={1:0},i=[];function o(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.e=function(n){var e=[],t=r[n];if(0!==t)if(t)e.push(t[2]);else{var a=new Promise((function(e,a){t=r[n]=[e,a]}));e.push(t[2]=a);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(n){return o.p+"assets/js/"+({}[n]||n)+"."+{2:"fd3e179e",3:"13829456",4:"6d986bfe",5:"dfc39999",6:"39027bda",7:"3fbeea1c",8:"49ad1637",9:"e7534b6c",10:"4f444ad9",11:"bcba717a",12:"8fe18c68",13:"ac6b35ed",14:"d9be7dd1",15:"658a6d64",16:"0eacd8a6",17:"456002b9",18:"355372f4",19:"ec6f4848",20:"f4728706",21:"07934a6e",22:"04bea09d",23:"bded5cf6",24:"36e55145",25:"af635b06",26:"3eb5129e",27:"76ca98fe",28:"8ccbcac6",29:"ef9e7225",30:"d9cc6dc8",31:"a4970b6b",32:"c1e5ef11",33:"dc8ab04b",34:"27064eb2",35:"e2658c44",36:"5dfe8359",37:"9bed175b",38:"442a0821",39:"ee700231",40:"c70d0291",41:"c2c82a49",42:"d1251607",43:"521ef6e4",44:"66b2dcf2",45:"c588e7c8",46:"a2092b84",47:"e1a8c216",48:"aeba6e1f",49:"3978dfc3",50:"6d98df1d",51:"2bfd5e00",52:"62d88abb",53:"155f15a2",54:"266cf2d7",55:"d1ed211f",56:"cd84ef92",57:"e4428de4",58:"54f14446",59:"b528093b",60:"0b2f58d0",61:"7ec5c991",62:"2241309a",63:"ac4e1e0a",64:"d106193a",65:"b6c04d51",66:"36025271",67:"c231dad8",68:"b1d2c18d",69:"c541140a",70:"50e92823",71:"cfe6e344",72:"82532df7",73:"987e4182",74:"06ab1615",75:"a7709b48",76:"d2a08353",77:"0141ff0a",78:"8d33fcf7",79:"132f7978",80:"be1fa7c9",81:"5f384a58",82:"ac3a3a26",83:"4af5435b",84:"bcb557f7",85:"501d4ca7",86:"facca23f"}[n]+".js"}(n);var l=new Error;i=function(e){s.onerror=s.onload=null,clearTimeout(c);var t=r[n];if(0!==t){if(t){var a=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;l.message="Loading chunk "+n+" failed.\n("+a+": "+i+")",l.name="ChunkLoadError",l.type=a,l.request=i,t[1](l)}r[n]=void 0}};var c=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(e)},o.m=n,o.c=a,o.d=function(n,e,t){o.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)o.d(t,a,function(e){return n[e]}.bind(null,a));return t},o.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(e,"a",e),e},o.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},o.p="/java-tutorial/",o.oe=function(n){throw console.error(n),n};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var p=l;i.push([100,0]),t()}([function(n,e){n.exports=function(n){return"function"==typeof n}},function(n,e,t){var a=t(25),r=Function.prototype,i=r.bind,o=r.call,s=a&&i.bind(o,o);n.exports=a?function(n){return n&&s(n)}:function(n){return n&&function(){return o.apply(n,arguments)}}},function(n,e){var t=function(n){return n&&n.Math==Math&&n};n.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(n,e){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,e){var t=Array.isArray;n.exports=t},function(n,e,t){var a=t(67),r="object"==typeof self&&self&&self.Object===Object&&self,i=a||r||Function("return this")();n.exports=i},function(n,e,t){"use strict";function a(n,e,t,a,r,i,o,s){var l,c="function"==typeof n?n.options:n;if(e&&(c.render=e,c.staticRenderFns=t,c._compiled=!0),a&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),o?(l=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),r&&r.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(o)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(n,e){return l.call(e),p(n,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:n,options:c}}t.d(e,"a",(function(){return a}))},function(n,e,t){var a=t(3);n.exports=!a((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(n,e,t){var a=t(1),r=t(45),i=a({}.hasOwnProperty);n.exports=Object.hasOwn||function(n,e){return i(r(n),e)}},function(n,e,t){var a=t(0);n.exports=function(n){return"object"==typeof n?null!==n:a(n)}},function(n,e,t){var a=t(155),r=t(158);n.exports=function(n,e){var t=r(n,e);return a(t)?t:void 0}},function(n,e,t){"use strict";t.d(e,"e",(function(){return a})),t.d(e,"b",(function(){return i})),t.d(e,"j",(function(){return o})),t.d(e,"g",(function(){return l})),t.d(e,"h",(function(){return c})),t.d(e,"i",(function(){return p})),t.d(e,"c",(function(){return d})),t.d(e,"f",(function(){return m})),t.d(e,"l",(function(){return u})),t.d(e,"m",(function(){return h})),t.d(e,"d",(function(){return v})),t.d(e,"k",(function(){return b})),t.d(e,"n",(function(){return f})),t.d(e,"a",(function(){return x}));const a=/#.*$/,r=/\.(md|html)$/,i=/\/$/,o=/^[a-z]+:/i;function s(n){return decodeURI(n).replace(a,"").replace(r,"")}function l(n){return o.test(n)}function c(n){return/^mailto:/.test(n)}function p(n){return/^tel:/.test(n)}function d(n){if(l(n))return n;if(!n)return"404";const e=n.match(a),t=e?e[0]:"",r=s(n);return i.test(r)?n:r+".html"+t}function m(n,e){const t=n.hash,r=function(n){const e=n&&n.match(a);if(e)return e[0]}(e);if(r&&t!==r)return!1;return s(n.path)===s(e)}function u(n,e,t){if(l(e))return{type:"external",path:e};t&&(e=function(n,e,t){const a=n.charAt(0);if("/"===a)return n;if("?"===a||"#"===a)return e+n;const r=e.split("/");t&&r[r.length-1]||r.pop();const i=n.replace(/^\//,"").split("/");for(let n=0;n<i.length;n++){const e=i[n];".."===e?r.pop():"."!==e&&r.push(e)}""!==r[0]&&r.unshift("");return r.join("/")}(e,t));const a=s(e);for(let e=0;e<n.length;e++)if(s(n[e].regularPath)===a)return Object.assign({},n[e],{type:"page",path:d(n[e].path)});return console.error(`[vuepress] No matching page found for sidebar item "${e}"`),{}}function h(n,e,t,a){const{pages:r,themeConfig:i}=t,o=a&&i.locales&&i.locales[a]||i;if("auto"===(n.frontmatter.sidebar||o.sidebar||i.sidebar))return g(n);const s=o.sidebar||i.sidebar;if(s){const{base:t,config:a}=function(n,e){if(Array.isArray(e))return{base:"/",config:e};for(const a in e)if(0===(t=n,/(\.html|\/)$/.test(t)?t:t+"/").indexOf(encodeURI(a)))return{base:a,config:e[a]};var t;return{}}(e,s);return"auto"===a?g(n):a?a.map(n=>function n(e,t,a,r=1){if("string"==typeof e)return u(t,e,a);if(Array.isArray(e))return Object.assign(u(t,e[0],a),{title:e[1]});{r>3&&console.error("[vuepress] detected a too deep nested sidebar group.");const i=e.children||[];return 0===i.length&&e.path?Object.assign(u(t,e.path,a),{title:e.title}):{type:"group",path:e.path,title:e.title,sidebarDepth:e.sidebarDepth,initialOpenGroupIndex:e.initialOpenGroupIndex,children:i.map(e=>n(e,t,a,r+1)),collapsable:!1!==e.collapsable}}}(n,r,t)):[]}return[]}function g(n){const e=v(n.headers||[]);return[{type:"group",collapsable:!1,title:n.title,path:null,children:e.map(e=>({type:"auto",title:e.title,basePath:n.path,path:n.path+"#"+e.slug,children:e.children||[]}))}]}function v(n){let e;return(n=n.map(n=>Object.assign({},n))).forEach(n=>{2===n.level?e=n:e&&(e.children||(e.children=[])).push(n)}),n.filter(n=>2===n.level)}function b(n){return Object.assign(n,{type:n.items&&n.items.length?"links":"link"})}function f(n){return Object.prototype.toString.call(n).match(/\[object (.*?)\]/)[1].toLowerCase()}function y(n){let e=n.frontmatter.date||n.lastUpdated||new Date,t=new Date(e);return"Invalid Date"==t&&e&&(t=new Date(e.replace(/-/g,"/"))),t.getTime()}function x(n,e){return y(e)-y(n)}},function(n,e){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,e,t){var a=t(14),r=t(140),i=t(141),o=a?a.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":o&&o in Object(n)?r(n):i(n)}},function(n,e,t){var a=t(5).Symbol;n.exports=a},function(n,e,t){var a=t(7),r=t(61),i=t(96),o=t(24),s=t(52),l=TypeError,c=Object.defineProperty,p=Object.getOwnPropertyDescriptor;e.f=a?i?function(n,e,t){if(o(n),e=s(e),o(t),"function"==typeof n&&"prototype"===e&&"value"in t&&"writable"in t&&!t.writable){var a=p(n,e);a&&a.writable&&(n[e]=t.value,t={configurable:"configurable"in t?t.configurable:a.configurable,enumerable:"enumerable"in t?t.enumerable:a.enumerable,writable:!1})}return c(n,e,t)}:c:function(n,e,t){if(o(n),e=s(e),o(t),r)try{return c(n,e,t)}catch(n){}if("get"in t||"set"in t)throw l("Accessors not supported");return"value"in t&&(n[e]=t.value),n}},function(n,e,t){var a=t(2),r=t(0),i=function(n){return r(n)?n:void 0};n.exports=function(n,e){return arguments.length<2?i(a[n]):a[n]&&a[n][e]}},function(n,e,t){var a=t(7),r=t(15),i=t(29);n.exports=a?function(n,e,t){return r.f(n,e,i(1,t))}:function(n,e,t){return n[e]=t,n}},function(n,e,t){var a=t(145),r=t(146),i=t(147),o=t(148),s=t(149);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var a=n[e];this.set(a[0],a[1])}}l.prototype.clear=a,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=o,l.prototype.set=s,n.exports=l},function(n,e,t){var a=t(69);n.exports=function(n,e){for(var t=n.length;t--;)if(a(n[t][0],e))return t;return-1}},function(n,e,t){var a=t(10)(Object,"create");n.exports=a},function(n,e,t){var a=t(167);n.exports=function(n,e){var t=n.__data__;return a(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(n,e,t){var a=t(40);n.exports=function(n){if("string"==typeof n||a(n))return n;var e=n+"";return"0"==e&&1/n==-1/0?"-0":e}},function(n,e,t){var a,r;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(r="function"==typeof(a=function(){var n,e,t={version:"0.2.0"},a=t.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function r(n,e,t){return n<e?e:n>t?t:n}function i(n){return 100*(-1+n)}t.configure=function(n){var e,t;for(e in n)void 0!==(t=n[e])&&n.hasOwnProperty(e)&&(a[e]=t);return this},t.status=null,t.set=function(n){var e=t.isStarted();n=r(n,a.minimum,1),t.status=1===n?null:n;var l=t.render(!e),c=l.querySelector(a.barSelector),p=a.speed,d=a.easing;return l.offsetWidth,o((function(e){""===a.positionUsing&&(a.positionUsing=t.getPositioningCSS()),s(c,function(n,e,t){var r;return(r="translate3d"===a.positionUsing?{transform:"translate3d("+i(n)+"%,0,0)"}:"translate"===a.positionUsing?{transform:"translate("+i(n)+"%,0)"}:{"margin-left":i(n)+"%"}).transition="all "+e+"ms "+t,r}(n,p,d)),1===n?(s(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout((function(){s(l,{transition:"all "+p+"ms linear",opacity:0}),setTimeout((function(){t.remove(),e()}),p)}),p)):setTimeout(e,p)})),this},t.isStarted=function(){return"number"==typeof t.status},t.start=function(){t.status||t.set(0);var n=function(){setTimeout((function(){t.status&&(t.trickle(),n())}),a.trickleSpeed)};return a.trickle&&n(),this},t.done=function(n){return n||t.status?t.inc(.3+.5*Math.random()).set(1):this},t.inc=function(n){var e=t.status;return e?("number"!=typeof n&&(n=(1-e)*r(Math.random()*e,.1,.95)),e=r(e+n,0,.994),t.set(e)):t.start()},t.trickle=function(){return t.inc(Math.random()*a.trickleRate)},n=0,e=0,t.promise=function(a){return a&&"resolved"!==a.state()?(0===e&&t.start(),n++,e++,a.always((function(){0==--e?(n=0,t.done()):t.set((n-e)/n)})),this):this},t.render=function(n){if(t.isRendered())return document.getElementById("nprogress");c(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=a.template;var r,o=e.querySelector(a.barSelector),l=n?"-100":i(t.status||0),p=document.querySelector(a.parent);return s(o,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),a.showSpinner||(r=e.querySelector(a.spinnerSelector))&&m(r),p!=document.body&&c(p,"nprogress-custom-parent"),p.appendChild(e),e},t.remove=function(){p(document.documentElement,"nprogress-busy"),p(document.querySelector(a.parent),"nprogress-custom-parent");var n=document.getElementById("nprogress");n&&m(n)},t.isRendered=function(){return!!document.getElementById("nprogress")},t.getPositioningCSS=function(){var n=document.body.style,e="WebkitTransform"in n?"Webkit":"MozTransform"in n?"Moz":"msTransform"in n?"ms":"OTransform"in n?"O":"";return e+"Perspective"in n?"translate3d":e+"Transform"in n?"translate":"margin"};var o=function(){var n=[];function e(){var t=n.shift();t&&t(e)}return function(t){n.push(t),1==n.length&&e()}}(),s=function(){var n=["Webkit","O","Moz","ms"],e={};function t(t){return t=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(n,e){return e.toUpperCase()})),e[t]||(e[t]=function(e){var t=document.body.style;if(e in t)return e;for(var a,r=n.length,i=e.charAt(0).toUpperCase()+e.slice(1);r--;)if((a=n[r]+i)in t)return a;return e}(t))}function a(n,e,a){e=t(e),n.style[e]=a}return function(n,e){var t,r,i=arguments;if(2==i.length)for(t in e)void 0!==(r=e[t])&&e.hasOwnProperty(t)&&a(n,t,r);else a(n,i[1],i[2])}}();function l(n,e){return("string"==typeof n?n:d(n)).indexOf(" "+e+" ")>=0}function c(n,e){var t=d(n),a=t+e;l(t,e)||(n.className=a.substring(1))}function p(n,e){var t,a=d(n);l(n,e)&&(t=a.replace(" "+e+" "," "),n.className=t.substring(1,t.length-1))}function d(n){return(" "+(n.className||"")+" ").replace(/\s+/gi," ")}function m(n){n&&n.parentNode&&n.parentNode.removeChild(n)}return t})?a.call(e,t,e,n):a)||(n.exports=r)},function(n,e,t){var a=t(9),r=String,i=TypeError;n.exports=function(n){if(a(n))return n;throw i(r(n)+" is not an object")}},function(n,e,t){var a=t(3);n.exports=!a((function(){var n=function(){}.bind();return"function"!=typeof n||n.hasOwnProperty("prototype")}))},function(n,e,t){var a=t(43),r=t(51);n.exports=function(n){return a(r(n))}},function(n,e,t){var a=t(2),r=t(58),i=t(8),o=t(60),s=t(56),l=t(55),c=r("wks"),p=a.Symbol,d=p&&p.for,m=l?p:p&&p.withoutSetter||o;n.exports=function(n){if(!i(c,n)||!s&&"string"!=typeof c[n]){var e="Symbol."+n;s&&i(p,n)?c[n]=p[n]:c[n]=l&&d?d(e):m(e)}return c[n]}},function(n,e,t){var a=t(25),r=Function.prototype.call;n.exports=a?r.bind(r):function(){return r.apply(r,arguments)}},function(n,e){n.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(n,e,t){var a=t(1),r=a({}.toString),i=a("".slice);n.exports=function(n){return i(r(n),8,-1)}},function(n,e,t){var a=t(2),r=t(32),i=a["__core-js_shared__"]||r("__core-js_shared__",{});n.exports=i},function(n,e,t){var a=t(2),r=Object.defineProperty;n.exports=function(n,e){try{r(a,n,{value:e,configurable:!0,writable:!0})}catch(t){a[n]=e}return e}},function(n,e,t){var a=t(139),r=t(12),i=Object.prototype,o=i.hasOwnProperty,s=i.propertyIsEnumerable,l=a(function(){return arguments}())?a:function(n){return r(n)&&o.call(n,"callee")&&!s.call(n,"callee")};n.exports=l},function(n,e,t){var a=t(10)(t(5),"Map");n.exports=a},function(n,e){n.exports=function(n){var e=typeof n;return null!=n&&("object"==e||"function"==e)}},function(n,e,t){var a=t(159),r=t(166),i=t(168),o=t(169),s=t(170);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var a=n[e];this.set(a[0],a[1])}}l.prototype.clear=a,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=o,l.prototype.set=s,n.exports=l},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n){t[++e]=n})),t}},function(n,e){n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=9007199254740991}},function(n,e,t){var a=t(4),r=t(40),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;n.exports=function(n,e){if(a(n))return!1;var t=typeof n;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=n&&!r(n))||(o.test(n)||!i.test(n)||null!=e&&n in Object(e))}},function(n,e,t){var a=t(13),r=t(12);n.exports=function(n){return"symbol"==typeof n||r(n)&&"[object Symbol]"==a(n)}},function(n,e){n.exports=function(n){return n}},function(n,e,t){var a=t(2),r=t(50).f,i=t(17),o=t(108),s=t(32),l=t(63),c=t(120);n.exports=function(n,e){var t,p,d,m,u,h=n.target,g=n.global,v=n.stat;if(t=g?a:v?a[h]||s(h,{}):(a[h]||{}).prototype)for(p in e){if(m=e[p],d=n.dontCallGetSet?(u=r(t,p))&&u.value:t[p],!c(g?p:h+(v?".":"#")+p,n.forced)&&void 0!==d){if(typeof m==typeof d)continue;l(m,d)}(n.sham||d&&d.sham)&&i(m,"sham",!0),o(t,p,m,n)}}},function(n,e,t){var a=t(1),r=t(3),i=t(30),o=Object,s=a("".split);n.exports=r((function(){return!o("z").propertyIsEnumerable(0)}))?function(n){return"String"==i(n)?s(n,""):o(n)}:o},function(n,e,t){var a=t(0),r=t(106),i=TypeError;n.exports=function(n){if(a(n))return n;throw i(r(n)+" is not a function")}},function(n,e,t){var a=t(51),r=Object;n.exports=function(n){return r(a(n))}},function(n,e){n.exports={}},function(n,e,t){var a=t(118);n.exports=function(n){return a(n.length)}},function(n,e){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,e){var t=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,i=/^0o[0-7]+$/i,o=parseInt,s="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),p=Object.prototype.toString,d=Math.max,m=Math.min,u=function(){return c.Date.now()};function h(n){var e=typeof n;return!!n&&("object"==e||"function"==e)}function g(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return!!n&&"object"==typeof n}(n)&&"[object Symbol]"==p.call(n)}(n))return NaN;if(h(n)){var e="function"==typeof n.valueOf?n.valueOf():n;n=h(e)?e+"":e}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(t,"");var s=r.test(n);return s||i.test(n)?o(n.slice(2),s?2:8):a.test(n)?NaN:+n}n.exports=function(n,e,t){var a,r,i,o,s,l,c=0,p=!1,v=!1,b=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function f(e){var t=a,i=r;return a=r=void 0,c=e,o=n.apply(i,t)}function y(n){return c=n,s=setTimeout(k,e),p?f(n):o}function x(n){var t=n-l;return void 0===l||t>=e||t<0||v&&n-c>=i}function k(){var n=u();if(x(n))return j(n);s=setTimeout(k,function(n){var t=e-(n-l);return v?m(t,i-(n-c)):t}(n))}function j(n){return s=void 0,b&&a?f(n):(a=r=void 0,o)}function S(){var n=u(),t=x(n);if(a=arguments,r=this,l=n,t){if(void 0===s)return y(l);if(v)return s=setTimeout(k,e),f(l)}return void 0===s&&(s=setTimeout(k,e)),o}return e=g(e)||0,h(t)&&(p=!!t.leading,i=(v="maxWait"in t)?d(g(t.maxWait)||0,e):i,b="trailing"in t?!!t.trailing:b),S.cancel=function(){void 0!==s&&clearTimeout(s),c=0,a=l=r=s=void 0},S.flush=function(){return void 0===s?o:j(u())},S}},function(n,e,t){var a=t(7),r=t(28),i=t(102),o=t(29),s=t(26),l=t(52),c=t(8),p=t(61),d=Object.getOwnPropertyDescriptor;e.f=a?d:function(n,e){if(n=s(n),e=l(e),p)try{return d(n,e)}catch(n){}if(c(n,e))return o(!r(i.f,n,e),n[e])}},function(n,e){var t=TypeError;n.exports=function(n){if(null==n)throw t("Can't call method on "+n);return n}},function(n,e,t){var a=t(103),r=t(53);n.exports=function(n){var e=a(n,"string");return r(e)?e:e+""}},function(n,e,t){var a=t(16),r=t(0),i=t(54),o=t(55),s=Object;n.exports=o?function(n){return"symbol"==typeof n}:function(n){var e=a("Symbol");return r(e)&&i(e.prototype,s(n))}},function(n,e,t){var a=t(1);n.exports=a({}.isPrototypeOf)},function(n,e,t){var a=t(56);n.exports=a&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(n,e,t){var a=t(57),r=t(3);n.exports=!!Object.getOwnPropertySymbols&&!r((function(){var n=Symbol();return!String(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&a&&a<41}))},function(n,e,t){var a,r,i=t(2),o=t(104),s=i.process,l=i.Deno,c=s&&s.versions||l&&l.version,p=c&&c.v8;p&&(r=(a=p.split("."))[0]>0&&a[0]<4?1:+(a[0]+a[1])),!r&&o&&(!(a=o.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=o.match(/Chrome\/(\d+)/))&&(r=+a[1]),n.exports=r},function(n,e,t){var a=t(59),r=t(31);(n.exports=function(n,e){return r[n]||(r[n]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.3",mode:a?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE",source:"https://github.com/zloirock/core-js"})},function(n,e){n.exports=!1},function(n,e,t){var a=t(1),r=0,i=Math.random(),o=a(1..toString);n.exports=function(n){return"Symbol("+(void 0===n?"":n)+")_"+o(++r+i,36)}},function(n,e,t){var a=t(7),r=t(3),i=t(95);n.exports=!a&&!r((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(n,e,t){var a=t(1),r=t(0),i=t(31),o=a(Function.toString);r(i.inspectSource)||(i.inspectSource=function(n){return o(n)}),n.exports=i.inspectSource},function(n,e,t){var a=t(8),r=t(113),i=t(50),o=t(15);n.exports=function(n,e,t){for(var s=r(e),l=o.f,c=i.f,p=0;p<s.length;p++){var d=s[p];a(n,d)||t&&a(t,d)||l(n,d,c(e,d))}}},function(n,e,t){var a=t(117);n.exports=function(n){var e=+n;return e!=e||0===e?0:a(e)}},function(n,e,t){var a=t(1),r=t(24),i=t(127);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,e=!1,t={};try{(n=a(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(t,[]),e=t instanceof Array}catch(n){}return function(t,a){return r(t),i(a),e?n(t,a):t.__proto__=a,t}}():void 0)},function(n,e){n.exports=function(n,e){for(var t=-1,a=e.length,r=n.length;++t<a;)n[r+t]=e[t];return n}},function(n,e){var t="object"==typeof global&&global&&global.Object===Object&&global;n.exports=t},function(n,e,t){var a=t(18),r=t(150),i=t(151),o=t(152),s=t(153),l=t(154);function c(n){var e=this.__data__=new a(n);this.size=e.size}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=l,n.exports=c},function(n,e){n.exports=function(n,e){return n===e||n!=n&&e!=e}},function(n,e,t){var a=t(13),r=t(35);n.exports=function(n){if(!r(n))return!1;var e=a(n);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(n,e){var t=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return t.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,e,t){var a=t(171),r=t(12);n.exports=function n(e,t,i,o,s){return e===t||(null==e||null==t||!r(e)&&!r(t)?e!=e&&t!=t:a(e,t,i,o,n,s))}},function(n,e,t){var a=t(74),r=t(174),i=t(75);n.exports=function(n,e,t,o,s,l){var c=1&t,p=n.length,d=e.length;if(p!=d&&!(c&&d>p))return!1;var m=l.get(n),u=l.get(e);if(m&&u)return m==e&&u==n;var h=-1,g=!0,v=2&t?new a:void 0;for(l.set(n,e),l.set(e,n);++h<p;){var b=n[h],f=e[h];if(o)var y=c?o(f,b,h,e,n,l):o(b,f,h,n,e,l);if(void 0!==y){if(y)continue;g=!1;break}if(v){if(!r(e,(function(n,e){if(!i(v,e)&&(b===n||s(b,n,t,o,l)))return v.push(e)}))){g=!1;break}}else if(b!==f&&!s(b,f,t,o,l)){g=!1;break}}return l.delete(n),l.delete(e),g}},function(n,e,t){var a=t(36),r=t(172),i=t(173);function o(n){var e=-1,t=null==n?0:n.length;for(this.__data__=new a;++e<t;)this.add(n[e])}o.prototype.add=o.prototype.push=r,o.prototype.has=i,n.exports=o},function(n,e){n.exports=function(n,e){return n.has(e)}},function(n,e,t){var a=t(184),r=t(190),i=t(80);n.exports=function(n){return i(n)?a(n):r(n)}},function(n,e,t){(function(n){var a=t(5),r=t(186),i=e&&!e.nodeType&&e,o=i&&"object"==typeof n&&n&&!n.nodeType&&n,s=o&&o.exports===i?a.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;n.exports=l}).call(this,t(48)(n))},function(n,e){var t=/^(?:0|[1-9]\d*)$/;n.exports=function(n,e){var a=typeof n;return!!(e=null==e?9007199254740991:e)&&("number"==a||"symbol"!=a&&t.test(n))&&n>-1&&n%1==0&&n<e}},function(n,e,t){var a=t(187),r=t(188),i=t(189),o=i&&i.isTypedArray,s=o?r(o):a;n.exports=s},function(n,e,t){var a=t(70),r=t(38);n.exports=function(n){return null!=n&&r(n.length)&&!a(n)}},function(n,e,t){var a=t(10)(t(5),"Set");n.exports=a},function(n,e,t){var a=t(35);n.exports=function(n){return n==n&&!a(n)}},function(n,e){n.exports=function(n,e){return function(t){return null!=t&&(t[n]===e&&(void 0!==e||n in Object(t)))}}},function(n,e,t){var a=t(85),r=t(22);n.exports=function(n,e){for(var t=0,i=(e=a(e,n)).length;null!=n&&t<i;)n=n[r(e[t++])];return t&&t==i?n:void 0}},function(n,e,t){var a=t(4),r=t(39),i=t(201),o=t(204);n.exports=function(n,e){return a(n)?n:r(n,e)?[n]:i(o(n))}},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){var a=t(137),r=t(142),i=t(213),o=t(221),s=t(230),l=t(99),c=i((function(n){var e=l(n);return s(e)&&(e=void 0),o(a(n,1,s,!0),r(e,2))}));n.exports=c},function(n,e,t){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var a=/["'&<>]/;n.exports=function(n){var e,t=""+n,r=a.exec(t);if(!r)return t;var i="",o=0,s=0;for(o=r.index;o<t.length;o++){switch(t.charCodeAt(o)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==o&&(i+=t.substring(s,o)),s=o+1,i+=e}return s!==o?i+t.substring(s,o):i}},function(n,e,t){"use strict";t.r(e);var a={name:"CodeBlock",props:{title:{type:String,required:!0},active:{type:Boolean,default:!1}}},r=(t(233),t(6)),i=Object(r.a)(a,(function(){return(0,this._self._c)("div",{staticClass:"theme-code-block",class:{"theme-code-block__active":this.active}},[this._t("default")],2)}),[],!1,null,"4f1e9d0c",null);e.default=i.exports},function(n,e,t){"use strict";t.r(e);var a={name:"CodeGroup",data:()=>({codeTabs:[],activeCodeTabIndex:-1}),watch:{activeCodeTabIndex(n){this.codeTabs.forEach(n=>{n.elm.classList.remove("theme-code-block__active")}),this.codeTabs[n].elm.classList.add("theme-code-block__active")}},mounted(){this.codeTabs=(this.$slots.default||[]).filter(n=>Boolean(n.componentOptions)).map((n,e)=>(""===n.componentOptions.propsData.active&&(this.activeCodeTabIndex=e),{title:n.componentOptions.propsData.title,elm:n.elm})),-1===this.activeCodeTabIndex&&this.codeTabs.length>0&&(this.activeCodeTabIndex=0)},methods:{changeCodeTab(n){this.activeCodeTabIndex=n}}},r=(t(234),t(6)),i=Object(r.a)(a,(function(){var n=this,e=n._self._c;return e("div",{staticClass:"theme-code-group"},[e("div",{staticClass:"theme-code-group__nav"},[e("ul",{staticClass:"theme-code-group__ul"},n._l(n.codeTabs,(function(t,a){return e("li",{key:t.title,staticClass:"theme-code-group__li"},[e("button",{staticClass:"theme-code-group__nav-tab",class:{"theme-code-group__nav-tab-active":a===n.activeCodeTabIndex},on:{click:function(e){return n.changeCodeTab(a)}}},[n._v("\n            "+n._s(t.title)+"\n          ")])])})),0)]),n._v(" "),n._t("default"),n._v(" "),n.codeTabs.length<1?e("pre",{staticClass:"pre-blank"},[n._v("// Make sure to add code blocks to your code group")]):n._e()],2)}),[],!1,null,"2f5f1757",null);e.default=i.exports},function(n,e){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,e,t){var a=t(2),r=t(9),i=a.document,o=r(i)&&r(i.createElement);n.exports=function(n){return o?i.createElement(n):{}}},function(n,e,t){var a=t(7),r=t(3);n.exports=a&&r((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(n,e,t){var a=t(58),r=t(60),i=a("keys");n.exports=function(n){return i[n]||(i[n]=r(n))}},function(n,e,t){var a=t(1),r=t(8),i=t(26),o=t(115).indexOf,s=t(46),l=a([].push);n.exports=function(n,e){var t,a=i(n),c=0,p=[];for(t in a)!r(s,t)&&r(a,t)&&l(p,t);for(;e.length>c;)r(a,t=e[c++])&&(~o(p,t)||l(p,t));return p}},function(n,e){n.exports=function(n){var e=null==n?0:n.length;return e?n[e-1]:void 0}},function(n,e,t){n.exports=t(239)},function(n,e,t){"use strict";var a=t(42),r=t(121).left,i=t(122),o=t(57),s=t(123);a({target:"Array",proto:!0,forced:!i("reduce")||!s&&o>79&&o<83},{reduce:function(n){var e=arguments.length;return r(this,n,e,e>1?arguments[1]:void 0)}})},function(n,e,t){"use strict";var a={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!a.call({1:2},1);e.f=i?function(n){var e=r(this,n);return!!e&&e.enumerable}:a},function(n,e,t){var a=t(28),r=t(9),i=t(53),o=t(105),s=t(107),l=t(27),c=TypeError,p=l("toPrimitive");n.exports=function(n,e){if(!r(n)||i(n))return n;var t,l=o(n,p);if(l){if(void 0===e&&(e="default"),t=a(l,n,e),!r(t)||i(t))return t;throw c("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(n,e)}},function(n,e,t){var a=t(16);n.exports=a("navigator","userAgent")||""},function(n,e,t){var a=t(44);n.exports=function(n,e){var t=n[e];return null==t?void 0:a(t)}},function(n,e){var t=String;n.exports=function(n){try{return t(n)}catch(n){return"Object"}}},function(n,e,t){var a=t(28),r=t(0),i=t(9),o=TypeError;n.exports=function(n,e){var t,s;if("string"===e&&r(t=n.toString)&&!i(s=a(t,n)))return s;if(r(t=n.valueOf)&&!i(s=a(t,n)))return s;if("string"!==e&&r(t=n.toString)&&!i(s=a(t,n)))return s;throw o("Can't convert object to primitive value")}},function(n,e,t){var a=t(0),r=t(15),i=t(109),o=t(32);n.exports=function(n,e,t,s){s||(s={});var l=s.enumerable,c=void 0!==s.name?s.name:e;if(a(t)&&i(t,c,s),s.global)l?n[e]=t:o(e,t);else{try{s.unsafe?n[e]&&(l=!0):delete n[e]}catch(n){}l?n[e]=t:r.f(n,e,{value:t,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return n}},function(n,e,t){var a=t(3),r=t(0),i=t(8),o=t(7),s=t(110).CONFIGURABLE,l=t(62),c=t(111),p=c.enforce,d=c.get,m=Object.defineProperty,u=o&&!a((function(){return 8!==m((function(){}),"length",{value:8}).length})),h=String(String).split("String"),g=n.exports=function(n,e,t){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!i(n,"name")||s&&n.name!==e)&&(o?m(n,"name",{value:e,configurable:!0}):n.name=e),u&&t&&i(t,"arity")&&n.length!==t.arity&&m(n,"length",{value:t.arity});try{t&&i(t,"constructor")&&t.constructor?o&&m(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch(n){}var a=p(n);return i(a,"source")||(a.source=h.join("string"==typeof e?e:"")),n};Function.prototype.toString=g((function(){return r(this)&&d(this).source||l(this)}),"toString")},function(n,e,t){var a=t(7),r=t(8),i=Function.prototype,o=a&&Object.getOwnPropertyDescriptor,s=r(i,"name"),l=s&&"something"===function(){}.name,c=s&&(!a||a&&o(i,"name").configurable);n.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},function(n,e,t){var a,r,i,o=t(112),s=t(2),l=t(1),c=t(9),p=t(17),d=t(8),m=t(31),u=t(97),h=t(46),g=s.TypeError,v=s.WeakMap;if(o||m.state){var b=m.state||(m.state=new v),f=l(b.get),y=l(b.has),x=l(b.set);a=function(n,e){if(y(b,n))throw new g("Object already initialized");return e.facade=n,x(b,n,e),e},r=function(n){return f(b,n)||{}},i=function(n){return y(b,n)}}else{var k=u("state");h[k]=!0,a=function(n,e){if(d(n,k))throw new g("Object already initialized");return e.facade=n,p(n,k,e),e},r=function(n){return d(n,k)?n[k]:{}},i=function(n){return d(n,k)}}n.exports={set:a,get:r,has:i,enforce:function(n){return i(n)?r(n):a(n,{})},getterFor:function(n){return function(e){var t;if(!c(e)||(t=r(e)).type!==n)throw g("Incompatible receiver, "+n+" required");return t}}}},function(n,e,t){var a=t(2),r=t(0),i=t(62),o=a.WeakMap;n.exports=r(o)&&/native code/.test(i(o))},function(n,e,t){var a=t(16),r=t(1),i=t(114),o=t(119),s=t(24),l=r([].concat);n.exports=a("Reflect","ownKeys")||function(n){var e=i.f(s(n)),t=o.f;return t?l(e,t(n)):e}},function(n,e,t){var a=t(98),r=t(94).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(n){return a(n,r)}},function(n,e,t){var a=t(26),r=t(116),i=t(47),o=function(n){return function(e,t,o){var s,l=a(e),c=i(l),p=r(o,c);if(n&&t!=t){for(;c>p;)if((s=l[p++])!=s)return!0}else for(;c>p;p++)if((n||p in l)&&l[p]===t)return n||p||0;return!n&&-1}};n.exports={includes:o(!0),indexOf:o(!1)}},function(n,e,t){var a=t(64),r=Math.max,i=Math.min;n.exports=function(n,e){var t=a(n);return t<0?r(t+e,0):i(t,e)}},function(n,e){var t=Math.ceil,a=Math.floor;n.exports=Math.trunc||function(n){var e=+n;return(e>0?a:t)(e)}},function(n,e,t){var a=t(64),r=Math.min;n.exports=function(n){return n>0?r(a(n),9007199254740991):0}},function(n,e){e.f=Object.getOwnPropertySymbols},function(n,e,t){var a=t(3),r=t(0),i=/#|\.prototype\./,o=function(n,e){var t=l[s(n)];return t==p||t!=c&&(r(e)?a(e):!!e)},s=o.normalize=function(n){return String(n).replace(i,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",p=o.POLYFILL="P";n.exports=o},function(n,e,t){var a=t(44),r=t(45),i=t(43),o=t(47),s=TypeError,l=function(n){return function(e,t,l,c){a(t);var p=r(e),d=i(p),m=o(p),u=n?m-1:0,h=n?-1:1;if(l<2)for(;;){if(u in d){c=d[u],u+=h;break}if(u+=h,n?u<0:m<=u)throw s("Reduce of empty array with no initial value")}for(;n?u>=0:m>u;u+=h)u in d&&(c=t(c,d[u],u,p));return c}};n.exports={left:l(!1),right:l(!0)}},function(n,e,t){"use strict";var a=t(3);n.exports=function(n,e){var t=[][n];return!!t&&a((function(){t.call(null,e||function(){return 1},1)}))}},function(n,e,t){var a=t(30),r=t(2);n.exports="process"==a(r.process)},function(n,e,t){var a=t(42),r=t(2),i=t(125),o=t(126),s=r.WebAssembly,l=7!==Error("e",{cause:7}).cause,c=function(n,e){var t={};t[n]=o(n,e,l),a({global:!0,constructor:!0,arity:1,forced:l},t)},p=function(n,e){if(s&&s[n]){var t={};t[n]=o("WebAssembly."+n,e,l),a({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:l},t)}};c("Error",(function(n){return function(e){return i(n,this,arguments)}})),c("EvalError",(function(n){return function(e){return i(n,this,arguments)}})),c("RangeError",(function(n){return function(e){return i(n,this,arguments)}})),c("ReferenceError",(function(n){return function(e){return i(n,this,arguments)}})),c("SyntaxError",(function(n){return function(e){return i(n,this,arguments)}})),c("TypeError",(function(n){return function(e){return i(n,this,arguments)}})),c("URIError",(function(n){return function(e){return i(n,this,arguments)}})),p("CompileError",(function(n){return function(e){return i(n,this,arguments)}})),p("LinkError",(function(n){return function(e){return i(n,this,arguments)}})),p("RuntimeError",(function(n){return function(e){return i(n,this,arguments)}}))},function(n,e,t){var a=t(25),r=Function.prototype,i=r.apply,o=r.call;n.exports="object"==typeof Reflect&&Reflect.apply||(a?o.bind(i):function(){return o.apply(i,arguments)})},function(n,e,t){"use strict";var a=t(16),r=t(8),i=t(17),o=t(54),s=t(65),l=t(63),c=t(128),p=t(129),d=t(130),m=t(134),u=t(135),h=t(136),g=t(7),v=t(59);n.exports=function(n,e,t,b){var f=b?2:1,y=n.split("."),x=y[y.length-1],k=a.apply(null,y);if(k){var j=k.prototype;if(!v&&r(j,"cause")&&delete j.cause,!t)return k;var S=a("Error"),w=e((function(n,e){var t=d(b?e:n,void 0),a=b?new k(n):new k;return void 0!==t&&i(a,"message",t),h&&i(a,"stack",u(a.stack,2)),this&&o(j,this)&&p(a,this,w),arguments.length>f&&m(a,arguments[f]),a}));if(w.prototype=j,"Error"!==x?s?s(w,S):l(w,S,{name:!0}):g&&"stackTraceLimit"in k&&(c(w,k,"stackTraceLimit"),c(w,k,"prepareStackTrace")),l(w,k),!v)try{j.name!==x&&i(j,"name",x),j.constructor=w}catch(n){}return w}}},function(n,e,t){var a=t(0),r=String,i=TypeError;n.exports=function(n){if("object"==typeof n||a(n))return n;throw i("Can't set "+r(n)+" as a prototype")}},function(n,e,t){var a=t(15).f;n.exports=function(n,e,t){t in n||a(n,t,{configurable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})}},function(n,e,t){var a=t(0),r=t(9),i=t(65);n.exports=function(n,e,t){var o,s;return i&&a(o=e.constructor)&&o!==t&&r(s=o.prototype)&&s!==t.prototype&&i(n,s),n}},function(n,e,t){var a=t(131);n.exports=function(n,e){return void 0===n?arguments.length<2?"":e:a(n)}},function(n,e,t){var a=t(132),r=String;n.exports=function(n){if("Symbol"===a(n))throw TypeError("Cannot convert a Symbol value to a string");return r(n)}},function(n,e,t){var a=t(133),r=t(0),i=t(30),o=t(27)("toStringTag"),s=Object,l="Arguments"==i(function(){return arguments}());n.exports=a?i:function(n){var e,t,a;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(t=function(n,e){try{return n[e]}catch(n){}}(e=s(n),o))?t:l?i(e):"Object"==(a=i(e))&&r(e.callee)?"Arguments":a}},function(n,e,t){var a={};a[t(27)("toStringTag")]="z",n.exports="[object z]"===String(a)},function(n,e,t){var a=t(9),r=t(17);n.exports=function(n,e){a(e)&&"cause"in e&&r(n,"cause",e.cause)}},function(n,e,t){var a=t(1),r=Error,i=a("".replace),o=String(r("zxcasd").stack),s=/\n\s*at [^:]*:[^\n]*/,l=s.test(o);n.exports=function(n,e){if(l&&"string"==typeof n&&!r.prepareStackTrace)for(;e--;)n=i(n,s,"");return n}},function(n,e,t){var a=t(3),r=t(29);n.exports=!a((function(){var n=Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",r(1,7)),7!==n.stack)}))},function(n,e,t){var a=t(66),r=t(138);n.exports=function n(e,t,i,o,s){var l=-1,c=e.length;for(i||(i=r),s||(s=[]);++l<c;){var p=e[l];t>0&&i(p)?t>1?n(p,t-1,i,o,s):a(s,p):o||(s[s.length]=p)}return s}},function(n,e,t){var a=t(14),r=t(33),i=t(4),o=a?a.isConcatSpreadable:void 0;n.exports=function(n){return i(n)||r(n)||!!(o&&n&&n[o])}},function(n,e,t){var a=t(13),r=t(12);n.exports=function(n){return r(n)&&"[object Arguments]"==a(n)}},function(n,e,t){var a=t(14),r=Object.prototype,i=r.hasOwnProperty,o=r.toString,s=a?a.toStringTag:void 0;n.exports=function(n){var e=i.call(n,s),t=n[s];try{n[s]=void 0;var a=!0}catch(n){}var r=o.call(n);return a&&(e?n[s]=t:delete n[s]),r}},function(n,e){var t=Object.prototype.toString;n.exports=function(n){return t.call(n)}},function(n,e,t){var a=t(143),r=t(199),i=t(41),o=t(4),s=t(210);n.exports=function(n){return"function"==typeof n?n:null==n?i:"object"==typeof n?o(n)?r(n[0],n[1]):a(n):s(n)}},function(n,e,t){var a=t(144),r=t(198),i=t(83);n.exports=function(n){var e=r(n);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(t){return t===n||a(t,n,e)}}},function(n,e,t){var a=t(68),r=t(72);n.exports=function(n,e,t,i){var o=t.length,s=o,l=!i;if(null==n)return!s;for(n=Object(n);o--;){var c=t[o];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++o<s;){var p=(c=t[o])[0],d=n[p],m=c[1];if(l&&c[2]){if(void 0===d&&!(p in n))return!1}else{var u=new a;if(i)var h=i(d,m,p,n,e,u);if(!(void 0===h?r(m,d,3,i,u):h))return!1}}return!0}},function(n,e){n.exports=function(){this.__data__=[],this.size=0}},function(n,e,t){var a=t(19),r=Array.prototype.splice;n.exports=function(n){var e=this.__data__,t=a(e,n);return!(t<0)&&(t==e.length-1?e.pop():r.call(e,t,1),--this.size,!0)}},function(n,e,t){var a=t(19);n.exports=function(n){var e=this.__data__,t=a(e,n);return t<0?void 0:e[t][1]}},function(n,e,t){var a=t(19);n.exports=function(n){return a(this.__data__,n)>-1}},function(n,e,t){var a=t(19);n.exports=function(n,e){var t=this.__data__,r=a(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}},function(n,e,t){var a=t(18);n.exports=function(){this.__data__=new a,this.size=0}},function(n,e){n.exports=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}},function(n,e){n.exports=function(n){return this.__data__.get(n)}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e,t){var a=t(18),r=t(34),i=t(36);n.exports=function(n,e){var t=this.__data__;if(t instanceof a){var o=t.__data__;if(!r||o.length<199)return o.push([n,e]),this.size=++t.size,this;t=this.__data__=new i(o)}return t.set(n,e),this.size=t.size,this}},function(n,e,t){var a=t(70),r=t(156),i=t(35),o=t(71),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,p=l.toString,d=c.hasOwnProperty,m=RegExp("^"+p.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!i(n)||r(n))&&(a(n)?m:s).test(o(n))}},function(n,e,t){var a,r=t(157),i=(a=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";n.exports=function(n){return!!i&&i in n}},function(n,e,t){var a=t(5)["__core-js_shared__"];n.exports=a},function(n,e){n.exports=function(n,e){return null==n?void 0:n[e]}},function(n,e,t){var a=t(160),r=t(18),i=t(34);n.exports=function(){this.size=0,this.__data__={hash:new a,map:new(i||r),string:new a}}},function(n,e,t){var a=t(161),r=t(162),i=t(163),o=t(164),s=t(165);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var a=n[e];this.set(a[0],a[1])}}l.prototype.clear=a,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=o,l.prototype.set=s,n.exports=l},function(n,e,t){var a=t(20);n.exports=function(){this.__data__=a?a(null):{},this.size=0}},function(n,e){n.exports=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}},function(n,e,t){var a=t(20),r=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;if(a){var t=e[n];return"__lodash_hash_undefined__"===t?void 0:t}return r.call(e,n)?e[n]:void 0}},function(n,e,t){var a=t(20),r=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;return a?void 0!==e[n]:r.call(e,n)}},function(n,e,t){var a=t(20);n.exports=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=a&&void 0===e?"__lodash_hash_undefined__":e,this}},function(n,e,t){var a=t(21);n.exports=function(n){var e=a(this,n).delete(n);return this.size-=e?1:0,e}},function(n,e){n.exports=function(n){var e=typeof n;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n}},function(n,e,t){var a=t(21);n.exports=function(n){return a(this,n).get(n)}},function(n,e,t){var a=t(21);n.exports=function(n){return a(this,n).has(n)}},function(n,e,t){var a=t(21);n.exports=function(n,e){var t=a(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}},function(n,e,t){var a=t(68),r=t(73),i=t(175),o=t(178),s=t(194),l=t(4),c=t(77),p=t(79),d="[object Object]",m=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,u,h,g){var v=l(n),b=l(e),f=v?"[object Array]":s(n),y=b?"[object Array]":s(e),x=(f="[object Arguments]"==f?d:f)==d,k=(y="[object Arguments]"==y?d:y)==d,j=f==y;if(j&&c(n)){if(!c(e))return!1;v=!0,x=!1}if(j&&!x)return g||(g=new a),v||p(n)?r(n,e,t,u,h,g):i(n,e,f,t,u,h,g);if(!(1&t)){var S=x&&m.call(n,"__wrapped__"),w=k&&m.call(e,"__wrapped__");if(S||w){var T=S?n.value():n,I=w?e.value():e;return g||(g=new a),h(T,I,t,u,g)}}return!!j&&(g||(g=new a),o(n,e,t,u,h,g))}},function(n,e){n.exports=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e){n.exports=function(n,e){for(var t=-1,a=null==n?0:n.length;++t<a;)if(e(n[t],t,n))return!0;return!1}},function(n,e,t){var a=t(14),r=t(176),i=t(69),o=t(73),s=t(177),l=t(37),c=a?a.prototype:void 0,p=c?c.valueOf:void 0;n.exports=function(n,e,t,a,c,d,m){switch(t){case"[object DataView]":if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=e.byteLength||!d(new r(n),new r(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+n,+e);case"[object Error]":return n.name==e.name&&n.message==e.message;case"[object RegExp]":case"[object String]":return n==e+"";case"[object Map]":var u=s;case"[object Set]":var h=1&a;if(u||(u=l),n.size!=e.size&&!h)return!1;var g=m.get(n);if(g)return g==e;a|=2,m.set(n,e);var v=o(u(n),u(e),a,c,d,m);return m.delete(n),v;case"[object Symbol]":if(p)return p.call(n)==p.call(e)}return!1}},function(n,e,t){var a=t(5).Uint8Array;n.exports=a},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n,a){t[++e]=[a,n]})),t}},function(n,e,t){var a=t(179),r=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,i,o,s){var l=1&t,c=a(n),p=c.length;if(p!=a(e).length&&!l)return!1;for(var d=p;d--;){var m=c[d];if(!(l?m in e:r.call(e,m)))return!1}var u=s.get(n),h=s.get(e);if(u&&h)return u==e&&h==n;var g=!0;s.set(n,e),s.set(e,n);for(var v=l;++d<p;){var b=n[m=c[d]],f=e[m];if(i)var y=l?i(f,b,m,e,n,s):i(b,f,m,n,e,s);if(!(void 0===y?b===f||o(b,f,t,i,s):y)){g=!1;break}v||(v="constructor"==m)}if(g&&!v){var x=n.constructor,k=e.constructor;x==k||!("constructor"in n)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof k&&k instanceof k||(g=!1)}return s.delete(n),s.delete(e),g}},function(n,e,t){var a=t(180),r=t(181),i=t(76);n.exports=function(n){return a(n,i,r)}},function(n,e,t){var a=t(66),r=t(4);n.exports=function(n,e,t){var i=e(n);return r(n)?i:a(i,t(n))}},function(n,e,t){var a=t(182),r=t(183),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(n){return null==n?[]:(n=Object(n),a(o(n),(function(e){return i.call(n,e)})))}:r;n.exports=s},function(n,e){n.exports=function(n,e){for(var t=-1,a=null==n?0:n.length,r=0,i=[];++t<a;){var o=n[t];e(o,t,n)&&(i[r++]=o)}return i}},function(n,e){n.exports=function(){return[]}},function(n,e,t){var a=t(185),r=t(33),i=t(4),o=t(77),s=t(78),l=t(79),c=Object.prototype.hasOwnProperty;n.exports=function(n,e){var t=i(n),p=!t&&r(n),d=!t&&!p&&o(n),m=!t&&!p&&!d&&l(n),u=t||p||d||m,h=u?a(n.length,String):[],g=h.length;for(var v in n)!e&&!c.call(n,v)||u&&("length"==v||d&&("offset"==v||"parent"==v)||m&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,g))||h.push(v);return h}},function(n,e){n.exports=function(n,e){for(var t=-1,a=Array(n);++t<n;)a[t]=e(t);return a}},function(n,e){n.exports=function(){return!1}},function(n,e,t){var a=t(13),r=t(38),i=t(12),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,n.exports=function(n){return i(n)&&r(n.length)&&!!o[a(n)]}},function(n,e){n.exports=function(n){return function(e){return n(e)}}},function(n,e,t){(function(n){var a=t(67),r=e&&!e.nodeType&&e,i=r&&"object"==typeof n&&n&&!n.nodeType&&n,o=i&&i.exports===r&&a.process,s=function(){try{var n=i&&i.require&&i.require("util").types;return n||o&&o.binding&&o.binding("util")}catch(n){}}();n.exports=s}).call(this,t(48)(n))},function(n,e,t){var a=t(191),r=t(192),i=Object.prototype.hasOwnProperty;n.exports=function(n){if(!a(n))return r(n);var e=[];for(var t in Object(n))i.call(n,t)&&"constructor"!=t&&e.push(t);return e}},function(n,e){var t=Object.prototype;n.exports=function(n){var e=n&&n.constructor;return n===("function"==typeof e&&e.prototype||t)}},function(n,e,t){var a=t(193)(Object.keys,Object);n.exports=a},function(n,e){n.exports=function(n,e){return function(t){return n(e(t))}}},function(n,e,t){var a=t(195),r=t(34),i=t(196),o=t(81),s=t(197),l=t(13),c=t(71),p=c(a),d=c(r),m=c(i),u=c(o),h=c(s),g=l;(a&&"[object DataView]"!=g(new a(new ArrayBuffer(1)))||r&&"[object Map]"!=g(new r)||i&&"[object Promise]"!=g(i.resolve())||o&&"[object Set]"!=g(new o)||s&&"[object WeakMap]"!=g(new s))&&(g=function(n){var e=l(n),t="[object Object]"==e?n.constructor:void 0,a=t?c(t):"";if(a)switch(a){case p:return"[object DataView]";case d:return"[object Map]";case m:return"[object Promise]";case u:return"[object Set]";case h:return"[object WeakMap]"}return e}),n.exports=g},function(n,e,t){var a=t(10)(t(5),"DataView");n.exports=a},function(n,e,t){var a=t(10)(t(5),"Promise");n.exports=a},function(n,e,t){var a=t(10)(t(5),"WeakMap");n.exports=a},function(n,e,t){var a=t(82),r=t(76);n.exports=function(n){for(var e=r(n),t=e.length;t--;){var i=e[t],o=n[i];e[t]=[i,o,a(o)]}return e}},function(n,e,t){var a=t(72),r=t(200),i=t(207),o=t(39),s=t(82),l=t(83),c=t(22);n.exports=function(n,e){return o(n)&&s(e)?l(c(n),e):function(t){var o=r(t,n);return void 0===o&&o===e?i(t,n):a(e,o,3)}}},function(n,e,t){var a=t(84);n.exports=function(n,e,t){var r=null==n?void 0:a(n,e);return void 0===r?t:r}},function(n,e,t){var a=t(202),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=a((function(n){var e=[];return 46===n.charCodeAt(0)&&e.push(""),n.replace(r,(function(n,t,a,r){e.push(a?r.replace(i,"$1"):t||n)})),e}));n.exports=o},function(n,e,t){var a=t(203);n.exports=function(n){var e=a(n,(function(n){return 500===t.size&&t.clear(),n})),t=e.cache;return e}},function(n,e,t){var a=t(36);function r(n,e){if("function"!=typeof n||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var t=function(){var a=arguments,r=e?e.apply(this,a):a[0],i=t.cache;if(i.has(r))return i.get(r);var o=n.apply(this,a);return t.cache=i.set(r,o)||i,o};return t.cache=new(r.Cache||a),t}r.Cache=a,n.exports=r},function(n,e,t){var a=t(205);n.exports=function(n){return null==n?"":a(n)}},function(n,e,t){var a=t(14),r=t(206),i=t(4),o=t(40),s=a?a.prototype:void 0,l=s?s.toString:void 0;n.exports=function n(e){if("string"==typeof e)return e;if(i(e))return r(e,n)+"";if(o(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(n,e){n.exports=function(n,e){for(var t=-1,a=null==n?0:n.length,r=Array(a);++t<a;)r[t]=e(n[t],t,n);return r}},function(n,e,t){var a=t(208),r=t(209);n.exports=function(n,e){return null!=n&&r(n,e,a)}},function(n,e){n.exports=function(n,e){return null!=n&&e in Object(n)}},function(n,e,t){var a=t(85),r=t(33),i=t(4),o=t(78),s=t(38),l=t(22);n.exports=function(n,e,t){for(var c=-1,p=(e=a(e,n)).length,d=!1;++c<p;){var m=l(e[c]);if(!(d=null!=n&&t(n,m)))break;n=n[m]}return d||++c!=p?d:!!(p=null==n?0:n.length)&&s(p)&&o(m,p)&&(i(n)||r(n))}},function(n,e,t){var a=t(211),r=t(212),i=t(39),o=t(22);n.exports=function(n){return i(n)?a(o(n)):r(n)}},function(n,e){n.exports=function(n){return function(e){return null==e?void 0:e[n]}}},function(n,e,t){var a=t(84);n.exports=function(n){return function(e){return a(e,n)}}},function(n,e,t){var a=t(41),r=t(214),i=t(216);n.exports=function(n,e){return i(r(n,e,a),n+"")}},function(n,e,t){var a=t(215),r=Math.max;n.exports=function(n,e,t){return e=r(void 0===e?n.length-1:e,0),function(){for(var i=arguments,o=-1,s=r(i.length-e,0),l=Array(s);++o<s;)l[o]=i[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=i[o];return c[e]=t(l),a(n,this,c)}}},function(n,e){n.exports=function(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}},function(n,e,t){var a=t(217),r=t(220)(a);n.exports=r},function(n,e,t){var a=t(218),r=t(219),i=t(41),o=r?function(n,e){return r(n,"toString",{configurable:!0,enumerable:!1,value:a(e),writable:!0})}:i;n.exports=o},function(n,e){n.exports=function(n){return function(){return n}}},function(n,e,t){var a=t(10),r=function(){try{var n=a(Object,"defineProperty");return n({},"",{}),n}catch(n){}}();n.exports=r},function(n,e){var t=Date.now;n.exports=function(n){var e=0,a=0;return function(){var r=t(),i=16-(r-a);if(a=r,i>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}},function(n,e,t){var a=t(74),r=t(222),i=t(227),o=t(75),s=t(228),l=t(37);n.exports=function(n,e,t){var c=-1,p=r,d=n.length,m=!0,u=[],h=u;if(t)m=!1,p=i;else if(d>=200){var g=e?null:s(n);if(g)return l(g);m=!1,p=o,h=new a}else h=e?[]:u;n:for(;++c<d;){var v=n[c],b=e?e(v):v;if(v=t||0!==v?v:0,m&&b==b){for(var f=h.length;f--;)if(h[f]===b)continue n;e&&h.push(b),u.push(v)}else p(h,b,t)||(h!==u&&h.push(b),u.push(v))}return u}},function(n,e,t){var a=t(223);n.exports=function(n,e){return!!(null==n?0:n.length)&&a(n,e,0)>-1}},function(n,e,t){var a=t(224),r=t(225),i=t(226);n.exports=function(n,e,t){return e==e?i(n,e,t):a(n,r,t)}},function(n,e){n.exports=function(n,e,t,a){for(var r=n.length,i=t+(a?1:-1);a?i--:++i<r;)if(e(n[i],i,n))return i;return-1}},function(n,e){n.exports=function(n){return n!=n}},function(n,e){n.exports=function(n,e,t){for(var a=t-1,r=n.length;++a<r;)if(n[a]===e)return a;return-1}},function(n,e){n.exports=function(n,e,t){for(var a=-1,r=null==n?0:n.length;++a<r;)if(t(e,n[a]))return!0;return!1}},function(n,e,t){var a=t(81),r=t(229),i=t(37),o=a&&1/i(new a([,-0]))[1]==1/0?function(n){return new a(n)}:r;n.exports=o},function(n,e){n.exports=function(){}},function(n,e,t){var a=t(80),r=t(12);n.exports=function(n){return r(n)&&a(n)}},function(n,e,t){},function(n,e,t){},function(n,e,t){"use strict";t(86)},function(n,e,t){"use strict";t(87)},function(n,e,t){},function(n,e,t){},function(n,e,t){"use strict";t(88)},function(n,e,t){"use strict";t(89)},function(n,e,t){"use strict";t.r(e);
/*!
 * Vue.js v2.7.4
 * (c) 2014-2022 Evan You
 * Released under the MIT License.
 */
var a=Object.freeze({}),r=Array.isArray;function i(n){return null==n}function o(n){return null!=n}function s(n){return!0===n}function l(n){return"string"==typeof n||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n}function c(n){return"function"==typeof n}function p(n){return null!==n&&"object"==typeof n}var d=Object.prototype.toString;function m(n){return"[object Object]"===d.call(n)}function u(n){return"[object RegExp]"===d.call(n)}function h(n){var e=parseFloat(String(n));return e>=0&&Math.floor(e)===e&&isFinite(n)}function g(n){return o(n)&&"function"==typeof n.then&&"function"==typeof n.catch}function v(n){return null==n?"":Array.isArray(n)||m(n)&&n.toString===d?JSON.stringify(n,null,2):String(n)}function b(n){var e=parseFloat(n);return isNaN(e)?n:e}function f(n,e){for(var t=Object.create(null),a=n.split(","),r=0;r<a.length;r++)t[a[r]]=!0;return e?function(n){return t[n.toLowerCase()]}:function(n){return t[n]}}f("slot,component",!0);var y=f("key,ref,slot,slot-scope,is");function x(n,e){if(n.length){var t=n.indexOf(e);if(t>-1)return n.splice(t,1)}}var k=Object.prototype.hasOwnProperty;function j(n,e){return k.call(n,e)}function S(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var w=/-(\w)/g,T=S((function(n){return n.replace(w,(function(n,e){return e?e.toUpperCase():""}))})),I=S((function(n){return n.charAt(0).toUpperCase()+n.slice(1)})),C=/\B([A-Z])/g,M=S((function(n){return n.replace(C,"-$1").toLowerCase()}));var E=Function.prototype.bind?function(n,e){return n.bind(e)}:function(n,e){function t(t){var a=arguments.length;return a?a>1?n.apply(e,arguments):n.call(e,t):n.call(e)}return t._length=n.length,t};function P(n,e){e=e||0;for(var t=n.length-e,a=new Array(t);t--;)a[t]=n[t+e];return a}function z(n,e){for(var t in e)n[t]=e[t];return n}function A(n){for(var e={},t=0;t<n.length;t++)n[t]&&z(e,n[t]);return e}function q(n,e,t){}var J=function(n,e,t){return!1},L=function(n){return n};function R(n,e){if(n===e)return!0;var t=p(n),a=p(e);if(!t||!a)return!t&&!a&&String(n)===String(e);try{var r=Array.isArray(n),i=Array.isArray(e);if(r&&i)return n.length===e.length&&n.every((function(n,t){return R(n,e[t])}));if(n instanceof Date&&e instanceof Date)return n.getTime()===e.getTime();if(r||i)return!1;var o=Object.keys(n),s=Object.keys(e);return o.length===s.length&&o.every((function(t){return R(n[t],e[t])}))}catch(n){return!1}}function _(n,e){for(var t=0;t<n.length;t++)if(R(n[t],e))return t;return-1}function O(n){var e=!1;return function(){e||(e=!0,n.apply(this,arguments))}}function B(n,e){return n===e?0===n&&1/n!=1/e:n==n||e==e}var D=["component","directive","filter"],H=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],F={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:J,isReservedAttr:J,isUnknownElement:J,getTagNamespace:q,parsePlatformTagName:L,mustUseProp:J,async:!0,_lifecycleHooks:H},N=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function U(n){var e=(n+"").charCodeAt(0);return 36===e||95===e}function $(n,e,t,a){Object.defineProperty(n,e,{value:t,enumerable:!!a,writable:!0,configurable:!0})}var W=new RegExp("[^".concat(N.source,".$_\\d]"));var Q="__proto__"in{},G="undefined"!=typeof window,V=G&&window.navigator.userAgent.toLowerCase(),K=V&&/msie|trident/.test(V),X=V&&V.indexOf("msie 9.0")>0,Z=V&&V.indexOf("edge/")>0;V&&V.indexOf("android");var Y=V&&/iphone|ipad|ipod|ios/.test(V);V&&/chrome\/\d+/.test(V),V&&/phantomjs/.test(V);var nn,en=V&&V.match(/firefox\/(\d+)/),tn={}.watch,an=!1;if(G)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){an=!0}}),window.addEventListener("test-passive",null,rn)}catch(n){}var on=function(){return void 0===nn&&(nn=!G&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),nn},sn=G&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ln(n){return"function"==typeof n&&/native code/.test(n.toString())}var cn,pn="undefined"!=typeof Symbol&&ln(Symbol)&&"undefined"!=typeof Reflect&&ln(Reflect.ownKeys);cn="undefined"!=typeof Set&&ln(Set)?Set:function(){function n(){this.set=Object.create(null)}return n.prototype.has=function(n){return!0===this.set[n]},n.prototype.add=function(n){this.set[n]=!0},n.prototype.clear=function(){this.set=Object.create(null)},n}();var dn=null;function mn(n){void 0===n&&(n=null),n||dn&&dn._scope.off(),dn=n,n&&n._scope.on()}var un=q,hn=0,gn=function(){function n(){this.id=hn++,this.subs=[]}return n.prototype.addSub=function(n){this.subs.push(n)},n.prototype.removeSub=function(n){x(this.subs,n)},n.prototype.depend=function(e){n.target&&n.target.addDep(this)},n.prototype.notify=function(n){var e=this.subs.slice();for(var t=0,a=e.length;t<a;t++){e[t].update()}},n}();gn.target=null;var vn=[];function bn(n){vn.push(n),gn.target=n}function fn(){vn.pop(),gn.target=vn[vn.length-1]}var yn=function(){function n(n,e,t,a,r,i,o,s){this.tag=n,this.data=e,this.children=t,this.text=a,this.elm=r,this.ns=void 0,this.context=i,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(n.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),n}(),xn=function(n){void 0===n&&(n="");var e=new yn;return e.text=n,e.isComment=!0,e};function kn(n){return new yn(void 0,void 0,void 0,String(n))}function jn(n){var e=new yn(n.tag,n.data,n.children&&n.children.slice(),n.text,n.elm,n.context,n.componentOptions,n.asyncFactory);return e.ns=n.ns,e.isStatic=n.isStatic,e.key=n.key,e.isComment=n.isComment,e.fnContext=n.fnContext,e.fnOptions=n.fnOptions,e.fnScopeId=n.fnScopeId,e.asyncMeta=n.asyncMeta,e.isCloned=!0,e}var Sn=Array.prototype,wn=Object.create(Sn);function Tn(n){return In(n,!0),$(n,"__v_isShallow",!0),n}function In(n,e){if(!Cn(n)){gt(n,e,on());0}}function Cn(n){return!(!n||!n.__v_isReadonly)}["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(n){var e=Sn[n];$(wn,n,(function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r,i=e.apply(this,t),o=this.__ob__;switch(n){case"push":case"unshift":r=t;break;case"splice":r=t.slice(2)}return r&&o.observeArray(r),o.dep.notify(),i}))}));function Mn(n){return!(!n||!0!==n.__v_isRef)}function En(n,e,t){Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:function(){return function(n){return Mn(n)?n.value:n}(e[t])},set:function(n){var a=e[t];Mn(a)&&!Mn(n)?a.value=n:e[t]=n}})}var Pn=new cn;function zn(n){return function n(e,t){var a,i,o=r(e);if(!o&&!p(e)||Object.isFrozen(e)||e instanceof yn)return;if(e.__ob__){var s=e.__ob__.dep.id;if(t.has(s))return;t.add(s)}if(o)for(a=e.length;a--;)n(e[a],t);else for(i=Object.keys(e),a=i.length;a--;)n(e[i[a]],t)}(n,Pn),Pn.clear(),n}var An=S((function(n){var e="&"===n.charAt(0),t="~"===(n=e?n.slice(1):n).charAt(0),a="!"===(n=t?n.slice(1):n).charAt(0);return{name:n=a?n.slice(1):n,once:t,capture:a,passive:e}}));function qn(n,e){function t(){var n=t.fns;if(!r(n))return Ve(n,null,arguments,e,"v-on handler");for(var a=n.slice(),i=0;i<a.length;i++)Ve(a[i],null,arguments,e,"v-on handler")}return t.fns=n,t}function Jn(n,e,t,a,r,o){var l,c,p,d;for(l in n)c=n[l],p=e[l],d=An(l),i(c)||(i(p)?(i(c.fns)&&(c=n[l]=qn(c,o)),s(d.once)&&(c=n[l]=r(d.name,c,d.capture)),t(d.name,c,d.capture,d.passive,d.params)):c!==p&&(p.fns=c,n[l]=p));for(l in e)i(n[l])&&a((d=An(l)).name,e[l],d.capture)}function Ln(n,e,t){var a;n instanceof yn&&(n=n.data.hook||(n.data.hook={}));var r=n[e];function l(){t.apply(this,arguments),x(a.fns,l)}i(r)?a=qn([l]):o(r.fns)&&s(r.merged)?(a=r).fns.push(l):a=qn([r,l]),a.merged=!0,n[e]=a}function Rn(n,e,t,a,r){if(o(e)){if(j(e,t))return n[t]=e[t],r||delete e[t],!0;if(j(e,a))return n[t]=e[a],r||delete e[a],!0}return!1}function _n(n){return l(n)?[kn(n)]:r(n)?function n(e,t){var a,c,p,d,m=[];for(a=0;a<e.length;a++)i(c=e[a])||"boolean"==typeof c||(p=m.length-1,d=m[p],r(c)?c.length>0&&(On((c=n(c,"".concat(t||"","_").concat(a)))[0])&&On(d)&&(m[p]=kn(d.text+c[0].text),c.shift()),m.push.apply(m,c)):l(c)?On(d)?m[p]=kn(d.text+c):""!==c&&m.push(kn(c)):On(c)&&On(d)?m[p]=kn(d.text+c.text):(s(e._isVList)&&o(c.tag)&&i(c.key)&&o(t)&&(c.key="__vlist".concat(t,"_").concat(a,"__")),m.push(c)));return m}(n):void 0}function On(n){return o(n)&&o(n.text)&&!1===n.isComment}function Bn(n,e){if(dn){var t=dn._provided,a=dn.$parent&&dn.$parent._provided;a===t&&(t=dn._provided=Object.create(a)),t[n]=e}else 0}function Dn(n,e){if(n){for(var t=Object.create(null),a=pn?Reflect.ownKeys(n):Object.keys(n),r=0;r<a.length;r++){var i=a[r];if("__ob__"!==i){var o=n[i].from;if(o in e._provided)t[i]=e._provided[o];else if("default"in n[i]){var s=n[i].default;t[i]=c(s)?s.call(e):s}else 0}}return t}}function Hn(n,e){if(!n||!n.length)return{};for(var t={},a=0,r=n.length;a<r;a++){var i=n[a],o=i.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,i.context!==e&&i.fnContext!==e||!o||null==o.slot)(t.default||(t.default=[])).push(i);else{var s=o.slot,l=t[s]||(t[s]=[]);"template"===i.tag?l.push.apply(l,i.children||[]):l.push(i)}}for(var c in t)t[c].every(Fn)&&delete t[c];return t}function Fn(n){return n.isComment&&!n.asyncFactory||" "===n.text}function Nn(n){return n.isComment&&n.asyncFactory}function Un(n,e,t,r){var i,o=Object.keys(t).length>0,s=e?!!e.$stable:!o,l=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(s&&r&&r!==a&&l===r.$key&&!o&&!r.$hasNormal)return r;for(var c in i={},e)e[c]&&"$"!==c[0]&&(i[c]=$n(n,t,c,e[c]))}else i={};for(var p in t)p in i||(i[p]=Wn(t,p));return e&&Object.isExtensible(e)&&(e._normalized=i),$(i,"$stable",s),$(i,"$key",l),$(i,"$hasNormal",o),i}function $n(n,e,t,a){var i=function(){var e=dn;mn(n);var t=arguments.length?a.apply(null,arguments):a({}),i=(t=t&&"object"==typeof t&&!r(t)?[t]:_n(t))&&t[0];return mn(e),t&&(!i||1===t.length&&i.isComment&&!Nn(i))?void 0:t};return a.proxy&&Object.defineProperty(e,t,{get:i,enumerable:!0,configurable:!0}),i}function Wn(n,e){return function(){return n[e]}}function Qn(n,e){var t,a,i,s,l=null;if(r(n)||"string"==typeof n)for(l=new Array(n.length),t=0,a=n.length;t<a;t++)l[t]=e(n[t],t);else if("number"==typeof n)for(l=new Array(n),t=0;t<n;t++)l[t]=e(t+1,t);else if(p(n))if(pn&&n[Symbol.iterator]){l=[];for(var c=n[Symbol.iterator](),d=c.next();!d.done;)l.push(e(d.value,l.length)),d=c.next()}else for(i=Object.keys(n),l=new Array(i.length),t=0,a=i.length;t<a;t++)s=i[t],l[t]=e(n[s],s,t);return o(l)||(l=[]),l._isVList=!0,l}function Gn(n,e,t,a){var r,i=this.$scopedSlots[n];i?(t=t||{},a&&(t=z(z({},a),t)),r=i(t)||(c(e)?e():e)):r=this.$slots[n]||(c(e)?e():e);var o=t&&t.slot;return o?this.$createElement("template",{slot:o},r):r}function Vn(n){return Ct(this.$options,"filters",n,!0)||L}function Kn(n,e){return r(n)?-1===n.indexOf(e):n!==e}function Xn(n,e,t,a,r){var i=F.keyCodes[e]||t;return r&&a&&!F.keyCodes[e]?Kn(r,a):i?Kn(i,n):a?M(a)!==e:void 0===n}function Zn(n,e,t,a,i){if(t)if(p(t)){r(t)&&(t=A(t));var o=void 0,s=function(r){if("class"===r||"style"===r||y(r))o=n;else{var s=n.attrs&&n.attrs.type;o=a||F.mustUseProp(e,s,r)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={})}var l=T(r),c=M(r);l in o||c in o||(o[r]=t[r],i&&((n.on||(n.on={}))["update:".concat(r)]=function(n){t[r]=n}))};for(var l in t)s(l)}else;return n}function Yn(n,e){var t=this._staticTrees||(this._staticTrees=[]),a=t[n];return a&&!e||ee(a=t[n]=this.$options.staticRenderFns[n].call(this._renderProxy,this._c,this),"__static__".concat(n),!1),a}function ne(n,e,t){return ee(n,"__once__".concat(e).concat(t?"_".concat(t):""),!0),n}function ee(n,e,t){if(r(n))for(var a=0;a<n.length;a++)n[a]&&"string"!=typeof n[a]&&te(n[a],"".concat(e,"_").concat(a),t);else te(n,e,t)}function te(n,e,t){n.isStatic=!0,n.key=e,n.isOnce=t}function ae(n,e){if(e)if(m(e)){var t=n.on=n.on?z({},n.on):{};for(var a in e){var r=t[a],i=e[a];t[a]=r?[].concat(r,i):i}}else;return n}function re(n,e,t,a){e=e||{$stable:!t};for(var i=0;i<n.length;i++){var o=n[i];r(o)?re(o,e,t):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return a&&(e.$key=a),e}function ie(n,e){for(var t=0;t<e.length;t+=2){var a=e[t];"string"==typeof a&&a&&(n[e[t]]=e[t+1])}return n}function oe(n,e){return"string"==typeof n?e+n:n}function se(n){n._o=ne,n._n=b,n._s=v,n._l=Qn,n._t=Gn,n._q=R,n._i=_,n._m=Yn,n._f=Vn,n._k=Xn,n._b=Zn,n._v=kn,n._e=xn,n._u=re,n._g=ae,n._d=ie,n._p=oe}function le(n,e,t,i,o){var l,c=this,p=o.options;j(i,"_uid")?(l=Object.create(i))._original=i:(l=i,i=i._original);var d=s(p._compiled),m=!d;this.data=n,this.props=e,this.children=t,this.parent=i,this.listeners=n.on||a,this.injections=Dn(p.inject,i),this.slots=function(){return c.$slots||Un(i,n.scopedSlots,c.$slots=Hn(t,i)),c.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Un(i,n.scopedSlots,this.slots())}}),d&&(this.$options=p,this.$slots=this.slots(),this.$scopedSlots=Un(i,n.scopedSlots,this.$slots)),p._scopeId?this._c=function(n,e,t,a){var o=ge(l,n,e,t,a,m);return o&&!r(o)&&(o.fnScopeId=p._scopeId,o.fnContext=i),o}:this._c=function(n,e,t,a){return ge(l,n,e,t,a,m)}}function ce(n,e,t,a,r){var i=jn(n);return i.fnContext=t,i.fnOptions=a,e.slot&&((i.data||(i.data={})).slot=e.slot),i}function pe(n,e){for(var t in e)n[T(t)]=e[t]}se(le.prototype);var de={init:function(n,e){if(n.componentInstance&&!n.componentInstance._isDestroyed&&n.data.keepAlive){var t=n;de.prepatch(t,t)}else{(n.componentInstance=function(n,e){var t={_isComponent:!0,_parentVnode:n,parent:e},a=n.data.inlineTemplate;o(a)&&(t.render=a.render,t.staticRenderFns=a.staticRenderFns);return new n.componentOptions.Ctor(t)}(n,Me)).$mount(e?n.elm:void 0,e)}},prepatch:function(n,e){var t=e.componentOptions;!function(n,e,t,r,i){0;var o=r.data.scopedSlots,s=n.$scopedSlots,l=!!(o&&!o.$stable||s!==a&&!s.$stable||o&&n.$scopedSlots.$key!==o.$key||!o&&n.$scopedSlots.$key),c=!!(i||n.$options._renderChildren||l),p=n.$vnode;n.$options._parentVnode=r,n.$vnode=r,n._vnode&&(n._vnode.parent=r);n.$options._renderChildren=i;var d=r.data.attrs||a;n._attrsProxy&&be(n._attrsProxy,d,p.data&&p.data.attrs||a,n)&&(c=!0);if(n.$attrs=d,n.$listeners=t||a,e&&n.$options.props){mt(!1);for(var m=n._props,u=n.$options._propKeys||[],h=0;h<u.length;h++){var g=u[h],v=n.$options.props;m[g]=Mt(g,v,e,n)}mt(!0),n.$options.propsData=e}t=t||a;var b=n.$options._parentListeners;n.$options._parentListeners=t,Ce(n,t,b),c&&(n.$slots=Hn(i,r.context),n.$forceUpdate());0}(e.componentInstance=n.componentInstance,t.propsData,t.listeners,e,t.children)},insert:function(n){var e,t=n.context,a=n.componentInstance;a._isMounted||(a._isMounted=!0,Ae(a,"mounted")),n.data.keepAlive&&(t._isMounted?((e=a)._inactive=!1,Je.push(e)):ze(a,!0))},destroy:function(n){var e=n.componentInstance;e._isDestroyed||(n.data.keepAlive?function n(e,t){if(t&&(e._directInactive=!0,Pe(e)))return;if(!e._inactive){e._inactive=!0;for(var a=0;a<e.$children.length;a++)n(e.$children[a]);Ae(e,"deactivated")}}(e,!0):e.$destroy())}},me=Object.keys(de);function ue(n,e,t,l,c){if(!i(n)){var d=t.$options._base;if(p(n)&&(n=d.extend(n)),"function"==typeof n){var m;if(i(n.cid)&&void 0===(n=function(n,e){if(s(n.error)&&o(n.errorComp))return n.errorComp;if(o(n.resolved))return n.resolved;var t=ke;t&&o(n.owners)&&-1===n.owners.indexOf(t)&&n.owners.push(t);if(s(n.loading)&&o(n.loadingComp))return n.loadingComp;if(t&&!o(n.owners)){var a=n.owners=[t],r=!0,l=null,c=null;t.$on("hook:destroyed",(function(){return x(a,t)}));var d=function(n){for(var e=0,t=a.length;e<t;e++)a[e].$forceUpdate();n&&(a.length=0,null!==l&&(clearTimeout(l),l=null),null!==c&&(clearTimeout(c),c=null))},m=O((function(t){n.resolved=je(t,e),r?a.length=0:d(!0)})),u=O((function(e){o(n.errorComp)&&(n.error=!0,d(!0))})),h=n(m,u);return p(h)&&(g(h)?i(n.resolved)&&h.then(m,u):g(h.component)&&(h.component.then(m,u),o(h.error)&&(n.errorComp=je(h.error,e)),o(h.loading)&&(n.loadingComp=je(h.loading,e),0===h.delay?n.loading=!0:l=setTimeout((function(){l=null,i(n.resolved)&&i(n.error)&&(n.loading=!0,d(!1))}),h.delay||200)),o(h.timeout)&&(c=setTimeout((function(){c=null,i(n.resolved)&&u(null)}),h.timeout)))),r=!1,n.loading?n.loadingComp:n.resolved}}(m=n,d)))return function(n,e,t,a,r){var i=xn();return i.asyncFactory=n,i.asyncMeta={data:e,context:t,children:a,tag:r},i}(m,e,t,l,c);e=e||{},Ft(n),o(e.model)&&function(n,e){var t=n.model&&n.model.prop||"value",a=n.model&&n.model.event||"input";(e.attrs||(e.attrs={}))[t]=e.model.value;var i=e.on||(e.on={}),s=i[a],l=e.model.callback;o(s)?(r(s)?-1===s.indexOf(l):s!==l)&&(i[a]=[l].concat(s)):i[a]=l}(n.options,e);var u=function(n,e,t){var a=e.options.props;if(!i(a)){var r={},s=n.attrs,l=n.props;if(o(s)||o(l))for(var c in a){var p=M(c);Rn(r,l,c,p,!0)||Rn(r,s,c,p,!1)}return r}}(e,n);if(s(n.options.functional))return function(n,e,t,i,s){var l=n.options,c={},p=l.props;if(o(p))for(var d in p)c[d]=Mt(d,p,e||a);else o(t.attrs)&&pe(c,t.attrs),o(t.props)&&pe(c,t.props);var m=new le(t,c,s,i,n),u=l.render.call(null,m._c,m);if(u instanceof yn)return ce(u,t,m.parent,l,m);if(r(u)){for(var h=_n(u)||[],g=new Array(h.length),v=0;v<h.length;v++)g[v]=ce(h[v],t,m.parent,l,m);return g}}(n,u,e,t,l);var h=e.on;if(e.on=e.nativeOn,s(n.options.abstract)){var v=e.slot;e={},v&&(e.slot=v)}!function(n){for(var e=n.hook||(n.hook={}),t=0;t<me.length;t++){var a=me[t],r=e[a],i=de[a];r===i||r&&r._merged||(e[a]=r?he(i,r):i)}}(e);var b=n.options.name||c;return new yn("vue-component-".concat(n.cid).concat(b?"-".concat(b):""),e,void 0,void 0,void 0,t,{Ctor:n,propsData:u,listeners:h,tag:c,children:l},m)}}}function he(n,e){var t=function(t,a){n(t,a),e(t,a)};return t._merged=!0,t}function ge(n,e,t,a,d,m){return(r(t)||l(t))&&(d=a,a=t,t=void 0),s(m)&&(d=2),function(n,e,t,a,l){if(o(t)&&o(t.__ob__))return xn();o(t)&&o(t.is)&&(e=t.is);if(!e)return xn();0;r(a)&&c(a[0])&&((t=t||{}).scopedSlots={default:a[0]},a.length=0);2===l?a=_n(a):1===l&&(a=function(n){for(var e=0;e<n.length;e++)if(r(n[e]))return Array.prototype.concat.apply([],n);return n}(a));var d,m;if("string"==typeof e){var u=void 0;m=n.$vnode&&n.$vnode.ns||F.getTagNamespace(e),d=F.isReservedTag(e)?new yn(F.parsePlatformTagName(e),t,a,void 0,void 0,n):t&&t.pre||!o(u=Ct(n.$options,"components",e))?new yn(e,t,a,void 0,void 0,n):ue(u,t,n,a,e)}else d=ue(e,t,n,a);return r(d)?d:o(d)?(o(m)&&function n(e,t,a){e.ns=t,"foreignObject"===e.tag&&(t=void 0,a=!0);if(o(e.children))for(var r=0,l=e.children.length;r<l;r++){var c=e.children[r];o(c.tag)&&(i(c.ns)||s(a)&&"svg"!==c.tag)&&n(c,t,a)}}(d,m),o(t)&&function(n){p(n.style)&&zn(n.style);p(n.class)&&zn(n.class)}(t),d):xn()}(n,e,t,a,d)}function ve(n){return{get attrs(){return function(n){if(!n._attrsProxy){var e=n._attrsProxy={};$(e,"_v_attr_proxy",!0),be(e,n.$attrs,a,n)}return n._attrsProxy}(n)},get slots(){return function(n){n._slotsProxy||ye(n._slotsProxy={},n.$scopedSlots);return n._slotsProxy}(n)},emit:E(n.$emit,n),expose:function(e){e&&Object.keys(e).forEach((function(t){return En(n,e,t)}))}}}function be(n,e,t,a){var r=!1;for(var i in e)i in n?e[i]!==t[i]&&(r=!0):(r=!0,fe(n,i,a));for(var i in n)i in e||(r=!0,delete n[i]);return r}function fe(n,e,t){Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){return t.$attrs[e]}})}function ye(n,e){for(var t in e)n[t]=e[t];for(var t in n)t in e||delete n[t]}var xe,ke=null;function je(n,e){return(n.__esModule||pn&&"Module"===n[Symbol.toStringTag])&&(n=n.default),p(n)?e.extend(n):n}function Se(n){if(r(n))for(var e=0;e<n.length;e++){var t=n[e];if(o(t)&&(o(t.componentOptions)||Nn(t)))return t}}function we(n,e){xe.$on(n,e)}function Te(n,e){xe.$off(n,e)}function Ie(n,e){var t=xe;return function a(){var r=e.apply(null,arguments);null!==r&&t.$off(n,a)}}function Ce(n,e,t){xe=n,Jn(e,t||{},we,Te,Ie,n),xe=void 0}var Me=null;function Ee(n){var e=Me;return Me=n,function(){Me=e}}function Pe(n){for(;n&&(n=n.$parent);)if(n._inactive)return!0;return!1}function ze(n,e){if(e){if(n._directInactive=!1,Pe(n))return}else if(n._directInactive)return;if(n._inactive||null===n._inactive){n._inactive=!1;for(var t=0;t<n.$children.length;t++)ze(n.$children[t]);Ae(n,"activated")}}function Ae(n,e,t){bn();var a=dn;mn(n);var r=n.$options[e],i="".concat(e," hook");if(r)for(var o=0,s=r.length;o<s;o++)Ve(r[o],n,t||null,n,i);n._hasHookEvent&&n.$emit("hook:"+e),mn(a),fn()}var qe=[],Je=[],Le={},Re=!1,_e=!1,Oe=0;var Be,De=0,He=Date.now;if(G&&!K){var Fe=window.performance;Fe&&"function"==typeof Fe.now&&He()>document.createEvent("Event").timeStamp&&(He=function(){return Fe.now()})}function Ne(){var n,e;for(De=He(),_e=!0,qe.sort((function(n,e){return n.id-e.id})),Oe=0;Oe<qe.length;Oe++)(n=qe[Oe]).before&&n.before(),e=n.id,Le[e]=null,n.run();var t=Je.slice(),a=qe.slice();Oe=qe.length=Je.length=0,Le={},Re=_e=!1,function(n){for(var e=0;e<n.length;e++)n[e]._inactive=!0,ze(n[e],!0)}(t),function(n){var e=n.length;for(;e--;){var t=n[e],a=t.vm;a&&a._watcher===t&&a._isMounted&&!a._isDestroyed&&Ae(a,"updated")}}(a),sn&&F.devtools&&sn.emit("flush")}function Ue(n){var e=n.id;if(null==Le[e]&&(n!==gn.target||!n.noRecurse)){if(Le[e]=!0,_e){for(var t=qe.length-1;t>Oe&&qe[t].id>n.id;)t--;qe.splice(t+1,0,n)}else qe.push(n);Re||(Re=!0,st(Ne))}}var $e=function(){function n(n){void 0===n&&(n=!1),this.active=!0,this.effects=[],this.cleanups=[],!n&&Be&&(this.parent=Be,this.index=(Be.scopes||(Be.scopes=[])).push(this)-1)}return n.prototype.run=function(n){if(this.active){var e=Be;try{return Be=this,n()}finally{Be=e}}else 0},n.prototype.on=function(){Be=this},n.prototype.off=function(){Be=this.parent},n.prototype.stop=function(n){if(this.active){var e=void 0,t=void 0;for(e=0,t=this.effects.length;e<t;e++)this.effects[e].teardown();for(e=0,t=this.cleanups.length;e<t;e++)this.cleanups[e]();if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].stop(!0);if(this.parent&&!n){var a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}},n}();var We=0,Qe=function(){function n(n,e,t,a,r){var i,o;i=this,void 0===(o=Be||(n?n._scope:void 0))&&(o=Be),o&&o.active&&o.effects.push(i),(this.vm=n)&&r&&(n._watcher=this),a?(this.deep=!!a.deep,this.user=!!a.user,this.lazy=!!a.lazy,this.sync=!!a.sync,this.before=a.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=t,this.id=++We,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new cn,this.newDepIds=new cn,this.expression="",c(e)?this.getter=e:(this.getter=function(n){if(!W.test(n)){var e=n.split(".");return function(n){for(var t=0;t<e.length;t++){if(!n)return;n=n[e[t]]}return n}}}(e),this.getter||(this.getter=q)),this.value=this.lazy?void 0:this.get()}return n.prototype.get=function(){var n;bn(this);var e=this.vm;try{n=this.getter.call(e,e)}catch(n){if(!this.user)throw n;Ge(n,e,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&zn(n),fn(),this.cleanupDeps()}return n},n.prototype.addDep=function(n){var e=n.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(n),this.depIds.has(e)||n.addSub(this))},n.prototype.cleanupDeps=function(){for(var n=this.deps.length;n--;){var e=this.deps[n];this.newDepIds.has(e.id)||e.removeSub(this)}var t=this.depIds;this.depIds=this.newDepIds,this.newDepIds=t,this.newDepIds.clear(),t=this.deps,this.deps=this.newDeps,this.newDeps=t,this.newDeps.length=0},n.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Ue(this)},n.prototype.run=function(){if(this.active){var n=this.get();if(n!==this.value||p(n)||this.deep){var e=this.value;if(this.value=n,this.user){var t='callback for watcher "'.concat(this.expression,'"');Ve(this.cb,this.vm,[n,e],this.vm,t)}else this.cb.call(this.vm,n,e)}}},n.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},n.prototype.depend=function(){for(var n=this.deps.length;n--;)this.deps[n].depend()},n.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&x(this.vm._scope.effects,this),this.active){for(var n=this.deps.length;n--;)this.deps[n].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},n}();"".concat("watcher"," callback"),"".concat("watcher"," getter"),"".concat("watcher"," cleanup");function Ge(n,e,t){bn();try{if(e)for(var a=e;a=a.$parent;){var r=a.$options.errorCaptured;if(r)for(var i=0;i<r.length;i++)try{if(!1===r[i].call(a,n,e,t))return}catch(n){Ke(n,a,"errorCaptured hook")}}Ke(n,e,t)}finally{fn()}}function Ve(n,e,t,a,r){var i;try{(i=t?n.apply(e,t):n.call(e))&&!i._isVue&&g(i)&&!i._handled&&(i.catch((function(n){return Ge(n,a,r+" (Promise/async)")})),i._handled=!0)}catch(n){Ge(n,a,r)}return i}function Ke(n,e,t){if(F.errorHandler)try{return F.errorHandler.call(null,n,e,t)}catch(e){e!==n&&Xe(e,null,"config.errorHandler")}Xe(n,e,t)}function Xe(n,e,t){if(!G||"undefined"==typeof console)throw n;console.error(n)}var Ze,Ye=!1,nt=[],et=!1;function tt(){et=!1;var n=nt.slice(0);nt.length=0;for(var e=0;e<n.length;e++)n[e]()}if("undefined"!=typeof Promise&&ln(Promise)){var at=Promise.resolve();Ze=function(){at.then(tt),Y&&setTimeout(q)},Ye=!0}else if(K||"undefined"==typeof MutationObserver||!ln(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Ze="undefined"!=typeof setImmediate&&ln(setImmediate)?function(){setImmediate(tt)}:function(){setTimeout(tt,0)};else{var rt=1,it=new MutationObserver(tt),ot=document.createTextNode(String(rt));it.observe(ot,{characterData:!0}),Ze=function(){rt=(rt+1)%2,ot.data=String(rt)},Ye=!0}function st(n,e){var t;if(nt.push((function(){if(n)try{n.call(e)}catch(n){Ge(n,e,"nextTick")}else t&&t(e)})),et||(et=!0,Ze()),!n&&"undefined"!=typeof Promise)return new Promise((function(n){t=n}))}function lt(n){return function(e,t){if(void 0===t&&(t=dn),t)return function(n,e,t){var a=n.$options;a[e]=St(a[e],t)}(t,n,e)}}lt("beforeMount"),lt("mounted"),lt("beforeUpdate"),lt("updated"),lt("beforeDestroy"),lt("destroyed"),lt("errorCaptured"),lt("activated"),lt("deactivated"),lt("serverPrefetch"),lt("renderTracked"),lt("renderTriggered");var ct=Object.getOwnPropertyNames(wn),pt={},dt=!0;function mt(n){dt=n}var ut={notify:q,depend:q,addSub:q,removeSub:q},ht=function(){function n(n,e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this.value=n,this.shallow=e,this.mock=t,this.dep=t?ut:new gn,this.vmCount=0,$(n,"__ob__",this),r(n)){if(!t)if(Q)n.__proto__=wn;else for(var a=0,i=ct.length;a<i;a++){$(n,s=ct[a],wn[s])}e||this.observeArray(n)}else{var o=Object.keys(n);for(a=0;a<o.length;a++){var s;vt(n,s=o[a],pt,void 0,e,t)}}}return n.prototype.observeArray=function(n){for(var e=0,t=n.length;e<t;e++)gt(n[e],!1,this.mock)},n}();function gt(n,e,t){var a;if(!(!p(n)||Mn(n)||n instanceof yn))return j(n,"__ob__")&&n.__ob__ instanceof ht?a=n.__ob__:!dt||!t&&on()||!r(n)&&!m(n)||!Object.isExtensible(n)||n.__v_skip||(a=new ht(n,e,t)),a}function vt(n,e,t,a,i,o){var s=new gn,l=Object.getOwnPropertyDescriptor(n,e);if(!l||!1!==l.configurable){var c=l&&l.get,p=l&&l.set;c&&!p||t!==pt&&2!==arguments.length||(t=n[e]);var d=!i&&gt(t,!1,o);return Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){var e=c?c.call(n):t;return gn.target&&(s.depend(),d&&(d.dep.depend(),r(e)&&yt(e))),Mn(e)&&!i?e.value:e},set:function(e){var a=c?c.call(n):t;if(B(a,e)){if(p)p.call(n,e);else{if(c)return;if(Mn(a)&&!Mn(e))return void(a.value=e);t=e}d=!i&&gt(e,!1,o),s.notify()}}}),s}}function bt(n,e,t){if(!Cn(n)){var a=n.__ob__;return r(n)&&h(e)?(n.length=Math.max(n.length,e),n.splice(e,1,t),a&&!a.shallow&&a.mock&&gt(t,!1,!0),t):e in n&&!(e in Object.prototype)?(n[e]=t,t):n._isVue||a&&a.vmCount?t:a?(vt(a.value,e,t,void 0,a.shallow,a.mock),a.dep.notify(),t):(n[e]=t,t)}}function ft(n,e){if(r(n)&&h(e))n.splice(e,1);else{var t=n.__ob__;n._isVue||t&&t.vmCount||Cn(n)||j(n,e)&&(delete n[e],t&&t.dep.notify())}}function yt(n){for(var e=void 0,t=0,a=n.length;t<a;t++)(e=n[t])&&e.__ob__&&e.__ob__.dep.depend(),r(e)&&yt(e)}var xt=F.optionMergeStrategies;function kt(n,e){if(!e)return n;for(var t,a,r,i=pn?Reflect.ownKeys(e):Object.keys(e),o=0;o<i.length;o++)"__ob__"!==(t=i[o])&&(a=n[t],r=e[t],j(n,t)?a!==r&&m(a)&&m(r)&&kt(a,r):bt(n,t,r));return n}function jt(n,e,t){return t?function(){var a=c(e)?e.call(t,t):e,r=c(n)?n.call(t,t):n;return a?kt(a,r):r}:e?n?function(){return kt(c(e)?e.call(this,this):e,c(n)?n.call(this,this):n)}:e:n}function St(n,e){var t=e?n?n.concat(e):r(e)?e:[e]:n;return t?function(n){for(var e=[],t=0;t<n.length;t++)-1===e.indexOf(n[t])&&e.push(n[t]);return e}(t):t}function wt(n,e,t,a){var r=Object.create(n||null);return e?z(r,e):r}xt.data=function(n,e,t){return t?jt(n,e,t):e&&"function"!=typeof e?n:jt(n,e)},H.forEach((function(n){xt[n]=St})),D.forEach((function(n){xt[n+"s"]=wt})),xt.watch=function(n,e,t,a){if(n===tn&&(n=void 0),e===tn&&(e=void 0),!e)return Object.create(n||null);if(!n)return e;var i={};for(var o in z(i,n),e){var s=i[o],l=e[o];s&&!r(s)&&(s=[s]),i[o]=s?s.concat(l):r(l)?l:[l]}return i},xt.props=xt.methods=xt.inject=xt.computed=function(n,e,t,a){if(!n)return e;var r=Object.create(null);return z(r,n),e&&z(r,e),r},xt.provide=jt;var Tt=function(n,e){return void 0===e?n:e};function It(n,e,t){if(c(e)&&(e=e.options),function(n,e){var t=n.props;if(t){var a,i,o={};if(r(t))for(a=t.length;a--;)"string"==typeof(i=t[a])&&(o[T(i)]={type:null});else if(m(t))for(var s in t)i=t[s],o[T(s)]=m(i)?i:{type:i};else 0;n.props=o}}(e),function(n,e){var t=n.inject;if(t){var a=n.inject={};if(r(t))for(var i=0;i<t.length;i++)a[t[i]]={from:t[i]};else if(m(t))for(var o in t){var s=t[o];a[o]=m(s)?z({from:o},s):{from:s}}else 0}}(e),function(n){var e=n.directives;if(e)for(var t in e){var a=e[t];c(a)&&(e[t]={bind:a,update:a})}}(e),!e._base&&(e.extends&&(n=It(n,e.extends,t)),e.mixins))for(var a=0,i=e.mixins.length;a<i;a++)n=It(n,e.mixins[a],t);var o,s={};for(o in n)l(o);for(o in e)j(n,o)||l(o);function l(a){var r=xt[a]||Tt;s[a]=r(n[a],e[a],t,a)}return s}function Ct(n,e,t,a){if("string"==typeof t){var r=n[e];if(j(r,t))return r[t];var i=T(t);if(j(r,i))return r[i];var o=I(i);return j(r,o)?r[o]:r[t]||r[i]||r[o]}}function Mt(n,e,t,a){var r=e[n],i=!j(t,n),o=t[n],s=At(Boolean,r.type);if(s>-1)if(i&&!j(r,"default"))o=!1;else if(""===o||o===M(n)){var l=At(String,r.type);(l<0||s<l)&&(o=!0)}if(void 0===o){o=function(n,e,t){if(!j(e,"default"))return;var a=e.default;0;if(n&&n.$options.propsData&&void 0===n.$options.propsData[t]&&void 0!==n._props[t])return n._props[t];return c(a)&&"Function"!==Pt(e.type)?a.call(n):a}(a,r,n);var p=dt;mt(!0),gt(o),mt(p)}return o}var Et=/^\s*function (\w+)/;function Pt(n){var e=n&&n.toString().match(Et);return e?e[1]:""}function zt(n,e){return Pt(n)===Pt(e)}function At(n,e){if(!r(e))return zt(e,n)?0:-1;for(var t=0,a=e.length;t<a;t++)if(zt(e[t],n))return t;return-1}var qt={enumerable:!0,configurable:!0,get:q,set:q};function Jt(n,e,t){qt.get=function(){return this[e][t]},qt.set=function(n){this[e][t]=n},Object.defineProperty(n,t,qt)}function Lt(n){var e=n.$options;if(e.props&&function(n,e){var t=n.$options.propsData||{},a=n._props=Tn({}),r=n.$options._propKeys=[];n.$parent&&mt(!1);var i=function(i){r.push(i);var o=Mt(i,e,t,n);vt(a,i,o),i in n||Jt(n,"_props",i)};for(var o in e)i(o);mt(!0)}(n,e.props),function(n){var e=n.$options,t=e.setup;if(t){var a=n._setupContext=ve(n);mn(n),bn();var r=Ve(t,null,[n._props||Tn({}),a],n,"setup");if(fn(),mn(),c(r))e.render=r;else if(p(r))if(n._setupState=r,r.__sfc){var i=n._setupProxy={};for(var o in r)"__sfc"!==o&&En(i,r,o)}else for(var o in r)U(o)||En(n,r,o);else 0}}(n),e.methods&&function(n,e){n.$options.props;for(var t in e)n[t]="function"!=typeof e[t]?q:E(e[t],n)}(n,e.methods),e.data)!function(n){var e=n.$options.data;m(e=n._data=c(e)?function(n,e){bn();try{return n.call(e,e)}catch(n){return Ge(n,e,"data()"),{}}finally{fn()}}(e,n):e||{})||(e={});var t=Object.keys(e),a=n.$options.props,r=(n.$options.methods,t.length);for(;r--;){var i=t[r];0,a&&j(a,i)||U(i)||Jt(n,"_data",i)}var o=gt(e);o&&o.vmCount++}(n);else{var t=gt(n._data={});t&&t.vmCount++}e.computed&&function(n,e){var t=n._computedWatchers=Object.create(null),a=on();for(var r in e){var i=e[r],o=c(i)?i:i.get;0,a||(t[r]=new Qe(n,o||q,q,Rt)),r in n||_t(n,r,i)}}(n,e.computed),e.watch&&e.watch!==tn&&function(n,e){for(var t in e){var a=e[t];if(r(a))for(var i=0;i<a.length;i++)Dt(n,t,a[i]);else Dt(n,t,a)}}(n,e.watch)}var Rt={lazy:!0};function _t(n,e,t){var a=!on();c(t)?(qt.get=a?Ot(e):Bt(t),qt.set=q):(qt.get=t.get?a&&!1!==t.cache?Ot(e):Bt(t.get):q,qt.set=t.set||q),Object.defineProperty(n,e,qt)}function Ot(n){return function(){var e=this._computedWatchers&&this._computedWatchers[n];if(e)return e.dirty&&e.evaluate(),gn.target&&e.depend(),e.value}}function Bt(n){return function(){return n.call(this,this)}}function Dt(n,e,t,a){return m(t)&&(a=t,t=t.handler),"string"==typeof t&&(t=n[t]),n.$watch(e,t,a)}var Ht=0;function Ft(n){var e=n.options;if(n.super){var t=Ft(n.super);if(t!==n.superOptions){n.superOptions=t;var a=function(n){var e,t=n.options,a=n.sealedOptions;for(var r in t)t[r]!==a[r]&&(e||(e={}),e[r]=t[r]);return e}(n);a&&z(n.extendOptions,a),(e=n.options=It(t,n.extendOptions)).name&&(e.components[e.name]=n)}}return e}function Nt(n){this._init(n)}function Ut(n){n.cid=0;var e=1;n.extend=function(n){n=n||{};var t=this,a=t.cid,r=n._Ctor||(n._Ctor={});if(r[a])return r[a];var i=n.name||t.options.name;var o=function(n){this._init(n)};return(o.prototype=Object.create(t.prototype)).constructor=o,o.cid=e++,o.options=It(t.options,n),o.super=t,o.options.props&&function(n){var e=n.options.props;for(var t in e)Jt(n.prototype,"_props",t)}(o),o.options.computed&&function(n){var e=n.options.computed;for(var t in e)_t(n.prototype,t,e[t])}(o),o.extend=t.extend,o.mixin=t.mixin,o.use=t.use,D.forEach((function(n){o[n]=t[n]})),i&&(o.options.components[i]=o),o.superOptions=t.options,o.extendOptions=n,o.sealedOptions=z({},o.options),r[a]=o,o}}function $t(n){return n&&(n.Ctor.options.name||n.tag)}function Wt(n,e){return r(n)?n.indexOf(e)>-1:"string"==typeof n?n.split(",").indexOf(e)>-1:!!u(n)&&n.test(e)}function Qt(n,e){var t=n.cache,a=n.keys,r=n._vnode;for(var i in t){var o=t[i];if(o){var s=o.name;s&&!e(s)&&Gt(t,i,a,r)}}}function Gt(n,e,t,a){var r=n[e];!r||a&&r.tag===a.tag||r.componentInstance.$destroy(),n[e]=null,x(t,e)}!function(n){n.prototype._init=function(n){var e=this;e._uid=Ht++,e._isVue=!0,e.__v_skip=!0,e._scope=new $e(!0),n&&n._isComponent?function(n,e){var t=n.$options=Object.create(n.constructor.options),a=e._parentVnode;t.parent=e.parent,t._parentVnode=a;var r=a.componentOptions;t.propsData=r.propsData,t._parentListeners=r.listeners,t._renderChildren=r.children,t._componentTag=r.tag,e.render&&(t.render=e.render,t.staticRenderFns=e.staticRenderFns)}(e,n):e.$options=It(Ft(e.constructor),n||{},e),e._renderProxy=e,e._self=e,function(n){var e=n.$options,t=e.parent;if(t&&!e.abstract){for(;t.$options.abstract&&t.$parent;)t=t.$parent;t.$children.push(n)}n.$parent=t,n.$root=t?t.$root:n,n.$children=[],n.$refs={},n._provided=t?t._provided:Object.create(null),n._watcher=null,n._inactive=null,n._directInactive=!1,n._isMounted=!1,n._isDestroyed=!1,n._isBeingDestroyed=!1}(e),function(n){n._events=Object.create(null),n._hasHookEvent=!1;var e=n.$options._parentListeners;e&&Ce(n,e)}(e),function(n){n._vnode=null,n._staticTrees=null;var e=n.$options,t=n.$vnode=e._parentVnode,r=t&&t.context;n.$slots=Hn(e._renderChildren,r),n.$scopedSlots=a,n._c=function(e,t,a,r){return ge(n,e,t,a,r,!1)},n.$createElement=function(e,t,a,r){return ge(n,e,t,a,r,!0)};var i=t&&t.data;vt(n,"$attrs",i&&i.attrs||a,null,!0),vt(n,"$listeners",e._parentListeners||a,null,!0)}(e),Ae(e,"beforeCreate"),function(n){var e=Dn(n.$options.inject,n);e&&(mt(!1),Object.keys(e).forEach((function(t){vt(n,t,e[t])})),mt(!0))}(e),Lt(e),function(n){var e=n.$options.provide;if(e){var t=c(e)?e.call(n):e;if(!p(t))return;var a=pn?Reflect.ownKeys(t):Object.keys(t);mn(n);for(var r=0;r<a.length;r++)Bn(a[r],t[a[r]]);mn()}}(e),Ae(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(Nt),function(n){var e={get:function(){return this._data}},t={get:function(){return this._props}};Object.defineProperty(n.prototype,"$data",e),Object.defineProperty(n.prototype,"$props",t),n.prototype.$set=bt,n.prototype.$delete=ft,n.prototype.$watch=function(n,e,t){if(m(e))return Dt(this,n,e,t);(t=t||{}).user=!0;var a=new Qe(this,n,e,t);if(t.immediate){var r='callback for immediate watcher "'.concat(a.expression,'"');bn(),Ve(e,this,[a.value],this,r),fn()}return function(){a.teardown()}}}(Nt),function(n){var e=/^hook:/;n.prototype.$on=function(n,t){var a=this;if(r(n))for(var i=0,o=n.length;i<o;i++)a.$on(n[i],t);else(a._events[n]||(a._events[n]=[])).push(t),e.test(n)&&(a._hasHookEvent=!0);return a},n.prototype.$once=function(n,e){var t=this;function a(){t.$off(n,a),e.apply(t,arguments)}return a.fn=e,t.$on(n,a),t},n.prototype.$off=function(n,e){var t=this;if(!arguments.length)return t._events=Object.create(null),t;if(r(n)){for(var a=0,i=n.length;a<i;a++)t.$off(n[a],e);return t}var o,s=t._events[n];if(!s)return t;if(!e)return t._events[n]=null,t;for(var l=s.length;l--;)if((o=s[l])===e||o.fn===e){s.splice(l,1);break}return t},n.prototype.$emit=function(n){var e=this,t=e._events[n];if(t){t=t.length>1?P(t):t;for(var a=P(arguments,1),r='event handler for "'.concat(n,'"'),i=0,o=t.length;i<o;i++)Ve(t[i],e,a,e,r)}return e}}(Nt),function(n){n.prototype._update=function(n,e){var t=this,a=t.$el,r=t._vnode,i=Ee(t);t._vnode=n,t.$el=r?t.__patch__(r,n):t.__patch__(t.$el,n,e,!1),i(),a&&(a.__vue__=null),t.$el&&(t.$el.__vue__=t),t.$vnode&&t.$parent&&t.$vnode===t.$parent._vnode&&(t.$parent.$el=t.$el)},n.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},n.prototype.$destroy=function(){var n=this;if(!n._isBeingDestroyed){Ae(n,"beforeDestroy"),n._isBeingDestroyed=!0;var e=n.$parent;!e||e._isBeingDestroyed||n.$options.abstract||x(e.$children,n),n._scope.stop(),n._data.__ob__&&n._data.__ob__.vmCount--,n._isDestroyed=!0,n.__patch__(n._vnode,null),Ae(n,"destroyed"),n.$off(),n.$el&&(n.$el.__vue__=null),n.$vnode&&(n.$vnode.parent=null)}}}(Nt),function(n){se(n.prototype),n.prototype.$nextTick=function(n){return st(n,this)},n.prototype._render=function(){var n,e=this,t=e.$options,a=t.render,i=t._parentVnode;i&&(e.$scopedSlots=Un(e.$parent,i.data.scopedSlots,e.$slots,e.$scopedSlots),e._slotsProxy&&ye(e._slotsProxy,e.$scopedSlots)),e.$vnode=i;try{mn(e),ke=e,n=a.call(e._renderProxy,e.$createElement)}catch(t){Ge(t,e,"render"),n=e._vnode}finally{ke=null,mn()}return r(n)&&1===n.length&&(n=n[0]),n instanceof yn||(n=xn()),n.parent=i,n}}(Nt);var Vt=[String,RegExp,Array],Kt={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Vt,exclude:Vt,max:[String,Number]},methods:{cacheVNode:function(){var n=this.cache,e=this.keys,t=this.vnodeToCache,a=this.keyToCache;if(t){var r=t.tag,i=t.componentInstance,o=t.componentOptions;n[a]={name:$t(o),tag:r,componentInstance:i},e.push(a),this.max&&e.length>parseInt(this.max)&&Gt(n,e[0],e,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var n in this.cache)Gt(this.cache,n,this.keys)},mounted:function(){var n=this;this.cacheVNode(),this.$watch("include",(function(e){Qt(n,(function(n){return Wt(e,n)}))})),this.$watch("exclude",(function(e){Qt(n,(function(n){return!Wt(e,n)}))}))},updated:function(){this.cacheVNode()},render:function(){var n=this.$slots.default,e=Se(n),t=e&&e.componentOptions;if(t){var a=$t(t),r=this.include,i=this.exclude;if(r&&(!a||!Wt(r,a))||i&&a&&Wt(i,a))return e;var o=this.cache,s=this.keys,l=null==e.key?t.Ctor.cid+(t.tag?"::".concat(t.tag):""):e.key;o[l]?(e.componentInstance=o[l].componentInstance,x(s,l),s.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||n&&n[0]}}};!function(n){var e={get:function(){return F}};Object.defineProperty(n,"config",e),n.util={warn:un,extend:z,mergeOptions:It,defineReactive:vt},n.set=bt,n.delete=ft,n.nextTick=st,n.observable=function(n){return gt(n),n},n.options=Object.create(null),D.forEach((function(e){n.options[e+"s"]=Object.create(null)})),n.options._base=n,z(n.options.components,Kt),function(n){n.use=function(n){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(n)>-1)return this;var t=P(arguments,1);return t.unshift(this),c(n.install)?n.install.apply(n,t):c(n)&&n.apply(null,t),e.push(n),this}}(n),function(n){n.mixin=function(n){return this.options=It(this.options,n),this}}(n),Ut(n),function(n){D.forEach((function(e){n[e]=function(n,t){return t?("component"===e&&m(t)&&(t.name=t.name||n,t=this.options._base.extend(t)),"directive"===e&&c(t)&&(t={bind:t,update:t}),this.options[e+"s"][n]=t,t):this.options[e+"s"][n]}}))}(n)}(Nt),Object.defineProperty(Nt.prototype,"$isServer",{get:on}),Object.defineProperty(Nt.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Nt,"FunctionalRenderContext",{value:le}),Nt.version="2.7.4";var Xt=f("style,class"),Zt=f("input,textarea,option,select,progress"),Yt=f("contenteditable,draggable,spellcheck"),na=f("events,caret,typing,plaintext-only"),ea=f("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),ta="http://www.w3.org/1999/xlink",aa=function(n){return":"===n.charAt(5)&&"xlink"===n.slice(0,5)},ra=function(n){return aa(n)?n.slice(6,n.length):""},ia=function(n){return null==n||!1===n};function oa(n){for(var e=n.data,t=n,a=n;o(a.componentInstance);)(a=a.componentInstance._vnode)&&a.data&&(e=sa(a.data,e));for(;o(t=t.parent);)t&&t.data&&(e=sa(e,t.data));return function(n,e){if(o(n)||o(e))return la(n,ca(e));return""}(e.staticClass,e.class)}function sa(n,e){return{staticClass:la(n.staticClass,e.staticClass),class:o(n.class)?[n.class,e.class]:e.class}}function la(n,e){return n?e?n+" "+e:n:e||""}function ca(n){return Array.isArray(n)?function(n){for(var e,t="",a=0,r=n.length;a<r;a++)o(e=ca(n[a]))&&""!==e&&(t&&(t+=" "),t+=e);return t}(n):p(n)?function(n){var e="";for(var t in n)n[t]&&(e&&(e+=" "),e+=t);return e}(n):"string"==typeof n?n:""}var pa={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},da=f("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),ma=f("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),ua=function(n){return da(n)||ma(n)};var ha=Object.create(null);var ga=f("text,number,password,search,email,tel,url");var va=Object.freeze({__proto__:null,createElement:function(n,e){var t=document.createElement(n);return"select"!==n||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&t.setAttribute("multiple","multiple"),t},createElementNS:function(n,e){return document.createElementNS(pa[n],e)},createTextNode:function(n){return document.createTextNode(n)},createComment:function(n){return document.createComment(n)},insertBefore:function(n,e,t){n.insertBefore(e,t)},removeChild:function(n,e){n.removeChild(e)},appendChild:function(n,e){n.appendChild(e)},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling},tagName:function(n){return n.tagName},setTextContent:function(n,e){n.textContent=e},setStyleScope:function(n,e){n.setAttribute(e,"")}}),ba={create:function(n,e){fa(e)},update:function(n,e){n.data.ref!==e.data.ref&&(fa(n,!0),fa(e))},destroy:function(n){fa(n,!0)}};function fa(n,e){var t=n.data.ref;if(o(t)){var a=n.context,i=n.componentInstance||n.elm,s=e?null:i,l=e?void 0:i;if(c(t))Ve(t,a,[s],a,"template ref function");else{var p=n.data.refInFor,d="string"==typeof t||"number"==typeof t,m=Mn(t),u=a.$refs;if(d||m)if(p){var h=d?u[t]:t.value;e?r(h)&&x(h,i):r(h)?h.includes(i)||h.push(i):d?(u[t]=[i],ya(a,t,u[t])):t.value=[i]}else if(d){if(e&&u[t]!==i)return;u[t]=l,ya(a,t,s)}else if(m){if(e&&t.value!==i)return;t.value=s}else 0}}}function ya(n,e,t){var a=n._setupState;a&&j(a,e)&&(Mn(a[e])?a[e].value=t:a[e]=t)}var xa=new yn("",{},[]),ka=["create","activate","update","remove","destroy"];function ja(n,e){return n.key===e.key&&n.asyncFactory===e.asyncFactory&&(n.tag===e.tag&&n.isComment===e.isComment&&o(n.data)===o(e.data)&&function(n,e){if("input"!==n.tag)return!0;var t,a=o(t=n.data)&&o(t=t.attrs)&&t.type,r=o(t=e.data)&&o(t=t.attrs)&&t.type;return a===r||ga(a)&&ga(r)}(n,e)||s(n.isAsyncPlaceholder)&&i(e.asyncFactory.error))}function Sa(n,e,t){var a,r,i={};for(a=e;a<=t;++a)o(r=n[a].key)&&(i[r]=a);return i}var wa={create:Ta,update:Ta,destroy:function(n){Ta(n,xa)}};function Ta(n,e){(n.data.directives||e.data.directives)&&function(n,e){var t,a,r,i=n===xa,o=e===xa,s=Ca(n.data.directives,n.context),l=Ca(e.data.directives,e.context),c=[],p=[];for(t in l)a=s[t],r=l[t],a?(r.oldValue=a.value,r.oldArg=a.arg,Ea(r,"update",e,n),r.def&&r.def.componentUpdated&&p.push(r)):(Ea(r,"bind",e,n),r.def&&r.def.inserted&&c.push(r));if(c.length){var d=function(){for(var t=0;t<c.length;t++)Ea(c[t],"inserted",e,n)};i?Ln(e,"insert",d):d()}p.length&&Ln(e,"postpatch",(function(){for(var t=0;t<p.length;t++)Ea(p[t],"componentUpdated",e,n)}));if(!i)for(t in s)l[t]||Ea(s[t],"unbind",n,n,o)}(n,e)}var Ia=Object.create(null);function Ca(n,e){var t,a,r=Object.create(null);if(!n)return r;for(t=0;t<n.length;t++)(a=n[t]).modifiers||(a.modifiers=Ia),r[Ma(a)]=a,e._setupState&&e._setupState.__sfc&&(a.def=a.def||Ct(e,"_setupState","v-"+a.name)),a.def=a.def||Ct(e.$options,"directives",a.name);return r}function Ma(n){return n.rawName||"".concat(n.name,".").concat(Object.keys(n.modifiers||{}).join("."))}function Ea(n,e,t,a,r){var i=n.def&&n.def[e];if(i)try{i(t.elm,n,t,a,r)}catch(a){Ge(a,t.context,"directive ".concat(n.name," ").concat(e," hook"))}}var Pa=[ba,wa];function za(n,e){var t=e.componentOptions;if(!(o(t)&&!1===t.Ctor.options.inheritAttrs||i(n.data.attrs)&&i(e.data.attrs))){var a,r,l=e.elm,c=n.data.attrs||{},p=e.data.attrs||{};for(a in(o(p.__ob__)||s(p._v_attr_proxy))&&(p=e.data.attrs=z({},p)),p)r=p[a],c[a]!==r&&Aa(l,a,r,e.data.pre);for(a in(K||Z)&&p.value!==c.value&&Aa(l,"value",p.value),c)i(p[a])&&(aa(a)?l.removeAttributeNS(ta,ra(a)):Yt(a)||l.removeAttribute(a))}}function Aa(n,e,t,a){a||n.tagName.indexOf("-")>-1?qa(n,e,t):ea(e)?ia(t)?n.removeAttribute(e):(t="allowfullscreen"===e&&"EMBED"===n.tagName?"true":e,n.setAttribute(e,t)):Yt(e)?n.setAttribute(e,function(n,e){return ia(e)||"false"===e?"false":"contenteditable"===n&&na(e)?e:"true"}(e,t)):aa(e)?ia(t)?n.removeAttributeNS(ta,ra(e)):n.setAttributeNS(ta,e,t):qa(n,e,t)}function qa(n,e,t){if(ia(t))n.removeAttribute(e);else{if(K&&!X&&"TEXTAREA"===n.tagName&&"placeholder"===e&&""!==t&&!n.__ieph){var a=function(e){e.stopImmediatePropagation(),n.removeEventListener("input",a)};n.addEventListener("input",a),n.__ieph=!0}n.setAttribute(e,t)}}var Ja={create:za,update:za};function La(n,e){var t=e.elm,a=e.data,r=n.data;if(!(i(a.staticClass)&&i(a.class)&&(i(r)||i(r.staticClass)&&i(r.class)))){var s=oa(e),l=t._transitionClasses;o(l)&&(s=la(s,ca(l))),s!==t._prevClass&&(t.setAttribute("class",s),t._prevClass=s)}}var Ra,_a={create:La,update:La};function Oa(n,e,t){var a=Ra;return function r(){var i=e.apply(null,arguments);null!==i&&Ha(n,r,t,a)}}var Ba=Ye&&!(en&&Number(en[1])<=53);function Da(n,e,t,a){if(Ba){var r=De,i=e;e=i._wrapper=function(n){if(n.target===n.currentTarget||n.timeStamp>=r||n.timeStamp<=0||n.target.ownerDocument!==document)return i.apply(this,arguments)}}Ra.addEventListener(n,e,an?{capture:t,passive:a}:t)}function Ha(n,e,t,a){(a||Ra).removeEventListener(n,e._wrapper||e,t)}function Fa(n,e){if(!i(n.data.on)||!i(e.data.on)){var t=e.data.on||{},a=n.data.on||{};Ra=e.elm||n.elm,function(n){if(o(n.__r)){var e=K?"change":"input";n[e]=[].concat(n.__r,n[e]||[]),delete n.__r}o(n.__c)&&(n.change=[].concat(n.__c,n.change||[]),delete n.__c)}(t),Jn(t,a,Da,Ha,Oa,e.context),Ra=void 0}}var Na,Ua={create:Fa,update:Fa,destroy:function(n){return Fa(n,xa)}};function $a(n,e){if(!i(n.data.domProps)||!i(e.data.domProps)){var t,a,r=e.elm,l=n.data.domProps||{},c=e.data.domProps||{};for(t in(o(c.__ob__)||s(c._v_attr_proxy))&&(c=e.data.domProps=z({},c)),l)t in c||(r[t]="");for(t in c){if(a=c[t],"textContent"===t||"innerHTML"===t){if(e.children&&(e.children.length=0),a===l[t])continue;1===r.childNodes.length&&r.removeChild(r.childNodes[0])}if("value"===t&&"PROGRESS"!==r.tagName){r._value=a;var p=i(a)?"":String(a);Wa(r,p)&&(r.value=p)}else if("innerHTML"===t&&ma(r.tagName)&&i(r.innerHTML)){(Na=Na||document.createElement("div")).innerHTML="<svg>".concat(a,"</svg>");for(var d=Na.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;d.firstChild;)r.appendChild(d.firstChild)}else if(a!==l[t])try{r[t]=a}catch(n){}}}}function Wa(n,e){return!n.composing&&("OPTION"===n.tagName||function(n,e){var t=!0;try{t=document.activeElement!==n}catch(n){}return t&&n.value!==e}(n,e)||function(n,e){var t=n.value,a=n._vModifiers;if(o(a)){if(a.number)return b(t)!==b(e);if(a.trim)return t.trim()!==e.trim()}return t!==e}(n,e))}var Qa={create:$a,update:$a},Ga=S((function(n){var e={},t=/:(.+)/;return n.split(/;(?![^(]*\))/g).forEach((function(n){if(n){var a=n.split(t);a.length>1&&(e[a[0].trim()]=a[1].trim())}})),e}));function Va(n){var e=Ka(n.style);return n.staticStyle?z(n.staticStyle,e):e}function Ka(n){return Array.isArray(n)?A(n):"string"==typeof n?Ga(n):n}var Xa,Za=/^--/,Ya=/\s*!important$/,nr=function(n,e,t){if(Za.test(e))n.style.setProperty(e,t);else if(Ya.test(t))n.style.setProperty(M(e),t.replace(Ya,""),"important");else{var a=tr(e);if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++)n.style[a]=t[r];else n.style[a]=t}},er=["Webkit","Moz","ms"],tr=S((function(n){if(Xa=Xa||document.createElement("div").style,"filter"!==(n=T(n))&&n in Xa)return n;for(var e=n.charAt(0).toUpperCase()+n.slice(1),t=0;t<er.length;t++){var a=er[t]+e;if(a in Xa)return a}}));function ar(n,e){var t=e.data,a=n.data;if(!(i(t.staticStyle)&&i(t.style)&&i(a.staticStyle)&&i(a.style))){var r,s,l=e.elm,c=a.staticStyle,p=a.normalizedStyle||a.style||{},d=c||p,m=Ka(e.data.style)||{};e.data.normalizedStyle=o(m.__ob__)?z({},m):m;var u=function(n,e){var t,a={};if(e)for(var r=n;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(t=Va(r.data))&&z(a,t);(t=Va(n.data))&&z(a,t);for(var i=n;i=i.parent;)i.data&&(t=Va(i.data))&&z(a,t);return a}(e,!0);for(s in d)i(u[s])&&nr(l,s,"");for(s in u)(r=u[s])!==d[s]&&nr(l,s,null==r?"":r)}}var rr={create:ar,update:ar},ir=/\s+/;function or(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(ir).forEach((function(e){return n.classList.add(e)})):n.classList.add(e);else{var t=" ".concat(n.getAttribute("class")||""," ");t.indexOf(" "+e+" ")<0&&n.setAttribute("class",(t+e).trim())}}function sr(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(ir).forEach((function(e){return n.classList.remove(e)})):n.classList.remove(e),n.classList.length||n.removeAttribute("class");else{for(var t=" ".concat(n.getAttribute("class")||""," "),a=" "+e+" ";t.indexOf(a)>=0;)t=t.replace(a," ");(t=t.trim())?n.setAttribute("class",t):n.removeAttribute("class")}}function lr(n){if(n){if("object"==typeof n){var e={};return!1!==n.css&&z(e,cr(n.name||"v")),z(e,n),e}return"string"==typeof n?cr(n):void 0}}var cr=S((function(n){return{enterClass:"".concat(n,"-enter"),enterToClass:"".concat(n,"-enter-to"),enterActiveClass:"".concat(n,"-enter-active"),leaveClass:"".concat(n,"-leave"),leaveToClass:"".concat(n,"-leave-to"),leaveActiveClass:"".concat(n,"-leave-active")}})),pr=G&&!X,dr="transition",mr="transitionend",ur="animation",hr="animationend";pr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(dr="WebkitTransition",mr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(ur="WebkitAnimation",hr="webkitAnimationEnd"));var gr=G?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(n){return n()};function vr(n){gr((function(){gr(n)}))}function br(n,e){var t=n._transitionClasses||(n._transitionClasses=[]);t.indexOf(e)<0&&(t.push(e),or(n,e))}function fr(n,e){n._transitionClasses&&x(n._transitionClasses,e),sr(n,e)}function yr(n,e,t){var a=kr(n,e),r=a.type,i=a.timeout,o=a.propCount;if(!r)return t();var s="transition"===r?mr:hr,l=0,c=function(){n.removeEventListener(s,p),t()},p=function(e){e.target===n&&++l>=o&&c()};setTimeout((function(){l<o&&c()}),i+1),n.addEventListener(s,p)}var xr=/\b(transform|all)(,|$)/;function kr(n,e){var t,a=window.getComputedStyle(n),r=(a[dr+"Delay"]||"").split(", "),i=(a[dr+"Duration"]||"").split(", "),o=jr(r,i),s=(a[ur+"Delay"]||"").split(", "),l=(a[ur+"Duration"]||"").split(", "),c=jr(s,l),p=0,d=0;return"transition"===e?o>0&&(t="transition",p=o,d=i.length):"animation"===e?c>0&&(t="animation",p=c,d=l.length):d=(t=(p=Math.max(o,c))>0?o>c?"transition":"animation":null)?"transition"===t?i.length:l.length:0,{type:t,timeout:p,propCount:d,hasTransform:"transition"===t&&xr.test(a[dr+"Property"])}}function jr(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max.apply(null,e.map((function(e,t){return Sr(e)+Sr(n[t])})))}function Sr(n){return 1e3*Number(n.slice(0,-1).replace(",","."))}function wr(n,e){var t=n.elm;o(t._leaveCb)&&(t._leaveCb.cancelled=!0,t._leaveCb());var a=lr(n.data.transition);if(!i(a)&&!o(t._enterCb)&&1===t.nodeType){for(var r=a.css,s=a.type,l=a.enterClass,d=a.enterToClass,m=a.enterActiveClass,u=a.appearClass,h=a.appearToClass,g=a.appearActiveClass,v=a.beforeEnter,f=a.enter,y=a.afterEnter,x=a.enterCancelled,k=a.beforeAppear,j=a.appear,S=a.afterAppear,w=a.appearCancelled,T=a.duration,I=Me,C=Me.$vnode;C&&C.parent;)I=C.context,C=C.parent;var M=!I._isMounted||!n.isRootInsert;if(!M||j||""===j){var E=M&&u?u:l,P=M&&g?g:m,z=M&&h?h:d,A=M&&k||v,q=M&&c(j)?j:f,J=M&&S||y,L=M&&w||x,R=b(p(T)?T.enter:T);0;var _=!1!==r&&!X,B=Cr(q),D=t._enterCb=O((function(){_&&(fr(t,z),fr(t,P)),D.cancelled?(_&&fr(t,E),L&&L(t)):J&&J(t),t._enterCb=null}));n.data.show||Ln(n,"insert",(function(){var e=t.parentNode,a=e&&e._pending&&e._pending[n.key];a&&a.tag===n.tag&&a.elm._leaveCb&&a.elm._leaveCb(),q&&q(t,D)})),A&&A(t),_&&(br(t,E),br(t,P),vr((function(){fr(t,E),D.cancelled||(br(t,z),B||(Ir(R)?setTimeout(D,R):yr(t,s,D)))}))),n.data.show&&(e&&e(),q&&q(t,D)),_||B||D()}}}function Tr(n,e){var t=n.elm;o(t._enterCb)&&(t._enterCb.cancelled=!0,t._enterCb());var a=lr(n.data.transition);if(i(a)||1!==t.nodeType)return e();if(!o(t._leaveCb)){var r=a.css,s=a.type,l=a.leaveClass,c=a.leaveToClass,d=a.leaveActiveClass,m=a.beforeLeave,u=a.leave,h=a.afterLeave,g=a.leaveCancelled,v=a.delayLeave,f=a.duration,y=!1!==r&&!X,x=Cr(u),k=b(p(f)?f.leave:f);0;var j=t._leaveCb=O((function(){t.parentNode&&t.parentNode._pending&&(t.parentNode._pending[n.key]=null),y&&(fr(t,c),fr(t,d)),j.cancelled?(y&&fr(t,l),g&&g(t)):(e(),h&&h(t)),t._leaveCb=null}));v?v(S):S()}function S(){j.cancelled||(!n.data.show&&t.parentNode&&((t.parentNode._pending||(t.parentNode._pending={}))[n.key]=n),m&&m(t),y&&(br(t,l),br(t,d),vr((function(){fr(t,l),j.cancelled||(br(t,c),x||(Ir(k)?setTimeout(j,k):yr(t,s,j)))}))),u&&u(t,j),y||x||j())}}function Ir(n){return"number"==typeof n&&!isNaN(n)}function Cr(n){if(i(n))return!1;var e=n.fns;return o(e)?Cr(Array.isArray(e)?e[0]:e):(n._length||n.length)>1}function Mr(n,e){!0!==e.data.show&&wr(e)}var Er=function(n){var e,t,a={},c=n.modules,p=n.nodeOps;for(e=0;e<ka.length;++e)for(a[ka[e]]=[],t=0;t<c.length;++t)o(c[t][ka[e]])&&a[ka[e]].push(c[t][ka[e]]);function d(n){var e=p.parentNode(n);o(e)&&p.removeChild(e,n)}function m(n,e,t,r,i,l,c){if(o(n.elm)&&o(l)&&(n=l[c]=jn(n)),n.isRootInsert=!i,!function(n,e,t,r){var i=n.data;if(o(i)){var l=o(n.componentInstance)&&i.keepAlive;if(o(i=i.hook)&&o(i=i.init)&&i(n,!1),o(n.componentInstance))return u(n,e),h(t,n.elm,r),s(l)&&function(n,e,t,r){var i,s=n;for(;s.componentInstance;)if(s=s.componentInstance._vnode,o(i=s.data)&&o(i=i.transition)){for(i=0;i<a.activate.length;++i)a.activate[i](xa,s);e.push(s);break}h(t,n.elm,r)}(n,e,t,r),!0}}(n,e,t,r)){var d=n.data,m=n.children,v=n.tag;o(v)?(n.elm=n.ns?p.createElementNS(n.ns,v):p.createElement(v,n),y(n),g(n,m,e),o(d)&&b(n,e),h(t,n.elm,r)):s(n.isComment)?(n.elm=p.createComment(n.text),h(t,n.elm,r)):(n.elm=p.createTextNode(n.text),h(t,n.elm,r))}}function u(n,e){o(n.data.pendingInsert)&&(e.push.apply(e,n.data.pendingInsert),n.data.pendingInsert=null),n.elm=n.componentInstance.$el,v(n)?(b(n,e),y(n)):(fa(n),e.push(n))}function h(n,e,t){o(n)&&(o(t)?p.parentNode(t)===n&&p.insertBefore(n,e,t):p.appendChild(n,e))}function g(n,e,t){if(r(e)){0;for(var a=0;a<e.length;++a)m(e[a],t,n.elm,null,!0,e,a)}else l(n.text)&&p.appendChild(n.elm,p.createTextNode(String(n.text)))}function v(n){for(;n.componentInstance;)n=n.componentInstance._vnode;return o(n.tag)}function b(n,t){for(var r=0;r<a.create.length;++r)a.create[r](xa,n);o(e=n.data.hook)&&(o(e.create)&&e.create(xa,n),o(e.insert)&&t.push(n))}function y(n){var e;if(o(e=n.fnScopeId))p.setStyleScope(n.elm,e);else for(var t=n;t;)o(e=t.context)&&o(e=e.$options._scopeId)&&p.setStyleScope(n.elm,e),t=t.parent;o(e=Me)&&e!==n.context&&e!==n.fnContext&&o(e=e.$options._scopeId)&&p.setStyleScope(n.elm,e)}function x(n,e,t,a,r,i){for(;a<=r;++a)m(t[a],i,n,e,!1,t,a)}function k(n){var e,t,r=n.data;if(o(r))for(o(e=r.hook)&&o(e=e.destroy)&&e(n),e=0;e<a.destroy.length;++e)a.destroy[e](n);if(o(e=n.children))for(t=0;t<n.children.length;++t)k(n.children[t])}function j(n,e,t){for(;e<=t;++e){var a=n[e];o(a)&&(o(a.tag)?(S(a),k(a)):d(a.elm))}}function S(n,e){if(o(e)||o(n.data)){var t,r=a.remove.length+1;for(o(e)?e.listeners+=r:e=function(n,e){function t(){0==--t.listeners&&d(n)}return t.listeners=e,t}(n.elm,r),o(t=n.componentInstance)&&o(t=t._vnode)&&o(t.data)&&S(t,e),t=0;t<a.remove.length;++t)a.remove[t](n,e);o(t=n.data.hook)&&o(t=t.remove)?t(n,e):e()}else d(n.elm)}function w(n,e,t,a){for(var r=t;r<a;r++){var i=e[r];if(o(i)&&ja(n,i))return r}}function T(n,e,t,r,l,c){if(n!==e){o(e.elm)&&o(r)&&(e=r[l]=jn(e));var d=e.elm=n.elm;if(s(n.isAsyncPlaceholder))o(e.asyncFactory.resolved)?M(n.elm,e,t):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(n.isStatic)&&e.key===n.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=n.componentInstance;else{var u,h=e.data;o(h)&&o(u=h.hook)&&o(u=u.prepatch)&&u(n,e);var g=n.children,b=e.children;if(o(h)&&v(e)){for(u=0;u<a.update.length;++u)a.update[u](n,e);o(u=h.hook)&&o(u=u.update)&&u(n,e)}i(e.text)?o(g)&&o(b)?g!==b&&function(n,e,t,a,r){var s,l,c,d=0,u=0,h=e.length-1,g=e[0],v=e[h],b=t.length-1,f=t[0],y=t[b],k=!r;for(0;d<=h&&u<=b;)i(g)?g=e[++d]:i(v)?v=e[--h]:ja(g,f)?(T(g,f,a,t,u),g=e[++d],f=t[++u]):ja(v,y)?(T(v,y,a,t,b),v=e[--h],y=t[--b]):ja(g,y)?(T(g,y,a,t,b),k&&p.insertBefore(n,g.elm,p.nextSibling(v.elm)),g=e[++d],y=t[--b]):ja(v,f)?(T(v,f,a,t,u),k&&p.insertBefore(n,v.elm,g.elm),v=e[--h],f=t[++u]):(i(s)&&(s=Sa(e,d,h)),i(l=o(f.key)?s[f.key]:w(f,e,d,h))?m(f,a,n,g.elm,!1,t,u):ja(c=e[l],f)?(T(c,f,a,t,u),e[l]=void 0,k&&p.insertBefore(n,c.elm,g.elm)):m(f,a,n,g.elm,!1,t,u),f=t[++u]);d>h?x(n,i(t[b+1])?null:t[b+1].elm,t,u,b,a):u>b&&j(e,d,h)}(d,g,b,t,c):o(b)?(o(n.text)&&p.setTextContent(d,""),x(d,null,b,0,b.length-1,t)):o(g)?j(g,0,g.length-1):o(n.text)&&p.setTextContent(d,""):n.text!==e.text&&p.setTextContent(d,e.text),o(h)&&o(u=h.hook)&&o(u=u.postpatch)&&u(n,e)}}}function I(n,e,t){if(s(t)&&o(n.parent))n.parent.data.pendingInsert=e;else for(var a=0;a<e.length;++a)e[a].data.hook.insert(e[a])}var C=f("attrs,class,staticClass,staticStyle,key");function M(n,e,t,a){var r,i=e.tag,l=e.data,c=e.children;if(a=a||l&&l.pre,e.elm=n,s(e.isComment)&&o(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(o(l)&&(o(r=l.hook)&&o(r=r.init)&&r(e,!0),o(r=e.componentInstance)))return u(e,t),!0;if(o(i)){if(o(c))if(n.hasChildNodes())if(o(r=l)&&o(r=r.domProps)&&o(r=r.innerHTML)){if(r!==n.innerHTML)return!1}else{for(var p=!0,d=n.firstChild,m=0;m<c.length;m++){if(!d||!M(d,c[m],t,a)){p=!1;break}d=d.nextSibling}if(!p||d)return!1}else g(e,c,t);if(o(l)){var h=!1;for(var v in l)if(!C(v)){h=!0,b(e,t);break}!h&&l.class&&zn(l.class)}}else n.data!==e.text&&(n.data=e.text);return!0}return function(n,e,t,r){if(!i(e)){var l,c=!1,d=[];if(i(n))c=!0,m(e,d);else{var u=o(n.nodeType);if(!u&&ja(n,e))T(n,e,d,null,null,r);else{if(u){if(1===n.nodeType&&n.hasAttribute("data-server-rendered")&&(n.removeAttribute("data-server-rendered"),t=!0),s(t)&&M(n,e,d))return I(e,d,!0),n;l=n,n=new yn(p.tagName(l).toLowerCase(),{},[],void 0,l)}var h=n.elm,g=p.parentNode(h);if(m(e,d,h._leaveCb?null:g,p.nextSibling(h)),o(e.parent))for(var b=e.parent,f=v(e);b;){for(var y=0;y<a.destroy.length;++y)a.destroy[y](b);if(b.elm=e.elm,f){for(var x=0;x<a.create.length;++x)a.create[x](xa,b);var S=b.data.hook.insert;if(S.merged)for(var w=1;w<S.fns.length;w++)S.fns[w]()}else fa(b);b=b.parent}o(g)?j([n],0,0):o(n.tag)&&k(n)}}return I(e,d,c),e.elm}o(n)&&k(n)}}({nodeOps:va,modules:[Ja,_a,Ua,Qa,rr,G?{create:Mr,activate:Mr,remove:function(n,e){!0!==n.data.show?Tr(n,e):e()}}:{}].concat(Pa)});X&&document.addEventListener("selectionchange",(function(){var n=document.activeElement;n&&n.vmodel&&_r(n,"input")}));var Pr={inserted:function(n,e,t,a){"select"===t.tag?(a.elm&&!a.elm._vOptions?Ln(t,"postpatch",(function(){Pr.componentUpdated(n,e,t)})):zr(n,e,t.context),n._vOptions=[].map.call(n.options,Jr)):("textarea"===t.tag||ga(n.type))&&(n._vModifiers=e.modifiers,e.modifiers.lazy||(n.addEventListener("compositionstart",Lr),n.addEventListener("compositionend",Rr),n.addEventListener("change",Rr),X&&(n.vmodel=!0)))},componentUpdated:function(n,e,t){if("select"===t.tag){zr(n,e,t.context);var a=n._vOptions,r=n._vOptions=[].map.call(n.options,Jr);if(r.some((function(n,e){return!R(n,a[e])})))(n.multiple?e.value.some((function(n){return qr(n,r)})):e.value!==e.oldValue&&qr(e.value,r))&&_r(n,"change")}}};function zr(n,e,t){Ar(n,e,t),(K||Z)&&setTimeout((function(){Ar(n,e,t)}),0)}function Ar(n,e,t){var a=e.value,r=n.multiple;if(!r||Array.isArray(a)){for(var i,o,s=0,l=n.options.length;s<l;s++)if(o=n.options[s],r)i=_(a,Jr(o))>-1,o.selected!==i&&(o.selected=i);else if(R(Jr(o),a))return void(n.selectedIndex!==s&&(n.selectedIndex=s));r||(n.selectedIndex=-1)}}function qr(n,e){return e.every((function(e){return!R(e,n)}))}function Jr(n){return"_value"in n?n._value:n.value}function Lr(n){n.target.composing=!0}function Rr(n){n.target.composing&&(n.target.composing=!1,_r(n.target,"input"))}function _r(n,e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),n.dispatchEvent(t)}function Or(n){return!n.componentInstance||n.data&&n.data.transition?n:Or(n.componentInstance._vnode)}var Br={model:Pr,show:{bind:function(n,e,t){var a=e.value,r=(t=Or(t)).data&&t.data.transition,i=n.__vOriginalDisplay="none"===n.style.display?"":n.style.display;a&&r?(t.data.show=!0,wr(t,(function(){n.style.display=i}))):n.style.display=a?i:"none"},update:function(n,e,t){var a=e.value;!a!=!e.oldValue&&((t=Or(t)).data&&t.data.transition?(t.data.show=!0,a?wr(t,(function(){n.style.display=n.__vOriginalDisplay})):Tr(t,(function(){n.style.display="none"}))):n.style.display=a?n.__vOriginalDisplay:"none")},unbind:function(n,e,t,a,r){r||(n.style.display=n.__vOriginalDisplay)}}},Dr={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Hr(n){var e=n&&n.componentOptions;return e&&e.Ctor.options.abstract?Hr(Se(e.children)):n}function Fr(n){var e={},t=n.$options;for(var a in t.propsData)e[a]=n[a];var r=t._parentListeners;for(var a in r)e[T(a)]=r[a];return e}function Nr(n,e){if(/\d-keep-alive$/.test(e.tag))return n("keep-alive",{props:e.componentOptions.propsData})}var Ur=function(n){return n.tag||Nn(n)},$r=function(n){return"show"===n.name},Wr={name:"transition",props:Dr,abstract:!0,render:function(n){var e=this,t=this.$slots.default;if(t&&(t=t.filter(Ur)).length){0;var a=this.mode;0;var r=t[0];if(function(n){for(;n=n.parent;)if(n.data.transition)return!0}(this.$vnode))return r;var i=Hr(r);if(!i)return r;if(this._leaving)return Nr(n,r);var o="__transition-".concat(this._uid,"-");i.key=null==i.key?i.isComment?o+"comment":o+i.tag:l(i.key)?0===String(i.key).indexOf(o)?i.key:o+i.key:i.key;var s=(i.data||(i.data={})).transition=Fr(this),c=this._vnode,p=Hr(c);if(i.data.directives&&i.data.directives.some($r)&&(i.data.show=!0),p&&p.data&&!function(n,e){return e.key===n.key&&e.tag===n.tag}(i,p)&&!Nn(p)&&(!p.componentInstance||!p.componentInstance._vnode.isComment)){var d=p.data.transition=z({},s);if("out-in"===a)return this._leaving=!0,Ln(d,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Nr(n,r);if("in-out"===a){if(Nn(i))return c;var m,u=function(){m()};Ln(s,"afterEnter",u),Ln(s,"enterCancelled",u),Ln(d,"delayLeave",(function(n){m=n}))}}return r}}},Qr=z({tag:String,moveClass:String},Dr);function Gr(n){n.elm._moveCb&&n.elm._moveCb(),n.elm._enterCb&&n.elm._enterCb()}function Vr(n){n.data.newPos=n.elm.getBoundingClientRect()}function Kr(n){var e=n.data.pos,t=n.data.newPos,a=e.left-t.left,r=e.top-t.top;if(a||r){n.data.moved=!0;var i=n.elm.style;i.transform=i.WebkitTransform="translate(".concat(a,"px,").concat(r,"px)"),i.transitionDuration="0s"}}delete Qr.mode;var Xr={Transition:Wr,TransitionGroup:{props:Qr,beforeMount:function(){var n=this,e=this._update;this._update=function(t,a){var r=Ee(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,r(),e.call(n,t,a)}},render:function(n){for(var e=this.tag||this.$vnode.data.tag||"span",t=Object.create(null),a=this.prevChildren=this.children,r=this.$slots.default||[],i=this.children=[],o=Fr(this),s=0;s<r.length;s++){if((p=r[s]).tag)if(null!=p.key&&0!==String(p.key).indexOf("__vlist"))i.push(p),t[p.key]=p,(p.data||(p.data={})).transition=o;else;}if(a){var l=[],c=[];for(s=0;s<a.length;s++){var p;(p=a[s]).data.transition=o,p.data.pos=p.elm.getBoundingClientRect(),t[p.key]?l.push(p):c.push(p)}this.kept=n(e,null,l),this.removed=c}return n(e,null,i)},updated:function(){var n=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";n.length&&this.hasMove(n[0].elm,e)&&(n.forEach(Gr),n.forEach(Vr),n.forEach(Kr),this._reflow=document.body.offsetHeight,n.forEach((function(n){if(n.data.moved){var t=n.elm,a=t.style;br(t,e),a.transform=a.WebkitTransform=a.transitionDuration="",t.addEventListener(mr,t._moveCb=function n(a){a&&a.target!==t||a&&!/transform$/.test(a.propertyName)||(t.removeEventListener(mr,n),t._moveCb=null,fr(t,e))})}})))},methods:{hasMove:function(n,e){if(!pr)return!1;if(this._hasMove)return this._hasMove;var t=n.cloneNode();n._transitionClasses&&n._transitionClasses.forEach((function(n){sr(t,n)})),or(t,e),t.style.display="none",this.$el.appendChild(t);var a=kr(t);return this.$el.removeChild(t),this._hasMove=a.hasTransform}}}};function Zr(n,e){for(var t in e)n[t]=e[t];return n}Nt.config.mustUseProp=function(n,e,t){return"value"===t&&Zt(n)&&"button"!==e||"selected"===t&&"option"===n||"checked"===t&&"input"===n||"muted"===t&&"video"===n},Nt.config.isReservedTag=ua,Nt.config.isReservedAttr=Xt,Nt.config.getTagNamespace=function(n){return ma(n)?"svg":"math"===n?"math":void 0},Nt.config.isUnknownElement=function(n){if(!G)return!0;if(ua(n))return!1;if(n=n.toLowerCase(),null!=ha[n])return ha[n];var e=document.createElement(n);return n.indexOf("-")>-1?ha[n]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:ha[n]=/HTMLUnknownElement/.test(e.toString())},z(Nt.options.directives,Br),z(Nt.options.components,Xr),Nt.prototype.__patch__=G?Er:q,Nt.prototype.$mount=function(n,e){return function(n,e,t){var a;n.$el=e,n.$options.render||(n.$options.render=xn),Ae(n,"beforeMount"),a=function(){n._update(n._render(),t)},new Qe(n,a,q,{before:function(){n._isMounted&&!n._isDestroyed&&Ae(n,"beforeUpdate")}},!0),t=!1;var r=n._preWatchers;if(r)for(var i=0;i<r.length;i++)r[i].run();return null==n.$vnode&&(n._isMounted=!0,Ae(n,"mounted")),n}(this,n=n&&G?function(n){if("string"==typeof n){var e=document.querySelector(n);return e||document.createElement("div")}return n}(n):void 0,e)},G&&setTimeout((function(){F.devtools&&sn&&sn.emit("init",Nt)}),0);var Yr=/[!'()*]/g,ni=function(n){return"%"+n.charCodeAt(0).toString(16)},ei=/%2C/g,ti=function(n){return encodeURIComponent(n).replace(Yr,ni).replace(ei,",")};function ai(n){try{return decodeURIComponent(n)}catch(n){0}return n}var ri=function(n){return null==n||"object"==typeof n?n:String(n)};function ii(n){var e={};return(n=n.trim().replace(/^(\?|#|&)/,""))?(n.split("&").forEach((function(n){var t=n.replace(/\+/g," ").split("="),a=ai(t.shift()),r=t.length>0?ai(t.join("=")):null;void 0===e[a]?e[a]=r:Array.isArray(e[a])?e[a].push(r):e[a]=[e[a],r]})),e):e}function oi(n){var e=n?Object.keys(n).map((function(e){var t=n[e];if(void 0===t)return"";if(null===t)return ti(e);if(Array.isArray(t)){var a=[];return t.forEach((function(n){void 0!==n&&(null===n?a.push(ti(e)):a.push(ti(e)+"="+ti(n)))})),a.join("&")}return ti(e)+"="+ti(t)})).filter((function(n){return n.length>0})).join("&"):null;return e?"?"+e:""}var si=/\/?$/;function li(n,e,t,a){var r=a&&a.options.stringifyQuery,i=e.query||{};try{i=ci(i)}catch(n){}var o={name:e.name||n&&n.name,meta:n&&n.meta||{},path:e.path||"/",hash:e.hash||"",query:i,params:e.params||{},fullPath:mi(e,r),matched:n?di(n):[]};return t&&(o.redirectedFrom=mi(t,r)),Object.freeze(o)}function ci(n){if(Array.isArray(n))return n.map(ci);if(n&&"object"==typeof n){var e={};for(var t in n)e[t]=ci(n[t]);return e}return n}var pi=li(null,{path:"/"});function di(n){for(var e=[];n;)e.unshift(n),n=n.parent;return e}function mi(n,e){var t=n.path,a=n.query;void 0===a&&(a={});var r=n.hash;return void 0===r&&(r=""),(t||"/")+(e||oi)(a)+r}function ui(n,e,t){return e===pi?n===e:!!e&&(n.path&&e.path?n.path.replace(si,"")===e.path.replace(si,"")&&(t||n.hash===e.hash&&hi(n.query,e.query)):!(!n.name||!e.name)&&(n.name===e.name&&(t||n.hash===e.hash&&hi(n.query,e.query)&&hi(n.params,e.params))))}function hi(n,e){if(void 0===n&&(n={}),void 0===e&&(e={}),!n||!e)return n===e;var t=Object.keys(n).sort(),a=Object.keys(e).sort();return t.length===a.length&&t.every((function(t,r){var i=n[t];if(a[r]!==t)return!1;var o=e[t];return null==i||null==o?i===o:"object"==typeof i&&"object"==typeof o?hi(i,o):String(i)===String(o)}))}function gi(n){for(var e=0;e<n.matched.length;e++){var t=n.matched[e];for(var a in t.instances){var r=t.instances[a],i=t.enteredCbs[a];if(r&&i){delete t.enteredCbs[a];for(var o=0;o<i.length;o++)r._isBeingDestroyed||i[o](r)}}}}var vi={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(n,e){var t=e.props,a=e.children,r=e.parent,i=e.data;i.routerView=!0;for(var o=r.$createElement,s=t.name,l=r.$route,c=r._routerViewCache||(r._routerViewCache={}),p=0,d=!1;r&&r._routerRoot!==r;){var m=r.$vnode?r.$vnode.data:{};m.routerView&&p++,m.keepAlive&&r._directInactive&&r._inactive&&(d=!0),r=r.$parent}if(i.routerViewDepth=p,d){var u=c[s],h=u&&u.component;return h?(u.configProps&&bi(h,i,u.route,u.configProps),o(h,i,a)):o()}var g=l.matched[p],v=g&&g.components[s];if(!g||!v)return c[s]=null,o();c[s]={component:v},i.registerRouteInstance=function(n,e){var t=g.instances[s];(e&&t!==n||!e&&t===n)&&(g.instances[s]=e)},(i.hook||(i.hook={})).prepatch=function(n,e){g.instances[s]=e.componentInstance},i.hook.init=function(n){n.data.keepAlive&&n.componentInstance&&n.componentInstance!==g.instances[s]&&(g.instances[s]=n.componentInstance),gi(l)};var b=g.props&&g.props[s];return b&&(Zr(c[s],{route:l,configProps:b}),bi(v,i,l,b)),o(v,i,a)}};function bi(n,e,t,a){var r=e.props=function(n,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(n);case"boolean":return e?n.params:void 0;default:0}}(t,a);if(r){r=e.props=Zr({},r);var i=e.attrs=e.attrs||{};for(var o in r)n.props&&o in n.props||(i[o]=r[o],delete r[o])}}function fi(n,e,t){var a=n.charAt(0);if("/"===a)return n;if("?"===a||"#"===a)return e+n;var r=e.split("/");t&&r[r.length-1]||r.pop();for(var i=n.replace(/^\//,"").split("/"),o=0;o<i.length;o++){var s=i[o];".."===s?r.pop():"."!==s&&r.push(s)}return""!==r[0]&&r.unshift(""),r.join("/")}function yi(n){return n.replace(/\/(?:\s*\/)+/g,"/")}var xi=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)},ki=Li,ji=Ci,Si=function(n,e){return Ei(Ci(n,e),e)},wi=Ei,Ti=Ji,Ii=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function Ci(n,e){for(var t,a=[],r=0,i=0,o="",s=e&&e.delimiter||"/";null!=(t=Ii.exec(n));){var l=t[0],c=t[1],p=t.index;if(o+=n.slice(i,p),i=p+l.length,c)o+=c[1];else{var d=n[i],m=t[2],u=t[3],h=t[4],g=t[5],v=t[6],b=t[7];o&&(a.push(o),o="");var f=null!=m&&null!=d&&d!==m,y="+"===v||"*"===v,x="?"===v||"*"===v,k=t[2]||s,j=h||g;a.push({name:u||r++,prefix:m||"",delimiter:k,optional:x,repeat:y,partial:f,asterisk:!!b,pattern:j?zi(j):b?".*":"[^"+Pi(k)+"]+?"})}}return i<n.length&&(o+=n.substr(i)),o&&a.push(o),a}function Mi(n){return encodeURI(n).replace(/[\/?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()}))}function Ei(n,e){for(var t=new Array(n.length),a=0;a<n.length;a++)"object"==typeof n[a]&&(t[a]=new RegExp("^(?:"+n[a].pattern+")$",qi(e)));return function(e,a){for(var r="",i=e||{},o=(a||{}).pretty?Mi:encodeURIComponent,s=0;s<n.length;s++){var l=n[s];if("string"!=typeof l){var c,p=i[l.name];if(null==p){if(l.optional){l.partial&&(r+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(xi(p)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var d=0;d<p.length;d++){if(c=o(p[d]),!t[s].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(c)+"`");r+=(0===d?l.prefix:l.delimiter)+c}}else{if(c=l.asterisk?encodeURI(p).replace(/[?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})):o(p),!t[s].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');r+=l.prefix+c}}else r+=l}return r}}function Pi(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function zi(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function Ai(n,e){return n.keys=e,n}function qi(n){return n&&n.sensitive?"":"i"}function Ji(n,e,t){xi(e)||(t=e||t,e=[]);for(var a=(t=t||{}).strict,r=!1!==t.end,i="",o=0;o<n.length;o++){var s=n[o];if("string"==typeof s)i+=Pi(s);else{var l=Pi(s.prefix),c="(?:"+s.pattern+")";e.push(s),s.repeat&&(c+="(?:"+l+c+")*"),i+=c=s.optional?s.partial?l+"("+c+")?":"(?:"+l+"("+c+"))?":l+"("+c+")"}}var p=Pi(t.delimiter||"/"),d=i.slice(-p.length)===p;return a||(i=(d?i.slice(0,-p.length):i)+"(?:"+p+"(?=$))?"),i+=r?"$":a&&d?"":"(?="+p+"|$)",Ai(new RegExp("^"+i,qi(t)),e)}function Li(n,e,t){return xi(e)||(t=e||t,e=[]),t=t||{},n instanceof RegExp?function(n,e){var t=n.source.match(/\((?!\?)/g);if(t)for(var a=0;a<t.length;a++)e.push({name:a,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Ai(n,e)}(n,e):xi(n)?function(n,e,t){for(var a=[],r=0;r<n.length;r++)a.push(Li(n[r],e,t).source);return Ai(new RegExp("(?:"+a.join("|")+")",qi(t)),e)}(n,e,t):function(n,e,t){return Ji(Ci(n,t),e,t)}(n,e,t)}ki.parse=ji,ki.compile=Si,ki.tokensToFunction=wi,ki.tokensToRegExp=Ti;var Ri=Object.create(null);function _i(n,e,t){e=e||{};try{var a=Ri[n]||(Ri[n]=ki.compile(n));return"string"==typeof e.pathMatch&&(e[0]=e.pathMatch),a(e,{pretty:!0})}catch(n){return""}finally{delete e[0]}}function Oi(n,e,t,a){var r="string"==typeof n?{path:n}:n;if(r._normalized)return r;if(r.name){var i=(r=Zr({},n)).params;return i&&"object"==typeof i&&(r.params=Zr({},i)),r}if(!r.path&&r.params&&e){(r=Zr({},r))._normalized=!0;var o=Zr(Zr({},e.params),r.params);if(e.name)r.name=e.name,r.params=o;else if(e.matched.length){var s=e.matched[e.matched.length-1].path;r.path=_i(s,o,e.path)}else 0;return r}var l=function(n){var e="",t="",a=n.indexOf("#");a>=0&&(e=n.slice(a),n=n.slice(0,a));var r=n.indexOf("?");return r>=0&&(t=n.slice(r+1),n=n.slice(0,r)),{path:n,query:t,hash:e}}(r.path||""),c=e&&e.path||"/",p=l.path?fi(l.path,c,t||r.append):c,d=function(n,e,t){void 0===e&&(e={});var a,r=t||ii;try{a=r(n||"")}catch(n){a={}}for(var i in e){var o=e[i];a[i]=Array.isArray(o)?o.map(ri):ri(o)}return a}(l.query,r.query,a&&a.options.parseQuery),m=r.hash||l.hash;return m&&"#"!==m.charAt(0)&&(m="#"+m),{_normalized:!0,path:p,query:d,hash:m}}var Bi,Di=function(){},Hi={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(n){var e=this,t=this.$router,a=this.$route,r=t.resolve(this.to,a,this.append),i=r.location,o=r.route,s=r.href,l={},c=t.options.linkActiveClass,p=t.options.linkExactActiveClass,d=null==c?"router-link-active":c,m=null==p?"router-link-exact-active":p,u=null==this.activeClass?d:this.activeClass,h=null==this.exactActiveClass?m:this.exactActiveClass,g=o.redirectedFrom?li(null,Oi(o.redirectedFrom),null,t):o;l[h]=ui(a,g,this.exactPath),l[u]=this.exact||this.exactPath?l[h]:function(n,e){return 0===n.path.replace(si,"/").indexOf(e.path.replace(si,"/"))&&(!e.hash||n.hash===e.hash)&&function(n,e){for(var t in e)if(!(t in n))return!1;return!0}(n.query,e.query)}(a,g);var v=l[h]?this.ariaCurrentValue:null,b=function(n){Fi(n)&&(e.replace?t.replace(i,Di):t.push(i,Di))},f={click:Fi};Array.isArray(this.event)?this.event.forEach((function(n){f[n]=b})):f[this.event]=b;var y={class:l},x=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:s,route:o,navigate:b,isActive:l[u],isExactActive:l[h]});if(x){if(1===x.length)return x[0];if(x.length>1||!x.length)return 0===x.length?n():n("span",{},x)}if("a"===this.tag)y.on=f,y.attrs={href:s,"aria-current":v};else{var k=function n(e){var t;if(e)for(var a=0;a<e.length;a++){if("a"===(t=e[a]).tag)return t;if(t.children&&(t=n(t.children)))return t}}(this.$slots.default);if(k){k.isStatic=!1;var j=k.data=Zr({},k.data);for(var S in j.on=j.on||{},j.on){var w=j.on[S];S in f&&(j.on[S]=Array.isArray(w)?w:[w])}for(var T in f)T in j.on?j.on[T].push(f[T]):j.on[T]=b;var I=k.data.attrs=Zr({},k.data.attrs);I.href=s,I["aria-current"]=v}else y.on=f}return n(this.tag,y,this.$slots.default)}};function Fi(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||n.defaultPrevented||void 0!==n.button&&0!==n.button)){if(n.currentTarget&&n.currentTarget.getAttribute){var e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}var Ni="undefined"!=typeof window;function Ui(n,e,t,a,r){var i=e||[],o=t||Object.create(null),s=a||Object.create(null);n.forEach((function(n){!function n(e,t,a,r,i,o){var s=r.path,l=r.name;0;var c=r.pathToRegexpOptions||{},p=function(n,e,t){t||(n=n.replace(/\/$/,""));if("/"===n[0])return n;if(null==e)return n;return yi(e.path+"/"+n)}(s,i,c.strict);"boolean"==typeof r.caseSensitive&&(c.sensitive=r.caseSensitive);var d={path:p,regex:$i(p,c),components:r.components||{default:r.component},alias:r.alias?"string"==typeof r.alias?[r.alias]:r.alias:[],instances:{},enteredCbs:{},name:l,parent:i,matchAs:o,redirect:r.redirect,beforeEnter:r.beforeEnter,meta:r.meta||{},props:null==r.props?{}:r.components?r.props:{default:r.props}};r.children&&r.children.forEach((function(r){var i=o?yi(o+"/"+r.path):void 0;n(e,t,a,r,d,i)}));t[d.path]||(e.push(d.path),t[d.path]=d);if(void 0!==r.alias)for(var m=Array.isArray(r.alias)?r.alias:[r.alias],u=0;u<m.length;++u){0;var h={path:m[u],children:r.children};n(e,t,a,h,i,d.path||"/")}l&&(a[l]||(a[l]=d))}(i,o,s,n,r)}));for(var l=0,c=i.length;l<c;l++)"*"===i[l]&&(i.push(i.splice(l,1)[0]),c--,l--);return{pathList:i,pathMap:o,nameMap:s}}function $i(n,e){return ki(n,[],e)}function Wi(n,e){var t=Ui(n),a=t.pathList,r=t.pathMap,i=t.nameMap;function o(n,t,o){var s=Oi(n,t,!1,e),c=s.name;if(c){var p=i[c];if(!p)return l(null,s);var d=p.regex.keys.filter((function(n){return!n.optional})).map((function(n){return n.name}));if("object"!=typeof s.params&&(s.params={}),t&&"object"==typeof t.params)for(var m in t.params)!(m in s.params)&&d.indexOf(m)>-1&&(s.params[m]=t.params[m]);return s.path=_i(p.path,s.params),l(p,s,o)}if(s.path){s.params={};for(var u=0;u<a.length;u++){var h=a[u],g=r[h];if(Qi(g.regex,s.path,s.params))return l(g,s,o)}}return l(null,s)}function s(n,t){var a=n.redirect,r="function"==typeof a?a(li(n,t,null,e)):a;if("string"==typeof r&&(r={path:r}),!r||"object"!=typeof r)return l(null,t);var s=r,c=s.name,p=s.path,d=t.query,m=t.hash,u=t.params;if(d=s.hasOwnProperty("query")?s.query:d,m=s.hasOwnProperty("hash")?s.hash:m,u=s.hasOwnProperty("params")?s.params:u,c){i[c];return o({_normalized:!0,name:c,query:d,hash:m,params:u},void 0,t)}if(p){var h=function(n,e){return fi(n,e.parent?e.parent.path:"/",!0)}(p,n);return o({_normalized:!0,path:_i(h,u),query:d,hash:m},void 0,t)}return l(null,t)}function l(n,t,a){return n&&n.redirect?s(n,a||t):n&&n.matchAs?function(n,e,t){var a=o({_normalized:!0,path:_i(t,e.params)});if(a){var r=a.matched,i=r[r.length-1];return e.params=a.params,l(i,e)}return l(null,e)}(0,t,n.matchAs):li(n,t,a,e)}return{match:o,addRoute:function(n,e){var t="object"!=typeof n?i[n]:void 0;Ui([e||n],a,r,i,t),t&&t.alias.length&&Ui(t.alias.map((function(n){return{path:n,children:[e]}})),a,r,i,t)},getRoutes:function(){return a.map((function(n){return r[n]}))},addRoutes:function(n){Ui(n,a,r,i)}}}function Qi(n,e,t){var a=e.match(n);if(!a)return!1;if(!t)return!0;for(var r=1,i=a.length;r<i;++r){var o=n.keys[r-1];o&&(t[o.name||"pathMatch"]="string"==typeof a[r]?ai(a[r]):a[r])}return!0}var Gi=Ni&&window.performance&&window.performance.now?window.performance:Date;function Vi(){return Gi.now().toFixed(3)}var Ki=Vi();function Xi(){return Ki}function Zi(n){return Ki=n}var Yi=Object.create(null);function no(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var n=window.location.protocol+"//"+window.location.host,e=window.location.href.replace(n,""),t=Zr({},window.history.state);return t.key=Xi(),window.history.replaceState(t,"",e),window.addEventListener("popstate",ao),function(){window.removeEventListener("popstate",ao)}}function eo(n,e,t,a){if(n.app){var r=n.options.scrollBehavior;r&&n.app.$nextTick((function(){var i=function(){var n=Xi();if(n)return Yi[n]}(),o=r.call(n,e,t,a?i:null);o&&("function"==typeof o.then?o.then((function(n){lo(n,i)})).catch((function(n){0})):lo(o,i))}))}}function to(){var n=Xi();n&&(Yi[n]={x:window.pageXOffset,y:window.pageYOffset})}function ao(n){to(),n.state&&n.state.key&&Zi(n.state.key)}function ro(n){return oo(n.x)||oo(n.y)}function io(n){return{x:oo(n.x)?n.x:window.pageXOffset,y:oo(n.y)?n.y:window.pageYOffset}}function oo(n){return"number"==typeof n}var so=/^#\d/;function lo(n,e){var t,a="object"==typeof n;if(a&&"string"==typeof n.selector){var r=so.test(n.selector)?document.getElementById(n.selector.slice(1)):document.querySelector(n.selector);if(r){var i=n.offset&&"object"==typeof n.offset?n.offset:{};e=function(n,e){var t=document.documentElement.getBoundingClientRect(),a=n.getBoundingClientRect();return{x:a.left-t.left-e.x,y:a.top-t.top-e.y}}(r,i={x:oo((t=i).x)?t.x:0,y:oo(t.y)?t.y:0})}else ro(n)&&(e=io(n))}else a&&ro(n)&&(e=io(n));e&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:e.x,top:e.y,behavior:n.behavior}):window.scrollTo(e.x,e.y))}var co,po=Ni&&((-1===(co=window.navigator.userAgent).indexOf("Android 2.")&&-1===co.indexOf("Android 4.0")||-1===co.indexOf("Mobile Safari")||-1!==co.indexOf("Chrome")||-1!==co.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function mo(n,e){to();var t=window.history;try{if(e){var a=Zr({},t.state);a.key=Xi(),t.replaceState(a,"",n)}else t.pushState({key:Zi(Vi())},"",n)}catch(t){window.location[e?"replace":"assign"](n)}}function uo(n){mo(n,!0)}function ho(n,e,t){var a=function(r){r>=n.length?t():n[r]?e(n[r],(function(){a(r+1)})):a(r+1)};a(0)}var go={redirected:2,aborted:4,cancelled:8,duplicated:16};function vo(n,e){return fo(n,e,go.redirected,'Redirected when going from "'+n.fullPath+'" to "'+function(n){if("string"==typeof n)return n;if("path"in n)return n.path;var e={};return yo.forEach((function(t){t in n&&(e[t]=n[t])})),JSON.stringify(e,null,2)}(e)+'" via a navigation guard.')}function bo(n,e){return fo(n,e,go.cancelled,'Navigation cancelled from "'+n.fullPath+'" to "'+e.fullPath+'" with a new navigation.')}function fo(n,e,t,a){var r=new Error(a);return r._isRouter=!0,r.from=n,r.to=e,r.type=t,r}var yo=["params","query","hash"];function xo(n){return Object.prototype.toString.call(n).indexOf("Error")>-1}function ko(n,e){return xo(n)&&n._isRouter&&(null==e||n.type===e)}function jo(n){return function(e,t,a){var r=!1,i=0,o=null;So(n,(function(n,e,t,s){if("function"==typeof n&&void 0===n.cid){r=!0,i++;var l,c=Io((function(e){var r;((r=e).__esModule||To&&"Module"===r[Symbol.toStringTag])&&(e=e.default),n.resolved="function"==typeof e?e:Bi.extend(e),t.components[s]=e,--i<=0&&a()})),p=Io((function(n){var e="Failed to resolve async component "+s+": "+n;o||(o=xo(n)?n:new Error(e),a(o))}));try{l=n(c,p)}catch(n){p(n)}if(l)if("function"==typeof l.then)l.then(c,p);else{var d=l.component;d&&"function"==typeof d.then&&d.then(c,p)}}})),r||a()}}function So(n,e){return wo(n.map((function(n){return Object.keys(n.components).map((function(t){return e(n.components[t],n.instances[t],n,t)}))})))}function wo(n){return Array.prototype.concat.apply([],n)}var To="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function Io(n){var e=!1;return function(){for(var t=[],a=arguments.length;a--;)t[a]=arguments[a];if(!e)return e=!0,n.apply(this,t)}}var Co=function(n,e){this.router=n,this.base=function(n){if(!n)if(Ni){var e=document.querySelector("base");n=(n=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else n="/";"/"!==n.charAt(0)&&(n="/"+n);return n.replace(/\/$/,"")}(e),this.current=pi,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function Mo(n,e,t,a){var r=So(n,(function(n,a,r,i){var o=function(n,e){"function"!=typeof n&&(n=Bi.extend(n));return n.options[e]}(n,e);if(o)return Array.isArray(o)?o.map((function(n){return t(n,a,r,i)})):t(o,a,r,i)}));return wo(a?r.reverse():r)}function Eo(n,e){if(e)return function(){return n.apply(e,arguments)}}Co.prototype.listen=function(n){this.cb=n},Co.prototype.onReady=function(n,e){this.ready?n():(this.readyCbs.push(n),e&&this.readyErrorCbs.push(e))},Co.prototype.onError=function(n){this.errorCbs.push(n)},Co.prototype.transitionTo=function(n,e,t){var a,r=this;try{a=this.router.match(n,this.current)}catch(n){throw this.errorCbs.forEach((function(e){e(n)})),n}var i=this.current;this.confirmTransition(a,(function(){r.updateRoute(a),e&&e(a),r.ensureURL(),r.router.afterHooks.forEach((function(n){n&&n(a,i)})),r.ready||(r.ready=!0,r.readyCbs.forEach((function(n){n(a)})))}),(function(n){t&&t(n),n&&!r.ready&&(ko(n,go.redirected)&&i===pi||(r.ready=!0,r.readyErrorCbs.forEach((function(e){e(n)}))))}))},Co.prototype.confirmTransition=function(n,e,t){var a=this,r=this.current;this.pending=n;var i,o,s=function(n){!ko(n)&&xo(n)&&(a.errorCbs.length?a.errorCbs.forEach((function(e){e(n)})):console.error(n)),t&&t(n)},l=n.matched.length-1,c=r.matched.length-1;if(ui(n,r)&&l===c&&n.matched[l]===r.matched[c])return this.ensureURL(),n.hash&&eo(this.router,r,n,!1),s(((o=fo(i=r,n,go.duplicated,'Avoided redundant navigation to current location: "'+i.fullPath+'".')).name="NavigationDuplicated",o));var p=function(n,e){var t,a=Math.max(n.length,e.length);for(t=0;t<a&&n[t]===e[t];t++);return{updated:e.slice(0,t),activated:e.slice(t),deactivated:n.slice(t)}}(this.current.matched,n.matched),d=p.updated,m=p.deactivated,u=p.activated,h=[].concat(function(n){return Mo(n,"beforeRouteLeave",Eo,!0)}(m),this.router.beforeHooks,function(n){return Mo(n,"beforeRouteUpdate",Eo)}(d),u.map((function(n){return n.beforeEnter})),jo(u)),g=function(e,t){if(a.pending!==n)return s(bo(r,n));try{e(n,r,(function(e){!1===e?(a.ensureURL(!0),s(function(n,e){return fo(n,e,go.aborted,'Navigation aborted from "'+n.fullPath+'" to "'+e.fullPath+'" via a navigation guard.')}(r,n))):xo(e)?(a.ensureURL(!0),s(e)):"string"==typeof e||"object"==typeof e&&("string"==typeof e.path||"string"==typeof e.name)?(s(vo(r,n)),"object"==typeof e&&e.replace?a.replace(e):a.push(e)):t(e)}))}catch(n){s(n)}};ho(h,g,(function(){ho(function(n){return Mo(n,"beforeRouteEnter",(function(n,e,t,a){return function(n,e,t){return function(a,r,i){return n(a,r,(function(n){"function"==typeof n&&(e.enteredCbs[t]||(e.enteredCbs[t]=[]),e.enteredCbs[t].push(n)),i(n)}))}}(n,t,a)}))}(u).concat(a.router.resolveHooks),g,(function(){if(a.pending!==n)return s(bo(r,n));a.pending=null,e(n),a.router.app&&a.router.app.$nextTick((function(){gi(n)}))}))}))},Co.prototype.updateRoute=function(n){this.current=n,this.cb&&this.cb(n)},Co.prototype.setupListeners=function(){},Co.prototype.teardown=function(){this.listeners.forEach((function(n){n()})),this.listeners=[],this.current=pi,this.pending=null};var Po=function(n){function e(e,t){n.call(this,e,t),this._startLocation=zo(this.base)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router,t=e.options.scrollBehavior,a=po&&t;a&&this.listeners.push(no());var r=function(){var t=n.current,r=zo(n.base);n.current===pi&&r===n._startLocation||n.transitionTo(r,(function(n){a&&eo(e,n,t,!0)}))};window.addEventListener("popstate",r),this.listeners.push((function(){window.removeEventListener("popstate",r)}))}},e.prototype.go=function(n){window.history.go(n)},e.prototype.push=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){mo(yi(a.base+n.fullPath)),eo(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){uo(yi(a.base+n.fullPath)),eo(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.ensureURL=function(n){if(zo(this.base)!==this.current.fullPath){var e=yi(this.base+this.current.fullPath);n?mo(e):uo(e)}},e.prototype.getCurrentLocation=function(){return zo(this.base)},e}(Co);function zo(n){var e=window.location.pathname,t=e.toLowerCase(),a=n.toLowerCase();return!n||t!==a&&0!==t.indexOf(yi(a+"/"))||(e=e.slice(n.length)),(e||"/")+window.location.search+window.location.hash}var Ao=function(n){function e(e,t,a){n.call(this,e,t),a&&function(n){var e=zo(n);if(!/^\/#/.test(e))return window.location.replace(yi(n+"/#"+e)),!0}(this.base)||qo()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router.options.scrollBehavior,t=po&&e;t&&this.listeners.push(no());var a=function(){var e=n.current;qo()&&n.transitionTo(Jo(),(function(a){t&&eo(n.router,a,e,!0),po||_o(a.fullPath)}))},r=po?"popstate":"hashchange";window.addEventListener(r,a),this.listeners.push((function(){window.removeEventListener(r,a)}))}},e.prototype.push=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){Ro(n.fullPath),eo(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){_o(n.fullPath),eo(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.go=function(n){window.history.go(n)},e.prototype.ensureURL=function(n){var e=this.current.fullPath;Jo()!==e&&(n?Ro(e):_o(e))},e.prototype.getCurrentLocation=function(){return Jo()},e}(Co);function qo(){var n=Jo();return"/"===n.charAt(0)||(_o("/"+n),!1)}function Jo(){var n=window.location.href,e=n.indexOf("#");return e<0?"":n=n.slice(e+1)}function Lo(n){var e=window.location.href,t=e.indexOf("#");return(t>=0?e.slice(0,t):e)+"#"+n}function Ro(n){po?mo(Lo(n)):window.location.hash=n}function _o(n){po?uo(Lo(n)):window.location.replace(Lo(n))}var Oo=function(n){function e(e,t){n.call(this,e,t),this.stack=[],this.index=-1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.push=function(n,e,t){var a=this;this.transitionTo(n,(function(n){a.stack=a.stack.slice(0,a.index+1).concat(n),a.index++,e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var a=this;this.transitionTo(n,(function(n){a.stack=a.stack.slice(0,a.index).concat(n),e&&e(n)}),t)},e.prototype.go=function(n){var e=this,t=this.index+n;if(!(t<0||t>=this.stack.length)){var a=this.stack[t];this.confirmTransition(a,(function(){var n=e.current;e.index=t,e.updateRoute(a),e.router.afterHooks.forEach((function(e){e&&e(a,n)}))}),(function(n){ko(n,go.duplicated)&&(e.index=t)}))}},e.prototype.getCurrentLocation=function(){var n=this.stack[this.stack.length-1];return n?n.fullPath:"/"},e.prototype.ensureURL=function(){},e}(Co),Bo=function(n){void 0===n&&(n={}),this.app=null,this.apps=[],this.options=n,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=Wi(n.routes||[],this);var e=n.mode||"hash";switch(this.fallback="history"===e&&!po&&!1!==n.fallback,this.fallback&&(e="hash"),Ni||(e="abstract"),this.mode=e,e){case"history":this.history=new Po(this,n.base);break;case"hash":this.history=new Ao(this,n.base,this.fallback);break;case"abstract":this.history=new Oo(this,n.base);break;default:0}},Do={currentRoute:{configurable:!0}};function Ho(n,e){return n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}}Bo.prototype.match=function(n,e,t){return this.matcher.match(n,e,t)},Do.currentRoute.get=function(){return this.history&&this.history.current},Bo.prototype.init=function(n){var e=this;if(this.apps.push(n),n.$once("hook:destroyed",(function(){var t=e.apps.indexOf(n);t>-1&&e.apps.splice(t,1),e.app===n&&(e.app=e.apps[0]||null),e.app||e.history.teardown()})),!this.app){this.app=n;var t=this.history;if(t instanceof Po||t instanceof Ao){var a=function(n){t.setupListeners(),function(n){var a=t.current,r=e.options.scrollBehavior;po&&r&&"fullPath"in n&&eo(e,n,a,!1)}(n)};t.transitionTo(t.getCurrentLocation(),a,a)}t.listen((function(n){e.apps.forEach((function(e){e._route=n}))}))}},Bo.prototype.beforeEach=function(n){return Ho(this.beforeHooks,n)},Bo.prototype.beforeResolve=function(n){return Ho(this.resolveHooks,n)},Bo.prototype.afterEach=function(n){return Ho(this.afterHooks,n)},Bo.prototype.onReady=function(n,e){this.history.onReady(n,e)},Bo.prototype.onError=function(n){this.history.onError(n)},Bo.prototype.push=function(n,e,t){var a=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){a.history.push(n,e,t)}));this.history.push(n,e,t)},Bo.prototype.replace=function(n,e,t){var a=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){a.history.replace(n,e,t)}));this.history.replace(n,e,t)},Bo.prototype.go=function(n){this.history.go(n)},Bo.prototype.back=function(){this.go(-1)},Bo.prototype.forward=function(){this.go(1)},Bo.prototype.getMatchedComponents=function(n){var e=n?n.matched?n:this.resolve(n).route:this.currentRoute;return e?[].concat.apply([],e.matched.map((function(n){return Object.keys(n.components).map((function(e){return n.components[e]}))}))):[]},Bo.prototype.resolve=function(n,e,t){var a=Oi(n,e=e||this.history.current,t,this),r=this.match(a,e),i=r.redirectedFrom||r.fullPath;return{location:a,route:r,href:function(n,e,t){var a="hash"===t?"#"+e:e;return n?yi(n+"/"+a):a}(this.history.base,i,this.mode),normalizedTo:a,resolved:r}},Bo.prototype.getRoutes=function(){return this.matcher.getRoutes()},Bo.prototype.addRoute=function(n,e){this.matcher.addRoute(n,e),this.history.current!==pi&&this.history.transitionTo(this.history.getCurrentLocation())},Bo.prototype.addRoutes=function(n){this.matcher.addRoutes(n),this.history.current!==pi&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(Bo.prototype,Do),Bo.install=function n(e){if(!n.installed||Bi!==e){n.installed=!0,Bi=e;var t=function(n){return void 0!==n},a=function(n,e){var a=n.$options._parentVnode;t(a)&&t(a=a.data)&&t(a=a.registerRouteInstance)&&a(n,e)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,a(this,this)},destroyed:function(){a(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",vi),e.component("RouterLink",Hi);var r=e.config.optionMergeStrategies;r.beforeRouteEnter=r.beforeRouteLeave=r.beforeRouteUpdate=r.created}},Bo.version="3.5.4",Bo.isNavigationFailure=ko,Bo.NavigationFailureType=go,Bo.START_LOCATION=pi,Ni&&window.Vue&&window.Vue.use(Bo);var Fo=Bo;t(101);t(124);var No={NotFound:()=>Promise.all([t.e(0),t.e(4)]).then(t.bind(null,320)),Layout:()=>Promise.all([t.e(0),t.e(2)]).then(t.bind(null,319))},Uo={"v-4b99dd20":()=>t.e(5).then(t.bind(null,322)),"v-27772cc0":()=>t.e(6).then(t.bind(null,323)),"v-576f0972":()=>t.e(7).then(t.bind(null,324)),"v-62a8b34c":()=>t.e(8).then(t.bind(null,325)),"v-1ee597b8":()=>t.e(9).then(t.bind(null,326)),"v-17a7d10c":()=>t.e(10).then(t.bind(null,327)),"v-75ecbd16":()=>t.e(11).then(t.bind(null,328)),"v-f0e9a0d2":()=>t.e(12).then(t.bind(null,329)),"v-0a24b240":()=>t.e(13).then(t.bind(null,330)),"v-2626d1fc":()=>t.e(14).then(t.bind(null,331)),"v-34fe61e4":()=>t.e(15).then(t.bind(null,332)),"v-00b2ebc6":()=>t.e(16).then(t.bind(null,333)),"v-612590a5":()=>t.e(17).then(t.bind(null,334)),"v-b09ed4f4":()=>t.e(18).then(t.bind(null,335)),"v-08c5e54c":()=>t.e(19).then(t.bind(null,336)),"v-8b222c70":()=>t.e(20).then(t.bind(null,337)),"v-101ee2a2":()=>t.e(21).then(t.bind(null,338)),"v-6441b580":()=>t.e(22).then(t.bind(null,339)),"v-7d156502":()=>t.e(23).then(t.bind(null,340)),"v-ae223d88":()=>t.e(24).then(t.bind(null,341)),"v-d649585e":()=>t.e(25).then(t.bind(null,342)),"v-6589cc90":()=>t.e(26).then(t.bind(null,343)),"v-cba3920e":()=>t.e(27).then(t.bind(null,344)),"v-d7044cd0":()=>t.e(28).then(t.bind(null,345)),"v-09c4ff2e":()=>t.e(29).then(t.bind(null,346)),"v-2040598b":()=>t.e(30).then(t.bind(null,347)),"v-69d50af2":()=>t.e(31).then(t.bind(null,348)),"v-f12e4400":()=>t.e(32).then(t.bind(null,349)),"v-5d502cb7":()=>t.e(33).then(t.bind(null,350)),"v-1a600385":()=>t.e(34).then(t.bind(null,351)),"v-1a493fea":()=>t.e(35).then(t.bind(null,352)),"v-19f95e8b":()=>t.e(36).then(t.bind(null,353)),"v-46ed506a":()=>t.e(37).then(t.bind(null,354)),"v-1f33db24":()=>t.e(38).then(t.bind(null,355)),"v-415dc8b8":()=>t.e(39).then(t.bind(null,356)),"v-4f0d9490":()=>t.e(40).then(t.bind(null,357)),"v-d23f2b76":()=>t.e(41).then(t.bind(null,358)),"v-199c639b":()=>t.e(42).then(t.bind(null,359)),"v-2507e04a":()=>t.e(43).then(t.bind(null,360)),"v-696c277c":()=>t.e(44).then(t.bind(null,361)),"v-783c66c8":()=>t.e(45).then(t.bind(null,362)),"v-eb512f24":()=>t.e(46).then(t.bind(null,363)),"v-a63f00f0":()=>t.e(47).then(t.bind(null,364)),"v-438f9dca":()=>t.e(48).then(t.bind(null,365)),"v-c5441038":()=>t.e(49).then(t.bind(null,366)),"v-f8abeb6c":()=>t.e(50).then(t.bind(null,367)),"v-955934dc":()=>t.e(51).then(t.bind(null,368)),"v-63d503f0":()=>t.e(52).then(t.bind(null,369)),"v-f2154a58":()=>t.e(53).then(t.bind(null,370)),"v-dbf118bc":()=>t.e(54).then(t.bind(null,371)),"v-65004ca6":()=>t.e(55).then(t.bind(null,372)),"v-35c0dec5":()=>t.e(56).then(t.bind(null,373)),"v-066da6f7":()=>t.e(57).then(t.bind(null,374)),"v-aab99b9a":()=>t.e(58).then(t.bind(null,375)),"v-4c05d3a6":()=>t.e(59).then(t.bind(null,376)),"v-ed73b8ba":()=>t.e(60).then(t.bind(null,377)),"v-af4ff908":()=>t.e(61).then(t.bind(null,378)),"v-96ecc776":()=>t.e(62).then(t.bind(null,379)),"v-58178384":()=>t.e(63).then(t.bind(null,380)),"v-7f048411":()=>t.e(64).then(t.bind(null,381)),"v-1fe197ae":()=>t.e(65).then(t.bind(null,382)),"v-31a4aa1d":()=>t.e(66).then(t.bind(null,383)),"v-03cb9ec2":()=>t.e(67).then(t.bind(null,384)),"v-448a2646":()=>t.e(68).then(t.bind(null,385)),"v-6aa69b5a":()=>t.e(69).then(t.bind(null,386)),"v-6140a136":()=>t.e(70).then(t.bind(null,387)),"v-5df11448":()=>t.e(71).then(t.bind(null,388)),"v-f41b300c":()=>t.e(72).then(t.bind(null,389)),"v-2525a60d":()=>t.e(73).then(t.bind(null,390)),"v-fa0cf7f8":()=>t.e(74).then(t.bind(null,391)),"v-47099c49":()=>t.e(75).then(t.bind(null,392)),"v-d302b38c":()=>t.e(76).then(t.bind(null,393)),"v-16f33bda":()=>t.e(77).then(t.bind(null,394)),"v-1f77f9ec":()=>t.e(78).then(t.bind(null,395)),"v-94737480":()=>t.e(79).then(t.bind(null,396)),"v-c4a07c5e":()=>t.e(80).then(t.bind(null,397)),"v-a9382712":()=>t.e(81).then(t.bind(null,398)),"v-9e9dd666":()=>t.e(82).then(t.bind(null,399)),"v-04cda89e":()=>t.e(83).then(t.bind(null,400)),"v-5d493111":()=>t.e(84).then(t.bind(null,401)),"v-26877d31":()=>t.e(85).then(t.bind(null,402)),"v-10d1fe8a":()=>t.e(86).then(t.bind(null,321))};function $o(n){const e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}const Wo=/-(\w)/g,Qo=$o(n=>n.replace(Wo,(n,e)=>e?e.toUpperCase():"")),Go=/\B([A-Z])/g,Vo=$o(n=>n.replace(Go,"-$1").toLowerCase()),Ko=$o(n=>n.charAt(0).toUpperCase()+n.slice(1));function Xo(n,e){if(!e)return;if(n(e))return n(e);return e.includes("-")?n(Ko(Qo(e))):n(Ko(e))||n(Vo(e))}const Zo=Object.assign({},No,Uo),Yo=n=>Zo[n],ns=n=>Uo[n],es=n=>No[n],ts=n=>Nt.component(n);function as(n){return Xo(ns,n)}function rs(n){return Xo(es,n)}function is(n){return Xo(Yo,n)}function os(n){return Xo(ts,n)}function ss(...n){return Promise.all(n.filter(n=>n).map(async n=>{if(!os(n)&&is(n)){const e=await is(n)();Nt.component(n,e.default)}}))}function ls(n,e){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[n]=e)}var cs=t(90),ps=t.n(cs),ds=t(91),ms=t.n(ds),us={created(){if(this.siteMeta=this.$site.headTags.filter(([n])=>"meta"===n).map(([n,e])=>e),this.$ssrContext){const e=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(n=e)?n.map(n=>{let e="<meta";return Object.keys(n).forEach(t=>{e+=` ${t}="${ms()(n[t])}"`}),e+">"}).join("\n    "):"",this.$ssrContext.canonicalLink=gs(this.$canonicalUrl)}var n},mounted(){this.currentMetaTags=[...document.querySelectorAll("meta")],this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta(){document.title=this.$title,document.documentElement.lang=this.$lang;const n=this.getMergedMetaTags();this.currentMetaTags=vs(n,this.currentMetaTags)},getMergedMetaTags(){const n=this.$page.frontmatter.meta||[];return ps()([{name:"description",content:this.$description}],n,this.siteMeta,bs)},updateCanonicalLink(){hs(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",gs(this.$canonicalUrl))}},watch:{$page(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy(){vs(null,this.currentMetaTags),hs()}};function hs(){const n=document.querySelector("link[rel='canonical']");n&&n.remove()}function gs(n=""){return n?`<link href="${n}" rel="canonical" />`:""}function vs(n,e){if(e&&[...e].filter(n=>n.parentNode===document.head).forEach(n=>document.head.removeChild(n)),n)return n.map(n=>{const e=document.createElement("meta");return Object.keys(n).forEach(t=>{e.setAttribute(t,n[t])}),document.head.appendChild(e),e})}function bs(n){for(const e of["name","property","itemprop"])if(n.hasOwnProperty(e))return n[e]+e;return JSON.stringify(n)}var fs=t(49),ys={mounted(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:t.n(fs)()((function(){this.setActiveHash()}),300),setActiveHash(){const n=[].slice.call(document.querySelectorAll(".sidebar-link")),e=[].slice.call(document.querySelectorAll(".header-anchor")).filter(e=>n.some(n=>n.hash===e.hash)),t=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),r=window.innerHeight+t;for(let n=0;n<e.length;n++){const i=e[n],o=e[n+1],s=0===n&&0===t||t>=i.parentElement.offsetTop+10&&(!o||t<o.parentElement.offsetTop-10),l=decodeURIComponent(this.$route.hash);if(s&&l!==decodeURIComponent(i.hash)){const t=i;if(r===a)for(let t=n+1;t<e.length;t++)if(l===decodeURIComponent(e[t].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(t.hash),()=>{this.$nextTick(()=>{this.$vuepress.$set("disableScrollBehavior",!1)})})}}}},beforeDestroy(){window.removeEventListener("scroll",this.onScroll)}},xs=t(23),ks=t.n(xs),js={mounted(){ks.a.configure({showSpinner:!1}),this.$router.beforeEach((n,e,t)=>{n.path===e.path||Nt.component(n.name)||ks.a.start(),t()}),this.$router.afterEach(()=>{ks.a.done(),this.isSidebarOpen=!1})}};t(231),t(232);class Ss{constructor(){this.containerEl=document.getElementById("message-container"),this.containerEl||(this.containerEl=document.createElement("div"),this.containerEl.id="message-container",document.body.appendChild(this.containerEl))}show({text:n="",duration:e=3e3}){let t=document.createElement("div");t.className="message move-in",t.innerHTML=`\n      <i style="fill: #06a35a;font-size: 14px;display:inline-flex;align-items: center;">\n        <svg style="fill: #06a35a;font-size: 14px;" t="1572421810237" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2323" width="16" height="16"><path d="M822.811993 824.617989c-83.075838 81.99224-188.546032 124.613757-316.049383 127.86455-122.085362-3.250794-223.943563-45.87231-305.935802-127.86455s-124.613757-184.21164-127.86455-305.935802c3.250794-127.503351 45.87231-232.973545 127.86455-316.049383 81.99224-83.075838 184.21164-126.058554 305.935802-129.309347 127.503351 3.250794 232.973545 46.23351 316.049383 129.309347 83.075838 83.075838 126.058554 188.546032 129.309347 316.049383C949.231746 640.406349 905.887831 742.62575 822.811993 824.617989zM432.716755 684.111464c3.973192 3.973192 8.307584 5.779189 13.364374 6.140388 5.05679 0.361199 9.752381-1.444797 13.364374-5.417989l292.571429-287.514638c3.973192-3.973192 5.779189-8.307584 5.779189-13.364374 0-5.05679-1.805996-9.752381-5.779189-13.364374l1.805996 1.805996c-3.973192-3.973192-8.668783-5.779189-14.086772-6.140388-5.417989-0.361199-10.47478 1.444797-14.809171 5.417989l-264.397884 220.33157c-3.973192 3.250794-8.668783 4.695591-14.447972 4.695591-5.779189 0-10.835979-1.444797-15.53157-3.973192l-94.273016-72.962257c-4.334392-3.250794-9.391182-4.334392-14.447972-3.973192s-9.391182 3.250794-12.641975 7.585185l-2.889594 3.973192c-3.250794 4.334392-4.334392 9.391182-3.973192 14.809171 0.722399 5.417989 2.528395 10.11358 5.779189 14.086772L432.716755 684.111464z" p-id="2324"></path></svg>\n      </i>\n      <div class="text">${n}</div>\n    `,this.containerEl.appendChild(t),e>0&&setTimeout(()=>{this.close(t)},e)}close(n){n.className=n.className.replace("move-in",""),n.className+="move-out",n.addEventListener("animationend",()=>{n.remove()})}}var ws={mounted(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},updated(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},methods:{updateCopy(){setTimeout(()=>{(['div[class*="language-"] pre','div[class*="aside-code"] aside']instanceof Array||Array.isArray(['div[class*="language-"] pre','div[class*="aside-code"] aside']))&&['div[class*="language-"] pre','div[class*="aside-code"] aside'].forEach(n=>{document.querySelectorAll(n).forEach(this.generateCopyButton)})},1e3)},generateCopyButton(n){if(n.classList.contains("codecopy-enabled"))return;const e=document.createElement("i");e.className="code-copy",e.innerHTML='<svg  style="color:#aaa;font-size:14px" t="1572422231464" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3201" width="14" height="14"><path d="M866.461538 39.384615H354.461538c-43.323077 0-78.769231 35.446154-78.76923 78.769231v39.384616h472.615384c43.323077 0 78.769231 35.446154 78.769231 78.76923v551.384616h39.384615c43.323077 0 78.769231-35.446154 78.769231-78.769231V118.153846c0-43.323077-35.446154-78.769231-78.769231-78.769231z m-118.153846 275.692308c0-43.323077-35.446154-78.769231-78.76923-78.769231H157.538462c-43.323077 0-78.769231 35.446154-78.769231 78.769231v590.769231c0 43.323077 35.446154 78.769231 78.769231 78.769231h512c43.323077 0 78.769231-35.446154 78.76923-78.769231V315.076923z m-354.461538 137.846154c0 11.815385-7.876923 19.692308-19.692308 19.692308h-157.538461c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h157.538461c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z m157.538461 315.076923c0 11.815385-7.876923 19.692308-19.692307 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h315.076923c11.815385 0 19.692308 7.876923 19.692307 19.692308v39.384615z m78.769231-157.538462c0 11.815385-7.876923 19.692308-19.692308 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h393.846153c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z" p-id="3202"></path></svg>',e.title="Copy to clipboard",e.addEventListener("click",()=>{this.copyToClipboard(n.innerText)}),n.appendChild(e),n.classList.add("codecopy-enabled")},copyToClipboard(n){const e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);const t=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy");(new Ss).show({text:"å¤å¶æå",duration:1e3}),document.body.removeChild(e),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))}}};!function(n,e){void 0===e&&(e={});var t=e.insertAt;if(n&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&a.firstChild?a.insertBefore(r,a.firstChild):a.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}}("@media (max-width: 1000px) {\n  .vuepress-plugin-demo-block__h_code {\n    display: none;\n  }\n  .vuepress-plugin-demo-block__app {\n    margin-left: auto !important;\n    margin-right: auto !important;\n  }\n}\n.vuepress-plugin-demo-block__wrapper {\n  margin-top: 10px;\n  border: 1px solid #ebebeb;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display {\n  height: 400px;\n  display: flex;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__app {\n  width: 300px;\n  border: 1px solid #ebebeb;\n  box-shadow: 1px 1px 3px #ebebeb;\n  margin-right: 5px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code {\n  flex: 1;\n  overflow: auto;\n  height: 100%;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code > pre {\n  overflow: visible;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  max-height: 400px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper div {\n  box-sizing: border-box;\n}\n.vuepress-plugin-demo-block__wrapper:hover {\n  box-shadow: 0 0 11px rgba(33, 33, 33, 0.2);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code {\n  overflow: hidden;\n  height: 0;\n  padding: 0 !important;\n  background-color: #282c34;\n  border-radius: 0 !important;\n  transition: height 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code pre {\n  margin: 0 !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  padding: 20px;\n  border-bottom: 1px solid #ebebeb;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer {\n  position: relative;\n  text-align: center;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__codepen {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__expand::before {\n  border-top: none;\n  border-right: 6px solid transparent;\n  border-bottom: 6px solid #ccc;\n  border-left: 6px solid transparent;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__codepen,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand span,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand::before {\n  border-top-color: #3eaf7c !important;\n  border-bottom-color: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover svg {\n  fill: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand-text {\n  transition: all 0.5s;\n  opacity: 0;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:nth-last-child(2) {\n  right: 50px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:last-child {\n  right: 10px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button {\n  border-color: transparent;\n  background-color: transparent;\n  font-size: 14px;\n  color: #3eaf7c;\n  cursor: pointer;\n  outline: none;\n  margin: 0;\n  width: 46px;\n  position: relative;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::before {\n  content: attr(data-tip);\n  white-space: nowrap;\n  position: absolute;\n  top: -30px;\n  left: 50%;\n  color: #eee;\n  line-height: 1;\n  z-index: 1000;\n  border-radius: 4px;\n  padding: 6px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::after {\n  content: '' !important;\n  display: block;\n  position: absolute;\n  left: 50%;\n  top: -5px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  border: 5px solid transparent;\n  border-top-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button svg {\n  width: 34px;\n  height: 20px;\n  fill: #ccc;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__codepen {\n  position: absolute;\n  top: 10px;\n  transition: all 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand {\n  position: relative;\n  width: 100px;\n  height: 40px;\n  margin: 0;\n  color: #3eaf7c;\n  font-size: 14px;\n  background-color: transparent;\n  border-color: transparent;\n  outline: none;\n  transition: all 0.5s;\n  cursor: pointer;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand::before {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-top: 6px solid #ccc;\n  border-right: 6px solid transparent;\n  border-left: 6px solid transparent;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n");var Ts={jsLib:[],cssLib:[],jsfiddle:!0,codepen:!0,codepenLayout:"left",codepenJsProcessor:"babel",codepenEditors:"101",horizontal:!1,vue:"https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js",react:"https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js",reactDOM:"https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"},Is={},Cs=function(n){return'<div id="app">\n'.concat(n,"\n</div>")},Ms=function(n){return window.$VUEPRESS_DEMO_BLOCK&&void 0!==window.$VUEPRESS_DEMO_BLOCK[n]?window.$VUEPRESS_DEMO_BLOCK[n]:Ts[n]},Es=function n(e,t,a){var r=document.createElement(e);return t&&Object.keys(t).forEach((function(n){if(n.indexOf("data"))r[n]=t[n];else{var e=n.replace("data","");r.dataset[e]=t[n]}})),a&&a.forEach((function(e){var t=e.tag,a=e.attrs,i=e.children;r.appendChild(n(t,a,i))})),r},Ps=function(n,e,t){var a,r=(a=n.querySelectorAll(".".concat(e)),Array.prototype.slice.call(a));return 1!==r.length||t?r:r[0]},zs=function(n,e){var t,a,r=n.match(/<style>([\s\S]+)<\/style>/),i=n.match(/<template>([\s\S]+)<\/template>/),o=n.match(/<script>([\s\S]+)<\/script>/),s={css:r&&r[1].replace(/^\n|\n$/g,""),html:i&&i[1].replace(/^\n|\n$/g,""),js:o&&o[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};s.htmlTpl=Cs(s.html),s.jsTpl=(t=s.js,a=t.replace(/export\s+default\s*?\{\n*/,"").replace(/\n*\}\s*$/,"").trim(),"new Vue({\n  el: '#app',\n  ".concat(a,"\n})")),s.script=function(n,e){var t=n.split(/export\s+default/),a="(function() {".concat(t[0]," ; return ").concat(t[1],"})()"),r=window.Babel?window.Babel.transform(a,{presets:["es2015"]}).code:a,i=[eval][0](r);return i.template=e,i}(s.js,s.html);var l=Ms("vue");return s.jsLib.unshift(l),s},As=function(n,e){var t,a=n.match(/<style>([\s\S]+)<\/style>/),r=n.match(/<html>([\s\S]+)<\/html>/),i=n.match(/<script>([\s\S]+)<\/script>/),o={css:a&&a[1].replace(/^\n|\n$/g,""),html:r&&r[1].replace(/^\n|\n$/g,""),js:i&&i[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};return o.htmlTpl=o.html,o.jsTpl=o.js,o.script=(t=o.js,window.Babel?window.Babel.transform(t,{presets:["es2015"]}).code:t),o},qs=function(n){return n=n.replace("export default ","").replace(/App\.__style__(\s*)=(\s*)`([\s\S]*)?`/,""),n+='ReactDOM.render(React.createElement(App), document.getElementById("app"))'};function Js(){var n=Ps(document,"vuepress-plugin-demo-block__wrapper",!0);n.length?n.forEach((function(n){if("true"!==n.dataset.created){n.style.display="block";var e=Ps(n,"vuepress-plugin-demo-block__code"),t=Ps(n,"vuepress-plugin-demo-block__display"),a=Ps(n,"vuepress-plugin-demo-block__footer"),r=Ps(t,"vuepress-plugin-demo-block__app"),i=decodeURIComponent(n.dataset.code),o=decodeURIComponent(n.dataset.config),s=decodeURIComponent(n.dataset.type);o=o?JSON.parse(o):{};var l=e.querySelector("div").clientHeight,c="react"===s?function(n,e){var t=(0,window.Babel.transform)(n,{presets:["es2015","react"]}).code,a="(function(exports){var module={};module.exports=exports;".concat(t,";return module.exports.__esModule?module.exports.default:module.exports;})({})"),r=new Function("return ".concat(a))(),i={js:r,css:r.__style__||"",jsLib:e.jsLib||[],cssLib:e.cssLib||[],jsTpl:qs(n),htmlTpl:Cs("")},o=Ms("react"),s=Ms("reactDOM");return i.jsLib.unshift(o,s),i}(i,o):"vanilla"===s?As(i,o):zs(i,o),p=Es("button",{className:"".concat("vuepress-plugin-demo-block__expand")});if(a.appendChild(p),p.addEventListener("click",Ls.bind(null,p,l,e,a)),Ms("jsfiddle")&&a.appendChild(function(n){var e=n.css,t=n.htmlTpl,a=n.jsTpl,r=n.jsLib,i=n.cssLib,o=r.concat(i).concat(Ms("cssLib")).concat(Ms("jsLib")).join(",");return Es("form",{className:"vuepress-plugin-demo-block__jsfiddle",target:"_blank",action:"https://jsfiddle.net/api/post/library/pure/",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"css",value:e}},{tag:"input",attrs:{type:"hidden",name:"html",value:t}},{tag:"input",attrs:{type:"hidden",name:"js",value:a}},{tag:"input",attrs:{type:"hidden",name:"panel_js",value:3}},{tag:"input",attrs:{type:"hidden",name:"wrap",value:1}},{tag:"input",attrs:{type:"hidden",name:"resources",value:o}},{tag:"button",attrs:{type:"submit",className:"vuepress-plugin-demo-block__button",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088289967" class="icon" style="" viewBox="0 0 1170 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1952" xmlns:xlink="http://www.w3.org/1999/xlink" width="228.515625" height="200"><defs><style type="text/css"></style></defs><path d="M1028.571429 441.142857q63.428571 26.285714 102.571428 83.142857T1170.285714 650.857143q0 93.714286-67.428571 160.285714T940 877.714286q-2.285714 0-6.571429-0.285715t-6-0.285714H232q-97.142857-5.714286-164.571429-71.714286T0 645.142857q0-62.857143 31.428571-116t84-84q-6.857143-22.285714-6.857142-46.857143 0-65.714286 46.857142-112t113.714286-46.285714q54.285714 0 98.285714 33.142857 42.857143-88 127.142858-141.714286t186.571428-53.714285q94.857143 0 174.857143 46T982.571429 248.571429t46.571428 172q0 3.428571-0.285714 10.285714t-0.285714 10.285714zM267.428571 593.142857q0 69.714286 48 110.285714t118.857143 40.571429q78.285714 0 137.142857-56.571429-9.142857-11.428571-27.142857-32.285714T519.428571 626.285714q-38.285714 37.142857-82.285714 37.142857-31.428571 0-53.428571-19.142857T361.714286 594.285714q0-30.285714 22-49.714285t52.285714-19.428572q25.142857 0 48.285714 12t41.714286 31.428572 37.142857 42.857142 39.428572 46.857143 44 42.857143 55.428571 31.428572 69.428571 12q69.142857 0 116.857143-40.857143T936 594.857143q0-69.142857-48-109.714286t-118.285714-40.571428q-81.714286 0-137.714286 55.428571l53.142857 61.714286q37.714286-36.571429 81.142857-36.571429 29.714286 0 52.571429 18.857143t22.857143 48q0 32.571429-21.142857 52.285714t-53.714286 19.714286q-24.571429 0-47.142857-12t-41.142857-31.428571-37.428572-42.857143-39.714286-46.857143-44.285714-42.857143-55.142857-31.428571T434.285714 444.571429q-69.714286 0-118.285714 40.285714T267.428571 593.142857z" p-id="1953"></path></svg>',datatip:"JSFiddle"}}])}(c)),Ms("codepen")&&a.appendChild(function(n){var e=n.css,t=n.htmlTpl,a=n.jsTpl,r=n.jsLib,i=n.cssLib,o=JSON.stringify({css:e,html:t,js:a,js_external:r.concat(Ms("jsLib")).join(";"),css_external:i.concat(Ms("cssLib")).join(";"),layout:Ms("codepenLayout"),js_pre_processor:Ms("codepenJsProcessor"),editors:Ms("codepenEditors")});return Es("form",{className:"vuepress-plugin-demo-block__codepen",target:"_blank",action:"https://codepen.io/pen/define",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"data",value:o}},{tag:"button",attrs:{type:"submit",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088271207" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1737" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M123.428571 668l344.571429 229.714286v-205.142857L277.142857 565.142857z m-35.428571-82.285714l110.285714-73.714286-110.285714-73.714286v147.428572z m468 312l344.571429-229.714286-153.714286-102.857143-190.857143 127.428572v205.142857z m-44-281.714286l155.428571-104-155.428571-104-155.428571 104zM277.142857 458.857143l190.857143-127.428572V126.285714L123.428571 356z m548.571429 53.142857l110.285714 73.714286V438.285714z m-78.857143-53.142857l153.714286-102.857143-344.571429-229.714286v205.142857z m277.142857-102.857143v312q0 23.428571-19.428571 36.571429l-468 312q-12 7.428571-24.571429 7.428571t-24.571429-7.428571L19.428571 704.571429q-19.428571-13.142857-19.428571-36.571429V356q0-23.428571 19.428571-36.571429L487.428571 7.428571q12-7.428571 24.571429-7.428571t24.571429 7.428571l468 312q19.428571 13.142857 19.428571 36.571429z" p-id="1738"></path></svg>',className:"vuepress-plugin-demo-block__button",datatip:"Codepen"}}])}(c)),void 0!==o.horizontal?o.horizontal:Ms("horizontal")){n.classList.add("vuepress-plugin-demo-block__horizontal");var d=e.firstChild.cloneNode(!0);d.classList.add("vuepress-plugin-demo-block__h_code"),t.appendChild(d)}if(c.css&&function(n){if(!Is[n]){var e=Es("style",{innerHTML:n});document.body.appendChild(e),Is[n]=!0}}(c.css),"react"===s)ReactDOM.render(React.createElement(c.js),r);else if("vue"===s){var m=(new(Vue.extend(c.script))).$mount();r.appendChild(m.$el)}else"vanilla"===s&&(r.innerHTML=c.html,new Function("return (function(){".concat(c.script,"})()"))());n.dataset.created="true"}})):setTimeout((function(n){Js()}),300)}function Ls(n,e,t,a){var r="1"!==n.dataset.isExpand;t.style.height=r?"".concat(e,"px"):0,r?a.classList.add("vuepress-plugin-demo-block__show-link"):a.classList.remove("vuepress-plugin-demo-block__show-link"),n.dataset.isExpand=r?"1":"0"}var Rs={mounted:function(){window.$VUEPRESS_DEMO_BLOCK={jsfiddle:!1,codepen:!0,horizontal:!1},Js()},updated:function(){Js()}},_s="auto",Os="zoom-in",Bs="zoom-out",Ds="grab",Hs="move";function Fs(n,e,t){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r={passive:!1};a?n.addEventListener(e,t,r):n.removeEventListener(e,t,r)}function Ns(n,e){if(n){var t=new Image;t.onload=function(){e&&e(t)},t.src=n}}function Us(n){return n.dataset.original?n.dataset.original:"A"===n.parentNode.tagName?n.parentNode.getAttribute("href"):null}function $s(n,e,t){!function(n){var e=Ws,t=Qs;if(n.transition){var a=n.transition;delete n.transition,n[e]=a}if(n.transform){var r=n.transform;delete n.transform,n[t]=r}}(e);var a=n.style,r={};for(var i in e)t&&(r[i]=a[i]||""),a[i]=e[i];return r}var Ws="transition",Qs="transform",Gs="transform",Vs="transitionend";var Ks=function(){},Xs={enableGrab:!0,preloadImage:!1,closeOnWindowResize:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,zIndex:998,customSize:null,onOpen:Ks,onClose:Ks,onGrab:Ks,onMove:Ks,onRelease:Ks,onBeforeOpen:Ks,onBeforeClose:Ks,onBeforeGrab:Ks,onBeforeRelease:Ks,onImageLoading:Ks,onImageLoaded:Ks},Zs={init:function(n){var e,t;e=this,t=n,Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(n){e[n]=e[n].bind(t)}))},click:function(n){if(n.preventDefault(),nl(n))return window.open(this.target.srcOriginal||n.currentTarget.src,"_blank");this.shown?this.released?this.close():this.release():this.open(n.currentTarget)},scroll:function(){var n=document.documentElement||document.body.parentNode||document.body,e=window.pageXOffset||n.scrollLeft,t=window.pageYOffset||n.scrollTop;null===this.lastScrollPosition&&(this.lastScrollPosition={x:e,y:t});var a=this.lastScrollPosition.x-e,r=this.lastScrollPosition.y-t,i=this.options.scrollThreshold;(Math.abs(r)>=i||Math.abs(a)>=i)&&(this.lastScrollPosition=null,this.close())},keydown:function(n){(function(n){return"Escape"===(n.key||n.code)||27===n.keyCode})(n)&&(this.released?this.close():this.release(this.close))},mousedown:function(n){if(Ys(n)&&!nl(n)){n.preventDefault();var e=n.clientX,t=n.clientY;this.pressTimer=setTimeout(function(){this.grab(e,t)}.bind(this),200)}},mousemove:function(n){this.released||this.move(n.clientX,n.clientY)},mouseup:function(n){Ys(n)&&!nl(n)&&(clearTimeout(this.pressTimer),this.released?this.close():this.release())},touchstart:function(n){n.preventDefault();var e=n.touches[0],t=e.clientX,a=e.clientY;this.pressTimer=setTimeout(function(){this.grab(t,a)}.bind(this),200)},touchmove:function(n){if(!this.released){var e=n.touches[0],t=e.clientX,a=e.clientY;this.move(t,a)}},touchend:function(n){(function(n){n.targetTouches.length})(n)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())},clickOverlay:function(){this.close()},resizeWindow:function(){this.close()}};function Ys(n){return 0===n.button}function nl(n){return n.metaKey||n.ctrlKey}var el={init:function(n){this.el=document.createElement("div"),this.instance=n,this.parent=document.body,$s(this.el,{position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0}),this.updateStyle(n.options),Fs(this.el,"click",n.handler.clickOverlay.bind(n))},updateStyle:function(n){$s(this.el,{zIndex:n.zIndex,backgroundColor:n.bgColor,transition:"opacity\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction})},insert:function(){this.parent.appendChild(this.el)},remove:function(){this.parent.removeChild(this.el)},fadeIn:function(){this.el.offsetWidth,this.el.style.opacity=this.instance.options.bgOpacity},fadeOut:function(){this.el.style.opacity=0}},tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},al=function(){function n(n,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}(),rl=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},il={init:function(n,e){this.el=n,this.instance=e,this.srcThumbnail=this.el.getAttribute("src"),this.srcset=this.el.getAttribute("srcset"),this.srcOriginal=Us(this.el),this.rect=this.el.getBoundingClientRect(),this.translate=null,this.scale=null,this.styleOpen=null,this.styleClose=null},zoomIn:function(){var n=this.instance.options,e=n.zIndex,t=n.enableGrab,a=n.transitionDuration,r=n.transitionTimingFunction;this.translate=this.calculateTranslate(),this.scale=this.calculateScale(),this.styleOpen={position:"relative",zIndex:e+1,cursor:t?Ds:Bs,transition:Gs+"\n        "+a+"s\n        "+r,transform:"translate3d("+this.translate.x+"px, "+this.translate.y+"px, 0px)\n        scale("+this.scale.x+","+this.scale.y+")",height:this.rect.height+"px",width:this.rect.width+"px"},this.el.offsetWidth,this.styleClose=$s(this.el,this.styleOpen,!0)},zoomOut:function(){this.el.offsetWidth,$s(this.el,{transform:"none"})},grab:function(n,e,t){var a=ol(),r=a.x-n,i=a.y-e;$s(this.el,{cursor:Hs,transform:"translate3d(\n        "+(this.translate.x+r)+"px, "+(this.translate.y+i)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},move:function(n,e,t){var a=ol(),r=a.x-n,i=a.y-e;$s(this.el,{transition:Gs,transform:"translate3d(\n        "+(this.translate.x+r)+"px, "+(this.translate.y+i)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},restoreCloseStyle:function(){$s(this.el,this.styleClose)},restoreOpenStyle:function(){$s(this.el,this.styleOpen)},upgradeSource:function(){if(this.srcOriginal){var n=this.el.parentNode;this.srcset&&this.el.removeAttribute("srcset");var e=this.el.cloneNode(!1);e.setAttribute("src",this.srcOriginal),e.style.position="fixed",e.style.visibility="hidden",n.appendChild(e),setTimeout(function(){this.el.setAttribute("src",this.srcOriginal),n.removeChild(e)}.bind(this),50)}},downgradeSource:function(){this.srcOriginal&&(this.srcset&&this.el.setAttribute("srcset",this.srcset),this.el.setAttribute("src",this.srcThumbnail))},calculateTranslate:function(){var n=ol(),e=this.rect.left+this.rect.width/2,t=this.rect.top+this.rect.height/2;return{x:n.x-e,y:n.y-t}},calculateScale:function(){var n=this.el.dataset,e=n.zoomingHeight,t=n.zoomingWidth,a=this.instance.options,r=a.customSize,i=a.scaleBase;if(!r&&e&&t)return{x:t/this.rect.width,y:e/this.rect.height};if(r&&"object"===(void 0===r?"undefined":tl(r)))return{x:r.width/this.rect.width,y:r.height/this.rect.height};var o=this.rect.width/2,s=this.rect.height/2,l=ol(),c={x:l.x-o,y:l.y-s},p=c.x/o,d=c.y/s,m=i+Math.min(p,d);if(r&&"string"==typeof r){var u=t||this.el.naturalWidth,h=e||this.el.naturalHeight,g=parseFloat(r)*u/(100*this.rect.width),v=parseFloat(r)*h/(100*this.rect.height);if(m>g||m>v)return{x:g,y:v}}return{x:m,y:m}}};function ol(){var n=document.documentElement;return{x:Math.min(n.clientWidth,window.innerWidth)/2,y:Math.min(n.clientHeight,window.innerHeight)/2}}function sl(n,e,t){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach((function(a){Fs(n,a,e[a],t)}))}var ll=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.target=Object.create(il),this.overlay=Object.create(el),this.handler=Object.create(Zs),this.body=document.body,this.shown=!1,this.lock=!1,this.released=!0,this.lastScrollPosition=null,this.pressTimer=null,this.options=rl({},Xs,e),this.overlay.init(this),this.handler.init(this)}return al(n,[{key:"listen",value:function(n){if("string"==typeof n)for(var e=document.querySelectorAll(n),t=e.length;t--;)this.listen(e[t]);else"IMG"===n.tagName&&(n.style.cursor=Os,Fs(n,"click",this.handler.click),this.options.preloadImage&&Ns(Us(n)));return this}},{key:"config",value:function(n){return n?(rl(this.options,n),this.overlay.updateStyle(this.options),this):this.options}},{key:"open",value:function(n){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.onOpen;if(!this.shown&&!this.lock){var a="string"==typeof n?document.querySelector(n):n;if("IMG"===a.tagName){if(this.options.onBeforeOpen(a),this.target.init(a,this),!this.options.preloadImage){var r=this.target.srcOriginal;null!=r&&(this.options.onImageLoading(a),Ns(r,this.options.onImageLoaded))}this.shown=!0,this.lock=!0,this.target.zoomIn(),this.overlay.insert(),this.overlay.fadeIn(),Fs(document,"scroll",this.handler.scroll),Fs(document,"keydown",this.handler.keydown),this.options.closeOnWindowResize&&Fs(window,"resize",this.handler.resizeWindow);var i=function n(){Fs(a,Vs,n,!1),e.lock=!1,e.target.upgradeSource(),e.options.enableGrab&&sl(document,e.handler,!0),t(a)};return Fs(a,Vs,i),this}}}},{key:"close",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onClose;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeClose(t),this.lock=!0,this.body.style.cursor=_s,this.overlay.fadeOut(),this.target.zoomOut(),Fs(document,"scroll",this.handler.scroll,!1),Fs(document,"keydown",this.handler.keydown,!1),this.options.closeOnWindowResize&&Fs(window,"resize",this.handler.resizeWindow,!1);var a=function a(){Fs(t,Vs,a,!1),n.shown=!1,n.lock=!1,n.target.downgradeSource(),n.options.enableGrab&&sl(document,n.handler,!1),n.target.restoreCloseStyle(),n.overlay.remove(),e(t)};return Fs(t,Vs,a),this}}},{key:"grab",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onGrab;if(this.shown&&!this.lock){var r=this.target.el;this.options.onBeforeGrab(r),this.released=!1,this.target.grab(n,e,t);var i=function n(){Fs(r,Vs,n,!1),a(r)};return Fs(r,Vs,i),this}}},{key:"move",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onMove;if(this.shown&&!this.lock){this.released=!1,this.body.style.cursor=Hs,this.target.move(n,e,t);var r=this.target.el,i=function n(){Fs(r,Vs,n,!1),a(r)};return Fs(r,Vs,i),this}}},{key:"release",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onRelease;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeRelease(t),this.lock=!0,this.body.style.cursor=_s,this.target.restoreOpenStyle();var a=function a(){Fs(t,Vs,a,!1),n.lock=!1,n.released=!0,e(t)};return Fs(t,Vs,a),this}}}]),n}();const cl=JSON.parse('{"bgColor":"rgba(0,0,0,0.6)"}'),pl=Number("500");class dl{constructor(){this.instance=new ll(cl)}update(n=".theme-vdoing-content img:not(.no-zoom)"){"undefined"!=typeof window&&this.instance.listen(n)}updateDelay(n=".theme-vdoing-content img:not(.no-zoom)",e=pl){setTimeout(()=>this.update(n),e)}}var ml=[us,ys,js,ws,Rs,{watch:{"$page.path"(){void 0!==this.$vuepress.zooming&&this.$vuepress.zooming.updateDelay()}},mounted(){this.$vuepress.zooming=new dl,this.$vuepress.zooming.updateDelay()}}],ul={name:"GlobalLayout",computed:{layout(){const n=this.getLayout();return ls("layout",n),Nt.component(n)}},methods:{getLayout(){if(this.$page.path){const n=this.$page.frontmatter.layout;return n&&(this.$vuepress.getLayoutAsyncComponent(n)||this.$vuepress.getVueComponent(n))?n:"Layout"}return"NotFound"}}},hl=t(6),gl=Object(hl.a)(ul,(function(){return(0,this._self._c)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(n,e,t){switch(e){case"components":n[e]||(n[e]={}),Object.assign(n[e],t);break;case"mixins":n[e]||(n[e]=[]),n[e].push(...t);break;default:throw new Error("Unknown option name.")}}(gl,"mixins",ml);const vl=[{name:"v-4b99dd20",path:"/pages/be093b/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-4b99dd20").then(t)}},{path:"/pages/be093b/index.html",redirect:"/pages/be093b/"},{path:"/02.JavaEE/01.JavaWeb/01.JavaWebä¹Servletæå.html",redirect:"/pages/be093b/"},{name:"v-27772cc0",path:"/pages/6bbb16/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-27772cc0").then(t)}},{path:"/pages/6bbb16/index.html",redirect:"/pages/6bbb16/"},{path:"/02.JavaEE/01.JavaWeb/02.JavaWebä¹Jspæå.html",redirect:"/pages/6bbb16/"},{name:"v-576f0972",path:"/pages/5ecb29/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-576f0972").then(t)}},{path:"/pages/5ecb29/index.html",redirect:"/pages/5ecb29/"},{path:"/02.JavaEE/01.JavaWeb/03.JavaWebä¹FilteråListener.html",redirect:"/pages/5ecb29/"},{name:"v-62a8b34c",path:"/pages/e61883/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-62a8b34c").then(t)}},{path:"/pages/e61883/index.html",redirect:"/pages/e61883/"},{path:"/02.JavaEE/01.JavaWeb/04.JavaWebä¹CookieåSession.html",redirect:"/pages/e61883/"},{name:"v-1ee597b8",path:"/pages/1933b3/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-1ee597b8").then(t)}},{path:"/pages/1933b3/index.html",redirect:"/pages/1933b3/"},{path:"/02.JavaEE/01.JavaWeb/99.JavaWebé¢ç».html",redirect:"/pages/1933b3/"},{name:"v-17a7d10c",path:"/pages/c1cee9/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-17a7d10c").then(t)}},{path:"/pages/c1cee9/index.html",redirect:"/pages/c1cee9/"},{path:"/02.JavaEE/01.JavaWeb/",redirect:"/pages/c1cee9/"},{name:"v-75ecbd16",path:"/pages/c50d2b/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-75ecbd16").then(t)}},{path:"/pages/c50d2b/index.html",redirect:"/pages/c50d2b/"},{path:"/02.JavaEE/02.æå¡å¨/01.Tomcat/01.Tomcatå¿«éå¥é¨.html",redirect:"/pages/c50d2b/"},{name:"v-f0e9a0d2",path:"/pages/3c954b/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-f0e9a0d2").then(t)}},{path:"/pages/3c954b/index.html",redirect:"/pages/3c954b/"},{path:"/02.JavaEE/02.æå¡å¨/01.Tomcat/02.Tomcatè¿æ¥å¨.html",redirect:"/pages/3c954b/"},{name:"v-0a24b240",path:"/pages/2fea08/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-0a24b240").then(t)}},{path:"/pages/2fea08/index.html",redirect:"/pages/2fea08/"},{path:"/02.JavaEE/02.æå¡å¨/01.Tomcat/03.Tomcatå®¹å¨.html",redirect:"/pages/2fea08/"},{name:"v-2626d1fc",path:"/pages/6c22f4/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-2626d1fc").then(t)}},{path:"/pages/6c22f4/index.html",redirect:"/pages/6c22f4/"},{path:"/02.JavaEE/02.æå¡å¨/01.Tomcat/04.Tomcatä¼å.html",redirect:"/pages/6c22f4/"},{name:"v-34fe61e4",path:"/pages/f1bba6/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-34fe61e4").then(t)}},{path:"/pages/f1bba6/index.html",redirect:"/pages/f1bba6/"},{path:"/02.JavaEE/02.æå¡å¨/01.Tomcat/05.TomcatåJetty.html",redirect:"/pages/f1bba6/"},{name:"v-00b2ebc6",path:"/pages/86288e/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-00b2ebc6").then(t)}},{path:"/pages/86288e/index.html",redirect:"/pages/86288e/"},{path:"/02.JavaEE/02.æå¡å¨/01.Tomcat/",redirect:"/pages/86288e/"},{name:"v-612590a5",path:"/pages/9ecdc1/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-612590a5").then(t)}},{path:"/pages/9ecdc1/index.html",redirect:"/pages/9ecdc1/"},{path:"/02.JavaEE/02.æå¡å¨/02.Jetty.html",redirect:"/pages/9ecdc1/"},{name:"v-b09ed4f4",path:"/pages/9d17ce/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-b09ed4f4").then(t)}},{path:"/pages/9d17ce/index.html",redirect:"/pages/9d17ce/"},{path:"/02.JavaEE/02.æå¡å¨/",redirect:"/pages/9d17ce/"},{name:"v-08c5e54c",path:"/pages/ca58e7/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-08c5e54c").then(t)}},{path:"/pages/ca58e7/index.html",redirect:"/pages/ca58e7/"},{path:"/02.JavaEE/",redirect:"/pages/ca58e7/"},{name:"v-8b222c70",path:"/pages/6b8149/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-8b222c70").then(t)}},{path:"/pages/6b8149/index.html",redirect:"/pages/6b8149/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/01.Mavenå¿«éå¥é¨.html",redirect:"/pages/6b8149/"},{name:"v-101ee2a2",path:"/pages/f594fa/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-101ee2a2").then(t)}},{path:"/pages/f594fa/index.html",redirect:"/pages/f594fa/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/02.Mavenæç¨ä¹pom.xmlè¯¦è§£.html",redirect:"/pages/f594fa/"},{name:"v-6441b580",path:"/pages/d05c38/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-6441b580").then(t)}},{path:"/pages/d05c38/index.html",redirect:"/pages/d05c38/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/03.Mavenæç¨ä¹settings.xmlè¯¦è§£.html",redirect:"/pages/d05c38/"},{name:"v-7d156502",path:"/pages/7908f2/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-7d156502").then(t)}},{path:"/pages/7908f2/index.html",redirect:"/pages/7908f2/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/04.Mavenå®æé®é¢åæä½³å®è·µ.html",redirect:"/pages/7908f2/"},{name:"v-ae223d88",path:"/pages/2ddf04/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-ae223d88").then(t)}},{path:"/pages/2ddf04/index.html",redirect:"/pages/2ddf04/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/05.Mavenæç¨ä¹åå¸jarå°ç§ææä¸­å¤®ä»åº.html",redirect:"/pages/2ddf04/"},{name:"v-d649585e",path:"/pages/149013/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-d649585e").then(t)}},{path:"/pages/149013/index.html",redirect:"/pages/149013/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/06.Mavenæä»¶ä¹ä»£ç æ£æ¥.html",redirect:"/pages/149013/"},{name:"v-6589cc90",path:"/pages/14735b/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-6589cc90").then(t)}},{path:"/pages/14735b/index.html",redirect:"/pages/14735b/"},{path:"/11.è½¯ä»¶/01.æå»º/01.Maven/",redirect:"/pages/14735b/"},{name:"v-cba3920e",path:"/pages/e2af3a/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-cba3920e").then(t)}},{path:"/pages/e2af3a/index.html",redirect:"/pages/e2af3a/"},{path:"/11.è½¯ä»¶/01.æå»º/02.Ant.html",redirect:"/pages/e2af3a/"},{name:"v-d7044cd0",path:"/pages/95388e/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-d7044cd0").then(t)}},{path:"/pages/95388e/index.html",redirect:"/pages/95388e/"},{path:"/11.è½¯ä»¶/01.æå»º/",redirect:"/pages/95388e/"},{name:"v-09c4ff2e",path:"/pages/ea83ee/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-09c4ff2e").then(t)}},{path:"/pages/ea83ee/index.html",redirect:"/pages/ea83ee/"},{path:"/11.è½¯ä»¶/02.IDE/01.Intellij.html",redirect:"/pages/ea83ee/"},{name:"v-2040598b",path:"/pages/a897a9/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-2040598b").then(t)}},{path:"/pages/a897a9/index.html",redirect:"/pages/a897a9/"},{path:"/11.è½¯ä»¶/02.IDE/02.Eclipse.html",redirect:"/pages/a897a9/"},{name:"v-69d50af2",path:"/pages/a537c7/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-69d50af2").then(t)}},{path:"/pages/a537c7/index.html",redirect:"/pages/a537c7/"},{path:"/11.è½¯ä»¶/02.IDE/03.VsCode.html",redirect:"/pages/a537c7/"},{name:"v-f12e4400",path:"/pages/2df5ea/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-f12e4400").then(t)}},{path:"/pages/2df5ea/index.html",redirect:"/pages/2df5ea/"},{path:"/11.è½¯ä»¶/02.IDE/",redirect:"/pages/2df5ea/"},{name:"v-5d502cb7",path:"/pages/c7c5ec/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-5d502cb7").then(t)}},{path:"/pages/c7c5ec/index.html",redirect:"/pages/c7c5ec/"},{path:"/11.è½¯ä»¶/03.çæ§è¯æ­/01.çæ§å·¥å·å¯¹æ¯.html",redirect:"/pages/c7c5ec/"},{name:"v-1a600385",path:"/pages/83e684/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-1a600385").then(t)}},{path:"/pages/83e684/index.html",redirect:"/pages/83e684/"},{path:"/11.è½¯ä»¶/03.çæ§è¯æ­/02.CAT.html",redirect:"/pages/83e684/"},{name:"v-1a493fea",path:"/pages/82c168/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-1a493fea").then(t)}},{path:"/pages/82c168/index.html",redirect:"/pages/82c168/"},{path:"/11.è½¯ä»¶/03.çæ§è¯æ­/03.Zipkin.html",redirect:"/pages/82c168/"},{name:"v-19f95e8b",path:"/pages/d82d3c/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-19f95e8b").then(t)}},{path:"/pages/d82d3c/index.html",redirect:"/pages/d82d3c/"},{path:"/11.è½¯ä»¶/03.çæ§è¯æ­/04.Skywalking.html",redirect:"/pages/d82d3c/"},{name:"v-46ed506a",path:"/pages/b6a542/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-46ed506a").then(t)}},{path:"/pages/b6a542/index.html",redirect:"/pages/b6a542/"},{path:"/11.è½¯ä»¶/03.çæ§è¯æ­/05.Arthas.html",redirect:"/pages/b6a542/"},{name:"v-1f33db24",path:"/pages/2853ec/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-1f33db24").then(t)}},{path:"/pages/2853ec/index.html",redirect:"/pages/2853ec/"},{path:"/11.è½¯ä»¶/03.çæ§è¯æ­/",redirect:"/pages/2853ec/"},{name:"v-415dc8b8",path:"/pages/dab057/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-415dc8b8").then(t)}},{path:"/pages/dab057/index.html",redirect:"/pages/dab057/"},{path:"/11.è½¯ä»¶/",redirect:"/pages/dab057/"},{name:"v-4f0d9490",path:"/pages/a14952/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-4f0d9490").then(t)}},{path:"/pages/a14952/index.html",redirect:"/pages/a14952/"},{path:"/12.å·¥å·/01.IO/01.JSONåºåå.html",redirect:"/pages/a14952/"},{name:"v-d23f2b76",path:"/pages/95f25b/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-d23f2b76").then(t)}},{path:"/pages/95f25b/index.html",redirect:"/pages/95f25b/"},{path:"/12.å·¥å·/01.IO/02.äºè¿å¶åºåå.html",redirect:"/pages/95f25b/"},{name:"v-199c639b",path:"/pages/0358e9/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-199c639b").then(t)}},{path:"/pages/0358e9/index.html",redirect:"/pages/0358e9/"},{path:"/12.å·¥å·/01.IO/",redirect:"/pages/0358e9/"},{name:"v-2507e04a",path:"/pages/0d31cd/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-2507e04a").then(t)}},{path:"/pages/0d31cd/index.html",redirect:"/pages/0d31cd/"},{path:"/12.å·¥å·/02.JavaBean/01.Lombok.html",redirect:"/pages/0d31cd/"},{name:"v-696c277c",path:"/pages/596174/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-696c277c").then(t)}},{path:"/pages/596174/index.html",redirect:"/pages/596174/"},{path:"/12.å·¥å·/02.JavaBean/02.Dozer.html",redirect:"/pages/596174/"},{name:"v-783c66c8",path:"/pages/34ec25/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-783c66c8").then(t)}},{path:"/pages/34ec25/index.html",redirect:"/pages/34ec25/"},{path:"/12.å·¥å·/03.æ¨¡æ¿å¼æ/01.Freemark.html",redirect:"/pages/34ec25/"},{name:"v-eb512f24",path:"/pages/2263fb/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-eb512f24").then(t)}},{path:"/pages/2263fb/index.html",redirect:"/pages/2263fb/"},{path:"/12.å·¥å·/03.æ¨¡æ¿å¼æ/02.Thymeleaf.html",redirect:"/pages/2263fb/"},{name:"v-a63f00f0",path:"/pages/7ecb81/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-a63f00f0").then(t)}},{path:"/pages/7ecb81/index.html",redirect:"/pages/7ecb81/"},{path:"/12.å·¥å·/03.æ¨¡æ¿å¼æ/03.Velocity.html",redirect:"/pages/7ecb81/"},{name:"v-438f9dca",path:"/pages/9a5880/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-438f9dca").then(t)}},{path:"/pages/9a5880/index.html",redirect:"/pages/9a5880/"},{path:"/12.å·¥å·/03.æ¨¡æ¿å¼æ/",redirect:"/pages/9a5880/"},{name:"v-c5441038",path:"/pages/06533c/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-c5441038").then(t)}},{path:"/pages/06533c/index.html",redirect:"/pages/06533c/"},{path:"/12.å·¥å·/04.æµè¯/01.Junit.html",redirect:"/pages/06533c/"},{name:"v-f8abeb6c",path:"/pages/ab18ad/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-f8abeb6c").then(t)}},{path:"/pages/ab18ad/index.html",redirect:"/pages/ab18ad/"},{path:"/12.å·¥å·/04.æµè¯/02.Mockito.html",redirect:"/pages/ab18ad/"},{name:"v-955934dc",path:"/pages/d99171/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-955934dc").then(t)}},{path:"/pages/d99171/index.html",redirect:"/pages/d99171/"},{path:"/12.å·¥å·/04.æµè¯/03.Jmeter.html",redirect:"/pages/d99171/"},{name:"v-63d503f0",path:"/pages/747d3e/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-63d503f0").then(t)}},{path:"/pages/747d3e/index.html",redirect:"/pages/747d3e/"},{path:"/12.å·¥å·/04.æµè¯/04.JMH.html",redirect:"/pages/747d3e/"},{name:"v-f2154a58",path:"/pages/337701/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-f2154a58").then(t)}},{path:"/pages/337701/index.html",redirect:"/pages/337701/"},{path:"/12.å·¥å·/99.å¶ä»/01.Javaæ¥å¿.html",redirect:"/pages/337701/"},{name:"v-dbf118bc",path:"/pages/14e432/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-dbf118bc").then(t)}},{path:"/pages/14e432/index.html",redirect:"/pages/14e432/"},{path:"/12.å·¥å·/99.å¶ä»/02.Javaå·¥å·å.html",redirect:"/pages/14e432/"},{name:"v-65004ca6",path:"/pages/ea4914/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-65004ca6").then(t)}},{path:"/pages/ea4914/index.html",redirect:"/pages/ea4914/"},{path:"/12.å·¥å·/99.å¶ä»/03.Reflections.html",redirect:"/pages/ea4914/"},{name:"v-35c0dec5",path:"/pages/da3f07/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-35c0dec5").then(t)}},{path:"/pages/da3f07/index.html",redirect:"/pages/da3f07/"},{path:"/12.å·¥å·/99.å¶ä»/04.JavaMail.html",redirect:"/pages/da3f07/"},{name:"v-066da6f7",path:"/pages/c516cc/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-066da6f7").then(t)}},{path:"/pages/c516cc/index.html",redirect:"/pages/c516cc/"},{path:"/12.å·¥å·/99.å¶ä»/05.Jsoup.html",redirect:"/pages/c516cc/"},{name:"v-aab99b9a",path:"/pages/aa9f61/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-aab99b9a").then(t)}},{path:"/pages/aa9f61/index.html",redirect:"/pages/aa9f61/"},{path:"/12.å·¥å·/99.å¶ä»/06.Thumbnailator.html",redirect:"/pages/aa9f61/"},{name:"v-4c05d3a6",path:"/pages/cc8ce5/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-4c05d3a6").then(t)}},{path:"/pages/cc8ce5/index.html",redirect:"/pages/cc8ce5/"},{path:"/12.å·¥å·/99.å¶ä»/07.Zxing.html",redirect:"/pages/cc8ce5/"},{name:"v-ed73b8ba",path:"/pages/4b6820/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-ed73b8ba").then(t)}},{path:"/pages/4b6820/index.html",redirect:"/pages/4b6820/"},{path:"/12.å·¥å·/",redirect:"/pages/4b6820/"},{name:"v-af4ff908",path:"/pages/538358/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-af4ff908").then(t)}},{path:"/pages/538358/index.html",redirect:"/pages/538358/"},{path:"/13.æ¡æ¶/11.ORM/01.Mybatiså¿«éå¥é¨.html",redirect:"/pages/538358/"},{name:"v-96ecc776",path:"/pages/3f3dba/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-96ecc776").then(t)}},{path:"/pages/3f3dba/index.html",redirect:"/pages/3f3dba/"},{path:"/13.æ¡æ¶/11.ORM/02.Mybatisåç.html",redirect:"/pages/3f3dba/"},{name:"v-58178384",path:"/pages/e873e1/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-58178384").then(t)}},{path:"/pages/e873e1/index.html",redirect:"/pages/e873e1/"},{path:"/13.æ¡æ¶/11.ORM/",redirect:"/pages/e873e1/"},{name:"v-7f048411",path:"/pages/cd25bf/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-7f048411").then(t)}},{path:"/pages/cd25bf/index.html",redirect:"/pages/cd25bf/"},{path:"/13.æ¡æ¶/12.å®å¨/01.Shiro.html",redirect:"/pages/cd25bf/"},{name:"v-1fe197ae",path:"/pages/a6cc5f/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-1fe197ae").then(t)}},{path:"/pages/a6cc5f/index.html",redirect:"/pages/a6cc5f/"},{path:"/13.æ¡æ¶/12.å®å¨/02.SpringSecurity.html",redirect:"/pages/a6cc5f/"},{name:"v-31a4aa1d",path:"/pages/520c52/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-31a4aa1d").then(t)}},{path:"/pages/520c52/index.html",redirect:"/pages/520c52/"},{path:"/13.æ¡æ¶/13.IO/01.Netty.html",redirect:"/pages/520c52/"},{name:"v-03cb9ec2",path:"/pages/e79b77/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-03cb9ec2").then(t)}},{path:"/pages/e79b77/index.html",redirect:"/pages/e79b77/"},{path:"/13.æ¡æ¶/14.å¾®æå¡/01.Dubbo.html",redirect:"/pages/e79b77/"},{name:"v-448a2646",path:"/pages/fd4995/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-448a2646").then(t)}},{path:"/pages/fd4995/index.html",redirect:"/pages/fd4995/"},{path:"/13.æ¡æ¶/",redirect:"/pages/fd4995/"},{name:"v-6aa69b5a",path:"/pages/5a6cf3/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-6aa69b5a").then(t)}},{path:"/pages/5a6cf3/index.html",redirect:"/pages/5a6cf3/"},{path:"/14.ä¸­é´ä»¶/01.MQ/01.æ¶æ¯éåé¢è¯.html",redirect:"/pages/5a6cf3/"},{name:"v-6140a136",path:"/pages/055069/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-6140a136").then(t)}},{path:"/pages/055069/index.html",redirect:"/pages/055069/"},{path:"/14.ä¸­é´ä»¶/01.MQ/02.æ¶æ¯éååºæ¬åç.html",redirect:"/pages/055069/"},{name:"v-5df11448",path:"/pages/f56a96/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-5df11448").then(t)}},{path:"/pages/f56a96/index.html",redirect:"/pages/f56a96/"},{path:"/14.ä¸­é´ä»¶/01.MQ/03.RocketMQ.html",redirect:"/pages/f56a96/"},{name:"v-f41b300c",path:"/pages/3f7c49/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-f41b300c").then(t)}},{path:"/pages/3f7c49/index.html",redirect:"/pages/3f7c49/"},{path:"/14.ä¸­é´ä»¶/01.MQ/04.ActiveMQ.html",redirect:"/pages/3f7c49/"},{name:"v-2525a60d",path:"/pages/fc0b29/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-2525a60d").then(t)}},{path:"/pages/fc0b29/index.html",redirect:"/pages/fc0b29/"},{path:"/14.ä¸­é´ä»¶/01.MQ/",redirect:"/pages/fc0b29/"},{name:"v-fa0cf7f8",path:"/pages/eb30d6/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-fa0cf7f8").then(t)}},{path:"/pages/eb30d6/index.html",redirect:"/pages/eb30d6/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/01.ç¼å­é¢è¯é¢.html",redirect:"/pages/eb30d6/"},{name:"v-47099c49",path:"/pages/970fa6/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-47099c49").then(t)}},{path:"/pages/970fa6/index.html",redirect:"/pages/970fa6/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/02.Javaç¼å­ä¸­é´ä»¶.html",redirect:"/pages/970fa6/"},{name:"v-d302b38c",path:"/pages/25a710/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-d302b38c").then(t)}},{path:"/pages/25a710/index.html",redirect:"/pages/25a710/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/03.Memcached.html",redirect:"/pages/25a710/"},{name:"v-16f33bda",path:"/pages/c4647d/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-16f33bda").then(t)}},{path:"/pages/c4647d/index.html",redirect:"/pages/c4647d/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/04.Ehcache.html",redirect:"/pages/c4647d/"},{name:"v-1f77f9ec",path:"/pages/9632fd/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-1f77f9ec").then(t)}},{path:"/pages/9632fd/index.html",redirect:"/pages/9632fd/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/05.Javaè¿ç¨åç¼å­.html",redirect:"/pages/9632fd/"},{name:"v-94737480",path:"/pages/c09100/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-94737480").then(t)}},{path:"/pages/c09100/index.html",redirect:"/pages/c09100/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/06.Httpç¼å­.html",redirect:"/pages/c09100/"},{name:"v-c4a07c5e",path:"/pages/71104f/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-c4a07c5e").then(t)}},{path:"/pages/71104f/index.html",redirect:"/pages/71104f/"},{path:"/14.ä¸­é´ä»¶/02.ç¼å­/",redirect:"/pages/71104f/"},{name:"v-a9382712",path:"/pages/f2ebed/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-a9382712").then(t)}},{path:"/pages/f2ebed/index.html",redirect:"/pages/f2ebed/"},{path:"/14.ä¸­é´ä»¶/03.æµéæ§å¶/01.Hystrix.html",redirect:"/pages/f2ebed/"},{name:"v-9e9dd666",path:"/pages/3cbcff/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-9e9dd666").then(t)}},{path:"/pages/3cbcff/index.html",redirect:"/pages/3cbcff/"},{path:"/14.ä¸­é´ä»¶/",redirect:"/pages/3cbcff/"},{name:"v-04cda89e",path:"/archives/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-04cda89e").then(t)}},{path:"/archives/index.html",redirect:"/archives/"},{path:"/@pages/archivesPage.html",redirect:"/archives/"},{name:"v-5d493111",path:"/categories/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-5d493111").then(t)}},{path:"/categories/index.html",redirect:"/categories/"},{path:"/@pages/categoriesPage.html",redirect:"/categories/"},{name:"v-26877d31",path:"/tags/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-26877d31").then(t)}},{path:"/tags/index.html",redirect:"/tags/"},{path:"/@pages/tagsPage.html",redirect:"/tags/"},{name:"v-10d1fe8a",path:"/",component:gl,beforeEnter:(n,e,t)=>{ss("Layout","v-10d1fe8a").then(t)}},{path:"/index.html",redirect:"/"},{path:"*",component:gl}],bl={title:"JAVA-TUTORIAL",description:"â java-tutorial æ¯ä¸ä¸ª Java æç¨ï¼æ±éä¸ä¸ªèå¸æºå¨ Java é¢åçåå¹´ç§¯ç´¯ã",base:"/java-tutorial/",headTags:[["link",{rel:"icon",href:"/java-tutorial/img/favicon.ico"}],["meta",{name:"keywords",content:"vuepress,theme,blog,vdoing"}],["meta",{name:"theme-color",content:"#11a8cd"}]],pages:[{title:"JavaWeb ä¹ Servlet æå",frontmatter:{title:"JavaWeb ä¹ Servlet æå",categories:["ç¼ç¨","Java","JavaWeb"],tags:["Java","JavaWeb","Servlet"],abbrlink:"2ce8dedd",date:"2020-08-24T19:41:46.000Z",permalink:"/pages/be093b/"},regularPath:"/02.JavaEE/01.JavaWeb/01.JavaWeb%E4%B9%8BServlet%E6%8C%87%E5%8D%97.html",relativePath:"02.JavaEE/01.JavaWeb/01.JavaWebä¹Servletæå.md",key:"v-4b99dd20",path:"/pages/be093b/",headers:[{level:2,title:"JavaWeb ç®ä»",slug:"javaweb-ç®ä»",normalizedTitle:"javaweb ç®ä»",charIndex:27},{level:3,title:"Web åºç¨ç¨åº",slug:"web-åºç¨ç¨åº",normalizedTitle:"web åºç¨ç¨åº",charIndex:42},{level:3,title:"å¸¸è§ Web æå¡å¨",slug:"å¸¸è§-web-æå¡å¨",normalizedTitle:"å¸¸è§ web æå¡å¨",charIndex:369},{level:2,title:"Servlet ç®ä»",slug:"servlet-ç®ä»",normalizedTitle:"servlet ç®ä»",charIndex:466},{level:3,title:"ä»ä¹æ¯ Servlet",slug:"ä»ä¹æ¯-servlet",normalizedTitle:"ä»ä¹æ¯ servlet",charIndex:481},{level:3,title:"Servlet å CGI çåºå«",slug:"servlet-å-cgi-çåºå«",normalizedTitle:"servlet å cgi çåºå«",charIndex:773},{level:3,title:"Servlet çæ¬ä»¥åä¸»è¦ç¹æ§",slug:"servlet-çæ¬ä»¥åä¸»è¦ç¹æ§",normalizedTitle:"servlet çæ¬ä»¥åä¸»è¦ç¹æ§",charIndex:1e3},{level:3,title:"Servlet ä»»å¡",slug:"servlet-ä»»å¡",normalizedTitle:"servlet ä»»å¡",charIndex:1838},{level:3,title:"Servlet çå½å¨æ",slug:"servlet-çå½å¨æ",normalizedTitle:"servlet çå½å¨æ",charIndex:2248},{level:2,title:"Servlet API",slug:"servlet-api",normalizedTitle:"servlet api",charIndex:2528},{level:3,title:"Servlet å",slug:"servlet-å",normalizedTitle:"servlet å",charIndex:2544},{level:3,title:"Servlet æ¥å£",slug:"servlet-æ¥å£",normalizedTitle:"servlet æ¥å£",charIndex:658},{level:4,title:"init() æ¹æ³",slug:"init-æ¹æ³",normalizedTitle:"init() æ¹æ³",charIndex:3167},{level:4,title:"service() æ¹æ³",slug:"service-æ¹æ³",normalizedTitle:"service() æ¹æ³",charIndex:879},{level:4,title:"doGet() æ¹æ³",slug:"doget-æ¹æ³",normalizedTitle:"doget() æ¹æ³",charIndex:4255},{level:4,title:"doPost() æ¹æ³",slug:"dopost-æ¹æ³",normalizedTitle:"dopost() æ¹æ³",charIndex:4213},{level:4,title:"destroy() æ¹æ³",slug:"destroy-æ¹æ³",normalizedTitle:"destroy() æ¹æ³",charIndex:2465},{level:2,title:"Servlet å HTTP ç¶æç ",slug:"servlet-å-http-ç¶æç ",normalizedTitle:"servlet å http ç¶æç ",charIndex:4975},{level:3,title:"HTTP ç¶æç ",slug:"http-ç¶æç ",normalizedTitle:"http ç¶æç ",charIndex:4985},{level:3,title:"è®¾ç½® HTTP ç¶æç çæ¹æ³",slug:"è®¾ç½®-http-ç¶æç çæ¹æ³",normalizedTitle:"è®¾ç½® http ç¶æç çæ¹æ³",charIndex:5888},{level:3,title:"HTTP ç¶æç å®ä¾",slug:"http-ç¶æç å®ä¾",normalizedTitle:"http ç¶æç å®ä¾",charIndex:6372},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:7316}],headersStr:"JavaWeb ç®ä» Web åºç¨ç¨åº å¸¸è§ Web æå¡å¨ Servlet ç®ä» ä»ä¹æ¯ Servlet Servlet å CGI çåºå« Servlet çæ¬ä»¥åä¸»è¦ç¹æ§ Servlet ä»»å¡ Servlet çå½å¨æ Servlet API Servlet å Servlet æ¥å£ init() æ¹æ³ service() æ¹æ³ doGet() æ¹æ³ doPost() æ¹æ³ destroy() æ¹æ³ Servlet å HTTP ç¶æç  HTTP ç¶æç  è®¾ç½® HTTP ç¶æç çæ¹æ³ HTTP ç¶æç å®ä¾ åèèµæ",content:'# JavaWeb ä¹ Servlet æå\n\n\n# JavaWeb ç®ä»\n\n\n# Web åºç¨ç¨åº\n\nWebï¼å¨è±è¯­ä¸­ web å³è¡¨ç¤ºç½é¡µçææï¼å®ç¨äºè¡¨ç¤º Internet ä¸»æºä¸ä¾å¤çè®¿é®çèµæºã\n\nWeb åºç¨ç¨åºæ¯ä¸ç§å¯ä»¥éè¿ Web è®¿é®çåºç¨ç¨åºï¼ç¨åºçæå¤§å¥½å¤æ¯ç¨æ·å¾å®¹æè®¿é®åºç¨ç¨åºï¼ç¨æ·åªéè¦ææµè§å¨å³å¯ï¼ä¸éè¦åå®è£å¶ä»è½¯ä»¶ã\n\nInternet ä¸ä¾å¤çè®¿é®ç Web èµæºåä¸ºï¼\n\n * éæ web èµæºï¼æ web é¡µé¢ä¸­ä¾äººä»¬æµè§çæ°æ®å§ç»æ¯ä¸åãå¸¸è§éæèµæºæä»¶ï¼htmlãcssãåç§å¾çç±»åï¼jpgãpngï¼\n * å¨æ web èµæºï¼æ web é¡µé¢ä¸­ä¾äººä»¬æµè§çæ°æ®æ¯ç±ç¨åºäº§ççï¼ä¸åæ¶é´ç¹è®¿é® web é¡µé¢çå°çåå®¹åä¸ç¸åãå¸¸è§å¨æèµæºææ¯ï¼JSP/ServletãASPãPHP\n\n\n# å¸¸è§ Web æå¡å¨\n\n * Tomcat\n * Jetty\n * Resin\n * Apache\n * Nginx\n * WebSphere\n * WebLogic\n * JBoss\n\n\n# Servlet ç®ä»\n\n\n# ä»ä¹æ¯ Servlet\n\nServletï¼Server Appletï¼ï¼å³å°æå¡ç¨åºææå¡è¿æ¥å¨ãServlet æ¯ Java ç¼åçæå¡å¨ç«¯ç¨åºï¼å·æç¬ç«äºå¹³å°ååè®®çç¹æ§ï¼ä¸»è¦åè½å¨äºäº¤äºå¼å°æµè§åçææ°æ®ï¼çæå¨æ Web åå®¹ã\n\n * ç­ä¹ç Servlet æ¯æ Java å®ç°çä¸ä¸ªæ¥å£ã\n * å¹¿ä¹ç Servlet æ¯æä»»ä½å®ç°äºè¿ä¸ª Servlet æ¥å£çç±»ã\n\nServlet è¿è¡äºæ¯æ Java çåºç¨æå¡å¨ä¸­ãä»åçä¸è®²ï¼Servlet å¯ä»¥ååºä»»ä½ç±»åçè¯·æ±ï¼ä½ç»å¤§å¤æ°æåµä¸ Servlet åªç¨æ¥æ©å±åºäº HTTP åè®®ç Web æå¡å¨ã\n\n\n# Servlet å CGI çåºå«\n\nServlet ææ¯åºç°ä¹åï¼Web ä¸»è¦ä½¿ç¨ CGI ææ¯ãå®ä»¬çåºå«å¦ä¸ï¼\n\n * Servlet æ¯åºäº Java ç¼åçï¼å¤äºæå¡å¨è¿ç¨ä¸­ï¼ä»è½å¤éè¿å¤çº¿ç¨æ¹å¼è¿è¡ service() æ¹æ³ï¼ä¸ä¸ªå®ä¾å¯ä»¥æå¡äºå¤ä¸ªè¯·æ±ï¼èä¸ä¸è¬ä¸ä¼éæ¯ï¼\n * CGI(Common Gateway Interface)ï¼å³éç¨ç½å³æ¥å£ãå®ä¼ä¸ºæ¯ä¸ªè¯·æ±äº§çæ°çè¿ç¨ï¼æå¡å®æåéæ¯ï¼æä»¥æçä¸ä½äº Servletã\n\n\n# Servlet çæ¬ä»¥åä¸»è¦ç¹æ§\n\nçæ¬            æ¥æ            JAVA EE/JDK çæ¬       ç¹æ§\nServlet 4.0   2017 å¹´ 10 æ   JavaEE 8             HTTP2\nServlet 3.1   2013 å¹´ 5 æ    JavaEE 7             éé»å¡ I/Oï¼HTTP åè®®åçº§æºå¶\nServlet 3.0   2009 å¹´ 12 æ   JavaEE 6, JavaSE 6   å¯æææ§ï¼æäºå¼åï¼å¼æ­¥ Servletï¼å®å¨æ§ï¼æä»¶ä¸ä¼ \nServlet 2.5   2005 å¹´ 10 æ   JavaEE 5, JavaSE 5   ä¾èµ JavaSE 5ï¼æ¯ææ³¨è§£\nServlet 2.4   2003 å¹´ 11 æ   J2EE 1.4, J2SE 1.3   web.xml ä½¿ç¨ XML Schema\nServlet 2.3   2001 å¹´ 8 æ    J2EE 1.3, J2SE 1.2   Filter\nServlet 2.2   1999 å¹´ 8 æ    J2EE 1.2, J2SE 1.2   æä¸º J2EE æ å\nServlet 2.1   1998 å¹´ 11 æ   æªæå®                  First official specification, added RequestDispatcher,\n                                                 ServletContext\nServlet 2.0                 JDK 1.1              Part of Java Servlet Development Kit 2.0\nServlet 1.0   1997 å¹´ 6 æ                         \n\n\n# Servlet ä»»å¡\n\nServlet æ§è¡ä»¥ä¸ä¸»è¦ä»»å¡ï¼\n\n * è¯»åå®¢æ·ç«¯ï¼æµè§å¨ï¼åéçæ¾å¼çæ°æ®ãè¿åæ¬ç½é¡µä¸ç HTML è¡¨åï¼æèä¹å¯ä»¥æ¯æ¥èª applet æèªå®ä¹ç HTTP å®¢æ·ç«¯ç¨åºçè¡¨åã\n * è¯»åå®¢æ·ç«¯ï¼æµè§å¨ï¼åéçéå¼ç HTTP è¯·æ±æ°æ®ãè¿åæ¬ cookiesãåªä½ç±»ååæµè§å¨è½çè§£çåç¼©æ ¼å¼ç­ç­ã\n * å¤çæ°æ®å¹¶çæç»æãè¿ä¸ªè¿ç¨å¯è½éè¦è®¿é®æ°æ®åºï¼æ§è¡ RMI æ CORBA è°ç¨ï¼è°ç¨ Web æå¡ï¼æèç´æ¥è®¡ç®å¾åºå¯¹åºçååºã\n * åéæ¾å¼çæ°æ®ï¼å³ææ¡£ï¼å°å®¢æ·ç«¯ï¼æµè§å¨ï¼ãè¯¥ææ¡£çæ ¼å¼å¯ä»¥æ¯å¤ç§å¤æ ·çï¼åæ¬ææ¬æä»¶ï¼HTML æ XMLï¼ãäºè¿å¶æä»¶ï¼GIF å¾åï¼ãExcel ç­ã\n * åééå¼ç HTTP ååºå°å®¢æ·ç«¯ï¼æµè§å¨ï¼ãè¿åæ¬åè¯æµè§å¨æå¶ä»å®¢æ·ç«¯è¢«è¿åçææ¡£ç±»åï¼ä¾å¦ HTMLï¼ï¼è®¾ç½® cookies åç¼å­åæ°ï¼ä»¥åå¶ä»ç±»ä¼¼çä»»å¡ã\n\n\n# Servlet çå½å¨æ\n\n\n\nServlet çå½å¨æå¦ä¸ï¼\n\n 1. å è½½ - ç¬¬ä¸ä¸ªå°è¾¾æå¡å¨ç HTTP è¯·æ±è¢«å§æ´¾å° Servlet å®¹å¨ãå®¹å¨éè¿ç±»å è½½å¨ä½¿ç¨ Servlet ç±»å¯¹åºçæä»¶å è½½ servletï¼\n 2. åå§å - Servlet éè¿è°ç¨ init () æ¹æ³è¿è¡åå§åã\n 3. æå¡ - Servlet è°ç¨ service() æ¹æ³æ¥å¤çå®¢æ·ç«¯çè¯·æ±ã\n 4. éæ¯ - Servlet éè¿è°ç¨ destroy() æ¹æ³ç»æ­¢ï¼ç»æï¼ã\n 5. å¸è½½ - Servlet æ¯ç± JVM çåå¾åæ¶å¨è¿è¡åå¾åæ¶çã\n\n\n# Servlet API\n\n\n# Servlet å\n\nJava Servlet æ¯è¿è¡å¨å¸¦ææ¯æ Java Servlet è§èçè§£éå¨ç web æå¡å¨ä¸ç Java ç±»ã\n\nServlet å¯ä»¥ä½¿ç¨ javax.servlet å javax.servlet.http ååå»ºï¼å®æ¯ Java ä¼ä¸ççæ åç»æé¨åï¼Java ä¼ä¸çæ¯æ¯æå¤§åå¼åé¡¹ç®ç Java ç±»åºçæ©å±çæ¬ã\n\nJava Servlet å°±åä»»ä½å¶ä»ç Java ç±»ä¸æ ·å·²ç»è¢«åå»ºåç¼è¯ãå¨æ¨å®è£ Servlet åå¹¶æå®ä»¬æ·»å å°æ¨çè®¡ç®æºä¸ç Classpath ç±»è·¯å¾ä¸­ä¹åï¼æ¨å°±å¯ä»¥éè¿ JDK ç Java ç¼è¯å¨æä»»ä½å¶ä»ç¼è¯å¨æ¥ç¼è¯ Servletã\n\n\n# Servlet æ¥å£\n\nServlet æ¥å£å®ä¹äºä¸é¢äºä¸ªæ¹æ³ï¼\n\npublic interface Servlet {\n    void init(ServletConfig var1) throws ServletException;\n\n    ServletConfig getServletConfig();\n\n    void service(ServletRequest var1, ServletResponse var2) throws ServletException, IOException;\n\n    String getServletInfo();\n\n    void destroy();\n}\n\n\n# init() æ¹æ³\n\ninit æ¹æ³è¢«è®¾è®¡æåªè°ç¨ä¸æ¬¡ãå®å¨ç¬¬ä¸æ¬¡åå»º Servlet æ¶è¢«è°ç¨ï¼å¨åç»­æ¯æ¬¡ç¨æ·è¯·æ±æ¶ä¸åè°ç¨ãå æ­¤ï¼å®æ¯ç¨äºä¸æ¬¡æ§åå§åï¼å°±å Applet ç init æ¹æ³ä¸æ ·ã\n\nServlet åå»ºäºç¨æ·ç¬¬ä¸æ¬¡è°ç¨å¯¹åºäºè¯¥ Servlet ç URL æ¶ï¼ä½æ¯æ¨ä¹å¯ä»¥æå® Servlet å¨æå¡å¨ç¬¬ä¸æ¬¡å¯å¨æ¶è¢«å è½½ã\n\nå½ç¨æ·è°ç¨ä¸ä¸ª Servlet æ¶ï¼å°±ä¼åå»ºä¸ä¸ª Servlet å®ä¾ï¼æ¯ä¸ä¸ªç¨æ·è¯·æ±é½ä¼äº§çä¸ä¸ªæ°ççº¿ç¨ï¼éå½çæ¶åç§»äº¤ç» doGet æ doPost æ¹æ³ãinit() æ¹æ³ç®åå°åå»ºæå è½½ä¸äºæ°æ®ï¼è¿äºæ°æ®å°è¢«ç¨äº Servlet çæ´ä¸ªçå½å¨æã\n\ninit æ¹æ³çå®ä¹å¦ä¸ï¼\n\npublic void init() throws ServletException {\n  // åå§åä»£ç ...\n}\n\n\n# service() æ¹æ³\n\nservice() æ¹æ³æ¯æ§è¡å®éä»»å¡çæ ¸å¿æ¹æ³ãServlet å®¹å¨ï¼å³ Web æå¡å¨ï¼è°ç¨ service() æ¹æ³æ¥å¤çæ¥èªå®¢æ·ç«¯ï¼æµè§å¨ï¼çè¯·æ±ï¼å¹¶ææ ¼å¼åçååºååç»å®¢æ·ç«¯ã\n\nservice() æ¹æ³æä¸¤ä¸ªåæ°ï¼ServletRequest å ServletResponseãServletRequest ç¨æ¥å°è£è¯·æ±ä¿¡æ¯ï¼ServletResponse ç¨æ¥å°è£ååºä¿¡æ¯ï¼å æ­¤æ¬è´¨ä¸è¿ä¸¤ä¸ªç±»æ¯å¯¹éä¿¡åè®®çå°è£ã\n\næ¯æ¬¡æå¡å¨æ¥æ¶å°ä¸ä¸ª Servlet è¯·æ±æ¶ï¼æå¡å¨ä¼äº§çä¸ä¸ªæ°ççº¿ç¨å¹¶è°ç¨æå¡ãservice() æ¹æ³æ£æ¥ HTTP è¯·æ±ç±»åï¼GETãPOSTãPUTãDELETE ç­ï¼ï¼å¹¶å¨éå½çæ¶åè°ç¨ doGetãdoPostãdoPutï¼doDelete ç­æ¹æ³ã\n\nä¸é¢æ¯è¯¥æ¹æ³çç¹å¾ï¼\n\npublic void service(ServletRequest request,\n                    ServletResponse response)\n      throws ServletException, IOException{\n}\n\n\nservice() æ¹æ³ç±å®¹å¨è°ç¨ï¼service æ¹æ³å¨éå½çæ¶åè°ç¨ doGetãdoPostãdoPutãdoDelete ç­æ¹æ³ãæä»¥ï¼æ¨ä¸ç¨å¯¹ service() æ¹æ³åä»»ä½å¨ä½ï¼æ¨åªéè¦æ ¹æ®æ¥èªå®¢æ·ç«¯çè¯·æ±ç±»åæ¥éå doGet() æ doPost() å³å¯ã\n\ndoGet() å doPost() æ¹æ³æ¯æ¯æ¬¡æå¡è¯·æ±ä¸­æå¸¸ç¨çæ¹æ³ãä¸é¢æ¯è¿ä¸¤ç§æ¹æ³çç¹å¾ã\n\n# doGet() æ¹æ³\n\nGET è¯·æ±æ¥èªäºä¸ä¸ª URL çæ­£å¸¸è¯·æ±ï¼æèæ¥èªäºä¸ä¸ªæªæå® METHOD ç HTML è¡¨åï¼å®ç± doGet() æ¹æ³å¤çã\n\npublic void doGet(HttpServletRequest request,\n                  HttpServletResponse response)\n    throws ServletException, IOException {\n    // Servlet ä»£ç \n}\n\n\n# doPost() æ¹æ³\n\nPOST è¯·æ±æ¥èªäºä¸ä¸ªç¹å«æå®äº METHOD ä¸º POST ç HTML è¡¨åï¼å®ç± doPost() æ¹æ³å¤çã\n\npublic void doPost(HttpServletRequest request,\n                   HttpServletResponse response)\n    throws ServletException, IOException {\n    // Servlet ä»£ç \n}\n\n\n# destroy() æ¹æ³\n\ndestroy() æ¹æ³åªä¼è¢«è°ç¨ä¸æ¬¡ï¼å¨ Servlet çå½å¨æç»ææ¶è¢«è°ç¨ãdestroy() æ¹æ³å¯ä»¥è®©æ¨ç Servlet å³é­æ°æ®åºè¿æ¥ãåæ­¢åå°çº¿ç¨ãæ Cookie åè¡¨æç¹å»è®¡æ°å¨åå¥å°ç£çï¼å¹¶æ§è¡å¶ä»ç±»ä¼¼çæ¸çæ´»å¨ã\n\nå¨è°ç¨ destroy() æ¹æ³ä¹åï¼servlet å¯¹è±¡è¢«æ è®°ä¸ºåå¾åæ¶ãdestroy æ¹æ³å®ä¹å¦ä¸æç¤ºï¼\n\n  public void destroy() {\n    // ç»æ­¢åä»£ç ...\n  }\n\n\n\n# Servlet å HTTP ç¶æç \n\ntitle: JavaEE Servlet HTTP ç¶æç  date: 2017-11-08 categories:\n\n * javaee tags:\n * javaee\n * servlet\n * http\n\n\n# HTTP ç¶æç \n\nHTTP è¯·æ±å HTTP ååºæ¶æ¯çæ ¼å¼æ¯ç±»ä¼¼çï¼ç»æå¦ä¸ï¼\n\n * åå§ç¶æè¡ + åè½¦æ¢è¡ç¬¦ï¼åè½¦+æ¢è¡ï¼\n * é¶ä¸ªæå¤ä¸ªæ é¢è¡+åè½¦æ¢è¡ç¬¦\n * ä¸ä¸ªç©ºç½è¡ï¼å³åè½¦æ¢è¡ç¬¦\n * ä¸ä¸ªå¯éçæ¶æ¯ä¸»ä½ï¼æ¯å¦æä»¶ãæ¥è¯¢æ°æ®ææ¥è¯¢è¾åº\n\nä¾å¦ï¼æå¡å¨çååºå¤´å¦ä¸æç¤ºï¼\n\nHTTP/1.1 200 OK\nContent-Type: text/html\nHeader2: ...\n...\nHeaderN: ...\n  (Blank Line)\n<!doctype ...>\n<html>\n<head>...</head>\n<body>\n...\n</body>\n</html>\n\n\nç¶æè¡åæ¬ HTTP çæ¬ï¼å¨æ¬ä¾ä¸­ä¸º HTTP/1.1ï¼ãä¸ä¸ªç¶æç ï¼å¨æ¬ä¾ä¸­ä¸º 200ï¼åä¸ä¸ªå¯¹åºäºç¶æç çç­æ¶æ¯ï¼å¨æ¬ä¾ä¸­ä¸º OKï¼ã\n\nä»¥ä¸æ¯å¯è½ä» Web æå¡å¨è¿åç HTTP ç¶æç åç¸å³çä¿¡æ¯åè¡¨ï¼\n\n * 1**ï¼ä¿¡æ¯æ§ç¶æç \n * 2**ï¼æåç¶æç \n   * 200ï¼è¯·æ±æ­£å¸¸æå\n   * 204ï¼æç¤ºè¯·æ±æåä½æ²¡æè¿åæ°ä¿¡æ¯\n   * 206ï¼æç¤ºæå¡å¨å·²å®æå¯¹èµæºçé¨å GET è¯·æ±\n * 3**ï¼éå®åç¶æç \n   * 301ï¼æ°¸ä¹æ§éå®å\n   * 302ï¼ä¸´æ¶æ§éå®å\n   * 304ï¼æå¡å¨ç«¯åè®¸è¯·æ±è®¿é®èµæºï¼ä½æªæ»¡è¶³æ¡ä»¶\n * 4**ï¼å®¢æ·ç«¯éè¯¯ç¶æç \n   * 400ï¼è¯·æ±æ¥æä¸­å­å¨è¯­æ³éè¯¯\n   * 401ï¼åéçè¯·æ±éè¦æéè¿ HTTP è®¤è¯çè®¤è¯ä¿¡æ¯\n   * 403ï¼å¯¹è¯·æ±èµæºçè®¿é®è¢«æå¡å¨æç»äº\n   * 404ï¼æå¡å¨ä¸æ æ³æ¾å°è¯·æ±çèµæº\n * 5**ï¼æå¡å¨éè¯¯ç¶æç \n   * 500ï¼æå¡å¨ç«¯å¨æ§è¡è¯·æ±æ¶åçäºéè¯¯\n   * 503ï¼æå¡å¨ææ¶å¤äºè¶è´è½½ææ­£å¨è¿è¡åæºç»´æ¤ï¼ç°å¨æ æ³å¤çè¯·æ±\n\n\n# è®¾ç½® HTTP ç¶æç çæ¹æ³\n\nä¸é¢çæ¹æ³å¯ç¨äºå¨ Servlet ç¨åºä¸­è®¾ç½® HTTP ç¶æç ãè¿äºæ¹æ³éè¿ HttpServletResponse å¯¹è±¡å¯ç¨ã\n\nåºå·   æ¹æ³ & æè¿°\n1    **public void setStatus ( int statusCode\n     )**è¯¥æ¹æ³è®¾ç½®ä¸ä¸ªä»»æçç¶æç ãsetStatus æ¹æ³æ¥åä¸ä¸ª\n     intï¼ç¶æç ï¼ä½ä¸ºåæ°ãå¦ææ¨çååºåå«äºä¸ä¸ªç¹æ®çç¶æç åææ¡£ï¼è¯·ç¡®ä¿å¨ä½¿ç¨ PrintWriter\n     å®éè¿åä»»ä½åå®¹ä¹åè°ç¨ setStatusã\n2    **public void sendRedirect(String url)**è¯¥æ¹æ³çæä¸ä¸ª 302\n     ååºï¼è¿åä¸ä¸ªå¸¦ææ°ææ¡£ URL ç Location å¤´ã\n3    **public void sendError(int code, String\n     message)**è¯¥æ¹æ³åéä¸ä¸ªç¶æç ï¼éå¸¸ä¸º 404ï¼ï¼è¿åä¸ä¸ªå¨ HTML\n     ææ¡£åé¨èªå¨æ ¼å¼åå¹¶åéå°å®¢æ·ç«¯çç­æ¶æ¯ã\n\n\n# HTTP ç¶æç å®ä¾\n\nä¸é¢çä¾å­æ 407 éè¯¯ä»£ç åéå°å®¢æ·ç«¯æµè§å¨ï¼æµè§å¨ä¼æ¾ç¤º "Need authentication!!!" æ¶æ¯ã\n\n// å¯¼å¥å¿éç java åº\nimport java.io.*;\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.util.*;\n\n// æ©å± HttpServlet ç±»\npublic class showError extends HttpServlet {\n\n  // å¤ç GET æ¹æ³è¯·æ±çæ¹æ³\n  public void doGet(HttpServletRequest request,\n                    HttpServletResponse response)\n            throws ServletException, IOException\n  {\n      // è®¾ç½®éè¯¯ä»£ç ååå \n      response.sendError(407, "Need authentication!!!" );\n  }\n  // å¤ç POST æ¹æ³è¯·æ±çæ¹æ³\n  public void doPost(HttpServletRequest request,\n                     HttpServletResponse response)\n      throws ServletException, IOException {\n     doGet(request, response);\n  }\n}\n\n\nç°å¨ï¼è°ç¨ä¸é¢ç Servlet å°æ¾ç¤ºä»¥ä¸ç»æï¼\n\nHTTP Status 407 - Need authentication!!!\ntype Status report\nmessage Need authentication!!!\ndescription The client must first authenticate itself with the proxy (Need authentication!!!).\nApache Tomcat/5.5.29\n\n\n\n# åèèµæ\n\n * æ·±å¥æè§£ Tomcat & Jetty\n * Java Web æ´åå¼åçèå½æ¥',normalizedContent:'# javaweb ä¹ servlet æå\n\n\n# javaweb ç®ä»\n\n\n# web åºç¨ç¨åº\n\nwebï¼å¨è±è¯­ä¸­ web å³è¡¨ç¤ºç½é¡µçææï¼å®ç¨äºè¡¨ç¤º internet ä¸»æºä¸ä¾å¤çè®¿é®çèµæºã\n\nweb åºç¨ç¨åºæ¯ä¸ç§å¯ä»¥éè¿ web è®¿é®çåºç¨ç¨åºï¼ç¨åºçæå¤§å¥½å¤æ¯ç¨æ·å¾å®¹æè®¿é®åºç¨ç¨åºï¼ç¨æ·åªéè¦ææµè§å¨å³å¯ï¼ä¸éè¦åå®è£å¶ä»è½¯ä»¶ã\n\ninternet ä¸ä¾å¤çè®¿é®ç web èµæºåä¸ºï¼\n\n * éæ web èµæºï¼æ web é¡µé¢ä¸­ä¾äººä»¬æµè§çæ°æ®å§ç»æ¯ä¸åãå¸¸è§éæèµæºæä»¶ï¼htmlãcssãåç§å¾çç±»åï¼jpgãpngï¼\n * å¨æ web èµæºï¼æ web é¡µé¢ä¸­ä¾äººä»¬æµè§çæ°æ®æ¯ç±ç¨åºäº§ççï¼ä¸åæ¶é´ç¹è®¿é® web é¡µé¢çå°çåå®¹åä¸ç¸åãå¸¸è§å¨æèµæºææ¯ï¼jsp/servletãaspãphp\n\n\n# å¸¸è§ web æå¡å¨\n\n * tomcat\n * jetty\n * resin\n * apache\n * nginx\n * websphere\n * weblogic\n * jboss\n\n\n# servlet ç®ä»\n\n\n# ä»ä¹æ¯ servlet\n\nservletï¼server appletï¼ï¼å³å°æå¡ç¨åºææå¡è¿æ¥å¨ãservlet æ¯ java ç¼åçæå¡å¨ç«¯ç¨åºï¼å·æç¬ç«äºå¹³å°ååè®®çç¹æ§ï¼ä¸»è¦åè½å¨äºäº¤äºå¼å°æµè§åçææ°æ®ï¼çæå¨æ web åå®¹ã\n\n * ç­ä¹ç servlet æ¯æ java å®ç°çä¸ä¸ªæ¥å£ã\n * å¹¿ä¹ç servlet æ¯æä»»ä½å®ç°äºè¿ä¸ª servlet æ¥å£çç±»ã\n\nservlet è¿è¡äºæ¯æ java çåºç¨æå¡å¨ä¸­ãä»åçä¸è®²ï¼servlet å¯ä»¥ååºä»»ä½ç±»åçè¯·æ±ï¼ä½ç»å¤§å¤æ°æåµä¸ servlet åªç¨æ¥æ©å±åºäº http åè®®ç web æå¡å¨ã\n\n\n# servlet å cgi çåºå«\n\nservlet ææ¯åºç°ä¹åï¼web ä¸»è¦ä½¿ç¨ cgi ææ¯ãå®ä»¬çåºå«å¦ä¸ï¼\n\n * servlet æ¯åºäº java ç¼åçï¼å¤äºæå¡å¨è¿ç¨ä¸­ï¼ä»è½å¤éè¿å¤çº¿ç¨æ¹å¼è¿è¡ service() æ¹æ³ï¼ä¸ä¸ªå®ä¾å¯ä»¥æå¡äºå¤ä¸ªè¯·æ±ï¼èä¸ä¸è¬ä¸ä¼éæ¯ï¼\n * cgi(common gateway interface)ï¼å³éç¨ç½å³æ¥å£ãå®ä¼ä¸ºæ¯ä¸ªè¯·æ±äº§çæ°çè¿ç¨ï¼æå¡å®æåéæ¯ï¼æä»¥æçä¸ä½äº servletã\n\n\n# servlet çæ¬ä»¥åä¸»è¦ç¹æ§\n\nçæ¬            æ¥æ            java ee/jdk çæ¬       ç¹æ§\nservlet 4.0   2017 å¹´ 10 æ   javaee 8             http2\nservlet 3.1   2013 å¹´ 5 æ    javaee 7             éé»å¡ i/oï¼http åè®®åçº§æºå¶\nservlet 3.0   2009 å¹´ 12 æ   javaee 6, javase 6   å¯æææ§ï¼æäºå¼åï¼å¼æ­¥ servletï¼å®å¨æ§ï¼æä»¶ä¸ä¼ \nservlet 2.5   2005 å¹´ 10 æ   javaee 5, javase 5   ä¾èµ javase 5ï¼æ¯ææ³¨è§£\nservlet 2.4   2003 å¹´ 11 æ   j2ee 1.4, j2se 1.3   web.xml ä½¿ç¨ xml schema\nservlet 2.3   2001 å¹´ 8 æ    j2ee 1.3, j2se 1.2   filter\nservlet 2.2   1999 å¹´ 8 æ    j2ee 1.2, j2se 1.2   æä¸º j2ee æ å\nservlet 2.1   1998 å¹´ 11 æ   æªæå®                  first official specification, added requestdispatcher,\n                                                 servletcontext\nservlet 2.0                 jdk 1.1              part of java servlet development kit 2.0\nservlet 1.0   1997 å¹´ 6 æ                         \n\n\n# servlet ä»»å¡\n\nservlet æ§è¡ä»¥ä¸ä¸»è¦ä»»å¡ï¼\n\n * è¯»åå®¢æ·ç«¯ï¼æµè§å¨ï¼åéçæ¾å¼çæ°æ®ãè¿åæ¬ç½é¡µä¸ç html è¡¨åï¼æèä¹å¯ä»¥æ¯æ¥èª applet æèªå®ä¹ç http å®¢æ·ç«¯ç¨åºçè¡¨åã\n * è¯»åå®¢æ·ç«¯ï¼æµè§å¨ï¼åéçéå¼ç http è¯·æ±æ°æ®ãè¿åæ¬ cookiesãåªä½ç±»ååæµè§å¨è½çè§£çåç¼©æ ¼å¼ç­ç­ã\n * å¤çæ°æ®å¹¶çæç»æãè¿ä¸ªè¿ç¨å¯è½éè¦è®¿é®æ°æ®åºï¼æ§è¡ rmi æ corba è°ç¨ï¼è°ç¨ web æå¡ï¼æèç´æ¥è®¡ç®å¾åºå¯¹åºçååºã\n * åéæ¾å¼çæ°æ®ï¼å³ææ¡£ï¼å°å®¢æ·ç«¯ï¼æµè§å¨ï¼ãè¯¥ææ¡£çæ ¼å¼å¯ä»¥æ¯å¤ç§å¤æ ·çï¼åæ¬ææ¬æä»¶ï¼html æ xmlï¼ãäºè¿å¶æä»¶ï¼gif å¾åï¼ãexcel ç­ã\n * åééå¼ç http ååºå°å®¢æ·ç«¯ï¼æµè§å¨ï¼ãè¿åæ¬åè¯æµè§å¨æå¶ä»å®¢æ·ç«¯è¢«è¿åçææ¡£ç±»åï¼ä¾å¦ htmlï¼ï¼è®¾ç½® cookies åç¼å­åæ°ï¼ä»¥åå¶ä»ç±»ä¼¼çä»»å¡ã\n\n\n# servlet çå½å¨æ\n\n\n\nservlet çå½å¨æå¦ä¸ï¼\n\n 1. å è½½ - ç¬¬ä¸ä¸ªå°è¾¾æå¡å¨ç http è¯·æ±è¢«å§æ´¾å° servlet å®¹å¨ãå®¹å¨éè¿ç±»å è½½å¨ä½¿ç¨ servlet ç±»å¯¹åºçæä»¶å è½½ servletï¼\n 2. åå§å - servlet éè¿è°ç¨ init () æ¹æ³è¿è¡åå§åã\n 3. æå¡ - servlet è°ç¨ service() æ¹æ³æ¥å¤çå®¢æ·ç«¯çè¯·æ±ã\n 4. éæ¯ - servlet éè¿è°ç¨ destroy() æ¹æ³ç»æ­¢ï¼ç»æï¼ã\n 5. å¸è½½ - servlet æ¯ç± jvm çåå¾åæ¶å¨è¿è¡åå¾åæ¶çã\n\n\n# servlet api\n\n\n# servlet å\n\njava servlet æ¯è¿è¡å¨å¸¦ææ¯æ java servlet è§èçè§£éå¨ç web æå¡å¨ä¸ç java ç±»ã\n\nservlet å¯ä»¥ä½¿ç¨ javax.servlet å javax.servlet.http ååå»ºï¼å®æ¯ java ä¼ä¸ççæ åç»æé¨åï¼java ä¼ä¸çæ¯æ¯æå¤§åå¼åé¡¹ç®ç java ç±»åºçæ©å±çæ¬ã\n\njava servlet å°±åä»»ä½å¶ä»ç java ç±»ä¸æ ·å·²ç»è¢«åå»ºåç¼è¯ãå¨æ¨å®è£ servlet åå¹¶æå®ä»¬æ·»å å°æ¨çè®¡ç®æºä¸ç classpath ç±»è·¯å¾ä¸­ä¹åï¼æ¨å°±å¯ä»¥éè¿ jdk ç java ç¼è¯å¨æä»»ä½å¶ä»ç¼è¯å¨æ¥ç¼è¯ servletã\n\n\n# servlet æ¥å£\n\nservlet æ¥å£å®ä¹äºä¸é¢äºä¸ªæ¹æ³ï¼\n\npublic interface servlet {\n    void init(servletconfig var1) throws servletexception;\n\n    servletconfig getservletconfig();\n\n    void service(servletrequest var1, servletresponse var2) throws servletexception, ioexception;\n\n    string getservletinfo();\n\n    void destroy();\n}\n\n\n# init() æ¹æ³\n\ninit æ¹æ³è¢«è®¾è®¡æåªè°ç¨ä¸æ¬¡ãå®å¨ç¬¬ä¸æ¬¡åå»º servlet æ¶è¢«è°ç¨ï¼å¨åç»­æ¯æ¬¡ç¨æ·è¯·æ±æ¶ä¸åè°ç¨ãå æ­¤ï¼å®æ¯ç¨äºä¸æ¬¡æ§åå§åï¼å°±å applet ç init æ¹æ³ä¸æ ·ã\n\nservlet åå»ºäºç¨æ·ç¬¬ä¸æ¬¡è°ç¨å¯¹åºäºè¯¥ servlet ç url æ¶ï¼ä½æ¯æ¨ä¹å¯ä»¥æå® servlet å¨æå¡å¨ç¬¬ä¸æ¬¡å¯å¨æ¶è¢«å è½½ã\n\nå½ç¨æ·è°ç¨ä¸ä¸ª servlet æ¶ï¼å°±ä¼åå»ºä¸ä¸ª servlet å®ä¾ï¼æ¯ä¸ä¸ªç¨æ·è¯·æ±é½ä¼äº§çä¸ä¸ªæ°ççº¿ç¨ï¼éå½çæ¶åç§»äº¤ç» doget æ dopost æ¹æ³ãinit() æ¹æ³ç®åå°åå»ºæå è½½ä¸äºæ°æ®ï¼è¿äºæ°æ®å°è¢«ç¨äº servlet çæ´ä¸ªçå½å¨æã\n\ninit æ¹æ³çå®ä¹å¦ä¸ï¼\n\npublic void init() throws servletexception {\n  // åå§åä»£ç ...\n}\n\n\n# service() æ¹æ³\n\nservice() æ¹æ³æ¯æ§è¡å®éä»»å¡çæ ¸å¿æ¹æ³ãservlet å®¹å¨ï¼å³ web æå¡å¨ï¼è°ç¨ service() æ¹æ³æ¥å¤çæ¥èªå®¢æ·ç«¯ï¼æµè§å¨ï¼çè¯·æ±ï¼å¹¶ææ ¼å¼åçååºååç»å®¢æ·ç«¯ã\n\nservice() æ¹æ³æä¸¤ä¸ªåæ°ï¼servletrequest å servletresponseãservletrequest ç¨æ¥å°è£è¯·æ±ä¿¡æ¯ï¼servletresponse ç¨æ¥å°è£ååºä¿¡æ¯ï¼å æ­¤æ¬è´¨ä¸è¿ä¸¤ä¸ªç±»æ¯å¯¹éä¿¡åè®®çå°è£ã\n\næ¯æ¬¡æå¡å¨æ¥æ¶å°ä¸ä¸ª servlet è¯·æ±æ¶ï¼æå¡å¨ä¼äº§çä¸ä¸ªæ°ççº¿ç¨å¹¶è°ç¨æå¡ãservice() æ¹æ³æ£æ¥ http è¯·æ±ç±»åï¼getãpostãputãdelete ç­ï¼ï¼å¹¶å¨éå½çæ¶åè°ç¨ dogetãdopostãdoputï¼dodelete ç­æ¹æ³ã\n\nä¸é¢æ¯è¯¥æ¹æ³çç¹å¾ï¼\n\npublic void service(servletrequest request,\n                    servletresponse response)\n      throws servletexception, ioexception{\n}\n\n\nservice() æ¹æ³ç±å®¹å¨è°ç¨ï¼service æ¹æ³å¨éå½çæ¶åè°ç¨ dogetãdopostãdoputãdodelete ç­æ¹æ³ãæä»¥ï¼æ¨ä¸ç¨å¯¹ service() æ¹æ³åä»»ä½å¨ä½ï¼æ¨åªéè¦æ ¹æ®æ¥èªå®¢æ·ç«¯çè¯·æ±ç±»åæ¥éå doget() æ dopost() å³å¯ã\n\ndoget() å dopost() æ¹æ³æ¯æ¯æ¬¡æå¡è¯·æ±ä¸­æå¸¸ç¨çæ¹æ³ãä¸é¢æ¯è¿ä¸¤ç§æ¹æ³çç¹å¾ã\n\n# doget() æ¹æ³\n\nget è¯·æ±æ¥èªäºä¸ä¸ª url çæ­£å¸¸è¯·æ±ï¼æèæ¥èªäºä¸ä¸ªæªæå® method ç html è¡¨åï¼å®ç± doget() æ¹æ³å¤çã\n\npublic void doget(httpservletrequest request,\n                  httpservletresponse response)\n    throws servletexception, ioexception {\n    // servlet ä»£ç \n}\n\n\n# dopost() æ¹æ³\n\npost è¯·æ±æ¥èªäºä¸ä¸ªç¹å«æå®äº method ä¸º post ç html è¡¨åï¼å®ç± dopost() æ¹æ³å¤çã\n\npublic void dopost(httpservletrequest request,\n                   httpservletresponse response)\n    throws servletexception, ioexception {\n    // servlet ä»£ç \n}\n\n\n# destroy() æ¹æ³\n\ndestroy() æ¹æ³åªä¼è¢«è°ç¨ä¸æ¬¡ï¼å¨ servlet çå½å¨æç»ææ¶è¢«è°ç¨ãdestroy() æ¹æ³å¯ä»¥è®©æ¨ç servlet å³é­æ°æ®åºè¿æ¥ãåæ­¢åå°çº¿ç¨ãæ cookie åè¡¨æç¹å»è®¡æ°å¨åå¥å°ç£çï¼å¹¶æ§è¡å¶ä»ç±»ä¼¼çæ¸çæ´»å¨ã\n\nå¨è°ç¨ destroy() æ¹æ³ä¹åï¼servlet å¯¹è±¡è¢«æ è®°ä¸ºåå¾åæ¶ãdestroy æ¹æ³å®ä¹å¦ä¸æç¤ºï¼\n\n  public void destroy() {\n    // ç»æ­¢åä»£ç ...\n  }\n\n\n\n# servlet å http ç¶æç \n\ntitle: javaee servlet http ç¶æç  date: 2017-11-08 categories:\n\n * javaee tags:\n * javaee\n * servlet\n * http\n\n\n# http ç¶æç \n\nhttp è¯·æ±å http ååºæ¶æ¯çæ ¼å¼æ¯ç±»ä¼¼çï¼ç»æå¦ä¸ï¼\n\n * åå§ç¶æè¡ + åè½¦æ¢è¡ç¬¦ï¼åè½¦+æ¢è¡ï¼\n * é¶ä¸ªæå¤ä¸ªæ é¢è¡+åè½¦æ¢è¡ç¬¦\n * ä¸ä¸ªç©ºç½è¡ï¼å³åè½¦æ¢è¡ç¬¦\n * ä¸ä¸ªå¯éçæ¶æ¯ä¸»ä½ï¼æ¯å¦æä»¶ãæ¥è¯¢æ°æ®ææ¥è¯¢è¾åº\n\nä¾å¦ï¼æå¡å¨çååºå¤´å¦ä¸æç¤ºï¼\n\nhttp/1.1 200 ok\ncontent-type: text/html\nheader2: ...\n...\nheadern: ...\n  (blank line)\n<!doctype ...>\n<html>\n<head>...</head>\n<body>\n...\n</body>\n</html>\n\n\nç¶æè¡åæ¬ http çæ¬ï¼å¨æ¬ä¾ä¸­ä¸º http/1.1ï¼ãä¸ä¸ªç¶æç ï¼å¨æ¬ä¾ä¸­ä¸º 200ï¼åä¸ä¸ªå¯¹åºäºç¶æç çç­æ¶æ¯ï¼å¨æ¬ä¾ä¸­ä¸º okï¼ã\n\nä»¥ä¸æ¯å¯è½ä» web æå¡å¨è¿åç http ç¶æç åç¸å³çä¿¡æ¯åè¡¨ï¼\n\n * 1**ï¼ä¿¡æ¯æ§ç¶æç \n * 2**ï¼æåç¶æç \n   * 200ï¼è¯·æ±æ­£å¸¸æå\n   * 204ï¼æç¤ºè¯·æ±æåä½æ²¡æè¿åæ°ä¿¡æ¯\n   * 206ï¼æç¤ºæå¡å¨å·²å®æå¯¹èµæºçé¨å get è¯·æ±\n * 3**ï¼éå®åç¶æç \n   * 301ï¼æ°¸ä¹æ§éå®å\n   * 302ï¼ä¸´æ¶æ§éå®å\n   * 304ï¼æå¡å¨ç«¯åè®¸è¯·æ±è®¿é®èµæºï¼ä½æªæ»¡è¶³æ¡ä»¶\n * 4**ï¼å®¢æ·ç«¯éè¯¯ç¶æç \n   * 400ï¼è¯·æ±æ¥æä¸­å­å¨è¯­æ³éè¯¯\n   * 401ï¼åéçè¯·æ±éè¦æéè¿ http è®¤è¯çè®¤è¯ä¿¡æ¯\n   * 403ï¼å¯¹è¯·æ±èµæºçè®¿é®è¢«æå¡å¨æç»äº\n   * 404ï¼æå¡å¨ä¸æ æ³æ¾å°è¯·æ±çèµæº\n * 5**ï¼æå¡å¨éè¯¯ç¶æç \n   * 500ï¼æå¡å¨ç«¯å¨æ§è¡è¯·æ±æ¶åçäºéè¯¯\n   * 503ï¼æå¡å¨ææ¶å¤äºè¶è´è½½ææ­£å¨è¿è¡åæºç»´æ¤ï¼ç°å¨æ æ³å¤çè¯·æ±\n\n\n# è®¾ç½® http ç¶æç çæ¹æ³\n\nä¸é¢çæ¹æ³å¯ç¨äºå¨ servlet ç¨åºä¸­è®¾ç½® http ç¶æç ãè¿äºæ¹æ³éè¿ httpservletresponse å¯¹è±¡å¯ç¨ã\n\nåºå·   æ¹æ³ & æè¿°\n1    **public void setstatus ( int statuscode\n     )**è¯¥æ¹æ³è®¾ç½®ä¸ä¸ªä»»æçç¶æç ãsetstatus æ¹æ³æ¥åä¸ä¸ª\n     intï¼ç¶æç ï¼ä½ä¸ºåæ°ãå¦ææ¨çååºåå«äºä¸ä¸ªç¹æ®çç¶æç åææ¡£ï¼è¯·ç¡®ä¿å¨ä½¿ç¨ printwriter\n     å®éè¿åä»»ä½åå®¹ä¹åè°ç¨ setstatusã\n2    **public void sendredirect(string url)**è¯¥æ¹æ³çæä¸ä¸ª 302\n     ååºï¼è¿åä¸ä¸ªå¸¦ææ°ææ¡£ url ç location å¤´ã\n3    **public void senderror(int code, string\n     message)**è¯¥æ¹æ³åéä¸ä¸ªç¶æç ï¼éå¸¸ä¸º 404ï¼ï¼è¿åä¸ä¸ªå¨ html\n     ææ¡£åé¨èªå¨æ ¼å¼åå¹¶åéå°å®¢æ·ç«¯çç­æ¶æ¯ã\n\n\n# http ç¶æç å®ä¾\n\nä¸é¢çä¾å­æ 407 éè¯¯ä»£ç åéå°å®¢æ·ç«¯æµè§å¨ï¼æµè§å¨ä¼æ¾ç¤º "need authentication!!!" æ¶æ¯ã\n\n// å¯¼å¥å¿éç java åº\nimport java.io.*;\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.util.*;\n\n// æ©å± httpservlet ç±»\npublic class showerror extends httpservlet {\n\n  // å¤ç get æ¹æ³è¯·æ±çæ¹æ³\n  public void doget(httpservletrequest request,\n                    httpservletresponse response)\n            throws servletexception, ioexception\n  {\n      // è®¾ç½®éè¯¯ä»£ç ååå \n      response.senderror(407, "need authentication!!!" );\n  }\n  // å¤ç post æ¹æ³è¯·æ±çæ¹æ³\n  public void dopost(httpservletrequest request,\n                     httpservletresponse response)\n      throws servletexception, ioexception {\n     doget(request, response);\n  }\n}\n\n\nç°å¨ï¼è°ç¨ä¸é¢ç servlet å°æ¾ç¤ºä»¥ä¸ç»æï¼\n\nhttp status 407 - need authentication!!!\ntype status report\nmessage need authentication!!!\ndescription the client must first authenticate itself with the proxy (need authentication!!!).\napache tomcat/5.5.29\n\n\n\n# åèèµæ\n\n * æ·±å¥æè§£ tomcat & jetty\n * java web æ´åå¼åçèå½æ¥',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaWeb ä¹ Jsp æå",frontmatter:{title:"JavaWeb ä¹ Jsp æå",categories:["ç¼ç¨","Java","JavaWeb"],tags:["Java","JavaWeb","JSP"],abbrlink:"339b3115",date:"2020-02-07T23:04:47.000Z",permalink:"/pages/6bbb16/"},regularPath:"/02.JavaEE/01.JavaWeb/02.JavaWeb%E4%B9%8BJsp%E6%8C%87%E5%8D%97.html",relativePath:"02.JavaEE/01.JavaWeb/02.JavaWebä¹Jspæå.md",key:"v-27772cc0",path:"/pages/6bbb16/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:23},{level:3,title:"ä»ä¹æ¯ Java Server Pages",slug:"ä»ä¹æ¯-java-server-pages",normalizedTitle:"ä»ä¹æ¯ java server pages",charIndex:30},{level:3,title:"ä¸ºä»ä¹ä½¿ç¨ JSP",slug:"ä¸ºä»ä¹ä½¿ç¨-jsp",normalizedTitle:"ä¸ºä»ä¹ä½¿ç¨ jsp",charIndex:361},{level:3,title:"JSP çä¼å¿",slug:"jsp-çä¼å¿",normalizedTitle:"jsp çä¼å¿",charIndex:793},{level:2,title:"JSP å·¥ä½åç",slug:"jsp-å·¥ä½åç",normalizedTitle:"jsp å·¥ä½åç",charIndex:1141},{level:3,title:"JSP å·¥ä½æµç¨",slug:"jsp-å·¥ä½æµç¨",normalizedTitle:"jsp å·¥ä½æµç¨",charIndex:1374},{level:4,title:"å·¥ä½æ­¥éª¤",slug:"å·¥ä½æ­¥éª¤",normalizedTitle:"å·¥ä½æ­¥éª¤",charIndex:1586},{level:3,title:"JSP çå½å¨æ",slug:"jsp-çå½å¨æ",normalizedTitle:"jsp çå½å¨æ",charIndex:2292},{level:4,title:"JSP ç¼è¯",slug:"jsp-ç¼è¯",normalizedTitle:"jsp ç¼è¯",charIndex:2685},{level:4,title:"JSP åå§å",slug:"jsp-åå§å",normalizedTitle:"jsp åå§å",charIndex:2841},{level:4,title:"JSP æ§è¡",slug:"jsp-æ§è¡",normalizedTitle:"jsp æ§è¡",charIndex:3050},{level:4,title:"JSP æ¸ç",slug:"jsp-æ¸ç",normalizedTitle:"jsp æ¸ç",charIndex:3445},{level:2,title:"è¯­æ³",slug:"è¯­æ³",normalizedTitle:"è¯­æ³",charIndex:3655},{level:3,title:"èæ¬",slug:"èæ¬",normalizedTitle:"èæ¬",charIndex:572},{level:4,title:"ä¸­æç¼ç é®é¢",slug:"ä¸­æç¼ç é®é¢",normalizedTitle:"ä¸­æç¼ç é®é¢",charIndex:4260},{level:3,title:"JSP å£°æ",slug:"jsp-å£°æ",normalizedTitle:"jsp å£°æ",charIndex:4739},{level:3,title:"JSP è¡¨è¾¾å¼",slug:"jsp-è¡¨è¾¾å¼",normalizedTitle:"jsp è¡¨è¾¾å¼",charIndex:5037},{level:3,title:"JSP æ³¨é",slug:"jsp-æ³¨é",normalizedTitle:"jsp æ³¨é",charIndex:5688},{level:3,title:"æ§å¶è¯­å¥",slug:"æ§å¶è¯­å¥",normalizedTitle:"æ§å¶è¯­å¥",charIndex:6333},{level:4,title:"ifâ¦else è¯­å¥",slug:"if-else-è¯­å¥",normalizedTitle:"ifâ¦else è¯­å¥",charIndex:6416},{level:4,title:"switchâ¦case è¯­å¥",slug:"switch-case-è¯­å¥",normalizedTitle:"switchâ¦case è¯­å¥",charIndex:6862},{level:4,title:"å¾ªç¯è¯­å¥",slug:"å¾ªç¯è¯­å¥",normalizedTitle:"å¾ªç¯è¯­å¥",charIndex:6405},{level:3,title:"JSP å­é¢é",slug:"jsp-å­é¢é",normalizedTitle:"jsp å­é¢é",charIndex:9415},{level:2,title:"æä»¤",slug:"æä»¤",normalizedTitle:"æä»¤",charIndex:9572},{level:3,title:"Page æä»¤",slug:"page-æä»¤",normalizedTitle:"page æä»¤",charIndex:9886},{level:4,title:"å±æ§",slug:"å±æ§",normalizedTitle:"å±æ§",charIndex:6293},{level:3,title:"Include æä»¤",slug:"include-æä»¤",normalizedTitle:"include æä»¤",charIndex:10725},{level:3,title:"Taglib æä»¤",slug:"taglib-æä»¤",normalizedTitle:"taglib æä»¤",charIndex:11015},{level:2,title:"JSP å¨ä½åç´ ",slug:"jsp-å¨ä½åç´ ",normalizedTitle:"jsp å¨ä½åç´ ",charIndex:11268},{level:3,title:"å¸¸è§çå±æ§",slug:"å¸¸è§çå±æ§",normalizedTitle:"å¸¸è§çå±æ§",charIndex:12037},{level:3,title:"<jsp:include>",slug:"jsp-include",normalizedTitle:'<a href="jsp:include">jsp:include</a>',charIndex:null},{level:3,title:"<jsp:useBean>",slug:"jsp-usebean",normalizedTitle:'<a href="jsp:usebean">jsp:usebean</a>',charIndex:null},{level:3,title:"<jsp:setProperty>",slug:"jsp-setproperty",normalizedTitle:'<a href="jsp:setproperty">jsp:setproperty</a>',charIndex:null},{level:3,title:"<jsp:getProperty>",slug:"jsp-getproperty",normalizedTitle:'<a href="jsp:getproperty">jsp:getproperty</a>',charIndex:null},{level:3,title:"<jsp:forward>",slug:"jsp-forward",normalizedTitle:'<a href="jsp:forward">jsp:forward</a>',charIndex:null},{level:3,title:"<jsp:plugin>",slug:"jsp-plugin",normalizedTitle:'<a href="jsp:plugin">jsp:plugin</a>',charIndex:null},{level:3,title:"<jsp:element> ã <jsp:attribute>ã<jsp:body>",slug:"jsp-element-ã-jsp-attribute-ã-jsp-body",normalizedTitle:'<a href="jsp:element">jsp:element</a> ã <a href="jsp:attribute">jsp:attribute</a>ã<a href="jsp:body">jsp:body</a>',charIndex:null},{level:3,title:"<jsp:text>",slug:"jsp-text",normalizedTitle:'<a href="jsp:text">jsp:text</a>',charIndex:null},{level:2,title:"JSP éå¼å¯¹è±¡",slug:"jsp-éå¼å¯¹è±¡",normalizedTitle:"jsp éå¼å¯¹è±¡",charIndex:18958},{level:3,title:"request å¯¹è±¡",slug:"request-å¯¹è±¡",normalizedTitle:"request å¯¹è±¡",charIndex:19440},{level:3,title:"response å¯¹è±¡",slug:"response-å¯¹è±¡",normalizedTitle:"response å¯¹è±¡",charIndex:19611},{level:3,title:"out å¯¹è±¡",slug:"out-å¯¹è±¡",normalizedTitle:"out å¯¹è±¡",charIndex:10213},{level:3,title:"session å¯¹è±¡",slug:"session-å¯¹è±¡",normalizedTitle:"session å¯¹è±¡",charIndex:20277},{level:3,title:"application å¯¹è±¡",slug:"application-å¯¹è±¡",normalizedTitle:"application å¯¹è±¡",charIndex:20401},{level:3,title:"config å¯¹è±¡",slug:"config-å¯¹è±¡",normalizedTitle:"config å¯¹è±¡",charIndex:20636},{level:3,title:"pageContext å¯¹è±¡",slug:"pagecontext-å¯¹è±¡",normalizedTitle:"pagecontext å¯¹è±¡",charIndex:20911},{level:3,title:"page å¯¹è±¡",slug:"page-å¯¹è±¡",normalizedTitle:"page å¯¹è±¡",charIndex:21494},{level:3,title:"exception å¯¹è±¡",slug:"exception-å¯¹è±¡",normalizedTitle:"exception å¯¹è±¡",charIndex:21563},{level:2,title:"EL è¡¨è¾¾å¼",slug:"el-è¡¨è¾¾å¼",normalizedTitle:"el è¡¨è¾¾å¼",charIndex:10681},{level:3,title:"ä¸ä¸ªç®åçè¯­æ³",slug:"ä¸ä¸ªç®åçè¯­æ³",normalizedTitle:"ä¸ä¸ªç®åçè¯­æ³",charIndex:21843},{level:3,title:"EL ä¸­çåºç¡æä½ç¬¦",slug:"el-ä¸­çåºç¡æä½ç¬¦",normalizedTitle:"el ä¸­çåºç¡æä½ç¬¦",charIndex:22724},{level:3,title:"JSP EL ä¸­çå½æ°",slug:"jsp-el-ä¸­çå½æ°",normalizedTitle:"jsp el ä¸­çå½æ°",charIndex:23136},{level:3,title:"JSP EL éå«å¯¹è±¡",slug:"jsp-el-éå«å¯¹è±¡",normalizedTitle:"jsp el éå«å¯¹è±¡",charIndex:23452},{level:3,title:"pageContext å¯¹è±¡",slug:"pagecontext-å¯¹è±¡-2",normalizedTitle:"pagecontext å¯¹è±¡",charIndex:20911},{level:3,title:"Scope å¯¹è±¡",slug:"scope-å¯¹è±¡",normalizedTitle:"scope å¯¹è±¡",charIndex:24082},{level:3,title:"param å paramValues å¯¹è±¡",slug:"param-å-paramvalues-å¯¹è±¡",normalizedTitle:"param å paramvalues å¯¹è±¡",charIndex:24244},{level:3,title:"header å headerValues å¯¹è±¡",slug:"header-å-headervalues-å¯¹è±¡",normalizedTitle:"header å headervalues å¯¹è±¡",charIndex:24842},{level:2,title:"JSTL",slug:"jstl",normalizedTitle:"jstl",charIndex:23325},{level:3,title:"JSTL åºå®è£",slug:"jstl-åºå®è£",normalizedTitle:"jstl åºå®è£",charIndex:25675},{level:3,title:"æ ¸å¿æ ç­¾",slug:"æ ¸å¿æ ç­¾",normalizedTitle:"æ ¸å¿æ ç­¾",charIndex:25626},{level:3,title:"æ ¼å¼åæ ç­¾",slug:"æ ¼å¼åæ ç­¾",normalizedTitle:"æ ¼å¼åæ ç­¾",charIndex:25634},{level:3,title:"SQL æ ç­¾",slug:"sql-æ ç­¾",normalizedTitle:"sql æ ç­¾",charIndex:25549},{level:3,title:"XML æ ç­¾",slug:"xml-æ ç­¾",normalizedTitle:"xml æ ç­¾",charIndex:25653},{level:3,title:"JSTL å½æ°",slug:"jstl-å½æ°",normalizedTitle:"jstl å½æ°",charIndex:25663},{level:2,title:"Taglib",slug:"taglib",normalizedTitle:"taglib",charIndex:11015},{level:3,title:"JSP èªå®ä¹æ ç­¾",slug:"jsp-èªå®ä¹æ ç­¾",normalizedTitle:"jsp èªå®ä¹æ ç­¾",charIndex:30920},{level:3,title:'åå»º"Hello"æ ç­¾',slug:"åå»º-hello-æ ç­¾",normalizedTitle:"åå»º&quot;hello&quot;æ ç­¾",charIndex:null},{level:3,title:"è®¿é®æ ç­¾ä½",slug:"è®¿é®æ ç­¾ä½",normalizedTitle:"è®¿é®æ ç­¾ä½",charIndex:32281},{level:3,title:"èªå®ä¹æ ç­¾å±æ§",slug:"èªå®ä¹æ ç­¾å±æ§",normalizedTitle:"èªå®ä¹æ ç­¾å±æ§",charIndex:33335}],headersStr:'ç®ä» ä»ä¹æ¯ Java Server Pages ä¸ºä»ä¹ä½¿ç¨ JSP JSP çä¼å¿ JSP å·¥ä½åç JSP å·¥ä½æµç¨ å·¥ä½æ­¥éª¤ JSP çå½å¨æ JSP ç¼è¯ JSP åå§å JSP æ§è¡ JSP æ¸ç è¯­æ³ èæ¬ ä¸­æç¼ç é®é¢ JSP å£°æ JSP è¡¨è¾¾å¼ JSP æ³¨é æ§å¶è¯­å¥ ifâ¦else è¯­å¥ switchâ¦case è¯­å¥ å¾ªç¯è¯­å¥ JSP å­é¢é æä»¤ Page æä»¤ å±æ§ Include æä»¤ Taglib æä»¤ JSP å¨ä½åç´  å¸¸è§çå±æ§ <jsp:include> <jsp:useBean> <jsp:setProperty> <jsp:getProperty> <jsp:forward> <jsp:plugin> <jsp:element> ã <jsp:attribute>ã<jsp:body> <jsp:text> JSP éå¼å¯¹è±¡ request å¯¹è±¡ response å¯¹è±¡ out å¯¹è±¡ session å¯¹è±¡ application å¯¹è±¡ config å¯¹è±¡ pageContext å¯¹è±¡ page å¯¹è±¡ exception å¯¹è±¡ EL è¡¨è¾¾å¼ ä¸ä¸ªç®åçè¯­æ³ EL ä¸­çåºç¡æä½ç¬¦ JSP EL ä¸­çå½æ° JSP EL éå«å¯¹è±¡ pageContext å¯¹è±¡ Scope å¯¹è±¡ param å paramValues å¯¹è±¡ header å headerValues å¯¹è±¡ JSTL JSTL åºå®è£ æ ¸å¿æ ç­¾ æ ¼å¼åæ ç­¾ SQL æ ç­¾ XML æ ç­¾ JSTL å½æ° Taglib JSP èªå®ä¹æ ç­¾ åå»º"Hello"æ ç­¾ è®¿é®æ ç­¾ä½ èªå®ä¹æ ç­¾å±æ§',content:'# JavaWeb ä¹ Jsp æå\n\n\n# ç®ä»\n\n\n# ä»ä¹æ¯ Java Server Pages\n\nJSPå¨ç§°Java Server Pagesï¼æ¯ä¸ç§å¨æç½é¡µå¼åææ¯ã\n\nå®ä½¿ç¨ JSP æ ç­¾å¨ HTML ç½é¡µä¸­æå¥ Java ä»£ç ãæ ç­¾éå¸¸ä»¥<%å¼å¤´ä»¥%>ç»æã\n\nJSP æ¯ä¸ç§ Java servletï¼ä¸»è¦ç¨äºå®ç° Java web åºç¨ç¨åºçç¨æ·çé¢é¨åãç½é¡µå¼åèä»¬éè¿ç»å HTML ä»£ç ãXHTML ä»£ç ãXML åç´ ä»¥ååµå¥ JSP æä½åå½ä»¤æ¥ç¼å JSPã\n\nJSP éè¿ç½é¡µè¡¨åè·åç¨æ·è¾å¥æ°æ®ãè®¿é®æ°æ®åºåå¶ä»æ°æ®æºï¼ç¶åå¨æå°åå»ºç½é¡µã\n\nJSP æ ç­¾æå¤ç§åè½ï¼æ¯å¦è®¿é®æ°æ®åºãè®°å½ç¨æ·éæ©ä¿¡æ¯ãè®¿é® JavaBeans ç»ä»¶ç­ï¼è¿å¯ä»¥å¨ä¸åçç½é¡µä¸­ä¼ éæ§å¶ä¿¡æ¯åå±äº«ä¿¡æ¯ã\n\n\n# ä¸ºä»ä¹ä½¿ç¨ JSP\n\nJSP ä¹æ¯ä¸ç§ Servletï¼å æ­¤ JSP è½å¤å®æ Servlet è½å®æçä»»ä½å·¥ä½ã\n\nJSP ç¨åºä¸ CGI ç¨åºæçç¸ä¼¼çåè½ï¼ä½å CGI ç¨åºç¸æ¯ï¼JSP ç¨åºæå¦ä¸ä¼å¿ï¼\n\n * æ§è½æ´å ä¼è¶ï¼å ä¸º JSP å¯ä»¥ç´æ¥å¨ HTML ç½é¡µä¸­å¨æåµå¥åç´ èä¸éè¦åç¬å¼ç¨ CGI æä»¶ã\n * æå¡å¨è°ç¨çæ¯å·²ç»ç¼è¯å¥½ç JSP æä»¶ï¼èä¸å CGI/Perl é£æ ·å¿é¡»åè½½å¥è§£éå¨åç®æ èæ¬ã\n * JSP åºäº Java Servlets APIï¼å æ­¤ï¼JSP æ¥æåç§å¼ºå¤§çä¼ä¸çº§ Java APIï¼åæ¬ JDBCï¼JNDIï¼EJBï¼JAXP ç­ç­ã\n * JSP é¡µé¢å¯ä»¥ä¸å¤çä¸å¡é»è¾ç servlets ä¸èµ·ä½¿ç¨ï¼è¿ç§æ¨¡å¼è¢« Java servlet æ¨¡æ¿å¼æææ¯æã\n\næåï¼JSP æ¯ Java EE ä¸å¯æç¼ºçä¸é¨åï¼æ¯ä¸ä¸ªå®æ´çä¼ä¸çº§åºç¨å¹³å°ãè¿æå³ç JSP å¯ä»¥ç¨æç®åçæ¹å¼æ¥å®ç°æå¤æçåºç¨ã\n\n\n# JSP çä¼å¿\n\nä»¥ä¸ååºäºä½¿ç¨ JSP å¸¦æ¥çå¶ä»å¥½å¤ï¼\n\n * ä¸ ASP ç¸æ¯ï¼JSP æä¸¤å¤§ä¼å¿ãé¦åï¼å¨æé¨åç¨ Java ç¼åï¼èä¸æ¯ VB æå¶ä» MS ä¸ç¨è¯­è¨ï¼æä»¥æ´å å¼ºå¤§ä¸æç¨ãç¬¬äºç¹å°±æ¯ JSP æäºç§»æ¤å°é MS å¹³å°ä¸ã\n * ä¸çº¯ Servlets ç¸æ¯ï¼JSP å¯ä»¥å¾æ¹ä¾¿çç¼åæèä¿®æ¹ HTML ç½é¡µèä¸ç¨å»é¢å¯¹å¤§éç println è¯­å¥ã\n * ä¸ SSI ç¸æ¯ï¼SSI æ æ³ä½¿ç¨è¡¨åæ°æ®ãæ æ³è¿è¡æ°æ®åºé¾æ¥ã\n * ä¸ JavaScript ç¸æ¯ï¼è½ç¶ JavaScript å¯ä»¥å¨å®¢æ·ç«¯å¨æçæ HTMLï¼ä½æ¯å¾é¾ä¸æå¡å¨äº¤äºï¼å æ­¤ä¸è½æä¾å¤æçæå¡ï¼æ¯å¦è®¿é®æ°æ®åºåå¾åå¤çç­ç­ã\n * ä¸éæ HTML ç¸æ¯ï¼éæ HTML ä¸åå«å¨æä¿¡æ¯ã\n\n\n# JSP å·¥ä½åç\n\nJSP æ¯ä¸ç§ Servletï¼ä½å·¥ä½æ¹å¼å Servlet ææå·®å«ã\n\nServlet æ¯åå°æºä»£ç ç¼è¯ä¸º class æä»¶åé¨ç½²å°æå¡å¨ä¸çï¼åç¼è¯åé¨ç½²ã\n\nJsp æ¯åå°æºä»£ç é¨ç½²å°æå¡å¨åç¼è¯ï¼åé¨ç½²åç¼è¯ã\n\nJsp ä¼å¨å®¢æ·ç«¯ç¬¬ä¸æ¬¡è¯·æ± Jsp æä»¶æ¶è¢«ç¼è¯ä¸º HttpJspPage ç±»ï¼Servlet çä¸ä¸ªå­ç±»ï¼ãè¯¥ç±»ä¼è¢«æå¡å¨ä¸´æ¶å­æ¾å¨æå¡å¨å·¥ä½ç®å½éãæä»¥ï¼ç¬¬ä¸æ¬¡è¯·æ± Jsp åï¼è®¿é®éåº¦ä¼åå¿«å°±æ¯è¿ä¸ªéçã\n\n\n# JSP å·¥ä½æµç¨\n\nç½ç»æå¡å¨éè¦ä¸ä¸ª JSP å¼æï¼ä¹å°±æ¯ä¸ä¸ªå®¹å¨æ¥å¤ç JSP é¡µé¢ãå®¹å¨è´è´£æªè·å¯¹ JSP é¡µé¢çè¯·æ±ãæ¬æç¨ä½¿ç¨ååµ JSP å®¹å¨ç Apache æ¥æ¯æ JSP å¼åã\n\nJSP å®¹å¨ä¸ Web æå¡å¨åååä½ï¼ä¸º JSP çæ­£å¸¸è¿è¡æä¾å¿è¦çè¿è¡ç¯å¢åå¶ä»æå¡ï¼å¹¶ä¸è½å¤æ­£ç¡®è¯å«ä¸å±äº JSP ç½é¡µçç¹æ®åç´ ã\n\nä¸å¾æ¾ç¤ºäº JSP å®¹å¨å JSP æä»¶å¨ Web åºç¨ä¸­æå¤çä½ç½®ã\n\n\n\n# å·¥ä½æ­¥éª¤\n\nä»¥ä¸æ­¥éª¤è¡¨æäº Web æå¡å¨æ¯å¦ä½ä½¿ç¨ JSP æ¥åå»ºç½é¡µçï¼\n\n * å°±åå¶ä»æ®éçç½é¡µä¸æ ·ï¼æ¨çæµè§å¨åéä¸ä¸ª HTTP è¯·æ±ç»æå¡å¨ã\n * Web æå¡å¨è¯å«åºè¿æ¯ä¸ä¸ªå¯¹ JSP ç½é¡µçè¯·æ±ï¼å¹¶ä¸å°è¯¥è¯·æ±ä¼ éç» JSP å¼æãéè¿ä½¿ç¨ URL æè.jsp æä»¶æ¥å®æã\n * JSP å¼æä»ç£çä¸­è½½å¥ JSP æä»¶ï¼ç¶åå°å®ä»¬è½¬åä¸º servletãè¿ç§è½¬ååªæ¯ç®åå°å°æææ¨¡æ¿ææ¬æ¹ç¨ println()è¯­å¥ï¼å¹¶ä¸å°ææç JSP åç´ è½¬åæ Java ä»£ç ã\n * JSP å¼æå° servlet ç¼è¯æå¯æ§è¡ç±»ï¼å¹¶ä¸å°åå§è¯·æ±ä¼ éç» servlet å¼æã\n * Web æå¡å¨çæç»ä»¶å°ä¼è°ç¨ servlet å¼æï¼ç¶åè½½å¥å¹¶æ§è¡ servlet ç±»ãå¨æ§è¡è¿ç¨ä¸­ï¼servlet äº§ç HTML æ ¼å¼çè¾åºå¹¶å°å¶ååµäº HTTP response ä¸­ä¸äº¤ç» Web æå¡å¨ã\n * Web æå¡å¨ä»¥éæ HTML ç½é¡µçå½¢å¼å° HTTP response è¿åå°æ¨çæµè§å¨ä¸­ã\n * æç»ï¼Web æµè§å¨å¤ç HTTP response ä¸­å¨æäº§çç HTML ç½é¡µï¼å°±å¥½åå¨å¤çéæç½é¡µä¸æ ·ã\n\nä»¥ä¸æåå°çæ­¥éª¤å¯ä»¥ç¨ä¸å¾æ¥è¡¨ç¤ºï¼\n\nä¸è¬æåµä¸ï¼JSP å¼æä¼æ£æ¥ JSP æä»¶å¯¹åºç servlet æ¯å¦å·²ç»å­å¨ï¼å¹¶ä¸æ£æ¥ JSP æä»¶çä¿®æ¹æ¥ææ¯å¦æ©äº servletãå¦æ JSP æä»¶çä¿®æ¹æ¥ææ©äºå¯¹åºç servletï¼é£ä¹å®¹å¨å°±å¯ä»¥ç¡®å® JSP æä»¶æ²¡æè¢«ä¿®æ¹è¿å¹¶ä¸ servlet ææãè¿ä½¿å¾æ´ä¸ªæµç¨ä¸å¶ä»èæ¬è¯­è¨ï¼æ¯å¦ PHPï¼ç¸æ¯è¦é«æå¿«æ·ä¸äºã\n\n\n# JSP çå½å¨æ\n\nçè§£ JSP åºå±åè½çå³é®å°±æ¯å»çè§£å®ä»¬æéµå®ççå½å¨æã\n\nJSP çå½å¨æå°±æ¯ä»åå»ºå°éæ¯çæ´ä¸ªè¿ç¨ï¼ç±»ä¼¼äº servlet çå½å¨æï¼åºå«å¨äº JSP çå½å¨æè¿åæ¬å° JSP æä»¶ç¼è¯æ servletã\n\nä»¥ä¸æ¯ JSP çå½å¨æä¸­æèµ°è¿çå ä¸ªé¶æ®µï¼\n\n * **ç¼è¯é¶æ®µï¼**servlet å®¹å¨ç¼è¯ servlet æºæä»¶ï¼çæ servlet ç±»\n * **åå§åé¶æ®µï¼**å è½½ä¸ JSP å¯¹åºç servlet ç±»ï¼åå»ºå¶å®ä¾ï¼å¹¶è°ç¨å®çåå§åæ¹æ³\n * **æ§è¡é¶æ®µï¼**è°ç¨ä¸ JSP å¯¹åºç servlet å®ä¾çæå¡æ¹æ³\n * **éæ¯é¶æ®µï¼**è°ç¨ä¸ JSP å¯¹åºç servlet å®ä¾çéæ¯æ¹æ³ï¼ç¶åéæ¯ servlet å®ä¾\n\nå¾ææ¾ï¼JSP çå½å¨æçåä¸ªä¸»è¦é¶æ®µå servlet çå½å¨æéå¸¸ç¸ä¼¼ï¼ä¸é¢ç»åºå¾ç¤ºï¼\n\n\n\n# JSP ç¼è¯\n\nå½æµè§å¨è¯·æ± JSP é¡µé¢æ¶ï¼JSP å¼æä¼é¦åå»æ£æ¥æ¯å¦éè¦ç¼è¯è¿ä¸ªæä»¶ãå¦æè¿ä¸ªæä»¶æ²¡æè¢«ç¼è¯è¿ï¼æèå¨ä¸æ¬¡ç¼è¯åè¢«æ´æ¹è¿ï¼åç¼è¯è¿ä¸ª JSP æä»¶ã\n\nç¼è¯çè¿ç¨åæ¬ä¸ä¸ªæ­¥éª¤ï¼\n\n * è§£æ JSP æä»¶ã\n * å° JSP æä»¶è½¬ä¸º servletã\n * ç¼è¯ servletã\n\n# JSP åå§å\n\nå®¹å¨è½½å¥ JSP æä»¶åï¼å®ä¼å¨ä¸ºè¯·æ±æä¾ä»»ä½æå¡åè°ç¨ jspInit()æ¹æ³ãå¦ææ¨éè¦æ§è¡èªå®ä¹ç JSP åå§åä»»å¡ï¼å¤å jspInit()æ¹æ³å°±è¡äºï¼å°±åä¸é¢è¿æ ·ï¼\n\npublic void jspInit(){\n  // åå§åä»£ç \n}\n\n\nä¸è¬æ¥è®²ç¨åºåªåå§åä¸æ¬¡ï¼servlet ä¹æ¯å¦æ­¤ãéå¸¸æåµä¸æ¨å¯ä»¥å¨ jspInit()æ¹æ³ä¸­åå§åæ°æ®åºè¿æ¥ãæå¼æä»¶ååå»ºæ¥è¯¢è¡¨ã\n\n# JSP æ§è¡\n\nè¿ä¸é¶æ®µæè¿°äº JSP çå½å¨æä¸­ä¸åä¸è¯·æ±ç¸å³çäº¤äºè¡ä¸ºï¼ç´å°è¢«éæ¯ã\n\nå½ JSP ç½é¡µå®æåå§ååï¼JSP å¼æå°ä¼è°ç¨ _jspService() æ¹æ³ã\n\n_jspService() æ¹æ³éè¦ä¸ä¸ª HttpServletRequest å¯¹è±¡åä¸ä¸ª HttpServletResponse å¯¹è±¡ä½ä¸ºå®çåæ°ï¼å°±åä¸é¢è¿æ ·ï¼\n\nvoid _jspService(HttpServletRequest request,\n                 HttpServletResponse response) {\n   // æå¡ç«¯å¤çä»£ç \n}\n\n\n_jspService() æ¹æ³å¨æ¯ä¸ª request ä¸­è¢«è°ç¨ä¸æ¬¡å¹¶ä¸è´è´£äº§çä¸ä¹ç¸å¯¹åºç responseï¼å¹¶ä¸å®è¿è´è´£äº§çææ 7 ä¸ª HTTP æ¹æ³çååºï¼æ¯å¦ GETãPOSTãDELETE ç­ç­ã\n\n# JSP æ¸ç\n\nJSP çå½å¨æçéæ¯é¶æ®µæè¿°äºå½ä¸ä¸ª JSP ç½é¡µä»å®¹å¨ä¸­è¢«ç§»é¤æ¶æåççä¸åã\n\njspDestroy()æ¹æ³å¨ JSP ä¸­ç­ä»·äº servlet ä¸­çéæ¯æ¹æ³ãå½æ¨éè¦æ§è¡ä»»ä½æ¸çå·¥ä½æ¶å¤å jspDestroy()æ¹æ³ï¼æ¯å¦éæ¾æ°æ®åºè¿æ¥æèå³é­æä»¶å¤¹ç­ç­ã\n\njspDestroy()æ¹æ³çæ ¼å¼å¦ä¸ï¼\n\npublic void jspDestroy() {\n   // æ¸çä»£ç \n}\n\n\n\n# è¯­æ³\n\n\n# èæ¬\n\nèæ¬ç¨åºå¯ä»¥åå«ä»»æéç Java è¯­å¥ãåéãæ¹æ³æè¡¨è¾¾å¼ï¼åªè¦å®ä»¬å¨èæ¬è¯­è¨ä¸­æ¯ææçã\n\nèæ¬ç¨åºçè¯­æ³æ ¼å¼ï¼\n\n<% ä»£ç çæ®µ %>\n\n\næèï¼æ¨ä¹å¯ä»¥ç¼åä¸å¶ç­ä»·ç XML è¯­å¥ï¼å°±åä¸é¢è¿æ ·ï¼\n\n<jsp:scriptlet>\n  ä»£ç çæ®µ\n</jsp:scriptlet>\n\n\nä»»ä½ææ¬ãHTML æ ç­¾ãJSP åç´ å¿é¡»åå¨èæ¬ç¨åºçå¤é¢ã\n\nä¸é¢ç»åºä¸ä¸ªç¤ºä¾ï¼åæ¶ä¹æ¯æ¬æç¨çç¬¬ä¸ä¸ª JSP ç¤ºä¾ï¼\n\n<html>\n  <head>\n    <title>Hello World</title>\n  </head>\n  <body>\n    Hello World!<br />\n    <% out.println("Your IP address is " + request.getRemoteAddr()); %>\n  </body>\n</html>\n\n\n**æ³¨æï¼**è¯·ç¡®ä¿ Apache Tomcat å·²ç»å®è£å¨ C:\\apache-tomcat-7.0.2 ç®å½ä¸å¹¶ä¸è¿è¡ç¯å¢å·²ç»æ­£ç¡®è®¾ç½®ã\n\nå°ä»¥ä¸ä»£ç ä¿å­å¨ hello.jsp ä¸­ï¼ç¶åå°å®æ¾ç½®å¨ C:\\apache-tomcat-7.0.2\\webapps\\ROOT ç®å½ä¸ï¼æå¼æµè§å¨å¹¶å¨å°åæ ä¸­è¾å¥ http://localhost:8080/hello.jsp ãè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\n\n\n# ä¸­æç¼ç é®é¢\n\nå¦ææä»¬è¦å¨é¡µé¢æ­£å¸¸æ¾ç¤ºä¸­æï¼æä»¬éè¦å¨ JSP æä»¶å¤´é¨æ·»å ä»¥ä¸ä»£ç ï¼<>\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n\n\næ¥ä¸æ¥æä»¬å°ä»¥ä¸ç¨åºä¿®æ¹ä¸ºï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    Hello World!<br />\n    <% out.println("ä½ ç IP å°å " + request.getRemoteAddr()); %>\n  </body>\n</html>\n\n\nè¿æ ·ä¸­æå°±å¯ä»¥æ­£å¸¸æ¾ç¤ºäºã\n\n\n# JSP å£°æ\n\nä¸ä¸ªå£°æè¯­å¥å¯ä»¥å£°æä¸ä¸ªæå¤ä¸ªåéãæ¹æ³ï¼ä¾åé¢ç Java ä»£ç ä½¿ç¨ãå¨ JSP æä»¶ä¸­ï¼æ¨å¿é¡»åå£°æè¿äºåéåæ¹æ³ç¶åæè½ä½¿ç¨å®ä»¬ã\n\nJSP å£°æçè¯­æ³æ ¼å¼ï¼\n\n<%! declaration; [ declaration; ]+ ... %>\n\n\næèï¼æ¨ä¹å¯ä»¥ç¼åä¸å¶ç­ä»·ç XML è¯­å¥ï¼å°±åä¸é¢è¿æ ·ï¼\n\n<jsp:declaration>\n  ä»£ç çæ®µ\n</jsp:declaration>\n\n\nç¨åºç¤ºä¾ï¼\n\n<%! int i = 0; %> <%! int a, b, c; %> <%! Circle a = new Circle(2.0); %>\n\n\n\n# JSP è¡¨è¾¾å¼\n\nä¸ä¸ª JSP è¡¨è¾¾å¼ä¸­åå«çèæ¬è¯­è¨è¡¨è¾¾å¼ï¼åè¢«è½¬åæ Stringï¼ç¶åæå¥å°è¡¨è¾¾å¼åºç°çå°æ¹ã\n\nç±äºè¡¨è¾¾å¼çå¼ä¼è¢«è½¬åæ Stringï¼æä»¥æ¨å¯ä»¥å¨ä¸ä¸ªææ¬è¡ä¸­ä½¿ç¨è¡¨è¾¾å¼èä¸ç¨å»ç®¡å®æ¯å¦æ¯ HTML æ ç­¾ã\n\nè¡¨è¾¾å¼åç´ ä¸­å¯ä»¥åå«ä»»ä½ç¬¦å Java è¯­è¨è§èçè¡¨è¾¾å¼ï¼ä½æ¯ä¸è½ä½¿ç¨åå·æ¥ç»æè¡¨è¾¾å¼ã\n\nJSP è¡¨è¾¾å¼çè¯­æ³æ ¼å¼ï¼\n\n<%= è¡¨è¾¾å¼ %>\n\n\nåæ ·ï¼æ¨ä¹å¯ä»¥ç¼åä¸ä¹ç­ä»·ç XML è¯­å¥ï¼\n\n<jsp:expression>\n  è¡¨è¾¾å¼\n</jsp:expression>\n\n\nç¨åºç¤ºä¾ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <p>\n      ä»å¤©çæ¥ææ¯: <%= (new java.util.Date()).toLocaleString()%>\n    </p>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\nä»å¤©çæ¥ææ¯: 2016-6-25 13:40:07\n\n\n----------------------------------------\n\n\n# JSP æ³¨é\n\nJSP æ³¨éä¸»è¦æä¸¤ä¸ªä½ç¨ï¼ä¸ºä»£ç ä½æ³¨éä»¥åå°ææ®µä»£ç æ³¨éæã\n\nJSP æ³¨éçè¯­æ³æ ¼å¼ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>JSPæ³¨éç¤ºä¾</title>\n  </head>\n  <body>\n    <%-- è¯¥é¨åæ³¨éå¨ç½é¡µä¸­ä¸ä¼è¢«æ¾ç¤º--%>\n    <p>\n      ä»å¤©çæ¥ææ¯: <%= (new java.util.Date()).toLocaleString()%>\n    </p>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\nä»å¤©çæ¥ææ¯: 2016-6-25 13:41:26\n\n\nä¸åæåµä¸ä½¿ç¨æ³¨éçè¯­æ³è§åï¼\n\nè¯­æ³             æè¿°\n<%-- æ³¨é --%>   JSP æ³¨éï¼æ³¨éåå®¹ä¸ä¼è¢«åéè³æµè§å¨çè³ä¸ä¼è¢«ç¼è¯\n\x3c!-- æ³¨é --\x3e    HTML æ³¨éï¼éè¿æµè§å¨æ¥çç½é¡µæºä»£ç æ¶å¯ä»¥çè§æ³¨éåå®¹\n<%             ä»£è¡¨éæ <%å¸¸é\n%>             ä»£è¡¨éæ %> å¸¸é\n\'              å¨å±æ§ä¸­ä½¿ç¨çåå¼å·\n"              å¨å±æ§ä¸­ä½¿ç¨çåå¼å·\n\n\n# æ§å¶è¯­å¥\n\nJSP æä¾å¯¹ Java è¯­è¨çå¨é¢æ¯æãæ¨å¯ä»¥å¨ JSP ç¨åºä¸­ä½¿ç¨ Java API çè³å»ºç« Java ä»£ç åï¼åæ¬å¤æ­è¯­å¥åå¾ªç¯è¯­å¥ç­ç­ã\n\n# ifâ¦else è¯­å¥\n\nIfâ¦elseåï¼è¯·çä¸é¢è¿ä¸ªä¾å­ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%> <%! int day = 1; %>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>02.JSPè¯­æ³ - if...elseç¤ºä¾</title>\n  </head>\n  <body>\n    <h3>IF...ELSE å®ä¾</h3>\n    <% if (day == 1 | day == 7) { %>\n    <p>ä»å¤©æ¯å¨æ«</p>\n    <% } else { %>\n    <p>ä»å¤©ä¸æ¯å¨æ«</p>\n    <% } %>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\nIF...ELSE å®ä¾\nä»å¤©ä¸æ¯å¨æ«\n\n\n# switchâ¦case è¯­å¥\n\nç°å¨æ¥çç switchâ¦case åï¼ä¸ ifâ¦else åæå¾å¤§çä¸åï¼å®ä½¿ç¨ out.println()ï¼å¹¶ä¸æ´ä¸ªé½è£å¨èæ¬ç¨åºçæ ç­¾ä¸­ï¼å°±åä¸é¢è¿æ ·ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%> <%! int day = 3; %>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>02.JSPè¯­æ³ - switch...caseç¤ºä¾</title>\n  </head>\n  <body>\n    <h3>Sswitch...caseç¤ºä¾</h3>\n    <% switch(day) { case 0: out.println("ææå¤©"); break; case 1:\n    out.println("ææä¸"); break; case 2: out.println("ææäº"); break; case 3:\n    out.println("ææä¸"); break; case 4: out.println("ææå"); break; case 5:\n    out.println("ææäº"); break; default: out.println("ææå­"); } %>\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ï¼è¿è¡åå¾åºä»¥ä¸ç»æï¼\n\nSWITCH...CASE å®ä¾\n\nææä¸\n\n\n# å¾ªç¯è¯­å¥\n\nå¨ JSP ç¨åºä¸­å¯ä»¥ä½¿ç¨ Java çä¸ä¸ªåºæ¬å¾ªç¯ç±»åï¼forï¼whileï¼å doâ¦whileã\n\nè®©æä»¬æ¥çç for å¾ªç¯çä¾å­ï¼ä»¥ä¸è¾åºçä¸åå­ä½å¤§å°ç"èé¸æç¨"ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%> <%! int fontSize; %>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h3>For å¾ªç¯å®ä¾</h3>\n    <%for ( fontSize = 1; fontSize <= 3; fontSize++){ %>\n    <font color="green" size="<%= fontSize %>">\n      èé¸æç¨ </font\n    ><br />\n    <%}%>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\n\n\nå°ä¸ä¾æ¹ç¨ while å¾ªç¯æ¥åï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%> <%! int fontSize; %>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h3>While å¾ªç¯å®ä¾</h3>\n    <%while ( fontSize <= 3){ %>\n    <font color="green" size="<%= fontSize %>">\n      èé¸æç¨ </font\n    ><br />\n    <%fontSize++;%> <%}%>\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ï¼è¾åºç»æä¸ºï¼fontSize åå§åä¸º 0ï¼æä»¥å¤è¾åºäºä¸è¡ï¼ï¼\n\n\n\nJSP è¿ç®ç¬¦\n\nJSP æ¯æææ Java é»è¾åç®æ¯è¿ç®ç¬¦ã\n\nä¸è¡¨ç½ååºäº JSP å¸¸è§è¿ç®ç¬¦ï¼ä¼åçº§ä»é«å°åºï¼\n\nç±»å«      æä½ç¬¦                                   ç»åæ§\nåç¼      () [] . (ç¹è¿ç®ç¬¦)                        å·¦å°å³\nä¸å      ++ - - ! ~                            å³å°å·¦\nå¯ä¹æ§     * / %                                 å·¦å°å³\nå¯å æ§     + -                                   å·¦å°å³\nç§»ä½      >> >>> <<                             å·¦å°å³\nå³ç³»      > >= < <=                             å·¦å°å³\nç¸ç­/ä¸ç­   == !=                                 å·¦å°å³\nä½ä¸      &                                     å·¦å°å³\nä½å¼æ     ^                                     å·¦å°å³\nä½æ      |                                     å·¦å°å³\né»è¾ä¸     &&                                    å·¦å°å³\né»è¾æ     | |                                   å·¦å°å³\næ¡ä»¶å¤æ­    ?:                                    å³å°å·¦\nèµå¼      = += -= \\*= /= %= >>= <<= &= ^= | =   å³å°å·¦\néå·      ,                                     å·¦å°å³\n\n\n# JSP å­é¢é\n\nJSP è¯­è¨å®ä¹äºä»¥ä¸å ä¸ªå­é¢éï¼\n\n * å¸å°å¼(boolean)ï¼true å false;\n * æ´å(int)ï¼ä¸ Java ä¸­çä¸æ ·;\n * æµ®ç¹å(float)ï¼ä¸ Java ä¸­çä¸æ ·;\n * å­ç¬¦ä¸²(string)ï¼ä»¥åå¼å·æåå¼å·å¼å§åç»æ;\n * Nullï¼nullã\n\n\n# æä»¤\n\nJSP æä»¤ç¨æ¥è®¾ç½®æ´ä¸ª JSP é¡µé¢ç¸å³çå±æ§ï¼å¦ç½é¡µçç¼ç æ¹å¼åèæ¬è¯­è¨ã\n\nJSP æä»¤ä»¥å¼<%@å¼å§ï¼ä»¥%>ç»æã\n\nJSP æä»¤è¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<%@ directive attribute="value" %>\n\n\næä»¤å¯ä»¥æå¾å¤ä¸ªå±æ§ï¼å®ä»¬ä»¥é®å¼å¯¹çå½¢å¼å­å¨ï¼å¹¶ç¨éå·éå¼ã\n\nJSP ä¸­çä¸ç§æä»¤æ ç­¾ï¼\n\næä»¤                   æè¿°\n<%@ page ... %>      å®ä¹ç½é¡µä¾èµå±æ§ï¼æ¯å¦èæ¬è¯­è¨ãerror é¡µé¢ãç¼å­éæ±ç­ç­\n<%@ include ... %>   åå«å¶ä»æä»¶\n<%@ taglib ... %>    å¼å¥æ ç­¾åºçå®ä¹ï¼å¯ä»¥æ¯èªå®ä¹æ ç­¾\n\n\n# Page æä»¤\n\nPage æä»¤ä¸ºå®¹å¨æä¾å½åé¡µé¢çä½¿ç¨è¯´æãä¸ä¸ª JSP é¡µé¢å¯ä»¥åå«å¤ä¸ªpageæä»¤ã\n\nPage æä»¤çè¯­æ³æ ¼å¼ï¼\n\n<%@ page attribute="value" %>\n\n\nç­ä»·ç XML æ ¼å¼ï¼\n\n<jsp:directive.page attribute="value" />\n\n\nä¾ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8" %>\n\n\n# å±æ§\n\nä¸è¡¨ååºä¸ Page æä»¤ç¸å³çå±æ§ï¼\n\nå±æ§                   æè¿°\nbuffer               æå® out å¯¹è±¡ä½¿ç¨ç¼å²åºçå¤§å°\nautoFlush            æ§å¶ out å¯¹è±¡ç ç¼å­åº\ncontentType          æå®å½å JSP é¡µé¢ç MIME ç±»ååå­ç¬¦ç¼ç \nerrorPage            æå®å½ JSP é¡µé¢åçå¼å¸¸æ¶éè¦è½¬åçéè¯¯å¤çé¡µé¢\nisErrorPage          æå®å½åé¡µé¢æ¯å¦å¯ä»¥ä½ä¸ºå¦ä¸ä¸ª JSP é¡µé¢çéè¯¯å¤çé¡µé¢\nextends              æå® servlet ä»åªä¸ä¸ªç±»ç»§æ¿\nimport               å¯¼å¥è¦ä½¿ç¨ç Java ç±»\ninfo                 å®ä¹ JSP é¡µé¢çæè¿°ä¿¡æ¯\nisThreadSafe         æå®å¯¹ JSP é¡µé¢çè®¿é®æ¯å¦ä¸ºçº¿ç¨å®å¨\nlanguage             å®ä¹ JSP é¡µé¢æç¨çèæ¬è¯­è¨ï¼é»è®¤æ¯ Java\nsession              æå® JSP é¡µé¢æ¯å¦ä½¿ç¨ session\nisELIgnored          æå®æ¯å¦æ§è¡ EL è¡¨è¾¾å¼\nisScriptingEnabled   ç¡®å®èæ¬åç´ è½å¦è¢«ä½¿ç¨\n\n\n# Include æä»¤\n\nJSP å¯ä»¥éè¿includeæä»¤æ¥åå«å¶ä»æä»¶ã\n\nè¢«åå«çæä»¶å¯ä»¥æ¯ JSP æä»¶ãHTML æä»¶æææ¬æä»¶ãåå«çæä»¶å°±å¥½åæ¯è¯¥ JSP æä»¶çä¸é¨åï¼ä¼è¢«åæ¶ç¼è¯æ§è¡ã\n\nInclude æä»¤çè¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<%@ include file="æä»¶ç¸å¯¹ url å°å" %>\n\n\ninclude æä»¤ä¸­çæä»¶åå®éä¸æ¯ä¸ä¸ªç¸å¯¹ç URL å°åã\n\nå¦ææ¨æ²¡æç»æä»¶å³èä¸ä¸ªè·¯å¾ï¼JSP ç¼è¯å¨é»è®¤å¨å½åè·¯å¾ä¸å¯»æ¾ã\n\nç­ä»·ç XML è¯­æ³ï¼\n\n<jsp:directive.include file="æä»¶ç¸å¯¹ url å°å" />\n\n\n\n# Taglib æä»¤\n\nJSP åè®¸ç¨æ·èªå®ä¹æ ç­¾ï¼ä¸ä¸ªèªå®ä¹æ ç­¾åºå°±æ¯èªå®ä¹æ ç­¾çéåã\n\ntaglibæä»¤å¼å¥ä¸ä¸ªèªå®ä¹æ ç­¾éåçå®ä¹ï¼åæ¬åºè·¯å¾ãèªå®ä¹æ ç­¾ã\n\ntaglibæä»¤çè¯­æ³ï¼\n\n<%@ taglib uri="uri" prefix="prefixOfTag" %>\n\n\nuri å±æ§ç¡®å®æ ç­¾åºçä½ç½®ï¼prefix å±æ§æå®æ ç­¾åºçåç¼ã\n\nç­ä»·ç XML è¯­æ³ï¼\n\n<jsp:directive.taglib uri="uri" prefix="prefixOfTag" />\n\n\n\n# JSP å¨ä½åç´ \n\nJSP å¨ä½åç´ æ¯ä¸ç» JSP åç½®çæ ç­¾ï¼åªéè¦ä¹¦åå¾å°çæ è®°ä»£ç å°±è½ä½¿ç¨ JSP æä¾çä¸°å¯åè½ãJSP å¨ä½åç´ æ¯å¯¹å¸¸ç¨ç JSP åè½çæ½è±¡ä¸å°è£ï¼åæ¬ä¸¤ç§ï¼èªå®ä¹ JSP å¨ä½åç´ ä¸æ å JSP å¨ä½åç´ ã\n\nä¸ JSP æä»¤åç´ ä¸åçæ¯ï¼JSP å¨ä½åç´ å¨è¯·æ±å¤çé¶æ®µèµ·ä½ç¨ãJSP å¨ä½åç´ æ¯ç¨ XML è¯­æ³åæçã\n\nå©ç¨ JSP å¨ä½å¯ä»¥å¨æå°æå¥æä»¶ãéç¨ JavaBean ç»ä»¶ãæç¨æ·éå®åå°å¦å¤çé¡µé¢ãä¸º Java æä»¶çæ HTML ä»£ç ã\n\nå¨ä½åç´ åªæä¸ç§è¯­æ³ï¼å®ç¬¦å XML æ åï¼\n\n<jsp:action_name attribute="value" />\n\n\nå¨ä½åç´ åºæ¬ä¸é½æ¯é¢å®ä¹çå½æ°ï¼JSP è§èå®ä¹äºä¸ç³»åçæ åå¨ä½ï¼å®ç¨ JSP ä½ä¸ºåç¼ï¼å¯ç¨çæ åå¨ä½åç´ å¦ä¸ï¼\n\nè¯­æ³                æè¿°\njsp:include       å¨é¡µé¢è¢«è¯·æ±çæ¶åå¼å¥ä¸ä¸ªæä»¶ã\njsp:useBean       å¯»æ¾æèå®ä¾åä¸ä¸ª JavaBeanã\njsp:setProperty   è®¾ç½® JavaBean çå±æ§ã\njsp:getProperty   è¾åºæä¸ª JavaBean çå±æ§ã\njsp:forward       æè¯·æ±è½¬å°ä¸ä¸ªæ°çé¡µé¢ã\njsp:plugin        æ ¹æ®æµè§å¨ç±»åä¸º Java æä»¶çæ OBJECT æ EMBED æ è®°ã\njsp:element       å®ä¹å¨æ XML åç´ \njsp:attribute     è®¾ç½®å¨æå®ä¹ç XML åç´ å±æ§ã\njsp:body          è®¾ç½®å¨æå®ä¹ç XML åç´ åå®¹ã\njsp:text          å¨ JSP é¡µé¢åææ¡£ä¸­ä½¿ç¨åå¥ææ¬çæ¨¡æ¿\n\n\n# å¸¸è§çå±æ§\n\nææçå¨ä½è¦ç´ é½æä¸¤ä¸ªå±æ§ï¼id å±æ§å scope å±æ§ã\n\n * **id å±æ§ï¼**id å±æ§æ¯å¨ä½åç´ çå¯ä¸æ è¯ï¼å¯ä»¥å¨ JSP é¡µé¢ä¸­å¼ç¨ãå¨ä½åç´ åå»ºç id å¼å¯ä»¥éè¿ PageContext æ¥è°ç¨ã\n * **scope å±æ§ï¼**è¯¥å±æ§ç¨äºè¯å«å¨ä½åç´ ççå½å¨æã id å±æ§å scope å±æ§æç´æ¥å³ç³»ï¼scope å±æ§å®ä¹äºç¸å³è id å¯¹è±¡çå¯¿å½ã scope å±æ§æåä¸ªå¯è½çå¼ï¼ (a) page, (b)request, (c)session, å (d) applicationã\n\n\n# <jsp:include>\n\n<jsp:include> ç¨æ¥åå«éæåå¨æçæä»¶ãè¯¥å¨ä½ææå®æä»¶æå¥æ­£å¨çæçé¡µé¢ã\n\nå¦æè¢«åå«çæä»¶ä¸º JSP ç¨åºï¼åä¼åæ§è¡ JSP ç¨åºï¼åå°æ§è¡ç»æåå«è¿æ¥ã\n\nè¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<jsp:include page="ç¸å¯¹ URL å°å" flush="true" />\n\n\nåé¢å·²ç»ä»ç»è¿ include æä»¤ï¼å®æ¯å¨ JSP æä»¶è¢«è½¬æ¢æ Servlet çæ¶åå¼å¥æä»¶ï¼èè¿éç jsp:include å¨ä½ä¸åï¼æå¥æä»¶çæ¶é´æ¯å¨é¡µé¢è¢«è¯·æ±çæ¶åã\n\nä»¥ä¸æ¯ include å¨ä½ç¸å³çå±æ§åè¡¨ã\n\nå±æ§      æè¿°\npage    åå«å¨é¡µé¢ä¸­çç¸å¯¹ URL å°åã\nflush   å¸å°å±æ§ï¼å®ä¹å¨åå«èµæºåæ¯å¦å·æ°ç¼å­åºã\n\nç¤ºä¾ï¼\n\nä»¥ä¸æä»¬å®ä¹äºä¸¤ä¸ªæä»¶ date.jsp å main.jspï¼ä»£ç å¦ä¸æç¤ºï¼\n\ndate.jsp æä»¶ä»£ç ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<p>\n  ä»å¤©çæ¥ææ¯: <%= (new java.util.Date())%>\n</p>\n\n\nmain.jsp æä»¶ä»£ç ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h2>include å¨ä½å®ä¾</h2>\n    <jsp:include page="date.jsp" flush="true" />\n  </body>\n</html>\n\n\nç°å¨å°ä»¥ä¸ä¸¤ä¸ªæä»¶æ¾å¨æå¡å¨çæ ¹ç®å½ä¸ï¼è®¿é® main.jsp æä»¶ãæ¾ç¤ºç»æå¦ä¸ï¼\n\ninclude å¨ä½å®ä¾\n\nä»å¤©çæ¥ææ¯: 2016-6-25 14:08:17\n\n\n\n# <jsp:useBean>\n\njsp:useBean å¨ä½ç¨æ¥å è½½ä¸ä¸ªå°å¨ JSP é¡µé¢ä¸­ä½¿ç¨ç JavaBeanã\n\nè¿ä¸ªåè½éå¸¸æç¨ï¼å ä¸ºå®ä½¿å¾æä»¬å¯ä»¥åæ¥ Java ç»ä»¶å¤ç¨çä¼å¿ã\n\njsp:useBean å¨ä½æç®åçè¯­æ³ä¸ºï¼\n\n<jsp:useBean id="name" class="package.class" />\n\n\nå¨ç±»è½½å¥åï¼æä»¬æ¢å¯ä»¥éè¿ jsp:setProperty å jsp:getProperty å¨ä½æ¥ä¿®æ¹åæ£ç´¢ bean çå±æ§ã\n\nä»¥ä¸æ¯ useBean å¨ä½ç¸å³çå±æ§åè¡¨ã\n\nå±æ§         æè¿°\nclass      æå® Bean çå®æ´ååã\ntype       æå®å°å¼ç¨è¯¥å¯¹è±¡åéçç±»åã\nbeanName   éè¿ java.beans.Beans ç instantiate() æ¹æ³æå® Bean çåå­ã\n\nå¨ç»åºå·ä½å®ä¾åï¼è®©æä»¬åæ¥çä¸ jsp:setProperty å jsp:getProperty å¨ä½åç´ ï¼\n\n\n# <jsp:setProperty>\n\njsp:setProperty ç¨æ¥è®¾ç½®å·²ç»å®ä¾åç Bean å¯¹è±¡çå±æ§ï¼æä¸¤ç§ç¨æ³ãé¦åï¼ä½ å¯ä»¥å¨ jsp:useBean åç´ çå¤é¢ï¼åé¢ï¼ä½¿ç¨ jsp:setPropertyï¼å¦ä¸æç¤ºï¼\n\n<jsp:useBean id="myName" ... />\n...\n<jsp:setProperty name="myName" property="someProperty" .../>\n\n\næ­¤æ¶ï¼ä¸ç®¡ jsp:useBean æ¯æ¾å°äºä¸ä¸ªç°æç Beanï¼è¿æ¯æ°åå»ºäºä¸ä¸ª Bean å®ä¾ï¼jsp:setProperty é½ä¼æ§è¡ãç¬¬äºç§ç¨æ³æ¯æ jsp:setProperty æ¾å¥ jsp:useBean åç´ çåé¨ï¼å¦ä¸æç¤ºï¼\n\n<jsp:useBean id="myName" ... >\n...\n   <jsp:setProperty name="myName" property="someProperty" .../>\n</jsp:useBean>\n\n\næ­¤æ¶ï¼jsp:setProperty åªæå¨æ°å»º Bean å®ä¾æ¶æä¼æ§è¡ï¼å¦ææ¯ä½¿ç¨ç°æå®ä¾åä¸æ§è¡ jsp:setPropertyã\n\njsp:setProperty å¨ä½æä¸é¢åä¸ªå±æ§,å¦ä¸è¡¨ï¼\n\nå±æ§         æè¿°\nname       name å±æ§æ¯å¿éçãå®è¡¨ç¤ºè¦è®¾ç½®å±æ§çæ¯åªä¸ª Beanã\nproperty   property å±æ§æ¯å¿éçãå®è¡¨ç¤ºè¦è®¾ç½®åªä¸ªå±æ§ãæä¸ä¸ªç¹æ®ç¨æ³ï¼å¦æ property\n           çå¼æ¯"*"ï¼è¡¨ç¤ºææåå­å Bean å±æ§åå­å¹éçè¯·æ±åæ°é½å°è¢«ä¼ éç»ç¸åºçå±æ§ set æ¹æ³ã\nvalue      value å±æ§æ¯å¯éçãè¯¥å±æ§ç¨æ¥æå® Bean å±æ§çå¼ãå­ç¬¦ä¸²æ°æ®ä¼å¨ç®æ ç±»ä¸­éè¿æ åç valueOf\n           æ¹æ³èªå¨è½¬æ¢ææ°å­ãbooleanãBooleanã\n           byteãByteãcharãCharacterãä¾å¦ï¼boolean å Boolean\n           ç±»åçå±æ§å¼ï¼æ¯å¦"true"ï¼éè¿ Boolean.valueOf è½¬æ¢ï¼int å Integer\n           ç±»åçå±æ§å¼ï¼æ¯å¦"42"ï¼éè¿ Integer.valueOf è½¬æ¢ã ãã value å param\n           ä¸è½åæ¶ä½¿ç¨ï¼ä½å¯ä»¥ä½¿ç¨å¶ä¸­ä»»æä¸ä¸ªã\nparam      param æ¯å¯éçãå®æå®ç¨åªä¸ªè¯·æ±åæ°ä½ä¸º Bean å±æ§çå¼ãå¦æå½åè¯·æ±æ²¡æåæ°ï¼åä»ä¹äºæä¹ä¸åï¼ç³»ç»ä¸ä¼æ\n           null ä¼ éç» Bean å±æ§ç set æ¹æ³ãå æ­¤ï¼ä½ å¯ä»¥è®© Bean\n           èªå·±æä¾é»è®¤å±æ§å¼ï¼åªæå½è¯·æ±åæ°æç¡®æå®äºæ°å¼æ¶æä¿®æ¹é»è®¤å±æ§å¼ã\n\n\n# <jsp:getProperty>\n\njsp:getProperty å¨ä½æåæå® Bean å±æ§çå¼ï¼è½¬æ¢æå­ç¬¦ä¸²ï¼ç¶åè¾åºãè¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<jsp:useBean id="myName" ... />\n...\n<jsp:getProperty name="myName" property="someProperty" .../>\n\n\nä¸è¡¨æ¯ä¸ getProperty ç¸å³èçå±æ§ï¼\n\nå±æ§         æè¿°\nname       è¦æ£ç´¢ç Bean å±æ§åç§°ãBean å¿é¡»å·²å®ä¹ã\nproperty   è¡¨ç¤ºè¦æå Bean å±æ§çå¼\n\nå®ä¾\n\nä»¥ä¸å®ä¾æä»¬ä½¿ç¨äº Bean:\n\npackage com.runoob.main;\n\npublic class TestBean {\n   private String message = "èé¸æç¨";\n\n   public String getMessage() {\n      return(message);\n   }\n   public void setMessage(String message) {\n      this.message = message;\n   }\n}\n\n\nç¼è¯ä»¥ä¸å®ä¾æä»¶ TestBean.java ï¼\n\n$ javac TestBean.java\n\n\nç¼è¯å®æåä¼å¨å½åç®å½ä¸çæä¸ä¸ª TestBean.class æä»¶ï¼ å°è¯¥æä»¶æ·è´è³å½å JSP é¡¹ç®ç WebContent/WEB-INF/classes/com/runoob/main ä¸( com/runoob/main åè·¯å¾ï¼æ²¡æéè¦æå¨åå»º)ã\n\nä¸é¢æ¯ä¸ä¸ª Eclipse ä¸­ç®å½ç»æå¾ï¼\n\n\n\nä¸é¢æ¯ä¸ä¸ªå¾ç®åçä¾å­ï¼å®çåè½æ¯è£è½½ä¸ä¸ª Beanï¼ç¶åè®¾ç½®/è¯»åå®ç message å±æ§ã\n\nç°å¨è®©æä»¬å¨ main.jsp æä»¶ä¸­è°ç¨è¯¥ Bean:\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h2>Jsp ä½¿ç¨ JavaBean å®ä¾</h2>\n    <jsp:useBean id="test" class="com.runoob.main.TestBean" />\n\n    <jsp:setProperty name="test" property="message" value="èé¸æç¨..." />\n\n    <p>è¾åºä¿¡æ¯....</p>\n\n    <jsp:getProperty name="test" property="message" />\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ï¼æ§è¡ä»¥ä¸æä»¶ï¼è¾åºå¦ä¸æç¤ºï¼\n\n\n\n\n# <jsp:forward>\n\njsp:forward å¨ä½æè¯·æ±è½¬å°å¦å¤çé¡µé¢ãjsp:forward æ è®°åªæä¸ä¸ªå±æ§ pageãè¯­æ³æ ¼å¼å¦ä¸æç¤ºï¼\n\n<jsp:forward page="ç¸å¯¹ URL å°å" />\n\n\nä»¥ä¸æ¯ forward ç¸å³èçå±æ§ï¼\n\nå±æ§     æè¿°\npage   page å±æ§åå«çæ¯ä¸ä¸ªç¸å¯¹ URLãpage çå¼æ¢å¯ä»¥ç´æ¥ç»åºï¼ä¹å¯ä»¥å¨è¯·æ±çæ¶åå¨æè®¡ç®ï¼å¯ä»¥æ¯ä¸ä¸ª JSP\n       é¡µé¢æèä¸ä¸ª Java Servlet.\n\nå®ä¾\n\nä»¥ä¸å®ä¾æä»¬ä½¿ç¨äºä¸¤ä¸ªæä»¶ï¼åå«æ¯ï¼ date.jsp å main.jspã\n\ndate.jsp æä»¶ä»£ç å¦ä¸ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<p>\n  ä»å¤©çæ¥ææ¯: <%= (new java.util.Date()).toLocaleString()%>\n</p>\n\n\nmain.jsp æä»¶ä»£ç ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h2>forward å¨ä½å®ä¾</h2>\n    <jsp:forward page="date.jsp" />\n  </body>\n</html>\n\n\nç°å¨å°ä»¥ä¸ä¸¤ä¸ªæä»¶æ¾å¨æå¡å¨çæ ¹ç®å½ä¸ï¼è®¿é® main.jsp æä»¶ãæ¾ç¤ºç»æå¦ä¸ï¼\n\nä»å¤©çæ¥ææ¯: 2016-6-25 14:37:25\n\n\n\n# <jsp:plugin>\n\njsp:plugin å¨ä½ç¨æ¥æ ¹æ®æµè§å¨çç±»åï¼æå¥éè¿ Java æä»¶ è¿è¡ Java Applet æå¿éç OBJECT æ EMBED åç´ ã\n\nå¦æéè¦çæä»¶ä¸å­å¨ï¼å®ä¼ä¸è½½æä»¶ï¼ç¶åæ§è¡ Java ç»ä»¶ã Java ç»ä»¶å¯ä»¥æ¯ä¸ä¸ª applet æä¸ä¸ª JavaBeanã\n\nplugin å¨ä½æå¤ä¸ªå¯¹åº HTML åç´ çå±æ§ç¨äºæ ¼å¼å Java ç»ä»¶ãparam åç´ å¯ç¨äºå Applet æ Bean ä¼ éåæ°ã\n\nä»¥ä¸æ¯ä½¿ç¨ plugin å¨ä½åç´ çå¸åå®ä¾:\n\n<jsp:plugin type="applet" codebase="dirname" code="MyApplet.class"\n                           width="60" height="80">\n   <jsp:param name="fontcolor" value="red" />\n   <jsp:param name="background" value="black" />\n\n   <jsp:fallback>\n      Unable to initialize Java Plugin\n   </jsp:fallback>\n\n</jsp:plugin>\n\n\nå¦æä½ æå´è¶£å¯ä»¥å°è¯ä½¿ç¨ applet æ¥æµè¯ jsp:plugin å¨ä½åç´ ï¼<fallback> åç´ æ¯ä¸ä¸ªæ°åç´ ï¼å¨ç»ä»¶åºç°æéçéè¯¯æ¯åéç»ç¨æ·éè¯¯ä¿¡æ¯ã\n\n\n# <jsp:element> ã <jsp:attribute>ã<jsp:body>\n\n<jsp:element> ã <jsp:attribute>ã<jsp:body> å¨ä½åç´ å¨æå®ä¹ XML åç´ ãå¨ææ¯éå¸¸éè¦çï¼è¿å°±æå³ç XML åç´ å¨ç¼è¯æ¶æ¯å¨æçæçèééæã\n\nä»¥ä¸å®ä¾å¨æå®ä¹äº XML åç´ ï¼\n\n<%@ page language="java" contentType="text/html; charset=UTF-8"\npageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <jsp:element name="xmlElement">\n      <jsp:attribute name="xmlElementAttr">\n        å±æ§å¼\n      </jsp:attribute>\n      <jsp:body>\n        XML åç´ çä¸»ä½\n      </jsp:body>\n    </jsp:element>\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ä»¥ä¸é¡µé¢ï¼è¾åºç»æå¦ä¸æç¤ºï¼\n\n\n\n\n# <jsp:text>\n\njsp:textå¨ä½åç´ åè®¸å¨ JSP é¡µé¢åææ¡£ä¸­ä½¿ç¨åå¥ææ¬çæ¨¡æ¿ï¼è¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<jsp:text>æ¨¡æ¿æ°æ®</jsp:text>\n\n\nä»¥ä¸ææ¬æ¨¡æ¿ä¸è½åå«å¶ä»åç´ ï¼åªè½åªè½åå«ææ¬å EL è¡¨è¾¾å¼ï¼æ³¨ï¼EL è¡¨è¾¾å¼å°å¨åç»­ç« èä¸­ä»ç»ï¼ãè¯·æ³¨æï¼å¨ XML æä»¶ä¸­ï¼æ¨ä¸è½ä½¿ç¨è¡¨è¾¾å¼å¦ ${whatever > 0}ï¼å ä¸º>ç¬¦å·æ¯éæ³çã ä½ å¯ä»¥ä½¿ç¨ ${whatever gt 0}è¡¨è¾¾å¼æèåµå¥å¨ä¸ä¸ª CDATA é¨åçå¼ã\n\n<jsp:text><![CDATA[<br>]]></jsp:text>\n\n\nå¦æä½ éè¦å¨ XHTML ä¸­å£°æ DOCTYPE,å¿é¡»ä½¿ç¨å° <jsp:text> å¨ä½åç´ ï¼å®ä¾å¦ä¸ï¼\n\n<jsp:text><![CDATA[<!DOCTYPE html\nPUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"\n"DTD/xhtml1-strict.dtd">]]>\n</jsp:text>\n<head><title>jsp:text action</title></head>\n<body>\n\n<books><book><jsp:text>\n    Welcome to JSP Programming\n</jsp:text></book></books>\n\n</body>\n</html>\n\n\nä½ å¯ä»¥å¯¹ä»¥ä¸å®ä¾å°è¯ä½¿ç¨jsp:textåä¸ä½¿ç¨è¯¥å¨ä½åç´ æ§è¡ç»æçåºå«ã\n\n\n# JSP éå¼å¯¹è±¡\n\nJSP éå¼å¯¹è±¡æ¯ JSP å®¹å¨ä¸ºæ¯ä¸ªé¡µé¢æä¾ç Java å¯¹è±¡ï¼å¼åèå¯ä»¥ç´æ¥ä½¿ç¨å®ä»¬èä¸ç¨æ¾å¼å£°æãJSP éå¼å¯¹è±¡ä¹è¢«ç§°ä¸ºé¢å®ä¹åéã\n\nJSP ææ¯æçä¹å¤§éå¼å¯¹è±¡ï¼\n\nå¯¹è±¡            æè¿°\nrequest       HttpServletRequestç±»çå®ä¾\nresponse      HttpServletResponseç±»çå®ä¾\nout           PrintWriterç±»çå®ä¾ï¼ç¨äºæç»æè¾åºè³ç½é¡µä¸\nsession       HttpSessionç±»çå®ä¾\napplication   ServletContextç±»çå®ä¾ï¼ä¸åºç¨ä¸ä¸ææå³\nconfig        ServletConfigç±»çå®ä¾\npageContext   PageContextç±»çå®ä¾ï¼æä¾å¯¹ JSP é¡µé¢ææå¯¹è±¡ä»¥åå½åç©ºé´çè®¿é®\npage          ç±»ä¼¼äº Java ç±»ä¸­ç this å³é®å­\nException     Exceptionç±»çå¯¹è±¡ï¼ä»£è¡¨åçéè¯¯ç JSP é¡µé¢ä¸­å¯¹åºçå¼å¸¸å¯¹è±¡\n\n\n# request å¯¹è±¡\n\nrequestå¯¹è±¡æ¯javax.servlet.http.HttpServletRequest ç±»çå®ä¾ã\n\næ¯å½å®¢æ·ç«¯è¯·æ±ä¸ä¸ª JSP é¡µé¢æ¶ï¼JSP å¼æå°±ä¼å¶é ä¸ä¸ªæ°çrequestå¯¹è±¡æ¥ä»£è¡¨è¿ä¸ªè¯·æ±ã\n\nrequestå¯¹è±¡æä¾äºä¸ç³»åæ¹æ³æ¥è·å HTTP å¤´ä¿¡æ¯ï¼cookiesï¼HTTP æ¹æ³ç­ç­ã\n\n\n# response å¯¹è±¡\n\nresponseå¯¹è±¡æ¯javax.servlet.http.HttpServletResponseç±»çå®ä¾ã\n\nå½æå¡å¨åå»ºrequestå¯¹è±¡æ¶ä¼åæ¶åå»ºç¨äºååºè¿ä¸ªå®¢æ·ç«¯çresponseå¯¹è±¡ã\n\nresponseå¯¹è±¡ä¹å®ä¹äºå¤ç HTTP å¤´æ¨¡åçæ¥å£ãéè¿è¿ä¸ªå¯¹è±¡ï¼å¼åèä»¬å¯ä»¥æ·»å æ°ç cookiesï¼æ¶é´æ³ï¼HTTP ç¶æç ç­ç­ã\n\n\n# out å¯¹è±¡\n\noutå¯¹è±¡æ¯javax.servlet.jsp.JspWriterç±»çå®ä¾ï¼ç¨æ¥å¨responseå¯¹è±¡ä¸­åå¥åå®¹ã\n\næåçJspWriterç±»å¯¹è±¡æ ¹æ®é¡µé¢æ¯å¦æç¼å­æ¥è¿è¡ä¸åçå®ä¾åæä½ãå¯ä»¥å¨pageæä»¤ä¸­ä½¿ç¨buffered=\'false\'å±æ§æ¥è½»æ¾å³é­ç¼å­ã\n\nJspWriterç±»åå«äºå¤§é¨åjava.io.PrintWriterç±»ä¸­çæ¹æ³ãä¸è¿ï¼JspWriteræ°å¢äºä¸äºä¸ä¸ºå¤çç¼å­èè®¾è®¡çæ¹æ³ãè¿æå°±æ¯ï¼JspWriterç±»ä¼æåºIOExceptionså¼å¸¸ï¼èPrintWriterä¸ä¼ã\n\nä¸è¡¨ååºäºæä»¬å°ä¼ç¨æ¥è¾åºbooleanï¼charï¼intï¼doubleï¼Stringï¼objectç­ç±»åæ°æ®çéè¦æ¹æ³ï¼\n\næ¹æ³                         æè¿°\nout.print(dataType dt)     è¾åº Type ç±»åçå¼\nout.println(dataType dt)   è¾åº Type ç±»åçå¼ç¶åæ¢è¡\nout.flush()                å·æ°è¾åºæµ\n\n\n# session å¯¹è±¡\n\nsessionå¯¹è±¡æ¯javax.servlet.http.HttpSessionç±»çå®ä¾ãå Java Servlets ä¸­çsessionå¯¹è±¡æä¸æ ·çè¡ä¸ºã\n\nsessionå¯¹è±¡ç¨æ¥è·è¸ªå¨åä¸ªå®¢æ·ç«¯è¯·æ±é´çä¼è¯ã\n\n\n# application å¯¹è±¡\n\napplicationå¯¹è±¡ç´æ¥åè£äº servlet çServletContextç±»çå¯¹è±¡ï¼æ¯javax.servlet.ServletContextç±»çå®ä¾ã\n\nè¿ä¸ªå¯¹è±¡å¨ JSP é¡µé¢çæ´ä¸ªçå½å¨æä¸­é½ä»£è¡¨çè¿ä¸ª JSP é¡µé¢ãè¿ä¸ªå¯¹è±¡å¨ JSP é¡µé¢åå§åæ¶è¢«åå»ºï¼éçjspDestroy()æ¹æ³çè°ç¨èè¢«ç§»é¤ã\n\néè¿åapplicationä¸­æ·»å å±æ§ï¼åææç»ææ¨ web åºç¨ç JSP æä»¶é½è½è®¿é®å°è¿äºå±æ§ã\n\n\n# config å¯¹è±¡\n\nconfigå¯¹è±¡æ¯javax.servlet.ServletConfigç±»çå®ä¾ï¼ç´æ¥åè£äº servlet çServletConfigç±»çå¯¹è±¡ã\n\nè¿ä¸ªå¯¹è±¡åè®¸å¼åèè®¿é® Servlet æè JSP å¼æçåå§ååæ°ï¼æ¯å¦æä»¶è·¯å¾ç­ã\n\nä»¥ä¸æ¯ config å¯¹è±¡çä½¿ç¨æ¹æ³ï¼ä¸æ¯å¾éè¦ï¼æä»¥ä¸å¸¸ç¨ï¼\n\nconfig.getServletName();\n\n\nå®è¿ååå«å¨<servlet-name>åç´ ä¸­ç servlet åå­ï¼æ³¨æï¼<servlet-name>åç´ å¨WEB-INF\\web.xmlæä»¶ä¸­å®ä¹ã\n\n\n# pageContext å¯¹è±¡\n\npageContextå¯¹è±¡æ¯javax.servlet.jsp.PageContextç±»çå®ä¾ï¼ç¨æ¥ä»£è¡¨æ´ä¸ª JSP é¡µé¢ã\n\nè¿ä¸ªå¯¹è±¡ä¸»è¦ç¨æ¥è®¿é®é¡µé¢ä¿¡æ¯ï¼åæ¶è¿æ»¤æå¤§é¨åå®ç°ç»èã\n\nè¿ä¸ªå¯¹è±¡å­å¨äºrequestå¯¹è±¡åresponseå¯¹è±¡çå¼ç¨ãapplicationå¯¹è±¡ï¼configå¯¹è±¡ï¼sessionå¯¹è±¡ï¼outå¯¹è±¡å¯ä»¥éè¿è®¿é®è¿ä¸ªå¯¹è±¡çå±æ§æ¥å¯¼åºã\n\npageContextå¯¹è±¡ä¹åå«äºä¼ ç» JSP é¡µé¢çæä»¤ä¿¡æ¯ï¼åæ¬ç¼å­ä¿¡æ¯ï¼ErrorPage URL,é¡µé¢ scope ç­ã\n\nPageContextç±»å®ä¹äºä¸äºå­æ®µï¼åæ¬ PAGE_SCOPEï¼REQUEST_SCOPEï¼SESSION_SCOPEï¼ APPLICATION_SCOPEãå®ä¹æä¾äº 40 ä½ç§æ¹æ³ï¼æä¸åç»§æ¿èªjavax.servlet.jsp.JspContext ç±»ã\n\nå¶ä¸­ä¸ä¸ªéè¦çæ¹æ³å°±æ¯removeArribute()ï¼å®å¯æ¥åä¸ä¸ªæä¸¤ä¸ªåæ°ãæ¯å¦ï¼pageContext.removeArribute("attrName")ç§»é¤åä¸ª scope ä¸­ç¸å³å±æ§ï¼ä½æ¯ä¸é¢è¿ç§æ¹æ³åªç§»é¤ç¹å® scope ä¸­çç¸å³å±æ§ï¼\n\npageContext.removeAttribute("attrName", PAGE_SCOPE);\n\n\n\n# page å¯¹è±¡\n\nè¿ä¸ªå¯¹è±¡å°±æ¯é¡µé¢å®ä¾çå¼ç¨ãå®å¯ä»¥è¢«çåæ¯æ´ä¸ª JSP é¡µé¢çä»£è¡¨ã\n\npageå¯¹è±¡å°±æ¯thiså¯¹è±¡çåä¹è¯ã\n\n\n# exception å¯¹è±¡\n\nexceptionå¯¹è±¡åè£äºä»ååé¡µé¢ä¸­æåºçå¼å¸¸ä¿¡æ¯ãå®éå¸¸è¢«ç¨æ¥äº§çå¯¹åºéæ¡ä»¶çéå½ååºã\n\n\n# EL è¡¨è¾¾å¼\n\nEL è¡¨è¾¾å¼æ¯ç¨${}æ¬èµ·æ¥çèæ¬ï¼ç¨æ¥æ´æ¹ä¾¿å°è¯»åå¯¹è±¡ãEL è¡¨è¾¾å¼åå¨ JSP ç HTML ä»£ç ä¸­ï¼èä¸è½åå¨<%ä¸%>å¼èµ·ç JSP èæ¬ä¸­ã\n\nJSP è¡¨è¾¾å¼è¯­è¨ï¼ELï¼ä½¿å¾è®¿é®å­å¨å¨ JavaBean ä¸­çæ°æ®åå¾éå¸¸ç®åãJSP EL æ¢å¯ä»¥ç¨æ¥åå»ºç®æ¯è¡¨è¾¾å¼ä¹å¯ä»¥ç¨æ¥åå»ºé»è¾è¡¨è¾¾å¼ãå¨ JSP EL è¡¨è¾¾å¼åå¯ä»¥ä½¿ç¨æ´åæ°ï¼æµ®ç¹æ°ï¼å­ç¬¦ä¸²ï¼å¸¸é trueãfalseï¼è¿æ nullã\n\n\n# ä¸ä¸ªç®åçè¯­æ³\n\nå¸åçï¼å½æ¨éè¦å¨ JSP æ ç­¾ä¸­æå®ä¸ä¸ªå±æ§å¼æ¶ï¼åªéè¦ç®åå°ä½¿ç¨å­ç¬¦ä¸²å³å¯ï¼\n\n<jsp:setProperty name="box" property="perimeter" value="100" />\n\n\nJSP EL åè®¸æ¨æå®ä¸ä¸ªè¡¨è¾¾å¼æ¥è¡¨ç¤ºå±æ§å¼ãä¸ä¸ªç®åçè¡¨è¾¾å¼è¯­æ³å¦ä¸ï¼\n\n${expr}\n\n\nå¶ä¸­ï¼expr æçæ¯è¡¨è¾¾å¼ãå¨ JSP EL ä¸­éç¨çæä½ç¬¦æ¯"."å"[]"ãè¿ä¸¤ä¸ªæä½ç¬¦åè®¸æ¨éè¿ååµç JSP å¯¹è±¡è®¿é®åç§åæ ·ç JavaBean å±æ§ã\n\nä¸¾ä¾æ¥è¯´ï¼ä¸é¢ç <jsp:setProperty> æ ç­¾å¯ä»¥ä½¿ç¨è¡¨è¾¾å¼è¯­è¨æ¹åæå¦ä¸å½¢å¼ï¼\n\n<jsp:setProperty\n  name="box"\n  property="perimeter"\n  value="${2*box.width+2*box.height}"\n/>\n\n\nå½ JSP ç¼è¯å¨å¨å±æ§ä¸­è§å°"${}"æ ¼å¼åï¼å®ä¼äº§çä»£ç æ¥è®¡ç®è¿ä¸ªè¡¨è¾¾å¼ï¼å¹¶ä¸äº§çä¸ä¸ªæ¿ä»£åæ¥ä»£æ¿è¡¨è¾¾å¼çå¼ã\n\næ¨ä¹å¯ä»¥å¨æ ç­¾çæ¨¡æ¿ææ¬ä¸­ä½¿ç¨è¡¨è¾¾å¼è¯­è¨ãæ¯å¦ <jsp:text> æ ç­¾ç®åå°å°å¶ä¸»ä½ä¸­çææ¬æå¥å° JSP è¾åºä¸­ï¼\n\n<jsp:text>\n  <h1>Hello JSP!</h1>\n</jsp:text>\n\n\nç°å¨ï¼å¨jsp:textæ ç­¾ä¸»ä½ä¸­ä½¿ç¨è¡¨è¾¾å¼ï¼å°±åè¿æ ·ï¼\n\n<jsp:text>\n  Box Perimeter is: ${2*box.width + 2*box.height}\n</jsp:text>\n\n\nå¨ EL è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç¨åæ¬å·æ¥ç»ç»å­è¡¨è¾¾å¼ãæ¯å¦ ${(1 + 2) _ 3} ç­äº 9ï¼ä½æ¯ ${1 + (2 _ 3)} ç­äº 7ã\n\næ³è¦åç¨å¯¹ EL è¡¨è¾¾å¼çè¯ä¼°çè¯ï¼éè¦ä½¿ç¨ page æä»¤å° isELIgnored å±æ§å¼è®¾ä¸º trueï¼\n\n<%@ page isELIgnored ="true|false" %>\n\n\nè¿æ ·ï¼EL è¡¨è¾¾å¼å°±ä¼è¢«å¿½ç¥ãè¥è®¾ä¸º falseï¼åå®¹å¨å°ä¼è®¡ç® EL è¡¨è¾¾å¼ã\n\n\n# EL ä¸­çåºç¡æä½ç¬¦\n\nEL è¡¨è¾¾å¼æ¯æå¤§é¨å Java ææä¾çç®æ¯åé»è¾æä½ç¬¦ï¼\n\næä½ç¬¦         æè¿°\n.           è®¿é®ä¸ä¸ª Bean å±æ§æèä¸ä¸ªæ å°æ¡ç®\n[]          è®¿é®ä¸ä¸ªæ°ç»æèé¾è¡¨çåç´ \n( )         ç»ç»ä¸ä¸ªå­è¡¨è¾¾å¼ä»¥æ¹åä¼åçº§\n+           å \n-           åæè´\n*           ä¹\n/ or div    é¤\n% or mod    åæ¨¡\n== or eq    æµè¯æ¯å¦ç¸ç­\n!= or ne    æµè¯æ¯å¦ä¸ç­\n< or lt     æµè¯æ¯å¦å°äº\n> or gt     æµè¯æ¯å¦å¤§äº\n<= or le    æµè¯æ¯å¦å°äºç­äº\n>= or ge    æµè¯æ¯å¦å¤§äºç­äº\n&& or and   æµè¯é»è¾ä¸\n|| or or    æµè¯é»è¾æ\n! or not    æµè¯åå\nempty       æµè¯æ¯å¦ç©ºå¼\n\n\n# JSP EL ä¸­çå½æ°\n\nJSP EL åè®¸æ¨å¨è¡¨è¾¾å¼ä¸­ä½¿ç¨å½æ°ãè¿äºå½æ°å¿é¡»è¢«å®ä¹å¨èªå®ä¹æ ç­¾åºä¸­ãå½æ°çä½¿ç¨è¯­æ³å¦ä¸ï¼\n\n${ns:func(param1, param2, ...)}\n\n\nns æçæ¯å½åç©ºé´ï¼namespaceï¼ï¼func æçæ¯å½æ°çåç§°ï¼param1 æçæ¯ç¬¬ä¸ä¸ªåæ°ï¼param2 æçæ¯ç¬¬äºä¸ªåæ°ï¼ä»¥æ­¤ç±»æ¨ãæ¯å¦ï¼æå½æ° fn:lengthï¼å¨ JSTL åºä¸­å®ä¹ï¼å¯ä»¥åä¸é¢è¿æ ·æ¥è·åä¸ä¸ªå­ç¬¦ä¸²çé¿åº¦ï¼\n\n${fn:length("Get my length")}\n\n\nè¦ä½¿ç¨ä»»ä½æ ç­¾åºä¸­çå½æ°ï¼æ¨éè¦å°è¿äºåºå®è£å¨æå¡å¨ä¸­ï¼ç¶åä½¿ç¨ <taglib> æ ç­¾å¨ JSP æä»¶ä¸­åå«è¿äºåºã\n\n\n# JSP EL éå«å¯¹è±¡\n\nJSP EL æ¯æä¸è¡¨ååºçéå«å¯¹è±¡ï¼\n\néå«å¯¹è±¡               æè¿°\npageScope          page ä½ç¨å\nrequestScope       request ä½ç¨å\nsessionScope       session ä½ç¨å\napplicationScope   application ä½ç¨å\nparam              Request å¯¹è±¡çåæ°ï¼å­ç¬¦ä¸²\nparamValues        Request å¯¹è±¡çåæ°ï¼å­ç¬¦ä¸²éå\nheader             HTTP ä¿¡æ¯å¤´ï¼å­ç¬¦ä¸²\nheaderValues       HTTP ä¿¡æ¯å¤´ï¼å­ç¬¦ä¸²éå\ninitParam          ä¸ä¸æåå§ååæ°\ncookie             Cookie å¼\npageContext        å½åé¡µé¢ç pageContext\n\næ¨å¯ä»¥å¨è¡¨è¾¾å¼ä¸­ä½¿ç¨è¿äºå¯¹è±¡ï¼å°±åä½¿ç¨åéä¸æ ·ãæ¥ä¸æ¥ä¼ç»åºå ä¸ªä¾å­æ¥æ´å¥½ççè§£è¿ä¸ªæ¦å¿µã\n\n\n# pageContext å¯¹è±¡\n\npageContext å¯¹è±¡æ¯ JSP ä¸­ pageContext å¯¹è±¡çå¼ç¨ãéè¿ pageContext å¯¹è±¡ï¼æ¨å¯ä»¥è®¿é® request å¯¹è±¡ãæ¯å¦ï¼è®¿é® request å¯¹è±¡ä¼ å¥çæ¥è¯¢å­ç¬¦ä¸²ï¼å°±åè¿æ ·ï¼\n\n${pageContext.request.queryString}\n\n\n\n# Scope å¯¹è±¡\n\npageScopeï¼requestScopeï¼sessionScopeï¼applicationScope åéç¨æ¥è®¿é®å­å¨å¨åä¸ªä½ç¨åå±æ¬¡çåéã\n\nä¸¾ä¾æ¥è¯´ï¼å¦ææ¨éè¦æ¾å¼è®¿é®å¨ applicationScope å±ç box åéï¼å¯ä»¥è¿æ ·æ¥è®¿é®ï¼applicationScope.boxã\n\n\n# param å paramValues å¯¹è±¡\n\nparam å paramValues å¯¹è±¡ç¨æ¥è®¿é®åæ°å¼ï¼éè¿ä½¿ç¨ request.getParameter æ¹æ³å request.getParameterValues æ¹æ³ã\n\nä¸¾ä¾æ¥è¯´ï¼è®¿é®ä¸ä¸ªåä¸º order çåæ°ï¼å¯ä»¥è¿æ ·ä½¿ç¨è¡¨è¾¾å¼ï¼${param.order}ï¼æè${param["order"]}ã\n\næ¥ä¸æ¥çä¾å­è¡¨æäºå¦ä½è®¿é® request ä¸­ç username åæ°ï¼\n\n<%@ page import="java.io.*,java.util.*" %> <% String title = "Accessing Request\nParam"; %>\n<html>\n  <head>\n    <title><% out.print(title); %></title>\n  </head>\n  <body>\n    <center>\n      <h1><% out.print(title); %></h1>\n    </center>\n    <div align="center">\n      <p>${param["username"]}</p>\n    </div>\n  </body>\n</html>\n\n\nparam å¯¹è±¡è¿ååä¸çå­ç¬¦ä¸²ï¼è paramValues å¯¹è±¡åè¿åä¸ä¸ªå­ç¬¦ä¸²æ°ç»ã\n\n\n# header å headerValues å¯¹è±¡\n\nheader å headerValues å¯¹è±¡ç¨æ¥è®¿é®ä¿¡æ¯å¤´ï¼éè¿ä½¿ç¨ request.getHeader æ¹æ³å request.getHeaders æ¹æ³ã\n\nä¸¾ä¾æ¥è¯´ï¼è¦è®¿é®ä¸ä¸ªåä¸º user-agent çä¿¡æ¯å¤´ï¼å¯ä»¥è¿æ ·ä½¿ç¨è¡¨è¾¾å¼ï¼${header.user-agent}ï¼æè ${header["user-agent"]}ã\n\næ¥ä¸æ¥çä¾å­è¡¨æäºå¦ä½è®¿é® user-agent ä¿¡æ¯å¤´ï¼\n\n<%@ page import="java.io.*,java.util.*" %> <% String title = "User Agent\nExample"; %>\n<html>\n  <head>\n    <title><% out.print(title); %></title>\n  </head>\n  <body>\n    <center>\n      <h1><% out.print(title); %></h1>\n    </center>\n    <div align="center">\n      <p>${header["user-agent"]}</p>\n    </div>\n  </body>\n</html>\n\n\nè¿è¡ç»æå¦ä¸ï¼\n\n\n\nheader å¯¹è±¡è¿ååä¸å¼ï¼è headerValues åè¿åä¸ä¸ªå­ç¬¦ä¸²æ°ç»ã\n\n\n# JSTL\n\nJSP æ åæ ç­¾åºï¼JSTLï¼æ¯ä¸ä¸ª JSP æ ç­¾éåï¼å®å°è£äº JSP åºç¨çéç¨æ ¸å¿åè½ã\n\nJSTL æ¯æéç¨çãç»æåçä»»å¡ï¼æ¯å¦è¿­ä»£ï¼æ¡ä»¶å¤æ­ï¼XML ææ¡£æä½ï¼å½éåæ ç­¾ï¼SQL æ ç­¾ã é¤äºè¿äºï¼å®è¿æä¾äºä¸ä¸ªæ¡æ¶æ¥ä½¿ç¨éæ JSTL çèªå®ä¹æ ç­¾ã\n\næ ¹æ® JSTL æ ç­¾ææä¾çåè½ï¼å¯ä»¥å°å¶åä¸º 5 ä¸ªç±»å«ã\n\n * æ ¸å¿æ ç­¾\n * æ ¼å¼åæ ç­¾\n * SQL æ ç­¾\n * XML æ ç­¾\n * JSTL å½æ°\n\n\n# JSTL åºå®è£\n\nApache Tomcat å®è£ JSTL åºæ­¥éª¤å¦ä¸ï¼\n\nä» Apache çæ åæ ç­¾åºä¸­ä¸è½½çäºè¿å(jakarta-taglibs-standard-current.zip)ã\n\n * å®æ¹ä¸è½½å°åï¼http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/\n * æ¬ç«ä¸è½½å°åï¼jakarta-taglibs-standard-1.1.2.zip\n\nä¸è½½ jakarta-taglibs-standard-1.1.2.zip åå¹¶è§£åï¼å° jakarta-taglibs-standard-1.1.2/lib/ ä¸çä¸¤ä¸ª jar æä»¶ï¼standard.jar å jstl.jar æä»¶æ·è´å° /WEB-INF/lib/ ä¸ã\n\nå° tld ä¸çéè¦å¼å¥ç tld æä»¶å¤å¶å° WEB-INF ç®å½ä¸ã\n\næ¥ä¸æ¥æä»¬å¨ web.xml æä»¶ä¸­æ·»å ä»¥ä¸éç½®ï¼\n\n<?xml version="1.0" encoding="UTF-8"?>\n<web-app\n  version="2.4"\n  xmlns="http://java.sun.com/xml/ns/j2ee"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee\n        http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"\n>\n  <jsp-config>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/fmt</taglib-uri>\n      <taglib-location>/WEB-INF/fmt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/fmt-rt</taglib-uri>\n      <taglib-location>/WEB-INF/fmt-rt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/core</taglib-uri>\n      <taglib-location>/WEB-INF/c.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/core-rt</taglib-uri>\n      <taglib-location>/WEB-INF/c-rt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/sql</taglib-uri>\n      <taglib-location>/WEB-INF/sql.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/sql-rt</taglib-uri>\n      <taglib-location>/WEB-INF/sql-rt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/x</taglib-uri>\n      <taglib-location>/WEB-INF/x.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/x-rt</taglib-uri>\n      <taglib-location>/WEB-INF/x-rt.tld</taglib-location>\n    </taglib>\n  </jsp-config>\n</web-app>\n\n\nä½¿ç¨ä»»ä½åºï¼ä½ å¿é¡»å¨æ¯ä¸ª JSP æä»¶ä¸­çå¤´é¨åå« æ ç­¾ã\n\n\n# æ ¸å¿æ ç­¾\n\næ ¸å¿æ ç­¾æ¯æå¸¸ç¨ç JSTL æ ç­¾ãå¼ç¨æ ¸å¿æ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>\n\n\næ ç­¾              æè¿°\n<c:out>         ç¨äºå¨ JSP ä¸­æ¾ç¤ºæ°æ®ï¼å°±å<%= ... >\n<c:set>         ç¨äºä¿å­æ°æ®\n<c:remove>      ç¨äºå é¤æ°æ®\n<c:catch>       ç¨æ¥å¤çäº§çéè¯¯çå¼å¸¸ç¶åµï¼å¹¶ä¸å°éè¯¯ä¿¡æ¯å¨å­èµ·æ¥\n<c:if>          ä¸æä»¬å¨ä¸è¬ç¨åºä¸­ç¨ç if ä¸æ ·\n<c:choose>      æ¬èº«åªå½å<c:when>å<c:otherwise>çç¶æ ç­¾\n<c:when>        <c:choose>çå­æ ç­¾ï¼ç¨æ¥å¤æ­æ¡ä»¶æ¯å¦æç«\n<c:otherwise>   <c:choose>çå­æ ç­¾ï¼æ¥å¨<c:when>æ ç­¾åï¼å½<c:when>æ ç­¾å¤æ­ä¸º false æ¶è¢«æ§è¡\n<c:import>      æ£ç´¢ä¸ä¸ªç»å¯¹æç¸å¯¹ URLï¼ç¶åå°å¶åå®¹æ´é²ç»é¡µé¢\n<c:forEach>     åºç¡è¿­ä»£æ ç­¾ï¼æ¥åå¤ç§éåç±»å\n<c:forTokens>   æ ¹æ®æå®çåéç¬¦æ¥åéåå®¹å¹¶è¿­ä»£è¾åº\n<c:param>       ç¨æ¥ç»åå«æéå®åçé¡µé¢ä¼ éåæ°\n<c:redirect>    éå®åè³ä¸ä¸ªæ°ç URL.\n<c:url>         ä½¿ç¨å¯éçæ¥è¯¢åæ°æ¥åé ä¸ä¸ª URL\n\n\n# æ ¼å¼åæ ç­¾\n\nJSTL æ ¼å¼åæ ç­¾ç¨æ¥æ ¼å¼åå¹¶è¾åºææ¬ãæ¥æãæ¶é´ãæ°å­ãå¼ç¨æ ¼å¼åæ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>\n\n\næ ç­¾                      æè¿°\n<fmt:formatNumber>      ä½¿ç¨æå®çæ ¼å¼æç²¾åº¦æ ¼å¼åæ°å­\n<fmt:parseNumber>       è§£æä¸ä¸ªä»£è¡¨çæ°å­ï¼è´§å¸æç¾åæ¯çå­ç¬¦ä¸²\n<fmt:formatDate>        ä½¿ç¨æå®çé£æ ¼ææ¨¡å¼æ ¼å¼åæ¥æåæ¶é´\n<fmt:parseDate>         è§£æä¸ä¸ªä»£è¡¨çæ¥æææ¶é´çå­ç¬¦ä¸²\n<fmt:bundle>            ç»å®èµæº\n<fmt:setLocale>         æå®å°åº\n<fmt:setBundle>         ç»å®èµæº\n<fmt:timeZone>          æå®æ¶åº\n<fmt:setTimeZone>       æå®æ¶åº\n<fmt:message>           æ¾ç¤ºèµæºéç½®æä»¶ä¿¡æ¯\n<fmt:requestEncoding>   è®¾ç½® request çå­ç¬¦ç¼ç \n\n\n# SQL æ ç­¾\n\nJSTL SQL æ ç­¾åºæä¾äºä¸å³ç³»åæ°æ®åºï¼Oracleï¼MySQLï¼SQL Server ç­ç­ï¼è¿è¡äº¤äºçæ ç­¾ãå¼ç¨ SQL æ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql" %>\n\n\næ ç­¾                    æè¿°\n<sql:setDataSource>   æå®æ°æ®æº\n<sql:query>           è¿è¡ SQL æ¥è¯¢è¯­å¥\n<sql:update>          è¿è¡ SQL æ´æ°è¯­å¥\n<sql:param>           å° SQL è¯­å¥ä¸­çåæ°è®¾ä¸ºæå®å¼\n<sql:dateParam>       å° SQL è¯­å¥ä¸­çæ¥æåæ°è®¾ä¸ºæå®ç java.util.Date å¯¹è±¡å¼\n<sql:transaction>     å¨å±äº«æ°æ®åºè¿æ¥ä¸­æä¾åµå¥çæ°æ®åºè¡ä¸ºåç´ ï¼å°ææè¯­å¥ä»¥ä¸ä¸ªäºå¡çå½¢å¼æ¥è¿è¡\n\n\n# XML æ ç­¾\n\nJSTL XML æ ç­¾åºæä¾äºåå»ºåæä½ XML ææ¡£çæ ç­¾ãå¼ç¨ XML æ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="x" uri="http://java.sun.com/jsp/jstl/xml" %>\n\n\nå¨ä½¿ç¨ xml æ ç­¾åï¼ä½ å¿é¡»å° XML å XPath çç¸å³åæ·è´è³ä½ ç <Tomcat å®è£ç®å½>\\lib ä¸:\n\n * XercesImpl.jar\n   \n   ä¸è½½å°åï¼ http://www.apache.org/dist/xerces/j/\n\n * xalan.jar\n   \n   ä¸è½½å°åï¼ http://xml.apache.org/xalan-j/index.html\n\næ ç­¾              æè¿°\n<x:out>         ä¸<%= ... >,ç±»ä¼¼ï¼ä¸è¿åªç¨äº XPath è¡¨è¾¾å¼\n<x:parse>       è§£æ XML æ°æ®\n<x:set>         è®¾ç½® XPath è¡¨è¾¾å¼\n<x:if>          å¤æ­ XPath è¡¨è¾¾å¼ï¼è¥ä¸ºçï¼åæ§è¡æ¬ä½ä¸­çåå®¹ï¼å¦åè·³è¿æ¬ä½\n<x:forEach>     è¿­ä»£ XML ææ¡£ä¸­çèç¹\n<x:choose>      <x:when>å<x:otherwise>çç¶æ ç­¾\n<x:when>        <x:choose>çå­æ ç­¾ï¼ç¨æ¥è¿è¡æ¡ä»¶å¤æ­\n<x:otherwise>   <x:choose>çå­æ ç­¾ï¼å½<x:when>å¤æ­ä¸º false æ¶è¢«æ§è¡\n<x:transform>   å° XSL è½¬æ¢åºç¨å¨ XML ææ¡£ä¸­\n<x:param>       ä¸<x:transform>å±åä½¿ç¨ï¼ç¨äºè®¾ç½® XSL æ ·å¼è¡¨\n\n\n# JSTL å½æ°\n\nJSTL åå«ä¸ç³»åæ åå½æ°ï¼å¤§é¨åæ¯éç¨çå­ç¬¦ä¸²å¤çå½æ°ãå¼ç¨ JSTL å½æ°åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>\n\n\nå½æ°                        æè¿°\nfn:contains()             æµè¯è¾å¥çå­ç¬¦ä¸²æ¯å¦åå«æå®çå­ä¸²\nfn:containsIgnoreCase()   æµè¯è¾å¥çå­ç¬¦ä¸²æ¯å¦åå«æå®çå­ä¸²ï¼å¤§å°åä¸ææ\nfn:endsWith()             æµè¯è¾å¥çå­ç¬¦ä¸²æ¯å¦ä»¥æå®çåç¼ç»å°¾\nfn:escapeXml()            è·³è¿å¯ä»¥ä½ä¸º XML æ è®°çå­ç¬¦\nfn:indexOf()              è¿åæå®å­ç¬¦ä¸²å¨è¾å¥å­ç¬¦ä¸²ä¸­åºç°çä½ç½®\nfn:join()                 å°æ°ç»ä¸­çåç´ åæä¸ä¸ªå­ç¬¦ä¸²ç¶åè¾åº\nfn:length()               è¿åå­ç¬¦ä¸²é¿åº¦\nfn:replace()              å°è¾å¥å­ç¬¦ä¸²ä¸­æå®çä½ç½®æ¿æ¢ä¸ºæå®çå­ç¬¦ä¸²ç¶åè¿å\nfn:split()                å°å­ç¬¦ä¸²ç¨æå®çåéç¬¦åéç¶åç»æä¸ä¸ªå­å­ç¬¦ä¸²æ°ç»å¹¶è¿å\nfn:startsWith()           æµè¯è¾å¥å­ç¬¦ä¸²æ¯å¦ä»¥æå®çåç¼å¼å§\nfn:substring()            è¿åå­ç¬¦ä¸²çå­é\nfn:substringAfter()       è¿åå­ç¬¦ä¸²å¨æå®å­ä¸²ä¹åçå­é\nfn:substringBefore()      è¿åå­ç¬¦ä¸²å¨æå®å­ä¸²ä¹åçå­é\nfn:toLowerCase()          å°å­ç¬¦ä¸²ä¸­çå­ç¬¦è½¬ä¸ºå°å\nfn:toUpperCase()          å°å­ç¬¦ä¸²ä¸­çå­ç¬¦è½¬ä¸ºå¤§å\nfn:trim()                 ç§»é¤é¦å°¾çç©ºç½ç¬¦\n\n\n# Taglib\n\n\n# JSP èªå®ä¹æ ç­¾\n\nèªå®ä¹æ ç­¾æ¯ç¨æ·å®ä¹ç JSP è¯­è¨åç´ ãå½ JSP é¡µé¢åå«ä¸ä¸ªèªå®ä¹æ ç­¾æ¶å°è¢«è½¬åä¸º servletï¼æ ç­¾è½¬åä¸ºå¯¹è¢« ç§°ä¸º tag handler çå¯¹è±¡çæä½ï¼å³å½ servlet æ§è¡æ¶ Web container è°ç¨é£äºæä½ã\n\nJSP æ ç­¾æ©å±å¯ä»¥è®©ä½ åå»ºæ°çæ ç­¾å¹¶ä¸å¯ä»¥ç´æ¥æå¥å°ä¸ä¸ª JSP é¡µé¢ã JSP 2.0 è§èä¸­å¼å¥ Simple Tag Handlers æ¥ç¼åè¿äºèªå®ä¹æ è®°ã\n\nä½ å¯ä»¥ç»§æ¿ SimpleTagSupport ç±»å¹¶éåç doTag()æ¹æ³æ¥å¼åä¸ä¸ªæç®åçèªå®ä¹æ ç­¾ã\n\n\n# åå»º"Hello"æ ç­¾\n\næ¥ä¸æ¥ï¼æä»¬æ³åå»ºä¸ä¸ªèªå®ä¹æ ç­¾å«ä½ex:Helloï¼æ ç­¾æ ¼å¼ä¸ºï¼\n\n<ex:Hello />\n\n\nè¦åå»ºèªå®ä¹ç JSP æ ç­¾ï¼ä½ é¦åå¿é¡»åå»ºå¤çæ ç­¾ç Java ç±»ãæä»¥ï¼è®©æä»¬åå»ºä¸ä¸ª HelloTag ç±»ï¼å¦ä¸æç¤ºï¼\n\npackage com.runoob; import javax.servlet.jsp.tagext.*; import\njavax.servlet.jsp.*; import java.io.*; public class HelloTag extends\nSimpleTagSupport { public void doTag() throws JspException, IOException {\nJspWriter out = getJspContext().getOut(); out.println("Hello Custom Tag!"); } }\n\n\nä»¥ä¸ä»£ç éåäº doTag()æ¹æ³ï¼æ¹æ³ä¸­ä½¿ç¨äº getJspContext()æ¹æ³æ¥è·åå½åç JspContext å¯¹è±¡ï¼å¹¶å°"Hello Custom Tag!"ä¼ éç» JspWriter å¯¹è±¡ã\n\nç¼è¯ä»¥ä¸ç±»ï¼å¹¶å°å¶å¤å¶å°ç¯å¢åé CLASSPATH ç®å½ä¸­ãæååå»ºå¦ä¸æ ç­¾åºï¼<Tomcatå®è£ç®å½>webapps\\ROOT\\WEB-INF\\custom.tldã\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <jsp-version>2.0</jsp-version>\n  <short-name>Example TLD</short-name>\n  <tag>\n    <name>Hello</name>\n    <tag-class>com.runoob.HelloTag</tag-class>\n    <body-content>empty</body-content>\n  </tag>\n</taglib>\n\n\næ¥ä¸æ¥ï¼æä»¬å°±å¯ä»¥å¨ JSP æä»¶ä¸­ä½¿ç¨ Hello æ ç­¾ï¼\n\n<%@ taglib prefix="ex" uri="WEB-INF/custom.tld"%>\n<html>\n  <head>\n    <title>A sample custom tag</title>\n  </head>\n  <body>\n    <ex:Hello />\n  </body>\n</html>\n\n\nä»¥ä¸ç¨åºè¾åºç»æä¸ºï¼\n\nHello Custom Tag!\n\n\n\n# è®¿é®æ ç­¾ä½\n\nä½ å¯ä»¥åæ åæ ç­¾åºä¸æ ·å¨æ ç­¾ä¸­åå«æ¶æ¯åå®¹ãå¦æä»¬è¦å¨æä»¬èªå®ä¹ç Hello ä¸­åå«åå®¹ï¼æ ¼å¼å¦ä¸ï¼\n\n<ex:Hello>\n  This is message body\n</ex:Hello>\n\n\næä»¬å¯ä»¥ä¿®æ¹æ ç­¾å¤çç±»æä»¶ï¼ä»£ç å¦ä¸ï¼\n\npackage com.runoob;\n\nimport javax.servlet.jsp.tagext.*;\nimport javax.servlet.jsp.*;\nimport java.io.*;\n\npublic class HelloTag extends SimpleTagSupport {\n\n   StringWriter sw = new StringWriter();\n   public void doTag()\n      throws JspException, IOException\n    {\n       getJspBody().invoke(sw);\n       getJspContext().getOut().println(sw.toString());\n    }\n\n}\n\n\næ¥ä¸æ¥æä»¬éè¦ä¿®æ¹ TLD æä»¶ï¼å¦ä¸æç¤ºï¼\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <jsp-version>2.0</jsp-version>\n  <short-name>Example TLD with Body</short-name>\n  <tag>\n    <name>Hello</name>\n    <tag-class>com.runoob.HelloTag</tag-class>\n    <body-content>scriptless</body-content>\n  </tag>\n</taglib>\n\n\nç°å¨æä»¬å¯ä»¥å¨ JSP ä½¿ç¨ä¿®æ¹åçæ ç­¾ï¼å¦ä¸æç¤º:\n\n<%@ taglib prefix="ex" uri="WEB-INF/custom.tld"%>\n<html>\n  <head>\n    <title>A sample custom tag</title>\n  </head>\n  <body>\n    <ex:Hello>\n      This is message body\n    </ex:Hello>\n  </body>\n</html>\n\n\nä»¥ä¸ç¨åºè¾åºç»æå¦ä¸æç¤ºï¼\n\nThis is message body\n\n\n\n# èªå®ä¹æ ç­¾å±æ§\n\nä½ å¯ä»¥å¨èªå®ä¹æ åä¸­è®¾ç½®åç§å±æ§ï¼è¦æ¥æ¶å±æ§ï¼å¼èªå®ä¹æ ç­¾ç±»å¿é¡»å®ç° setter æ¹æ³ï¼ JavaBean ä¸­ç setter æ¹æ³å¦ä¸æç¤ºï¼\n\npackage com.runoob;\n\nimport javax.servlet.jsp.tagext.*;\nimport javax.servlet.jsp.*;\nimport java.io.*;\n\npublic class HelloTag extends SimpleTagSupport {\n\n   private String message;\n\n   public void setMessage(String msg) {\n      this.message = msg;\n   }\n\n   StringWriter sw = new StringWriter();\n\n   public void doTag()\n      throws JspException, IOException\n    {\n       if (message != null) {\n          /* ä»å±æ§ä¸­ä½¿ç¨æ¶æ¯ */\n          JspWriter out = getJspContext().getOut();\n          out.println( message );\n       }\n       else {\n          /* ä»åå®¹ä½ä¸­ä½¿ç¨æ¶æ¯ */\n          getJspBody().invoke(sw);\n          getJspContext().getOut().println(sw.toString());\n       }\n   }\n\n}\n\n\nå±æ§çåç§°æ¯"message"ï¼æä»¥ setter æ¹æ³æ¯ç setMessage()ãç°å¨è®©æä»¬å¨ TLD æä»¶ä¸­ä½¿ç¨çåç´ æ·»å æ­¤å±æ§ï¼\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <jsp-version>2.0</jsp-version>\n  <short-name>Example TLD with Body</short-name>\n  <tag>\n    <name>Hello</name>\n    <tag-class>com.runoob.HelloTag</tag-class>\n    <body-content>scriptless</body-content>\n    <attribute>\n      <name>message</name>\n    </attribute>\n  </tag>\n</taglib>\n\n\nç°å¨æä»¬å°±å¯ä»¥å¨ JSP æä»¶ä¸­ä½¿ç¨ message å±æ§äºï¼å¦ä¸æç¤ºï¼\n\n<%@ taglib prefix="ex" uri="WEB-INF/custom.tld"%>\n<html>\n  <head>\n    <title>A sample custom tag</title>\n  </head>\n  <body>\n    <ex:Hello message="This is custom tag" />\n  </body>\n</html>\n\n\nä»¥ä¸å®ä¾æ°æ®è¾åºç»æä¸ºï¼\n\nThis is custom tag\n\n\nä½ è¿å¯ä»¥åå«ä»¥ä¸å±æ§ï¼\n\nå±æ§            æè¿°\nname          å®ä¹å±æ§çåç§°ãæ¯ä¸ªæ ç­¾çæ¯å±æ§åç§°å¿é¡»æ¯å¯ä¸çã\nrequired      æå®å±æ§æ¯å¦æ¯å¿é¡»çæèå¯éç,å¦æè®¾ç½®ä¸º false ä¸ºå¯éã\nrtexprvalue   å£°æå¨è¿è¡è¡¨è¾¾å¼æ¶ï¼æ ç­¾å±æ§æ¯å¦ææã\ntype          å®ä¹è¯¥å±æ§ç Java ç±»ç±»å ãé»è®¤æå®ä¸º String\ndescription   æè¿°ä¿¡æ¯\nfragment      å¦æå£°æäºè¯¥å±æ§,å±æ§å¼å°è¢«è§ä¸ºä¸ä¸ª JspFragmentã\n\nä»¥ä¸æ¯æå®ç¸å³çå±æ§å®ä¾ï¼\n\n.....\n<attribute>\n  <name>attribute_name</name>\n  <required>false</required>\n  <type>java.util.Date</type>\n  <fragment>false</fragment>\n</attribute>\n.....\n\n\nå¦æä½ ä½¿ç¨äºä¸¤ä¸ªå±æ§ï¼ä¿®æ¹ TLD æä»¶ï¼å¦ä¸æç¤ºï¼\n\n.....\n<attribute>\n  <name>attribute_name1</name>\n  <required>false</required>\n  <type>java.util.Boolean</type>\n  <fragment>false</fragment>\n</attribute>\n<attribute>\n  <name>attribute_name2</name>\n  <required>true</required>\n  <type>java.util.Date</type>\n</attribute>\n.....\n',normalizedContent:'# javaweb ä¹ jsp æå\n\n\n# ç®ä»\n\n\n# ä»ä¹æ¯ java server pages\n\njspå¨ç§°java server pagesï¼æ¯ä¸ç§å¨æç½é¡µå¼åææ¯ã\n\nå®ä½¿ç¨ jsp æ ç­¾å¨ html ç½é¡µä¸­æå¥ java ä»£ç ãæ ç­¾éå¸¸ä»¥<%å¼å¤´ä»¥%>ç»æã\n\njsp æ¯ä¸ç§ java servletï¼ä¸»è¦ç¨äºå®ç° java web åºç¨ç¨åºçç¨æ·çé¢é¨åãç½é¡µå¼åèä»¬éè¿ç»å html ä»£ç ãxhtml ä»£ç ãxml åç´ ä»¥ååµå¥ jsp æä½åå½ä»¤æ¥ç¼å jspã\n\njsp éè¿ç½é¡µè¡¨åè·åç¨æ·è¾å¥æ°æ®ãè®¿é®æ°æ®åºåå¶ä»æ°æ®æºï¼ç¶åå¨æå°åå»ºç½é¡µã\n\njsp æ ç­¾æå¤ç§åè½ï¼æ¯å¦è®¿é®æ°æ®åºãè®°å½ç¨æ·éæ©ä¿¡æ¯ãè®¿é® javabeans ç»ä»¶ç­ï¼è¿å¯ä»¥å¨ä¸åçç½é¡µä¸­ä¼ éæ§å¶ä¿¡æ¯åå±äº«ä¿¡æ¯ã\n\n\n# ä¸ºä»ä¹ä½¿ç¨ jsp\n\njsp ä¹æ¯ä¸ç§ servletï¼å æ­¤ jsp è½å¤å®æ servlet è½å®æçä»»ä½å·¥ä½ã\n\njsp ç¨åºä¸ cgi ç¨åºæçç¸ä¼¼çåè½ï¼ä½å cgi ç¨åºç¸æ¯ï¼jsp ç¨åºæå¦ä¸ä¼å¿ï¼\n\n * æ§è½æ´å ä¼è¶ï¼å ä¸º jsp å¯ä»¥ç´æ¥å¨ html ç½é¡µä¸­å¨æåµå¥åç´ èä¸éè¦åç¬å¼ç¨ cgi æä»¶ã\n * æå¡å¨è°ç¨çæ¯å·²ç»ç¼è¯å¥½ç jsp æä»¶ï¼èä¸å cgi/perl é£æ ·å¿é¡»åè½½å¥è§£éå¨åç®æ èæ¬ã\n * jsp åºäº java servlets apiï¼å æ­¤ï¼jsp æ¥æåç§å¼ºå¤§çä¼ä¸çº§ java apiï¼åæ¬ jdbcï¼jndiï¼ejbï¼jaxp ç­ç­ã\n * jsp é¡µé¢å¯ä»¥ä¸å¤çä¸å¡é»è¾ç servlets ä¸èµ·ä½¿ç¨ï¼è¿ç§æ¨¡å¼è¢« java servlet æ¨¡æ¿å¼æææ¯æã\n\næåï¼jsp æ¯ java ee ä¸å¯æç¼ºçä¸é¨åï¼æ¯ä¸ä¸ªå®æ´çä¼ä¸çº§åºç¨å¹³å°ãè¿æå³ç jsp å¯ä»¥ç¨æç®åçæ¹å¼æ¥å®ç°æå¤æçåºç¨ã\n\n\n# jsp çä¼å¿\n\nä»¥ä¸ååºäºä½¿ç¨ jsp å¸¦æ¥çå¶ä»å¥½å¤ï¼\n\n * ä¸ asp ç¸æ¯ï¼jsp æä¸¤å¤§ä¼å¿ãé¦åï¼å¨æé¨åç¨ java ç¼åï¼èä¸æ¯ vb æå¶ä» ms ä¸ç¨è¯­è¨ï¼æä»¥æ´å å¼ºå¤§ä¸æç¨ãç¬¬äºç¹å°±æ¯ jsp æäºç§»æ¤å°é ms å¹³å°ä¸ã\n * ä¸çº¯ servlets ç¸æ¯ï¼jsp å¯ä»¥å¾æ¹ä¾¿çç¼åæèä¿®æ¹ html ç½é¡µèä¸ç¨å»é¢å¯¹å¤§éç println è¯­å¥ã\n * ä¸ ssi ç¸æ¯ï¼ssi æ æ³ä½¿ç¨è¡¨åæ°æ®ãæ æ³è¿è¡æ°æ®åºé¾æ¥ã\n * ä¸ javascript ç¸æ¯ï¼è½ç¶ javascript å¯ä»¥å¨å®¢æ·ç«¯å¨æçæ htmlï¼ä½æ¯å¾é¾ä¸æå¡å¨äº¤äºï¼å æ­¤ä¸è½æä¾å¤æçæå¡ï¼æ¯å¦è®¿é®æ°æ®åºåå¾åå¤çç­ç­ã\n * ä¸éæ html ç¸æ¯ï¼éæ html ä¸åå«å¨æä¿¡æ¯ã\n\n\n# jsp å·¥ä½åç\n\njsp æ¯ä¸ç§ servletï¼ä½å·¥ä½æ¹å¼å servlet ææå·®å«ã\n\nservlet æ¯åå°æºä»£ç ç¼è¯ä¸º class æä»¶åé¨ç½²å°æå¡å¨ä¸çï¼åç¼è¯åé¨ç½²ã\n\njsp æ¯åå°æºä»£ç é¨ç½²å°æå¡å¨åç¼è¯ï¼åé¨ç½²åç¼è¯ã\n\njsp ä¼å¨å®¢æ·ç«¯ç¬¬ä¸æ¬¡è¯·æ± jsp æä»¶æ¶è¢«ç¼è¯ä¸º httpjsppage ç±»ï¼servlet çä¸ä¸ªå­ç±»ï¼ãè¯¥ç±»ä¼è¢«æå¡å¨ä¸´æ¶å­æ¾å¨æå¡å¨å·¥ä½ç®å½éãæä»¥ï¼ç¬¬ä¸æ¬¡è¯·æ± jsp åï¼è®¿é®éåº¦ä¼åå¿«å°±æ¯è¿ä¸ªéçã\n\n\n# jsp å·¥ä½æµç¨\n\nç½ç»æå¡å¨éè¦ä¸ä¸ª jsp å¼æï¼ä¹å°±æ¯ä¸ä¸ªå®¹å¨æ¥å¤ç jsp é¡µé¢ãå®¹å¨è´è´£æªè·å¯¹ jsp é¡µé¢çè¯·æ±ãæ¬æç¨ä½¿ç¨ååµ jsp å®¹å¨ç apache æ¥æ¯æ jsp å¼åã\n\njsp å®¹å¨ä¸ web æå¡å¨åååä½ï¼ä¸º jsp çæ­£å¸¸è¿è¡æä¾å¿è¦çè¿è¡ç¯å¢åå¶ä»æå¡ï¼å¹¶ä¸è½å¤æ­£ç¡®è¯å«ä¸å±äº jsp ç½é¡µçç¹æ®åç´ ã\n\nä¸å¾æ¾ç¤ºäº jsp å®¹å¨å jsp æä»¶å¨ web åºç¨ä¸­æå¤çä½ç½®ã\n\n\n\n# å·¥ä½æ­¥éª¤\n\nä»¥ä¸æ­¥éª¤è¡¨æäº web æå¡å¨æ¯å¦ä½ä½¿ç¨ jsp æ¥åå»ºç½é¡µçï¼\n\n * å°±åå¶ä»æ®éçç½é¡µä¸æ ·ï¼æ¨çæµè§å¨åéä¸ä¸ª http è¯·æ±ç»æå¡å¨ã\n * web æå¡å¨è¯å«åºè¿æ¯ä¸ä¸ªå¯¹ jsp ç½é¡µçè¯·æ±ï¼å¹¶ä¸å°è¯¥è¯·æ±ä¼ éç» jsp å¼æãéè¿ä½¿ç¨ url æè.jsp æä»¶æ¥å®æã\n * jsp å¼æä»ç£çä¸­è½½å¥ jsp æä»¶ï¼ç¶åå°å®ä»¬è½¬åä¸º servletãè¿ç§è½¬ååªæ¯ç®åå°å°æææ¨¡æ¿ææ¬æ¹ç¨ println()è¯­å¥ï¼å¹¶ä¸å°ææç jsp åç´ è½¬åæ java ä»£ç ã\n * jsp å¼æå° servlet ç¼è¯æå¯æ§è¡ç±»ï¼å¹¶ä¸å°åå§è¯·æ±ä¼ éç» servlet å¼æã\n * web æå¡å¨çæç»ä»¶å°ä¼è°ç¨ servlet å¼æï¼ç¶åè½½å¥å¹¶æ§è¡ servlet ç±»ãå¨æ§è¡è¿ç¨ä¸­ï¼servlet äº§ç html æ ¼å¼çè¾åºå¹¶å°å¶ååµäº http response ä¸­ä¸äº¤ç» web æå¡å¨ã\n * web æå¡å¨ä»¥éæ html ç½é¡µçå½¢å¼å° http response è¿åå°æ¨çæµè§å¨ä¸­ã\n * æç»ï¼web æµè§å¨å¤ç http response ä¸­å¨æäº§çç html ç½é¡µï¼å°±å¥½åå¨å¤çéæç½é¡µä¸æ ·ã\n\nä»¥ä¸æåå°çæ­¥éª¤å¯ä»¥ç¨ä¸å¾æ¥è¡¨ç¤ºï¼\n\nä¸è¬æåµä¸ï¼jsp å¼æä¼æ£æ¥ jsp æä»¶å¯¹åºç servlet æ¯å¦å·²ç»å­å¨ï¼å¹¶ä¸æ£æ¥ jsp æä»¶çä¿®æ¹æ¥ææ¯å¦æ©äº servletãå¦æ jsp æä»¶çä¿®æ¹æ¥ææ©äºå¯¹åºç servletï¼é£ä¹å®¹å¨å°±å¯ä»¥ç¡®å® jsp æä»¶æ²¡æè¢«ä¿®æ¹è¿å¹¶ä¸ servlet ææãè¿ä½¿å¾æ´ä¸ªæµç¨ä¸å¶ä»èæ¬è¯­è¨ï¼æ¯å¦ phpï¼ç¸æ¯è¦é«æå¿«æ·ä¸äºã\n\n\n# jsp çå½å¨æ\n\nçè§£ jsp åºå±åè½çå³é®å°±æ¯å»çè§£å®ä»¬æéµå®ççå½å¨æã\n\njsp çå½å¨æå°±æ¯ä»åå»ºå°éæ¯çæ´ä¸ªè¿ç¨ï¼ç±»ä¼¼äº servlet çå½å¨æï¼åºå«å¨äº jsp çå½å¨æè¿åæ¬å° jsp æä»¶ç¼è¯æ servletã\n\nä»¥ä¸æ¯ jsp çå½å¨æä¸­æèµ°è¿çå ä¸ªé¶æ®µï¼\n\n * **ç¼è¯é¶æ®µï¼**servlet å®¹å¨ç¼è¯ servlet æºæä»¶ï¼çæ servlet ç±»\n * **åå§åé¶æ®µï¼**å è½½ä¸ jsp å¯¹åºç servlet ç±»ï¼åå»ºå¶å®ä¾ï¼å¹¶è°ç¨å®çåå§åæ¹æ³\n * **æ§è¡é¶æ®µï¼**è°ç¨ä¸ jsp å¯¹åºç servlet å®ä¾çæå¡æ¹æ³\n * **éæ¯é¶æ®µï¼**è°ç¨ä¸ jsp å¯¹åºç servlet å®ä¾çéæ¯æ¹æ³ï¼ç¶åéæ¯ servlet å®ä¾\n\nå¾ææ¾ï¼jsp çå½å¨æçåä¸ªä¸»è¦é¶æ®µå servlet çå½å¨æéå¸¸ç¸ä¼¼ï¼ä¸é¢ç»åºå¾ç¤ºï¼\n\n\n\n# jsp ç¼è¯\n\nå½æµè§å¨è¯·æ± jsp é¡µé¢æ¶ï¼jsp å¼æä¼é¦åå»æ£æ¥æ¯å¦éè¦ç¼è¯è¿ä¸ªæä»¶ãå¦æè¿ä¸ªæä»¶æ²¡æè¢«ç¼è¯è¿ï¼æèå¨ä¸æ¬¡ç¼è¯åè¢«æ´æ¹è¿ï¼åç¼è¯è¿ä¸ª jsp æä»¶ã\n\nç¼è¯çè¿ç¨åæ¬ä¸ä¸ªæ­¥éª¤ï¼\n\n * è§£æ jsp æä»¶ã\n * å° jsp æä»¶è½¬ä¸º servletã\n * ç¼è¯ servletã\n\n# jsp åå§å\n\nå®¹å¨è½½å¥ jsp æä»¶åï¼å®ä¼å¨ä¸ºè¯·æ±æä¾ä»»ä½æå¡åè°ç¨ jspinit()æ¹æ³ãå¦ææ¨éè¦æ§è¡èªå®ä¹ç jsp åå§åä»»å¡ï¼å¤å jspinit()æ¹æ³å°±è¡äºï¼å°±åä¸é¢è¿æ ·ï¼\n\npublic void jspinit(){\n  // åå§åä»£ç \n}\n\n\nä¸è¬æ¥è®²ç¨åºåªåå§åä¸æ¬¡ï¼servlet ä¹æ¯å¦æ­¤ãéå¸¸æåµä¸æ¨å¯ä»¥å¨ jspinit()æ¹æ³ä¸­åå§åæ°æ®åºè¿æ¥ãæå¼æä»¶ååå»ºæ¥è¯¢è¡¨ã\n\n# jsp æ§è¡\n\nè¿ä¸é¶æ®µæè¿°äº jsp çå½å¨æä¸­ä¸åä¸è¯·æ±ç¸å³çäº¤äºè¡ä¸ºï¼ç´å°è¢«éæ¯ã\n\nå½ jsp ç½é¡µå®æåå§ååï¼jsp å¼æå°ä¼è°ç¨ _jspservice() æ¹æ³ã\n\n_jspservice() æ¹æ³éè¦ä¸ä¸ª httpservletrequest å¯¹è±¡åä¸ä¸ª httpservletresponse å¯¹è±¡ä½ä¸ºå®çåæ°ï¼å°±åä¸é¢è¿æ ·ï¼\n\nvoid _jspservice(httpservletrequest request,\n                 httpservletresponse response) {\n   // æå¡ç«¯å¤çä»£ç \n}\n\n\n_jspservice() æ¹æ³å¨æ¯ä¸ª request ä¸­è¢«è°ç¨ä¸æ¬¡å¹¶ä¸è´è´£äº§çä¸ä¹ç¸å¯¹åºç responseï¼å¹¶ä¸å®è¿è´è´£äº§çææ 7 ä¸ª http æ¹æ³çååºï¼æ¯å¦ getãpostãdelete ç­ç­ã\n\n# jsp æ¸ç\n\njsp çå½å¨æçéæ¯é¶æ®µæè¿°äºå½ä¸ä¸ª jsp ç½é¡µä»å®¹å¨ä¸­è¢«ç§»é¤æ¶æåççä¸åã\n\njspdestroy()æ¹æ³å¨ jsp ä¸­ç­ä»·äº servlet ä¸­çéæ¯æ¹æ³ãå½æ¨éè¦æ§è¡ä»»ä½æ¸çå·¥ä½æ¶å¤å jspdestroy()æ¹æ³ï¼æ¯å¦éæ¾æ°æ®åºè¿æ¥æèå³é­æä»¶å¤¹ç­ç­ã\n\njspdestroy()æ¹æ³çæ ¼å¼å¦ä¸ï¼\n\npublic void jspdestroy() {\n   // æ¸çä»£ç \n}\n\n\n\n# è¯­æ³\n\n\n# èæ¬\n\nèæ¬ç¨åºå¯ä»¥åå«ä»»æéç java è¯­å¥ãåéãæ¹æ³æè¡¨è¾¾å¼ï¼åªè¦å®ä»¬å¨èæ¬è¯­è¨ä¸­æ¯ææçã\n\nèæ¬ç¨åºçè¯­æ³æ ¼å¼ï¼\n\n<% ä»£ç çæ®µ %>\n\n\næèï¼æ¨ä¹å¯ä»¥ç¼åä¸å¶ç­ä»·ç xml è¯­å¥ï¼å°±åä¸é¢è¿æ ·ï¼\n\n<jsp:scriptlet>\n  ä»£ç çæ®µ\n</jsp:scriptlet>\n\n\nä»»ä½ææ¬ãhtml æ ç­¾ãjsp åç´ å¿é¡»åå¨èæ¬ç¨åºçå¤é¢ã\n\nä¸é¢ç»åºä¸ä¸ªç¤ºä¾ï¼åæ¶ä¹æ¯æ¬æç¨çç¬¬ä¸ä¸ª jsp ç¤ºä¾ï¼\n\n<html>\n  <head>\n    <title>hello world</title>\n  </head>\n  <body>\n    hello world!<br />\n    <% out.println("your ip address is " + request.getremoteaddr()); %>\n  </body>\n</html>\n\n\n**æ³¨æï¼**è¯·ç¡®ä¿ apache tomcat å·²ç»å®è£å¨ c:\\apache-tomcat-7.0.2 ç®å½ä¸å¹¶ä¸è¿è¡ç¯å¢å·²ç»æ­£ç¡®è®¾ç½®ã\n\nå°ä»¥ä¸ä»£ç ä¿å­å¨ hello.jsp ä¸­ï¼ç¶åå°å®æ¾ç½®å¨ c:\\apache-tomcat-7.0.2\\webapps\\root ç®å½ä¸ï¼æå¼æµè§å¨å¹¶å¨å°åæ ä¸­è¾å¥ http://localhost:8080/hello.jsp ãè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\n\n\n# ä¸­æç¼ç é®é¢\n\nå¦ææä»¬è¦å¨é¡µé¢æ­£å¸¸æ¾ç¤ºä¸­æï¼æä»¬éè¦å¨ jsp æä»¶å¤´é¨æ·»å ä»¥ä¸ä»£ç ï¼<>\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n\n\næ¥ä¸æ¥æä»¬å°ä»¥ä¸ç¨åºä¿®æ¹ä¸ºï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    hello world!<br />\n    <% out.println("ä½ ç ip å°å " + request.getremoteaddr()); %>\n  </body>\n</html>\n\n\nè¿æ ·ä¸­æå°±å¯ä»¥æ­£å¸¸æ¾ç¤ºäºã\n\n\n# jsp å£°æ\n\nä¸ä¸ªå£°æè¯­å¥å¯ä»¥å£°æä¸ä¸ªæå¤ä¸ªåéãæ¹æ³ï¼ä¾åé¢ç java ä»£ç ä½¿ç¨ãå¨ jsp æä»¶ä¸­ï¼æ¨å¿é¡»åå£°æè¿äºåéåæ¹æ³ç¶åæè½ä½¿ç¨å®ä»¬ã\n\njsp å£°æçè¯­æ³æ ¼å¼ï¼\n\n<%! declaration; [ declaration; ]+ ... %>\n\n\næèï¼æ¨ä¹å¯ä»¥ç¼åä¸å¶ç­ä»·ç xml è¯­å¥ï¼å°±åä¸é¢è¿æ ·ï¼\n\n<jsp:declaration>\n  ä»£ç çæ®µ\n</jsp:declaration>\n\n\nç¨åºç¤ºä¾ï¼\n\n<%! int i = 0; %> <%! int a, b, c; %> <%! circle a = new circle(2.0); %>\n\n\n\n# jsp è¡¨è¾¾å¼\n\nä¸ä¸ª jsp è¡¨è¾¾å¼ä¸­åå«çèæ¬è¯­è¨è¡¨è¾¾å¼ï¼åè¢«è½¬åæ stringï¼ç¶åæå¥å°è¡¨è¾¾å¼åºç°çå°æ¹ã\n\nç±äºè¡¨è¾¾å¼çå¼ä¼è¢«è½¬åæ stringï¼æä»¥æ¨å¯ä»¥å¨ä¸ä¸ªææ¬è¡ä¸­ä½¿ç¨è¡¨è¾¾å¼èä¸ç¨å»ç®¡å®æ¯å¦æ¯ html æ ç­¾ã\n\nè¡¨è¾¾å¼åç´ ä¸­å¯ä»¥åå«ä»»ä½ç¬¦å java è¯­è¨è§èçè¡¨è¾¾å¼ï¼ä½æ¯ä¸è½ä½¿ç¨åå·æ¥ç»æè¡¨è¾¾å¼ã\n\njsp è¡¨è¾¾å¼çè¯­æ³æ ¼å¼ï¼\n\n<%= è¡¨è¾¾å¼ %>\n\n\nåæ ·ï¼æ¨ä¹å¯ä»¥ç¼åä¸ä¹ç­ä»·ç xml è¯­å¥ï¼\n\n<jsp:expression>\n  è¡¨è¾¾å¼\n</jsp:expression>\n\n\nç¨åºç¤ºä¾ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <p>\n      ä»å¤©çæ¥ææ¯: <%= (new java.util.date()).tolocalestring()%>\n    </p>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\nä»å¤©çæ¥ææ¯: 2016-6-25 13:40:07\n\n\n----------------------------------------\n\n\n# jsp æ³¨é\n\njsp æ³¨éä¸»è¦æä¸¤ä¸ªä½ç¨ï¼ä¸ºä»£ç ä½æ³¨éä»¥åå°ææ®µä»£ç æ³¨éæã\n\njsp æ³¨éçè¯­æ³æ ¼å¼ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>jspæ³¨éç¤ºä¾</title>\n  </head>\n  <body>\n    <%-- è¯¥é¨åæ³¨éå¨ç½é¡µä¸­ä¸ä¼è¢«æ¾ç¤º--%>\n    <p>\n      ä»å¤©çæ¥ææ¯: <%= (new java.util.date()).tolocalestring()%>\n    </p>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\nä»å¤©çæ¥ææ¯: 2016-6-25 13:41:26\n\n\nä¸åæåµä¸ä½¿ç¨æ³¨éçè¯­æ³è§åï¼\n\nè¯­æ³             æè¿°\n<%-- æ³¨é --%>   jsp æ³¨éï¼æ³¨éåå®¹ä¸ä¼è¢«åéè³æµè§å¨çè³ä¸ä¼è¢«ç¼è¯\n\x3c!-- æ³¨é --\x3e    html æ³¨éï¼éè¿æµè§å¨æ¥çç½é¡µæºä»£ç æ¶å¯ä»¥çè§æ³¨éåå®¹\n<%             ä»£è¡¨éæ <%å¸¸é\n%>             ä»£è¡¨éæ %> å¸¸é\n\'              å¨å±æ§ä¸­ä½¿ç¨çåå¼å·\n"              å¨å±æ§ä¸­ä½¿ç¨çåå¼å·\n\n\n# æ§å¶è¯­å¥\n\njsp æä¾å¯¹ java è¯­è¨çå¨é¢æ¯æãæ¨å¯ä»¥å¨ jsp ç¨åºä¸­ä½¿ç¨ java api çè³å»ºç« java ä»£ç åï¼åæ¬å¤æ­è¯­å¥åå¾ªç¯è¯­å¥ç­ç­ã\n\n# ifâ¦else è¯­å¥\n\nifâ¦elseåï¼è¯·çä¸é¢è¿ä¸ªä¾å­ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%> <%! int day = 1; %>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>02.jspè¯­æ³ - if...elseç¤ºä¾</title>\n  </head>\n  <body>\n    <h3>if...else å®ä¾</h3>\n    <% if (day == 1 | day == 7) { %>\n    <p>ä»å¤©æ¯å¨æ«</p>\n    <% } else { %>\n    <p>ä»å¤©ä¸æ¯å¨æ«</p>\n    <% } %>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\nif...else å®ä¾\nä»å¤©ä¸æ¯å¨æ«\n\n\n# switchâ¦case è¯­å¥\n\nç°å¨æ¥çç switchâ¦case åï¼ä¸ ifâ¦else åæå¾å¤§çä¸åï¼å®ä½¿ç¨ out.println()ï¼å¹¶ä¸æ´ä¸ªé½è£å¨èæ¬ç¨åºçæ ç­¾ä¸­ï¼å°±åä¸é¢è¿æ ·ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%> <%! int day = 3; %>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>02.jspè¯­æ³ - switch...caseç¤ºä¾</title>\n  </head>\n  <body>\n    <h3>sswitch...caseç¤ºä¾</h3>\n    <% switch(day) { case 0: out.println("ææå¤©"); break; case 1:\n    out.println("ææä¸"); break; case 2: out.println("ææäº"); break; case 3:\n    out.println("ææä¸"); break; case 4: out.println("ææå"); break; case 5:\n    out.println("ææäº"); break; default: out.println("ææå­"); } %>\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ï¼è¿è¡åå¾åºä»¥ä¸ç»æï¼\n\nswitch...case å®ä¾\n\nææä¸\n\n\n# å¾ªç¯è¯­å¥\n\nå¨ jsp ç¨åºä¸­å¯ä»¥ä½¿ç¨ java çä¸ä¸ªåºæ¬å¾ªç¯ç±»åï¼forï¼whileï¼å doâ¦whileã\n\nè®©æä»¬æ¥çç for å¾ªç¯çä¾å­ï¼ä»¥ä¸è¾åºçä¸åå­ä½å¤§å°ç"èé¸æç¨"ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%> <%! int fontsize; %>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h3>for å¾ªç¯å®ä¾</h3>\n    <%for ( fontsize = 1; fontsize <= 3; fontsize++){ %>\n    <font color="green" size="<%= fontsize %>">\n      èé¸æç¨ </font\n    ><br />\n    <%}%>\n  </body>\n</html>\n\n\nè¿è¡åå¾å°ä»¥ä¸ç»æï¼\n\n\n\nå°ä¸ä¾æ¹ç¨ while å¾ªç¯æ¥åï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%> <%! int fontsize; %>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h3>while å¾ªç¯å®ä¾</h3>\n    <%while ( fontsize <= 3){ %>\n    <font color="green" size="<%= fontsize %>">\n      èé¸æç¨ </font\n    ><br />\n    <%fontsize++;%> <%}%>\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ï¼è¾åºç»æä¸ºï¼fontsize åå§åä¸º 0ï¼æä»¥å¤è¾åºäºä¸è¡ï¼ï¼\n\n\n\njsp è¿ç®ç¬¦\n\njsp æ¯æææ java é»è¾åç®æ¯è¿ç®ç¬¦ã\n\nä¸è¡¨ç½ååºäº jsp å¸¸è§è¿ç®ç¬¦ï¼ä¼åçº§ä»é«å°åºï¼\n\nç±»å«      æä½ç¬¦                                   ç»åæ§\nåç¼      () [] . (ç¹è¿ç®ç¬¦)                        å·¦å°å³\nä¸å      ++ - - ! ~                            å³å°å·¦\nå¯ä¹æ§     * / %                                 å·¦å°å³\nå¯å æ§     + -                                   å·¦å°å³\nç§»ä½      >> >>> <<                             å·¦å°å³\nå³ç³»      > >= < <=                             å·¦å°å³\nç¸ç­/ä¸ç­   == !=                                 å·¦å°å³\nä½ä¸      &                                     å·¦å°å³\nä½å¼æ     ^                                     å·¦å°å³\nä½æ      |                                     å·¦å°å³\né»è¾ä¸     &&                                    å·¦å°å³\né»è¾æ     | |                                   å·¦å°å³\næ¡ä»¶å¤æ­    ?:                                    å³å°å·¦\nèµå¼      = += -= \\*= /= %= >>= <<= &= ^= | =   å³å°å·¦\néå·      ,                                     å·¦å°å³\n\n\n# jsp å­é¢é\n\njsp è¯­è¨å®ä¹äºä»¥ä¸å ä¸ªå­é¢éï¼\n\n * å¸å°å¼(boolean)ï¼true å false;\n * æ´å(int)ï¼ä¸ java ä¸­çä¸æ ·;\n * æµ®ç¹å(float)ï¼ä¸ java ä¸­çä¸æ ·;\n * å­ç¬¦ä¸²(string)ï¼ä»¥åå¼å·æåå¼å·å¼å§åç»æ;\n * nullï¼nullã\n\n\n# æä»¤\n\njsp æä»¤ç¨æ¥è®¾ç½®æ´ä¸ª jsp é¡µé¢ç¸å³çå±æ§ï¼å¦ç½é¡µçç¼ç æ¹å¼åèæ¬è¯­è¨ã\n\njsp æä»¤ä»¥å¼<%@å¼å§ï¼ä»¥%>ç»æã\n\njsp æä»¤è¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<%@ directive attribute="value" %>\n\n\næä»¤å¯ä»¥æå¾å¤ä¸ªå±æ§ï¼å®ä»¬ä»¥é®å¼å¯¹çå½¢å¼å­å¨ï¼å¹¶ç¨éå·éå¼ã\n\njsp ä¸­çä¸ç§æä»¤æ ç­¾ï¼\n\næä»¤                   æè¿°\n<%@ page ... %>      å®ä¹ç½é¡µä¾èµå±æ§ï¼æ¯å¦èæ¬è¯­è¨ãerror é¡µé¢ãç¼å­éæ±ç­ç­\n<%@ include ... %>   åå«å¶ä»æä»¶\n<%@ taglib ... %>    å¼å¥æ ç­¾åºçå®ä¹ï¼å¯ä»¥æ¯èªå®ä¹æ ç­¾\n\n\n# page æä»¤\n\npage æä»¤ä¸ºå®¹å¨æä¾å½åé¡µé¢çä½¿ç¨è¯´æãä¸ä¸ª jsp é¡µé¢å¯ä»¥åå«å¤ä¸ªpageæä»¤ã\n\npage æä»¤çè¯­æ³æ ¼å¼ï¼\n\n<%@ page attribute="value" %>\n\n\nç­ä»·ç xml æ ¼å¼ï¼\n\n<jsp:directive.page attribute="value" />\n\n\nä¾ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8" %>\n\n\n# å±æ§\n\nä¸è¡¨ååºä¸ page æä»¤ç¸å³çå±æ§ï¼\n\nå±æ§                   æè¿°\nbuffer               æå® out å¯¹è±¡ä½¿ç¨ç¼å²åºçå¤§å°\nautoflush            æ§å¶ out å¯¹è±¡ç ç¼å­åº\ncontenttype          æå®å½å jsp é¡µé¢ç mime ç±»ååå­ç¬¦ç¼ç \nerrorpage            æå®å½ jsp é¡µé¢åçå¼å¸¸æ¶éè¦è½¬åçéè¯¯å¤çé¡µé¢\niserrorpage          æå®å½åé¡µé¢æ¯å¦å¯ä»¥ä½ä¸ºå¦ä¸ä¸ª jsp é¡µé¢çéè¯¯å¤çé¡µé¢\nextends              æå® servlet ä»åªä¸ä¸ªç±»ç»§æ¿\nimport               å¯¼å¥è¦ä½¿ç¨ç java ç±»\ninfo                 å®ä¹ jsp é¡µé¢çæè¿°ä¿¡æ¯\nisthreadsafe         æå®å¯¹ jsp é¡µé¢çè®¿é®æ¯å¦ä¸ºçº¿ç¨å®å¨\nlanguage             å®ä¹ jsp é¡µé¢æç¨çèæ¬è¯­è¨ï¼é»è®¤æ¯ java\nsession              æå® jsp é¡µé¢æ¯å¦ä½¿ç¨ session\niselignored          æå®æ¯å¦æ§è¡ el è¡¨è¾¾å¼\nisscriptingenabled   ç¡®å®èæ¬åç´ è½å¦è¢«ä½¿ç¨\n\n\n# include æä»¤\n\njsp å¯ä»¥éè¿includeæä»¤æ¥åå«å¶ä»æä»¶ã\n\nè¢«åå«çæä»¶å¯ä»¥æ¯ jsp æä»¶ãhtml æä»¶æææ¬æä»¶ãåå«çæä»¶å°±å¥½åæ¯è¯¥ jsp æä»¶çä¸é¨åï¼ä¼è¢«åæ¶ç¼è¯æ§è¡ã\n\ninclude æä»¤çè¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<%@ include file="æä»¶ç¸å¯¹ url å°å" %>\n\n\ninclude æä»¤ä¸­çæä»¶åå®éä¸æ¯ä¸ä¸ªç¸å¯¹ç url å°åã\n\nå¦ææ¨æ²¡æç»æä»¶å³èä¸ä¸ªè·¯å¾ï¼jsp ç¼è¯å¨é»è®¤å¨å½åè·¯å¾ä¸å¯»æ¾ã\n\nç­ä»·ç xml è¯­æ³ï¼\n\n<jsp:directive.include file="æä»¶ç¸å¯¹ url å°å" />\n\n\n\n# taglib æä»¤\n\njsp åè®¸ç¨æ·èªå®ä¹æ ç­¾ï¼ä¸ä¸ªèªå®ä¹æ ç­¾åºå°±æ¯èªå®ä¹æ ç­¾çéåã\n\ntaglibæä»¤å¼å¥ä¸ä¸ªèªå®ä¹æ ç­¾éåçå®ä¹ï¼åæ¬åºè·¯å¾ãèªå®ä¹æ ç­¾ã\n\ntaglibæä»¤çè¯­æ³ï¼\n\n<%@ taglib uri="uri" prefix="prefixoftag" %>\n\n\nuri å±æ§ç¡®å®æ ç­¾åºçä½ç½®ï¼prefix å±æ§æå®æ ç­¾åºçåç¼ã\n\nç­ä»·ç xml è¯­æ³ï¼\n\n<jsp:directive.taglib uri="uri" prefix="prefixoftag" />\n\n\n\n# jsp å¨ä½åç´ \n\njsp å¨ä½åç´ æ¯ä¸ç» jsp åç½®çæ ç­¾ï¼åªéè¦ä¹¦åå¾å°çæ è®°ä»£ç å°±è½ä½¿ç¨ jsp æä¾çä¸°å¯åè½ãjsp å¨ä½åç´ æ¯å¯¹å¸¸ç¨ç jsp åè½çæ½è±¡ä¸å°è£ï¼åæ¬ä¸¤ç§ï¼èªå®ä¹ jsp å¨ä½åç´ ä¸æ å jsp å¨ä½åç´ ã\n\nä¸ jsp æä»¤åç´ ä¸åçæ¯ï¼jsp å¨ä½åç´ å¨è¯·æ±å¤çé¶æ®µèµ·ä½ç¨ãjsp å¨ä½åç´ æ¯ç¨ xml è¯­æ³åæçã\n\nå©ç¨ jsp å¨ä½å¯ä»¥å¨æå°æå¥æä»¶ãéç¨ javabean ç»ä»¶ãæç¨æ·éå®åå°å¦å¤çé¡µé¢ãä¸º java æä»¶çæ html ä»£ç ã\n\nå¨ä½åç´ åªæä¸ç§è¯­æ³ï¼å®ç¬¦å xml æ åï¼\n\n<jsp:action_name attribute="value" />\n\n\nå¨ä½åç´ åºæ¬ä¸é½æ¯é¢å®ä¹çå½æ°ï¼jsp è§èå®ä¹äºä¸ç³»åçæ åå¨ä½ï¼å®ç¨ jsp ä½ä¸ºåç¼ï¼å¯ç¨çæ åå¨ä½åç´ å¦ä¸ï¼\n\nè¯­æ³                æè¿°\njsp:include       å¨é¡µé¢è¢«è¯·æ±çæ¶åå¼å¥ä¸ä¸ªæä»¶ã\njsp:usebean       å¯»æ¾æèå®ä¾åä¸ä¸ª javabeanã\njsp:setproperty   è®¾ç½® javabean çå±æ§ã\njsp:getproperty   è¾åºæä¸ª javabean çå±æ§ã\njsp:forward       æè¯·æ±è½¬å°ä¸ä¸ªæ°çé¡µé¢ã\njsp:plugin        æ ¹æ®æµè§å¨ç±»åä¸º java æä»¶çæ object æ embed æ è®°ã\njsp:element       å®ä¹å¨æ xml åç´ \njsp:attribute     è®¾ç½®å¨æå®ä¹ç xml åç´ å±æ§ã\njsp:body          è®¾ç½®å¨æå®ä¹ç xml åç´ åå®¹ã\njsp:text          å¨ jsp é¡µé¢åææ¡£ä¸­ä½¿ç¨åå¥ææ¬çæ¨¡æ¿\n\n\n# å¸¸è§çå±æ§\n\nææçå¨ä½è¦ç´ é½æä¸¤ä¸ªå±æ§ï¼id å±æ§å scope å±æ§ã\n\n * **id å±æ§ï¼**id å±æ§æ¯å¨ä½åç´ çå¯ä¸æ è¯ï¼å¯ä»¥å¨ jsp é¡µé¢ä¸­å¼ç¨ãå¨ä½åç´ åå»ºç id å¼å¯ä»¥éè¿ pagecontext æ¥è°ç¨ã\n * **scope å±æ§ï¼**è¯¥å±æ§ç¨äºè¯å«å¨ä½åç´ ççå½å¨æã id å±æ§å scope å±æ§æç´æ¥å³ç³»ï¼scope å±æ§å®ä¹äºç¸å³è id å¯¹è±¡çå¯¿å½ã scope å±æ§æåä¸ªå¯è½çå¼ï¼ (a) page, (b)request, (c)session, å (d) applicationã\n\n\n# <jsp:include>\n\n<jsp:include> ç¨æ¥åå«éæåå¨æçæä»¶ãè¯¥å¨ä½ææå®æä»¶æå¥æ­£å¨çæçé¡µé¢ã\n\nå¦æè¢«åå«çæä»¶ä¸º jsp ç¨åºï¼åä¼åæ§è¡ jsp ç¨åºï¼åå°æ§è¡ç»æåå«è¿æ¥ã\n\nè¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<jsp:include page="ç¸å¯¹ url å°å" flush="true" />\n\n\nåé¢å·²ç»ä»ç»è¿ include æä»¤ï¼å®æ¯å¨ jsp æä»¶è¢«è½¬æ¢æ servlet çæ¶åå¼å¥æä»¶ï¼èè¿éç jsp:include å¨ä½ä¸åï¼æå¥æä»¶çæ¶é´æ¯å¨é¡µé¢è¢«è¯·æ±çæ¶åã\n\nä»¥ä¸æ¯ include å¨ä½ç¸å³çå±æ§åè¡¨ã\n\nå±æ§      æè¿°\npage    åå«å¨é¡µé¢ä¸­çç¸å¯¹ url å°åã\nflush   å¸å°å±æ§ï¼å®ä¹å¨åå«èµæºåæ¯å¦å·æ°ç¼å­åºã\n\nç¤ºä¾ï¼\n\nä»¥ä¸æä»¬å®ä¹äºä¸¤ä¸ªæä»¶ date.jsp å main.jspï¼ä»£ç å¦ä¸æç¤ºï¼\n\ndate.jsp æä»¶ä»£ç ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<p>\n  ä»å¤©çæ¥ææ¯: <%= (new java.util.date())%>\n</p>\n\n\nmain.jsp æä»¶ä»£ç ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h2>include å¨ä½å®ä¾</h2>\n    <jsp:include page="date.jsp" flush="true" />\n  </body>\n</html>\n\n\nç°å¨å°ä»¥ä¸ä¸¤ä¸ªæä»¶æ¾å¨æå¡å¨çæ ¹ç®å½ä¸ï¼è®¿é® main.jsp æä»¶ãæ¾ç¤ºç»æå¦ä¸ï¼\n\ninclude å¨ä½å®ä¾\n\nä»å¤©çæ¥ææ¯: 2016-6-25 14:08:17\n\n\n\n# <jsp:usebean>\n\njsp:usebean å¨ä½ç¨æ¥å è½½ä¸ä¸ªå°å¨ jsp é¡µé¢ä¸­ä½¿ç¨ç javabeanã\n\nè¿ä¸ªåè½éå¸¸æç¨ï¼å ä¸ºå®ä½¿å¾æä»¬å¯ä»¥åæ¥ java ç»ä»¶å¤ç¨çä¼å¿ã\n\njsp:usebean å¨ä½æç®åçè¯­æ³ä¸ºï¼\n\n<jsp:usebean id="name" class="package.class" />\n\n\nå¨ç±»è½½å¥åï¼æä»¬æ¢å¯ä»¥éè¿ jsp:setproperty å jsp:getproperty å¨ä½æ¥ä¿®æ¹åæ£ç´¢ bean çå±æ§ã\n\nä»¥ä¸æ¯ usebean å¨ä½ç¸å³çå±æ§åè¡¨ã\n\nå±æ§         æè¿°\nclass      æå® bean çå®æ´ååã\ntype       æå®å°å¼ç¨è¯¥å¯¹è±¡åéçç±»åã\nbeanname   éè¿ java.beans.beans ç instantiate() æ¹æ³æå® bean çåå­ã\n\nå¨ç»åºå·ä½å®ä¾åï¼è®©æä»¬åæ¥çä¸ jsp:setproperty å jsp:getproperty å¨ä½åç´ ï¼\n\n\n# <jsp:setproperty>\n\njsp:setproperty ç¨æ¥è®¾ç½®å·²ç»å®ä¾åç bean å¯¹è±¡çå±æ§ï¼æä¸¤ç§ç¨æ³ãé¦åï¼ä½ å¯ä»¥å¨ jsp:usebean åç´ çå¤é¢ï¼åé¢ï¼ä½¿ç¨ jsp:setpropertyï¼å¦ä¸æç¤ºï¼\n\n<jsp:usebean id="myname" ... />\n...\n<jsp:setproperty name="myname" property="someproperty" .../>\n\n\næ­¤æ¶ï¼ä¸ç®¡ jsp:usebean æ¯æ¾å°äºä¸ä¸ªç°æç beanï¼è¿æ¯æ°åå»ºäºä¸ä¸ª bean å®ä¾ï¼jsp:setproperty é½ä¼æ§è¡ãç¬¬äºç§ç¨æ³æ¯æ jsp:setproperty æ¾å¥ jsp:usebean åç´ çåé¨ï¼å¦ä¸æç¤ºï¼\n\n<jsp:usebean id="myname" ... >\n...\n   <jsp:setproperty name="myname" property="someproperty" .../>\n</jsp:usebean>\n\n\næ­¤æ¶ï¼jsp:setproperty åªæå¨æ°å»º bean å®ä¾æ¶æä¼æ§è¡ï¼å¦ææ¯ä½¿ç¨ç°æå®ä¾åä¸æ§è¡ jsp:setpropertyã\n\njsp:setproperty å¨ä½æä¸é¢åä¸ªå±æ§,å¦ä¸è¡¨ï¼\n\nå±æ§         æè¿°\nname       name å±æ§æ¯å¿éçãå®è¡¨ç¤ºè¦è®¾ç½®å±æ§çæ¯åªä¸ª beanã\nproperty   property å±æ§æ¯å¿éçãå®è¡¨ç¤ºè¦è®¾ç½®åªä¸ªå±æ§ãæä¸ä¸ªç¹æ®ç¨æ³ï¼å¦æ property\n           çå¼æ¯"*"ï¼è¡¨ç¤ºææåå­å bean å±æ§åå­å¹éçè¯·æ±åæ°é½å°è¢«ä¼ éç»ç¸åºçå±æ§ set æ¹æ³ã\nvalue      value å±æ§æ¯å¯éçãè¯¥å±æ§ç¨æ¥æå® bean å±æ§çå¼ãå­ç¬¦ä¸²æ°æ®ä¼å¨ç®æ ç±»ä¸­éè¿æ åç valueof\n           æ¹æ³èªå¨è½¬æ¢ææ°å­ãbooleanãbooleanã\n           byteãbyteãcharãcharacterãä¾å¦ï¼boolean å boolean\n           ç±»åçå±æ§å¼ï¼æ¯å¦"true"ï¼éè¿ boolean.valueof è½¬æ¢ï¼int å integer\n           ç±»åçå±æ§å¼ï¼æ¯å¦"42"ï¼éè¿ integer.valueof è½¬æ¢ã ãã value å param\n           ä¸è½åæ¶ä½¿ç¨ï¼ä½å¯ä»¥ä½¿ç¨å¶ä¸­ä»»æä¸ä¸ªã\nparam      param æ¯å¯éçãå®æå®ç¨åªä¸ªè¯·æ±åæ°ä½ä¸º bean å±æ§çå¼ãå¦æå½åè¯·æ±æ²¡æåæ°ï¼åä»ä¹äºæä¹ä¸åï¼ç³»ç»ä¸ä¼æ\n           null ä¼ éç» bean å±æ§ç set æ¹æ³ãå æ­¤ï¼ä½ å¯ä»¥è®© bean\n           èªå·±æä¾é»è®¤å±æ§å¼ï¼åªæå½è¯·æ±åæ°æç¡®æå®äºæ°å¼æ¶æä¿®æ¹é»è®¤å±æ§å¼ã\n\n\n# <jsp:getproperty>\n\njsp:getproperty å¨ä½æåæå® bean å±æ§çå¼ï¼è½¬æ¢æå­ç¬¦ä¸²ï¼ç¶åè¾åºãè¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<jsp:usebean id="myname" ... />\n...\n<jsp:getproperty name="myname" property="someproperty" .../>\n\n\nä¸è¡¨æ¯ä¸ getproperty ç¸å³èçå±æ§ï¼\n\nå±æ§         æè¿°\nname       è¦æ£ç´¢ç bean å±æ§åç§°ãbean å¿é¡»å·²å®ä¹ã\nproperty   è¡¨ç¤ºè¦æå bean å±æ§çå¼\n\nå®ä¾\n\nä»¥ä¸å®ä¾æä»¬ä½¿ç¨äº bean:\n\npackage com.runoob.main;\n\npublic class testbean {\n   private string message = "èé¸æç¨";\n\n   public string getmessage() {\n      return(message);\n   }\n   public void setmessage(string message) {\n      this.message = message;\n   }\n}\n\n\nç¼è¯ä»¥ä¸å®ä¾æä»¶ testbean.java ï¼\n\n$ javac testbean.java\n\n\nç¼è¯å®æåä¼å¨å½åç®å½ä¸çæä¸ä¸ª testbean.class æä»¶ï¼ å°è¯¥æä»¶æ·è´è³å½å jsp é¡¹ç®ç webcontent/web-inf/classes/com/runoob/main ä¸( com/runoob/main åè·¯å¾ï¼æ²¡æéè¦æå¨åå»º)ã\n\nä¸é¢æ¯ä¸ä¸ª eclipse ä¸­ç®å½ç»æå¾ï¼\n\n\n\nä¸é¢æ¯ä¸ä¸ªå¾ç®åçä¾å­ï¼å®çåè½æ¯è£è½½ä¸ä¸ª beanï¼ç¶åè®¾ç½®/è¯»åå®ç message å±æ§ã\n\nç°å¨è®©æä»¬å¨ main.jsp æä»¶ä¸­è°ç¨è¯¥ bean:\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h2>jsp ä½¿ç¨ javabean å®ä¾</h2>\n    <jsp:usebean id="test" class="com.runoob.main.testbean" />\n\n    <jsp:setproperty name="test" property="message" value="èé¸æç¨..." />\n\n    <p>è¾åºä¿¡æ¯....</p>\n\n    <jsp:getproperty name="test" property="message" />\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ï¼æ§è¡ä»¥ä¸æä»¶ï¼è¾åºå¦ä¸æç¤ºï¼\n\n\n\n\n# <jsp:forward>\n\njsp:forward å¨ä½æè¯·æ±è½¬å°å¦å¤çé¡µé¢ãjsp:forward æ è®°åªæä¸ä¸ªå±æ§ pageãè¯­æ³æ ¼å¼å¦ä¸æç¤ºï¼\n\n<jsp:forward page="ç¸å¯¹ url å°å" />\n\n\nä»¥ä¸æ¯ forward ç¸å³èçå±æ§ï¼\n\nå±æ§     æè¿°\npage   page å±æ§åå«çæ¯ä¸ä¸ªç¸å¯¹ urlãpage çå¼æ¢å¯ä»¥ç´æ¥ç»åºï¼ä¹å¯ä»¥å¨è¯·æ±çæ¶åå¨æè®¡ç®ï¼å¯ä»¥æ¯ä¸ä¸ª jsp\n       é¡µé¢æèä¸ä¸ª java servlet.\n\nå®ä¾\n\nä»¥ä¸å®ä¾æä»¬ä½¿ç¨äºä¸¤ä¸ªæä»¶ï¼åå«æ¯ï¼ date.jsp å main.jspã\n\ndate.jsp æä»¶ä»£ç å¦ä¸ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<p>\n  ä»å¤©çæ¥ææ¯: <%= (new java.util.date()).tolocalestring()%>\n</p>\n\n\nmain.jsp æä»¶ä»£ç ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <h2>forward å¨ä½å®ä¾</h2>\n    <jsp:forward page="date.jsp" />\n  </body>\n</html>\n\n\nç°å¨å°ä»¥ä¸ä¸¤ä¸ªæä»¶æ¾å¨æå¡å¨çæ ¹ç®å½ä¸ï¼è®¿é® main.jsp æä»¶ãæ¾ç¤ºç»æå¦ä¸ï¼\n\nä»å¤©çæ¥ææ¯: 2016-6-25 14:37:25\n\n\n\n# <jsp:plugin>\n\njsp:plugin å¨ä½ç¨æ¥æ ¹æ®æµè§å¨çç±»åï¼æå¥éè¿ java æä»¶ è¿è¡ java applet æå¿éç object æ embed åç´ ã\n\nå¦æéè¦çæä»¶ä¸å­å¨ï¼å®ä¼ä¸è½½æä»¶ï¼ç¶åæ§è¡ java ç»ä»¶ã java ç»ä»¶å¯ä»¥æ¯ä¸ä¸ª applet æä¸ä¸ª javabeanã\n\nplugin å¨ä½æå¤ä¸ªå¯¹åº html åç´ çå±æ§ç¨äºæ ¼å¼å java ç»ä»¶ãparam åç´ å¯ç¨äºå applet æ bean ä¼ éåæ°ã\n\nä»¥ä¸æ¯ä½¿ç¨ plugin å¨ä½åç´ çå¸åå®ä¾:\n\n<jsp:plugin type="applet" codebase="dirname" code="myapplet.class"\n                           width="60" height="80">\n   <jsp:param name="fontcolor" value="red" />\n   <jsp:param name="background" value="black" />\n\n   <jsp:fallback>\n      unable to initialize java plugin\n   </jsp:fallback>\n\n</jsp:plugin>\n\n\nå¦æä½ æå´è¶£å¯ä»¥å°è¯ä½¿ç¨ applet æ¥æµè¯ jsp:plugin å¨ä½åç´ ï¼<fallback> åç´ æ¯ä¸ä¸ªæ°åç´ ï¼å¨ç»ä»¶åºç°æéçéè¯¯æ¯åéç»ç¨æ·éè¯¯ä¿¡æ¯ã\n\n\n# <jsp:element> ã <jsp:attribute>ã<jsp:body>\n\n<jsp:element> ã <jsp:attribute>ã<jsp:body> å¨ä½åç´ å¨æå®ä¹ xml åç´ ãå¨ææ¯éå¸¸éè¦çï¼è¿å°±æå³ç xml åç´ å¨ç¼è¯æ¶æ¯å¨æçæçèééæã\n\nä»¥ä¸å®ä¾å¨æå®ä¹äº xml åç´ ï¼\n\n<%@ page language="java" contenttype="text/html; charset=utf-8"\npageencoding="utf-8"%>\n<!doctype html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>èé¸æç¨(runoob.com)</title>\n  </head>\n  <body>\n    <jsp:element name="xmlelement">\n      <jsp:attribute name="xmlelementattr">\n        å±æ§å¼\n      </jsp:attribute>\n      <jsp:body>\n        xml åç´ çä¸»ä½\n      </jsp:body>\n    </jsp:element>\n  </body>\n</html>\n\n\næµè§å¨è®¿é®ä»¥ä¸é¡µé¢ï¼è¾åºç»æå¦ä¸æç¤ºï¼\n\n\n\n\n# <jsp:text>\n\njsp:textå¨ä½åç´ åè®¸å¨ jsp é¡µé¢åææ¡£ä¸­ä½¿ç¨åå¥ææ¬çæ¨¡æ¿ï¼è¯­æ³æ ¼å¼å¦ä¸ï¼\n\n<jsp:text>æ¨¡æ¿æ°æ®</jsp:text>\n\n\nä»¥ä¸ææ¬æ¨¡æ¿ä¸è½åå«å¶ä»åç´ ï¼åªè½åªè½åå«ææ¬å el è¡¨è¾¾å¼ï¼æ³¨ï¼el è¡¨è¾¾å¼å°å¨åç»­ç« èä¸­ä»ç»ï¼ãè¯·æ³¨æï¼å¨ xml æä»¶ä¸­ï¼æ¨ä¸è½ä½¿ç¨è¡¨è¾¾å¼å¦ ${whatever > 0}ï¼å ä¸º>ç¬¦å·æ¯éæ³çã ä½ å¯ä»¥ä½¿ç¨ ${whatever gt 0}è¡¨è¾¾å¼æèåµå¥å¨ä¸ä¸ª cdata é¨åçå¼ã\n\n<jsp:text><![cdata[<br>]]></jsp:text>\n\n\nå¦æä½ éè¦å¨ xhtml ä¸­å£°æ doctype,å¿é¡»ä½¿ç¨å° <jsp:text> å¨ä½åç´ ï¼å®ä¾å¦ä¸ï¼\n\n<jsp:text><![cdata[<!doctype html\npublic "-//w3c//dtd xhtml 1.0 strict//en"\n"dtd/xhtml1-strict.dtd">]]>\n</jsp:text>\n<head><title>jsp:text action</title></head>\n<body>\n\n<books><book><jsp:text>\n    welcome to jsp programming\n</jsp:text></book></books>\n\n</body>\n</html>\n\n\nä½ å¯ä»¥å¯¹ä»¥ä¸å®ä¾å°è¯ä½¿ç¨jsp:textåä¸ä½¿ç¨è¯¥å¨ä½åç´ æ§è¡ç»æçåºå«ã\n\n\n# jsp éå¼å¯¹è±¡\n\njsp éå¼å¯¹è±¡æ¯ jsp å®¹å¨ä¸ºæ¯ä¸ªé¡µé¢æä¾ç java å¯¹è±¡ï¼å¼åèå¯ä»¥ç´æ¥ä½¿ç¨å®ä»¬èä¸ç¨æ¾å¼å£°æãjsp éå¼å¯¹è±¡ä¹è¢«ç§°ä¸ºé¢å®ä¹åéã\n\njsp ææ¯æçä¹å¤§éå¼å¯¹è±¡ï¼\n\nå¯¹è±¡            æè¿°\nrequest       httpservletrequestç±»çå®ä¾\nresponse      httpservletresponseç±»çå®ä¾\nout           printwriterç±»çå®ä¾ï¼ç¨äºæç»æè¾åºè³ç½é¡µä¸\nsession       httpsessionç±»çå®ä¾\napplication   servletcontextç±»çå®ä¾ï¼ä¸åºç¨ä¸ä¸ææå³\nconfig        servletconfigç±»çå®ä¾\npagecontext   pagecontextç±»çå®ä¾ï¼æä¾å¯¹ jsp é¡µé¢ææå¯¹è±¡ä»¥åå½åç©ºé´çè®¿é®\npage          ç±»ä¼¼äº java ç±»ä¸­ç this å³é®å­\nexception     exceptionç±»çå¯¹è±¡ï¼ä»£è¡¨åçéè¯¯ç jsp é¡µé¢ä¸­å¯¹åºçå¼å¸¸å¯¹è±¡\n\n\n# request å¯¹è±¡\n\nrequestå¯¹è±¡æ¯javax.servlet.http.httpservletrequest ç±»çå®ä¾ã\n\næ¯å½å®¢æ·ç«¯è¯·æ±ä¸ä¸ª jsp é¡µé¢æ¶ï¼jsp å¼æå°±ä¼å¶é ä¸ä¸ªæ°çrequestå¯¹è±¡æ¥ä»£è¡¨è¿ä¸ªè¯·æ±ã\n\nrequestå¯¹è±¡æä¾äºä¸ç³»åæ¹æ³æ¥è·å http å¤´ä¿¡æ¯ï¼cookiesï¼http æ¹æ³ç­ç­ã\n\n\n# response å¯¹è±¡\n\nresponseå¯¹è±¡æ¯javax.servlet.http.httpservletresponseç±»çå®ä¾ã\n\nå½æå¡å¨åå»ºrequestå¯¹è±¡æ¶ä¼åæ¶åå»ºç¨äºååºè¿ä¸ªå®¢æ·ç«¯çresponseå¯¹è±¡ã\n\nresponseå¯¹è±¡ä¹å®ä¹äºå¤ç http å¤´æ¨¡åçæ¥å£ãéè¿è¿ä¸ªå¯¹è±¡ï¼å¼åèä»¬å¯ä»¥æ·»å æ°ç cookiesï¼æ¶é´æ³ï¼http ç¶æç ç­ç­ã\n\n\n# out å¯¹è±¡\n\noutå¯¹è±¡æ¯javax.servlet.jsp.jspwriterç±»çå®ä¾ï¼ç¨æ¥å¨responseå¯¹è±¡ä¸­åå¥åå®¹ã\n\næåçjspwriterç±»å¯¹è±¡æ ¹æ®é¡µé¢æ¯å¦æç¼å­æ¥è¿è¡ä¸åçå®ä¾åæä½ãå¯ä»¥å¨pageæä»¤ä¸­ä½¿ç¨buffered=\'false\'å±æ§æ¥è½»æ¾å³é­ç¼å­ã\n\njspwriterç±»åå«äºå¤§é¨åjava.io.printwriterç±»ä¸­çæ¹æ³ãä¸è¿ï¼jspwriteræ°å¢äºä¸äºä¸ä¸ºå¤çç¼å­èè®¾è®¡çæ¹æ³ãè¿æå°±æ¯ï¼jspwriterç±»ä¼æåºioexceptionså¼å¸¸ï¼èprintwriterä¸ä¼ã\n\nä¸è¡¨ååºäºæä»¬å°ä¼ç¨æ¥è¾åºbooleanï¼charï¼intï¼doubleï¼stringï¼objectç­ç±»åæ°æ®çéè¦æ¹æ³ï¼\n\næ¹æ³                         æè¿°\nout.print(datatype dt)     è¾åº type ç±»åçå¼\nout.println(datatype dt)   è¾åº type ç±»åçå¼ç¶åæ¢è¡\nout.flush()                å·æ°è¾åºæµ\n\n\n# session å¯¹è±¡\n\nsessionå¯¹è±¡æ¯javax.servlet.http.httpsessionç±»çå®ä¾ãå java servlets ä¸­çsessionå¯¹è±¡æä¸æ ·çè¡ä¸ºã\n\nsessionå¯¹è±¡ç¨æ¥è·è¸ªå¨åä¸ªå®¢æ·ç«¯è¯·æ±é´çä¼è¯ã\n\n\n# application å¯¹è±¡\n\napplicationå¯¹è±¡ç´æ¥åè£äº servlet çservletcontextç±»çå¯¹è±¡ï¼æ¯javax.servlet.servletcontextç±»çå®ä¾ã\n\nè¿ä¸ªå¯¹è±¡å¨ jsp é¡µé¢çæ´ä¸ªçå½å¨æä¸­é½ä»£è¡¨çè¿ä¸ª jsp é¡µé¢ãè¿ä¸ªå¯¹è±¡å¨ jsp é¡µé¢åå§åæ¶è¢«åå»ºï¼éçjspdestroy()æ¹æ³çè°ç¨èè¢«ç§»é¤ã\n\néè¿åapplicationä¸­æ·»å å±æ§ï¼åææç»ææ¨ web åºç¨ç jsp æä»¶é½è½è®¿é®å°è¿äºå±æ§ã\n\n\n# config å¯¹è±¡\n\nconfigå¯¹è±¡æ¯javax.servlet.servletconfigç±»çå®ä¾ï¼ç´æ¥åè£äº servlet çservletconfigç±»çå¯¹è±¡ã\n\nè¿ä¸ªå¯¹è±¡åè®¸å¼åèè®¿é® servlet æè jsp å¼æçåå§ååæ°ï¼æ¯å¦æä»¶è·¯å¾ç­ã\n\nä»¥ä¸æ¯ config å¯¹è±¡çä½¿ç¨æ¹æ³ï¼ä¸æ¯å¾éè¦ï¼æä»¥ä¸å¸¸ç¨ï¼\n\nconfig.getservletname();\n\n\nå®è¿ååå«å¨<servlet-name>åç´ ä¸­ç servlet åå­ï¼æ³¨æï¼<servlet-name>åç´ å¨web-inf\\web.xmlæä»¶ä¸­å®ä¹ã\n\n\n# pagecontext å¯¹è±¡\n\npagecontextå¯¹è±¡æ¯javax.servlet.jsp.pagecontextç±»çå®ä¾ï¼ç¨æ¥ä»£è¡¨æ´ä¸ª jsp é¡µé¢ã\n\nè¿ä¸ªå¯¹è±¡ä¸»è¦ç¨æ¥è®¿é®é¡µé¢ä¿¡æ¯ï¼åæ¶è¿æ»¤æå¤§é¨åå®ç°ç»èã\n\nè¿ä¸ªå¯¹è±¡å­å¨äºrequestå¯¹è±¡åresponseå¯¹è±¡çå¼ç¨ãapplicationå¯¹è±¡ï¼configå¯¹è±¡ï¼sessionå¯¹è±¡ï¼outå¯¹è±¡å¯ä»¥éè¿è®¿é®è¿ä¸ªå¯¹è±¡çå±æ§æ¥å¯¼åºã\n\npagecontextå¯¹è±¡ä¹åå«äºä¼ ç» jsp é¡µé¢çæä»¤ä¿¡æ¯ï¼åæ¬ç¼å­ä¿¡æ¯ï¼errorpage url,é¡µé¢ scope ç­ã\n\npagecontextç±»å®ä¹äºä¸äºå­æ®µï¼åæ¬ page_scopeï¼request_scopeï¼session_scopeï¼ application_scopeãå®ä¹æä¾äº 40 ä½ç§æ¹æ³ï¼æä¸åç»§æ¿èªjavax.servlet.jsp.jspcontext ç±»ã\n\nå¶ä¸­ä¸ä¸ªéè¦çæ¹æ³å°±æ¯removearribute()ï¼å®å¯æ¥åä¸ä¸ªæä¸¤ä¸ªåæ°ãæ¯å¦ï¼pagecontext.removearribute("attrname")ç§»é¤åä¸ª scope ä¸­ç¸å³å±æ§ï¼ä½æ¯ä¸é¢è¿ç§æ¹æ³åªç§»é¤ç¹å® scope ä¸­çç¸å³å±æ§ï¼\n\npagecontext.removeattribute("attrname", page_scope);\n\n\n\n# page å¯¹è±¡\n\nè¿ä¸ªå¯¹è±¡å°±æ¯é¡µé¢å®ä¾çå¼ç¨ãå®å¯ä»¥è¢«çåæ¯æ´ä¸ª jsp é¡µé¢çä»£è¡¨ã\n\npageå¯¹è±¡å°±æ¯thiså¯¹è±¡çåä¹è¯ã\n\n\n# exception å¯¹è±¡\n\nexceptionå¯¹è±¡åè£äºä»ååé¡µé¢ä¸­æåºçå¼å¸¸ä¿¡æ¯ãå®éå¸¸è¢«ç¨æ¥äº§çå¯¹åºéæ¡ä»¶çéå½ååºã\n\n\n# el è¡¨è¾¾å¼\n\nel è¡¨è¾¾å¼æ¯ç¨${}æ¬èµ·æ¥çèæ¬ï¼ç¨æ¥æ´æ¹ä¾¿å°è¯»åå¯¹è±¡ãel è¡¨è¾¾å¼åå¨ jsp ç html ä»£ç ä¸­ï¼èä¸è½åå¨<%ä¸%>å¼èµ·ç jsp èæ¬ä¸­ã\n\njsp è¡¨è¾¾å¼è¯­è¨ï¼elï¼ä½¿å¾è®¿é®å­å¨å¨ javabean ä¸­çæ°æ®åå¾éå¸¸ç®åãjsp el æ¢å¯ä»¥ç¨æ¥åå»ºç®æ¯è¡¨è¾¾å¼ä¹å¯ä»¥ç¨æ¥åå»ºé»è¾è¡¨è¾¾å¼ãå¨ jsp el è¡¨è¾¾å¼åå¯ä»¥ä½¿ç¨æ´åæ°ï¼æµ®ç¹æ°ï¼å­ç¬¦ä¸²ï¼å¸¸é trueãfalseï¼è¿æ nullã\n\n\n# ä¸ä¸ªç®åçè¯­æ³\n\nå¸åçï¼å½æ¨éè¦å¨ jsp æ ç­¾ä¸­æå®ä¸ä¸ªå±æ§å¼æ¶ï¼åªéè¦ç®åå°ä½¿ç¨å­ç¬¦ä¸²å³å¯ï¼\n\n<jsp:setproperty name="box" property="perimeter" value="100" />\n\n\njsp el åè®¸æ¨æå®ä¸ä¸ªè¡¨è¾¾å¼æ¥è¡¨ç¤ºå±æ§å¼ãä¸ä¸ªç®åçè¡¨è¾¾å¼è¯­æ³å¦ä¸ï¼\n\n${expr}\n\n\nå¶ä¸­ï¼expr æçæ¯è¡¨è¾¾å¼ãå¨ jsp el ä¸­éç¨çæä½ç¬¦æ¯"."å"[]"ãè¿ä¸¤ä¸ªæä½ç¬¦åè®¸æ¨éè¿ååµç jsp å¯¹è±¡è®¿é®åç§åæ ·ç javabean å±æ§ã\n\nä¸¾ä¾æ¥è¯´ï¼ä¸é¢ç <jsp:setproperty> æ ç­¾å¯ä»¥ä½¿ç¨è¡¨è¾¾å¼è¯­è¨æ¹åæå¦ä¸å½¢å¼ï¼\n\n<jsp:setproperty\n  name="box"\n  property="perimeter"\n  value="${2*box.width+2*box.height}"\n/>\n\n\nå½ jsp ç¼è¯å¨å¨å±æ§ä¸­è§å°"${}"æ ¼å¼åï¼å®ä¼äº§çä»£ç æ¥è®¡ç®è¿ä¸ªè¡¨è¾¾å¼ï¼å¹¶ä¸äº§çä¸ä¸ªæ¿ä»£åæ¥ä»£æ¿è¡¨è¾¾å¼çå¼ã\n\næ¨ä¹å¯ä»¥å¨æ ç­¾çæ¨¡æ¿ææ¬ä¸­ä½¿ç¨è¡¨è¾¾å¼è¯­è¨ãæ¯å¦ <jsp:text> æ ç­¾ç®åå°å°å¶ä¸»ä½ä¸­çææ¬æå¥å° jsp è¾åºä¸­ï¼\n\n<jsp:text>\n  <h1>hello jsp!</h1>\n</jsp:text>\n\n\nç°å¨ï¼å¨jsp:textæ ç­¾ä¸»ä½ä¸­ä½¿ç¨è¡¨è¾¾å¼ï¼å°±åè¿æ ·ï¼\n\n<jsp:text>\n  box perimeter is: ${2*box.width + 2*box.height}\n</jsp:text>\n\n\nå¨ el è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç¨åæ¬å·æ¥ç»ç»å­è¡¨è¾¾å¼ãæ¯å¦ ${(1 + 2) _ 3} ç­äº 9ï¼ä½æ¯ ${1 + (2 _ 3)} ç­äº 7ã\n\næ³è¦åç¨å¯¹ el è¡¨è¾¾å¼çè¯ä¼°çè¯ï¼éè¦ä½¿ç¨ page æä»¤å° iselignored å±æ§å¼è®¾ä¸º trueï¼\n\n<%@ page iselignored ="true|false" %>\n\n\nè¿æ ·ï¼el è¡¨è¾¾å¼å°±ä¼è¢«å¿½ç¥ãè¥è®¾ä¸º falseï¼åå®¹å¨å°ä¼è®¡ç® el è¡¨è¾¾å¼ã\n\n\n# el ä¸­çåºç¡æä½ç¬¦\n\nel è¡¨è¾¾å¼æ¯æå¤§é¨å java ææä¾çç®æ¯åé»è¾æä½ç¬¦ï¼\n\næä½ç¬¦         æè¿°\n.           è®¿é®ä¸ä¸ª bean å±æ§æèä¸ä¸ªæ å°æ¡ç®\n[]          è®¿é®ä¸ä¸ªæ°ç»æèé¾è¡¨çåç´ \n( )         ç»ç»ä¸ä¸ªå­è¡¨è¾¾å¼ä»¥æ¹åä¼åçº§\n+           å \n-           åæè´\n*           ä¹\n/ or div    é¤\n% or mod    åæ¨¡\n== or eq    æµè¯æ¯å¦ç¸ç­\n!= or ne    æµè¯æ¯å¦ä¸ç­\n< or lt     æµè¯æ¯å¦å°äº\n> or gt     æµè¯æ¯å¦å¤§äº\n<= or le    æµè¯æ¯å¦å°äºç­äº\n>= or ge    æµè¯æ¯å¦å¤§äºç­äº\n&& or and   æµè¯é»è¾ä¸\n|| or or    æµè¯é»è¾æ\n! or not    æµè¯åå\nempty       æµè¯æ¯å¦ç©ºå¼\n\n\n# jsp el ä¸­çå½æ°\n\njsp el åè®¸æ¨å¨è¡¨è¾¾å¼ä¸­ä½¿ç¨å½æ°ãè¿äºå½æ°å¿é¡»è¢«å®ä¹å¨èªå®ä¹æ ç­¾åºä¸­ãå½æ°çä½¿ç¨è¯­æ³å¦ä¸ï¼\n\n${ns:func(param1, param2, ...)}\n\n\nns æçæ¯å½åç©ºé´ï¼namespaceï¼ï¼func æçæ¯å½æ°çåç§°ï¼param1 æçæ¯ç¬¬ä¸ä¸ªåæ°ï¼param2 æçæ¯ç¬¬äºä¸ªåæ°ï¼ä»¥æ­¤ç±»æ¨ãæ¯å¦ï¼æå½æ° fn:lengthï¼å¨ jstl åºä¸­å®ä¹ï¼å¯ä»¥åä¸é¢è¿æ ·æ¥è·åä¸ä¸ªå­ç¬¦ä¸²çé¿åº¦ï¼\n\n${fn:length("get my length")}\n\n\nè¦ä½¿ç¨ä»»ä½æ ç­¾åºä¸­çå½æ°ï¼æ¨éè¦å°è¿äºåºå®è£å¨æå¡å¨ä¸­ï¼ç¶åä½¿ç¨ <taglib> æ ç­¾å¨ jsp æä»¶ä¸­åå«è¿äºåºã\n\n\n# jsp el éå«å¯¹è±¡\n\njsp el æ¯æä¸è¡¨ååºçéå«å¯¹è±¡ï¼\n\néå«å¯¹è±¡               æè¿°\npagescope          page ä½ç¨å\nrequestscope       request ä½ç¨å\nsessionscope       session ä½ç¨å\napplicationscope   application ä½ç¨å\nparam              request å¯¹è±¡çåæ°ï¼å­ç¬¦ä¸²\nparamvalues        request å¯¹è±¡çåæ°ï¼å­ç¬¦ä¸²éå\nheader             http ä¿¡æ¯å¤´ï¼å­ç¬¦ä¸²\nheadervalues       http ä¿¡æ¯å¤´ï¼å­ç¬¦ä¸²éå\ninitparam          ä¸ä¸æåå§ååæ°\ncookie             cookie å¼\npagecontext        å½åé¡µé¢ç pagecontext\n\næ¨å¯ä»¥å¨è¡¨è¾¾å¼ä¸­ä½¿ç¨è¿äºå¯¹è±¡ï¼å°±åä½¿ç¨åéä¸æ ·ãæ¥ä¸æ¥ä¼ç»åºå ä¸ªä¾å­æ¥æ´å¥½ççè§£è¿ä¸ªæ¦å¿µã\n\n\n# pagecontext å¯¹è±¡\n\npagecontext å¯¹è±¡æ¯ jsp ä¸­ pagecontext å¯¹è±¡çå¼ç¨ãéè¿ pagecontext å¯¹è±¡ï¼æ¨å¯ä»¥è®¿é® request å¯¹è±¡ãæ¯å¦ï¼è®¿é® request å¯¹è±¡ä¼ å¥çæ¥è¯¢å­ç¬¦ä¸²ï¼å°±åè¿æ ·ï¼\n\n${pagecontext.request.querystring}\n\n\n\n# scope å¯¹è±¡\n\npagescopeï¼requestscopeï¼sessionscopeï¼applicationscope åéç¨æ¥è®¿é®å­å¨å¨åä¸ªä½ç¨åå±æ¬¡çåéã\n\nä¸¾ä¾æ¥è¯´ï¼å¦ææ¨éè¦æ¾å¼è®¿é®å¨ applicationscope å±ç box åéï¼å¯ä»¥è¿æ ·æ¥è®¿é®ï¼applicationscope.boxã\n\n\n# param å paramvalues å¯¹è±¡\n\nparam å paramvalues å¯¹è±¡ç¨æ¥è®¿é®åæ°å¼ï¼éè¿ä½¿ç¨ request.getparameter æ¹æ³å request.getparametervalues æ¹æ³ã\n\nä¸¾ä¾æ¥è¯´ï¼è®¿é®ä¸ä¸ªåä¸º order çåæ°ï¼å¯ä»¥è¿æ ·ä½¿ç¨è¡¨è¾¾å¼ï¼${param.order}ï¼æè${param["order"]}ã\n\næ¥ä¸æ¥çä¾å­è¡¨æäºå¦ä½è®¿é® request ä¸­ç username åæ°ï¼\n\n<%@ page import="java.io.*,java.util.*" %> <% string title = "accessing request\nparam"; %>\n<html>\n  <head>\n    <title><% out.print(title); %></title>\n  </head>\n  <body>\n    <center>\n      <h1><% out.print(title); %></h1>\n    </center>\n    <div align="center">\n      <p>${param["username"]}</p>\n    </div>\n  </body>\n</html>\n\n\nparam å¯¹è±¡è¿ååä¸çå­ç¬¦ä¸²ï¼è paramvalues å¯¹è±¡åè¿åä¸ä¸ªå­ç¬¦ä¸²æ°ç»ã\n\n\n# header å headervalues å¯¹è±¡\n\nheader å headervalues å¯¹è±¡ç¨æ¥è®¿é®ä¿¡æ¯å¤´ï¼éè¿ä½¿ç¨ request.getheader æ¹æ³å request.getheaders æ¹æ³ã\n\nä¸¾ä¾æ¥è¯´ï¼è¦è®¿é®ä¸ä¸ªåä¸º user-agent çä¿¡æ¯å¤´ï¼å¯ä»¥è¿æ ·ä½¿ç¨è¡¨è¾¾å¼ï¼${header.user-agent}ï¼æè ${header["user-agent"]}ã\n\næ¥ä¸æ¥çä¾å­è¡¨æäºå¦ä½è®¿é® user-agent ä¿¡æ¯å¤´ï¼\n\n<%@ page import="java.io.*,java.util.*" %> <% string title = "user agent\nexample"; %>\n<html>\n  <head>\n    <title><% out.print(title); %></title>\n  </head>\n  <body>\n    <center>\n      <h1><% out.print(title); %></h1>\n    </center>\n    <div align="center">\n      <p>${header["user-agent"]}</p>\n    </div>\n  </body>\n</html>\n\n\nè¿è¡ç»æå¦ä¸ï¼\n\n\n\nheader å¯¹è±¡è¿ååä¸å¼ï¼è headervalues åè¿åä¸ä¸ªå­ç¬¦ä¸²æ°ç»ã\n\n\n# jstl\n\njsp æ åæ ç­¾åºï¼jstlï¼æ¯ä¸ä¸ª jsp æ ç­¾éåï¼å®å°è£äº jsp åºç¨çéç¨æ ¸å¿åè½ã\n\njstl æ¯æéç¨çãç»æåçä»»å¡ï¼æ¯å¦è¿­ä»£ï¼æ¡ä»¶å¤æ­ï¼xml ææ¡£æä½ï¼å½éåæ ç­¾ï¼sql æ ç­¾ã é¤äºè¿äºï¼å®è¿æä¾äºä¸ä¸ªæ¡æ¶æ¥ä½¿ç¨éæ jstl çèªå®ä¹æ ç­¾ã\n\næ ¹æ® jstl æ ç­¾ææä¾çåè½ï¼å¯ä»¥å°å¶åä¸º 5 ä¸ªç±»å«ã\n\n * æ ¸å¿æ ç­¾\n * æ ¼å¼åæ ç­¾\n * sql æ ç­¾\n * xml æ ç­¾\n * jstl å½æ°\n\n\n# jstl åºå®è£\n\napache tomcat å®è£ jstl åºæ­¥éª¤å¦ä¸ï¼\n\nä» apache çæ åæ ç­¾åºä¸­ä¸è½½çäºè¿å(jakarta-taglibs-standard-current.zip)ã\n\n * å®æ¹ä¸è½½å°åï¼http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/\n * æ¬ç«ä¸è½½å°åï¼jakarta-taglibs-standard-1.1.2.zip\n\nä¸è½½ jakarta-taglibs-standard-1.1.2.zip åå¹¶è§£åï¼å° jakarta-taglibs-standard-1.1.2/lib/ ä¸çä¸¤ä¸ª jar æä»¶ï¼standard.jar å jstl.jar æä»¶æ·è´å° /web-inf/lib/ ä¸ã\n\nå° tld ä¸çéè¦å¼å¥ç tld æä»¶å¤å¶å° web-inf ç®å½ä¸ã\n\næ¥ä¸æ¥æä»¬å¨ web.xml æä»¶ä¸­æ·»å ä»¥ä¸éç½®ï¼\n\n<?xml version="1.0" encoding="utf-8"?>\n<web-app\n  version="2.4"\n  xmlns="http://java.sun.com/xml/ns/j2ee"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://java.sun.com/xml/ns/j2ee\n        http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"\n>\n  <jsp-config>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/fmt</taglib-uri>\n      <taglib-location>/web-inf/fmt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/fmt-rt</taglib-uri>\n      <taglib-location>/web-inf/fmt-rt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/core</taglib-uri>\n      <taglib-location>/web-inf/c.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/core-rt</taglib-uri>\n      <taglib-location>/web-inf/c-rt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/sql</taglib-uri>\n      <taglib-location>/web-inf/sql.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/sql-rt</taglib-uri>\n      <taglib-location>/web-inf/sql-rt.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/x</taglib-uri>\n      <taglib-location>/web-inf/x.tld</taglib-location>\n    </taglib>\n    <taglib>\n      <taglib-uri>http://java.sun.com/jsp/jstl/x-rt</taglib-uri>\n      <taglib-location>/web-inf/x-rt.tld</taglib-location>\n    </taglib>\n  </jsp-config>\n</web-app>\n\n\nä½¿ç¨ä»»ä½åºï¼ä½ å¿é¡»å¨æ¯ä¸ª jsp æä»¶ä¸­çå¤´é¨åå« æ ç­¾ã\n\n\n# æ ¸å¿æ ç­¾\n\næ ¸å¿æ ç­¾æ¯æå¸¸ç¨ç jstl æ ç­¾ãå¼ç¨æ ¸å¿æ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>\n\n\næ ç­¾              æè¿°\n<c:out>         ç¨äºå¨ jsp ä¸­æ¾ç¤ºæ°æ®ï¼å°±å<%= ... >\n<c:set>         ç¨äºä¿å­æ°æ®\n<c:remove>      ç¨äºå é¤æ°æ®\n<c:catch>       ç¨æ¥å¤çäº§çéè¯¯çå¼å¸¸ç¶åµï¼å¹¶ä¸å°éè¯¯ä¿¡æ¯å¨å­èµ·æ¥\n<c:if>          ä¸æä»¬å¨ä¸è¬ç¨åºä¸­ç¨ç if ä¸æ ·\n<c:choose>      æ¬èº«åªå½å<c:when>å<c:otherwise>çç¶æ ç­¾\n<c:when>        <c:choose>çå­æ ç­¾ï¼ç¨æ¥å¤æ­æ¡ä»¶æ¯å¦æç«\n<c:otherwise>   <c:choose>çå­æ ç­¾ï¼æ¥å¨<c:when>æ ç­¾åï¼å½<c:when>æ ç­¾å¤æ­ä¸º false æ¶è¢«æ§è¡\n<c:import>      æ£ç´¢ä¸ä¸ªç»å¯¹æç¸å¯¹ urlï¼ç¶åå°å¶åå®¹æ´é²ç»é¡µé¢\n<c:foreach>     åºç¡è¿­ä»£æ ç­¾ï¼æ¥åå¤ç§éåç±»å\n<c:fortokens>   æ ¹æ®æå®çåéç¬¦æ¥åéåå®¹å¹¶è¿­ä»£è¾åº\n<c:param>       ç¨æ¥ç»åå«æéå®åçé¡µé¢ä¼ éåæ°\n<c:redirect>    éå®åè³ä¸ä¸ªæ°ç url.\n<c:url>         ä½¿ç¨å¯éçæ¥è¯¢åæ°æ¥åé ä¸ä¸ª url\n\n\n# æ ¼å¼åæ ç­¾\n\njstl æ ¼å¼åæ ç­¾ç¨æ¥æ ¼å¼åå¹¶è¾åºææ¬ãæ¥æãæ¶é´ãæ°å­ãå¼ç¨æ ¼å¼åæ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>\n\n\næ ç­¾                      æè¿°\n<fmt:formatnumber>      ä½¿ç¨æå®çæ ¼å¼æç²¾åº¦æ ¼å¼åæ°å­\n<fmt:parsenumber>       è§£æä¸ä¸ªä»£è¡¨çæ°å­ï¼è´§å¸æç¾åæ¯çå­ç¬¦ä¸²\n<fmt:formatdate>        ä½¿ç¨æå®çé£æ ¼ææ¨¡å¼æ ¼å¼åæ¥æåæ¶é´\n<fmt:parsedate>         è§£æä¸ä¸ªä»£è¡¨çæ¥æææ¶é´çå­ç¬¦ä¸²\n<fmt:bundle>            ç»å®èµæº\n<fmt:setlocale>         æå®å°åº\n<fmt:setbundle>         ç»å®èµæº\n<fmt:timezone>          æå®æ¶åº\n<fmt:settimezone>       æå®æ¶åº\n<fmt:message>           æ¾ç¤ºèµæºéç½®æä»¶ä¿¡æ¯\n<fmt:requestencoding>   è®¾ç½® request çå­ç¬¦ç¼ç \n\n\n# sql æ ç­¾\n\njstl sql æ ç­¾åºæä¾äºä¸å³ç³»åæ°æ®åºï¼oracleï¼mysqlï¼sql server ç­ç­ï¼è¿è¡äº¤äºçæ ç­¾ãå¼ç¨ sql æ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="sql" uri="http://java.sun.com/jsp/jstl/sql" %>\n\n\næ ç­¾                    æè¿°\n<sql:setdatasource>   æå®æ°æ®æº\n<sql:query>           è¿è¡ sql æ¥è¯¢è¯­å¥\n<sql:update>          è¿è¡ sql æ´æ°è¯­å¥\n<sql:param>           å° sql è¯­å¥ä¸­çåæ°è®¾ä¸ºæå®å¼\n<sql:dateparam>       å° sql è¯­å¥ä¸­çæ¥æåæ°è®¾ä¸ºæå®ç java.util.date å¯¹è±¡å¼\n<sql:transaction>     å¨å±äº«æ°æ®åºè¿æ¥ä¸­æä¾åµå¥çæ°æ®åºè¡ä¸ºåç´ ï¼å°ææè¯­å¥ä»¥ä¸ä¸ªäºå¡çå½¢å¼æ¥è¿è¡\n\n\n# xml æ ç­¾\n\njstl xml æ ç­¾åºæä¾äºåå»ºåæä½ xml ææ¡£çæ ç­¾ãå¼ç¨ xml æ ç­¾åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="x" uri="http://java.sun.com/jsp/jstl/xml" %>\n\n\nå¨ä½¿ç¨ xml æ ç­¾åï¼ä½ å¿é¡»å° xml å xpath çç¸å³åæ·è´è³ä½ ç <tomcat å®è£ç®å½>\\lib ä¸:\n\n * xercesimpl.jar\n   \n   ä¸è½½å°åï¼ http://www.apache.org/dist/xerces/j/\n\n * xalan.jar\n   \n   ä¸è½½å°åï¼ http://xml.apache.org/xalan-j/index.html\n\næ ç­¾              æè¿°\n<x:out>         ä¸<%= ... >,ç±»ä¼¼ï¼ä¸è¿åªç¨äº xpath è¡¨è¾¾å¼\n<x:parse>       è§£æ xml æ°æ®\n<x:set>         è®¾ç½® xpath è¡¨è¾¾å¼\n<x:if>          å¤æ­ xpath è¡¨è¾¾å¼ï¼è¥ä¸ºçï¼åæ§è¡æ¬ä½ä¸­çåå®¹ï¼å¦åè·³è¿æ¬ä½\n<x:foreach>     è¿­ä»£ xml ææ¡£ä¸­çèç¹\n<x:choose>      <x:when>å<x:otherwise>çç¶æ ç­¾\n<x:when>        <x:choose>çå­æ ç­¾ï¼ç¨æ¥è¿è¡æ¡ä»¶å¤æ­\n<x:otherwise>   <x:choose>çå­æ ç­¾ï¼å½<x:when>å¤æ­ä¸º false æ¶è¢«æ§è¡\n<x:transform>   å° xsl è½¬æ¢åºç¨å¨ xml ææ¡£ä¸­\n<x:param>       ä¸<x:transform>å±åä½¿ç¨ï¼ç¨äºè®¾ç½® xsl æ ·å¼è¡¨\n\n\n# jstl å½æ°\n\njstl åå«ä¸ç³»åæ åå½æ°ï¼å¤§é¨åæ¯éç¨çå­ç¬¦ä¸²å¤çå½æ°ãå¼ç¨ jstl å½æ°åºçè¯­æ³å¦ä¸ï¼\n\n<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>\n\n\nå½æ°                        æè¿°\nfn:contains()             æµè¯è¾å¥çå­ç¬¦ä¸²æ¯å¦åå«æå®çå­ä¸²\nfn:containsignorecase()   æµè¯è¾å¥çå­ç¬¦ä¸²æ¯å¦åå«æå®çå­ä¸²ï¼å¤§å°åä¸ææ\nfn:endswith()             æµè¯è¾å¥çå­ç¬¦ä¸²æ¯å¦ä»¥æå®çåç¼ç»å°¾\nfn:escapexml()            è·³è¿å¯ä»¥ä½ä¸º xml æ è®°çå­ç¬¦\nfn:indexof()              è¿åæå®å­ç¬¦ä¸²å¨è¾å¥å­ç¬¦ä¸²ä¸­åºç°çä½ç½®\nfn:join()                 å°æ°ç»ä¸­çåç´ åæä¸ä¸ªå­ç¬¦ä¸²ç¶åè¾åº\nfn:length()               è¿åå­ç¬¦ä¸²é¿åº¦\nfn:replace()              å°è¾å¥å­ç¬¦ä¸²ä¸­æå®çä½ç½®æ¿æ¢ä¸ºæå®çå­ç¬¦ä¸²ç¶åè¿å\nfn:split()                å°å­ç¬¦ä¸²ç¨æå®çåéç¬¦åéç¶åç»æä¸ä¸ªå­å­ç¬¦ä¸²æ°ç»å¹¶è¿å\nfn:startswith()           æµè¯è¾å¥å­ç¬¦ä¸²æ¯å¦ä»¥æå®çåç¼å¼å§\nfn:substring()            è¿åå­ç¬¦ä¸²çå­é\nfn:substringafter()       è¿åå­ç¬¦ä¸²å¨æå®å­ä¸²ä¹åçå­é\nfn:substringbefore()      è¿åå­ç¬¦ä¸²å¨æå®å­ä¸²ä¹åçå­é\nfn:tolowercase()          å°å­ç¬¦ä¸²ä¸­çå­ç¬¦è½¬ä¸ºå°å\nfn:touppercase()          å°å­ç¬¦ä¸²ä¸­çå­ç¬¦è½¬ä¸ºå¤§å\nfn:trim()                 ç§»é¤é¦å°¾çç©ºç½ç¬¦\n\n\n# taglib\n\n\n# jsp èªå®ä¹æ ç­¾\n\nèªå®ä¹æ ç­¾æ¯ç¨æ·å®ä¹ç jsp è¯­è¨åç´ ãå½ jsp é¡µé¢åå«ä¸ä¸ªèªå®ä¹æ ç­¾æ¶å°è¢«è½¬åä¸º servletï¼æ ç­¾è½¬åä¸ºå¯¹è¢« ç§°ä¸º tag handler çå¯¹è±¡çæä½ï¼å³å½ servlet æ§è¡æ¶ web container è°ç¨é£äºæä½ã\n\njsp æ ç­¾æ©å±å¯ä»¥è®©ä½ åå»ºæ°çæ ç­¾å¹¶ä¸å¯ä»¥ç´æ¥æå¥å°ä¸ä¸ª jsp é¡µé¢ã jsp 2.0 è§èä¸­å¼å¥ simple tag handlers æ¥ç¼åè¿äºèªå®ä¹æ è®°ã\n\nä½ å¯ä»¥ç»§æ¿ simpletagsupport ç±»å¹¶éåç dotag()æ¹æ³æ¥å¼åä¸ä¸ªæç®åçèªå®ä¹æ ç­¾ã\n\n\n# åå»º"hello"æ ç­¾\n\næ¥ä¸æ¥ï¼æä»¬æ³åå»ºä¸ä¸ªèªå®ä¹æ ç­¾å«ä½ex:helloï¼æ ç­¾æ ¼å¼ä¸ºï¼\n\n<ex:hello />\n\n\nè¦åå»ºèªå®ä¹ç jsp æ ç­¾ï¼ä½ é¦åå¿é¡»åå»ºå¤çæ ç­¾ç java ç±»ãæä»¥ï¼è®©æä»¬åå»ºä¸ä¸ª hellotag ç±»ï¼å¦ä¸æç¤ºï¼\n\npackage com.runoob; import javax.servlet.jsp.tagext.*; import\njavax.servlet.jsp.*; import java.io.*; public class hellotag extends\nsimpletagsupport { public void dotag() throws jspexception, ioexception {\njspwriter out = getjspcontext().getout(); out.println("hello custom tag!"); } }\n\n\nä»¥ä¸ä»£ç éåäº dotag()æ¹æ³ï¼æ¹æ³ä¸­ä½¿ç¨äº getjspcontext()æ¹æ³æ¥è·åå½åç jspcontext å¯¹è±¡ï¼å¹¶å°"hello custom tag!"ä¼ éç» jspwriter å¯¹è±¡ã\n\nç¼è¯ä»¥ä¸ç±»ï¼å¹¶å°å¶å¤å¶å°ç¯å¢åé classpath ç®å½ä¸­ãæååå»ºå¦ä¸æ ç­¾åºï¼<tomcatå®è£ç®å½>webapps\\root\\web-inf\\custom.tldã\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <jsp-version>2.0</jsp-version>\n  <short-name>example tld</short-name>\n  <tag>\n    <name>hello</name>\n    <tag-class>com.runoob.hellotag</tag-class>\n    <body-content>empty</body-content>\n  </tag>\n</taglib>\n\n\næ¥ä¸æ¥ï¼æä»¬å°±å¯ä»¥å¨ jsp æä»¶ä¸­ä½¿ç¨ hello æ ç­¾ï¼\n\n<%@ taglib prefix="ex" uri="web-inf/custom.tld"%>\n<html>\n  <head>\n    <title>a sample custom tag</title>\n  </head>\n  <body>\n    <ex:hello />\n  </body>\n</html>\n\n\nä»¥ä¸ç¨åºè¾åºç»æä¸ºï¼\n\nhello custom tag!\n\n\n\n# è®¿é®æ ç­¾ä½\n\nä½ å¯ä»¥åæ åæ ç­¾åºä¸æ ·å¨æ ç­¾ä¸­åå«æ¶æ¯åå®¹ãå¦æä»¬è¦å¨æä»¬èªå®ä¹ç hello ä¸­åå«åå®¹ï¼æ ¼å¼å¦ä¸ï¼\n\n<ex:hello>\n  this is message body\n</ex:hello>\n\n\næä»¬å¯ä»¥ä¿®æ¹æ ç­¾å¤çç±»æä»¶ï¼ä»£ç å¦ä¸ï¼\n\npackage com.runoob;\n\nimport javax.servlet.jsp.tagext.*;\nimport javax.servlet.jsp.*;\nimport java.io.*;\n\npublic class hellotag extends simpletagsupport {\n\n   stringwriter sw = new stringwriter();\n   public void dotag()\n      throws jspexception, ioexception\n    {\n       getjspbody().invoke(sw);\n       getjspcontext().getout().println(sw.tostring());\n    }\n\n}\n\n\næ¥ä¸æ¥æä»¬éè¦ä¿®æ¹ tld æä»¶ï¼å¦ä¸æç¤ºï¼\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <jsp-version>2.0</jsp-version>\n  <short-name>example tld with body</short-name>\n  <tag>\n    <name>hello</name>\n    <tag-class>com.runoob.hellotag</tag-class>\n    <body-content>scriptless</body-content>\n  </tag>\n</taglib>\n\n\nç°å¨æä»¬å¯ä»¥å¨ jsp ä½¿ç¨ä¿®æ¹åçæ ç­¾ï¼å¦ä¸æç¤º:\n\n<%@ taglib prefix="ex" uri="web-inf/custom.tld"%>\n<html>\n  <head>\n    <title>a sample custom tag</title>\n  </head>\n  <body>\n    <ex:hello>\n      this is message body\n    </ex:hello>\n  </body>\n</html>\n\n\nä»¥ä¸ç¨åºè¾åºç»æå¦ä¸æç¤ºï¼\n\nthis is message body\n\n\n\n# èªå®ä¹æ ç­¾å±æ§\n\nä½ å¯ä»¥å¨èªå®ä¹æ åä¸­è®¾ç½®åç§å±æ§ï¼è¦æ¥æ¶å±æ§ï¼å¼èªå®ä¹æ ç­¾ç±»å¿é¡»å®ç° setter æ¹æ³ï¼ javabean ä¸­ç setter æ¹æ³å¦ä¸æç¤ºï¼\n\npackage com.runoob;\n\nimport javax.servlet.jsp.tagext.*;\nimport javax.servlet.jsp.*;\nimport java.io.*;\n\npublic class hellotag extends simpletagsupport {\n\n   private string message;\n\n   public void setmessage(string msg) {\n      this.message = msg;\n   }\n\n   stringwriter sw = new stringwriter();\n\n   public void dotag()\n      throws jspexception, ioexception\n    {\n       if (message != null) {\n          /* ä»å±æ§ä¸­ä½¿ç¨æ¶æ¯ */\n          jspwriter out = getjspcontext().getout();\n          out.println( message );\n       }\n       else {\n          /* ä»åå®¹ä½ä¸­ä½¿ç¨æ¶æ¯ */\n          getjspbody().invoke(sw);\n          getjspcontext().getout().println(sw.tostring());\n       }\n   }\n\n}\n\n\nå±æ§çåç§°æ¯"message"ï¼æä»¥ setter æ¹æ³æ¯ç setmessage()ãç°å¨è®©æä»¬å¨ tld æä»¶ä¸­ä½¿ç¨çåç´ æ·»å æ­¤å±æ§ï¼\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <jsp-version>2.0</jsp-version>\n  <short-name>example tld with body</short-name>\n  <tag>\n    <name>hello</name>\n    <tag-class>com.runoob.hellotag</tag-class>\n    <body-content>scriptless</body-content>\n    <attribute>\n      <name>message</name>\n    </attribute>\n  </tag>\n</taglib>\n\n\nç°å¨æä»¬å°±å¯ä»¥å¨ jsp æä»¶ä¸­ä½¿ç¨ message å±æ§äºï¼å¦ä¸æç¤ºï¼\n\n<%@ taglib prefix="ex" uri="web-inf/custom.tld"%>\n<html>\n  <head>\n    <title>a sample custom tag</title>\n  </head>\n  <body>\n    <ex:hello message="this is custom tag" />\n  </body>\n</html>\n\n\nä»¥ä¸å®ä¾æ°æ®è¾åºç»æä¸ºï¼\n\nthis is custom tag\n\n\nä½ è¿å¯ä»¥åå«ä»¥ä¸å±æ§ï¼\n\nå±æ§            æè¿°\nname          å®ä¹å±æ§çåç§°ãæ¯ä¸ªæ ç­¾çæ¯å±æ§åç§°å¿é¡»æ¯å¯ä¸çã\nrequired      æå®å±æ§æ¯å¦æ¯å¿é¡»çæèå¯éç,å¦æè®¾ç½®ä¸º false ä¸ºå¯éã\nrtexprvalue   å£°æå¨è¿è¡è¡¨è¾¾å¼æ¶ï¼æ ç­¾å±æ§æ¯å¦ææã\ntype          å®ä¹è¯¥å±æ§ç java ç±»ç±»å ãé»è®¤æå®ä¸º string\ndescription   æè¿°ä¿¡æ¯\nfragment      å¦æå£°æäºè¯¥å±æ§,å±æ§å¼å°è¢«è§ä¸ºä¸ä¸ª jspfragmentã\n\nä»¥ä¸æ¯æå®ç¸å³çå±æ§å®ä¾ï¼\n\n.....\n<attribute>\n  <name>attribute_name</name>\n  <required>false</required>\n  <type>java.util.date</type>\n  <fragment>false</fragment>\n</attribute>\n.....\n\n\nå¦æä½ ä½¿ç¨äºä¸¤ä¸ªå±æ§ï¼ä¿®æ¹ tld æä»¶ï¼å¦ä¸æç¤ºï¼\n\n.....\n<attribute>\n  <name>attribute_name1</name>\n  <required>false</required>\n  <type>java.util.boolean</type>\n  <fragment>false</fragment>\n</attribute>\n<attribute>\n  <name>attribute_name2</name>\n  <required>true</required>\n  <type>java.util.date</type>\n</attribute>\n.....\n',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaWeb ä¹ Filter å Listener",frontmatter:{title:"JavaWeb ä¹ Filter å Listener",categories:["ç¼ç¨","Java","JavaWeb"],tags:["Java","JavaWeb","Filter","Listener"],abbrlink:"9eb5517a",date:"2020-08-24T19:41:46.000Z",permalink:"/pages/5ecb29/"},regularPath:"/02.JavaEE/01.JavaWeb/03.JavaWeb%E4%B9%8BFilter%E5%92%8CListener.html",relativePath:"02.JavaEE/01.JavaWeb/03.JavaWebä¹FilteråListener.md",key:"v-576f0972",path:"/pages/5ecb29/",headers:[{level:2,title:"Filter",slug:"filter",normalizedTitle:"filter",charIndex:12},{level:3,title:"è¿æ»¤å¨æ¹æ³",slug:"è¿æ»¤å¨æ¹æ³",normalizedTitle:"è¿æ»¤å¨æ¹æ³",charIndex:483},{level:3,title:"è¿æ»¤å¨éç½®",slug:"è¿æ»¤å¨éç½®",normalizedTitle:"è¿æ»¤å¨éç½®",charIndex:1350},{level:2,title:"Listener",slug:"listener",normalizedTitle:"listener",charIndex:21},{level:3,title:"çå¬å¨çåç±»",slug:"çå¬å¨çåç±»",normalizedTitle:"çå¬å¨çåç±»",charIndex:2207},{level:3,title:"çå¬å¯¹è±¡çåå»ºåéæ¯",slug:"çå¬å¯¹è±¡çåå»ºåéæ¯",normalizedTitle:"çå¬å¯¹è±¡çåå»ºåéæ¯",charIndex:2439},{level:4,title:"HttpSessionListener",slug:"httpsessionlistener",normalizedTitle:"httpsessionlistener",charIndex:2453},{level:4,title:"ServletContextListener",slug:"servletcontextlistener",normalizedTitle:"servletcontextlistener",charIndex:2652},{level:4,title:"ServletRequestListener",slug:"servletrequestlistener",normalizedTitle:"servletrequestlistener",charIndex:3072},{level:3,title:"çå¬å¯¹è±¡çå±æ§åå",slug:"çå¬å¯¹è±¡çå±æ§åå",normalizedTitle:"çå¬å¯¹è±¡çå±æ§åå",charIndex:3390},{level:4,title:"attributeAdded æ¹æ³",slug:"attributeadded-æ¹æ³",normalizedTitle:"attributeadded æ¹æ³",charIndex:3676},{level:4,title:"attributeRemoved æ¹æ³",slug:"attributeremoved-æ¹æ³",normalizedTitle:"attributeremoved æ¹æ³",charIndex:4011},{level:4,title:"attributeReplaced æ¹æ³",slug:"attributereplaced-æ¹æ³",normalizedTitle:"attributereplaced æ¹æ³",charIndex:4298},{level:3,title:"çå¬ Session åçå¯¹è±¡",slug:"çå¬-session-åçå¯¹è±¡",normalizedTitle:"çå¬ session åçå¯¹è±¡",charIndex:4594},{level:4,title:"HttpSessionBindingListener",slug:"httpsessionbindinglistener",normalizedTitle:"httpsessionbindinglistener",charIndex:4828},{level:4,title:"HttpSessionActivationListener",slug:"httpsessionactivationlistener",normalizedTitle:"httpsessionactivationlistener",charIndex:4856},{level:2,title:"Filter å Listener",slug:"filter-å-listener",normalizedTitle:"filter å listener",charIndex:12},{level:2,title:"ç¤ºä¾ä»£ç ",slug:"ç¤ºä¾ä»£ç ",normalizedTitle:"ç¤ºä¾ä»£ç ",charIndex:5846},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:5896}],headersStr:"Filter è¿æ»¤å¨æ¹æ³ è¿æ»¤å¨éç½® Listener çå¬å¨çåç±» çå¬å¯¹è±¡çåå»ºåéæ¯ HttpSessionListener ServletContextListener ServletRequestListener çå¬å¯¹è±¡çå±æ§åå attributeAdded æ¹æ³ attributeRemoved æ¹æ³ attributeReplaced æ¹æ³ çå¬ Session åçå¯¹è±¡ HttpSessionBindingListener HttpSessionActivationListener Filter å Listener ç¤ºä¾ä»£ç  åèèµæ",content:'# JavaWeb ä¹ Filter å Listener\n\nå¼å¥äº Servlet è§èåï¼ä½ ä¸éè¦å³å¿ Socket ç½ç»éä¿¡ãä¸éè¦å³å¿ HTTP åè®®ï¼ä¹ä¸éè¦å³å¿ä½ çä¸å¡ç±»æ¯å¦ä½è¢«å®ä¾ååè°ç¨çï¼å ä¸ºè¿äºé½è¢« Servlet è§èæ ååäºï¼ä½ åªè¦å³å¿æä¹å®ç°çä½ çä¸å¡é»è¾ãè¿å¯¹äºç¨åºåæ¥è¯´æ¯ä»¶å¥½äºï¼ä½ä¹æä¸æ¹ä¾¿çä¸é¢ãæè°è§èå°±æ¯è¯´å¤§å®¶é½è¦éµå®ï¼å°±ä¼åç¯ä¸å¾ï¼ä½æ¯å¦æè¿ä¸ªè§èä¸è½æ»¡è¶³ä½ çä¸å¡çä¸ªæ§åéæ±ï¼å°±æé®é¢äºï¼å æ­¤è®¾è®¡ä¸ä¸ªè§èæèä¸ä¸ªä¸­é´ä»¶ï¼è¦ååèèå°å¯æ©å±æ§ãServlet è§èæä¾äºä¸¤ç§æ©å±æºå¶ï¼FilteråListenerã\n\n\n# Filter\n\nFilter æ¯è¿æ»¤å¨ï¼è¿ä¸ªæ¥å£åè®¸ä½ å¯¹è¯·æ±åååºåä¸äºç»ä¸çå®å¶åå¤çã\n\nFilter æä¾äºè¿æ»¤é¾ï¼Filter Chainï¼çæ¦å¿µï¼ä¸ä¸ªè¿æ»¤é¾åæ¬å¤ä¸ª Filterãå®¢æ·ç«¯è¯·æ± request å¨æµè¾¾ Servlet ä¹åä¼ç»è¿è¿æ»¤é¾çææ Filterï¼æå¡å¨ååº response ä» Servlet æµè¾¾å®¢æ·ç«¯æµè§å¨ä¹åä¹ä¼ç»è¿è¿æ»¤é¾çææ FIlterã\n\n\n\n\n# è¿æ»¤å¨æ¹æ³\n\nFilter æ¥å£æä¸ä¸ªæ¹æ³ï¼\n\n * initï¼åå§å Filter\n * destroyï¼éæ¯ Filter\n * doFilterï¼å°è¯·æ±ä¼ ç»ä¸ä¸ª Filter æ Servlet\n\ninit å destroy æ¹æ³åªä¼è¢«è°ç¨ä¸æ¬¡ï¼doFilter æ¯æ¬¡æå®¢æ·ç«¯è¯·æ±é½ä¼è¢«è°ç¨ä¸æ¬¡ã\n\npublic interface Filter {\n\n\t/**\n\t * web ç¨åºå¯å¨æ¶è°ç¨æ­¤æ¹æ³, ç¨äºåå§åè¯¥ Filter\n\t * @param config\n\t *            å¯ä»¥ä»è¯¥åæ°ä¸­è·ååå§ååæ°ä»¥åServletContextä¿¡æ¯ç­\n\t * @throws ServletException\n\t */\n\tpublic void init(FilterConfig config) throws ServletException;\n\n\t/**\n\t * å®¢æ·è¯·æ±æå¡å¨æ¶ä¼ç»è¿\n\t *\n\t * @param request\n\t *            å®¢æ·è¯·æ±\n\t * @param response\n\t *            æå¡å¨ååº\n\t * @param chain\n\t *            è¿æ»¤é¾, éè¿ chain.doFilter(request, response) å°è¯·æ±ä¼ ç»ä¸ä¸ª Filter æ\n\t *            Servlet\n\t * @throws ServletException\n\t * @throws IOException\n\t */\n\tpublic void doFilter(ServletRequest request, ServletResponse response,\n\t\t\tFilterChain chain) throws ServletException, IOException;\n\n\t/**\n\t * web ç¨åºå³é­æ¶è°ç¨æ­¤æ¹æ³, ç¨äºéæ¯ä¸äºèµæº\n\t */\n\tpublic void destroy();\n\n}\n\n\n\n# è¿æ»¤å¨éç½®\n\nFilter éè¦éç½®å¨ web.xml ä¸­æè½çæãä¸ä¸ª Filter éè¦éç½® <filter> ä¸ <filter-mapping> æ ç­¾ã\n\n * <filter> éç½® Filter åç§°ï¼å®ç°ç±»ä»¥ååå§ååæ°ã\n * <filter-mapping> éç½®ä»ä¹è§åä¸ä½¿ç¨è¯¥ Filterã\n * <filter> ç filterName ä¸ <filter-mapping> ç filterName å¿é¡»å¹éã\n * <url-pattern> éç½® URL çè§åï¼å¯ä»¥éç½®å¤ä¸ªï¼å¯ä»¥ä½¿ç¨ééç¬¦ï¼*ï¼ã\n * <dispatcher> éç½®å°è¾¾ Servlet çæ¹å¼ï¼æ 4 ç§åå¼ï¼REQUESTãFORWARDãINCLUDEãERRORãå¯ä»¥åæ¶éç½®å¤ä¸ª <dispatcher>ãå¦ææ²¡æéç½®ä»»ä½ <dispatcher>ï¼é»è®¤ä¸º REQUESTã\n   * REQUEST - è¡¨ç¤ºä»å½ç´æ¥è¯·æ± Servlet æ¶æçæã\n   * FORWARD - è¡¨ç¤ºä»å½æ Servlet éè¿ FORWARD å°è¯¥ Servlet æ¶æçæã\n   * INCLUDE - JSP ä¸­å¯ä»¥éè¿ <jsp:include> è¯·æ±æ Servletãä»å¨è¿ç§æåµè¡¨ææã\n   * ERROR - JSP ä¸­å¯ä»¥éè¿ <%@ page errorPage="error.jsp" %> æå®éè¯¯å¤çé¡µé¢ãä»å¨è¿ç§æåµè¡¨ææã\n\n\n# Listener\n\nçå¬å¨ï¼Listenerï¼ç¨äºçå¬ web åºç¨ç¨åºä¸­çServletContext, HttpSessionå ServletRequestç­åå¯¹è±¡çåå»ºä¸éæ¯äºä»¶ï¼ä»¥åçå¬è¿äºåå¯¹è±¡ä¸­çå±æ§åçä¿®æ¹çäºä»¶ã\n\nä½¿ç¨ Listener ä¸éè¦å³æ³¨è¯¥ç±»äºä»¶æ¶ææ ·è§¦åæèæä¹è°ç¨ç¸åºç Listenerï¼åªè¦è®°ä½è¯¥ç±»äºä»¶è§¦åæ¶ä¸å®ä¼è°ç¨ç¸åºç Listenerï¼éµå¾ª Servlet è§èçæå¡å¨ä¼èªå¨å®æç¸åºå·¥ä½ã\n\n\n# çå¬å¨çåç±»\n\nå¨ Servlet è§èä¸­å®ä¹äºå¤ç§ç±»åççå¬å¨ï¼å®ä»¬ç¨äºçå¬çäºä»¶æºåå«ä¸ºServletContextï¼HttpSessionåServletRequestè¿ä¸ä¸ªåå¯¹è±¡ Servlet è§èéå¯¹è¿ä¸ä¸ªå¯¹è±¡ä¸çæä½ï¼åæå¤ç§ç±»åççå¬å¨ååä¸ºä¸ç§ç±»åï¼\n\n 1. çå¬åå¯¹è±¡èªèº«çåå»ºåéæ¯çäºä»¶çå¬å¨ã\n 2. çå¬åå¯¹è±¡ä¸­çå±æ§çå¢å åå é¤çäºä»¶çå¬å¨ã\n 3. çå¬ç»å®å° HttpSession åä¸­çæä¸ªå¯¹è±¡çç¶æçäºä»¶çå¬å¨ã\n\n\n# çå¬å¯¹è±¡çåå»ºåéæ¯\n\n# HttpSessionListener\n\nHttpSessionListener æ¥å£ç¨äºçå¬ HttpSession å¯¹è±¡çåå»ºåéæ¯ã\n\n * åå»ºä¸ä¸ª Session æ¶ï¼æ¿å sessionCreated (HttpSessionEvent se) æ¹æ³\n * éæ¯ä¸ä¸ª Session æ¶ï¼æ¿å sessionDestroyed (HttpSessionEvent se) æ¹æ³ã\n\n# ServletContextListener\n\nServletContextListener æ¥å£ç¨äºçå¬ ServletContext å¯¹è±¡çåå»ºåéæ¯äºä»¶ã\n\nå®ç°äº ServletContextListener æ¥å£çç±»é½å¯ä»¥å¯¹ ServletContext å¯¹è±¡çåå»ºåéæ¯è¿è¡çå¬ã\n\n * å½ ServletContext å¯¹è±¡è¢«åå»ºæ¶ï¼æ¿å contextInitialized (ServletContextEvent sce) æ¹æ³ã\n * å½ ServletContext å¯¹è±¡è¢«éæ¯æ¶ï¼æ¿å contextDestroyed(ServletContextEvent sce) æ¹æ³ã\n\nServletContext åå¯¹è±¡åå»ºåéæ¯æ¶æºï¼\n\n * åå»ºï¼æå¡å¨å¯å¨éå¯¹æ¯ä¸ä¸ª Web åºç¨åå»º ServletContext\n * éæ¯ï¼æå¡å¨å³é­ååå³é­ä»£è¡¨æ¯ä¸ä¸ª web åºç¨ç ServletContext\n\n# ServletRequestListener\n\nServletRequestListener æ¥å£ç¨äºçå¬ ServletRequest å¯¹è±¡çåå»ºåéæ¯ã\n\n * Request å¯¹è±¡è¢«åå»ºæ¶ï¼çå¬å¨ç requestInitialized(ServletRequestEvent sre) æ¹æ³å°ä¼è¢«è°ç¨\n * Request å¯¹è±¡è¢«éæ¯æ¶ï¼çå¬å¨ç requestDestroyed(ServletRequestEvent sre) æ¹æ³å°ä¼è¢«è°ç¨\n\nServletRequest åå¯¹è±¡åå»ºåéæ¯æ¶æºï¼\n\n * åå»ºï¼ç¨æ·æ¯ä¸æ¬¡è®¿é®é½ä¼åå»º request å¯¹è±¡\n * éæ¯ï¼å½åè®¿é®ç»æï¼request å¯¹è±¡å°±ä¼éæ¯\n\n\n# çå¬å¯¹è±¡çå±æ§åå\n\nåå¯¹è±¡ä¸­å±æ§çåæ´çäºä»¶çå¬å¨å°±æ¯ç¨æ¥çå¬ ServletContextãHttpSessionãHttpServletRequest è¿ä¸ä¸ªå¯¹è±¡ä¸­çå±æ§åæ´ä¿¡æ¯äºä»¶ççå¬å¨ã è¿ä¸ä¸ªçå¬å¨æ¥å£åå«æ¯ ServletContextAttributeListenerãHttpSessionAttributeListener å ServletRequestAttributeListenerï¼è¿ä¸ä¸ªæ¥å£ä¸­é½å®ä¹äºä¸ä¸ªæ¹æ³æ¥å¤çè¢«çå¬å¯¹è±¡ä¸­çå±æ§çå¢å ï¼å é¤åæ¿æ¢çäºä»¶ï¼åä¸ä¸ªäºä»¶å¨è¿ä¸ä¸ªæ¥å£ä¸­å¯¹åºçæ¹æ³åç§°å®å¨ç¸åï¼åªæ¯æ¥åçåæ°ç±»åä¸åã\n\n# attributeAdded æ¹æ³\n\nå½åè¢«çå¬å¯¹è±¡ä¸­å¢å ä¸ä¸ªå±æ§æ¶ï¼web å®¹å¨å°±è°ç¨äºä»¶çå¬å¨ç attributeAdded æ¹æ³è¿è¡ååºï¼è¿ä¸ªæ¹æ³æ¥æ¶ä¸ä¸ªäºä»¶ç±»åçåæ°ï¼çå¬å¨å¯ä»¥éè¿è¿ä¸ªåæ°æ¥è·å¾æ­£å¨å¢å å±æ§çåå¯¹è±¡åè¢«ä¿å­å°åä¸­çå±æ§å¯¹è±¡ åä¸ªåå±æ§çå¬å¨ä¸­çå®æ´è¯­æ³å®ä¹ä¸ºï¼\n\npublic void attributeAdded(ServletContextAttributeEvent scae)\npublic void attributeReplaced(HttpSessionBindingEvent hsbe)\npublic void attributeRmoved(ServletRequestAttributeEvent srae)\n\n\n# attributeRemoved æ¹æ³\n\nå½å é¤è¢«çå¬å¯¹è±¡ä¸­çä¸ä¸ªå±æ§æ¶ï¼web å®¹å¨è°ç¨äºä»¶çå¬å¨ç attributeRemoved æ¹æ³è¿è¡ååº åä¸ªåå±æ§çå¬å¨ä¸­çå®æ´è¯­æ³å®ä¹ä¸ºï¼\n\npublic void attributeRemoved(ServletContextAttributeEvent scae)\npublic void attributeRemoved(HttpSessionBindingEvent hsbe)\npublic void attributeRemoved(ServletRequestAttributeEvent srae)\n\n\n# attributeReplaced æ¹æ³\n\nå½çå¬å¨çåå¯¹è±¡ä¸­çæä¸ªå±æ§è¢«æ¿æ¢æ¶ï¼web å®¹å¨è°ç¨äºä»¶çå¬å¨ç attributeReplaced æ¹æ³è¿è¡ååº åä¸ªåå±æ§çå¬å¨ä¸­çå®æ´è¯­æ³å®ä¹ä¸ºï¼\n\npublic void attributeReplaced(ServletContextAttributeEvent scae)\npublic void attributeReplaced(HttpSessionBindingEvent hsbe)\npublic void attributeReplaced(ServletRequestAttributeEvent srae)\n\n\n\n# çå¬ Session åçå¯¹è±¡\n\nä¿å­å¨ Session åä¸­çå¯¹è±¡å¯ä»¥æå¤ç§ç¶æï¼\n\n * ç»å®ï¼session.setAttribute("bean",Object)ï¼å° Session ä¸­ï¼\n * ä» Session åä¸­è§£é¤ç»å®ï¼session.removeAttribute("bean")ï¼ï¼\n * é Session å¯¹è±¡æä¹åå°ä¸ä¸ªå­å¨è®¾å¤ä¸­ï¼\n * é Session å¯¹è±¡ä»ä¸ä¸ªå­å¨è®¾å¤ä¸­æ¢å¤ã\n\nServlet è§èä¸­å®ä¹äºä¸¤ä¸ªç¹æ®ççå¬å¨æ¥å£ HttpSessionBindingListener åHttpSessionActivationListener æ¥å¸®å© JavaBean å¯¹è±¡äºè§£èªå·±å¨ Session åä¸­çè¿äºç¶æã\n\nå®ç°è¿ä¸¤ä¸ªæ¥å£çç±»ä¸éè¦ web.xml æä»¶ä¸­è¿è¡æ³¨åã\n\n# HttpSessionBindingListener\n\nHttpSessionBindingListener æ¥å£ç JavaBean å¯¹è±¡å¯ä»¥æç¥èªå·±è¢«ç»å®æè§£ç»å®å° Session ä¸­çäºä»¶ã\n\n * å½å¯¹è±¡è¢«ç»å®å° HttpSession å¯¹è±¡ä¸­æ¶ï¼web æå¡å¨è°ç¨è¯¥å¯¹è±¡ç valueBound(HttpSessionBindingEvent event) æ¹æ³ã\n * å½å¯¹è±¡ä» HttpSession å¯¹è±¡ä¸­è§£é¤ç»å®æ¶ï¼web æå¡å¨è°ç¨è¯¥å¯¹è±¡ç valueUnbound(HttpSessionBindingEvent event) æ¹æ³ã\n\n# HttpSessionActivationListener\n\nå®ç°äº HttpSessionActivationListener æ¥å£ç JavaBean å¯¹è±¡å¯ä»¥æç¥èªå·±è¢«æ´»å(ååºåå)åéå(åºåå)çäºä»¶ã\n\n * å½ç»å®å° HttpSession å¯¹è±¡ä¸­ç JavaBean å¯¹è±¡å°è¦é HttpSession å¯¹è±¡è¢«åºååä¹åï¼web æå¡å¨è°ç¨è¯¥ JavaBean å¯¹è±¡ç sessionWillPassivate(HttpSessionEvent event) æ¹æ³ãè¿æ · JavaBean å¯¹è±¡å°±å¯ä»¥ç¥éèªå·±å°è¦å HttpSession å¯¹è±¡ä¸èµ·è¢«åºååå°ç¡¬çä¸­.\n * å½ç»å®å° HttpSession å¯¹è±¡ä¸­ç JavaBean å¯¹è±¡å°è¦é HttpSession å¯¹è±¡è¢«ååºååä¹åï¼web æå¡å¨è°ç¨è¯¥ JavaBean å¯¹è±¡ç sessionDidActive(HttpSessionEvent event) æ¹æ³ãè¿æ · JavaBean å¯¹è±¡å°±å¯ä»¥ç¥éèªå·±å°è¦å HttpSession å¯¹è±¡ä¸èµ·è¢«ååºåååå°åå­ä¸­\n\n\n# Filter å Listener\n\nFilter å Listener çæ¬è´¨åºå«ï¼\n\n * Filter æ¯å¹²é¢è¿ç¨çï¼å®æ¯è¿ç¨çä¸é¨åï¼æ¯åºäºè¿ç¨è¡ä¸ºçã\n * Listener æ¯åºäºç¶æçï¼ä»»ä½è¡ä¸ºæ¹ååä¸ä¸ªç¶æï¼è§¦åçäºä»¶æ¯ä¸è´çã\n\n\n# ç¤ºä¾ä»£ç \n\n * Filter çç¤ºä¾æºç ï¼æºç \n * Listener çç¤ºä¾æºç ï¼æºç \n\n\n# åèèµæ\n\n * æ·±å¥æè§£ Tomcat & Jetty\n * Java Web æ´åå¼åçèå½æ¥',normalizedContent:'# javaweb ä¹ filter å listener\n\nå¼å¥äº servlet è§èåï¼ä½ ä¸éè¦å³å¿ socket ç½ç»éä¿¡ãä¸éè¦å³å¿ http åè®®ï¼ä¹ä¸éè¦å³å¿ä½ çä¸å¡ç±»æ¯å¦ä½è¢«å®ä¾ååè°ç¨çï¼å ä¸ºè¿äºé½è¢« servlet è§èæ ååäºï¼ä½ åªè¦å³å¿æä¹å®ç°çä½ çä¸å¡é»è¾ãè¿å¯¹äºç¨åºåæ¥è¯´æ¯ä»¶å¥½äºï¼ä½ä¹æä¸æ¹ä¾¿çä¸é¢ãæè°è§èå°±æ¯è¯´å¤§å®¶é½è¦éµå®ï¼å°±ä¼åç¯ä¸å¾ï¼ä½æ¯å¦æè¿ä¸ªè§èä¸è½æ»¡è¶³ä½ çä¸å¡çä¸ªæ§åéæ±ï¼å°±æé®é¢äºï¼å æ­¤è®¾è®¡ä¸ä¸ªè§èæèä¸ä¸ªä¸­é´ä»¶ï¼è¦ååèèå°å¯æ©å±æ§ãservlet è§èæä¾äºä¸¤ç§æ©å±æºå¶ï¼filterålistenerã\n\n\n# filter\n\nfilter æ¯è¿æ»¤å¨ï¼è¿ä¸ªæ¥å£åè®¸ä½ å¯¹è¯·æ±åååºåä¸äºç»ä¸çå®å¶åå¤çã\n\nfilter æä¾äºè¿æ»¤é¾ï¼filter chainï¼çæ¦å¿µï¼ä¸ä¸ªè¿æ»¤é¾åæ¬å¤ä¸ª filterãå®¢æ·ç«¯è¯·æ± request å¨æµè¾¾ servlet ä¹åä¼ç»è¿è¿æ»¤é¾çææ filterï¼æå¡å¨ååº response ä» servlet æµè¾¾å®¢æ·ç«¯æµè§å¨ä¹åä¹ä¼ç»è¿è¿æ»¤é¾çææ filterã\n\n\n\n\n# è¿æ»¤å¨æ¹æ³\n\nfilter æ¥å£æä¸ä¸ªæ¹æ³ï¼\n\n * initï¼åå§å filter\n * destroyï¼éæ¯ filter\n * dofilterï¼å°è¯·æ±ä¼ ç»ä¸ä¸ª filter æ servlet\n\ninit å destroy æ¹æ³åªä¼è¢«è°ç¨ä¸æ¬¡ï¼dofilter æ¯æ¬¡æå®¢æ·ç«¯è¯·æ±é½ä¼è¢«è°ç¨ä¸æ¬¡ã\n\npublic interface filter {\n\n\t/**\n\t * web ç¨åºå¯å¨æ¶è°ç¨æ­¤æ¹æ³, ç¨äºåå§åè¯¥ filter\n\t * @param config\n\t *            å¯ä»¥ä»è¯¥åæ°ä¸­è·ååå§ååæ°ä»¥åservletcontextä¿¡æ¯ç­\n\t * @throws servletexception\n\t */\n\tpublic void init(filterconfig config) throws servletexception;\n\n\t/**\n\t * å®¢æ·è¯·æ±æå¡å¨æ¶ä¼ç»è¿\n\t *\n\t * @param request\n\t *            å®¢æ·è¯·æ±\n\t * @param response\n\t *            æå¡å¨ååº\n\t * @param chain\n\t *            è¿æ»¤é¾, éè¿ chain.dofilter(request, response) å°è¯·æ±ä¼ ç»ä¸ä¸ª filter æ\n\t *            servlet\n\t * @throws servletexception\n\t * @throws ioexception\n\t */\n\tpublic void dofilter(servletrequest request, servletresponse response,\n\t\t\tfilterchain chain) throws servletexception, ioexception;\n\n\t/**\n\t * web ç¨åºå³é­æ¶è°ç¨æ­¤æ¹æ³, ç¨äºéæ¯ä¸äºèµæº\n\t */\n\tpublic void destroy();\n\n}\n\n\n\n# è¿æ»¤å¨éç½®\n\nfilter éè¦éç½®å¨ web.xml ä¸­æè½çæãä¸ä¸ª filter éè¦éç½® <filter> ä¸ <filter-mapping> æ ç­¾ã\n\n * <filter> éç½® filter åç§°ï¼å®ç°ç±»ä»¥ååå§ååæ°ã\n * <filter-mapping> éç½®ä»ä¹è§åä¸ä½¿ç¨è¯¥ filterã\n * <filter> ç filtername ä¸ <filter-mapping> ç filtername å¿é¡»å¹éã\n * <url-pattern> éç½® url çè§åï¼å¯ä»¥éç½®å¤ä¸ªï¼å¯ä»¥ä½¿ç¨ééç¬¦ï¼*ï¼ã\n * <dispatcher> éç½®å°è¾¾ servlet çæ¹å¼ï¼æ 4 ç§åå¼ï¼requestãforwardãincludeãerrorãå¯ä»¥åæ¶éç½®å¤ä¸ª <dispatcher>ãå¦ææ²¡æéç½®ä»»ä½ <dispatcher>ï¼é»è®¤ä¸º requestã\n   * request - è¡¨ç¤ºä»å½ç´æ¥è¯·æ± servlet æ¶æçæã\n   * forward - è¡¨ç¤ºä»å½æ servlet éè¿ forward å°è¯¥ servlet æ¶æçæã\n   * include - jsp ä¸­å¯ä»¥éè¿ <jsp:include> è¯·æ±æ servletãä»å¨è¿ç§æåµè¡¨ææã\n   * error - jsp ä¸­å¯ä»¥éè¿ <%@ page errorpage="error.jsp" %> æå®éè¯¯å¤çé¡µé¢ãä»å¨è¿ç§æåµè¡¨ææã\n\n\n# listener\n\nçå¬å¨ï¼listenerï¼ç¨äºçå¬ web åºç¨ç¨åºä¸­çservletcontext, httpsessionå servletrequestç­åå¯¹è±¡çåå»ºä¸éæ¯äºä»¶ï¼ä»¥åçå¬è¿äºåå¯¹è±¡ä¸­çå±æ§åçä¿®æ¹çäºä»¶ã\n\nä½¿ç¨ listener ä¸éè¦å³æ³¨è¯¥ç±»äºä»¶æ¶ææ ·è§¦åæèæä¹è°ç¨ç¸åºç listenerï¼åªè¦è®°ä½è¯¥ç±»äºä»¶è§¦åæ¶ä¸å®ä¼è°ç¨ç¸åºç listenerï¼éµå¾ª servlet è§èçæå¡å¨ä¼èªå¨å®æç¸åºå·¥ä½ã\n\n\n# çå¬å¨çåç±»\n\nå¨ servlet è§èä¸­å®ä¹äºå¤ç§ç±»åççå¬å¨ï¼å®ä»¬ç¨äºçå¬çäºä»¶æºåå«ä¸ºservletcontextï¼httpsessionåservletrequestè¿ä¸ä¸ªåå¯¹è±¡ servlet è§èéå¯¹è¿ä¸ä¸ªå¯¹è±¡ä¸çæä½ï¼åæå¤ç§ç±»åççå¬å¨ååä¸ºä¸ç§ç±»åï¼\n\n 1. çå¬åå¯¹è±¡èªèº«çåå»ºåéæ¯çäºä»¶çå¬å¨ã\n 2. çå¬åå¯¹è±¡ä¸­çå±æ§çå¢å åå é¤çäºä»¶çå¬å¨ã\n 3. çå¬ç»å®å° httpsession åä¸­çæä¸ªå¯¹è±¡çç¶æçäºä»¶çå¬å¨ã\n\n\n# çå¬å¯¹è±¡çåå»ºåéæ¯\n\n# httpsessionlistener\n\nhttpsessionlistener æ¥å£ç¨äºçå¬ httpsession å¯¹è±¡çåå»ºåéæ¯ã\n\n * åå»ºä¸ä¸ª session æ¶ï¼æ¿å sessioncreated (httpsessionevent se) æ¹æ³\n * éæ¯ä¸ä¸ª session æ¶ï¼æ¿å sessiondestroyed (httpsessionevent se) æ¹æ³ã\n\n# servletcontextlistener\n\nservletcontextlistener æ¥å£ç¨äºçå¬ servletcontext å¯¹è±¡çåå»ºåéæ¯äºä»¶ã\n\nå®ç°äº servletcontextlistener æ¥å£çç±»é½å¯ä»¥å¯¹ servletcontext å¯¹è±¡çåå»ºåéæ¯è¿è¡çå¬ã\n\n * å½ servletcontext å¯¹è±¡è¢«åå»ºæ¶ï¼æ¿å contextinitialized (servletcontextevent sce) æ¹æ³ã\n * å½ servletcontext å¯¹è±¡è¢«éæ¯æ¶ï¼æ¿å contextdestroyed(servletcontextevent sce) æ¹æ³ã\n\nservletcontext åå¯¹è±¡åå»ºåéæ¯æ¶æºï¼\n\n * åå»ºï¼æå¡å¨å¯å¨éå¯¹æ¯ä¸ä¸ª web åºç¨åå»º servletcontext\n * éæ¯ï¼æå¡å¨å³é­ååå³é­ä»£è¡¨æ¯ä¸ä¸ª web åºç¨ç servletcontext\n\n# servletrequestlistener\n\nservletrequestlistener æ¥å£ç¨äºçå¬ servletrequest å¯¹è±¡çåå»ºåéæ¯ã\n\n * request å¯¹è±¡è¢«åå»ºæ¶ï¼çå¬å¨ç requestinitialized(servletrequestevent sre) æ¹æ³å°ä¼è¢«è°ç¨\n * request å¯¹è±¡è¢«éæ¯æ¶ï¼çå¬å¨ç requestdestroyed(servletrequestevent sre) æ¹æ³å°ä¼è¢«è°ç¨\n\nservletrequest åå¯¹è±¡åå»ºåéæ¯æ¶æºï¼\n\n * åå»ºï¼ç¨æ·æ¯ä¸æ¬¡è®¿é®é½ä¼åå»º request å¯¹è±¡\n * éæ¯ï¼å½åè®¿é®ç»æï¼request å¯¹è±¡å°±ä¼éæ¯\n\n\n# çå¬å¯¹è±¡çå±æ§åå\n\nåå¯¹è±¡ä¸­å±æ§çåæ´çäºä»¶çå¬å¨å°±æ¯ç¨æ¥çå¬ servletcontextãhttpsessionãhttpservletrequest è¿ä¸ä¸ªå¯¹è±¡ä¸­çå±æ§åæ´ä¿¡æ¯äºä»¶ççå¬å¨ã è¿ä¸ä¸ªçå¬å¨æ¥å£åå«æ¯ servletcontextattributelistenerãhttpsessionattributelistener å servletrequestattributelistenerï¼è¿ä¸ä¸ªæ¥å£ä¸­é½å®ä¹äºä¸ä¸ªæ¹æ³æ¥å¤çè¢«çå¬å¯¹è±¡ä¸­çå±æ§çå¢å ï¼å é¤åæ¿æ¢çäºä»¶ï¼åä¸ä¸ªäºä»¶å¨è¿ä¸ä¸ªæ¥å£ä¸­å¯¹åºçæ¹æ³åç§°å®å¨ç¸åï¼åªæ¯æ¥åçåæ°ç±»åä¸åã\n\n# attributeadded æ¹æ³\n\nå½åè¢«çå¬å¯¹è±¡ä¸­å¢å ä¸ä¸ªå±æ§æ¶ï¼web å®¹å¨å°±è°ç¨äºä»¶çå¬å¨ç attributeadded æ¹æ³è¿è¡ååºï¼è¿ä¸ªæ¹æ³æ¥æ¶ä¸ä¸ªäºä»¶ç±»åçåæ°ï¼çå¬å¨å¯ä»¥éè¿è¿ä¸ªåæ°æ¥è·å¾æ­£å¨å¢å å±æ§çåå¯¹è±¡åè¢«ä¿å­å°åä¸­çå±æ§å¯¹è±¡ åä¸ªåå±æ§çå¬å¨ä¸­çå®æ´è¯­æ³å®ä¹ä¸ºï¼\n\npublic void attributeadded(servletcontextattributeevent scae)\npublic void attributereplaced(httpsessionbindingevent hsbe)\npublic void attributermoved(servletrequestattributeevent srae)\n\n\n# attributeremoved æ¹æ³\n\nå½å é¤è¢«çå¬å¯¹è±¡ä¸­çä¸ä¸ªå±æ§æ¶ï¼web å®¹å¨è°ç¨äºä»¶çå¬å¨ç attributeremoved æ¹æ³è¿è¡ååº åä¸ªåå±æ§çå¬å¨ä¸­çå®æ´è¯­æ³å®ä¹ä¸ºï¼\n\npublic void attributeremoved(servletcontextattributeevent scae)\npublic void attributeremoved(httpsessionbindingevent hsbe)\npublic void attributeremoved(servletrequestattributeevent srae)\n\n\n# attributereplaced æ¹æ³\n\nå½çå¬å¨çåå¯¹è±¡ä¸­çæä¸ªå±æ§è¢«æ¿æ¢æ¶ï¼web å®¹å¨è°ç¨äºä»¶çå¬å¨ç attributereplaced æ¹æ³è¿è¡ååº åä¸ªåå±æ§çå¬å¨ä¸­çå®æ´è¯­æ³å®ä¹ä¸ºï¼\n\npublic void attributereplaced(servletcontextattributeevent scae)\npublic void attributereplaced(httpsessionbindingevent hsbe)\npublic void attributereplaced(servletrequestattributeevent srae)\n\n\n\n# çå¬ session åçå¯¹è±¡\n\nä¿å­å¨ session åä¸­çå¯¹è±¡å¯ä»¥æå¤ç§ç¶æï¼\n\n * ç»å®ï¼session.setattribute("bean",object)ï¼å° session ä¸­ï¼\n * ä» session åä¸­è§£é¤ç»å®ï¼session.removeattribute("bean")ï¼ï¼\n * é session å¯¹è±¡æä¹åå°ä¸ä¸ªå­å¨è®¾å¤ä¸­ï¼\n * é session å¯¹è±¡ä»ä¸ä¸ªå­å¨è®¾å¤ä¸­æ¢å¤ã\n\nservlet è§èä¸­å®ä¹äºä¸¤ä¸ªç¹æ®ççå¬å¨æ¥å£ httpsessionbindinglistener åhttpsessionactivationlistener æ¥å¸®å© javabean å¯¹è±¡äºè§£èªå·±å¨ session åä¸­çè¿äºç¶æã\n\nå®ç°è¿ä¸¤ä¸ªæ¥å£çç±»ä¸éè¦ web.xml æä»¶ä¸­è¿è¡æ³¨åã\n\n# httpsessionbindinglistener\n\nhttpsessionbindinglistener æ¥å£ç javabean å¯¹è±¡å¯ä»¥æç¥èªå·±è¢«ç»å®æè§£ç»å®å° session ä¸­çäºä»¶ã\n\n * å½å¯¹è±¡è¢«ç»å®å° httpsession å¯¹è±¡ä¸­æ¶ï¼web æå¡å¨è°ç¨è¯¥å¯¹è±¡ç valuebound(httpsessionbindingevent event) æ¹æ³ã\n * å½å¯¹è±¡ä» httpsession å¯¹è±¡ä¸­è§£é¤ç»å®æ¶ï¼web æå¡å¨è°ç¨è¯¥å¯¹è±¡ç valueunbound(httpsessionbindingevent event) æ¹æ³ã\n\n# httpsessionactivationlistener\n\nå®ç°äº httpsessionactivationlistener æ¥å£ç javabean å¯¹è±¡å¯ä»¥æç¥èªå·±è¢«æ´»å(ååºåå)åéå(åºåå)çäºä»¶ã\n\n * å½ç»å®å° httpsession å¯¹è±¡ä¸­ç javabean å¯¹è±¡å°è¦é httpsession å¯¹è±¡è¢«åºååä¹åï¼web æå¡å¨è°ç¨è¯¥ javabean å¯¹è±¡ç sessionwillpassivate(httpsessionevent event) æ¹æ³ãè¿æ · javabean å¯¹è±¡å°±å¯ä»¥ç¥éèªå·±å°è¦å httpsession å¯¹è±¡ä¸èµ·è¢«åºååå°ç¡¬çä¸­.\n * å½ç»å®å° httpsession å¯¹è±¡ä¸­ç javabean å¯¹è±¡å°è¦é httpsession å¯¹è±¡è¢«ååºååä¹åï¼web æå¡å¨è°ç¨è¯¥ javabean å¯¹è±¡ç sessiondidactive(httpsessionevent event) æ¹æ³ãè¿æ · javabean å¯¹è±¡å°±å¯ä»¥ç¥éèªå·±å°è¦å httpsession å¯¹è±¡ä¸èµ·è¢«ååºåååå°åå­ä¸­\n\n\n# filter å listener\n\nfilter å listener çæ¬è´¨åºå«ï¼\n\n * filter æ¯å¹²é¢è¿ç¨çï¼å®æ¯è¿ç¨çä¸é¨åï¼æ¯åºäºè¿ç¨è¡ä¸ºçã\n * listener æ¯åºäºç¶æçï¼ä»»ä½è¡ä¸ºæ¹ååä¸ä¸ªç¶æï¼è§¦åçäºä»¶æ¯ä¸è´çã\n\n\n# ç¤ºä¾ä»£ç \n\n * filter çç¤ºä¾æºç ï¼æºç \n * listener çç¤ºä¾æºç ï¼æºç \n\n\n# åèèµæ\n\n * æ·±å¥æè§£ tomcat & jetty\n * java web æ´åå¼åçèå½æ¥',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaWeb ä¹ Cookie å Session",frontmatter:{title:"JavaWeb ä¹ Cookie å Session",categories:["ç¼ç¨","Java","JavaWeb"],tags:["Java","JavaWeb","Cookie","Session"],abbrlink:"bb93a37b",date:"2020-08-24T19:41:46.000Z",permalink:"/pages/e61883/"},regularPath:"/02.JavaEE/01.JavaWeb/04.JavaWeb%E4%B9%8BCookie%E5%92%8CSession.html",relativePath:"02.JavaEE/01.JavaWeb/04.JavaWebä¹CookieåSession.md",key:"v-62a8b34c",path:"/pages/e61883/",headers:[{level:2,title:"Cookie",slug:"cookie",normalizedTitle:"cookie",charIndex:12},{level:3,title:"Cookie æ¯ä»ä¹",slug:"cookie-æ¯ä»ä¹",normalizedTitle:"cookie æ¯ä»ä¹",charIndex:143},{level:3,title:"Cookie åæ",slug:"cookie-åæ",normalizedTitle:"cookie åæ",charIndex:483},{level:3,title:"Cookie ç±»ä¸­çæ¹æ³",slug:"cookie-ç±»ä¸­çæ¹æ³",normalizedTitle:"cookie ç±»ä¸­çæ¹æ³",charIndex:1288},{level:3,title:"Cookie çæææ",slug:"cookie-çæææ",normalizedTitle:"cookie çæææ",charIndex:2432},{level:3,title:"Cookie çåå",slug:"cookie-çåå",normalizedTitle:"cookie çåå",charIndex:2632},{level:3,title:"Cookie çè·¯å¾",slug:"cookie-çè·¯å¾",normalizedTitle:"cookie çè·¯å¾",charIndex:991},{level:3,title:"Cookie çå®å¨å±æ§",slug:"cookie-çå®å¨å±æ§",normalizedTitle:"cookie çå®å¨å±æ§",charIndex:3014},{level:3,title:"Cookie å®ä¾",slug:"cookie-å®ä¾",normalizedTitle:"cookie å®ä¾",charIndex:3254},{level:4,title:"æ·»å  Cookie",slug:"æ·»å -cookie",normalizedTitle:"æ·»å  cookie",charIndex:3267},{level:4,title:"æ¾ç¤º Cookie",slug:"æ¾ç¤º-cookie",normalizedTitle:"æ¾ç¤º cookie",charIndex:6148},{level:4,title:"å é¤ Cookie",slug:"å é¤-cookie",normalizedTitle:"å é¤ cookie",charIndex:8707},{level:2,title:"Session",slug:"session",normalizedTitle:"session",charIndex:21},{level:3,title:"Session æ¯ä»ä¹",slug:"session-æ¯ä»ä¹",normalizedTitle:"session æ¯ä»ä¹",charIndex:11262},{level:3,title:"Session ç±»ä¸­çæ¹æ³",slug:"session-ç±»ä¸­çæ¹æ³",normalizedTitle:"session ç±»ä¸­çæ¹æ³",charIndex:11473},{level:3,title:"Session çæææ",slug:"session-çæææ",normalizedTitle:"session çæææ",charIndex:12772},{level:3,title:"Session å¯¹æµè§å¨çè¦æ±",slug:"session-å¯¹æµè§å¨çè¦æ±",normalizedTitle:"session å¯¹æµè§å¨çè¦æ±",charIndex:13121},{level:3,title:"URL å°åéå",slug:"url-å°åéå",normalizedTitle:"url å°åéå",charIndex:13375},{level:3,title:"Session ä¸­ç¦ç¨ Cookie",slug:"session-ä¸­ç¦ç¨-cookie",normalizedTitle:"session ä¸­ç¦ç¨ cookie",charIndex:13563},{level:3,title:"Session å®ä¾",slug:"session-å®ä¾",normalizedTitle:"session å®ä¾",charIndex:13763},{level:4,title:"Session è·è¸ª",slug:"session-è·è¸ª",normalizedTitle:"session è·è¸ª",charIndex:13777},{level:4,title:"å é¤ Session ä¼è¯æ°æ®",slug:"å é¤-session-ä¼è¯æ°æ®",normalizedTitle:"å é¤ session ä¼è¯æ°æ®",charIndex:16954},{level:2,title:"Cookie vs Session",slug:"cookie-vs-session",normalizedTitle:"cookie vs session",charIndex:17664},{level:3,title:"å­åæ¹å¼",slug:"å­åæ¹å¼",normalizedTitle:"å­åæ¹å¼",charIndex:17686},{level:3,title:"éç§å®å¨",slug:"éç§å®å¨",normalizedTitle:"éç§å®å¨",charIndex:2726},{level:3,title:"æææ",slug:"æææ",normalizedTitle:"æææ",charIndex:2440},{level:3,title:"æå¡å¨çå¼é",slug:"æå¡å¨çå¼é",normalizedTitle:"æå¡å¨çå¼é",charIndex:18160},{level:3,title:"æµè§å¨çæ¯æ",slug:"æµè§å¨çæ¯æ",normalizedTitle:"æµè§å¨çæ¯æ",charIndex:379},{level:3,title:"è·¨åå",slug:"è·¨åå",normalizedTitle:"è·¨åå",charIndex:2655}],headersStr:"Cookie Cookie æ¯ä»ä¹ Cookie åæ Cookie ç±»ä¸­çæ¹æ³ Cookie çæææ Cookie çåå Cookie çè·¯å¾ Cookie çå®å¨å±æ§ Cookie å®ä¾ æ·»å  Cookie æ¾ç¤º Cookie å é¤ Cookie Session Session æ¯ä»ä¹ Session ç±»ä¸­çæ¹æ³ Session çæææ Session å¯¹æµè§å¨çè¦æ± URL å°åéå Session ä¸­ç¦ç¨ Cookie Session å®ä¾ Session è·è¸ª å é¤ Session ä¼è¯æ°æ® Cookie vs Session å­åæ¹å¼ éç§å®å¨ æææ æå¡å¨çå¼é æµè§å¨çæ¯æ è·¨åå",content:'# JavaWeb ä¹ Cookie å Session\n\n\n# Cookie\n\nç±äº Http æ¯ä¸ç§æ ç¶æçåè®®ï¼æå¡å¨åä»ç½ç»è¿æ¥ä¸æ ä»ç¥éå®¢æ·èº«ä»½ã\n\nä¼è¯è·è¸ªæ¯ Web ç¨åºä¸­å¸¸ç¨çææ¯ï¼ç¨æ¥è·è¸ªç¨æ·çæ´ä¸ªä¼è¯ãå¸¸ç¨ä¼è¯è·è¸ªææ¯æ¯ Cookie ä¸ Sessionã\n\n\n# Cookie æ¯ä»ä¹\n\nCookie å®éä¸æ¯å­å¨å¨å®¢æ·ç«¯ä¸çææ¬ä¿¡æ¯ï¼å¹¶ä¿çäºåç§è·è¸ªçä¿¡æ¯ã\n\nCookie å·¥ä½æ­¥éª¤ï¼\n\n 1. å®¢æ·ç«¯è¯·æ±æå¡å¨ï¼å¦ææå¡å¨éè¦è®°å½è¯¥ç¨æ·çç¶æï¼å°±æ¯ç¨ response åå®¢æ·ç«¯æµè§å¨é¢åä¸ä¸ª Cookieã\n 2. å®¢æ·ç«¯æµè§å¨ä¼æ Cookie ä¿å­ä¸æ¥ã\n 3. å½æµè§å¨åè¯·æ±è¯¥ç½ç«æ¶ï¼æµè§å¨æè¯¥è¯·æ±çç½åè¿å Cookie ä¸åæäº¤ç»æå¡å¨ãæå¡å¨æ£æ¥è¯¥ Cookieï¼ä»¥æ­¤æ¥è¾¨è®¤ç¨æ·ç¶æã\n\næ³¨ï¼Cookie åè½éè¦æµè§å¨çæ¯æï¼å¦ææµè§å¨ä¸æ¯æ Cookie æè Cookie ç¦ç¨äºï¼Cookie åè½å°±ä¼å¤±æã\n\nJava ä¸­æ Cookie å°è£æäºjavax.servlet.http.Cookieç±»ã\n\n\n# Cookie åæ\n\nCookies éå¸¸è®¾ç½®å¨ HTTP å¤´ä¿¡æ¯ä¸­ï¼è½ç¶ JavaScript ä¹å¯ä»¥ç´æ¥å¨æµè§å¨ä¸è®¾ç½®ä¸ä¸ª Cookieï¼ã\n\nè®¾ç½® Cookie ç Servlet ä¼åéå¦ä¸çå¤´ä¿¡æ¯ï¼\n\nHTTP/1.1 200 OK\nDate: Fri, 04 Feb 2000 21:03:38 GMT\nServer: Apache/1.3.9 (UNIX) PHP/4.0b3\nSet-Cookie: name=xyz; expires=Friday, 04-Feb-07 22:03:38 GMT;\n                 path=/; domain=w3cschool.cc\nConnection: close\nContent-Type: text/html\n\n\næ­£å¦æ¨æçå°çï¼Set-Cookie å¤´åå«äºä¸ä¸ªåç§°å¼å¯¹ãä¸ä¸ª GMT æ¥æãä¸ä¸ªè·¯å¾åä¸ä¸ªåãåç§°åå¼ä¼è¢« URL ç¼ç ãexpires å­æ®µæ¯ä¸ä¸ªæä»¤ï¼åè¯æµè§å¨å¨ç»å®çæ¶é´åæ¥æä¹å"å¿è®°"è¯¥ Cookieã\n\nå¦ææµè§å¨è¢«éç½®ä¸ºå­å¨ Cookiesï¼å®å°ä¼ä¿çæ­¤ä¿¡æ¯ç´å°å°ææ¥æãå¦æç¨æ·çæµè§å¨æåä»»ä½å¹éè¯¥ Cookie çè·¯å¾ååçé¡µé¢ï¼å®ä¼éæ°åé Cookie å°æå¡å¨ãæµè§å¨çå¤´ä¿¡æ¯å¯è½å¦ä¸æç¤ºï¼\n\nGET / HTTP/1.0\nConnection: Keep-Alive\nUser-Agent: Mozilla/4.6 (X11; I; Linux 2.2.6-15apmac ppc)\nHost: zink.demon.co.uk:1126\nAccept: image/gif, */*\nAccept-Encoding: gzip\nAccept-Language: en\nAccept-Charset: iso-8859-1,*,utf-8\nCookie: name=xyz\n\n\n\n# Cookie ç±»ä¸­çæ¹æ³\n\næ¹æ³                                       åè½\npublic void setDomain(String pattern)    è¯¥æ¹æ³è®¾ç½® cookie éç¨çåã\npublic String getDomain()                è¯¥æ¹æ³è·å cookie éç¨çåã\npublic void setMaxAge(int expiry)        è¯¥æ¹æ³è®¾ç½® cookie è¿æçæ¶é´ï¼ä»¥ç§ä¸ºåä½ï¼ãå¦æä¸è¿æ ·è®¾ç½®ï¼cookie åªä¼å¨å½å session\n                                         ä¼è¯ä¸­æç»­ææã\npublic int getMaxAge()                   è¯¥æ¹æ³è¿å cookie çæå¤§çå­å¨æï¼ä»¥ç§ä¸ºåä½ï¼ï¼é»è®¤æåµä¸ï¼-1 è¡¨ç¤º cookie\n                                         å°æç»­ä¸å»ï¼ç´å°æµè§å¨å³é­ã\npublic String getName()                  è¯¥æ¹æ³è¿å cookie çåç§°ãåç§°å¨åå»ºåä¸è½æ¹åã\npublic void setValue(String newValue)    è¯¥æ¹æ³è®¾ç½®ä¸ cookie å³èçå¼ã\npublic String getValue()                 è¯¥æ¹æ³è·åä¸ cookie å³èçå¼ã\npublic void setPath(String uri)          è¯¥æ¹æ³è®¾ç½® cookie éç¨çè·¯å¾ãå¦ææ¨ä¸æå®è·¯å¾ï¼ä¸å½åé¡µé¢ç¸åç®å½ä¸çï¼åæ¬å­ç®å½ä¸çï¼ææ URL é½ä¼è¿å\n                                         cookieã\npublic String getPath()                  è¯¥æ¹æ³è·å cookie éç¨çè·¯å¾ã\npublic void setSecure(boolean flag)      è¯¥æ¹æ³è®¾ç½®å¸å°å¼ï¼åæµè§å¨æç¤ºï¼åªä¼å¨ HTTPS å SSL ç­å®å¨åè®®ä¸­ä¼ è¾æ­¤ç±» Cookieã\npublic void setComment(String purpose)   è¯¥æ¹æ³è§å®äºæè¿° cookie ç®ççæ³¨éãè¯¥æ³¨éå¨æµè§å¨åç¨æ·åç° cookie æ¶éå¸¸æç¨ã\npublic String getComment()               è¯¥æ¹æ³è¿åäºæè¿° cookie ç®ççæ³¨éï¼å¦æ cookie æ²¡ææ³¨éåè¿å nullã\n\n\n# Cookie çæææ\n\nCookieçmaxAgeå³å®ç Cookie çæææï¼åä½ä¸ºç§ã\n\nå¦æ maxAge ä¸º 0ï¼åè¡¨ç¤ºå é¤è¯¥ Cookieï¼\n\nå¦æä¸ºè´æ°ï¼è¡¨ç¤ºè¯¥ Cookie ä»å¨æ¬æµè§å¨ä¸­ä»¥åæ¬çªå£æå¼çå­çªå£åææï¼å³é­çªå£åè¯¥ Cookie å³å¤±æã\n\nCookie ä¸­æä¾getMaxAge()åsetMaxAge(int expiry)æ¹æ³æ¥è¯»åmaxAgeå±æ§ã\n\n\n# Cookie çåå\n\nCookie æ¯ä¸å¯ä»¥è·¨ååçãåå www.google.com é¢åç Cookie ä¸ä¼è¢«æäº¤å°åå www.baidu.com å»ãè¿æ¯ç± Cookie çéç§å®å¨æºå¶å³å®çãéç§å®å¨æºå¶è½å¤ç¦æ­¢ç½ç«éæ³è·åå¶ä»ç½ç«ç Cookieã\n\næ­£å¸¸æåµä¸ï¼åä¸ä¸ªä¸çº§ååçä¸¤ä¸ªäºçº§ååä¹é´ä¹ä¸è½äºç¸ä½¿ç¨ Cookieãå¦ææ³è®©æååä¸çå­ååä¹å¯ä»¥ä½¿ç¨è¯¥ Cookieï¼éè¦è®¾ç½® Cookie ç domain åæ°ã\n\nJava ä¸­ä½¿ç¨setDomain(Stringdomain)ågetDomain()æ¹æ³æ¥è®¾ç½®ãè·å domainã\n\n\n# Cookie çè·¯å¾\n\nPath å±æ§å³å®åè®¸è®¿é® Cookie çè·¯å¾ã\n\nJava ä¸­ä½¿ç¨setPath(Stringuri)ågetPath()æ¹æ³æ¥è®¾ç½®ãè·å pathã\n\n\n# Cookie çå®å¨å±æ§\n\nHTTP åè®®ä¸ä»æ¯æ ç¶æçï¼èä¸æ¯ä¸å®å¨çã\n\nä½¿ç¨ HTTP åè®®çæ°æ®ä¸ç»è¿ä»»ä½å å¯å°±ç´æ¥å¨ç½ç»ä¸ä¼ æ­ï¼æè¢«æªè·çå¯è½ãå¦æä¸å¸æ Cookie å¨ HTTP ç­éå®å¨åè®®ä¸­ä¼ è¾ï¼å¯ä»¥è®¾ç½® Cookie ç secure å±æ§ä¸º trueãæµè§å¨åªä¼å¨ HTTPS å SSL ç­å®å¨åè®®ä¸­ä¼ è¾æ­¤ç±» Cookieã\n\nJava ä¸­ä½¿ç¨setSecure(booleanflag)ågetSecure ()æ¹æ³æ¥è®¾ç½®ãè·å Secureã\n\n\n# Cookie å®ä¾\n\n# æ·»å  Cookie\n\néè¿ Servlet æ·»å  Cookies åæ¬ä¸ä¸ªæ­¥éª¤ï¼\n\n 1. åå»ºä¸ä¸ª Cookie å¯¹è±¡ï¼æ¨å¯ä»¥è°ç¨å¸¦æ cookie åç§°å cookie å¼ç Cookie æé å½æ°ï¼cookie åç§°å cookie å¼é½æ¯å­ç¬¦ä¸²ã\n\n 2. è®¾ç½®æå¤§çå­å¨æï¼æ¨å¯ä»¥ä½¿ç¨ setMaxAge æ¹æ³æ¥æå® cookie è½å¤ä¿æææçæ¶é´ï¼ä»¥ç§ä¸ºåä½ï¼ã\n\n 3. åé Cookie å° HTTP ååºå¤´ï¼æ¨å¯ä»¥ä½¿ç¨ response.addCookie æ¥æ·»å  HTTP ååºå¤´ä¸­ç Cookiesã\n\nAddCookies.java\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.net.URLEncoder;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.Cookie;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet("/servlet/AddCookies")\npublic class AddCookies extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public AddCookies() {\n        super();\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    public void doGet(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        // ä¸ºåå­åå§æ°åå»º Cookie\n        Cookie name = new Cookie("name", URLEncoder.encode(request.getParameter("name"), "UTF-8")); // ä¸­æè½¬ç \n        Cookie url = new Cookie("url", request.getParameter("url"));\n\n        // ä¸ºä¸¤ä¸ª Cookie è®¾ç½®è¿ææ¥æä¸º 24 å°æ¶å\n        name.setMaxAge(60 * 60 * 24);\n        url.setMaxAge(60 * 60 * 24);\n\n        // å¨ååºå¤´ä¸­æ·»å ä¸¤ä¸ª Cookie\n        response.addCookie(name);\n        response.addCookie(url);\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setContentType("text/html;charset=UTF-8");\n\n        PrintWriter out = response.getWriter();\n        String title = "è®¾ç½® Cookie å®ä¾";\n        String docType = "<!DOCTYPE html>\\n";\n        out.println(docType + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n" + "<h1 align=\\"center\\">" + title\n                        + "</h1>\\n" + "<ul>\\n" + "  <li><b>ç«ç¹åï¼</b>ï¼" + request.getParameter("name")\n                        + "\\n</li>" + "  <li><b>ç«ç¹ URLï¼</b>ï¼" + request.getParameter("url")\n                        + "\\n</li>" + "</ul>\\n" + "</body></html>");\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        doGet(request, response);\n    }\n\n}\n\n\naddCookies.jsp\n\n<%@ page language="java" pageEncoding="UTF-8" %>\n<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>æ·»å Cookie</title>\n</head>\n<body>\n<form action=/servlet/AddCookies method="GET">\n  ç«ç¹å ï¼<input type="text" name="name">\n  <br/>\n  ç«ç¹ URLï¼<input type="text" name="url"/><br>\n  <input type="submit" value="æäº¤"/>\n</form>\n</body>\n</html>\n\n\n# æ¾ç¤º Cookie\n\nè¦è¯»å Cookiesï¼æ¨éè¦éè¿è°ç¨ HttpServletRequest ç getCookies() æ¹æ³åå»ºä¸ä¸ª javax.servlet.http.Cookie å¯¹è±¡çæ°ç»ãç¶åå¾ªç¯éåæ°ç»ï¼å¹¶ä½¿ç¨ getName() å getValue() æ¹æ³æ¥è®¿é®æ¯ä¸ª cookie åå³èçå¼ã\n\nReadCookies.java\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.net.URLDecoder;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.Cookie;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet("/servlet/ReadCookies")\npublic class ReadCookies extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public ReadCookies() {\n        super();\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    public void doGet(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        Cookie cookie = null;\n        Cookie[] cookies = null;\n        // è·åä¸è¯¥åç¸å³ç Cookie çæ°ç»\n        cookies = request.getCookies();\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setContentType("text/html;charset=UTF-8");\n\n        PrintWriter out = response.getWriter();\n        String title = "Delete Cookie Example";\n        String docType = "<!DOCTYPE html>\\n";\n        out.println(docType + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n");\n        if (cookies != null) {\n            out.println("<h2>Cookie åç§°åå¼</h2>");\n            for (int i = 0; i < cookies.length; i++) {\n                cookie = cookies[i];\n                if ((cookie.getName()).compareTo("name") == 0) {\n                    cookie.setMaxAge(0);\n                    response.addCookie(cookie);\n                    out.print("å·²å é¤ç cookieï¼" + cookie.getName() + "<br/>");\n                }\n                out.print("åç§°ï¼" + cookie.getName() + "ï¼");\n                out.print("å¼ï¼" + URLDecoder.decode(cookie.getValue(), "utf-8") + " <br/>");\n            }\n        } else {\n            out.println("<h2 class=\\"tutheader\\">No Cookie founds</h2>");\n        }\n        out.println("</body>");\n        out.println("</html>");\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        doGet(request, response);\n    }\n\n}\n\n\n# å é¤ Cookie\n\nJava ä¸­å¹¶æ²¡ææä¾ç´æ¥å é¤ Cookie çæ¹æ³ï¼å¦ææ³è¦å é¤ä¸ä¸ª Cookieï¼ç´æ¥å°è¿ä¸ª Cookie çæææè®¾ä¸º 0 å°±å¯ä»¥äºãæ­¥éª¤å¦ä¸ï¼\n\n 1. è¯»åä¸ä¸ªç°æç cookieï¼å¹¶æå®å­å¨å¨ Cookie å¯¹è±¡ä¸­ã\n\n 2. ä½¿ç¨ setMaxAge() æ¹æ³è®¾ç½® cookie çå¹´é¾ä¸ºé¶ï¼æ¥å é¤ç°æç cookieã\n\n 3. æè¿ä¸ª cookie æ·»å å°ååºå¤´ã\n\nDeleteCookies.java\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.Cookie;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet("/servlet/DeleteCookies")\npublic class DeleteCookies extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public DeleteCookies() {\n        super();\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    public void doGet(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        Cookie cookie = null;\n        Cookie[] cookies = null;\n        // è·åä¸è¯¥åç¸å³ç Cookie çæ°ç»\n        cookies = request.getCookies();\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setContentType("text/html;charset=UTF-8");\n\n        PrintWriter out = response.getWriter();\n        String title = "å é¤ Cookie å®ä¾";\n        String docType = "<!DOCTYPE html>\\n";\n        out.println(docType + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n");\n        if (cookies != null) {\n            out.println("<h2>Cookie åç§°åå¼</h2>");\n            for (int i = 0; i < cookies.length; i++) {\n                cookie = cookies[i];\n                if ((cookie.getName()).compareTo("url") == 0) {\n                    cookie.setMaxAge(0);\n                    response.addCookie(cookie);\n                    out.print("å·²å é¤ç cookieï¼" + cookie.getName() + "<br/>");\n                }\n                out.print("åç§°ï¼" + cookie.getName() + "ï¼");\n                out.print("å¼ï¼" + cookie.getValue() + " <br/>");\n            }\n        } else {\n            out.println("<h2 class=\\"tutheader\\">No Cookie founds</h2>");\n        }\n        out.println("</body>");\n        out.println("</html>");\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        doGet(request, response);\n    }\n\n}\n\n\n\n# Session\n\n\n# Session æ¯ä»ä¹\n\nä¸åäº Cookie ä¿å­å¨å®¢æ·ç«¯æµè§å¨ä¸­ï¼Session ä¿å­å¨æå¡å¨ä¸ã\n\nå¦æè¯´ Cookie æºå¶æ¯éè¿æ£æ¥å®¢æ·èº«ä¸çâéè¡è¯âæ¥ç¡®å®å®¢æ·èº«ä»½çè¯ï¼é£ä¹ Session æºå¶å°±æ¯éè¿æ£æ¥æå¡å¨ä¸çâå®¢æ·æç»è¡¨âæ¥ç¡®è®¤å®¢æ·èº«ä»½ã\n\nSession å¯¹åºçç±»ä¸º javax.servlet.http.HttpSession ç±»ãSession å¯¹è±¡æ¯å¨å®¢æ·ç¬¬ä¸æ¬¡è¯·æ±æå¡å¨æ¶åå»ºçã\n\n\n# Session ç±»ä¸­çæ¹æ³\n\njavax.servlet.http.HttpSession ç±»ä¸­çæ¹æ³ï¼\n\næ¹æ³                                                    åè½\npublic Object getAttribute(String name)               è¯¥æ¹æ³è¿åå¨è¯¥ session ä¼è¯ä¸­å·ææå®åç§°çå¯¹è±¡ï¼å¦ææ²¡ææå®åç§°çå¯¹è±¡ï¼åè¿å nullã\npublic Enumeration getAttributeNames()                è¯¥æ¹æ³è¿å String å¯¹è±¡çæä¸¾ï¼String å¯¹è±¡åå«ææç»å®å°è¯¥ session ä¼è¯çå¯¹è±¡çåç§°ã\npublic long getCreationTime()                         è¯¥æ¹æ³è¿åè¯¥ session ä¼è¯è¢«åå»ºçæ¶é´ï¼èªæ ¼æå°¼æ²»æ åæ¶é´ 1970 å¹´ 1 æ 1 æ¥åå¤ç®èµ·ï¼ä»¥æ¯«ç§ä¸ºåä½ã\npublic String getId()                                 è¯¥æ¹æ³è¿åä¸ä¸ªåå«åéç»è¯¥ session ä¼è¯çå¯ä¸æ è¯ç¬¦çå­ç¬¦ä¸²ã\npublic long getLastAccessedTime()                     è¯¥æ¹æ³è¿åå®¢æ·ç«¯æåä¸æ¬¡åéä¸è¯¥ session ä¼è¯ç¸å³çè¯·æ±çæ¶é´èªæ ¼æå°¼æ²»æ åæ¶é´ 1970 å¹´ 1 æ 1\n                                                      æ¥åå¤ç®èµ·ï¼ä»¥æ¯«ç§ä¸ºåä½ã\npublic int getMaxInactiveInterval()                   è¯¥æ¹æ³è¿å Servlet å®¹å¨å¨å®¢æ·ç«¯è®¿é®æ¶ä¿æ session ä¼è¯æå¼çæå¤§æ¶é´é´éï¼ä»¥ç§ä¸ºåä½ã\npublic void invalidate()                              è¯¥æ¹æ³æç¤ºè¯¥ session ä¼è¯æ æï¼å¹¶è§£é¤ç»å®å°å®ä¸é¢çä»»ä½å¯¹è±¡ã\npublic boolean isNew()                                å¦æå®¢æ·ç«¯è¿ä¸ç¥éè¯¥ session ä¼è¯ï¼æèå¦æå®¢æ·éæ©ä¸åå¥è¯¥ session ä¼è¯ï¼åè¯¥æ¹æ³è¿å trueã\npublic void removeAttribute(String name)              è¯¥æ¹æ³å°ä»è¯¥ session ä¼è¯ç§»é¤æå®åç§°çå¯¹è±¡ã\npublic void setAttribute(String name, Object value)   è¯¥æ¹æ³ä½¿ç¨æå®çåç§°ç»å®ä¸ä¸ªå¯¹è±¡å°è¯¥ session ä¼è¯ã\npublic void setMaxInactiveInterval(int interval)      è¯¥æ¹æ³å¨ Servlet å®¹å¨æç¤ºè¯¥ session ä¼è¯æ æä¹åï¼æå®å®¢æ·ç«¯è¯·æ±ä¹é´çæ¶é´ï¼ä»¥ç§ä¸ºåä½ã\n\n\n# Session çæææ\n\nç±äºä¼æè¶æ¥è¶å¤çç¨æ·è®¿é®æå¡å¨ï¼å æ­¤ Session ä¹ä¼è¶æ¥è¶å¤ãä¸ºé²æ­¢åå­æº¢åºï¼æå¡å¨ä¼æé¿æ¶é´æ²¡ææ´»è·ç Session ä»åå­ä¸­å é¤ã\n\nSession çè¶æ¶æ¶é´ä¸ºmaxInactiveIntervalå±æ§ï¼å¯ä»¥éè¿getMaxInactiveInterval()ãsetMaxInactiveInterval(longinterval)æ¥è¯»åè¿ä¸ªå±æ§ã\n\nTomcat ä¸­ Session çé»è®¤è¶æ¶æ¶é´ä¸º 20 åéãå¯ä»¥ä¿®æ¹ web.xml æ¹å Session çé»è®¤è¶æ¶æ¶é´ã\n\nä¾ï¼\n\n<session-config>\n  <session-timeout>60</session-timeout>\n</session-config>\n\n\n\n# Session å¯¹æµè§å¨çè¦æ±\n\nHTTP åè®®æ¯æ ç¶æçï¼Session ä¸è½ä¾æ® HTTP è¿æ¥æ¥å¤æ­æ¯å¦ä¸ºåä¸å®¢æ·ãå æ­¤æå¡å¨åå®¢æ·ç«¯æµè§å¨åéä¸ä¸ªåä¸º JESSIONID ç Cookieï¼ä»çå¼ä¸ºè¯¥ Session ç idï¼ä¹å°±æ¯ HttpSession.getId()çè¿åå¼ï¼ãSession ä¾æ®è¯¥ Cookie æ¥è¯å«æ¯å¦ä¸ºåä¸ç¨æ·ã\n\nè¯¥ Cookie ä¸ºæå¡å¨èªå¨çæçï¼å®çmaxAgeå±æ§ä¸è¬ä¸º-1ï¼è¡¨ç¤ºä»å½åæµè§å¨åææï¼å¹¶ä¸åæµè§å¨çªå£é´ä¸å±äº«ï¼å³é­æµè§å¨å°±ä¼å¤±æã\n\n\n# URL å°åéå\n\nURL å°åéåçåçæ¯å°è¯¥ç¨æ· Session ç id ä¿¡æ¯éåå° URL å°åä¸­ãæå¡å¨è½å¤è§£æéååç URL è·å Session ç idãè¿æ ·å³ä½¿å®¢æ·ç«¯ä¸æ¯æ Cookieï¼ä¹å¯ä»¥ä½¿ç¨ Session æ¥è®°å½ç¨æ·ç¶æã\n\nHttpServletResponseç±»æä¾äºencodeURL(Stringurl)å®ç° URL å°åéåã\n\n\n# Session ä¸­ç¦ç¨ Cookie\n\nå¨META-INF/context.xmlä¸­ç¼è¾å¦ä¸ï¼\n\n<Context path="/SessionNotes" cookies="true">\n</Context>\n\n\né¨ç½²åï¼TOMCAT ä¾¿ä¸ä¼èªå¨çæå JESSIONID ç Cookieï¼Session ä¹ä¸ä¼ä»¥ Cookie ä¸ºè¯å«æ å¿ï¼èä»ä»ä»¥éååç URL å°åä¸ºè¯å«æ å¿äºã\n\n\n# Session å®ä¾\n\n# Session è·è¸ª\n\nSessionTrackServlet.java\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\n\n@WebServlet("/servlet/SessionTrackServlet")\npublic class SessionTrackServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    public void doGet(HttpServletRequest request, HttpServletResponse response)\n                    throws ServletException, IOException {\n        // å¦æä¸å­å¨ session ä¼è¯ï¼ååå»ºä¸ä¸ª session å¯¹è±¡\n        HttpSession session = request.getSession(true);\n        // è·å session åå»ºæ¶é´\n        Date createTime = new Date(session.getCreationTime());\n        // è·åè¯¥ç½é¡µçæåä¸æ¬¡è®¿é®æ¶é´\n        Date lastAccessTime = new Date(session.getLastAccessedTime());\n\n        // è®¾ç½®æ¥æè¾åºçæ ¼å¼\n        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n\n        String title = "Servlet Session å®ä¾";\n        Integer visitCount = new Integer(0);\n        String visitCountKey = new String("visitCount");\n        String userIDKey = new String("userID");\n        String userID = new String("admin");\n\n        // æ£æ¥ç½é¡µä¸æ¯å¦ææ°çè®¿é®è\n        if (session.isNew()) {\n            session.setAttribute(userIDKey, userID);\n        } else {\n            visitCount = (Integer) session.getAttribute(visitCountKey);\n            visitCount = visitCount + 1;\n            userID = (String) session.getAttribute(userIDKey);\n        }\n        session.setAttribute(visitCountKey, visitCount);\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setContentType("text/html;charset=UTF-8");\n        PrintWriter out = response.getWriter();\n\n        String docType = "<!DOCTYPE html>\\n";\n        out.println(docType + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n" + "<h1 align=\\"center\\">" + title\n                        + "</h1>\\n" + "<h2 align=\\"center\\">Session ä¿¡æ¯</h2>\\n"\n                        + "<table border=\\"1\\" align=\\"center\\">\\n" + "<tr bgcolor=\\"#949494\\">\\n"\n                        + "  <th>Session ä¿¡æ¯</th><th>å¼</th></tr>\\n" + "<tr>\\n" + "  <td>id</td>\\n"\n                        + "  <td>" + session.getId() + "</td></tr>\\n" + "<tr>\\n"\n                        + "  <td>åå»ºæ¶é´</td>\\n" + "  <td>" + df.format(createTime) + "  </td></tr>\\n"\n                        + "<tr>\\n" + "  <td>æåè®¿é®æ¶é´</td>\\n" + "  <td>" + df.format(lastAccessTime)\n                        + "  </td></tr>\\n" + "<tr>\\n" + "  <td>ç¨æ· ID</td>\\n" + "  <td>" + userID\n                        + "  </td></tr>\\n" + "<tr>\\n" + "  <td>è®¿é®ç»è®¡ï¼</td>\\n" + "  <td>" + visitCount\n                        + "</td></tr>\\n" + "</table>\\n" + "</body></html>");\n    }\n}\n\n\nweb.xml\n\n<servlet>\n  <servlet-name>SessionTrackServlet</servlet-name>\n  <servlet-class>SessionTrackServlet</servlet-class>\n</servlet>\n<servlet-mapping>\n  <servlet-name>SessionTrackServlet</servlet-name>\n  <url-pattern>/servlet/SessionTrackServlet</url-pattern>\n</servlet-mapping>\n\n\n# å é¤ Session ä¼è¯æ°æ®\n\nå½æ¨å®æäºä¸ä¸ªç¨æ·ç session ä¼è¯æ°æ®ï¼æ¨æä»¥ä¸å ç§éæ©ï¼\n\n**ç§»é¤ä¸ä¸ªç¹å®çå±æ§ï¼**æ¨å¯ä»¥è°ç¨ removeAttribute(String name) æ¹æ³æ¥å é¤ä¸ç¹å®çé®ç¸å³èçå¼ã\n\n**å é¤æ´ä¸ª session ä¼è¯ï¼**æ¨å¯ä»¥è°ç¨ invalidate() æ¹æ³æ¥ä¸¢å¼æ´ä¸ª session ä¼è¯ã\n\n**è®¾ç½® session ä¼è¯è¿ææ¶é´ï¼**æ¨å¯ä»¥è°ç¨ setMaxInactiveInterval(int interval) æ¹æ³æ¥åç¬è®¾ç½® session ä¼è¯è¶æ¶ã\n\n**æ³¨éç¨æ·ï¼**å¦æä½¿ç¨çæ¯æ¯æ servlet 2.4 çæå¡å¨ï¼æ¨å¯ä»¥è°ç¨ logout æ¥æ³¨é Web æå¡å¨çå®¢æ·ç«¯ï¼å¹¶æå±äºææç¨æ·çææ session ä¼è¯è®¾ç½®ä¸ºæ æã\n\n**web.xml éç½®ï¼**å¦ææ¨ä½¿ç¨çæ¯ Tomcatï¼é¤äºä¸è¿°æ¹æ³ï¼æ¨è¿å¯ä»¥å¨ web.xml æä»¶ä¸­éç½® session ä¼è¯è¶æ¶ï¼å¦ä¸æç¤ºï¼\n\n<session-config>\n  <session-timeout>15</session-timeout>\n</session-config>\n\n\nä¸é¢å®ä¾ä¸­çè¶æ¶æ¶é´æ¯ä»¥åéä¸ºåä½ï¼å°è¦ç Tomcat ä¸­é»è®¤ç 30 åéè¶æ¶æ¶é´ã\n\nå¨ä¸ä¸ª Servlet ä¸­ç getMaxInactiveInterval() æ¹æ³ä¼è¿å session ä¼è¯çè¶æ¶æ¶é´ï¼ä»¥ç§ä¸ºåä½ãæä»¥ï¼å¦æå¨ web.xml ä¸­éç½® session ä¼è¯è¶æ¶æ¶é´ä¸º 15 åéï¼é£ä¹getMaxInactiveInterval() ä¼è¿å 900ã\n\n\n# Cookie vs Session\n\n\n# å­åæ¹å¼\n\nCookie åªè½ä¿å­ASCIIå­ç¬¦ä¸²ï¼å¦æéè¦å­å Unicode å­ç¬¦æäºè¿å¶æ°æ®ï¼éè¦è¿è¡UTF-8ãGBKæBASE64ç­æ¹å¼çç¼ç ã\n\nSession å¯ä»¥å­åä»»ä½ç±»åçæ°æ®ï¼çè³æ¯ä»»ä½ Java ç±»ãå¯ä»¥å° Session çææ¯ä¸ä¸ª Java å®¹å¨ç±»ã\n\n\n# éç§å®å¨\n\nCookie å­äºå®¢æ·ç«¯æµè§å¨ï¼ä¸äºå®¢æ·ç«¯çç¨åºå¯è½ä¼çª¥æ¢ãå¤å¶æä¿®æ¹ Cookie åå®¹ã\n\nSession å­äºæå¡å¨ï¼å¯¹å®¢æ·ç«¯æ¯éæçï¼ä¸å­å¨ææä¿¡æ¯æ³é²çå±é©ã\n\n\n# æææ\n\nä½¿ç¨ Cookie å¯ä»¥ä¿è¯é¿æ¶é´ç»å½ææï¼åªè¦è®¾ç½® Cookie çmaxAgeå±æ§ä¸ºä¸ä¸ªå¾å¤§çæ°å­ã\n\nè Session è½ç¶çè®ºä¸ä¹å¯ä»¥éè¿è®¾ç½®å¾å¤§çæ°å¼æ¥ä¿æé¿æ¶é´ç»å½ææï¼ä½æ¯ï¼ç±äº Session ä¾èµäºåä¸ºJESSIONIDç Cookieï¼è Cookie JESSIONIDçmaxAgeé»è®¤ä¸º-1ï¼åªè¦å³é­äºæµè§å¨è¯¥ Session å°±ä¼å¤±æï¼å æ­¤ï¼Session ä¸è½å®ç°ä¿¡æ¯æ°¸ä¹ææçææãä½¿ç¨ URL å°åéåä¹ä¸è½å®ç°ã\n\n\n# æå¡å¨çå¼é\n\nç±äº Session æ¯ä¿å­å¨æå¡å¨çï¼æ¯ä¸ªç¨æ·é½ä¼äº§çä¸ä¸ª Sessionï¼å¦æå¹¶åè®¿é®çç¨æ·éå¸¸å¤ï¼ä¼äº§çå¾å¤ç Sessionï¼æ¶èå¤§éçåå­ã\n\nè Cookie ç±äºä¿å­å¨å®¢æ·ç«¯æµè§å¨ä¸ï¼æä»¥ä¸å ç¨æå¡å¨èµæºã\n\n\n# æµè§å¨çæ¯æ\n\nCookie éè¦æµè§å¨æ¯ææè½ä½¿ç¨ã\n\nå¦ææµè§å¨ä¸æ¯æ Cookieï¼éè¦ä½¿ç¨ Session ä»¥å URL å°åéåã\n\néè¦æ³¨æçäºææçç¨å° Session ç¨åºç URL é½è¦ä½¿ç¨response.encodeURL(StringURL) æresponse.encodeRediretURL(String URL)è¿è¡ URL å°åéåï¼å¦åå¯¼è´ Session ä¼è¯è·è¸ªå¤±æã\n\n\n# è·¨åå\n\n * Cookie æ¯æè·¨ååã\n * Session ä¸æ¯æè·¨ååã',normalizedContent:'# javaweb ä¹ cookie å session\n\n\n# cookie\n\nç±äº http æ¯ä¸ç§æ ç¶æçåè®®ï¼æå¡å¨åä»ç½ç»è¿æ¥ä¸æ ä»ç¥éå®¢æ·èº«ä»½ã\n\nä¼è¯è·è¸ªæ¯ web ç¨åºä¸­å¸¸ç¨çææ¯ï¼ç¨æ¥è·è¸ªç¨æ·çæ´ä¸ªä¼è¯ãå¸¸ç¨ä¼è¯è·è¸ªææ¯æ¯ cookie ä¸ sessionã\n\n\n# cookie æ¯ä»ä¹\n\ncookie å®éä¸æ¯å­å¨å¨å®¢æ·ç«¯ä¸çææ¬ä¿¡æ¯ï¼å¹¶ä¿çäºåç§è·è¸ªçä¿¡æ¯ã\n\ncookie å·¥ä½æ­¥éª¤ï¼\n\n 1. å®¢æ·ç«¯è¯·æ±æå¡å¨ï¼å¦ææå¡å¨éè¦è®°å½è¯¥ç¨æ·çç¶æï¼å°±æ¯ç¨ response åå®¢æ·ç«¯æµè§å¨é¢åä¸ä¸ª cookieã\n 2. å®¢æ·ç«¯æµè§å¨ä¼æ cookie ä¿å­ä¸æ¥ã\n 3. å½æµè§å¨åè¯·æ±è¯¥ç½ç«æ¶ï¼æµè§å¨æè¯¥è¯·æ±çç½åè¿å cookie ä¸åæäº¤ç»æå¡å¨ãæå¡å¨æ£æ¥è¯¥ cookieï¼ä»¥æ­¤æ¥è¾¨è®¤ç¨æ·ç¶æã\n\næ³¨ï¼cookie åè½éè¦æµè§å¨çæ¯æï¼å¦ææµè§å¨ä¸æ¯æ cookie æè cookie ç¦ç¨äºï¼cookie åè½å°±ä¼å¤±æã\n\njava ä¸­æ cookie å°è£æäºjavax.servlet.http.cookieç±»ã\n\n\n# cookie åæ\n\ncookies éå¸¸è®¾ç½®å¨ http å¤´ä¿¡æ¯ä¸­ï¼è½ç¶ javascript ä¹å¯ä»¥ç´æ¥å¨æµè§å¨ä¸è®¾ç½®ä¸ä¸ª cookieï¼ã\n\nè®¾ç½® cookie ç servlet ä¼åéå¦ä¸çå¤´ä¿¡æ¯ï¼\n\nhttp/1.1 200 ok\ndate: fri, 04 feb 2000 21:03:38 gmt\nserver: apache/1.3.9 (unix) php/4.0b3\nset-cookie: name=xyz; expires=friday, 04-feb-07 22:03:38 gmt;\n                 path=/; domain=w3cschool.cc\nconnection: close\ncontent-type: text/html\n\n\næ­£å¦æ¨æçå°çï¼set-cookie å¤´åå«äºä¸ä¸ªåç§°å¼å¯¹ãä¸ä¸ª gmt æ¥æãä¸ä¸ªè·¯å¾åä¸ä¸ªåãåç§°åå¼ä¼è¢« url ç¼ç ãexpires å­æ®µæ¯ä¸ä¸ªæä»¤ï¼åè¯æµè§å¨å¨ç»å®çæ¶é´åæ¥æä¹å"å¿è®°"è¯¥ cookieã\n\nå¦ææµè§å¨è¢«éç½®ä¸ºå­å¨ cookiesï¼å®å°ä¼ä¿çæ­¤ä¿¡æ¯ç´å°å°ææ¥æãå¦æç¨æ·çæµè§å¨æåä»»ä½å¹éè¯¥ cookie çè·¯å¾ååçé¡µé¢ï¼å®ä¼éæ°åé cookie å°æå¡å¨ãæµè§å¨çå¤´ä¿¡æ¯å¯è½å¦ä¸æç¤ºï¼\n\nget / http/1.0\nconnection: keep-alive\nuser-agent: mozilla/4.6 (x11; i; linux 2.2.6-15apmac ppc)\nhost: zink.demon.co.uk:1126\naccept: image/gif, */*\naccept-encoding: gzip\naccept-language: en\naccept-charset: iso-8859-1,*,utf-8\ncookie: name=xyz\n\n\n\n# cookie ç±»ä¸­çæ¹æ³\n\næ¹æ³                                       åè½\npublic void setdomain(string pattern)    è¯¥æ¹æ³è®¾ç½® cookie éç¨çåã\npublic string getdomain()                è¯¥æ¹æ³è·å cookie éç¨çåã\npublic void setmaxage(int expiry)        è¯¥æ¹æ³è®¾ç½® cookie è¿æçæ¶é´ï¼ä»¥ç§ä¸ºåä½ï¼ãå¦æä¸è¿æ ·è®¾ç½®ï¼cookie åªä¼å¨å½å session\n                                         ä¼è¯ä¸­æç»­ææã\npublic int getmaxage()                   è¯¥æ¹æ³è¿å cookie çæå¤§çå­å¨æï¼ä»¥ç§ä¸ºåä½ï¼ï¼é»è®¤æåµä¸ï¼-1 è¡¨ç¤º cookie\n                                         å°æç»­ä¸å»ï¼ç´å°æµè§å¨å³é­ã\npublic string getname()                  è¯¥æ¹æ³è¿å cookie çåç§°ãåç§°å¨åå»ºåä¸è½æ¹åã\npublic void setvalue(string newvalue)    è¯¥æ¹æ³è®¾ç½®ä¸ cookie å³èçå¼ã\npublic string getvalue()                 è¯¥æ¹æ³è·åä¸ cookie å³èçå¼ã\npublic void setpath(string uri)          è¯¥æ¹æ³è®¾ç½® cookie éç¨çè·¯å¾ãå¦ææ¨ä¸æå®è·¯å¾ï¼ä¸å½åé¡µé¢ç¸åç®å½ä¸çï¼åæ¬å­ç®å½ä¸çï¼ææ url é½ä¼è¿å\n                                         cookieã\npublic string getpath()                  è¯¥æ¹æ³è·å cookie éç¨çè·¯å¾ã\npublic void setsecure(boolean flag)      è¯¥æ¹æ³è®¾ç½®å¸å°å¼ï¼åæµè§å¨æç¤ºï¼åªä¼å¨ https å ssl ç­å®å¨åè®®ä¸­ä¼ è¾æ­¤ç±» cookieã\npublic void setcomment(string purpose)   è¯¥æ¹æ³è§å®äºæè¿° cookie ç®ççæ³¨éãè¯¥æ³¨éå¨æµè§å¨åç¨æ·åç° cookie æ¶éå¸¸æç¨ã\npublic string getcomment()               è¯¥æ¹æ³è¿åäºæè¿° cookie ç®ççæ³¨éï¼å¦æ cookie æ²¡ææ³¨éåè¿å nullã\n\n\n# cookie çæææ\n\ncookieçmaxageå³å®ç cookie çæææï¼åä½ä¸ºç§ã\n\nå¦æ maxage ä¸º 0ï¼åè¡¨ç¤ºå é¤è¯¥ cookieï¼\n\nå¦æä¸ºè´æ°ï¼è¡¨ç¤ºè¯¥ cookie ä»å¨æ¬æµè§å¨ä¸­ä»¥åæ¬çªå£æå¼çå­çªå£åææï¼å³é­çªå£åè¯¥ cookie å³å¤±æã\n\ncookie ä¸­æä¾getmaxage()åsetmaxage(int expiry)æ¹æ³æ¥è¯»åmaxageå±æ§ã\n\n\n# cookie çåå\n\ncookie æ¯ä¸å¯ä»¥è·¨ååçãåå www.google.com é¢åç cookie ä¸ä¼è¢«æäº¤å°åå www.baidu.com å»ãè¿æ¯ç± cookie çéç§å®å¨æºå¶å³å®çãéç§å®å¨æºå¶è½å¤ç¦æ­¢ç½ç«éæ³è·åå¶ä»ç½ç«ç cookieã\n\næ­£å¸¸æåµä¸ï¼åä¸ä¸ªä¸çº§ååçä¸¤ä¸ªäºçº§ååä¹é´ä¹ä¸è½äºç¸ä½¿ç¨ cookieãå¦ææ³è®©æååä¸çå­ååä¹å¯ä»¥ä½¿ç¨è¯¥ cookieï¼éè¦è®¾ç½® cookie ç domain åæ°ã\n\njava ä¸­ä½¿ç¨setdomain(stringdomain)ågetdomain()æ¹æ³æ¥è®¾ç½®ãè·å domainã\n\n\n# cookie çè·¯å¾\n\npath å±æ§å³å®åè®¸è®¿é® cookie çè·¯å¾ã\n\njava ä¸­ä½¿ç¨setpath(stringuri)ågetpath()æ¹æ³æ¥è®¾ç½®ãè·å pathã\n\n\n# cookie çå®å¨å±æ§\n\nhttp åè®®ä¸ä»æ¯æ ç¶æçï¼èä¸æ¯ä¸å®å¨çã\n\nä½¿ç¨ http åè®®çæ°æ®ä¸ç»è¿ä»»ä½å å¯å°±ç´æ¥å¨ç½ç»ä¸ä¼ æ­ï¼æè¢«æªè·çå¯è½ãå¦æä¸å¸æ cookie å¨ http ç­éå®å¨åè®®ä¸­ä¼ è¾ï¼å¯ä»¥è®¾ç½® cookie ç secure å±æ§ä¸º trueãæµè§å¨åªä¼å¨ https å ssl ç­å®å¨åè®®ä¸­ä¼ è¾æ­¤ç±» cookieã\n\njava ä¸­ä½¿ç¨setsecure(booleanflag)ågetsecure ()æ¹æ³æ¥è®¾ç½®ãè·å secureã\n\n\n# cookie å®ä¾\n\n# æ·»å  cookie\n\néè¿ servlet æ·»å  cookies åæ¬ä¸ä¸ªæ­¥éª¤ï¼\n\n 1. åå»ºä¸ä¸ª cookie å¯¹è±¡ï¼æ¨å¯ä»¥è°ç¨å¸¦æ cookie åç§°å cookie å¼ç cookie æé å½æ°ï¼cookie åç§°å cookie å¼é½æ¯å­ç¬¦ä¸²ã\n\n 2. è®¾ç½®æå¤§çå­å¨æï¼æ¨å¯ä»¥ä½¿ç¨ setmaxage æ¹æ³æ¥æå® cookie è½å¤ä¿æææçæ¶é´ï¼ä»¥ç§ä¸ºåä½ï¼ã\n\n 3. åé cookie å° http ååºå¤´ï¼æ¨å¯ä»¥ä½¿ç¨ response.addcookie æ¥æ·»å  http ååºå¤´ä¸­ç cookiesã\n\naddcookies.java\n\nimport java.io.ioexception;\nimport java.io.printwriter;\nimport java.net.urlencoder;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.annotation.webservlet;\nimport javax.servlet.http.cookie;\nimport javax.servlet.http.httpservlet;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\n\n@webservlet("/servlet/addcookies")\npublic class addcookies extends httpservlet {\n    private static final long serialversionuid = 1l;\n\n    /**\n     * @see httpservlet#httpservlet()\n     */\n    public addcookies() {\n        super();\n    }\n\n    /**\n     * @see httpservlet#doget(httpservletrequest request, httpservletresponse response)\n     */\n    public void doget(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        // ä¸ºåå­åå§æ°åå»º cookie\n        cookie name = new cookie("name", urlencoder.encode(request.getparameter("name"), "utf-8")); // ä¸­æè½¬ç \n        cookie url = new cookie("url", request.getparameter("url"));\n\n        // ä¸ºä¸¤ä¸ª cookie è®¾ç½®è¿ææ¥æä¸º 24 å°æ¶å\n        name.setmaxage(60 * 60 * 24);\n        url.setmaxage(60 * 60 * 24);\n\n        // å¨ååºå¤´ä¸­æ·»å ä¸¤ä¸ª cookie\n        response.addcookie(name);\n        response.addcookie(url);\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setcontenttype("text/html;charset=utf-8");\n\n        printwriter out = response.getwriter();\n        string title = "è®¾ç½® cookie å®ä¾";\n        string doctype = "<!doctype html>\\n";\n        out.println(doctype + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n" + "<h1 align=\\"center\\">" + title\n                        + "</h1>\\n" + "<ul>\\n" + "  <li><b>ç«ç¹åï¼</b>ï¼" + request.getparameter("name")\n                        + "\\n</li>" + "  <li><b>ç«ç¹ urlï¼</b>ï¼" + request.getparameter("url")\n                        + "\\n</li>" + "</ul>\\n" + "</body></html>");\n    }\n\n    /**\n     * @see httpservlet#dopost(httpservletrequest request, httpservletresponse response)\n     */\n    protected void dopost(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        doget(request, response);\n    }\n\n}\n\n\naddcookies.jsp\n\n<%@ page language="java" pageencoding="utf-8" %>\n<!doctype html public "-//w3c//dtd html 4.01 transitional//en">\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>æ·»å cookie</title>\n</head>\n<body>\n<form action=/servlet/addcookies method="get">\n  ç«ç¹å ï¼<input type="text" name="name">\n  <br/>\n  ç«ç¹ urlï¼<input type="text" name="url"/><br>\n  <input type="submit" value="æäº¤"/>\n</form>\n</body>\n</html>\n\n\n# æ¾ç¤º cookie\n\nè¦è¯»å cookiesï¼æ¨éè¦éè¿è°ç¨ httpservletrequest ç getcookies() æ¹æ³åå»ºä¸ä¸ª javax.servlet.http.cookie å¯¹è±¡çæ°ç»ãç¶åå¾ªç¯éåæ°ç»ï¼å¹¶ä½¿ç¨ getname() å getvalue() æ¹æ³æ¥è®¿é®æ¯ä¸ª cookie åå³èçå¼ã\n\nreadcookies.java\n\nimport java.io.ioexception;\nimport java.io.printwriter;\nimport java.net.urldecoder;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.annotation.webservlet;\nimport javax.servlet.http.cookie;\nimport javax.servlet.http.httpservlet;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\n\n@webservlet("/servlet/readcookies")\npublic class readcookies extends httpservlet {\n    private static final long serialversionuid = 1l;\n\n    /**\n     * @see httpservlet#httpservlet()\n     */\n    public readcookies() {\n        super();\n    }\n\n    /**\n     * @see httpservlet#doget(httpservletrequest request, httpservletresponse response)\n     */\n    public void doget(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        cookie cookie = null;\n        cookie[] cookies = null;\n        // è·åä¸è¯¥åç¸å³ç cookie çæ°ç»\n        cookies = request.getcookies();\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setcontenttype("text/html;charset=utf-8");\n\n        printwriter out = response.getwriter();\n        string title = "delete cookie example";\n        string doctype = "<!doctype html>\\n";\n        out.println(doctype + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n");\n        if (cookies != null) {\n            out.println("<h2>cookie åç§°åå¼</h2>");\n            for (int i = 0; i < cookies.length; i++) {\n                cookie = cookies[i];\n                if ((cookie.getname()).compareto("name") == 0) {\n                    cookie.setmaxage(0);\n                    response.addcookie(cookie);\n                    out.print("å·²å é¤ç cookieï¼" + cookie.getname() + "<br/>");\n                }\n                out.print("åç§°ï¼" + cookie.getname() + "ï¼");\n                out.print("å¼ï¼" + urldecoder.decode(cookie.getvalue(), "utf-8") + " <br/>");\n            }\n        } else {\n            out.println("<h2 class=\\"tutheader\\">no cookie founds</h2>");\n        }\n        out.println("</body>");\n        out.println("</html>");\n    }\n\n    /**\n     * @see httpservlet#dopost(httpservletrequest request, httpservletresponse response)\n     */\n    protected void dopost(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        doget(request, response);\n    }\n\n}\n\n\n# å é¤ cookie\n\njava ä¸­å¹¶æ²¡ææä¾ç´æ¥å é¤ cookie çæ¹æ³ï¼å¦ææ³è¦å é¤ä¸ä¸ª cookieï¼ç´æ¥å°è¿ä¸ª cookie çæææè®¾ä¸º 0 å°±å¯ä»¥äºãæ­¥éª¤å¦ä¸ï¼\n\n 1. è¯»åä¸ä¸ªç°æç cookieï¼å¹¶æå®å­å¨å¨ cookie å¯¹è±¡ä¸­ã\n\n 2. ä½¿ç¨ setmaxage() æ¹æ³è®¾ç½® cookie çå¹´é¾ä¸ºé¶ï¼æ¥å é¤ç°æç cookieã\n\n 3. æè¿ä¸ª cookie æ·»å å°ååºå¤´ã\n\ndeletecookies.java\n\nimport java.io.ioexception;\nimport java.io.printwriter;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.annotation.webservlet;\nimport javax.servlet.http.cookie;\nimport javax.servlet.http.httpservlet;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\n\n@webservlet("/servlet/deletecookies")\npublic class deletecookies extends httpservlet {\n    private static final long serialversionuid = 1l;\n\n    /**\n     * @see httpservlet#httpservlet()\n     */\n    public deletecookies() {\n        super();\n    }\n\n    /**\n     * @see httpservlet#doget(httpservletrequest request, httpservletresponse response)\n     */\n    public void doget(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        cookie cookie = null;\n        cookie[] cookies = null;\n        // è·åä¸è¯¥åç¸å³ç cookie çæ°ç»\n        cookies = request.getcookies();\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setcontenttype("text/html;charset=utf-8");\n\n        printwriter out = response.getwriter();\n        string title = "å é¤ cookie å®ä¾";\n        string doctype = "<!doctype html>\\n";\n        out.println(doctype + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n");\n        if (cookies != null) {\n            out.println("<h2>cookie åç§°åå¼</h2>");\n            for (int i = 0; i < cookies.length; i++) {\n                cookie = cookies[i];\n                if ((cookie.getname()).compareto("url") == 0) {\n                    cookie.setmaxage(0);\n                    response.addcookie(cookie);\n                    out.print("å·²å é¤ç cookieï¼" + cookie.getname() + "<br/>");\n                }\n                out.print("åç§°ï¼" + cookie.getname() + "ï¼");\n                out.print("å¼ï¼" + cookie.getvalue() + " <br/>");\n            }\n        } else {\n            out.println("<h2 class=\\"tutheader\\">no cookie founds</h2>");\n        }\n        out.println("</body>");\n        out.println("</html>");\n    }\n\n    /**\n     * @see httpservlet#dopost(httpservletrequest request, httpservletresponse response)\n     */\n    protected void dopost(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        doget(request, response);\n    }\n\n}\n\n\n\n# session\n\n\n# session æ¯ä»ä¹\n\nä¸åäº cookie ä¿å­å¨å®¢æ·ç«¯æµè§å¨ä¸­ï¼session ä¿å­å¨æå¡å¨ä¸ã\n\nå¦æè¯´ cookie æºå¶æ¯éè¿æ£æ¥å®¢æ·èº«ä¸çâéè¡è¯âæ¥ç¡®å®å®¢æ·èº«ä»½çè¯ï¼é£ä¹ session æºå¶å°±æ¯éè¿æ£æ¥æå¡å¨ä¸çâå®¢æ·æç»è¡¨âæ¥ç¡®è®¤å®¢æ·èº«ä»½ã\n\nsession å¯¹åºçç±»ä¸º javax.servlet.http.httpsession ç±»ãsession å¯¹è±¡æ¯å¨å®¢æ·ç¬¬ä¸æ¬¡è¯·æ±æå¡å¨æ¶åå»ºçã\n\n\n# session ç±»ä¸­çæ¹æ³\n\njavax.servlet.http.httpsession ç±»ä¸­çæ¹æ³ï¼\n\næ¹æ³                                                    åè½\npublic object getattribute(string name)               è¯¥æ¹æ³è¿åå¨è¯¥ session ä¼è¯ä¸­å·ææå®åç§°çå¯¹è±¡ï¼å¦ææ²¡ææå®åç§°çå¯¹è±¡ï¼åè¿å nullã\npublic enumeration getattributenames()                è¯¥æ¹æ³è¿å string å¯¹è±¡çæä¸¾ï¼string å¯¹è±¡åå«ææç»å®å°è¯¥ session ä¼è¯çå¯¹è±¡çåç§°ã\npublic long getcreationtime()                         è¯¥æ¹æ³è¿åè¯¥ session ä¼è¯è¢«åå»ºçæ¶é´ï¼èªæ ¼æå°¼æ²»æ åæ¶é´ 1970 å¹´ 1 æ 1 æ¥åå¤ç®èµ·ï¼ä»¥æ¯«ç§ä¸ºåä½ã\npublic string getid()                                 è¯¥æ¹æ³è¿åä¸ä¸ªåå«åéç»è¯¥ session ä¼è¯çå¯ä¸æ è¯ç¬¦çå­ç¬¦ä¸²ã\npublic long getlastaccessedtime()                     è¯¥æ¹æ³è¿åå®¢æ·ç«¯æåä¸æ¬¡åéä¸è¯¥ session ä¼è¯ç¸å³çè¯·æ±çæ¶é´èªæ ¼æå°¼æ²»æ åæ¶é´ 1970 å¹´ 1 æ 1\n                                                      æ¥åå¤ç®èµ·ï¼ä»¥æ¯«ç§ä¸ºåä½ã\npublic int getmaxinactiveinterval()                   è¯¥æ¹æ³è¿å servlet å®¹å¨å¨å®¢æ·ç«¯è®¿é®æ¶ä¿æ session ä¼è¯æå¼çæå¤§æ¶é´é´éï¼ä»¥ç§ä¸ºåä½ã\npublic void invalidate()                              è¯¥æ¹æ³æç¤ºè¯¥ session ä¼è¯æ æï¼å¹¶è§£é¤ç»å®å°å®ä¸é¢çä»»ä½å¯¹è±¡ã\npublic boolean isnew()                                å¦æå®¢æ·ç«¯è¿ä¸ç¥éè¯¥ session ä¼è¯ï¼æèå¦æå®¢æ·éæ©ä¸åå¥è¯¥ session ä¼è¯ï¼åè¯¥æ¹æ³è¿å trueã\npublic void removeattribute(string name)              è¯¥æ¹æ³å°ä»è¯¥ session ä¼è¯ç§»é¤æå®åç§°çå¯¹è±¡ã\npublic void setattribute(string name, object value)   è¯¥æ¹æ³ä½¿ç¨æå®çåç§°ç»å®ä¸ä¸ªå¯¹è±¡å°è¯¥ session ä¼è¯ã\npublic void setmaxinactiveinterval(int interval)      è¯¥æ¹æ³å¨ servlet å®¹å¨æç¤ºè¯¥ session ä¼è¯æ æä¹åï¼æå®å®¢æ·ç«¯è¯·æ±ä¹é´çæ¶é´ï¼ä»¥ç§ä¸ºåä½ã\n\n\n# session çæææ\n\nç±äºä¼æè¶æ¥è¶å¤çç¨æ·è®¿é®æå¡å¨ï¼å æ­¤ session ä¹ä¼è¶æ¥è¶å¤ãä¸ºé²æ­¢åå­æº¢åºï¼æå¡å¨ä¼æé¿æ¶é´æ²¡ææ´»è·ç session ä»åå­ä¸­å é¤ã\n\nsession çè¶æ¶æ¶é´ä¸ºmaxinactiveintervalå±æ§ï¼å¯ä»¥éè¿getmaxinactiveinterval()ãsetmaxinactiveinterval(longinterval)æ¥è¯»åè¿ä¸ªå±æ§ã\n\ntomcat ä¸­ session çé»è®¤è¶æ¶æ¶é´ä¸º 20 åéãå¯ä»¥ä¿®æ¹ web.xml æ¹å session çé»è®¤è¶æ¶æ¶é´ã\n\nä¾ï¼\n\n<session-config>\n  <session-timeout>60</session-timeout>\n</session-config>\n\n\n\n# session å¯¹æµè§å¨çè¦æ±\n\nhttp åè®®æ¯æ ç¶æçï¼session ä¸è½ä¾æ® http è¿æ¥æ¥å¤æ­æ¯å¦ä¸ºåä¸å®¢æ·ãå æ­¤æå¡å¨åå®¢æ·ç«¯æµè§å¨åéä¸ä¸ªåä¸º jessionid ç cookieï¼ä»çå¼ä¸ºè¯¥ session ç idï¼ä¹å°±æ¯ httpsession.getid()çè¿åå¼ï¼ãsession ä¾æ®è¯¥ cookie æ¥è¯å«æ¯å¦ä¸ºåä¸ç¨æ·ã\n\nè¯¥ cookie ä¸ºæå¡å¨èªå¨çæçï¼å®çmaxageå±æ§ä¸è¬ä¸º-1ï¼è¡¨ç¤ºä»å½åæµè§å¨åææï¼å¹¶ä¸åæµè§å¨çªå£é´ä¸å±äº«ï¼å³é­æµè§å¨å°±ä¼å¤±æã\n\n\n# url å°åéå\n\nurl å°åéåçåçæ¯å°è¯¥ç¨æ· session ç id ä¿¡æ¯éåå° url å°åä¸­ãæå¡å¨è½å¤è§£æéååç url è·å session ç idãè¿æ ·å³ä½¿å®¢æ·ç«¯ä¸æ¯æ cookieï¼ä¹å¯ä»¥ä½¿ç¨ session æ¥è®°å½ç¨æ·ç¶æã\n\nhttpservletresponseç±»æä¾äºencodeurl(stringurl)å®ç° url å°åéåã\n\n\n# session ä¸­ç¦ç¨ cookie\n\nå¨meta-inf/context.xmlä¸­ç¼è¾å¦ä¸ï¼\n\n<context path="/sessionnotes" cookies="true">\n</context>\n\n\né¨ç½²åï¼tomcat ä¾¿ä¸ä¼èªå¨çæå jessionid ç cookieï¼session ä¹ä¸ä¼ä»¥ cookie ä¸ºè¯å«æ å¿ï¼èä»ä»ä»¥éååç url å°åä¸ºè¯å«æ å¿äºã\n\n\n# session å®ä¾\n\n# session è·è¸ª\n\nsessiontrackservlet.java\n\nimport java.io.ioexception;\nimport java.io.printwriter;\nimport java.text.simpledateformat;\nimport java.util.date;\n\nimport javax.servlet.servletexception;\nimport javax.servlet.annotation.webservlet;\nimport javax.servlet.http.httpservlet;\nimport javax.servlet.http.httpservletrequest;\nimport javax.servlet.http.httpservletresponse;\nimport javax.servlet.http.httpsession;\n\n@webservlet("/servlet/sessiontrackservlet")\npublic class sessiontrackservlet extends httpservlet {\n    private static final long serialversionuid = 1l;\n\n    public void doget(httpservletrequest request, httpservletresponse response)\n                    throws servletexception, ioexception {\n        // å¦æä¸å­å¨ session ä¼è¯ï¼ååå»ºä¸ä¸ª session å¯¹è±¡\n        httpsession session = request.getsession(true);\n        // è·å session åå»ºæ¶é´\n        date createtime = new date(session.getcreationtime());\n        // è·åè¯¥ç½é¡µçæåä¸æ¬¡è®¿é®æ¶é´\n        date lastaccesstime = new date(session.getlastaccessedtime());\n\n        // è®¾ç½®æ¥æè¾åºçæ ¼å¼\n        simpledateformat df = new simpledateformat("yyyy-mm-dd hh:mm:ss");\n\n        string title = "servlet session å®ä¾";\n        integer visitcount = new integer(0);\n        string visitcountkey = new string("visitcount");\n        string useridkey = new string("userid");\n        string userid = new string("admin");\n\n        // æ£æ¥ç½é¡µä¸æ¯å¦ææ°çè®¿é®è\n        if (session.isnew()) {\n            session.setattribute(useridkey, userid);\n        } else {\n            visitcount = (integer) session.getattribute(visitcountkey);\n            visitcount = visitcount + 1;\n            userid = (string) session.getattribute(useridkey);\n        }\n        session.setattribute(visitcountkey, visitcount);\n\n        // è®¾ç½®ååºåå®¹ç±»å\n        response.setcontenttype("text/html;charset=utf-8");\n        printwriter out = response.getwriter();\n\n        string doctype = "<!doctype html>\\n";\n        out.println(doctype + "<html>\\n" + "<head><title>" + title + "</title></head>\\n"\n                        + "<body bgcolor=\\"#f0f0f0\\">\\n" + "<h1 align=\\"center\\">" + title\n                        + "</h1>\\n" + "<h2 align=\\"center\\">session ä¿¡æ¯</h2>\\n"\n                        + "<table border=\\"1\\" align=\\"center\\">\\n" + "<tr bgcolor=\\"#949494\\">\\n"\n                        + "  <th>session ä¿¡æ¯</th><th>å¼</th></tr>\\n" + "<tr>\\n" + "  <td>id</td>\\n"\n                        + "  <td>" + session.getid() + "</td></tr>\\n" + "<tr>\\n"\n                        + "  <td>åå»ºæ¶é´</td>\\n" + "  <td>" + df.format(createtime) + "  </td></tr>\\n"\n                        + "<tr>\\n" + "  <td>æåè®¿é®æ¶é´</td>\\n" + "  <td>" + df.format(lastaccesstime)\n                        + "  </td></tr>\\n" + "<tr>\\n" + "  <td>ç¨æ· id</td>\\n" + "  <td>" + userid\n                        + "  </td></tr>\\n" + "<tr>\\n" + "  <td>è®¿é®ç»è®¡ï¼</td>\\n" + "  <td>" + visitcount\n                        + "</td></tr>\\n" + "</table>\\n" + "</body></html>");\n    }\n}\n\n\nweb.xml\n\n<servlet>\n  <servlet-name>sessiontrackservlet</servlet-name>\n  <servlet-class>sessiontrackservlet</servlet-class>\n</servlet>\n<servlet-mapping>\n  <servlet-name>sessiontrackservlet</servlet-name>\n  <url-pattern>/servlet/sessiontrackservlet</url-pattern>\n</servlet-mapping>\n\n\n# å é¤ session ä¼è¯æ°æ®\n\nå½æ¨å®æäºä¸ä¸ªç¨æ·ç session ä¼è¯æ°æ®ï¼æ¨æä»¥ä¸å ç§éæ©ï¼\n\n**ç§»é¤ä¸ä¸ªç¹å®çå±æ§ï¼**æ¨å¯ä»¥è°ç¨ removeattribute(string name) æ¹æ³æ¥å é¤ä¸ç¹å®çé®ç¸å³èçå¼ã\n\n**å é¤æ´ä¸ª session ä¼è¯ï¼**æ¨å¯ä»¥è°ç¨ invalidate() æ¹æ³æ¥ä¸¢å¼æ´ä¸ª session ä¼è¯ã\n\n**è®¾ç½® session ä¼è¯è¿ææ¶é´ï¼**æ¨å¯ä»¥è°ç¨ setmaxinactiveinterval(int interval) æ¹æ³æ¥åç¬è®¾ç½® session ä¼è¯è¶æ¶ã\n\n**æ³¨éç¨æ·ï¼**å¦æä½¿ç¨çæ¯æ¯æ servlet 2.4 çæå¡å¨ï¼æ¨å¯ä»¥è°ç¨ logout æ¥æ³¨é web æå¡å¨çå®¢æ·ç«¯ï¼å¹¶æå±äºææç¨æ·çææ session ä¼è¯è®¾ç½®ä¸ºæ æã\n\n**web.xml éç½®ï¼**å¦ææ¨ä½¿ç¨çæ¯ tomcatï¼é¤äºä¸è¿°æ¹æ³ï¼æ¨è¿å¯ä»¥å¨ web.xml æä»¶ä¸­éç½® session ä¼è¯è¶æ¶ï¼å¦ä¸æç¤ºï¼\n\n<session-config>\n  <session-timeout>15</session-timeout>\n</session-config>\n\n\nä¸é¢å®ä¾ä¸­çè¶æ¶æ¶é´æ¯ä»¥åéä¸ºåä½ï¼å°è¦ç tomcat ä¸­é»è®¤ç 30 åéè¶æ¶æ¶é´ã\n\nå¨ä¸ä¸ª servlet ä¸­ç getmaxinactiveinterval() æ¹æ³ä¼è¿å session ä¼è¯çè¶æ¶æ¶é´ï¼ä»¥ç§ä¸ºåä½ãæä»¥ï¼å¦æå¨ web.xml ä¸­éç½® session ä¼è¯è¶æ¶æ¶é´ä¸º 15 åéï¼é£ä¹getmaxinactiveinterval() ä¼è¿å 900ã\n\n\n# cookie vs session\n\n\n# å­åæ¹å¼\n\ncookie åªè½ä¿å­asciiå­ç¬¦ä¸²ï¼å¦æéè¦å­å unicode å­ç¬¦æäºè¿å¶æ°æ®ï¼éè¦è¿è¡utf-8ãgbkæbase64ç­æ¹å¼çç¼ç ã\n\nsession å¯ä»¥å­åä»»ä½ç±»åçæ°æ®ï¼çè³æ¯ä»»ä½ java ç±»ãå¯ä»¥å° session çææ¯ä¸ä¸ª java å®¹å¨ç±»ã\n\n\n# éç§å®å¨\n\ncookie å­äºå®¢æ·ç«¯æµè§å¨ï¼ä¸äºå®¢æ·ç«¯çç¨åºå¯è½ä¼çª¥æ¢ãå¤å¶æä¿®æ¹ cookie åå®¹ã\n\nsession å­äºæå¡å¨ï¼å¯¹å®¢æ·ç«¯æ¯éæçï¼ä¸å­å¨ææä¿¡æ¯æ³é²çå±é©ã\n\n\n# æææ\n\nä½¿ç¨ cookie å¯ä»¥ä¿è¯é¿æ¶é´ç»å½ææï¼åªè¦è®¾ç½® cookie çmaxageå±æ§ä¸ºä¸ä¸ªå¾å¤§çæ°å­ã\n\nè session è½ç¶çè®ºä¸ä¹å¯ä»¥éè¿è®¾ç½®å¾å¤§çæ°å¼æ¥ä¿æé¿æ¶é´ç»å½ææï¼ä½æ¯ï¼ç±äº session ä¾èµäºåä¸ºjessionidç cookieï¼è cookie jessionidçmaxageé»è®¤ä¸º-1ï¼åªè¦å³é­äºæµè§å¨è¯¥ session å°±ä¼å¤±æï¼å æ­¤ï¼session ä¸è½å®ç°ä¿¡æ¯æ°¸ä¹ææçææãä½¿ç¨ url å°åéåä¹ä¸è½å®ç°ã\n\n\n# æå¡å¨çå¼é\n\nç±äº session æ¯ä¿å­å¨æå¡å¨çï¼æ¯ä¸ªç¨æ·é½ä¼äº§çä¸ä¸ª sessionï¼å¦æå¹¶åè®¿é®çç¨æ·éå¸¸å¤ï¼ä¼äº§çå¾å¤ç sessionï¼æ¶èå¤§éçåå­ã\n\nè cookie ç±äºä¿å­å¨å®¢æ·ç«¯æµè§å¨ä¸ï¼æä»¥ä¸å ç¨æå¡å¨èµæºã\n\n\n# æµè§å¨çæ¯æ\n\ncookie éè¦æµè§å¨æ¯ææè½ä½¿ç¨ã\n\nå¦ææµè§å¨ä¸æ¯æ cookieï¼éè¦ä½¿ç¨ session ä»¥å url å°åéåã\n\néè¦æ³¨æçäºææçç¨å° session ç¨åºç url é½è¦ä½¿ç¨response.encodeurl(stringurl) æresponse.encoderedireturl(string url)è¿è¡ url å°åéåï¼å¦åå¯¼è´ session ä¼è¯è·è¸ªå¤±æã\n\n\n# è·¨åå\n\n * cookie æ¯æè·¨ååã\n * session ä¸æ¯æè·¨ååã',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaWeb é¢ç»",frontmatter:{title:"JavaWeb é¢ç»",categories:["ç¼ç¨","Java","JavaWeb"],tags:["Java","JavaWeb","Servlet"],abbrlink:"f216aa98",date:"2020-02-07T23:04:47.000Z",permalink:"/pages/1933b3/"},regularPath:"/02.JavaEE/01.JavaWeb/99.JavaWeb%E9%9D%A2%E7%BB%8F.html",relativePath:"02.JavaEE/01.JavaWeb/99.JavaWebé¢ç».md",key:"v-1ee597b8",path:"/pages/1933b3/",headers:[{level:2,title:"Servlet",slug:"servlet",normalizedTitle:"servlet",charIndex:17},{level:3,title:"ä»ä¹æ¯ Servlet",slug:"ä»ä¹æ¯-servlet",normalizedTitle:"ä»ä¹æ¯ servlet",charIndex:29},{level:3,title:"Servlet å CGI çåºå«",slug:"servlet-å-cgi-çåºå«",normalizedTitle:"servlet å cgi çåºå«",charIndex:321},{level:3,title:"Servlet çæ¬ä»¥åä¸»è¦ç¹æ§",slug:"servlet-çæ¬ä»¥åä¸»è¦ç¹æ§",normalizedTitle:"servlet çæ¬ä»¥åä¸»è¦ç¹æ§",charIndex:548},{level:3,title:"Servlet å JSP çåºå«",slug:"servlet-å-jsp-çåºå«",normalizedTitle:"servlet å jsp çåºå«",charIndex:1386},{level:3,title:"ç®è¿° Servlet çå½å¨æ",slug:"ç®è¿°-servlet-çå½å¨æ",normalizedTitle:"ç®è¿° servlet çå½å¨æ",charIndex:1684},{level:3,title:"å¦ä½ç°å® servlet çåçº¿ç¨æ¨¡å¼",slug:"å¦ä½ç°å®-servlet-çåçº¿ç¨æ¨¡å¼",normalizedTitle:"å¦ä½ç°å® servlet çåçº¿ç¨æ¨¡å¼",charIndex:1967},{level:3,title:"Servlet ä¸­å¦ä½è·åç¨æ·æäº¤çæ¥è¯¢åæ°æèè¡¨åæ°æ®",slug:"servlet-ä¸­å¦ä½è·åç¨æ·æäº¤çæ¥è¯¢åæ°æèè¡¨åæ°æ®",normalizedTitle:"servlet ä¸­å¦ä½è·åç¨æ·æäº¤çæ¥è¯¢åæ°æèè¡¨åæ°æ®",charIndex:2026},{level:3,title:"request çä¸»è¦æ¹æ³",slug:"request-çä¸»è¦æ¹æ³",normalizedTitle:"request çä¸»è¦æ¹æ³",charIndex:2198},{level:2,title:"JSP",slug:"jsp",normalizedTitle:"jsp",charIndex:1396},{level:3,title:"JSP çåç½®å¯¹è±¡",slug:"jsp-çåç½®å¯¹è±¡",normalizedTitle:"jsp çåç½®å¯¹è±¡",charIndex:3265},{level:3,title:"JSP çä½ç¨å",slug:"jsp-çä½ç¨å",normalizedTitle:"jsp çä½ç¨å",charIndex:3605},{level:3,title:"JSP ä¸­ 7 ä¸ªå¨ä½æä»¤åä½ç¨",slug:"jsp-ä¸­-7-ä¸ªå¨ä½æä»¤åä½ç¨",normalizedTitle:"jsp ä¸­ 7 ä¸ªå¨ä½æä»¤åä½ç¨",charIndex:3697},{level:3,title:"JSP ä¸­å¨æ INCLUDE åéæ INCLUDE æä»ä¹åºå«",slug:"jsp-ä¸­å¨æ-include-åéæ-include-æä»ä¹åºå«",normalizedTitle:"jsp ä¸­å¨æ include åéæ include æä»ä¹åºå«",charIndex:3999},{level:2,title:"åç",slug:"åç",normalizedTitle:"åç",charIndex:249},{level:3,title:"è¯·æ±è½¬å(forward)åéå®å(redirect)çåºå«",slug:"è¯·æ±è½¬å-forward-åéå®å-redirect-çåºå«",normalizedTitle:"è¯·æ±è½¬å(forward)åéå®å(redirect)çåºå«",charIndex:4251},{level:3,title:"get è¯·æ±å post è¯·æ±çåºå«",slug:"get-è¯·æ±å-post-è¯·æ±çåºå«",normalizedTitle:"get è¯·æ±å post è¯·æ±çåºå«",charIndex:4500},{level:3,title:"ç¨æ·å¨æµè§å¨ä¸­è¾å¥ URL ä¹åï¼åä»ä¹äºä»ä¹ï¼ååºè¯·æ±åååºçæµç¨",slug:"ç¨æ·å¨æµè§å¨ä¸­è¾å¥-url-ä¹å-åä»ä¹äºä»ä¹-ååºè¯·æ±åååºçæµç¨",normalizedTitle:"ç¨æ·å¨æµè§å¨ä¸­è¾å¥ url ä¹åï¼åä»ä¹äºä»ä¹ï¼ååºè¯·æ±åååºçæµç¨",charIndex:4770},{level:3,title:"ä»ä¹æ¯ Web Service?",slug:"ä»ä¹æ¯-web-service",normalizedTitle:"ä»ä¹æ¯ web service?",charIndex:4933},{level:3,title:"ä¼è¯è·è¸ªææ¯æåªäº?",slug:"ä¼è¯è·è¸ªææ¯æåªäº",normalizedTitle:"ä¼è¯è·è¸ªææ¯æåªäº?",charIndex:5082},{level:3,title:"ååºç»æç¶æç æåªäºï¼å¹¶ç»åºä¸­æå«ä¹ï¼",slug:"ååºç»æç¶æç æåªäº-å¹¶ç»åºä¸­æå«ä¹",normalizedTitle:"ååºç»æç¶æç æåªäºï¼å¹¶ç»åºä¸­æå«ä¹ï¼",charIndex:6245},{level:3,title:"XML ææ¡£å®ä¹æå ç§å½¢å¼ï¼å®ä»¬ä¹é´æä½æ¬è´¨åºå«ï¼è§£æ XML ææ¡£æåªå ç§æ¹å¼ï¼",slug:"xml-ææ¡£å®ä¹æå ç§å½¢å¼-å®ä»¬ä¹é´æä½æ¬è´¨åºå«-è§£æ-xml-ææ¡£æåªå ç§æ¹å¼",normalizedTitle:"xml ææ¡£å®ä¹æå ç§å½¢å¼ï¼å®ä»¬ä¹é´æä½æ¬è´¨åºå«ï¼è§£æ xml ææ¡£æåªå ç§æ¹å¼ï¼",charIndex:6640},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:7566}],headersStr:"Servlet ä»ä¹æ¯ Servlet Servlet å CGI çåºå« Servlet çæ¬ä»¥åä¸»è¦ç¹æ§ Servlet å JSP çåºå« ç®è¿° Servlet çå½å¨æ å¦ä½ç°å® servlet çåçº¿ç¨æ¨¡å¼ Servlet ä¸­å¦ä½è·åç¨æ·æäº¤çæ¥è¯¢åæ°æèè¡¨åæ°æ® request çä¸»è¦æ¹æ³ JSP JSP çåç½®å¯¹è±¡ JSP çä½ç¨å JSP ä¸­ 7 ä¸ªå¨ä½æä»¤åä½ç¨ JSP ä¸­å¨æ INCLUDE åéæ INCLUDE æä»ä¹åºå« åç è¯·æ±è½¬å(forward)åéå®å(redirect)çåºå« get è¯·æ±å post è¯·æ±çåºå« ç¨æ·å¨æµè§å¨ä¸­è¾å¥ URL ä¹åï¼åä»ä¹äºä»ä¹ï¼ååºè¯·æ±åååºçæµç¨ ä»ä¹æ¯ Web Service? ä¼è¯è·è¸ªææ¯æåªäº? ååºç»æç¶æç æåªäºï¼å¹¶ç»åºä¸­æå«ä¹ï¼ XML ææ¡£å®ä¹æå ç§å½¢å¼ï¼å®ä»¬ä¹é´æä½æ¬è´¨åºå«ï¼è§£æ XML ææ¡£æåªå ç§æ¹å¼ï¼ åèèµæ",content:'# JavaWeb é¢ç»\n\n\n# Servlet\n\n\n# ä»ä¹æ¯ Servlet\n\nServletï¼Server Appletï¼ï¼å³å°æå¡ç¨åºææå¡è¿æ¥å¨ãServlet æ¯ Java ç¼åçæå¡å¨ç«¯ç¨åºï¼å·æç¬ç«äºå¹³å°ååè®®çç¹æ§ï¼ä¸»è¦åè½å¨äºäº¤äºå¼å°æµè§åçææ°æ®ï¼çæå¨æ Web åå®¹ã\n\n * ç­ä¹ç Servlet æ¯æ Java å®ç°çä¸ä¸ªæ¥å£ã\n * å¹¿ä¹ç Servlet æ¯æä»»ä½å®ç°äºè¿ä¸ª Servlet æ¥å£çç±»ã\n\nServlet è¿è¡äºæ¯æ Java çåºç¨æå¡å¨ä¸­ãä»åçä¸è®²ï¼Servlet å¯ä»¥ååºä»»ä½ç±»åçè¯·æ±ï¼ä½ç»å¤§å¤æ°æåµä¸ Servlet åªç¨æ¥æ©å±åºäº HTTP åè®®ç Web æå¡å¨ã\n\n\n# Servlet å CGI çåºå«\n\nServlet ææ¯åºç°ä¹åï¼Web ä¸»è¦ä½¿ç¨ CGI ææ¯ãå®ä»¬çåºå«å¦ä¸ï¼\n\n * Servlet æ¯åºäº Java ç¼åçï¼å¤äºæå¡å¨è¿ç¨ä¸­ï¼ä»è½å¤éè¿å¤çº¿ç¨æ¹å¼è¿è¡ service() æ¹æ³ï¼ä¸ä¸ªå®ä¾å¯ä»¥æå¡äºå¤ä¸ªè¯·æ±ï¼èä¸ä¸è¬ä¸ä¼éæ¯ï¼\n * CGI(Common Gateway Interface)ï¼å³éç¨ç½å³æ¥å£ãå®ä¼ä¸ºæ¯ä¸ªè¯·æ±äº§çæ°çè¿ç¨ï¼æå¡å®æåéæ¯ï¼æä»¥æçä¸ä½äº Servletã\n\n\n# Servlet çæ¬ä»¥åä¸»è¦ç¹æ§\n\nçæ¬            æ¥æ            JAVA EE/JDK çæ¬       ç¹æ§\nServlet 4.0   2017 å¹´ 10 æ   JavaEE 8             HTTP2\nServlet 3.1   2013 å¹´ 5 æ    JavaEE 7             éé»å¡ I/Oï¼HTTP åè®®åçº§æºå¶\nServlet 3.0   2009 å¹´ 12 æ   JavaEE 6, JavaSE 6   å¯æææ§ï¼æäºå¼åï¼å¼æ­¥ Servletï¼å®å¨æ§ï¼æä»¶ä¸ä¼ \nServlet 2.5   2005 å¹´ 10 æ   JavaEE 5, JavaSE 5   ä¾èµ JavaSE 5ï¼æ¯ææ³¨è§£\nServlet 2.4   2003 å¹´ 11 æ   J2EE 1.4, J2SE 1.3   web.xml ä½¿ç¨ XML Schema\nServlet 2.3   2001 å¹´ 8 æ    J2EE 1.3, J2SE 1.2   Filter\nServlet 2.2   1999 å¹´ 8 æ    J2EE 1.2, J2SE 1.2   æä¸º J2EE æ å\nServlet 2.1   1998 å¹´ 11 æ   æªæå®                  First official specification, added RequestDispatcher,\n                                                 ServletContext\nServlet 2.0                 JDK 1.1              Part of Java Servlet Development Kit 2.0\nServlet 1.0   1997 å¹´ 6 æ                         \n\n\n# Servlet å JSP çåºå«\n\n 1. Servlet æ¯ä¸ä¸ªè¿è¡å¨æå¡å¨ä¸ç Java ç±»,ä¾é æå¡å¨æ¯æåæµè§å¨ä¼ è¾æ°æ®ã\n 2. JSP æ¬è´¨ä¸å°±æ¯ Servletï¼æ¯æ¬¡è¿è¡çæ¶å JSP é½ä¼è¢«ç¼è¯æ .java æä»¶ï¼ç¶ååè¢«ç¼è¯æ .class æä»¶ã\n 3. æäº JSPï¼Servlet ä¸åè´è´£å¨æçæé¡µé¢ï¼è½¬èå»è´è´£æ§å¶ç¨åºé»è¾çä½ç¨ï¼æ§å¶ JSP ä¸ JavaBean ä¹é´çæµè½¬ã\n 4. JSP ä¾§éäºè§å¾,è Servlet ä¾§éäºæ§å¶é»è¾,å¨ MVC æ¶ææ¨¡å¼ä¸­,JSP éååå½è§å¾ View,Servlet éååå½æ§å¶å¨ Controllerã\n\n\n# ç®è¿° Servlet çå½å¨æ\n\n\n\nServlet çå½å¨æå¦ä¸ï¼\n\n 1. å è½½ - ç¬¬ä¸ä¸ªå°è¾¾æå¡å¨ç HTTP è¯·æ±è¢«å§æ´¾å° Servlet å®¹å¨ãå®¹å¨éè¿ç±»å è½½å¨ä½¿ç¨ Servlet ç±»å¯¹åºçæä»¶å è½½ servletï¼\n 2. åå§å - Servlet éè¿è°ç¨ init () æ¹æ³è¿è¡åå§åã\n 3. æå¡ - Servlet è°ç¨ service() æ¹æ³æ¥å¤çå®¢æ·ç«¯çè¯·æ±ã\n 4. éæ¯ - Servlet éè¿è°ç¨ destroy() æ¹æ³ç»æ­¢ï¼ç»æï¼ã\n 5. å¸è½½ - Servlet æ¯ç± JVM çåå¾åæ¶å¨è¿è¡åå¾åæ¶çã\n\n\n# å¦ä½ç°å® servlet çåçº¿ç¨æ¨¡å¼\n\n<%@ page isThreadSafe="false" %>\n\n\n\n# Servlet ä¸­å¦ä½è·åç¨æ·æäº¤çæ¥è¯¢åæ°æèè¡¨åæ°æ®\n\n * HttpServletRequest ç getParameter() æ¹æ³ã\n * HttpServletRequest ç getParameterValues() æ¹æ³ã\n * HttpServletRequest ç getParameterMap() æ¹æ³ã\n\n\n# request çä¸»è¦æ¹æ³\n\n * setAttribute(String name,Object)ï¼è®¾ç½®åå­ä¸º name ç request çåæ°å¼\n * getAttribute(String name)ï¼è¿åç± name æå®çå±æ§å¼\n * getAttributeNames()ï¼è¿å request å¯¹è±¡ææå±æ§çåå­éåï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getCookies()ï¼è¿åå®¢æ·ç«¯çææ Cookie å¯¹è±¡ï¼ç»ææ¯ä¸ä¸ª Cookie æ°ç»\n * getCharacterEncoding()ï¼è¿åè¯·æ±ä¸­çå­ç¬¦ç¼ç æ¹å¼\n * getContentLength()ï¼è¿åè¯·æ±ç Body çé¿åº¦\n * getHeader(String name)ï¼è·å¾ HTTP åè®®å®ä¹çæä»¶å¤´ä¿¡æ¯\n * getHeaders(String name)ï¼è¿åæå®åå­ç request Header çææå¼ï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getHeaderNames()ï¼è¿åæä»¥ request Header çåå­ï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getInputStream()ï¼è¿åè¯·æ±çè¾å¥æµï¼ç¨äºè·å¾è¯·æ±ä¸­çæ°æ® getMethod()ï¼è·å¾å®¢æ·ç«¯åæå¡å¨ç«¯ä¼ éæ°æ®çæ¹æ³\n * getParameter(String name)ï¼è·å¾å®¢æ·ç«¯ä¼ éç»æå¡å¨ç«¯çæ name æå®çåæ°å¼\n * getParameterNames()ï¼è·å¾å®¢æ·ç«¯ä¼ éç»æå¡å¨ç«¯çææåæ°çåå­ï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getParameterValues(String name)ï¼è·å¾æ name æå®çåæ°çææå¼\n * getProtocol()ï¼è·åå®¢æ·ç«¯åæå¡å¨ç«¯ä¼ éæ°æ®æä¾æ®çåè®®åç§°\n * getQueryString()ï¼è·å¾æ¥è¯¢å­ç¬¦ä¸²\n * getRequestURI()ï¼è·åååºè¯·æ±å­ç¬¦ä¸²çå®¢æ·ç«¯å°å\n * getRemoteAddr()ï¼è·åå®¢æ·ç«¯ç IP å°å\n * getRemoteHost()ï¼è·åå®¢æ·ç«¯çåå­\n * getSession([Boolean create])ï¼è¿ååè¯·æ±ç¸å³\n * Session getServerName()ï¼è·åæå¡å¨çåå­\n * getServletPath()ï¼è·åå®¢æ·ç«¯æè¯·æ±çèæ¬æä»¶çè·¯å¾\n * getServerPort()ï¼è·åæå¡å¨çç«¯å£å·\n * removeAttribute(String name)ï¼å é¤è¯·æ±ä¸­çä¸ä¸ªå±æ§\n\n\n# JSP\n\n\n# JSP çåç½®å¯¹è±¡\n\n 1. requestï¼åå«å®¢æ·ç«¯è¯·æ±çä¿¡æ¯ï¼\n 2. responseï¼åå«æå¡å¨ä¼ åå®¢æ·ç«¯çååºä¿¡æ¯ï¼\n 3. sessionï¼ä¸»è¦ç¨æ¥åºåæ¯ä¸ªç¨æ·ä¿¡æ¯åä¼è¯ç¶æï¼\n 4. pageContextï¼ç®¡çé¡µé¢å±æ§ï¼\n 5. applicationï¼æå¡å¨å¯å¨æ¶åå»ºï¼æå¡å¨å³é­æ¶åæ­¢ï¼ä¿å­ææåºç¨ç³»ç»ä¸­çå±ææ°æ®ï¼ä¸ä¸ªå±äº«çåç½®å¯¹è±¡ï¼å³ä¸ä¸ªå®¹å¨ä¸­çå¤ä¸ªç¨æ·å±äº«ä¸ä¸ª application å¯¹è±¡ï¼ï¼\n 6. outï¼åå®¢æ·ç«¯è¾åºæ°æ®ï¼\n 7. configï¼ä»£ç çæ®µéç½®å¯¹è±¡ï¼ç¨äºåå§å Servlet çéç½®åæ°ï¼\n 8. pageï¼æç½é¡µæ¬èº«ï¼\n 9. exceptionï¼å¤ç JSP æä»¶æ§è¡æ¶åççéè¯¯åå¼å¸¸ï¼åªè¦å¨éè¯¯é¡µé¢éæè½ä½¿ç¨ã\n\n\n# JSP çä½ç¨å\n\n 1. pageï¼ä¸ä¸ªé¡µé¢ï¼\n 2. requestï¼ä¸æ¬¡è¯·æ±ï¼\n 3. sessionï¼ä¸æ¬¡ä¼è¯ï¼\n 4. applicationï¼æå¡å¨ä»å¯å¨å°åæ­¢ã\n\n\n# JSP ä¸­ 7 ä¸ªå¨ä½æä»¤åä½ç¨\n\n 1. jsp:forward - æ§è¡é¡µé¢è½¬åï¼æè¯·æ±è½¬åå°ä¸ä¸ä¸ªé¡µé¢ï¼\n 2. jsp:param - ç¨äºä¼ éåæ°ï¼å¿é¡»ä¸å¶ä»æ¯æåæ°çæ ç­¾ä¸èµ·ä½¿ç¨ï¼\n 3. jsp:include - ç¨äºå¨æå¼å¥ä¸ä¸ª JSP é¡µé¢ï¼\n 4. jsp:plugin - ç¨äºä¸è½½ JavaBean æ Applet å°å®¢æ·ç«¯æ§è¡ï¼\n 5. jsp:useBean - å¯»æ±æèå®ä¾åä¸ä¸ª JavaBeanï¼\n 6. jsp:setProperty - è®¾ç½® JavaBean çå±æ§å¼ï¼\n 7. jsp:getProperty - è·å JavaBean çå±æ§å¼ã\n\n\n# JSP ä¸­å¨æ INCLUDE åéæ INCLUDE æä»ä¹åºå«\n\n * éæ INCLUDEï¼ç¨ include ä¼ªç å®ç°ï¼ä¸ä¼æ£æ¥æå«æä»¶çååï¼éç¨äºåå«éæé¡µé¢<%@ include file="é¡µé¢åç§°.html" %>ãååå¹¶åç¼è¯ã\n * å¨æ INCLUDEï¼ç¨ jsp:include å¨ä½å®ç° <jsp:include page="é¡µé¢åç§° .jsp" flush="true"> å®æ»æ¯ä¼æ£æ¥æä»¶ä¸­çååï¼éç¨äºåå«å¨æé¡µé¢ï¼å¹¶ä¸å¯ä»¥å¸¦åæ°ãåç¼è¯ååå¹¶ã\n\n\n# åç\n\n\n# è¯·æ±è½¬å(forward)åéå®å(redirect)çåºå«\n\n * æçä¸\n   * è½¬åï¼forwardï¼ > éå®åï¼redirectï¼\n * æ¾ç¤ºä¸\n   * éå®åï¼redirectï¼ï¼æ¾ç¤ºæ°ç URL\n   * è½¬åï¼forwardï¼ï¼å°åæ ä¸å\n * æ°æ®ä¸\n   * è½¬åï¼forwardï¼ï¼å¯ä»¥å±äº« request éé¢çæ°æ®\n   * éå®åï¼redirectï¼ï¼ä¸è½\n * è¯·æ±æ¬¡æ°\n   * éå®åï¼redirectï¼æ¯ä¸¤æ¬¡\n   * è½¬åï¼forwardï¼æ¯ä¸æ¬¡\n\n\n# get è¯·æ±å post è¯·æ±çåºå«\n\n\n\n * GETï¼\n   * ä»æå¡å¨ä¸è·åæ°æ®ï¼ä¸è¬ä¸è½ä½¿ç¨å¨åæä½æ¥å£\n   * ç± URL æéå¶ï¼GET æ¹å¼ä¼ è¾çæ°æ®å¤§å°ææéå¶ï¼ä¼ éçæ°æ®éä¸è¶è¿ 2KB\n   * è¯·æ±çæ°æ®ä¼éå å¨ URL ä¹åï¼ä»¥ï¼åé URL åä¼ è¾æ°æ®ï¼å¤ä¸ªåæ°ç¨&è¿æ¥\n   * å®å¨æ§å·®\n * POST:\n   * åæå¡å¨æäº¤æ°æ®,ä¸è¬å¤çåä¸å¡\n   * POST æ¹å¼ä¼ éçæ°æ®éæ¯è¾å¤§ï¼ä¸è¬è¢«é»è®¤ä¸ºæ²¡æéå¶\n   * å®å¨æ§é«\n   * è¯·çæ±çæ°æ®åå®¹æ¾ç½®å¨ HTML HEADER ä¸­\n\n\n# ç¨æ·å¨æµè§å¨ä¸­è¾å¥ URL ä¹åï¼åä»ä¹äºä»ä¹ï¼ååºè¯·æ±åååºçæµç¨\n\n 1. ååè§£æ\n 2. TCP ä¸æ¬¡æ¡æ\n 3. æµè§å¨åæå¡å¨åé http è¯·æ±\n 4. æµè§å¨åéè¯·æ±å¤´ä¿¡æ¯\n 5. æå¡å¨å¤çè¯·æ±\n 6. æå¡å¨ååºåºç­\n 7. æå¡å¨åéåºç­å¤´ä¿¡æ¯\n 8. æå¡å¨åéæ°æ®\n 9. TCP è¿æ¥å³é­\n\n\n# ä»ä¹æ¯ Web Service?\n\n 1. WebService å°±æ¯ä¸ä¸ªåºç¨ç¨åºï¼å®åå¤çæ´é²åºä¸ä¸ªè½å¤éè¿ Web è¿è¡è°ç¨ç APIã\n 2. å®æ¯åºäº HTTP åè®®ä¼ è¾æ°æ®ï¼è¿ä½¿å¾è¿è¡å¨ä¸åæºä¸çä¸ååºç¨ç¨åºï¼æ é¡»åå©éå çãä¸é¨çç¬¬ä¸æ¹ è½¯ä»¶æç¡¬ä»¶ï¼å°±å¯ä»¥ç¸äºäº¤æ¢æ°æ®æéæã\n\n\n# ä¼è¯è·è¸ªææ¯æåªäº?\n\nç±äº HTTP åè®®æ¬èº«æ¯æ ç¶æçï¼æå¡å¨ä¸ºäºåºåä¸åçç¨æ·ï¼å°±éè¦å¯¹ç¨æ·ä¼è¯è¿è¡è·è¸ªï¼ç®åçè¯´å°±æ¯ä¸ºç¨æ·è¿è¡ç»è®°ï¼ä¸ºç¨æ·åéå¯ä¸ç IDï¼ä¸ä¸æ¬¡ç¨æ·å¨è¯·æ±ä¸­åå«æ­¤ IDï¼æå¡å¨æ ¹æ®æ­¤å¤æ­å°åºæ¯åªä¸ä¸ªç¨æ·ã\n\n * URL éåï¼å¨ URL ä¸­æ·»å ä¼è¯ä¿¡æ¯ä½ä¸ºè¯·æ±çåæ°ï¼æèå°å¯ä¸çä¼è¯ ID æ·»å å° URL ç»å°¾ï¼ä»¥è¡¨ç¤ºä¸ä¸ªä¼è¯ãè®¾ç½®è¡¨åéèåï¼å°åä¼è¯è·è¸ªç¸å³çå­æ®µæ·»å å°éèåä¸­ï¼è¿äºä¿¡æ¯ä¸ä¼å¨æµè§å¨æ¾ç¤ºï¼ä½æ¯æäº¤è¡¨åæ¶ä¼æäº¤ç»æå¡å¨ã\n * cookieï¼cookie æä¸¤ç§ï¼\n   * ä¸ç§æ¯åºäºçªå£çï¼æµè§å¨å³é­åï¼cookie å°±æ²¡æäºï¼\n   * å¦ä¸ç§æ¯å°ä¿¡æ¯å­å¨å¨ä¸ä¸ªä¸´æ¶æä»¶ä¸­ï¼å¹¶è®¾ç½®å¶ææè·¯å¾åæå¤§å­æ´»æ¶é´ãå½ç¨æ·éè¿æµè§å¨åæå¡å¨å»ºç«ä¸æ¬¡ä¼è¯åï¼ä¼è¯ ID å°±ä¼éç¸åºä¿¡æ¯å¨å­å¨åºäºçªå£ç cookie ä¸­ï¼é£å°±æå³çåªè¦æµè§å¨æ²¡æå³é­ï¼ä¼è¯æ²¡æè¶æ¶ï¼ä¸ä¸æ¬¡è¯·æ±æ¶è¿ä¸ªä¼è¯ ID åä¼æäº¤ç»æå¡å¨ï¼è®©æå¡å¨è¯å«ç¨æ·èº«ä»½ã\n   * å¨ä½¿ç¨ cookie æ¶è¦æ³¨æå ç¹ï¼\n     * é¦åä¸è¦å¨ cookie ä¸­å­æ¾æ æä¿¡æ¯ï¼\n     * å¶æ¬¡ cookie å­å¨çæ°æ®éæéï¼4kï¼ï¼ä¸è½å°è¿å¤çåå®¹å­å¨ cookie ä¸­ï¼\n     * åèæµè§å¨éå¸¸åªåè®¸ä¸ä¸ªç«ç¹æå¤å­æ¾ 20 ä¸ª cookieã\n     * å½ç¶ï¼åç¨æ·ä¼è¯ç¸å³çå¶ä»ä¿¡æ¯ï¼é¤äºä¼è¯ IDï¼ä¹å¯ä»¥å­å¨ cookie æ¹ä¾¿è¿è¡ä¼è¯ è·è¸ª;\n * HttpSessionï¼å¨ææä¼è¯è·è¸ªææ¯ä¸­ï¼HttpSession å¯¹è±¡æ¯æå¼ºå¤§ä¹æ¯åè½æå¤çãå½ä¸ä¸ªç¨æ·ç¬¬ä¸æ¬¡è®¿é®æä¸ªç½ç«æ¶ä¼èªå¨åå»º HttpSessionï¼æ¯ä¸ªç¨æ·å¯ä»¥è®¿é®ä»èªå·±ç HttpSessionãå¯ä»¥éè¿ HttpServletRequest å¯¹è±¡ç getSession æ¹æ³è·å¾ HttpSessionï¼éè¿ HttpSession ç setAttribute æ¹æ³å¯ä»¥å°ä¸ä¸ªå¼æ¾å¨ HttpSession ä¸­ï¼éè¿è°ç¨ HttpSession å¯¹è±¡ç getAttribute æ¹æ³ï¼åæ¶ä¼ å¥å±æ§åå°±å¯ä»¥è·åä¿å­å¨ HttpSession ä¸­çå¯¹è±¡ã\n   * ä¸ä¸é¢ä¸ç§æ¹å¼ä¸åçæ¯ï¼HttpSession æ¾å¨æå¡å¨çåå­ä¸­ï¼å æ­¤ä¸è¦å°è¿å¤§çå¯¹è±¡æ¾å¨éé¢ï¼å³ä½¿ç®åç Servlet å®¹å¨å¯ä»¥å¨åå­å°æ»¡æ¶å° HttpSession ä¸­çå¯¹è±¡ç§»å°å¶ä»å­å¨è®¾å¤ä¸­ï¼ä½æ¯è¿æ ·å¿å¿å½±åæ§è½ã\n   * æ·»å å° HttpSession ä¸­ çå¼å¯ä»¥æ¯ä»»æ Java å¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡æå¥½å®ç°äº Serializable æ¥å£ï¼è¿æ · Servlet å®¹å¨å¨å¿è¦çæ¶åå¯ä»¥å°å¶åºå åå°æä»¶ä¸­ï¼å¦åå¨åºååæ¶å°±ä¼åºç°å¼å¸¸ã\n\n\n# ååºç»æç¶æç æåªäºï¼å¹¶ç»åºä¸­æå«ä¹ï¼\n\n * 1**ï¼ä¿¡æ¯æ§ç¶æç \n * 2**ï¼æåç¶æç \n   * 200ï¼è¯·æ±æ­£å¸¸æå\n   * 204ï¼æç¤ºè¯·æ±æåä½æ²¡æè¿åæ°ä¿¡æ¯\n   * 206ï¼æç¤ºæå¡å¨å·²å®æå¯¹èµæºçé¨å GET è¯·æ±\n * 3**ï¼éå®åç¶æç \n   * 301ï¼æ°¸ä¹æ§éå®å\n   * 302ï¼ä¸´æ¶æ§éå®å\n   * 304ï¼æå¡å¨ç«¯åè®¸è¯·æ±è®¿é®èµæºï¼ä½æªæ»¡è¶³æ¡ä»¶\n * 4**ï¼å®¢æ·ç«¯éè¯¯ç¶æç \n   * 400ï¼è¯·æ±æ¥æä¸­å­å¨è¯­æ³éè¯¯\n   * 401ï¼åéçè¯·æ±éè¦æéè¿ HTTP è®¤è¯çè®¤è¯ä¿¡æ¯\n   * 403ï¼å¯¹è¯·æ±èµæºçè®¿é®è¢«æå¡å¨æç»äº\n   * 404ï¼æå¡å¨ä¸æ æ³æ¾å°è¯·æ±çèµæº\n * 5**ï¼æå¡å¨éè¯¯ç¶æç \n   * 500ï¼æå¡å¨ç«¯å¨æ§è¡è¯·æ±æ¶åçäºéè¯¯\n   * 503ï¼æå¡å¨ææ¶å¤äºè¶è´è½½ææ­£å¨è¿è¡åæºç»´æ¤ï¼ç°å¨æ æ³å¤çè¯·æ±\n\n\n# XML ææ¡£å®ä¹æå ç§å½¢å¼ï¼å®ä»¬ä¹é´æä½æ¬è´¨åºå«ï¼è§£æ XML ææ¡£æåªå ç§æ¹å¼ï¼\n\nï¼1ï¼XML ææ¡£æä¸¤ç§çº¦ææ¹å¼ï¼\n\n 1. DTD çº¦æ\n 2. Schema çº¦æ\n\nï¼2ï¼XML ææ¡£åºå«ï¼ 1 DTD ä¸ç¬¦å XML çè¯­æ³ç»æï¼schema ç¬¦å XML çè¯­æ³ç»æï¼ 2 DTD ççº¦ææ©å±æ§æ¯è¾å·®ï¼XML ææ¡£åªè½å¼å¥ä¸ä¸ª DTD çæä»¶ãschema å¯ä»¥å¼å¥å¤ä¸ªæä»¶ï¼ 3 DTD ä¸æ¯æåç§°ç©ºé´ï¼çè§£åç»æï¼ï¼schema æ¯æåç§°ç©ºé´ï¼ 4 DTD æ¯ææ°æ®æ¯è¾å°ï¼schema æ¯ææ´å¤çæ°æ®ç±»åï¼\n\nï¼3ï¼è§£ææ¹å¼ä¸»è¦æä¸ç§ï¼\n\n * DOM è§£æï¼\n   * ï¼aï¼å è½½æ´ä¸ª xml çææ¡£å°åå­ä¸­ï¼å½¢ææ ç¶ç»æï¼çæå¯¹è±¡ï¼\n   * ï¼bï¼å®¹æäº§çåå­æº¢åºï¼\n   * ï¼cï¼å¯ä»¥åå¢å æ¹\n * SAX è§£æ\n   * ï¼aï¼è¾¹è¯»è¾¹è§£æï¼\n   * ï¼bï¼ä¸å¯ä»¥åå¢å æ¹\n * DOM4J è§£æï¼hibernate åºå±éç¨)\n   * ï¼aï¼å¯è®© SAX è§£æä¹äº§çæ ç¶ç»æã\n   * ï¼bï¼ä¸»è¦ api å¼åæ­¥éª¤ï¼\n     * 1ï¼SAXReader.read(xxx.xml)ä»£è¡¨è§£æ xml çææ¡£ï¼è¿åå¯¹è±¡æ¯ Documentï¼\n     * 2ï¼Document.getRootElement(),è¿åçæ¯ææ¡£çæ ¹èç¹ï¼æ¯ Element å¯¹è±¡ï¼\n     * 3ï¼Element:\n       * .element(...)-- è·å¾æå®åç§°ç¬¬ä¸ä¸ªå­åç´ ãå¯ä»¥ä¸æå®åç§°;\n       * .elements(...)-- è·å¾æå®åç§°çææå­åç´ ãå¯ä»¥ä¸æå®åç§°;\n       * .getText()-- è·å¾å½ååç´ çææ¬åå®¹ï¼\n       * .elementText(...)-- è·å¾æå®åç§°å­åç´ çææ¬å¼\n       * .addElement()-- æ·»å å­èç¹\n       * .setText()-- è®¾ç½®å­æ ç­¾åå®¹\n     * 4ï¼XMLWriter.write("..")-- ååº\n     * 5ï¼XMLWriter.close()-- å³é­è¾åºæµ\n\n\n# åèèµæ\n\n * https://blog.csdn.net/YM_IlY/article/details/81266959\n * https://www.jianshu.com/p/f073dde56262',normalizedContent:'# javaweb é¢ç»\n\n\n# servlet\n\n\n# ä»ä¹æ¯ servlet\n\nservletï¼server appletï¼ï¼å³å°æå¡ç¨åºææå¡è¿æ¥å¨ãservlet æ¯ java ç¼åçæå¡å¨ç«¯ç¨åºï¼å·æç¬ç«äºå¹³å°ååè®®çç¹æ§ï¼ä¸»è¦åè½å¨äºäº¤äºå¼å°æµè§åçææ°æ®ï¼çæå¨æ web åå®¹ã\n\n * ç­ä¹ç servlet æ¯æ java å®ç°çä¸ä¸ªæ¥å£ã\n * å¹¿ä¹ç servlet æ¯æä»»ä½å®ç°äºè¿ä¸ª servlet æ¥å£çç±»ã\n\nservlet è¿è¡äºæ¯æ java çåºç¨æå¡å¨ä¸­ãä»åçä¸è®²ï¼servlet å¯ä»¥ååºä»»ä½ç±»åçè¯·æ±ï¼ä½ç»å¤§å¤æ°æåµä¸ servlet åªç¨æ¥æ©å±åºäº http åè®®ç web æå¡å¨ã\n\n\n# servlet å cgi çåºå«\n\nservlet ææ¯åºç°ä¹åï¼web ä¸»è¦ä½¿ç¨ cgi ææ¯ãå®ä»¬çåºå«å¦ä¸ï¼\n\n * servlet æ¯åºäº java ç¼åçï¼å¤äºæå¡å¨è¿ç¨ä¸­ï¼ä»è½å¤éè¿å¤çº¿ç¨æ¹å¼è¿è¡ service() æ¹æ³ï¼ä¸ä¸ªå®ä¾å¯ä»¥æå¡äºå¤ä¸ªè¯·æ±ï¼èä¸ä¸è¬ä¸ä¼éæ¯ï¼\n * cgi(common gateway interface)ï¼å³éç¨ç½å³æ¥å£ãå®ä¼ä¸ºæ¯ä¸ªè¯·æ±äº§çæ°çè¿ç¨ï¼æå¡å®æåéæ¯ï¼æä»¥æçä¸ä½äº servletã\n\n\n# servlet çæ¬ä»¥åä¸»è¦ç¹æ§\n\nçæ¬            æ¥æ            java ee/jdk çæ¬       ç¹æ§\nservlet 4.0   2017 å¹´ 10 æ   javaee 8             http2\nservlet 3.1   2013 å¹´ 5 æ    javaee 7             éé»å¡ i/oï¼http åè®®åçº§æºå¶\nservlet 3.0   2009 å¹´ 12 æ   javaee 6, javase 6   å¯æææ§ï¼æäºå¼åï¼å¼æ­¥ servletï¼å®å¨æ§ï¼æä»¶ä¸ä¼ \nservlet 2.5   2005 å¹´ 10 æ   javaee 5, javase 5   ä¾èµ javase 5ï¼æ¯ææ³¨è§£\nservlet 2.4   2003 å¹´ 11 æ   j2ee 1.4, j2se 1.3   web.xml ä½¿ç¨ xml schema\nservlet 2.3   2001 å¹´ 8 æ    j2ee 1.3, j2se 1.2   filter\nservlet 2.2   1999 å¹´ 8 æ    j2ee 1.2, j2se 1.2   æä¸º j2ee æ å\nservlet 2.1   1998 å¹´ 11 æ   æªæå®                  first official specification, added requestdispatcher,\n                                                 servletcontext\nservlet 2.0                 jdk 1.1              part of java servlet development kit 2.0\nservlet 1.0   1997 å¹´ 6 æ                         \n\n\n# servlet å jsp çåºå«\n\n 1. servlet æ¯ä¸ä¸ªè¿è¡å¨æå¡å¨ä¸ç java ç±»,ä¾é æå¡å¨æ¯æåæµè§å¨ä¼ è¾æ°æ®ã\n 2. jsp æ¬è´¨ä¸å°±æ¯ servletï¼æ¯æ¬¡è¿è¡çæ¶å jsp é½ä¼è¢«ç¼è¯æ .java æä»¶ï¼ç¶ååè¢«ç¼è¯æ .class æä»¶ã\n 3. æäº jspï¼servlet ä¸åè´è´£å¨æçæé¡µé¢ï¼è½¬èå»è´è´£æ§å¶ç¨åºé»è¾çä½ç¨ï¼æ§å¶ jsp ä¸ javabean ä¹é´çæµè½¬ã\n 4. jsp ä¾§éäºè§å¾,è servlet ä¾§éäºæ§å¶é»è¾,å¨ mvc æ¶ææ¨¡å¼ä¸­,jsp éååå½è§å¾ view,servlet éååå½æ§å¶å¨ controllerã\n\n\n# ç®è¿° servlet çå½å¨æ\n\n\n\nservlet çå½å¨æå¦ä¸ï¼\n\n 1. å è½½ - ç¬¬ä¸ä¸ªå°è¾¾æå¡å¨ç http è¯·æ±è¢«å§æ´¾å° servlet å®¹å¨ãå®¹å¨éè¿ç±»å è½½å¨ä½¿ç¨ servlet ç±»å¯¹åºçæä»¶å è½½ servletï¼\n 2. åå§å - servlet éè¿è°ç¨ init () æ¹æ³è¿è¡åå§åã\n 3. æå¡ - servlet è°ç¨ service() æ¹æ³æ¥å¤çå®¢æ·ç«¯çè¯·æ±ã\n 4. éæ¯ - servlet éè¿è°ç¨ destroy() æ¹æ³ç»æ­¢ï¼ç»æï¼ã\n 5. å¸è½½ - servlet æ¯ç± jvm çåå¾åæ¶å¨è¿è¡åå¾åæ¶çã\n\n\n# å¦ä½ç°å® servlet çåçº¿ç¨æ¨¡å¼\n\n<%@ page isthreadsafe="false" %>\n\n\n\n# servlet ä¸­å¦ä½è·åç¨æ·æäº¤çæ¥è¯¢åæ°æèè¡¨åæ°æ®\n\n * httpservletrequest ç getparameter() æ¹æ³ã\n * httpservletrequest ç getparametervalues() æ¹æ³ã\n * httpservletrequest ç getparametermap() æ¹æ³ã\n\n\n# request çä¸»è¦æ¹æ³\n\n * setattribute(string name,object)ï¼è®¾ç½®åå­ä¸º name ç request çåæ°å¼\n * getattribute(string name)ï¼è¿åç± name æå®çå±æ§å¼\n * getattributenames()ï¼è¿å request å¯¹è±¡ææå±æ§çåå­éåï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getcookies()ï¼è¿åå®¢æ·ç«¯çææ cookie å¯¹è±¡ï¼ç»ææ¯ä¸ä¸ª cookie æ°ç»\n * getcharacterencoding()ï¼è¿åè¯·æ±ä¸­çå­ç¬¦ç¼ç æ¹å¼\n * getcontentlength()ï¼è¿åè¯·æ±ç body çé¿åº¦\n * getheader(string name)ï¼è·å¾ http åè®®å®ä¹çæä»¶å¤´ä¿¡æ¯\n * getheaders(string name)ï¼è¿åæå®åå­ç request header çææå¼ï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getheadernames()ï¼è¿åæä»¥ request header çåå­ï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getinputstream()ï¼è¿åè¯·æ±çè¾å¥æµï¼ç¨äºè·å¾è¯·æ±ä¸­çæ°æ® getmethod()ï¼è·å¾å®¢æ·ç«¯åæå¡å¨ç«¯ä¼ éæ°æ®çæ¹æ³\n * getparameter(string name)ï¼è·å¾å®¢æ·ç«¯ä¼ éç»æå¡å¨ç«¯çæ name æå®çåæ°å¼\n * getparameternames()ï¼è·å¾å®¢æ·ç«¯ä¼ éç»æå¡å¨ç«¯çææåæ°çåå­ï¼ç»ææ¯ä¸ä¸ªæä¸¾çå®ä¾\n * getparametervalues(string name)ï¼è·å¾æ name æå®çåæ°çææå¼\n * getprotocol()ï¼è·åå®¢æ·ç«¯åæå¡å¨ç«¯ä¼ éæ°æ®æä¾æ®çåè®®åç§°\n * getquerystring()ï¼è·å¾æ¥è¯¢å­ç¬¦ä¸²\n * getrequesturi()ï¼è·åååºè¯·æ±å­ç¬¦ä¸²çå®¢æ·ç«¯å°å\n * getremoteaddr()ï¼è·åå®¢æ·ç«¯ç ip å°å\n * getremotehost()ï¼è·åå®¢æ·ç«¯çåå­\n * getsession([boolean create])ï¼è¿ååè¯·æ±ç¸å³\n * session getservername()ï¼è·åæå¡å¨çåå­\n * getservletpath()ï¼è·åå®¢æ·ç«¯æè¯·æ±çèæ¬æä»¶çè·¯å¾\n * getserverport()ï¼è·åæå¡å¨çç«¯å£å·\n * removeattribute(string name)ï¼å é¤è¯·æ±ä¸­çä¸ä¸ªå±æ§\n\n\n# jsp\n\n\n# jsp çåç½®å¯¹è±¡\n\n 1. requestï¼åå«å®¢æ·ç«¯è¯·æ±çä¿¡æ¯ï¼\n 2. responseï¼åå«æå¡å¨ä¼ åå®¢æ·ç«¯çååºä¿¡æ¯ï¼\n 3. sessionï¼ä¸»è¦ç¨æ¥åºåæ¯ä¸ªç¨æ·ä¿¡æ¯åä¼è¯ç¶æï¼\n 4. pagecontextï¼ç®¡çé¡µé¢å±æ§ï¼\n 5. applicationï¼æå¡å¨å¯å¨æ¶åå»ºï¼æå¡å¨å³é­æ¶åæ­¢ï¼ä¿å­ææåºç¨ç³»ç»ä¸­çå±ææ°æ®ï¼ä¸ä¸ªå±äº«çåç½®å¯¹è±¡ï¼å³ä¸ä¸ªå®¹å¨ä¸­çå¤ä¸ªç¨æ·å±äº«ä¸ä¸ª application å¯¹è±¡ï¼ï¼\n 6. outï¼åå®¢æ·ç«¯è¾åºæ°æ®ï¼\n 7. configï¼ä»£ç çæ®µéç½®å¯¹è±¡ï¼ç¨äºåå§å servlet çéç½®åæ°ï¼\n 8. pageï¼æç½é¡µæ¬èº«ï¼\n 9. exceptionï¼å¤ç jsp æä»¶æ§è¡æ¶åççéè¯¯åå¼å¸¸ï¼åªè¦å¨éè¯¯é¡µé¢éæè½ä½¿ç¨ã\n\n\n# jsp çä½ç¨å\n\n 1. pageï¼ä¸ä¸ªé¡µé¢ï¼\n 2. requestï¼ä¸æ¬¡è¯·æ±ï¼\n 3. sessionï¼ä¸æ¬¡ä¼è¯ï¼\n 4. applicationï¼æå¡å¨ä»å¯å¨å°åæ­¢ã\n\n\n# jsp ä¸­ 7 ä¸ªå¨ä½æä»¤åä½ç¨\n\n 1. jsp:forward - æ§è¡é¡µé¢è½¬åï¼æè¯·æ±è½¬åå°ä¸ä¸ä¸ªé¡µé¢ï¼\n 2. jsp:param - ç¨äºä¼ éåæ°ï¼å¿é¡»ä¸å¶ä»æ¯æåæ°çæ ç­¾ä¸èµ·ä½¿ç¨ï¼\n 3. jsp:include - ç¨äºå¨æå¼å¥ä¸ä¸ª jsp é¡µé¢ï¼\n 4. jsp:plugin - ç¨äºä¸è½½ javabean æ applet å°å®¢æ·ç«¯æ§è¡ï¼\n 5. jsp:usebean - å¯»æ±æèå®ä¾åä¸ä¸ª javabeanï¼\n 6. jsp:setproperty - è®¾ç½® javabean çå±æ§å¼ï¼\n 7. jsp:getproperty - è·å javabean çå±æ§å¼ã\n\n\n# jsp ä¸­å¨æ include åéæ include æä»ä¹åºå«\n\n * éæ includeï¼ç¨ include ä¼ªç å®ç°ï¼ä¸ä¼æ£æ¥æå«æä»¶çååï¼éç¨äºåå«éæé¡µé¢<%@ include file="é¡µé¢åç§°.html" %>ãååå¹¶åç¼è¯ã\n * å¨æ includeï¼ç¨ jsp:include å¨ä½å®ç° <jsp:include page="é¡µé¢åç§° .jsp" flush="true"> å®æ»æ¯ä¼æ£æ¥æä»¶ä¸­çååï¼éç¨äºåå«å¨æé¡µé¢ï¼å¹¶ä¸å¯ä»¥å¸¦åæ°ãåç¼è¯ååå¹¶ã\n\n\n# åç\n\n\n# è¯·æ±è½¬å(forward)åéå®å(redirect)çåºå«\n\n * æçä¸\n   * è½¬åï¼forwardï¼ > éå®åï¼redirectï¼\n * æ¾ç¤ºä¸\n   * éå®åï¼redirectï¼ï¼æ¾ç¤ºæ°ç url\n   * è½¬åï¼forwardï¼ï¼å°åæ ä¸å\n * æ°æ®ä¸\n   * è½¬åï¼forwardï¼ï¼å¯ä»¥å±äº« request éé¢çæ°æ®\n   * éå®åï¼redirectï¼ï¼ä¸è½\n * è¯·æ±æ¬¡æ°\n   * éå®åï¼redirectï¼æ¯ä¸¤æ¬¡\n   * è½¬åï¼forwardï¼æ¯ä¸æ¬¡\n\n\n# get è¯·æ±å post è¯·æ±çåºå«\n\n\n\n * getï¼\n   * ä»æå¡å¨ä¸è·åæ°æ®ï¼ä¸è¬ä¸è½ä½¿ç¨å¨åæä½æ¥å£\n   * ç± url æéå¶ï¼get æ¹å¼ä¼ è¾çæ°æ®å¤§å°ææéå¶ï¼ä¼ éçæ°æ®éä¸è¶è¿ 2kb\n   * è¯·æ±çæ°æ®ä¼éå å¨ url ä¹åï¼ä»¥ï¼åé url åä¼ è¾æ°æ®ï¼å¤ä¸ªåæ°ç¨&è¿æ¥\n   * å®å¨æ§å·®\n * post:\n   * åæå¡å¨æäº¤æ°æ®,ä¸è¬å¤çåä¸å¡\n   * post æ¹å¼ä¼ éçæ°æ®éæ¯è¾å¤§ï¼ä¸è¬è¢«é»è®¤ä¸ºæ²¡æéå¶\n   * å®å¨æ§é«\n   * è¯·çæ±çæ°æ®åå®¹æ¾ç½®å¨ html header ä¸­\n\n\n# ç¨æ·å¨æµè§å¨ä¸­è¾å¥ url ä¹åï¼åä»ä¹äºä»ä¹ï¼ååºè¯·æ±åååºçæµç¨\n\n 1. ååè§£æ\n 2. tcp ä¸æ¬¡æ¡æ\n 3. æµè§å¨åæå¡å¨åé http è¯·æ±\n 4. æµè§å¨åéè¯·æ±å¤´ä¿¡æ¯\n 5. æå¡å¨å¤çè¯·æ±\n 6. æå¡å¨ååºåºç­\n 7. æå¡å¨åéåºç­å¤´ä¿¡æ¯\n 8. æå¡å¨åéæ°æ®\n 9. tcp è¿æ¥å³é­\n\n\n# ä»ä¹æ¯ web service?\n\n 1. webservice å°±æ¯ä¸ä¸ªåºç¨ç¨åºï¼å®åå¤çæ´é²åºä¸ä¸ªè½å¤éè¿ web è¿è¡è°ç¨ç apiã\n 2. å®æ¯åºäº http åè®®ä¼ è¾æ°æ®ï¼è¿ä½¿å¾è¿è¡å¨ä¸åæºä¸çä¸ååºç¨ç¨åºï¼æ é¡»åå©éå çãä¸é¨çç¬¬ä¸æ¹ è½¯ä»¶æç¡¬ä»¶ï¼å°±å¯ä»¥ç¸äºäº¤æ¢æ°æ®æéæã\n\n\n# ä¼è¯è·è¸ªææ¯æåªäº?\n\nç±äº http åè®®æ¬èº«æ¯æ ç¶æçï¼æå¡å¨ä¸ºäºåºåä¸åçç¨æ·ï¼å°±éè¦å¯¹ç¨æ·ä¼è¯è¿è¡è·è¸ªï¼ç®åçè¯´å°±æ¯ä¸ºç¨æ·è¿è¡ç»è®°ï¼ä¸ºç¨æ·åéå¯ä¸ç idï¼ä¸ä¸æ¬¡ç¨æ·å¨è¯·æ±ä¸­åå«æ­¤ idï¼æå¡å¨æ ¹æ®æ­¤å¤æ­å°åºæ¯åªä¸ä¸ªç¨æ·ã\n\n * url éåï¼å¨ url ä¸­æ·»å ä¼è¯ä¿¡æ¯ä½ä¸ºè¯·æ±çåæ°ï¼æèå°å¯ä¸çä¼è¯ id æ·»å å° url ç»å°¾ï¼ä»¥è¡¨ç¤ºä¸ä¸ªä¼è¯ãè®¾ç½®è¡¨åéèåï¼å°åä¼è¯è·è¸ªç¸å³çå­æ®µæ·»å å°éèåä¸­ï¼è¿äºä¿¡æ¯ä¸ä¼å¨æµè§å¨æ¾ç¤ºï¼ä½æ¯æäº¤è¡¨åæ¶ä¼æäº¤ç»æå¡å¨ã\n * cookieï¼cookie æä¸¤ç§ï¼\n   * ä¸ç§æ¯åºäºçªå£çï¼æµè§å¨å³é­åï¼cookie å°±æ²¡æäºï¼\n   * å¦ä¸ç§æ¯å°ä¿¡æ¯å­å¨å¨ä¸ä¸ªä¸´æ¶æä»¶ä¸­ï¼å¹¶è®¾ç½®å¶ææè·¯å¾åæå¤§å­æ´»æ¶é´ãå½ç¨æ·éè¿æµè§å¨åæå¡å¨å»ºç«ä¸æ¬¡ä¼è¯åï¼ä¼è¯ id å°±ä¼éç¸åºä¿¡æ¯å¨å­å¨åºäºçªå£ç cookie ä¸­ï¼é£å°±æå³çåªè¦æµè§å¨æ²¡æå³é­ï¼ä¼è¯æ²¡æè¶æ¶ï¼ä¸ä¸æ¬¡è¯·æ±æ¶è¿ä¸ªä¼è¯ id åä¼æäº¤ç»æå¡å¨ï¼è®©æå¡å¨è¯å«ç¨æ·èº«ä»½ã\n   * å¨ä½¿ç¨ cookie æ¶è¦æ³¨æå ç¹ï¼\n     * é¦åä¸è¦å¨ cookie ä¸­å­æ¾æ æä¿¡æ¯ï¼\n     * å¶æ¬¡ cookie å­å¨çæ°æ®éæéï¼4kï¼ï¼ä¸è½å°è¿å¤çåå®¹å­å¨ cookie ä¸­ï¼\n     * åèæµè§å¨éå¸¸åªåè®¸ä¸ä¸ªç«ç¹æå¤å­æ¾ 20 ä¸ª cookieã\n     * å½ç¶ï¼åç¨æ·ä¼è¯ç¸å³çå¶ä»ä¿¡æ¯ï¼é¤äºä¼è¯ idï¼ä¹å¯ä»¥å­å¨ cookie æ¹ä¾¿è¿è¡ä¼è¯ è·è¸ª;\n * httpsessionï¼å¨ææä¼è¯è·è¸ªææ¯ä¸­ï¼httpsession å¯¹è±¡æ¯æå¼ºå¤§ä¹æ¯åè½æå¤çãå½ä¸ä¸ªç¨æ·ç¬¬ä¸æ¬¡è®¿é®æä¸ªç½ç«æ¶ä¼èªå¨åå»º httpsessionï¼æ¯ä¸ªç¨æ·å¯ä»¥è®¿é®ä»èªå·±ç httpsessionãå¯ä»¥éè¿ httpservletrequest å¯¹è±¡ç getsession æ¹æ³è·å¾ httpsessionï¼éè¿ httpsession ç setattribute æ¹æ³å¯ä»¥å°ä¸ä¸ªå¼æ¾å¨ httpsession ä¸­ï¼éè¿è°ç¨ httpsession å¯¹è±¡ç getattribute æ¹æ³ï¼åæ¶ä¼ å¥å±æ§åå°±å¯ä»¥è·åä¿å­å¨ httpsession ä¸­çå¯¹è±¡ã\n   * ä¸ä¸é¢ä¸ç§æ¹å¼ä¸åçæ¯ï¼httpsession æ¾å¨æå¡å¨çåå­ä¸­ï¼å æ­¤ä¸è¦å°è¿å¤§çå¯¹è±¡æ¾å¨éé¢ï¼å³ä½¿ç®åç servlet å®¹å¨å¯ä»¥å¨åå­å°æ»¡æ¶å° httpsession ä¸­çå¯¹è±¡ç§»å°å¶ä»å­å¨è®¾å¤ä¸­ï¼ä½æ¯è¿æ ·å¿å¿å½±åæ§è½ã\n   * æ·»å å° httpsession ä¸­ çå¼å¯ä»¥æ¯ä»»æ java å¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡æå¥½å®ç°äº serializable æ¥å£ï¼è¿æ · servlet å®¹å¨å¨å¿è¦çæ¶åå¯ä»¥å°å¶åºå åå°æä»¶ä¸­ï¼å¦åå¨åºååæ¶å°±ä¼åºç°å¼å¸¸ã\n\n\n# ååºç»æç¶æç æåªäºï¼å¹¶ç»åºä¸­æå«ä¹ï¼\n\n * 1**ï¼ä¿¡æ¯æ§ç¶æç \n * 2**ï¼æåç¶æç \n   * 200ï¼è¯·æ±æ­£å¸¸æå\n   * 204ï¼æç¤ºè¯·æ±æåä½æ²¡æè¿åæ°ä¿¡æ¯\n   * 206ï¼æç¤ºæå¡å¨å·²å®æå¯¹èµæºçé¨å get è¯·æ±\n * 3**ï¼éå®åç¶æç \n   * 301ï¼æ°¸ä¹æ§éå®å\n   * 302ï¼ä¸´æ¶æ§éå®å\n   * 304ï¼æå¡å¨ç«¯åè®¸è¯·æ±è®¿é®èµæºï¼ä½æªæ»¡è¶³æ¡ä»¶\n * 4**ï¼å®¢æ·ç«¯éè¯¯ç¶æç \n   * 400ï¼è¯·æ±æ¥æä¸­å­å¨è¯­æ³éè¯¯\n   * 401ï¼åéçè¯·æ±éè¦æéè¿ http è®¤è¯çè®¤è¯ä¿¡æ¯\n   * 403ï¼å¯¹è¯·æ±èµæºçè®¿é®è¢«æå¡å¨æç»äº\n   * 404ï¼æå¡å¨ä¸æ æ³æ¾å°è¯·æ±çèµæº\n * 5**ï¼æå¡å¨éè¯¯ç¶æç \n   * 500ï¼æå¡å¨ç«¯å¨æ§è¡è¯·æ±æ¶åçäºéè¯¯\n   * 503ï¼æå¡å¨ææ¶å¤äºè¶è´è½½ææ­£å¨è¿è¡åæºç»´æ¤ï¼ç°å¨æ æ³å¤çè¯·æ±\n\n\n# xml ææ¡£å®ä¹æå ç§å½¢å¼ï¼å®ä»¬ä¹é´æä½æ¬è´¨åºå«ï¼è§£æ xml ææ¡£æåªå ç§æ¹å¼ï¼\n\nï¼1ï¼xml ææ¡£æä¸¤ç§çº¦ææ¹å¼ï¼\n\n 1. dtd çº¦æ\n 2. schema çº¦æ\n\nï¼2ï¼xml ææ¡£åºå«ï¼ 1 dtd ä¸ç¬¦å xml çè¯­æ³ç»æï¼schema ç¬¦å xml çè¯­æ³ç»æï¼ 2 dtd ççº¦ææ©å±æ§æ¯è¾å·®ï¼xml ææ¡£åªè½å¼å¥ä¸ä¸ª dtd çæä»¶ãschema å¯ä»¥å¼å¥å¤ä¸ªæä»¶ï¼ 3 dtd ä¸æ¯æåç§°ç©ºé´ï¼çè§£åç»æï¼ï¼schema æ¯æåç§°ç©ºé´ï¼ 4 dtd æ¯ææ°æ®æ¯è¾å°ï¼schema æ¯ææ´å¤çæ°æ®ç±»åï¼\n\nï¼3ï¼è§£ææ¹å¼ä¸»è¦æä¸ç§ï¼\n\n * dom è§£æï¼\n   * ï¼aï¼å è½½æ´ä¸ª xml çææ¡£å°åå­ä¸­ï¼å½¢ææ ç¶ç»æï¼çæå¯¹è±¡ï¼\n   * ï¼bï¼å®¹æäº§çåå­æº¢åºï¼\n   * ï¼cï¼å¯ä»¥åå¢å æ¹\n * sax è§£æ\n   * ï¼aï¼è¾¹è¯»è¾¹è§£æï¼\n   * ï¼bï¼ä¸å¯ä»¥åå¢å æ¹\n * dom4j è§£æï¼hibernate åºå±éç¨)\n   * ï¼aï¼å¯è®© sax è§£æä¹äº§çæ ç¶ç»æã\n   * ï¼bï¼ä¸»è¦ api å¼åæ­¥éª¤ï¼\n     * 1ï¼saxreader.read(xxx.xml)ä»£è¡¨è§£æ xml çææ¡£ï¼è¿åå¯¹è±¡æ¯ documentï¼\n     * 2ï¼document.getrootelement(),è¿åçæ¯ææ¡£çæ ¹èç¹ï¼æ¯ element å¯¹è±¡ï¼\n     * 3ï¼element:\n       * .element(...)-- è·å¾æå®åç§°ç¬¬ä¸ä¸ªå­åç´ ãå¯ä»¥ä¸æå®åç§°;\n       * .elements(...)-- è·å¾æå®åç§°çææå­åç´ ãå¯ä»¥ä¸æå®åç§°;\n       * .gettext()-- è·å¾å½ååç´ çææ¬åå®¹ï¼\n       * .elementtext(...)-- è·å¾æå®åç§°å­åç´ çææ¬å¼\n       * .addelement()-- æ·»å å­èç¹\n       * .settext()-- è®¾ç½®å­æ ç­¾åå®¹\n     * 4ï¼xmlwriter.write("..")-- ååº\n     * 5ï¼xmlwriter.close()-- å³é­è¾åºæµ\n\n\n# åèèµæ\n\n * https://blog.csdn.net/ym_ily/article/details/81266959\n * https://www.jianshu.com/p/f073dde56262',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaWeb",frontmatter:{title:"JavaWeb",categories:["ç¼ç¨","Java","JavaWeb"],tags:["JavaWeb"],hidden:!0,abbrlink:"99720b1c",date:"2020-02-07T23:04:47.000Z",permalink:"/pages/c1cee9/"},regularPath:"/02.JavaEE/01.JavaWeb/",relativePath:"02.JavaEE/01.JavaWeb/README.md",key:"v-17a7d10c",path:"/pages/c1cee9/",headers:[{level:2,title:"ç¥è¯ç¹",slug:"ç¥è¯ç¹",normalizedTitle:"ç¥è¯ç¹",charIndex:16},{level:2,title:"å­¦ä¹ èµæ",slug:"å­¦ä¹ èµæ",normalizedTitle:"å­¦ä¹ èµæ",charIndex:144}],headersStr:"ç¥è¯ç¹ å­¦ä¹ èµæ",content:"# â JavaWeb\n\n\n# ç¥è¯ç¹\n\n * JavaWeb ä¹ Servlet æå\n * JavaWeb ä¹ Jsp æå\n * JavaWeb ä¹ Filter å Listener\n * JavaWeb ä¹ Cookie å Session\n * JavaWeb é¢ç»\n\n\n# å­¦ä¹ èµæ\n\n * ä¹¦ç±\n   * Java Web æ´åå¼åçèå½æ¥\n   * Head First Servlets & JSP\n * æç¨\n   * æ·±å¥æè§£ Tomcat & Jetty\n   * Servlet æç¨\n   * åå®¢å­å­¤å²èç¼ JavaWeb å­¦ä¹ æ»ç»\n   * JSP æç¨",normalizedContent:"# â javaweb\n\n\n# ç¥è¯ç¹\n\n * javaweb ä¹ servlet æå\n * javaweb ä¹ jsp æå\n * javaweb ä¹ filter å listener\n * javaweb ä¹ cookie å session\n * javaweb é¢ç»\n\n\n# å­¦ä¹ èµæ\n\n * ä¹¦ç±\n   * java web æ´åå¼åçèå½æ¥\n   * head first servlets & jsp\n * æç¨\n   * æ·±å¥æè§£ tomcat & jetty\n   * servlet æç¨\n   * åå®¢å­å­¤å²èç¼ javaweb å­¦ä¹ æ»ç»\n   * jsp æç¨",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Tomcat å¿«éå¥é¨",frontmatter:{title:"Tomcat å¿«éå¥é¨",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Tomcat"],abbrlink:"ea4ca089",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/c50d2b/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/01.Tomcat/01.Tomcat%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html",relativePath:"02.JavaEE/02.æå¡å¨/01.Tomcat/01.Tomcatå¿«éå¥é¨.md",key:"v-75ecbd16",path:"/pages/c50d2b/",headers:[{level:2,title:"1. Tomcat ç®ä»",slug:"_1-tomcat-ç®ä»",normalizedTitle:"1. tomcat ç®ä»",charIndex:71},{level:3,title:"1.1. Tomcat æ¯ä»ä¹",slug:"_1-1-tomcat-æ¯ä»ä¹",normalizedTitle:"1.1. tomcat æ¯ä»ä¹",charIndex:88},{level:3,title:"1.2. Tomcat éè¦ç®å½",slug:"_1-2-tomcat-éè¦ç®å½",normalizedTitle:"1.2. tomcat éè¦ç®å½",charIndex:422},{level:3,title:"1.3. web å·¥ç¨åå¸ç®å½ç»æ",slug:"_1-3-web-å·¥ç¨åå¸ç®å½ç»æ",normalizedTitle:"1.3. web å·¥ç¨åå¸ç®å½ç»æ",charIndex:601},{level:3,title:"1.4. Tomcat åè½",slug:"_1-4-tomcat-åè½",normalizedTitle:"1.4. tomcat åè½",charIndex:1548},{level:2,title:"2. Tomcat å¥é¨",slug:"_2-tomcat-å¥é¨",normalizedTitle:"2. tomcat å¥é¨",charIndex:1823},{level:3,title:"2.1. å®è£",slug:"_2-1-å®è£",normalizedTitle:"2.1. å®è£",charIndex:1840},{level:3,title:"2.2. éç½®",slug:"_2-2-éç½®",normalizedTitle:"2.2. éç½®",charIndex:2317},{level:4,title:"2.2.1. Server",slug:"_2-2-1-server",normalizedTitle:"2.2.1. server",charIndex:2385},{level:4,title:"2.2.2. Service",slug:"_2-2-2-service",normalizedTitle:"2.2.2. service",charIndex:2864},{level:4,title:"2.2.3. Executor",slug:"_2-2-3-executor",normalizedTitle:"2.2.3. executor",charIndex:3378},{level:4,title:"2.2.4. Connector",slug:"_2-2-4-connector",normalizedTitle:"2.2.4. connector",charIndex:4212},{level:4,title:"2.2.5. Context",slug:"_2-2-5-context",normalizedTitle:"2.2.5. context",charIndex:6442},{level:4,title:"2.2.6. Engine",slug:"_2-2-6-engine",normalizedTitle:"2.2.6. engine",charIndex:7503},{level:4,title:"2.2.7. Host",slug:"_2-2-7-host",normalizedTitle:"2.2.7. host",charIndex:7857},{level:4,title:"2.2.8. Cluster",slug:"_2-2-8-cluster",normalizedTitle:"2.2.8. cluster",charIndex:8899},{level:3,title:"2.3. å¯å¨",slug:"_2-3-å¯å¨",normalizedTitle:"2.3. å¯å¨",charIndex:8953},{level:4,title:"2.3.1. é¨ç½²æ¹å¼",slug:"_2-3-1-é¨ç½²æ¹å¼",normalizedTitle:"2.3.1. é¨ç½²æ¹å¼",charIndex:8964},{level:4,title:"2.3.2. åµå¥å¼",slug:"_2-3-2-åµå¥å¼",normalizedTitle:"2.3.2. åµå¥å¼",charIndex:9269},{level:5,title:"2.3.2.1. API æ¹å¼",slug:"_2-3-2-1-api-æ¹å¼",normalizedTitle:"2.3.2.1. api æ¹å¼",charIndex:9283},{level:5,title:"2.3.2.2. ä½¿ç¨ maven æä»¶å¯å¨ï¼ä¸æ¨èï¼",slug:"_2-3-2-2-ä½¿ç¨-maven-æä»¶å¯å¨-ä¸æ¨è",normalizedTitle:"2.3.2.2. ä½¿ç¨ maven æä»¶å¯å¨ï¼ä¸æ¨èï¼",charIndex:10857},{level:4,title:"2.3.3. IDE æä»¶",slug:"_2-3-3-ide-æä»¶",normalizedTitle:"2.3.3. ide æä»¶",charIndex:11396},{level:2,title:"3. Tomcat æ¶æ",slug:"_3-tomcat-æ¶æ",normalizedTitle:"3. tomcat æ¶æ",charIndex:11891},{level:3,title:"3.1. Service",slug:"_3-1-service",normalizedTitle:"3.1. service",charIndex:12093},{level:3,title:"3.2. è¿æ¥å¨",slug:"_3-2-è¿æ¥å¨",normalizedTitle:"3.2. è¿æ¥å¨",charIndex:12681},{level:4,title:"3.2.1. ProtocolHandler ç»ä»¶",slug:"_3-2-1-protocolhandler-ç»ä»¶",normalizedTitle:"3.2.1. protocolhandler ç»ä»¶",charIndex:13459},{level:5,title:"3.2.1.1. EndPoint",slug:"_3-2-1-1-endpoint",normalizedTitle:"3.2.1.1. endpoint",charIndex:13622},{level:5,title:"3.2.1.2. Processor",slug:"_3-2-1-2-processor",normalizedTitle:"3.2.1.2. processor",charIndex:14040},{level:4,title:"3.2.2. Adapter",slug:"_3-2-2-adapter",normalizedTitle:"3.2.2. adapter",charIndex:14552},{level:3,title:"3.3. å®¹å¨",slug:"_3-3-å®¹å¨",normalizedTitle:"3.3. å®¹å¨",charIndex:14939},{level:4,title:"3.3.1. è¯·æ±åå Servlet è¿ç¨",slug:"_3-3-1-è¯·æ±åå-servlet-è¿ç¨",normalizedTitle:"3.3.1. è¯·æ±åå servlet è¿ç¨",charIndex:15214},{level:4,title:"3.3.2. Pipeline-Value",slug:"_3-3-2-pipeline-value",normalizedTitle:"3.3.2. pipeline-value",charIndex:15876},{level:2,title:"4. Tomcat çå½å¨æ",slug:"_4-tomcat-çå½å¨æ",normalizedTitle:"4. tomcat çå½å¨æ",charIndex:17055},{level:3,title:"4.1. Tomcat çå¯å¨è¿ç¨",slug:"_4-1-tomcat-çå¯å¨è¿ç¨",normalizedTitle:"4.1. tomcat çå¯å¨è¿ç¨",charIndex:17074},{level:4,title:"4.1.1. Catalina ç»ä»¶",slug:"_4-1-1-catalina-ç»ä»¶",normalizedTitle:"4.1.1. catalina ç»ä»¶",charIndex:17447},{level:4,title:"4.1.2. Server ç»ä»¶",slug:"_4-1-2-server-ç»ä»¶",normalizedTitle:"4.1.2. server ç»ä»¶",charIndex:18843},{level:4,title:"4.1.3. Service ç»ä»¶",slug:"_4-1-3-service-ç»ä»¶",normalizedTitle:"4.1.3. service ç»ä»¶",charIndex:20100},{level:4,title:"4.1.4. Engine ç»ä»¶",slug:"_4-1-4-engine-ç»ä»¶",normalizedTitle:"4.1.4. engine ç»ä»¶",charIndex:21714},{level:3,title:"4.2. Web åºç¨çé¨ç½²æ¹å¼",slug:"_4-2-web-åºç¨çé¨ç½²æ¹å¼",normalizedTitle:"4.2. web åºç¨çé¨ç½²æ¹å¼",charIndex:21792},{level:3,title:"4.3. LifeCycle",slug:"_4-3-lifecycle",normalizedTitle:"4.3. lifecycle",charIndex:23040},{level:4,title:"4.3.1. è¯·æ±å¤çè¿ç¨",slug:"_4-3-1-è¯·æ±å¤çè¿ç¨",normalizedTitle:"4.3.1. è¯·æ±å¤çè¿ç¨",charIndex:23060},{level:3,title:"4.4. Connector æµç¨",slug:"_4-4-connector-æµç¨",normalizedTitle:"4.4. connector æµç¨",charIndex:23294},{level:4,title:"4.4.1. é»å¡ IO",slug:"_4-4-1-é»å¡-io",normalizedTitle:"4.4.1. é»å¡ io",charIndex:23317},{level:4,title:"4.4.2. éé»å¡ IO",slug:"_4-4-2-éé»å¡-io",normalizedTitle:"4.4.2. éé»å¡ io",charIndex:23335},{level:4,title:"4.4.3. IO å¤è·¯å¤ç¨",slug:"_4-4-3-io-å¤è·¯å¤ç¨",normalizedTitle:"4.4.3. io å¤è·¯å¤ç¨",charIndex:23354},{level:4,title:"4.4.4. Tomcat åç±» Connector å¯¹æ¯",slug:"_4-4-4-tomcat-åç±»-connector-å¯¹æ¯",normalizedTitle:"4.4.4. tomcat åç±» connector å¯¹æ¯",charIndex:23505},{level:3,title:"4.5. Comet",slug:"_4-5-comet",normalizedTitle:"4.5. comet",charIndex:24579},{level:3,title:"4.6. å¼æ­¥ Servlet",slug:"_4-6-å¼æ­¥-servlet",normalizedTitle:"4.6. å¼æ­¥ servlet",charIndex:25291},{level:2,title:"5. åèèµæ",slug:"_5-åèèµæ",normalizedTitle:"5. åèèµæ",charIndex:26192}],headersStr:"1. Tomcat ç®ä» 1.1. Tomcat æ¯ä»ä¹ 1.2. Tomcat éè¦ç®å½ 1.3. web å·¥ç¨åå¸ç®å½ç»æ 1.4. Tomcat åè½ 2. Tomcat å¥é¨ 2.1. å®è£ 2.2. éç½® 2.2.1. Server 2.2.2. Service 2.2.3. Executor 2.2.4. Connector 2.2.5. Context 2.2.6. Engine 2.2.7. Host 2.2.8. Cluster 2.3. å¯å¨ 2.3.1. é¨ç½²æ¹å¼ 2.3.2. åµå¥å¼ 2.3.2.1. API æ¹å¼ 2.3.2.2. ä½¿ç¨ maven æä»¶å¯å¨ï¼ä¸æ¨èï¼ 2.3.3. IDE æä»¶ 3. Tomcat æ¶æ 3.1. Service 3.2. è¿æ¥å¨ 3.2.1. ProtocolHandler ç»ä»¶ 3.2.1.1. EndPoint 3.2.1.2. Processor 3.2.2. Adapter 3.3. å®¹å¨ 3.3.1. è¯·æ±åå Servlet è¿ç¨ 3.3.2. Pipeline-Value 4. Tomcat çå½å¨æ 4.1. Tomcat çå¯å¨è¿ç¨ 4.1.1. Catalina ç»ä»¶ 4.1.2. Server ç»ä»¶ 4.1.3. Service ç»ä»¶ 4.1.4. Engine ç»ä»¶ 4.2. Web åºç¨çé¨ç½²æ¹å¼ 4.3. LifeCycle 4.3.1. è¯·æ±å¤çè¿ç¨ 4.4. Connector æµç¨ 4.4.1. é»å¡ IO 4.4.2. éé»å¡ IO 4.4.3. IO å¤è·¯å¤ç¨ 4.4.4. Tomcat åç±» Connector å¯¹æ¯ 4.5. Comet 4.6. å¼æ­¥ Servlet 5. åèèµæ",content:'# Tomcat å¿«éå¥é¨\n\n> ð çæ¬è¯´æ\n> \n> å½åææ°çæ¬ï¼Tomcat 8.5.24\n> \n> ç¯å¢è¦æ±ï¼JDK7+\n\n\n# 1. Tomcat ç®ä»\n\n\n# 1.1. Tomcat æ¯ä»ä¹\n\nTomcat æ¯ç± Apache å¼åçä¸ä¸ª Servlet å®¹å¨ï¼å®ç°äºå¯¹ Servlet å JSP çæ¯æï¼å¹¶æä¾äºä½ä¸º Web æå¡å¨çä¸äºç¹æåè½ï¼å¦ Tomcat ç®¡çåæ§å¶å¹³å°ãå®å¨åç®¡çå Tomcat éç­ã\n\nç±äº Tomcat æ¬èº«ä¹åå«äºä¸ä¸ª HTTP æå¡å¨ï¼å®ä¹å¯ä»¥è¢«è§ä½ä¸ä¸ªåç¬ç Web æå¡å¨ãä½æ¯ï¼ä¸è½å° Tomcat å Apache HTTP æå¡å¨æ··æ·ï¼Apache HTTP æå¡å¨æ¯ä¸ä¸ªç¨ C è¯­è¨å®ç°ç HTTP Web æå¡å¨ï¼è¿ä¸¤ä¸ª HTTP web server ä¸æ¯æç»å¨ä¸èµ·çãTomcat åå«äºä¸ä¸ªéç½®ç®¡çå·¥å·ï¼ä¹å¯ä»¥éè¿ç¼è¾ XML æ ¼å¼çéç½®æä»¶æ¥è¿è¡éç½®ã\n\n\n# 1.2. Tomcat éè¦ç®å½\n\n * /bin - Tomcat èæ¬å­æ¾ç®å½ï¼å¦å¯å¨ãå³é­èæ¬ï¼ã *.sh æä»¶ç¨äº Unix ç³»ç»ï¼ *.bat æä»¶ç¨äº Windows ç³»ç»ã\n * /conf - Tomcat éç½®æä»¶ç®å½ã\n * /logs - Tomcat é»è®¤æ¥å¿ç®å½ã\n * /webapps - webapp è¿è¡çç®å½ã\n\n\n# 1.3. web å·¥ç¨åå¸ç®å½ç»æ\n\nä¸è¬ web é¡¹ç®è·¯å¾ç»æ\n\n|-- webapp                         # ç«ç¹æ ¹ç®å½\n    |-- META-INF                   # META-INF ç®å½\n    |   `-- MANIFEST.MF            # éç½®æ¸åæä»¶\n    |-- WEB-INF                    # WEB-INF ç®å½\n    |   |-- classes                # classæä»¶ç®å½\n    |   |   |-- *.class            # ç¨åºéè¦ç class æä»¶\n    |   |   `-- *.xml              # ç¨åºéè¦ç xml æä»¶\n    |   |-- lib                    # åºæä»¶å¤¹\n    |   |   `-- *.jar              # ç¨åºéè¦ç jar å\n    |   `-- web.xml                # Webåºç¨ç¨åºçé¨ç½²æè¿°æä»¶\n    |-- <userdir>                  # èªå®ä¹çç®å½\n    |-- <userfiles>                # èªå®ä¹çèµæºæä»¶\n\n\n * webappï¼å·¥ç¨åå¸æä»¶å¤¹ãå¶å®æ¯ä¸ª war åé½å¯ä»¥è§ä¸º webapp çåç¼©åã\n\n * META-INFï¼META-INF ç®å½ç¨äºå­æ¾å·¥ç¨èªèº«ç¸å³çä¸äºä¿¡æ¯ï¼åæä»¶ä¿¡æ¯ï¼éå¸¸ç±å¼åå·¥å·ï¼ç¯å¢èªå¨çæã\n\n * WEB-INFï¼Java web åºç¨çå®å¨ç®å½ãæè°å®å¨å°±æ¯å®¢æ·ç«¯æ æ³è®¿é®ï¼åªææå¡ç«¯å¯ä»¥è®¿é®çç®å½ã\n\n * /WEB-INF/classesï¼å­æ¾ç¨åºæéè¦çææ Java class æä»¶ã\n\n * /WEB-INF/libï¼å­æ¾ç¨åºæéè¦çææ jar æä»¶ã\n\n * /WEB-INF/web.xmlï¼web åºç¨çé¨ç½²éç½®æä»¶ãå®æ¯å·¥ç¨ä¸­æéè¦çéç½®æä»¶ï¼å®æè¿°äº servlet åç»æåºç¨çå¶å®ç»ä»¶ï¼ä»¥ååºç¨åå§ååæ°ãå®å¨ç®¡ççº¦æç­ã\n\n\n# 1.4. Tomcat åè½\n\nTomcat æ¯æç I/O æ¨¡åæï¼\n\n * NIOï¼éé»å¡ I/Oï¼éç¨ Java NIO ç±»åºå®ç°ã\n * NIO2ï¼å¼æ­¥ I/Oï¼éç¨ JDK 7 ææ°ç NIO2 ç±»åºå®ç°ã\n * APRï¼éç¨ Apache å¯ç§»æ¤è¿è¡åºå®ç°ï¼æ¯ C/C++ ç¼åçæ¬å°åºã\n\nTomcat æ¯æçåºç¨å±åè®®æï¼\n\n * HTTP/1.1ï¼è¿æ¯å¤§é¨å Web åºç¨éç¨çè®¿é®åè®®ã\n * AJPï¼ç¨äºå Web æå¡å¨éæï¼å¦ Apacheï¼ã\n * HTTP/2ï¼HTTP 2.0 å¤§å¹åº¦çæåäº Web æ§è½ã\n\n\n# 2. Tomcat å¥é¨\n\n\n# 2.1. å®è£\n\nåææ¡ä»¶\n\nTomcat 8.5 è¦æ± JDK çæ¬ä¸º 1.7 ä»¥ä¸ã\n\nè¿å¥ Tomcat å®æ¹ä¸è½½å°å éæ©åéçæ¬ä¸è½½ï¼å¹¶è§£åå°æ¬å°ã\n\nWindows\n\næ·»å ç¯å¢åé CATALINA_HOME ï¼å¼ä¸º Tomcat çå®è£è·¯å¾ã\n\nè¿å¥å®è£ç®å½ä¸ç bin ç®å½ï¼è¿è¡ startup.bat æä»¶ï¼å¯å¨ Tomcat\n\nLinux / Unix\n\nä¸é¢çç¤ºä¾ä»¥ 8.5.24 çæ¬ä¸ºä¾ï¼åå«äºä¸è½½ãè§£åãå¯å¨æä½ã\n\n# ä¸è½½è§£åå°æ¬å°\nwget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-8/v8.5.24/bin/apache-tomcat-8.5.24.tar.gz\ntar -zxf apache-tomcat-8.5.24.tar.gz\n# å¯å¨ Tomcat\n./apache-tomcat-8.5.24/bin/startup.sh\n\n\nå¯å¨åï¼è®¿é® http://localhost:8080 ï¼å¯ä»¥çå° Tomcat å®è£æåçæµè¯é¡µé¢ã\n\n\n\n\n# 2.2. éç½®\n\næ¬èå°åä¸¾ä¸äºéè¦ãå¸¸è§çéç½®é¡¹ãè¯¦ç»ç Tomcat8 éç½®å¯ä»¥åè Tomcat 8 éç½®å®æ¹åèææ¡£ ã\n\n# 2.2.1. Server\n\n> Server åç´ è¡¨ç¤ºæ´ä¸ª Catalina servlet å®¹å¨ã\n> \n> å æ­¤ï¼å®å¿é¡»æ¯ conf/server.xml éç½®æä»¶ä¸­çæ ¹åç´ ãå®çå±æ§ä»£è¡¨äºæ´ä¸ª servlet å®¹å¨çç¹æ§ã\n\nå±æ§è¡¨\n\nå±æ§          æè¿°                                               å¤æ³¨\nclassName   è¿ä¸ªç±»å¿é¡»å®ç° org.apache.catalina.Server æ¥å£ã           é»è®¤ org.apache.catalina.core.StandardServer\naddress     æå¡å¨ç­å¾å³æºå½ä»¤ç TCP / IP å°åãå¦ææ²¡ææå®å°åï¼åä½¿ç¨ localhostã   \nport        æå¡å¨ç­å¾å³æºå½ä»¤ç TCP / IP ç«¯å£å·ãè®¾ç½®ä¸º-1 ä»¥ç¦ç¨å³é­ç«¯å£ã           \nshutdown    å¿é¡»éè¿ TCP / IP è¿æ¥æ¥æ¶å°æå®ç«¯å£å·çå½ä»¤å­ç¬¦ä¸²ï¼ä»¥å³é­ Tomcatã       \n\n# 2.2.2. Service\n\n> Service åç´ è¡¨ç¤ºä¸ä¸ªæå¤ä¸ªè¿æ¥å¨ç»ä»¶çç»åï¼è¿äºç»ä»¶å±äº«ä¸ä¸ªç¨äºå¤çä¼ å¥è¯·æ±çå¼æç»ä»¶ãServer ä¸­å¯ä»¥æå¤ä¸ª Serviceã\n\nå±æ§è¡¨\n\nå±æ§          æè¿°                                      å¤æ³¨\nclassName   è¿ä¸ªç±»å¿é¡»å®ç°org.apache.catalina.Serviceæ¥å£ã   é»è®¤ org.apache.catalina.core.StandardService\nname        æ­¤æå¡çæ¾ç¤ºåç§°ï¼å¦ææ¨ä½¿ç¨æ å Catalina               \n            ç»ä»¶ï¼å°åå«å¨æ¥å¿æ¶æ¯ä¸­ãä¸ç¹å®æå¡å¨å³èçæ¯ä¸ªæå¡çåç§°å¿é¡»æ¯å¯ä¸çã\n\nå®ä¾ - conf/server.xml éç½®æä»¶ç¤ºä¾\n\n<?xml version="1.0" encoding="UTF-8"?>\n<Server port="8080" shutdown="SHUTDOWN">\n  <Service name="xxx">\n  ...\n  </Service>\n</Server>\n\n\n# 2.2.3. Executor\n\n> Executor è¡¨ç¤ºå¯ä»¥å¨ Tomcat ä¸­çç»ä»¶ä¹é´å±äº«ççº¿ç¨æ± ã\n\nå±æ§è¡¨\n\nå±æ§                æè¿°                                          å¤æ³¨\nclassName         è¿ä¸ªç±»å¿é¡»å®ç°org.apache.catalina.Executoræ¥å£ã      é»è®¤ org.apache.catalina.core.StandardThreadExecutor\nname              çº¿ç¨æ± åç§°ã                                      è¦æ±å¯ä¸, ä¾ Connector åç´ ç executor å±æ§ä½¿ç¨\nnamePrefix        çº¿ç¨åç§°åç¼ã                                     \nmaxThreads        æå¤§æ´»è·çº¿ç¨æ°ã                                    é»è®¤ 200\nminSpareThreads   æå°æ´»è·çº¿ç¨æ°ã                                    é»è®¤ 25\nmaxIdleTime       å½åæ´»è·çº¿ç¨å¤§äº minSpareThreads æ¶,ç©ºé²çº¿ç¨å³é­çç­å¾æå¤§æ¶é´ã   é»è®¤ 60000ms\nmaxQueueSize      çº¿ç¨æ± æ»¡æåµä¸çè¯·æ±æéå¤§å°ã                             é»è®¤ Integer.MAX_VALUE\n\n<Service name="xxx">\n  <Executor name="tomcatThreadPool" namePrefix="catalina-exec-" maxThreads="300" minSpareThreads="25"/>\n</Service>\n\n\n# 2.2.4. Connector\n\n> Connector ä»£è¡¨è¿æ¥ç»ä»¶ãTomcat æ¯æä¸ç§åè®®ï¼HTTP/1.1ãHTTP/2.0ãAJPã\n\nå±æ§è¡¨\n\nå±æ§                      è¯´æ                                                             å¤æ³¨\nasyncTimeout            Servlet3.0 è§èä¸­çå¼æ­¥è¯·æ±è¶æ¶                                          é»è®¤ 30s\nport                    è¯·æ±è¿æ¥ç TCP Port                                                 è®¾ç½®ä¸º 0,åä¼éæºéåä¸ä¸ªæªå ç¨çç«¯å£å·\nprotocol                åè®®. ä¸è¬æåµä¸è®¾ç½®ä¸º HTTP/1.1,è¿ç§æåµä¸è¿æ¥æ¨¡åä¼å¨ NIO å APR/native ä¸­èªå¨æ ¹æ®éç½®éæ©   \nURIEncoding             å¯¹ URI çç¼ç æ¹å¼.                                                   å¦æè®¾ç½®ç³»ç»åé org.apache.catalina.STRICT_SERVLET_COMPLIANCE ä¸º\n                                                                                       true,ä½¿ç¨ ISO-8859-1 ç¼ç ;å¦ææªè®¾ç½®æ­¤ç³»ç»åéä¸æªè®¾ç½®æ­¤å±æ§, ä½¿ç¨ UTF-8 ç¼ç \nuseBodyEncodingForURI   æ¯å¦éç¨æå®ç contentType èä¸æ¯ URIEncoding æ¥ç¼ç  URI ä¸­çè¯·æ±åæ°             \n\nä»¥ä¸å±æ§å¨æ åç Connector(NIO, NIO2 å APR/native)ä¸­ææ:\n\nå±æ§                  è¯´æ                                                  å¤æ³¨\nacceptCount         å½æå¤§è¯·æ±è¿æ¥ maxConnections æ»¡æ¶çæå¤§æéå¤§å°                    é»è®¤ 100,æ³¨ææ­¤å±æ§å Executor ä¸­å±æ§ maxQueueSize\n                                                                        çåºå«.è¿ä¸ªæçæ¯è¯·æ±è¿æ¥æ»¡æ¶çå æ å¤§å°,Executor ç maxQueueSize æçæ¯å¤ççº¿ç¨æ»¡æ¶çå æ å¤§å°\nconnectionTimeout   è¯·æ±è¿æ¥è¶æ¶                                              é»è®¤ 60000ms\nexecutor            æå®éç½®ççº¿ç¨æ± åç§°                                          \nkeepAliveTimeout    keeAlive è¶æ¶æ¶é´                                       é»è®¤å¼ä¸º connectionTimeout éç½®å¼.-1 è¡¨ç¤ºä¸è¶æ¶\nmaxConnections      æå¤§è¿æ¥æ°                                               è¿æ¥æ»¡æ¶åç»­è¿æ¥æ¾å¥æå¤§ä¸º acceptCount çéåä¸­. å¯¹ NIO å NIO2 è¿æ¥,é»è®¤å¼ä¸º 10000;å¯¹\n                                                                        APR/native,é»è®¤å¼ä¸º 8192\nmaxThreads          å¦ææå®äº Executor, æ­¤å±æ§å¿½ç¥;å¦åä¸º Connector åå»ºçåé¨çº¿ç¨æ± æå¤§å¼     é»è®¤ 200\nminSpareThreads     å¦ææå®äº Executor, æ­¤å±æ§å¿½ç¥;å¦åä¸º Connector åå»ºçº¿ç¨æ± çæå°æ´»è·çº¿ç¨æ°   é»è®¤ 10\nprocessorCache      åè®®å¤çå¨ç¼å­ Processor å¯¹è±¡çå¤§å°                             -1 è¡¨ç¤ºä¸éå¶.å½ä¸ä½¿ç¨ servlet3.0 çå¼æ­¥å¤çæåµä¸: å¦æéç½® Executor,éç½®ä¸º\n                                                                        Executor ç maxThreads;å¦åéç½®ä¸º Connnector ç maxThreads. å¦æä½¿ç¨\n                                                                        Serlvet3.0 å¼æ­¥å¤ç, å maxThreads å maxConnections çæå¤§å¼\n\n# 2.2.5. Context\n\n> Context åç´ è¡¨ç¤ºä¸ä¸ª Web åºç¨ç¨åºï¼å®å¨ç¹å®çèæä¸»æºä¸­è¿è¡ãæ¯ä¸ª Web åºç¨ç¨åºé½åºäº Web åºç¨ç¨åºå­æ¡£ï¼WARï¼æä»¶ï¼æèåå«ç¸åºçè§£ååå®¹çç¸åºç®å½ï¼å¦ Servlet è§èä¸­æè¿°ã\n\nå±æ§è¡¨\n\nå±æ§                           è¯´æ                                                          å¤æ³¨\naltDDName                    web.xml é¨ç½²æè¿°ç¬¦è·¯å¾                                             é»è®¤ /WEB-INF/web.xml\ndocBase                      Context ç Root è·¯å¾                                           å Host ç appBase ç¸ç»å, å¯ç¡®å® web åºç¨çå®éç®å½\nfailCtxIfServletStartFails   å Host ä¸­ç failCtxIfServletStartFails, åªå¯¹å½å Context ææ       é»è®¤ä¸º false\nlogEffectiveWebXml           æ¯å¦æ¥å¿æå° web.xml åå®¹(web.xml ç±é»è®¤ç web.xml ååºç¨ä¸­ç web.xml ç»æ)    é»è®¤ä¸º false\npath                         web åºç¨ç context path                                        å¦æä¸ºæ ¹è·¯å¾,åéç½®ä¸ºç©ºå­ç¬¦ä¸²(""), ä¸è½ä¸éç½®\nprivileged                   æ¯å¦ä½¿ç¨ Tomcat æä¾ç manager servlet                             \nreloadable                   /WEB-INF/classes/ å/WEB-INF/lib/ ç®å½ä¸­ class æä»¶åçååæ¯å¦èªå¨éæ°å è½½   é»è®¤ä¸º false\nswallowOutput                true æåµä¸, System.out å System.err è¾åºå°è¢«å®åå° web åºç¨æ¥å¿ä¸­         é»è®¤ä¸º false\n\n# 2.2.6. Engine\n\n> Engine åç´ è¡¨ç¤ºä¸ç¹å®ç Catalina æå¡ç¸å³èçæ´ä¸ªè¯·æ±å¤çæºå¨ãå®æ¥æ¶å¹¶å¤çæ¥èªä¸ä¸ªæå¤ä¸ªè¿æ¥å¨çææè¯·æ±ï¼å¹¶å°å®æçååºè¿åç»è¿æ¥å¨ï¼ä»¥ä¾¿æç»ä¼ è¾åå®¢æ·ç«¯ã\n\nå±æ§è¡¨\n\nå±æ§            æè¿°                                           å¤æ³¨\ndefaultHost   é»è®¤ä¸»æºåï¼ç¨äºæ è¯å°å¤çæåæ­¤æå¡å¨ä¸ä¸»æºåç§°ä½æªå¨æ­¤éç½®æä»¶ä¸­éç½®çè¯·æ±çä¸»æºã   è¿ä¸ªåå­å¿é¡»å¹éå¶ä¸­ä¸ä¸ªåµå¥çä¸»æºåç´ çåå­å±æ§ã\nname          æ­¤å¼æçé»è¾åç§°ï¼ç¨äºæ¥å¿åéè¯¯æ¶æ¯ã                          å¨åä¸æå¡å¨ä¸­ä½¿ç¨å¤ä¸ªæå¡åç´ æ¶ï¼æ¯ä¸ªå¼æå¿é¡»åéä¸ä¸ªå¯ä¸çåç§°ã\n\n# 2.2.7. Host\n\n> Host åç´ è¡¨ç¤ºä¸ä¸ªèæä¸»æºï¼å®æ¯ä¸ä¸ªæå¡å¨çç½ç»åç§°ï¼å¦âwww.mycompany.comâï¼ä¸è¿è¡ Tomcat çç¹å®æå¡å¨çå³èã\n\nå±æ§è¡¨\n\nå±æ§                           è¯´æ                                                         å¤æ³¨\nname                         åç§°                                                         ç¨äºæ¥å¿è¾åº\nappBase                      èæä¸»æºå¯¹åºçåºç¨åºç¡è·¯å¾                                              å¯ä»¥æ¯ä¸ªç»å¯¹è·¯å¾, æ${CATALINA_BASE}ç¸å¯¹è·¯å¾\nxmlBase                      èæä¸»æº XML åºç¡è·¯å¾,éé¢åºè¯¥æ Context xml éç½®æä»¶                       å¯ä»¥æ¯ä¸ªç»å¯¹è·¯å¾, æ${CATALINA_BASE}ç¸å¯¹è·¯å¾\ncreateDirs                   å½ appBase å xmlBase ä¸å­å¨æ¶,æ¯å¦åå»ºç®å½                            é»è®¤ä¸º true\nautoDeploy                   æ¯å¦å¨ææ§çæ£æ¥ appBase å xmlBase å¹¶ deploy web åºç¨å context æè¿°ç¬¦    é»è®¤ä¸º true\ndeployIgnore                 å¿½ç¥ deploy çæ­£å                                              \ndeployOnStartup              Tomcat å¯å¨æ¶æ¯å¦èªå¨ deploy                                      é»è®¤ä¸º true\nfailCtxIfServletStartFails   éç½®ä¸º true æåµä¸,ä»»ä½ load-on-startup >=0 ç servlet å¯å¨å¤±è´¥,åå¶å¯¹åºç   é»è®¤ä¸º false\n                             Contxt ä¹å¯å¨å¤±è´¥\n\n# 2.2.8. Cluster\n\nç±äºå¨å®éå¼åä¸­ï¼æä»æªç¨è¿ Tomcat éç¾¤éç½®ï¼æä»¥æ²¡ç ç©¶ã\n\n\n# 2.3. å¯å¨\n\n# 2.3.1. é¨ç½²æ¹å¼\n\nè¿ç§æ¹å¼è¦æ±æ¬å°å¿é¡»å®è£ Tomcat ã\n\nå°æåå¥½ç war åæ¾å¨ Tomcat å®è£ç®å½ä¸ç webapps ç®å½ä¸ï¼ç¶åå¨ bin ç®å½ä¸æ§è¡ startup.bat æ startup.sh ï¼Tomcat ä¼èªå¨è§£å webapps ç®å½ä¸ç war åã\n\næååï¼å¯ä»¥è®¿é® http://localhost:8080/xxx ï¼xxx æ¯ war åæä»¶åï¼ã\n\n> æ³¨æ\n> \n> ä»¥ä¸æ­¥éª¤æ¯æç®åçç¤ºä¾ãæ­¥éª¤ä¸­ç war åè§£åè·¯å¾ãå¯å¨ç«¯å£ä»¥åä¸äºæ´å¤çåè½é½å¯ä»¥ä¿®æ¹éç½®æä»¶æ¥å®å¶ ï¼ä¸»è¦æ¯ server.xml æ context.xml æä»¶ï¼ã\n\n# 2.3.2. åµå¥å¼\n\n# 2.3.2.1. API æ¹å¼\n\nå¨ pom.xml ä¸­æ·»å ä¾èµ\n\n<dependency>\n  <groupId>org.apache.tomcat.embed</groupId>\n  <artifactId>tomcat-embed-core</artifactId>\n  <version>8.5.24</version>\n</dependency>\n\n\næ·»å  SimpleEmbedTomcatServer.java æä»¶ï¼åå®¹å¦ä¸ï¼\n\nimport java.util.Optional;\nimport org.apache.catalina.startup.Tomcat;\n\npublic class SimpleTomcatServer {\n    private static final int PORT = 8080;\n    private static final String CONTEXT_PATH = "/javatool-server";\n\n    public static void main(String[] args) throws Exception {\n        // è®¾å® profile\n        Optional<String> profile = Optional.ofNullable(System.getProperty("spring.profiles.active"));\n        System.setProperty("spring.profiles.active", profile.orElse("develop"));\n\n        Tomcat tomcat = new Tomcat();\n        tomcat.setPort(PORT);\n        tomcat.getHost().setAppBase(".");\n        tomcat.addWebapp(CONTEXT_PATH, getAbsolutePath() + "src/main/webapp");\n        tomcat.start();\n        tomcat.getServer().await();\n    }\n\n    private static String getAbsolutePath() {\n        String path = null;\n        String folderPath = SimpleEmbedTomcatServer.class.getProtectionDomain().getCodeSource().getLocation().getPath()\n                .substring(1);\n        if (folderPath.indexOf("target") > 0) {\n            path = folderPath.substring(0, folderPath.indexOf("target"));\n        }\n        return path;\n    }\n}\n\n\næååï¼å¯ä»¥è®¿é® http://localhost:8080/javatool-server ã\n\n> è¯´æ\n> \n> æ¬ç¤ºä¾æ¯ä½¿ç¨ org.apache.tomcat.embed å¯å¨åµå¥å¼ Tomcat çæç®ç¤ºä¾ã\n> \n> è¿ä¸ªç¤ºä¾ä¸­ä½¿ç¨çæ¯ Tomcat é»è®¤çéç½®ï¼ä½éå¸¸ï¼æä»¬éè¦å¯¹ Tomcat éç½®è¿è¡ä¸äºå®å¶åè°ä¼ãä¸ºäºå è½½éç½®æä»¶ï¼å¯å¨ç±»å°±è¦ç¨å¾®åå¤æä¸äºãè¿éä¸æ³åè´´ä»£ç ï¼æå´è¶£çåå­¦å¯ä»¥åèï¼\n> \n> ç¤ºä¾é¡¹ç®\n\n# 2.3.2.2. ä½¿ç¨ maven æä»¶å¯å¨ï¼ä¸æ¨èï¼\n\nä¸æ¨èçç±ï¼è¿ç§æ¹å¼å¯å¨ maven è½ç¶æç®åï¼ä½æ¯æä¸ä¸ªå¾å¤§çé®é¢æ¯ï¼ççå¾ä¹å¾ä¹æ²¡åå¸æ°çæ¬äºï¼ææ°çæ¬åå¸æ¶é´ï¼2013-11-11ï¼ãä¸è²ä¼¼åªè½æ¾å° Tomcat6 ãTomcat7 æä»¶ã\n\nä½¿ç¨æ¹æ³\n\nå¨ pom.xml ä¸­å¼å¥æä»¶\n\n<plugin>\n  <groupId>org.apache.tomcat.maven</groupId>\n  <artifactId>tomcat7-maven-plugin</artifactId>\n  <version>2.2</version>\n  <configuration>\n    <port>8080</port>\n    <path>/${project.artifactId}</path>\n    <uriEncoding>UTF-8</uriEncoding>\n  </configuration>\n</plugin>\n\n\nè¿è¡ mvn tomcat7:run å½ä»¤ï¼å¯å¨ Tomcatã\n\næååï¼å¯ä»¥è®¿é® http://localhost:8080/xxx ï¼xxx æ¯ ${project.artifactId} æå®çé¡¹ç®åï¼ã\n\n# 2.3.3. IDE æä»¶\n\nå¸¸è§ Java IDE ä¸è¬é½æå¯¹ Tomcat çæ¯æã\n\nä»¥ Intellij IDEA ä¸ºä¾ï¼æä¾äº Tomcat and TomEE Integration æä»¶ï¼ä¸è¬é»è®¤ä¼å®è£ï¼ã\n\nä½¿ç¨æ­¥éª¤\n\n * ç¹å» Run/Debug Configurations > New Tomcat Server > local ï¼æå¼ Tomcat éç½®é¡µé¢ã\n * ç¹å» Confiure... æé®ï¼è®¾ç½® Tomcat å®è£è·¯å¾ã\n * ç¹å» Deployment æ ç­¾é¡µï¼è®¾ç½®è¦å¯å¨çåºç¨ã\n * è®¾ç½®å¯å¨åºç¨çç«¯å£ãJVM åæ°ãå¯å¨æµè§å¨ç­ã\n * æååï¼å¯ä»¥è®¿é® http://localhost:8080/ï¼å½ç¶ï¼ä½ ä¹å¯ä»¥å¨ url ä¸­è®¾ç½®ä¸ä¸æåç§°ï¼ã\n\n\n\n> è¯´æ\n> \n> ä¸ªäººè®¤ä¸ºè¿ä¸ªæä»¶ä¸å¦ Eclipse ç Tomcat æä»¶å¥½ç¨ï¼Eclipse ç Tomcat æä»¶æ¯æå¯¹ Tomcat xml éç½®æä»¶è¿è¡éç½®ãèè¿éï¼ä½ åªè½èªå·±å» Tomcat å®è£è·¯å¾ä¸ä¿®æ¹éç½®æä»¶ã\n\næä¸­çåµå¥å¼å¯å¨ç¤ºä¾å¯ä»¥åèæçç¤ºä¾é¡¹ç®\n\n\n# 3. Tomcat æ¶æ\n\n\n\nTomcat è¦å®ç° 2 ä¸ªæ ¸å¿åè½ï¼\n\n * å¤ç Socket è¿æ¥ï¼è´è´£ç½ç»å­èæµä¸ Request å Response å¯¹è±¡çè½¬åã\n * å è½½åç®¡ç Servletï¼ä»¥åå¤çå·ä½ç Request è¯·æ±ã\n\nä¸ºæ­¤ï¼Tomcat è®¾è®¡äºä¸¤ä¸ªæ ¸å¿ç»ä»¶ï¼\n\n * è¿æ¥å¨ï¼Connectorï¼ï¼è´è´£åå¤é¨éä¿¡\n * å®¹å¨ï¼Containerï¼ï¼è´è´£åé¨å¤ç\n\n\n# 3.1. Service\n\nTomcat æ¯æç I/O æ¨¡åæï¼\n\n * NIOï¼éé»å¡ I/Oï¼éç¨ Java NIO ç±»åºå®ç°ã\n * NIO2ï¼å¼æ­¥ I/Oï¼éç¨ JDK 7 ææ°ç NIO2 ç±»åºå®ç°ã\n * APRï¼éç¨ Apache å¯ç§»æ¤è¿è¡åºå®ç°ï¼æ¯ C/C++ ç¼åçæ¬å°åºã\n\nTomcat æ¯æçåºç¨å±åè®®æï¼\n\n * HTTP/1.1ï¼è¿æ¯å¤§é¨å Web åºç¨éç¨çè®¿é®åè®®ã\n * AJPï¼ç¨äºå Web æå¡å¨éæï¼å¦ Apacheï¼ã\n * HTTP/2ï¼HTTP 2.0 å¤§å¹åº¦çæåäº Web æ§è½ã\n\nTomcat æ¯æå¤ç§ I/O æ¨¡åååºç¨å±åè®®ãä¸ºäºå®ç°è¿ç¹ï¼ä¸ä¸ªå®¹å¨å¯è½å¯¹æ¥å¤ä¸ªè¿æ¥å¨ãä½æ¯ï¼åç¬çè¿æ¥å¨æå®¹å¨é½ä¸è½å¯¹å¤æä¾æå¡ï¼éè¦æå®ä»¬ç»è£èµ·æ¥æè½å·¥ä½ï¼ç»è£åè¿ä¸ªæ´ä½å«ä½ Service ç»ä»¶ãTomcat åå¯è½æå¤ä¸ª Serviceï¼éè¿å¨ Tomcat ä¸­éç½®å¤ä¸ª Serviceï¼å¯ä»¥å®ç°éè¿ä¸åçç«¯å£å·æ¥è®¿é®åä¸å°æºå¨ä¸é¨ç½²çä¸ååºç¨ã\n\n\n\nä¸ä¸ª Tomcat å®ä¾æä¸ä¸ªæå¤ä¸ª Serviceï¼ä¸ä¸ª Service æå¤ä¸ª Connector å ContainerãConnector å Container ä¹é´éè¿æ åç ServletRequest å ServletResponse éä¿¡ã\n\n\n# 3.2. è¿æ¥å¨\n\nè¿æ¥å¨å¯¹ Servlet å®¹å¨å±è½äºåè®®å I/O æ¨¡åç­çåºå«ï¼æ è®ºæ¯ HTTP è¿æ¯ AJPï¼å¨å®¹å¨ä¸­è·åå°çé½æ¯ä¸ä¸ªæ åç ServletRequest å¯¹è±¡ã\n\nè¿æ¥å¨çä¸»è¦åè½æ¯ï¼\n\n * ç½ç»éä¿¡\n * åºç¨å±åè®®è§£æ\n * Tomcat Request/Response ä¸ ServletRequest/ServletResponse çè½¬å\n\nTomcat è®¾è®¡äº 3 ä¸ªç»ä»¶æ¥å®ç°è¿ 3 ä¸ªåè½ï¼åå«æ¯ EndPointãProcessor å Adapterã\n\n\n\nç»ä»¶é´éè¿æ½è±¡æ¥å£äº¤äºãè¿æ ·åè¿æä¸ä¸ªå¥½å¤æ¯**å°è£ååã**è¿æ¯é¢åå¯¹è±¡è®¾è®¡çç²¾é«ï¼å°ç³»ç»ä¸­ç»å¸¸ååçé¨ååç¨³å®çé¨åéç¦»ï¼æå©äºå¢å å¤ç¨æ§ï¼å¹¶éä½ç³»ç»è¦ååº¦ãç½ç»éä¿¡ç I/O æ¨¡åæ¯ååçï¼å¯è½æ¯éé»å¡ I/Oãå¼æ­¥ I/O æè APRãåºç¨å±åè®®ä¹æ¯ååçï¼å¯è½æ¯ HTTPãHTTPSãAJPãæµè§å¨ç«¯åéçè¯·æ±ä¿¡æ¯ä¹æ¯ååçãä½æ¯æ´ä½çå¤çé»è¾æ¯ä¸åçï¼EndPoint è´è´£æä¾å­èæµç» Processorï¼Processor è´è´£æä¾ Tomcat Request å¯¹è±¡ç» Adapterï¼Adapter è´è´£æä¾ ServletRequest å¯¹è±¡ç»å®¹å¨ã\n\nå¦æè¦æ¯ææ°ç I/O æ¹æ¡ãæ°çåºç¨å±åè®®ï¼åªéè¦å®ç°ç¸å³çå·ä½å­ç±»ï¼ä¸å±éç¨çå¤çé»è¾æ¯ä¸åçãç±äº I/O æ¨¡åååºç¨å±åè®®å¯ä»¥èªç±ç»åï¼æ¯å¦ NIO + HTTP æè NIO2 + AJPãTomcat çè®¾è®¡èå°ç½ç»éä¿¡ååºç¨å±åè®®è§£ææ¾å¨ä¸èµ·èèï¼è®¾è®¡äºä¸ä¸ªå« ProtocolHandler çæ¥å£æ¥å°è£è¿ä¸¤ç§ååç¹ãåç§åè®®åéä¿¡æ¨¡åçç»åæç¸åºçå·ä½å®ç°ç±»ãæ¯å¦ï¼Http11NioProtocol å AjpNioProtocolã\n\n\n\n# 3.2.1. ProtocolHandler ç»ä»¶\n\nè¿æ¥å¨ç¨ ProtocolHandler æ¥å£æ¥å°è£éä¿¡åè®®å I/O æ¨¡åçå·®å¼ãProtocolHandler åé¨ååä¸º EndPoint å Processor æ¨¡åï¼EndPoint è´è´£åºå± Socket éä¿¡ï¼Proccesor è´è´£åºç¨å±åè®®è§£æã\n\n# 3.2.1.1. EndPoint\n\nEndPoint æ¯éä¿¡ç«¯ç¹ï¼å³éä¿¡çå¬çæ¥å£ï¼æ¯å·ä½ç Socket æ¥æ¶ååéå¤çå¨ï¼æ¯å¯¹ä¼ è¾å±çæ½è±¡ï¼å æ­¤ EndPoint æ¯ç¨æ¥å®ç° TCP/IP åè®®çã\n\nEndPoint æ¯ä¸ä¸ªæ¥å£ï¼å¯¹åºçæ½è±¡å®ç°ç±»æ¯ AbstractEndpointï¼è AbstractEndpoint çå·ä½å­ç±»ï¼æ¯å¦å¨ NioEndpoint å Nio2Endpoint ä¸­ï¼æä¸¤ä¸ªéè¦çå­ç»ä»¶ï¼Acceptor å SocketProcessorã\n\nå¶ä¸­ Acceptor ç¨äºçå¬ Socket è¿æ¥è¯·æ±ãSocketProcessor ç¨äºå¤çæ¥æ¶å°ç Socket è¯·æ±ï¼å®å®ç° Runnable æ¥å£ï¼å¨ Run æ¹æ³éè°ç¨åè®®å¤çç»ä»¶ Processor è¿è¡å¤çãä¸ºäºæé«å¤çè½åï¼SocketProcessor è¢«æäº¤å°çº¿ç¨æ± æ¥æ§è¡ãèè¿ä¸ªçº¿ç¨æ± å«ä½æ§è¡å¨ï¼Executor)ã\n\n# 3.2.1.2. Processor\n\nå¦æè¯´ EndPoint æ¯ç¨æ¥å®ç° TCP/IP åè®®çï¼é£ä¹ Processor ç¨æ¥å®ç° HTTP åè®®ï¼Processor æ¥æ¶æ¥èª EndPoint ç Socketï¼è¯»åå­èæµè§£ææ Tomcat Request å Response å¯¹è±¡ï¼å¹¶éè¿ Adapter å°å¶æäº¤å°å®¹å¨å¤çï¼Processor æ¯å¯¹åºç¨å±åè®®çæ½è±¡ã\n\nProcessor æ¯ä¸ä¸ªæ¥å£ï¼å®ä¹äºè¯·æ±çå¤çç­æ¹æ³ãå®çæ½è±¡å®ç°ç±» AbstractProcessor å¯¹ä¸äºåè®®å±æçå±æ§è¿è¡å°è£ï¼æ²¡æå¯¹æ¹æ³è¿è¡å®ç°ãå·ä½çå®ç°æ AJPProcessorãHTTP11Processor ç­ï¼è¿äºå·ä½å®ç°ç±»å®ç°äºç¹å®åè®®çè§£ææ¹æ³åè¯·æ±å¤çæ¹å¼ã\n\n\n\nä»å¾ä¸­æä»¬çå°ï¼EndPoint æ¥æ¶å° Socket è¿æ¥åï¼çæä¸ä¸ª SocketProcessor ä»»å¡æäº¤å°çº¿ç¨æ± å»å¤çï¼SocketProcessor ç Run æ¹æ³ä¼è°ç¨ Processor ç»ä»¶å»è§£æåºç¨å±åè®®ï¼Processor éè¿è§£æçæ Request å¯¹è±¡åï¼ä¼è°ç¨ Adapter ç Service æ¹æ³ã\n\n# 3.2.2. Adapter\n\nè¿æ¥å¨éè¿ééå¨ Adapter è°ç¨å®¹å¨ã\n\nç±äºåè®®ä¸åï¼å®¢æ·ç«¯åè¿æ¥çè¯·æ±ä¿¡æ¯ä¹ä¸å°½ç¸åï¼Tomcat å®ä¹äºèªå·±ç Request ç±»æ¥ééè¿äºè¯·æ±ä¿¡æ¯ã\n\nProtocolHandler æ¥å£è´è´£è§£æè¯·æ±å¹¶çæ Tomcat Request ç±»ãä½æ¯è¿ä¸ª Request å¯¹è±¡ä¸æ¯æ åç ServletRequestï¼ä¹å°±æå³çï¼ä¸è½ç¨ Tomcat Request ä½ä¸ºåæ°æ¥è°ç¨å®¹å¨ãTomcat çè§£å³æ¹æ¡æ¯å¼å¥ CoyoteAdapterï¼è¿æ¯ééå¨æ¨¡å¼çç»å¸è¿ç¨ï¼è¿æ¥å¨è°ç¨ CoyoteAdapter ç Sevice æ¹æ³ï¼ä¼ å¥çæ¯ Tomcat Request å¯¹è±¡ï¼CoyoteAdapter è´è´£å° Tomcat Request è½¬æ ServletRequestï¼åè°ç¨å®¹å¨ç Service æ¹æ³ã\n\n\n# 3.3. å®¹å¨\n\nTomcat è®¾è®¡äº 4 ç§å®¹å¨ï¼åå«æ¯ EngineãHostãContext å Wrapperã\n\n * Engine - Servlet çé¡¶å±å®¹å¨ï¼åå«ä¸ ä¸ªæå¤ä¸ª Host å­å®¹å¨ï¼\n * Host - èæä¸»æºï¼è´è´£ web åºç¨çé¨ç½²å Context çåå»ºï¼\n * Context - Web åºç¨ä¸ä¸æï¼åå«å¤ä¸ª Wrapperï¼è´è´£ web éç½®çè§£æãç®¡çææç Web èµæºï¼\n * Wrapper - æåºå±çå®¹å¨ï¼æ¯å¯¹ Servlet çå°è£ï¼è´è´£ Servlet å®ä¾çå å»ºãæ§è¡åéæ¯ã\n\n# 3.3.1. è¯·æ±åå Servlet è¿ç¨\n\nTomcat æ¯æä¹ç¡®å®è¯·æ±æ¯ç±åªä¸ª Wrapper å®¹å¨éç Servlet æ¥å¤ççå¢ï¼ç­æ¡æ¯ï¼Tomcat æ¯ç¨ Mapper ç»ä»¶æ¥å®æè¿ä¸ªä»»å¡çã\n\nä¸¾ä¾æ¥è¯´ï¼åå¦æä¸ä¸ªç½è´­ç³»ç»ï¼æé¢åç½ç«ç®¡çäººåçåå°ç®¡çç³»ç»ï¼è¿æé¢åç»ç«¯å®¢æ·çå¨çº¿è´­ç©ç³»ç»ãè¿ä¸¤ä¸ªç³»ç»è·å¨åä¸ä¸ª Tomcat ä¸ï¼ä¸ºäºéç¦»å®ä»¬çè®¿é®ååï¼éç½®äºä¸¤ä¸ªèæååï¼manage.shopping.comåuser.shopping.comï¼ç½ç«ç®¡çäººåéè¿manage.shopping.comååè®¿é® Tomcat å»ç®¡çç¨æ·åååï¼èç¨æ·ç®¡çåååç®¡çæ¯ä¸¤ä¸ªåç¬ç Web åºç¨ãç»ç«¯å®¢æ·éè¿user.shopping.comååå»æç´¢åååä¸è®¢åï¼æç´¢åè½åè®¢åç®¡çä¹æ¯ä¸¤ä¸ªç¬ç«ç Web åºç¨ãå¦ä¸æç¤ºï¼æ¼ç¤ºäº url åºå£° Servlet çå¤çæµç¨ã\n\n\n\nåå¦æç¨æ·è®¿é®ä¸ä¸ª URLï¼æ¯å¦å¾ä¸­çhttp://user.shopping.com:8080/order/buyï¼Tomcat å¦ä½å°è¿ä¸ª URL å®ä½å°ä¸ä¸ª Servlet å¢ï¼\n\n 1. é¦åï¼æ ¹æ®åè®®åç«¯å£å·éå® Service å Engineã\n 2. ç¶åï¼æ ¹æ®ååéå® Hostã\n 3. ä¹åï¼æ ¹æ® URL è·¯å¾æ¾å° Context ç»ä»¶ã\n 4. æåï¼æ ¹æ® URL è·¯å¾æ¾å° Wrapperï¼Servletï¼ã\n\nè¿ä¸ªè·¯ç±ååè¿ç¨å·ä½æ¯æä¹å®ç°çå¢ï¼ç­æ¡æ¯ä½¿ç¨ Pipeline-Valve ç®¡éã\n\n# 3.3.2. Pipeline-Value\n\nPipeline å¯ä»¥çè§£ä¸ºç°å®ä¸­çç®¡éï¼Valve ä¸ºç®¡éä¸­çéé¨ï¼Request å Response å¯¹è±¡å¨ç®¡éä¸­ç»è¿åä¸ªéé¨çå¤çåæ§å¶ã\n\nPipeline-Valve æ¯è´£ä»»é¾æ¨¡å¼ï¼è´£ä»»é¾æ¨¡å¼æ¯æå¨ä¸ä¸ªè¯·æ±å¤ççè¿ç¨ä¸­æå¾å¤å¤çèä¾æ¬¡å¯¹è¯·æ±è¿è¡å¤çï¼æ¯ä¸ªå¤çèè´è´£åèªå·±ç¸åºçå¤çï¼å¤çå®ä¹åå°åè°ç¨ä¸ä¸ä¸ªå¤çèç»§ç»­å¤çãValve è¡¨ç¤ºä¸ä¸ªå¤çç¹ï¼æ¯å¦æéè®¤è¯åè®°å½æ¥å¿ã\n\nåæ¥äºè§£ä¸ä¸ Valve å Pipeline æ¥å£çè®¾è®¡ï¼\n\n\n\n * æ¯ä¸ä¸ªå®¹å¨é½æä¸ä¸ª Pipeline å¯¹è±¡ï¼åªè¦è§¦åè¿ä¸ª Pipeline çç¬¬ä¸ä¸ª Valveï¼è¿ä¸ªå®¹å¨é Pipeline ä¸­ç Valve å°±é½ä¼è¢«è°ç¨å°ãä½æ¯ï¼ä¸åå®¹å¨ç Pipeline æ¯æä¹é¾å¼è§¦åçå¢ï¼æ¯å¦ Engine ä¸­ Pipeline éè¦è°ç¨ä¸å±å®¹å¨ Host ä¸­ç Pipelineã\n * è¿æ¯å ä¸º Pipeline ä¸­è¿æä¸ª getBasic æ¹æ³ãè¿ä¸ª BasicValve å¤äº Valve é¾è¡¨çæ«ç«¯ï¼å®æ¯ Pipeline ä¸­å¿ä¸å¯å°çä¸ä¸ª Valveï¼è´è´£è°ç¨ä¸å±å®¹å¨ç Pipeline éçç¬¬ä¸ä¸ª Valveã\n * Pipeline ä¸­æ addValve æ¹æ³ãPipeline ä¸­ç»´æ¤äº Valve é¾è¡¨ï¼Valve å¯ä»¥æå¥å° Pipeline ä¸­ï¼å¯¹è¯·æ±åæäºå¤çãæä»¬è¿åç° Pipeline ä¸­æ²¡æ invoke æ¹æ³ï¼å ä¸ºæ´ä¸ªè°ç¨é¾çè§¦åæ¯ Valve æ¥å®æçï¼Valve å®æèªå·±çå¤çåï¼è°ç¨ getNext.invoke() æ¥è§¦åä¸ä¸ä¸ª Valve è°ç¨ã\n * Valve ä¸­ä¸»è¦çä¸ä¸ªæ¹æ³ï¼setNextãgetNextãinvokeãValve ä¹é´çå³ç³»æ¯ååé¾å¼ç»æï¼æ¬èº« invoke æ¹æ³ä¸­ä¼è°ç¨ä¸ä¸ä¸ª Valve ç invoke æ¹æ³ã\n * åå±å®¹å¨å¯¹åºç basic valve åå«æ¯ StandardEngineValveãStandardHostValveã StandardContextValveãStandardWrapperValveã\n * ç±äº Valve æ¯ä¸ä¸ªå¤çç¹ï¼å æ­¤ invoke æ¹æ³å°±æ¯æ¥å¤çè¯·æ±çãæ³¨æå° Valve ä¸­æ getNext å setNext æ¹æ³ï¼å æ­¤æä»¬å¤§æ¦å¯ä»¥çå°æä¸ä¸ªé¾è¡¨å° Valve é¾èµ·æ¥äºã\n\n\n\næ´ä¸ªè°ç¨è¿ç¨ç±è¿æ¥å¨ä¸­ç Adapter è§¦åçï¼å®ä¼è°ç¨ Engine çç¬¬ä¸ä¸ª Valveï¼\n\nconnector.getService().getContainer().getPipeline().getFirst().invoke(request, response);\n\n\n\n# 4. Tomcat çå½å¨æ\n\n\n# 4.1. Tomcat çå¯å¨è¿ç¨\n\n\n\n 1. Tomcat æ¯ä¸ä¸ª Java ç¨åºï¼å®çè¿è¡ä»æ§è¡ startup.sh èæ¬å¼å§ãstartup.sh ä¼å¯å¨ä¸ä¸ª JVM æ¥è¿è¡ Tomcat çå¯å¨ç±» Bootstrapã\n 2. Bootstrap ä¼åå§å Tomcat çç±»å è½½å¨å¹¶å®ä¾å Catalinaã\n 3. Catalina ä¼éè¿ Digester è§£æ server.xmlï¼æ ¹æ®å¶ä¸­çéç½®ä¿¡æ¯æ¥åå»ºç¸åºç»ä»¶ï¼å¹¶è°ç¨ Server ç start æ¹æ³ã\n 4. Server è´è´£ç®¡ç Service ç»ä»¶ï¼å®ä¼è°ç¨ Service ç start æ¹æ³ã\n 5. Service è´è´£ç®¡ç Connector åé¡¶å±å®¹å¨ Engineï¼å®ä¼è°ç¨ Connector å Engine ç start æ¹æ³ã\n\n# 4.1.1. Catalina ç»ä»¶\n\nCatalina çèè´£å°±æ¯è§£æ server.xml éç½®ï¼å¹¶æ®æ­¤å®ä¾å Serverãæ¥ä¸æ¥ï¼è°ç¨ Server ç»ä»¶ç init æ¹æ³å start æ¹æ³ï¼å° Tomcat å¯å¨èµ·æ¥ã\n\nCatalina è¿éè¦å¤çåç§âå¼å¸¸âæåµï¼æ¯å¦å½æä»¬éè¿âCtrl + Câå³é­ Tomcat æ¶ï¼Tomcat å°å¦ä½ä¼éçåæ­¢å¹¶ä¸æ¸çèµæºå¢ï¼å æ­¤ Catalina å¨ JVM ä¸­æ³¨åä¸ä¸ªâå³é­é©å­âã\n\npublic void start() {\n    //1. å¦æææç Server å®ä¾ä¸ºç©ºï¼å°±è§£æ server.xml åå»ºåºæ¥\n    if (getServer() == null) {\n        load();\n    }\n\n    //2. å¦æåå»ºå¤±è´¥ï¼æ¥ééåº\n    if (getServer() == null) {\n        log.fatal(sm.getString("catalina.noServer"));\n        return;\n    }\n\n    //3. å¯å¨ Server\n    try {\n        getServer().start();\n    } catch (LifecycleException e) {\n        return;\n    }\n\n    // åå»ºå¹¶æ³¨åå³é­é©å­\n    if (useShutdownHook) {\n        if (shutdownHook == null) {\n            shutdownHook = new CatalinaShutdownHook();\n        }\n        Runtime.getRuntime().addShutdownHook(shutdownHook);\n    }\n\n    // ç¨ await æ¹æ³çå¬åæ­¢è¯·æ±\n    if (await) {\n        await();\n        stop();\n    }\n}\n\n\nä¸ºä»ä¹éè¦å³é­é©å­ï¼\n\nå¦ææä»¬éè¦å¨ JVM å³é­æ¶åä¸äºæ¸çå·¥ä½ï¼æ¯å¦å°ç¼å­æ°æ®å·å°ç£çä¸ï¼æèæ¸çä¸äºä¸´æ¶æä»¶ï¼å¯ä»¥å JVM æ³¨åä¸ä¸ªâå³é­é©å­âãâå³é­é©å­âå¶å®å°±æ¯ä¸ä¸ªçº¿ç¨ï¼JVM å¨åæ­¢ä¹åä¼å°è¯æ§è¡è¿ä¸ªçº¿ç¨ç run æ¹æ³ã\n\nTomcat çâå³é­é©å­âââ CatalinaShutdownHook åäºäºä»ä¹å¢ï¼\n\nprotected class CatalinaShutdownHook extends Thread {\n\n    @Override\n    public void run() {\n        try {\n            if (getServer() != null) {\n                Catalina.this.stop();\n            }\n        } catch (Throwable ex) {\n           ...\n        }\n    }\n}\n\n\nTomcat çâå³é­é©å­âå®éä¸å°±æ§è¡äº Server ç stop æ¹æ³ï¼Server ç stop æ¹æ³ä¼éæ¾åæ¸çææçèµæºã\n\n# 4.1.2. Server ç»ä»¶\n\nServer ç»ä»¶çå·ä½å®ç°ç±»æ¯ StandardServerï¼Server ç»§æ¿äº LifeCycleBaseï¼å®ççå½å¨æè¢«ç»ä¸ç®¡çï¼å¹¶ä¸å®çå­ç»ä»¶æ¯ Serviceï¼å æ­¤å®è¿éè¦ç®¡ç Service ççå½å¨æï¼ä¹å°±æ¯è¯´å¨å¯å¨æ¶è°ç¨ Service ç»ä»¶çå¯å¨æ¹æ³ï¼å¨åæ­¢æ¶è°ç¨å®ä»¬çåæ­¢æ¹æ³ãServer å¨åé¨ç»´æ¤äºè¥å¹² Service ç»ä»¶ï¼å®æ¯ä»¥æ°ç»æ¥ä¿å­çã\n\n@Override\npublic void addService(Service service) {\n\n    service.setServer(this);\n\n    synchronized (servicesLock) {\n        // åå»ºä¸ä¸ªé¿åº¦ +1 çæ°æ°ç»\n        Service results[] = new Service[services.length + 1];\n\n        // å°èçæ°æ®å¤å¶è¿å»\n        System.arraycopy(services, 0, results, 0, services.length);\n        results[services.length] = service;\n        services = results;\n\n        // å¯å¨ Service ç»ä»¶\n        if (getState().isAvailable()) {\n            try {\n                service.start();\n            } catch (LifecycleException e) {\n                // Ignore\n            }\n        }\n\n        // è§¦åçå¬äºä»¶\n        support.firePropertyChange("service", null, service);\n    }\n\n}\n\n\nServer å¹¶æ²¡æä¸å¼å§å°±åéä¸ä¸ªå¾é¿çæ°ç»ï¼èæ¯å¨æ·»å çè¿ç¨ä¸­å¨æå°æ©å±æ°ç»é¿åº¦ï¼å½æ·»å ä¸ä¸ªæ°ç Service å®ä¾æ¶ï¼ä¼åå»ºä¸ä¸ªæ°æ°ç»å¹¶æåæ¥æ°ç»åå®¹å¤å¶å°æ°æ°ç»ï¼è¿æ ·åçç®çå¶å®æ¯ä¸ºäºèçåå­ç©ºé´ã\n\né¤æ­¤ä¹å¤ï¼Server ç»ä»¶è¿æä¸ä¸ªéè¦çä»»å¡æ¯å¯å¨ä¸ä¸ª Socket æ¥çå¬åæ­¢ç«¯å£ï¼è¿å°±æ¯ä¸ºä»ä¹ä½ è½éè¿ shutdown å½ä»¤æ¥å³é­ Tomcatãä¸ç¥éä½ çæå°æ²¡æï¼ä¸é¢ Caralina çå¯å¨æ¹æ³çæåä¸è¡ä»£ç å°±æ¯è°ç¨äº Server ç await æ¹æ³ã\n\nå¨ await æ¹æ³éä¼åå»ºä¸ä¸ª Socket çå¬ 8005 ç«¯å£ï¼å¹¶å¨ä¸ä¸ªæ­»å¾ªç¯éæ¥æ¶ Socket ä¸çè¿æ¥è¯·æ±ï¼å¦æææ°çè¿æ¥å°æ¥å°±å»ºç«è¿æ¥ï¼ç¶åä» Socket ä¸­è¯»åæ°æ®ï¼å¦æè¯»å°çæ°æ®æ¯åæ­¢å½ä»¤âSHUTDOWNâï¼å°±éåºå¾ªç¯ï¼è¿å¥ stop æµç¨ã\n\n# 4.1.3. Service ç»ä»¶\n\nService ç»ä»¶çå·ä½å®ç°ç±»æ¯ StandardServiceã\n\nãæºç ãStandardService æºç å®ä¹\n\npublic class StandardService extends LifecycleBase implements Service {\n    // åå­\n    private String name = null;\n\n    //Server å®ä¾\n    private Server server = null;\n\n    // è¿æ¥å¨æ°ç»\n    protected Connector connectors[] = new Connector[0];\n    private final Object connectorsLock = new Object();\n\n    // å¯¹åºç Engine å®¹å¨\n    private Engine engine = null;\n\n    // æ å°å¨åå¶çå¬å¨\n    protected final Mapper mapper = new Mapper();\n    protected final MapperListener mapperListener = new MapperListener(this);\n\n\t// ...\n}\n\n\nStandardService ç»§æ¿äº LifecycleBase æ½è±¡ç±»ã\n\nStandardService ç»´æ¤äºä¸ä¸ª MapperListener ç¨äºæ¯æ Tomcat ç­é¨ç½²ãå½ Web åºç¨çé¨ç½²åçååæ¶ï¼Mapper ä¸­çæ å°ä¿¡æ¯ä¹è¦è·çååï¼MapperListener å°±æ¯ä¸ä¸ªçå¬å¨ï¼å®çå¬å®¹å¨çååï¼å¹¶æä¿¡æ¯æ´æ°å° Mapper ä¸­ï¼è¿æ¯å¸åçè§å¯èæ¨¡å¼ã\n\nä½ä¸ºâç®¡çâè§è²çç»ä»¶ï¼æéè¦çæ¯ç»´æ¤å¶ä»ç»ä»¶ççå½å¨æãæ­¤å¤å¨å¯å¨åç§ç»ä»¶æ¶ï¼è¦æ³¨æå®ä»¬çä¾èµå³ç³»ï¼ä¹å°±æ¯è¯´ï¼è¦æ³¨æå¯å¨çé¡ºåºã\n\nprotected void startInternal() throws LifecycleException {\n\n    //1. è§¦åå¯å¨çå¬å¨\n    setState(LifecycleState.STARTING);\n\n    //2. åå¯å¨ Engineï¼Engine ä¼å¯å¨å®å­å®¹å¨\n    if (engine != null) {\n        synchronized (engine) {\n            engine.start();\n        }\n    }\n\n    //3. åå¯å¨ Mapper çå¬å¨\n    mapperListener.start();\n\n    //4. æåå¯å¨è¿æ¥å¨ï¼è¿æ¥å¨ä¼å¯å¨å®å­ç»ä»¶ï¼æ¯å¦ Endpoint\n    synchronized (connectorsLock) {\n        for (Connector connector: connectors) {\n            if (connector.getState() != LifecycleState.FAILED) {\n                connector.start();\n            }\n        }\n    }\n}\n\n\nä»å¯å¨æ¹æ³å¯ä»¥çå°ï¼Service åå¯å¨äº Engine ç»ä»¶ï¼åå¯å¨ Mapper çå¬å¨ï¼æåææ¯å¯å¨è¿æ¥å¨ãè¿å¾å¥½çè§£ï¼å ä¸ºåå±ç»ä»¶å¯å¨å¥½äºæè½å¯¹å¤æä¾æå¡ï¼æè½å¯å¨å¤å±çè¿æ¥å¨ç»ä»¶ãè Mapper ä¹ä¾èµå®¹å¨ç»ä»¶ï¼å®¹å¨ç»ä»¶å¯å¨å¥½äºæè½çå¬å®ä»¬çååï¼å æ­¤ Mapper å MapperListener å¨å®¹å¨ç»ä»¶ä¹åå¯å¨ãç»ä»¶åæ­¢çé¡ºåºè·å¯å¨é¡ºåºæ­£å¥½ç¸åçï¼ä¹æ¯åºäºå®ä»¬çä¾èµå³ç³»ã\n\n# 4.1.4. Engine ç»ä»¶\n\nEngine æ¬è´¨æ¯ä¸ä¸ªå®¹å¨ï¼å æ­¤å®ç»§æ¿äº ContainerBase åºç±»ï¼å¹¶ä¸å®ç°äº Engine æ¥å£ã\n\n\n# 4.2. Web åºç¨çé¨ç½²æ¹å¼\n\næ³¨ï¼catalina.homeï¼å®è£ç®å½;catalina.baseï¼å·¥ä½ç®å½;é»è®¤å¼ user.dir\n\n * Server.xml éç½® Host åç´ ï¼æå® appBase å±æ§ï¼é»è®¤$catalina.base/webapps/\n * Server.xml éç½® Context åç´ ï¼æå® docBaseï¼åç´ ï¼æå® web åºç¨çè·¯å¾\n * èªå®ä¹éç½®ï¼å¨$catalina.base/EngineName/HostName/XXX.xml éç½® Context åç´ \n\nHostConfig çå¬äº StandardHost å®¹å¨çäºä»¶ï¼å¨ start æ¹æ³ä¸­è§£æä¸è¿°éç½®æä»¶ï¼\n\n * æ«æ appbase è·¯å¾ä¸çæææä»¶å¤¹å war åï¼è§£æåä¸ªåºç¨ç META-INF/context.xmlï¼å¹¶ åå»º StandardContextï¼å¹¶å° Context å å¥å° Host çå­å®¹å¨ä¸­ã\n * è§£æ$catalina.base/EngineName/HostName/ä¸çææ Context éç½®ï¼æ¾å°ç¸åº web åº ç¨çä½ç½®ï¼è§£æåä¸ªåºç¨ç META-INF/context.xmlï¼å¹¶åå»º StandardContextï¼å¹¶å° Context å å¥å° Host çå­å®¹å¨ä¸­ã\n\næ³¨ï¼\n\n * HostConfig å¹¶æ²¡æå®éè§£æ Context.xmlï¼èæ¯å¨ ContextConfig ä¸­è¿è¡çã\n * HostConfig ä¸­ä¼å®ææ£æ¥ watched èµæºæä»¶(context.xml éç½®æä»¶)\n\nContextConfig è§£æ context.xml é¡ºåºï¼\n\n * åè§£æå¨å±çéç½® config/context.xml\n * ç¶åè§£æ Host çé»è®¤éç½® EngineName/HostName/context.xml.default\n * æåè§£æåºç¨ç META-INF/context.xml\n\nContextConfig è§£æ web.xml é¡ºåºï¼\n\n * åè§£æå¨å±çéç½® config/web.xml\n * ç¶åè§£æ Host çé»è®¤éç½® EngineName/HostName/web.xml.default æ¥çè§£æåºç¨ç MEB-INF/web.xml\n * æ«æåºç¨ WEB-INF/lib/ä¸ç jar æä»¶ï¼è§£æå¶ä¸­ç META-INF/web-fragment.xml æååå¹¶ xml å°è£æ WebXmlï¼å¹¶è®¾ç½® Context\n\næ³¨ï¼\n\n * æ«æ web åºç¨å jar ä¸­çæ³¨è§£(FilterãListenerãServlet)å°±æ¯ä¸è¿°æ­¥éª¤ä¸­è¿è¡çã\n * å®¹å¨çå®ææ§è¡ï¼backgroundProcessï¼ç± ContainerBase æ¥å®ç°çï¼å¹¶ä¸åªæå¨é¡¶å±å®¹å¨ ä¸­æä¼å¼å¯çº¿ç¨ã(backgroundProcessorDelay=10 æ å¿ä½æ¥æ§å¶)\n\n\n# 4.3. LifeCycle\n\n\n\n# 4.3.1. è¯·æ±å¤çè¿ç¨\n\n\n 1. æ ¹æ® server.xml éç½®çæå®ç connector ä»¥åç«¯å£çå¬ httpãæè ajp è¯·æ±\n 2. è¯·æ±å°æ¥æ¶å»ºç«è¿æ¥,è§£æè¯·æ±åæ°,åå»º Request å Response å¯¹è±¡,è°ç¨é¡¶å±å®¹å¨ pipeline ç invoke æ¹æ³\n 3. å®¹å¨ä¹é´å±å±è°ç¨,æç»è°ç¨ä¸å¡ servlet ç service æ¹æ³\n 4. Connector å° response æµä¸­çæ°æ®åå° socket ä¸­\n\n\n# 4.4. Connector æµç¨\n\n\n\n# 4.4.1. é»å¡ IO\n\n\n\n# 4.4.2. éé»å¡ IO\n\n\n\n# 4.4.3. IO å¤è·¯å¤ç¨\n\n\n\né»å¡ä¸éé»å¡çåºå«å¨äºè¿è¡è¯»æä½ååæä½çç³»ç»è°ç¨æ¶ï¼å¦ææ­¤æ¶åæ ¸ææ²¡ææ°æ®å¯è¯»æèæ²¡æç¼å²ç©ºé´å¯åæ¶ï¼æ¯å¦é»å¡ã\n\nIO å¤è·¯å¤ç¨çå¥½å¤å¨äºå¯åæ¶çå¬å¤ä¸ª socket çå¯è¯»åå¯åäºä»¶ï¼è¿æ ·å°±è½ä½¿å¾åºç¨å¯ä»¥åæ¶çå¬å¤ä¸ª socketï¼éæ¾äºåºç¨çº¿ç¨èµæºã\n\n# 4.4.4. Tomcat åç±» Connector å¯¹æ¯\n\n\n * JIOï¼ç¨ java.io ç¼åç TCP æ¨¡åï¼é»å¡ IO\n * NIOï¼ç¨ java.nio ç¼åç TCP æ¨¡åï¼éé»å¡ IOï¼ï¼IO å¤è·¯å¤ç¨ï¼\n * APRï¼å¨ç§° Apache Portable Runtimeï¼ä½¿ç¨ JNI çæ¹å¼æ¥è¿è¡è¯»åæä»¶ä»¥åè¿è¡ç½ç»ä¼ è¾\n\nApache Portable Runtime æ¯ä¸ä¸ªé«åº¦å¯ç§»æ¤çåºï¼å®æ¯ Apache HTTP Server 2.x çæ ¸å¿ã APR å·æè®¸å¤ç¨éï¼åæ¬è®¿é®é«çº§ IO åè½ï¼å¦ sendfileï¼epoll å OpenSSLï¼ï¼æä½ç³»ç»çº§åè½ï¼éæºæ°çæï¼ç³»ç»ç¶æç­ï¼åæ¬å°è¿ç¨å¤çï¼å±äº«åå­ï¼NT ç®¡éå Unix å¥æ¥å­ï¼ã\n\nè¡¨æ ¼ä¸­å­æ®µå«ä¹è¯´æï¼\n\n * Support Polling - æ¯å¦æ¯æåºäº IO å¤è·¯å¤ç¨ç socket äºä»¶è½®è¯¢\n * Polling Size - è½®è¯¢çæå¤§è¿æ¥æ°\n * Wait for next Request - å¨ç­å¾ä¸ä¸ä¸ªè¯·æ±æ¶ï¼å¤ççº¿ç¨æ¯å¦éæ¾ï¼BIO æ¯æ²¡æéæ¾çï¼æä»¥å¨ keep-alive=true çæåµä¸å¤ççå¹¶åè¿æ¥æ°æé\n * Read Request Headers - ç±äº request header æ°æ®è¾å°ï¼å¯ä»¥ç±å®¹å¨æåè§£æå®æ¯ï¼ä¸éè¦é»å¡\n * Read Request Body - è¯»å request body çæ°æ®æ¯åºç¨ä¸å¡é»è¾çäºæï¼åæ¶ Servlet çéå¶ï¼æ¯éè¦é»å¡è¯»åç\n * Write Response - è·è¯»å request body çé»è¾ç±»ä¼¼ï¼åæ ·éè¦é»å¡å\n\nNIO å¤çç¸å³ç±»\n\n\n\nPoller çº¿ç¨ä» EventQueue è·å PollerEventï¼å¹¶æ§è¡ PollerEvent ç run æ¹æ³ï¼è°ç¨ Selector ç select æ¹æ³ï¼å¦ææå¯è¯»ç Socket ååå»º Http11NioProcessorï¼æ¾å¥å°çº¿ç¨æ± ä¸­æ§è¡ï¼\n\nCoyoteAdapter æ¯ Connector å° Container çééå¨ï¼Http11NioProcessor è°ç¨å¶æä¾ç service æ¹æ³ï¼åé¨åå»º Request å Response å¯¹è±¡ï¼å¹¶è°ç¨æé¡¶å±å®¹å¨ç Pipeline ä¸­çç¬¬ä¸ä¸ª Valve ç invoke æ¹æ³\n\nMapper ä¸»è¦å¤ç http url å° servlet çæ å°è§åçè§£æï¼å¯¹å¤æä¾ map æ¹æ³\n\n\n# 4.5. Comet\n\nComet æ¯ä¸ç§ç¨äº web çæ¨éææ¯ï¼è½ä½¿æå¡å¨å®æ¶å°å°æ´æ°çä¿¡æ¯ä¼ éå°å®¢æ·ç«¯ï¼èæ é¡»å®¢æ·ç«¯ååºè¯·æ± å¨ WebSocket åºæ¥ä¹åï¼å¦æä¸éç¨ cometï¼åªè½éè¿æµè§å¨ç«¯è½®è¯¢ Server æ¥æ¨¡æå®ç°æå¡å¨ç«¯æ¨éã Comet æ¯æ servlet å¼æ­¥å¤ç IOï¼å½è¿æ¥ä¸æ°æ®å¯è¯»æ¶è§¦åäºä»¶ï¼å¹¶å¼æ­¥åæ°æ®(é»å¡)\n\nTomcat è¦å®ç° Cometï¼åªéç»§æ¿ HttpServlet åæ¶ï¼å®ç° CometProcessor æ¥å£\n\n * Beginï¼æ°çè¯·æ±è¿æ¥æ¥å¥è°ç¨ï¼å¯è¿è¡ä¸ Request å Response ç¸å³çå¯¹è±¡åå§åæä½ï¼å¹¶ä¿å­ response å¯¹è±¡ï¼ç¨äºåç»­åå¥æ°æ®\n * Readï¼è¯·æ±è¿æ¥ææ°æ®å¯è¯»æ¶è°ç¨\n * Endï¼å½æ°æ®å¯ç¨æ¶ï¼å¦æè¯»åå°æä»¶ç»ææè response è¢«å³é­æ¶åè¢«è°ç¨\n * Errorï¼å¨è¿æ¥ä¸åçå¼å¸¸æ¶è°ç¨ï¼æ°æ®è¯»åå¼å¸¸ãè¿æ¥æ­å¼ãå¤çå¼å¸¸ãsocket è¶æ¶\n\nNoteï¼\n\n * Readï¼å¨ post è¯·æ±ææ°æ®ï¼ä½å¨ begin äºä»¶ä¸­æ²¡æå¤çï¼åä¼è°ç¨ readï¼å¦æ read æ²¡æè¯»åæ°æ®ï¼å¨ä¼è§¦å Error åè°ï¼å³é­ socket\n * Endï¼å½ socket è¶æ¶ï¼å¹¶ä¸ response è¢«å³é­æ¶ä¹ä¼è°ç¨ï¼server è¢«å³é­æ¶è°ç¨\n * Errorï¼é¤äº socket è¶æ¶ä¸ä¼å³é­ socketï¼å¶ä»é½ä¼å³é­ socket\n * End å Error æ¶é´è§¦åæ¶åºå³é­å½å comet ä¼è¯ï¼å³è°ç¨ CometEvent ç close æ¹æ³ Noteï¼å¨äºä»¶è§¦åæ¶è¦åå¥½çº¿ç¨å®å¨çæä½\n\n\n# 4.6. å¼æ­¥ Servlet\n\n\n\nä¼ ç»æµç¨ï¼\n\n * é¦åï¼Servlet æ¥æ¶å°è¯·æ±ä¹åï¼request æ°æ®è§£æï¼\n * æ¥çï¼è°ç¨ä¸å¡æ¥å£çæäºæ¹æ³ï¼ä»¥å®æä¸å¡å¤çï¼\n * æåï¼æ ¹æ®å¤ççç»ææäº¤ååºï¼Servlet çº¿ç¨ç»æ\n\n\n\nå¼æ­¥å¤çæµç¨ï¼\n\n * å®¢æ·ç«¯åéä¸ä¸ªè¯·æ±\n * Servlet å®¹å¨åéä¸ä¸ªçº¿ç¨æ¥å¤çå®¹å¨ä¸­çä¸ä¸ª servlet\n * servlet è°ç¨ request.startAsync()ï¼ä¿å­ AsyncContext, ç¶åè¿å\n * ä»»ä½æ¹å¼å­å¨çå®¹å¨çº¿ç¨é½å°éåºï¼ä½æ¯ response ä»ç¶ä¿æå¼æ¾\n * ä¸å¡çº¿ç¨ä½¿ç¨ä¿å­ç AsyncContext æ¥å®æååºï¼çº¿ç¨æ± ï¼\n * å®¢æ·ç«¯æ¶å°ååº\n\nServlet çº¿ç¨å°è¯·æ±è½¬äº¤ç»ä¸ä¸ªå¼æ­¥çº¿ç¨æ¥æ§è¡ä¸å¡å¤çï¼çº¿ç¨æ¬èº«è¿åè³å®¹å¨ï¼æ­¤æ¶ Servlet è¿æ²¡æçæååºæ°æ®ï¼å¼æ­¥çº¿ç¨å¤çå®ä¸å¡ä»¥åï¼å¯ä»¥ç´æ¥çæååºæ°æ®ï¼å¼æ­¥çº¿ç¨æ¥æ ServletRequest å ServletResponse å¯¹è±¡çå¼ç¨ï¼\n\nä¸ºä»ä¹ web åºç¨ä¸­æ¯æå¼æ­¥ï¼\n\næ¨åºå¼æ­¥ï¼ä¸»è¦æ¯éå¯¹é£äºæ¯è¾èæ¶çè¯·æ±ï¼æ¯å¦ä¸æ¬¡ç¼æ¢çæ°æ®åºæ¥è¯¢ï¼ä¸æ¬¡å¤é¨ REST API è°ç¨, æèæ¯å¶ä»ä¸äº I/O å¯éåæä½ãè¿ç§èæ¶çè¯·æ±ä¼å¾å¿«çèå Servlet å®¹å¨ççº¿ç¨æ± ï¼ç»§èå½±åå¯æ©å±æ§ã\n\nNoteï¼ä»å®¢æ·ç«¯çè§åº¦æ¥çï¼request ä»ç¶åä»»ä½å¶ä»ç HTTP ç request-response äº¤äºä¸æ ·ï¼åªæ¯èè´¹äºæ´é¿çæ¶é´èå·²\n\nå¼æ­¥äºä»¶çå¬\n\n * onStartAsyncï¼Request è°ç¨ startAsync æ¹æ³æ¶è§¦å\n * onCompleteï¼syncContext è°ç¨ complete æ¹æ³æ¶è§¦å\n * onErrorï¼å¤çè¯·æ±çè¿ç¨åºç°å¼å¸¸æ¶è§¦å\n * onTimeoutï¼socket è¶æ¶è§¦å\n\nNote : onError/ onTimeout è§¦ååï¼ä¼ç´§æ¥çåè° onComplete onComplete æ§è¡åï¼å°±ä¸å¯åæä½ request å response\n\n\n# 5. åèèµæ\n\n * å®æ¹\n   \n   * Tomcat å®æ¹ç½ç«\n   * Tomcat Wiki\n   * Tomee å®æ¹ç½ç«\n\n * æç« \n   \n   * Creating a Web App with Bootstrap and Tomcat Embedded\n   * Tomcat ç»æä¸å·¥ä½åç\n   * Tomcat å·¥ä½åç\n   * Tomcat è®¾è®¡æ¨¡å¼åæ',normalizedContent:'# tomcat å¿«éå¥é¨\n\n> ð çæ¬è¯´æ\n> \n> å½åææ°çæ¬ï¼tomcat 8.5.24\n> \n> ç¯å¢è¦æ±ï¼jdk7+\n\n\n# 1. tomcat ç®ä»\n\n\n# 1.1. tomcat æ¯ä»ä¹\n\ntomcat æ¯ç± apache å¼åçä¸ä¸ª servlet å®¹å¨ï¼å®ç°äºå¯¹ servlet å jsp çæ¯æï¼å¹¶æä¾äºä½ä¸º web æå¡å¨çä¸äºç¹æåè½ï¼å¦ tomcat ç®¡çåæ§å¶å¹³å°ãå®å¨åç®¡çå tomcat éç­ã\n\nç±äº tomcat æ¬èº«ä¹åå«äºä¸ä¸ª http æå¡å¨ï¼å®ä¹å¯ä»¥è¢«è§ä½ä¸ä¸ªåç¬ç web æå¡å¨ãä½æ¯ï¼ä¸è½å° tomcat å apache http æå¡å¨æ··æ·ï¼apache http æå¡å¨æ¯ä¸ä¸ªç¨ c è¯­è¨å®ç°ç http web æå¡å¨ï¼è¿ä¸¤ä¸ª http web server ä¸æ¯æç»å¨ä¸èµ·çãtomcat åå«äºä¸ä¸ªéç½®ç®¡çå·¥å·ï¼ä¹å¯ä»¥éè¿ç¼è¾ xml æ ¼å¼çéç½®æä»¶æ¥è¿è¡éç½®ã\n\n\n# 1.2. tomcat éè¦ç®å½\n\n * /bin - tomcat èæ¬å­æ¾ç®å½ï¼å¦å¯å¨ãå³é­èæ¬ï¼ã *.sh æä»¶ç¨äº unix ç³»ç»ï¼ *.bat æä»¶ç¨äº windows ç³»ç»ã\n * /conf - tomcat éç½®æä»¶ç®å½ã\n * /logs - tomcat é»è®¤æ¥å¿ç®å½ã\n * /webapps - webapp è¿è¡çç®å½ã\n\n\n# 1.3. web å·¥ç¨åå¸ç®å½ç»æ\n\nä¸è¬ web é¡¹ç®è·¯å¾ç»æ\n\n|-- webapp                         # ç«ç¹æ ¹ç®å½\n    |-- meta-inf                   # meta-inf ç®å½\n    |   `-- manifest.mf            # éç½®æ¸åæä»¶\n    |-- web-inf                    # web-inf ç®å½\n    |   |-- classes                # classæä»¶ç®å½\n    |   |   |-- *.class            # ç¨åºéè¦ç class æä»¶\n    |   |   `-- *.xml              # ç¨åºéè¦ç xml æä»¶\n    |   |-- lib                    # åºæä»¶å¤¹\n    |   |   `-- *.jar              # ç¨åºéè¦ç jar å\n    |   `-- web.xml                # webåºç¨ç¨åºçé¨ç½²æè¿°æä»¶\n    |-- <userdir>                  # èªå®ä¹çç®å½\n    |-- <userfiles>                # èªå®ä¹çèµæºæä»¶\n\n\n * webappï¼å·¥ç¨åå¸æä»¶å¤¹ãå¶å®æ¯ä¸ª war åé½å¯ä»¥è§ä¸º webapp çåç¼©åã\n\n * meta-infï¼meta-inf ç®å½ç¨äºå­æ¾å·¥ç¨èªèº«ç¸å³çä¸äºä¿¡æ¯ï¼åæä»¶ä¿¡æ¯ï¼éå¸¸ç±å¼åå·¥å·ï¼ç¯å¢èªå¨çæã\n\n * web-infï¼java web åºç¨çå®å¨ç®å½ãæè°å®å¨å°±æ¯å®¢æ·ç«¯æ æ³è®¿é®ï¼åªææå¡ç«¯å¯ä»¥è®¿é®çç®å½ã\n\n * /web-inf/classesï¼å­æ¾ç¨åºæéè¦çææ java class æä»¶ã\n\n * /web-inf/libï¼å­æ¾ç¨åºæéè¦çææ jar æä»¶ã\n\n * /web-inf/web.xmlï¼web åºç¨çé¨ç½²éç½®æä»¶ãå®æ¯å·¥ç¨ä¸­æéè¦çéç½®æä»¶ï¼å®æè¿°äº servlet åç»æåºç¨çå¶å®ç»ä»¶ï¼ä»¥ååºç¨åå§ååæ°ãå®å¨ç®¡ççº¦æç­ã\n\n\n# 1.4. tomcat åè½\n\ntomcat æ¯æç i/o æ¨¡åæï¼\n\n * nioï¼éé»å¡ i/oï¼éç¨ java nio ç±»åºå®ç°ã\n * nio2ï¼å¼æ­¥ i/oï¼éç¨ jdk 7 ææ°ç nio2 ç±»åºå®ç°ã\n * aprï¼éç¨ apache å¯ç§»æ¤è¿è¡åºå®ç°ï¼æ¯ c/c++ ç¼åçæ¬å°åºã\n\ntomcat æ¯æçåºç¨å±åè®®æï¼\n\n * http/1.1ï¼è¿æ¯å¤§é¨å web åºç¨éç¨çè®¿é®åè®®ã\n * ajpï¼ç¨äºå web æå¡å¨éæï¼å¦ apacheï¼ã\n * http/2ï¼http 2.0 å¤§å¹åº¦çæåäº web æ§è½ã\n\n\n# 2. tomcat å¥é¨\n\n\n# 2.1. å®è£\n\nåææ¡ä»¶\n\ntomcat 8.5 è¦æ± jdk çæ¬ä¸º 1.7 ä»¥ä¸ã\n\nè¿å¥ tomcat å®æ¹ä¸è½½å°å éæ©åéçæ¬ä¸è½½ï¼å¹¶è§£åå°æ¬å°ã\n\nwindows\n\næ·»å ç¯å¢åé catalina_home ï¼å¼ä¸º tomcat çå®è£è·¯å¾ã\n\nè¿å¥å®è£ç®å½ä¸ç bin ç®å½ï¼è¿è¡ startup.bat æä»¶ï¼å¯å¨ tomcat\n\nlinux / unix\n\nä¸é¢çç¤ºä¾ä»¥ 8.5.24 çæ¬ä¸ºä¾ï¼åå«äºä¸è½½ãè§£åãå¯å¨æä½ã\n\n# ä¸è½½è§£åå°æ¬å°\nwget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-8/v8.5.24/bin/apache-tomcat-8.5.24.tar.gz\ntar -zxf apache-tomcat-8.5.24.tar.gz\n# å¯å¨ tomcat\n./apache-tomcat-8.5.24/bin/startup.sh\n\n\nå¯å¨åï¼è®¿é® http://localhost:8080 ï¼å¯ä»¥çå° tomcat å®è£æåçæµè¯é¡µé¢ã\n\n\n\n\n# 2.2. éç½®\n\næ¬èå°åä¸¾ä¸äºéè¦ãå¸¸è§çéç½®é¡¹ãè¯¦ç»ç tomcat8 éç½®å¯ä»¥åè tomcat 8 éç½®å®æ¹åèææ¡£ ã\n\n# 2.2.1. server\n\n> server åç´ è¡¨ç¤ºæ´ä¸ª catalina servlet å®¹å¨ã\n> \n> å æ­¤ï¼å®å¿é¡»æ¯ conf/server.xml éç½®æä»¶ä¸­çæ ¹åç´ ãå®çå±æ§ä»£è¡¨äºæ´ä¸ª servlet å®¹å¨çç¹æ§ã\n\nå±æ§è¡¨\n\nå±æ§          æè¿°                                               å¤æ³¨\nclassname   è¿ä¸ªç±»å¿é¡»å®ç° org.apache.catalina.server æ¥å£ã           é»è®¤ org.apache.catalina.core.standardserver\naddress     æå¡å¨ç­å¾å³æºå½ä»¤ç tcp / ip å°åãå¦ææ²¡ææå®å°åï¼åä½¿ç¨ localhostã   \nport        æå¡å¨ç­å¾å³æºå½ä»¤ç tcp / ip ç«¯å£å·ãè®¾ç½®ä¸º-1 ä»¥ç¦ç¨å³é­ç«¯å£ã           \nshutdown    å¿é¡»éè¿ tcp / ip è¿æ¥æ¥æ¶å°æå®ç«¯å£å·çå½ä»¤å­ç¬¦ä¸²ï¼ä»¥å³é­ tomcatã       \n\n# 2.2.2. service\n\n> service åç´ è¡¨ç¤ºä¸ä¸ªæå¤ä¸ªè¿æ¥å¨ç»ä»¶çç»åï¼è¿äºç»ä»¶å±äº«ä¸ä¸ªç¨äºå¤çä¼ å¥è¯·æ±çå¼æç»ä»¶ãserver ä¸­å¯ä»¥æå¤ä¸ª serviceã\n\nå±æ§è¡¨\n\nå±æ§          æè¿°                                      å¤æ³¨\nclassname   è¿ä¸ªç±»å¿é¡»å®ç°org.apache.catalina.serviceæ¥å£ã   é»è®¤ org.apache.catalina.core.standardservice\nname        æ­¤æå¡çæ¾ç¤ºåç§°ï¼å¦ææ¨ä½¿ç¨æ å catalina               \n            ç»ä»¶ï¼å°åå«å¨æ¥å¿æ¶æ¯ä¸­ãä¸ç¹å®æå¡å¨å³èçæ¯ä¸ªæå¡çåç§°å¿é¡»æ¯å¯ä¸çã\n\nå®ä¾ - conf/server.xml éç½®æä»¶ç¤ºä¾\n\n<?xml version="1.0" encoding="utf-8"?>\n<server port="8080" shutdown="shutdown">\n  <service name="xxx">\n  ...\n  </service>\n</server>\n\n\n# 2.2.3. executor\n\n> executor è¡¨ç¤ºå¯ä»¥å¨ tomcat ä¸­çç»ä»¶ä¹é´å±äº«ççº¿ç¨æ± ã\n\nå±æ§è¡¨\n\nå±æ§                æè¿°                                          å¤æ³¨\nclassname         è¿ä¸ªç±»å¿é¡»å®ç°org.apache.catalina.executoræ¥å£ã      é»è®¤ org.apache.catalina.core.standardthreadexecutor\nname              çº¿ç¨æ± åç§°ã                                      è¦æ±å¯ä¸, ä¾ connector åç´ ç executor å±æ§ä½¿ç¨\nnameprefix        çº¿ç¨åç§°åç¼ã                                     \nmaxthreads        æå¤§æ´»è·çº¿ç¨æ°ã                                    é»è®¤ 200\nminsparethreads   æå°æ´»è·çº¿ç¨æ°ã                                    é»è®¤ 25\nmaxidletime       å½åæ´»è·çº¿ç¨å¤§äº minsparethreads æ¶,ç©ºé²çº¿ç¨å³é­çç­å¾æå¤§æ¶é´ã   é»è®¤ 60000ms\nmaxqueuesize      çº¿ç¨æ± æ»¡æåµä¸çè¯·æ±æéå¤§å°ã                             é»è®¤ integer.max_value\n\n<service name="xxx">\n  <executor name="tomcatthreadpool" nameprefix="catalina-exec-" maxthreads="300" minsparethreads="25"/>\n</service>\n\n\n# 2.2.4. connector\n\n> connector ä»£è¡¨è¿æ¥ç»ä»¶ãtomcat æ¯æä¸ç§åè®®ï¼http/1.1ãhttp/2.0ãajpã\n\nå±æ§è¡¨\n\nå±æ§                      è¯´æ                                                             å¤æ³¨\nasynctimeout            servlet3.0 è§èä¸­çå¼æ­¥è¯·æ±è¶æ¶                                          é»è®¤ 30s\nport                    è¯·æ±è¿æ¥ç tcp port                                                 è®¾ç½®ä¸º 0,åä¼éæºéåä¸ä¸ªæªå ç¨çç«¯å£å·\nprotocol                åè®®. ä¸è¬æåµä¸è®¾ç½®ä¸º http/1.1,è¿ç§æåµä¸è¿æ¥æ¨¡åä¼å¨ nio å apr/native ä¸­èªå¨æ ¹æ®éç½®éæ©   \nuriencoding             å¯¹ uri çç¼ç æ¹å¼.                                                   å¦æè®¾ç½®ç³»ç»åé org.apache.catalina.strict_servlet_compliance ä¸º\n                                                                                       true,ä½¿ç¨ iso-8859-1 ç¼ç ;å¦ææªè®¾ç½®æ­¤ç³»ç»åéä¸æªè®¾ç½®æ­¤å±æ§, ä½¿ç¨ utf-8 ç¼ç \nusebodyencodingforuri   æ¯å¦éç¨æå®ç contenttype èä¸æ¯ uriencoding æ¥ç¼ç  uri ä¸­çè¯·æ±åæ°             \n\nä»¥ä¸å±æ§å¨æ åç connector(nio, nio2 å apr/native)ä¸­ææ:\n\nå±æ§                  è¯´æ                                                  å¤æ³¨\nacceptcount         å½æå¤§è¯·æ±è¿æ¥ maxconnections æ»¡æ¶çæå¤§æéå¤§å°                    é»è®¤ 100,æ³¨ææ­¤å±æ§å executor ä¸­å±æ§ maxqueuesize\n                                                                        çåºå«.è¿ä¸ªæçæ¯è¯·æ±è¿æ¥æ»¡æ¶çå æ å¤§å°,executor ç maxqueuesize æçæ¯å¤ççº¿ç¨æ»¡æ¶çå æ å¤§å°\nconnectiontimeout   è¯·æ±è¿æ¥è¶æ¶                                              é»è®¤ 60000ms\nexecutor            æå®éç½®ççº¿ç¨æ± åç§°                                          \nkeepalivetimeout    keealive è¶æ¶æ¶é´                                       é»è®¤å¼ä¸º connectiontimeout éç½®å¼.-1 è¡¨ç¤ºä¸è¶æ¶\nmaxconnections      æå¤§è¿æ¥æ°                                               è¿æ¥æ»¡æ¶åç»­è¿æ¥æ¾å¥æå¤§ä¸º acceptcount çéåä¸­. å¯¹ nio å nio2 è¿æ¥,é»è®¤å¼ä¸º 10000;å¯¹\n                                                                        apr/native,é»è®¤å¼ä¸º 8192\nmaxthreads          å¦ææå®äº executor, æ­¤å±æ§å¿½ç¥;å¦åä¸º connector åå»ºçåé¨çº¿ç¨æ± æå¤§å¼     é»è®¤ 200\nminsparethreads     å¦ææå®äº executor, æ­¤å±æ§å¿½ç¥;å¦åä¸º connector åå»ºçº¿ç¨æ± çæå°æ´»è·çº¿ç¨æ°   é»è®¤ 10\nprocessorcache      åè®®å¤çå¨ç¼å­ processor å¯¹è±¡çå¤§å°                             -1 è¡¨ç¤ºä¸éå¶.å½ä¸ä½¿ç¨ servlet3.0 çå¼æ­¥å¤çæåµä¸: å¦æéç½® executor,éç½®ä¸º\n                                                                        executor ç maxthreads;å¦åéç½®ä¸º connnector ç maxthreads. å¦æä½¿ç¨\n                                                                        serlvet3.0 å¼æ­¥å¤ç, å maxthreads å maxconnections çæå¤§å¼\n\n# 2.2.5. context\n\n> context åç´ è¡¨ç¤ºä¸ä¸ª web åºç¨ç¨åºï¼å®å¨ç¹å®çèæä¸»æºä¸­è¿è¡ãæ¯ä¸ª web åºç¨ç¨åºé½åºäº web åºç¨ç¨åºå­æ¡£ï¼warï¼æä»¶ï¼æèåå«ç¸åºçè§£ååå®¹çç¸åºç®å½ï¼å¦ servlet è§èä¸­æè¿°ã\n\nå±æ§è¡¨\n\nå±æ§                           è¯´æ                                                          å¤æ³¨\naltddname                    web.xml é¨ç½²æè¿°ç¬¦è·¯å¾                                             é»è®¤ /web-inf/web.xml\ndocbase                      context ç root è·¯å¾                                           å host ç appbase ç¸ç»å, å¯ç¡®å® web åºç¨çå®éç®å½\nfailctxifservletstartfails   å host ä¸­ç failctxifservletstartfails, åªå¯¹å½å context ææ       é»è®¤ä¸º false\nlogeffectivewebxml           æ¯å¦æ¥å¿æå° web.xml åå®¹(web.xml ç±é»è®¤ç web.xml ååºç¨ä¸­ç web.xml ç»æ)    é»è®¤ä¸º false\npath                         web åºç¨ç context path                                        å¦æä¸ºæ ¹è·¯å¾,åéç½®ä¸ºç©ºå­ç¬¦ä¸²(""), ä¸è½ä¸éç½®\nprivileged                   æ¯å¦ä½¿ç¨ tomcat æä¾ç manager servlet                             \nreloadable                   /web-inf/classes/ å/web-inf/lib/ ç®å½ä¸­ class æä»¶åçååæ¯å¦èªå¨éæ°å è½½   é»è®¤ä¸º false\nswallowoutput                true æåµä¸, system.out å system.err è¾åºå°è¢«å®åå° web åºç¨æ¥å¿ä¸­         é»è®¤ä¸º false\n\n# 2.2.6. engine\n\n> engine åç´ è¡¨ç¤ºä¸ç¹å®ç catalina æå¡ç¸å³èçæ´ä¸ªè¯·æ±å¤çæºå¨ãå®æ¥æ¶å¹¶å¤çæ¥èªä¸ä¸ªæå¤ä¸ªè¿æ¥å¨çææè¯·æ±ï¼å¹¶å°å®æçååºè¿åç»è¿æ¥å¨ï¼ä»¥ä¾¿æç»ä¼ è¾åå®¢æ·ç«¯ã\n\nå±æ§è¡¨\n\nå±æ§            æè¿°                                           å¤æ³¨\ndefaulthost   é»è®¤ä¸»æºåï¼ç¨äºæ è¯å°å¤çæåæ­¤æå¡å¨ä¸ä¸»æºåç§°ä½æªå¨æ­¤éç½®æä»¶ä¸­éç½®çè¯·æ±çä¸»æºã   è¿ä¸ªåå­å¿é¡»å¹éå¶ä¸­ä¸ä¸ªåµå¥çä¸»æºåç´ çåå­å±æ§ã\nname          æ­¤å¼æçé»è¾åç§°ï¼ç¨äºæ¥å¿åéè¯¯æ¶æ¯ã                          å¨åä¸æå¡å¨ä¸­ä½¿ç¨å¤ä¸ªæå¡åç´ æ¶ï¼æ¯ä¸ªå¼æå¿é¡»åéä¸ä¸ªå¯ä¸çåç§°ã\n\n# 2.2.7. host\n\n> host åç´ è¡¨ç¤ºä¸ä¸ªèæä¸»æºï¼å®æ¯ä¸ä¸ªæå¡å¨çç½ç»åç§°ï¼å¦âwww.mycompany.comâï¼ä¸è¿è¡ tomcat çç¹å®æå¡å¨çå³èã\n\nå±æ§è¡¨\n\nå±æ§                           è¯´æ                                                         å¤æ³¨\nname                         åç§°                                                         ç¨äºæ¥å¿è¾åº\nappbase                      èæä¸»æºå¯¹åºçåºç¨åºç¡è·¯å¾                                              å¯ä»¥æ¯ä¸ªç»å¯¹è·¯å¾, æ${catalina_base}ç¸å¯¹è·¯å¾\nxmlbase                      èæä¸»æº xml åºç¡è·¯å¾,éé¢åºè¯¥æ context xml éç½®æä»¶                       å¯ä»¥æ¯ä¸ªç»å¯¹è·¯å¾, æ${catalina_base}ç¸å¯¹è·¯å¾\ncreatedirs                   å½ appbase å xmlbase ä¸å­å¨æ¶,æ¯å¦åå»ºç®å½                            é»è®¤ä¸º true\nautodeploy                   æ¯å¦å¨ææ§çæ£æ¥ appbase å xmlbase å¹¶ deploy web åºç¨å context æè¿°ç¬¦    é»è®¤ä¸º true\ndeployignore                 å¿½ç¥ deploy çæ­£å                                              \ndeployonstartup              tomcat å¯å¨æ¶æ¯å¦èªå¨ deploy                                      é»è®¤ä¸º true\nfailctxifservletstartfails   éç½®ä¸º true æåµä¸,ä»»ä½ load-on-startup >=0 ç servlet å¯å¨å¤±è´¥,åå¶å¯¹åºç   é»è®¤ä¸º false\n                             contxt ä¹å¯å¨å¤±è´¥\n\n# 2.2.8. cluster\n\nç±äºå¨å®éå¼åä¸­ï¼æä»æªç¨è¿ tomcat éç¾¤éç½®ï¼æä»¥æ²¡ç ç©¶ã\n\n\n# 2.3. å¯å¨\n\n# 2.3.1. é¨ç½²æ¹å¼\n\nè¿ç§æ¹å¼è¦æ±æ¬å°å¿é¡»å®è£ tomcat ã\n\nå°æåå¥½ç war åæ¾å¨ tomcat å®è£ç®å½ä¸ç webapps ç®å½ä¸ï¼ç¶åå¨ bin ç®å½ä¸æ§è¡ startup.bat æ startup.sh ï¼tomcat ä¼èªå¨è§£å webapps ç®å½ä¸ç war åã\n\næååï¼å¯ä»¥è®¿é® http://localhost:8080/xxx ï¼xxx æ¯ war åæä»¶åï¼ã\n\n> æ³¨æ\n> \n> ä»¥ä¸æ­¥éª¤æ¯æç®åçç¤ºä¾ãæ­¥éª¤ä¸­ç war åè§£åè·¯å¾ãå¯å¨ç«¯å£ä»¥åä¸äºæ´å¤çåè½é½å¯ä»¥ä¿®æ¹éç½®æä»¶æ¥å®å¶ ï¼ä¸»è¦æ¯ server.xml æ context.xml æä»¶ï¼ã\n\n# 2.3.2. åµå¥å¼\n\n# 2.3.2.1. api æ¹å¼\n\nå¨ pom.xml ä¸­æ·»å ä¾èµ\n\n<dependency>\n  <groupid>org.apache.tomcat.embed</groupid>\n  <artifactid>tomcat-embed-core</artifactid>\n  <version>8.5.24</version>\n</dependency>\n\n\næ·»å  simpleembedtomcatserver.java æä»¶ï¼åå®¹å¦ä¸ï¼\n\nimport java.util.optional;\nimport org.apache.catalina.startup.tomcat;\n\npublic class simpletomcatserver {\n    private static final int port = 8080;\n    private static final string context_path = "/javatool-server";\n\n    public static void main(string[] args) throws exception {\n        // è®¾å® profile\n        optional<string> profile = optional.ofnullable(system.getproperty("spring.profiles.active"));\n        system.setproperty("spring.profiles.active", profile.orelse("develop"));\n\n        tomcat tomcat = new tomcat();\n        tomcat.setport(port);\n        tomcat.gethost().setappbase(".");\n        tomcat.addwebapp(context_path, getabsolutepath() + "src/main/webapp");\n        tomcat.start();\n        tomcat.getserver().await();\n    }\n\n    private static string getabsolutepath() {\n        string path = null;\n        string folderpath = simpleembedtomcatserver.class.getprotectiondomain().getcodesource().getlocation().getpath()\n                .substring(1);\n        if (folderpath.indexof("target") > 0) {\n            path = folderpath.substring(0, folderpath.indexof("target"));\n        }\n        return path;\n    }\n}\n\n\næååï¼å¯ä»¥è®¿é® http://localhost:8080/javatool-server ã\n\n> è¯´æ\n> \n> æ¬ç¤ºä¾æ¯ä½¿ç¨ org.apache.tomcat.embed å¯å¨åµå¥å¼ tomcat çæç®ç¤ºä¾ã\n> \n> è¿ä¸ªç¤ºä¾ä¸­ä½¿ç¨çæ¯ tomcat é»è®¤çéç½®ï¼ä½éå¸¸ï¼æä»¬éè¦å¯¹ tomcat éç½®è¿è¡ä¸äºå®å¶åè°ä¼ãä¸ºäºå è½½éç½®æä»¶ï¼å¯å¨ç±»å°±è¦ç¨å¾®åå¤æä¸äºãè¿éä¸æ³åè´´ä»£ç ï¼æå´è¶£çåå­¦å¯ä»¥åèï¼\n> \n> ç¤ºä¾é¡¹ç®\n\n# 2.3.2.2. ä½¿ç¨ maven æä»¶å¯å¨ï¼ä¸æ¨èï¼\n\nä¸æ¨èçç±ï¼è¿ç§æ¹å¼å¯å¨ maven è½ç¶æç®åï¼ä½æ¯æä¸ä¸ªå¾å¤§çé®é¢æ¯ï¼ççå¾ä¹å¾ä¹æ²¡åå¸æ°çæ¬äºï¼ææ°çæ¬åå¸æ¶é´ï¼2013-11-11ï¼ãä¸è²ä¼¼åªè½æ¾å° tomcat6 ãtomcat7 æä»¶ã\n\nä½¿ç¨æ¹æ³\n\nå¨ pom.xml ä¸­å¼å¥æä»¶\n\n<plugin>\n  <groupid>org.apache.tomcat.maven</groupid>\n  <artifactid>tomcat7-maven-plugin</artifactid>\n  <version>2.2</version>\n  <configuration>\n    <port>8080</port>\n    <path>/${project.artifactid}</path>\n    <uriencoding>utf-8</uriencoding>\n  </configuration>\n</plugin>\n\n\nè¿è¡ mvn tomcat7:run å½ä»¤ï¼å¯å¨ tomcatã\n\næååï¼å¯ä»¥è®¿é® http://localhost:8080/xxx ï¼xxx æ¯ ${project.artifactid} æå®çé¡¹ç®åï¼ã\n\n# 2.3.3. ide æä»¶\n\nå¸¸è§ java ide ä¸è¬é½æå¯¹ tomcat çæ¯æã\n\nä»¥ intellij idea ä¸ºä¾ï¼æä¾äº tomcat and tomee integration æä»¶ï¼ä¸è¬é»è®¤ä¼å®è£ï¼ã\n\nä½¿ç¨æ­¥éª¤\n\n * ç¹å» run/debug configurations > new tomcat server > local ï¼æå¼ tomcat éç½®é¡µé¢ã\n * ç¹å» confiure... æé®ï¼è®¾ç½® tomcat å®è£è·¯å¾ã\n * ç¹å» deployment æ ç­¾é¡µï¼è®¾ç½®è¦å¯å¨çåºç¨ã\n * è®¾ç½®å¯å¨åºç¨çç«¯å£ãjvm åæ°ãå¯å¨æµè§å¨ç­ã\n * æååï¼å¯ä»¥è®¿é® http://localhost:8080/ï¼å½ç¶ï¼ä½ ä¹å¯ä»¥å¨ url ä¸­è®¾ç½®ä¸ä¸æåç§°ï¼ã\n\n\n\n> è¯´æ\n> \n> ä¸ªäººè®¤ä¸ºè¿ä¸ªæä»¶ä¸å¦ eclipse ç tomcat æä»¶å¥½ç¨ï¼eclipse ç tomcat æä»¶æ¯æå¯¹ tomcat xml éç½®æä»¶è¿è¡éç½®ãèè¿éï¼ä½ åªè½èªå·±å» tomcat å®è£è·¯å¾ä¸ä¿®æ¹éç½®æä»¶ã\n\næä¸­çåµå¥å¼å¯å¨ç¤ºä¾å¯ä»¥åèæçç¤ºä¾é¡¹ç®\n\n\n# 3. tomcat æ¶æ\n\n\n\ntomcat è¦å®ç° 2 ä¸ªæ ¸å¿åè½ï¼\n\n * å¤ç socket è¿æ¥ï¼è´è´£ç½ç»å­èæµä¸ request å response å¯¹è±¡çè½¬åã\n * å è½½åç®¡ç servletï¼ä»¥åå¤çå·ä½ç request è¯·æ±ã\n\nä¸ºæ­¤ï¼tomcat è®¾è®¡äºä¸¤ä¸ªæ ¸å¿ç»ä»¶ï¼\n\n * è¿æ¥å¨ï¼connectorï¼ï¼è´è´£åå¤é¨éä¿¡\n * å®¹å¨ï¼containerï¼ï¼è´è´£åé¨å¤ç\n\n\n# 3.1. service\n\ntomcat æ¯æç i/o æ¨¡åæï¼\n\n * nioï¼éé»å¡ i/oï¼éç¨ java nio ç±»åºå®ç°ã\n * nio2ï¼å¼æ­¥ i/oï¼éç¨ jdk 7 ææ°ç nio2 ç±»åºå®ç°ã\n * aprï¼éç¨ apache å¯ç§»æ¤è¿è¡åºå®ç°ï¼æ¯ c/c++ ç¼åçæ¬å°åºã\n\ntomcat æ¯æçåºç¨å±åè®®æï¼\n\n * http/1.1ï¼è¿æ¯å¤§é¨å web åºç¨éç¨çè®¿é®åè®®ã\n * ajpï¼ç¨äºå web æå¡å¨éæï¼å¦ apacheï¼ã\n * http/2ï¼http 2.0 å¤§å¹åº¦çæåäº web æ§è½ã\n\ntomcat æ¯æå¤ç§ i/o æ¨¡åååºç¨å±åè®®ãä¸ºäºå®ç°è¿ç¹ï¼ä¸ä¸ªå®¹å¨å¯è½å¯¹æ¥å¤ä¸ªè¿æ¥å¨ãä½æ¯ï¼åç¬çè¿æ¥å¨æå®¹å¨é½ä¸è½å¯¹å¤æä¾æå¡ï¼éè¦æå®ä»¬ç»è£èµ·æ¥æè½å·¥ä½ï¼ç»è£åè¿ä¸ªæ´ä½å«ä½ service ç»ä»¶ãtomcat åå¯è½æå¤ä¸ª serviceï¼éè¿å¨ tomcat ä¸­éç½®å¤ä¸ª serviceï¼å¯ä»¥å®ç°éè¿ä¸åçç«¯å£å·æ¥è®¿é®åä¸å°æºå¨ä¸é¨ç½²çä¸ååºç¨ã\n\n\n\nä¸ä¸ª tomcat å®ä¾æä¸ä¸ªæå¤ä¸ª serviceï¼ä¸ä¸ª service æå¤ä¸ª connector å containerãconnector å container ä¹é´éè¿æ åç servletrequest å servletresponse éä¿¡ã\n\n\n# 3.2. è¿æ¥å¨\n\nè¿æ¥å¨å¯¹ servlet å®¹å¨å±è½äºåè®®å i/o æ¨¡åç­çåºå«ï¼æ è®ºæ¯ http è¿æ¯ ajpï¼å¨å®¹å¨ä¸­è·åå°çé½æ¯ä¸ä¸ªæ åç servletrequest å¯¹è±¡ã\n\nè¿æ¥å¨çä¸»è¦åè½æ¯ï¼\n\n * ç½ç»éä¿¡\n * åºç¨å±åè®®è§£æ\n * tomcat request/response ä¸ servletrequest/servletresponse çè½¬å\n\ntomcat è®¾è®¡äº 3 ä¸ªç»ä»¶æ¥å®ç°è¿ 3 ä¸ªåè½ï¼åå«æ¯ endpointãprocessor å adapterã\n\n\n\nç»ä»¶é´éè¿æ½è±¡æ¥å£äº¤äºãè¿æ ·åè¿æä¸ä¸ªå¥½å¤æ¯**å°è£ååã**è¿æ¯é¢åå¯¹è±¡è®¾è®¡çç²¾é«ï¼å°ç³»ç»ä¸­ç»å¸¸ååçé¨ååç¨³å®çé¨åéç¦»ï¼æå©äºå¢å å¤ç¨æ§ï¼å¹¶éä½ç³»ç»è¦ååº¦ãç½ç»éä¿¡ç i/o æ¨¡åæ¯ååçï¼å¯è½æ¯éé»å¡ i/oãå¼æ­¥ i/o æè aprãåºç¨å±åè®®ä¹æ¯ååçï¼å¯è½æ¯ httpãhttpsãajpãæµè§å¨ç«¯åéçè¯·æ±ä¿¡æ¯ä¹æ¯ååçãä½æ¯æ´ä½çå¤çé»è¾æ¯ä¸åçï¼endpoint è´è´£æä¾å­èæµç» processorï¼processor è´è´£æä¾ tomcat request å¯¹è±¡ç» adapterï¼adapter è´è´£æä¾ servletrequest å¯¹è±¡ç»å®¹å¨ã\n\nå¦æè¦æ¯ææ°ç i/o æ¹æ¡ãæ°çåºç¨å±åè®®ï¼åªéè¦å®ç°ç¸å³çå·ä½å­ç±»ï¼ä¸å±éç¨çå¤çé»è¾æ¯ä¸åçãç±äº i/o æ¨¡åååºç¨å±åè®®å¯ä»¥èªç±ç»åï¼æ¯å¦ nio + http æè nio2 + ajpãtomcat çè®¾è®¡èå°ç½ç»éä¿¡ååºç¨å±åè®®è§£ææ¾å¨ä¸èµ·èèï¼è®¾è®¡äºä¸ä¸ªå« protocolhandler çæ¥å£æ¥å°è£è¿ä¸¤ç§ååç¹ãåç§åè®®åéä¿¡æ¨¡åçç»åæç¸åºçå·ä½å®ç°ç±»ãæ¯å¦ï¼http11nioprotocol å ajpnioprotocolã\n\n\n\n# 3.2.1. protocolhandler ç»ä»¶\n\nè¿æ¥å¨ç¨ protocolhandler æ¥å£æ¥å°è£éä¿¡åè®®å i/o æ¨¡åçå·®å¼ãprotocolhandler åé¨ååä¸º endpoint å processor æ¨¡åï¼endpoint è´è´£åºå± socket éä¿¡ï¼proccesor è´è´£åºç¨å±åè®®è§£æã\n\n# 3.2.1.1. endpoint\n\nendpoint æ¯éä¿¡ç«¯ç¹ï¼å³éä¿¡çå¬çæ¥å£ï¼æ¯å·ä½ç socket æ¥æ¶ååéå¤çå¨ï¼æ¯å¯¹ä¼ è¾å±çæ½è±¡ï¼å æ­¤ endpoint æ¯ç¨æ¥å®ç° tcp/ip åè®®çã\n\nendpoint æ¯ä¸ä¸ªæ¥å£ï¼å¯¹åºçæ½è±¡å®ç°ç±»æ¯ abstractendpointï¼è abstractendpoint çå·ä½å­ç±»ï¼æ¯å¦å¨ nioendpoint å nio2endpoint ä¸­ï¼æä¸¤ä¸ªéè¦çå­ç»ä»¶ï¼acceptor å socketprocessorã\n\nå¶ä¸­ acceptor ç¨äºçå¬ socket è¿æ¥è¯·æ±ãsocketprocessor ç¨äºå¤çæ¥æ¶å°ç socket è¯·æ±ï¼å®å®ç° runnable æ¥å£ï¼å¨ run æ¹æ³éè°ç¨åè®®å¤çç»ä»¶ processor è¿è¡å¤çãä¸ºäºæé«å¤çè½åï¼socketprocessor è¢«æäº¤å°çº¿ç¨æ± æ¥æ§è¡ãèè¿ä¸ªçº¿ç¨æ± å«ä½æ§è¡å¨ï¼executor)ã\n\n# 3.2.1.2. processor\n\nå¦æè¯´ endpoint æ¯ç¨æ¥å®ç° tcp/ip åè®®çï¼é£ä¹ processor ç¨æ¥å®ç° http åè®®ï¼processor æ¥æ¶æ¥èª endpoint ç socketï¼è¯»åå­èæµè§£ææ tomcat request å response å¯¹è±¡ï¼å¹¶éè¿ adapter å°å¶æäº¤å°å®¹å¨å¤çï¼processor æ¯å¯¹åºç¨å±åè®®çæ½è±¡ã\n\nprocessor æ¯ä¸ä¸ªæ¥å£ï¼å®ä¹äºè¯·æ±çå¤çç­æ¹æ³ãå®çæ½è±¡å®ç°ç±» abstractprocessor å¯¹ä¸äºåè®®å±æçå±æ§è¿è¡å°è£ï¼æ²¡æå¯¹æ¹æ³è¿è¡å®ç°ãå·ä½çå®ç°æ ajpprocessorãhttp11processor ç­ï¼è¿äºå·ä½å®ç°ç±»å®ç°äºç¹å®åè®®çè§£ææ¹æ³åè¯·æ±å¤çæ¹å¼ã\n\n\n\nä»å¾ä¸­æä»¬çå°ï¼endpoint æ¥æ¶å° socket è¿æ¥åï¼çæä¸ä¸ª socketprocessor ä»»å¡æäº¤å°çº¿ç¨æ± å»å¤çï¼socketprocessor ç run æ¹æ³ä¼è°ç¨ processor ç»ä»¶å»è§£æåºç¨å±åè®®ï¼processor éè¿è§£æçæ request å¯¹è±¡åï¼ä¼è°ç¨ adapter ç service æ¹æ³ã\n\n# 3.2.2. adapter\n\nè¿æ¥å¨éè¿ééå¨ adapter è°ç¨å®¹å¨ã\n\nç±äºåè®®ä¸åï¼å®¢æ·ç«¯åè¿æ¥çè¯·æ±ä¿¡æ¯ä¹ä¸å°½ç¸åï¼tomcat å®ä¹äºèªå·±ç request ç±»æ¥ééè¿äºè¯·æ±ä¿¡æ¯ã\n\nprotocolhandler æ¥å£è´è´£è§£æè¯·æ±å¹¶çæ tomcat request ç±»ãä½æ¯è¿ä¸ª request å¯¹è±¡ä¸æ¯æ åç servletrequestï¼ä¹å°±æå³çï¼ä¸è½ç¨ tomcat request ä½ä¸ºåæ°æ¥è°ç¨å®¹å¨ãtomcat çè§£å³æ¹æ¡æ¯å¼å¥ coyoteadapterï¼è¿æ¯ééå¨æ¨¡å¼çç»å¸è¿ç¨ï¼è¿æ¥å¨è°ç¨ coyoteadapter ç sevice æ¹æ³ï¼ä¼ å¥çæ¯ tomcat request å¯¹è±¡ï¼coyoteadapter è´è´£å° tomcat request è½¬æ servletrequestï¼åè°ç¨å®¹å¨ç service æ¹æ³ã\n\n\n# 3.3. å®¹å¨\n\ntomcat è®¾è®¡äº 4 ç§å®¹å¨ï¼åå«æ¯ engineãhostãcontext å wrapperã\n\n * engine - servlet çé¡¶å±å®¹å¨ï¼åå«ä¸ ä¸ªæå¤ä¸ª host å­å®¹å¨ï¼\n * host - èæä¸»æºï¼è´è´£ web åºç¨çé¨ç½²å context çåå»ºï¼\n * context - web åºç¨ä¸ä¸æï¼åå«å¤ä¸ª wrapperï¼è´è´£ web éç½®çè§£æãç®¡çææç web èµæºï¼\n * wrapper - æåºå±çå®¹å¨ï¼æ¯å¯¹ servlet çå°è£ï¼è´è´£ servlet å®ä¾çå å»ºãæ§è¡åéæ¯ã\n\n# 3.3.1. è¯·æ±åå servlet è¿ç¨\n\ntomcat æ¯æä¹ç¡®å®è¯·æ±æ¯ç±åªä¸ª wrapper å®¹å¨éç servlet æ¥å¤ççå¢ï¼ç­æ¡æ¯ï¼tomcat æ¯ç¨ mapper ç»ä»¶æ¥å®æè¿ä¸ªä»»å¡çã\n\nä¸¾ä¾æ¥è¯´ï¼åå¦æä¸ä¸ªç½è´­ç³»ç»ï¼æé¢åç½ç«ç®¡çäººåçåå°ç®¡çç³»ç»ï¼è¿æé¢åç»ç«¯å®¢æ·çå¨çº¿è´­ç©ç³»ç»ãè¿ä¸¤ä¸ªç³»ç»è·å¨åä¸ä¸ª tomcat ä¸ï¼ä¸ºäºéç¦»å®ä»¬çè®¿é®ååï¼éç½®äºä¸¤ä¸ªèæååï¼manage.shopping.comåuser.shopping.comï¼ç½ç«ç®¡çäººåéè¿manage.shopping.comååè®¿é® tomcat å»ç®¡çç¨æ·åååï¼èç¨æ·ç®¡çåååç®¡çæ¯ä¸¤ä¸ªåç¬ç web åºç¨ãç»ç«¯å®¢æ·éè¿user.shopping.comååå»æç´¢åååä¸è®¢åï¼æç´¢åè½åè®¢åç®¡çä¹æ¯ä¸¤ä¸ªç¬ç«ç web åºç¨ãå¦ä¸æç¤ºï¼æ¼ç¤ºäº url åºå£° servlet çå¤çæµç¨ã\n\n\n\nåå¦æç¨æ·è®¿é®ä¸ä¸ª urlï¼æ¯å¦å¾ä¸­çhttp://user.shopping.com:8080/order/buyï¼tomcat å¦ä½å°è¿ä¸ª url å®ä½å°ä¸ä¸ª servlet å¢ï¼\n\n 1. é¦åï¼æ ¹æ®åè®®åç«¯å£å·éå® service å engineã\n 2. ç¶åï¼æ ¹æ®ååéå® hostã\n 3. ä¹åï¼æ ¹æ® url è·¯å¾æ¾å° context ç»ä»¶ã\n 4. æåï¼æ ¹æ® url è·¯å¾æ¾å° wrapperï¼servletï¼ã\n\nè¿ä¸ªè·¯ç±ååè¿ç¨å·ä½æ¯æä¹å®ç°çå¢ï¼ç­æ¡æ¯ä½¿ç¨ pipeline-valve ç®¡éã\n\n# 3.3.2. pipeline-value\n\npipeline å¯ä»¥çè§£ä¸ºç°å®ä¸­çç®¡éï¼valve ä¸ºç®¡éä¸­çéé¨ï¼request å response å¯¹è±¡å¨ç®¡éä¸­ç»è¿åä¸ªéé¨çå¤çåæ§å¶ã\n\npipeline-valve æ¯è´£ä»»é¾æ¨¡å¼ï¼è´£ä»»é¾æ¨¡å¼æ¯æå¨ä¸ä¸ªè¯·æ±å¤ççè¿ç¨ä¸­æå¾å¤å¤çèä¾æ¬¡å¯¹è¯·æ±è¿è¡å¤çï¼æ¯ä¸ªå¤çèè´è´£åèªå·±ç¸åºçå¤çï¼å¤çå®ä¹åå°åè°ç¨ä¸ä¸ä¸ªå¤çèç»§ç»­å¤çãvalve è¡¨ç¤ºä¸ä¸ªå¤çç¹ï¼æ¯å¦æéè®¤è¯åè®°å½æ¥å¿ã\n\nåæ¥äºè§£ä¸ä¸ valve å pipeline æ¥å£çè®¾è®¡ï¼\n\n\n\n * æ¯ä¸ä¸ªå®¹å¨é½æä¸ä¸ª pipeline å¯¹è±¡ï¼åªè¦è§¦åè¿ä¸ª pipeline çç¬¬ä¸ä¸ª valveï¼è¿ä¸ªå®¹å¨é pipeline ä¸­ç valve å°±é½ä¼è¢«è°ç¨å°ãä½æ¯ï¼ä¸åå®¹å¨ç pipeline æ¯æä¹é¾å¼è§¦åçå¢ï¼æ¯å¦ engine ä¸­ pipeline éè¦è°ç¨ä¸å±å®¹å¨ host ä¸­ç pipelineã\n * è¿æ¯å ä¸º pipeline ä¸­è¿æä¸ª getbasic æ¹æ³ãè¿ä¸ª basicvalve å¤äº valve é¾è¡¨çæ«ç«¯ï¼å®æ¯ pipeline ä¸­å¿ä¸å¯å°çä¸ä¸ª valveï¼è´è´£è°ç¨ä¸å±å®¹å¨ç pipeline éçç¬¬ä¸ä¸ª valveã\n * pipeline ä¸­æ addvalve æ¹æ³ãpipeline ä¸­ç»´æ¤äº valve é¾è¡¨ï¼valve å¯ä»¥æå¥å° pipeline ä¸­ï¼å¯¹è¯·æ±åæäºå¤çãæä»¬è¿åç° pipeline ä¸­æ²¡æ invoke æ¹æ³ï¼å ä¸ºæ´ä¸ªè°ç¨é¾çè§¦åæ¯ valve æ¥å®æçï¼valve å®æèªå·±çå¤çåï¼è°ç¨ getnext.invoke() æ¥è§¦åä¸ä¸ä¸ª valve è°ç¨ã\n * valve ä¸­ä¸»è¦çä¸ä¸ªæ¹æ³ï¼setnextãgetnextãinvokeãvalve ä¹é´çå³ç³»æ¯ååé¾å¼ç»æï¼æ¬èº« invoke æ¹æ³ä¸­ä¼è°ç¨ä¸ä¸ä¸ª valve ç invoke æ¹æ³ã\n * åå±å®¹å¨å¯¹åºç basic valve åå«æ¯ standardenginevalveãstandardhostvalveã standardcontextvalveãstandardwrappervalveã\n * ç±äº valve æ¯ä¸ä¸ªå¤çç¹ï¼å æ­¤ invoke æ¹æ³å°±æ¯æ¥å¤çè¯·æ±çãæ³¨æå° valve ä¸­æ getnext å setnext æ¹æ³ï¼å æ­¤æä»¬å¤§æ¦å¯ä»¥çå°æä¸ä¸ªé¾è¡¨å° valve é¾èµ·æ¥äºã\n\n\n\næ´ä¸ªè°ç¨è¿ç¨ç±è¿æ¥å¨ä¸­ç adapter è§¦åçï¼å®ä¼è°ç¨ engine çç¬¬ä¸ä¸ª valveï¼\n\nconnector.getservice().getcontainer().getpipeline().getfirst().invoke(request, response);\n\n\n\n# 4. tomcat çå½å¨æ\n\n\n# 4.1. tomcat çå¯å¨è¿ç¨\n\n\n\n 1. tomcat æ¯ä¸ä¸ª java ç¨åºï¼å®çè¿è¡ä»æ§è¡ startup.sh èæ¬å¼å§ãstartup.sh ä¼å¯å¨ä¸ä¸ª jvm æ¥è¿è¡ tomcat çå¯å¨ç±» bootstrapã\n 2. bootstrap ä¼åå§å tomcat çç±»å è½½å¨å¹¶å®ä¾å catalinaã\n 3. catalina ä¼éè¿ digester è§£æ server.xmlï¼æ ¹æ®å¶ä¸­çéç½®ä¿¡æ¯æ¥åå»ºç¸åºç»ä»¶ï¼å¹¶è°ç¨ server ç start æ¹æ³ã\n 4. server è´è´£ç®¡ç service ç»ä»¶ï¼å®ä¼è°ç¨ service ç start æ¹æ³ã\n 5. service è´è´£ç®¡ç connector åé¡¶å±å®¹å¨ engineï¼å®ä¼è°ç¨ connector å engine ç start æ¹æ³ã\n\n# 4.1.1. catalina ç»ä»¶\n\ncatalina çèè´£å°±æ¯è§£æ server.xml éç½®ï¼å¹¶æ®æ­¤å®ä¾å serverãæ¥ä¸æ¥ï¼è°ç¨ server ç»ä»¶ç init æ¹æ³å start æ¹æ³ï¼å° tomcat å¯å¨èµ·æ¥ã\n\ncatalina è¿éè¦å¤çåç§âå¼å¸¸âæåµï¼æ¯å¦å½æä»¬éè¿âctrl + câå³é­ tomcat æ¶ï¼tomcat å°å¦ä½ä¼éçåæ­¢å¹¶ä¸æ¸çèµæºå¢ï¼å æ­¤ catalina å¨ jvm ä¸­æ³¨åä¸ä¸ªâå³é­é©å­âã\n\npublic void start() {\n    //1. å¦æææç server å®ä¾ä¸ºç©ºï¼å°±è§£æ server.xml åå»ºåºæ¥\n    if (getserver() == null) {\n        load();\n    }\n\n    //2. å¦æåå»ºå¤±è´¥ï¼æ¥ééåº\n    if (getserver() == null) {\n        log.fatal(sm.getstring("catalina.noserver"));\n        return;\n    }\n\n    //3. å¯å¨ server\n    try {\n        getserver().start();\n    } catch (lifecycleexception e) {\n        return;\n    }\n\n    // åå»ºå¹¶æ³¨åå³é­é©å­\n    if (useshutdownhook) {\n        if (shutdownhook == null) {\n            shutdownhook = new catalinashutdownhook();\n        }\n        runtime.getruntime().addshutdownhook(shutdownhook);\n    }\n\n    // ç¨ await æ¹æ³çå¬åæ­¢è¯·æ±\n    if (await) {\n        await();\n        stop();\n    }\n}\n\n\nä¸ºä»ä¹éè¦å³é­é©å­ï¼\n\nå¦ææä»¬éè¦å¨ jvm å³é­æ¶åä¸äºæ¸çå·¥ä½ï¼æ¯å¦å°ç¼å­æ°æ®å·å°ç£çä¸ï¼æèæ¸çä¸äºä¸´æ¶æä»¶ï¼å¯ä»¥å jvm æ³¨åä¸ä¸ªâå³é­é©å­âãâå³é­é©å­âå¶å®å°±æ¯ä¸ä¸ªçº¿ç¨ï¼jvm å¨åæ­¢ä¹åä¼å°è¯æ§è¡è¿ä¸ªçº¿ç¨ç run æ¹æ³ã\n\ntomcat çâå³é­é©å­âââ catalinashutdownhook åäºäºä»ä¹å¢ï¼\n\nprotected class catalinashutdownhook extends thread {\n\n    @override\n    public void run() {\n        try {\n            if (getserver() != null) {\n                catalina.this.stop();\n            }\n        } catch (throwable ex) {\n           ...\n        }\n    }\n}\n\n\ntomcat çâå³é­é©å­âå®éä¸å°±æ§è¡äº server ç stop æ¹æ³ï¼server ç stop æ¹æ³ä¼éæ¾åæ¸çææçèµæºã\n\n# 4.1.2. server ç»ä»¶\n\nserver ç»ä»¶çå·ä½å®ç°ç±»æ¯ standardserverï¼server ç»§æ¿äº lifecyclebaseï¼å®ççå½å¨æè¢«ç»ä¸ç®¡çï¼å¹¶ä¸å®çå­ç»ä»¶æ¯ serviceï¼å æ­¤å®è¿éè¦ç®¡ç service ççå½å¨æï¼ä¹å°±æ¯è¯´å¨å¯å¨æ¶è°ç¨ service ç»ä»¶çå¯å¨æ¹æ³ï¼å¨åæ­¢æ¶è°ç¨å®ä»¬çåæ­¢æ¹æ³ãserver å¨åé¨ç»´æ¤äºè¥å¹² service ç»ä»¶ï¼å®æ¯ä»¥æ°ç»æ¥ä¿å­çã\n\n@override\npublic void addservice(service service) {\n\n    service.setserver(this);\n\n    synchronized (serviceslock) {\n        // åå»ºä¸ä¸ªé¿åº¦ +1 çæ°æ°ç»\n        service results[] = new service[services.length + 1];\n\n        // å°èçæ°æ®å¤å¶è¿å»\n        system.arraycopy(services, 0, results, 0, services.length);\n        results[services.length] = service;\n        services = results;\n\n        // å¯å¨ service ç»ä»¶\n        if (getstate().isavailable()) {\n            try {\n                service.start();\n            } catch (lifecycleexception e) {\n                // ignore\n            }\n        }\n\n        // è§¦åçå¬äºä»¶\n        support.firepropertychange("service", null, service);\n    }\n\n}\n\n\nserver å¹¶æ²¡æä¸å¼å§å°±åéä¸ä¸ªå¾é¿çæ°ç»ï¼èæ¯å¨æ·»å çè¿ç¨ä¸­å¨æå°æ©å±æ°ç»é¿åº¦ï¼å½æ·»å ä¸ä¸ªæ°ç service å®ä¾æ¶ï¼ä¼åå»ºä¸ä¸ªæ°æ°ç»å¹¶æåæ¥æ°ç»åå®¹å¤å¶å°æ°æ°ç»ï¼è¿æ ·åçç®çå¶å®æ¯ä¸ºäºèçåå­ç©ºé´ã\n\né¤æ­¤ä¹å¤ï¼server ç»ä»¶è¿æä¸ä¸ªéè¦çä»»å¡æ¯å¯å¨ä¸ä¸ª socket æ¥çå¬åæ­¢ç«¯å£ï¼è¿å°±æ¯ä¸ºä»ä¹ä½ è½éè¿ shutdown å½ä»¤æ¥å³é­ tomcatãä¸ç¥éä½ çæå°æ²¡æï¼ä¸é¢ caralina çå¯å¨æ¹æ³çæåä¸è¡ä»£ç å°±æ¯è°ç¨äº server ç await æ¹æ³ã\n\nå¨ await æ¹æ³éä¼åå»ºä¸ä¸ª socket çå¬ 8005 ç«¯å£ï¼å¹¶å¨ä¸ä¸ªæ­»å¾ªç¯éæ¥æ¶ socket ä¸çè¿æ¥è¯·æ±ï¼å¦æææ°çè¿æ¥å°æ¥å°±å»ºç«è¿æ¥ï¼ç¶åä» socket ä¸­è¯»åæ°æ®ï¼å¦æè¯»å°çæ°æ®æ¯åæ­¢å½ä»¤âshutdownâï¼å°±éåºå¾ªç¯ï¼è¿å¥ stop æµç¨ã\n\n# 4.1.3. service ç»ä»¶\n\nservice ç»ä»¶çå·ä½å®ç°ç±»æ¯ standardserviceã\n\nãæºç ãstandardservice æºç å®ä¹\n\npublic class standardservice extends lifecyclebase implements service {\n    // åå­\n    private string name = null;\n\n    //server å®ä¾\n    private server server = null;\n\n    // è¿æ¥å¨æ°ç»\n    protected connector connectors[] = new connector[0];\n    private final object connectorslock = new object();\n\n    // å¯¹åºç engine å®¹å¨\n    private engine engine = null;\n\n    // æ å°å¨åå¶çå¬å¨\n    protected final mapper mapper = new mapper();\n    protected final mapperlistener mapperlistener = new mapperlistener(this);\n\n\t// ...\n}\n\n\nstandardservice ç»§æ¿äº lifecyclebase æ½è±¡ç±»ã\n\nstandardservice ç»´æ¤äºä¸ä¸ª mapperlistener ç¨äºæ¯æ tomcat ç­é¨ç½²ãå½ web åºç¨çé¨ç½²åçååæ¶ï¼mapper ä¸­çæ å°ä¿¡æ¯ä¹è¦è·çååï¼mapperlistener å°±æ¯ä¸ä¸ªçå¬å¨ï¼å®çå¬å®¹å¨çååï¼å¹¶æä¿¡æ¯æ´æ°å° mapper ä¸­ï¼è¿æ¯å¸åçè§å¯èæ¨¡å¼ã\n\nä½ä¸ºâç®¡çâè§è²çç»ä»¶ï¼æéè¦çæ¯ç»´æ¤å¶ä»ç»ä»¶ççå½å¨æãæ­¤å¤å¨å¯å¨åç§ç»ä»¶æ¶ï¼è¦æ³¨æå®ä»¬çä¾èµå³ç³»ï¼ä¹å°±æ¯è¯´ï¼è¦æ³¨æå¯å¨çé¡ºåºã\n\nprotected void startinternal() throws lifecycleexception {\n\n    //1. è§¦åå¯å¨çå¬å¨\n    setstate(lifecyclestate.starting);\n\n    //2. åå¯å¨ engineï¼engine ä¼å¯å¨å®å­å®¹å¨\n    if (engine != null) {\n        synchronized (engine) {\n            engine.start();\n        }\n    }\n\n    //3. åå¯å¨ mapper çå¬å¨\n    mapperlistener.start();\n\n    //4. æåå¯å¨è¿æ¥å¨ï¼è¿æ¥å¨ä¼å¯å¨å®å­ç»ä»¶ï¼æ¯å¦ endpoint\n    synchronized (connectorslock) {\n        for (connector connector: connectors) {\n            if (connector.getstate() != lifecyclestate.failed) {\n                connector.start();\n            }\n        }\n    }\n}\n\n\nä»å¯å¨æ¹æ³å¯ä»¥çå°ï¼service åå¯å¨äº engine ç»ä»¶ï¼åå¯å¨ mapper çå¬å¨ï¼æåææ¯å¯å¨è¿æ¥å¨ãè¿å¾å¥½çè§£ï¼å ä¸ºåå±ç»ä»¶å¯å¨å¥½äºæè½å¯¹å¤æä¾æå¡ï¼æè½å¯å¨å¤å±çè¿æ¥å¨ç»ä»¶ãè mapper ä¹ä¾èµå®¹å¨ç»ä»¶ï¼å®¹å¨ç»ä»¶å¯å¨å¥½äºæè½çå¬å®ä»¬çååï¼å æ­¤ mapper å mapperlistener å¨å®¹å¨ç»ä»¶ä¹åå¯å¨ãç»ä»¶åæ­¢çé¡ºåºè·å¯å¨é¡ºåºæ­£å¥½ç¸åçï¼ä¹æ¯åºäºå®ä»¬çä¾èµå³ç³»ã\n\n# 4.1.4. engine ç»ä»¶\n\nengine æ¬è´¨æ¯ä¸ä¸ªå®¹å¨ï¼å æ­¤å®ç»§æ¿äº containerbase åºç±»ï¼å¹¶ä¸å®ç°äº engine æ¥å£ã\n\n\n# 4.2. web åºç¨çé¨ç½²æ¹å¼\n\næ³¨ï¼catalina.homeï¼å®è£ç®å½;catalina.baseï¼å·¥ä½ç®å½;é»è®¤å¼ user.dir\n\n * server.xml éç½® host åç´ ï¼æå® appbase å±æ§ï¼é»è®¤$catalina.base/webapps/\n * server.xml éç½® context åç´ ï¼æå® docbaseï¼åç´ ï¼æå® web åºç¨çè·¯å¾\n * èªå®ä¹éç½®ï¼å¨$catalina.base/enginename/hostname/xxx.xml éç½® context åç´ \n\nhostconfig çå¬äº standardhost å®¹å¨çäºä»¶ï¼å¨ start æ¹æ³ä¸­è§£æä¸è¿°éç½®æä»¶ï¼\n\n * æ«æ appbase è·¯å¾ä¸çæææä»¶å¤¹å war åï¼è§£æåä¸ªåºç¨ç meta-inf/context.xmlï¼å¹¶ åå»º standardcontextï¼å¹¶å° context å å¥å° host çå­å®¹å¨ä¸­ã\n * è§£æ$catalina.base/enginename/hostname/ä¸çææ context éç½®ï¼æ¾å°ç¸åº web åº ç¨çä½ç½®ï¼è§£æåä¸ªåºç¨ç meta-inf/context.xmlï¼å¹¶åå»º standardcontextï¼å¹¶å° context å å¥å° host çå­å®¹å¨ä¸­ã\n\næ³¨ï¼\n\n * hostconfig å¹¶æ²¡æå®éè§£æ context.xmlï¼èæ¯å¨ contextconfig ä¸­è¿è¡çã\n * hostconfig ä¸­ä¼å®ææ£æ¥ watched èµæºæä»¶(context.xml éç½®æä»¶)\n\ncontextconfig è§£æ context.xml é¡ºåºï¼\n\n * åè§£æå¨å±çéç½® config/context.xml\n * ç¶åè§£æ host çé»è®¤éç½® enginename/hostname/context.xml.default\n * æåè§£æåºç¨ç meta-inf/context.xml\n\ncontextconfig è§£æ web.xml é¡ºåºï¼\n\n * åè§£æå¨å±çéç½® config/web.xml\n * ç¶åè§£æ host çé»è®¤éç½® enginename/hostname/web.xml.default æ¥çè§£æåºç¨ç meb-inf/web.xml\n * æ«æåºç¨ web-inf/lib/ä¸ç jar æä»¶ï¼è§£æå¶ä¸­ç meta-inf/web-fragment.xml æååå¹¶ xml å°è£æ webxmlï¼å¹¶è®¾ç½® context\n\næ³¨ï¼\n\n * æ«æ web åºç¨å jar ä¸­çæ³¨è§£(filterãlistenerãservlet)å°±æ¯ä¸è¿°æ­¥éª¤ä¸­è¿è¡çã\n * å®¹å¨çå®ææ§è¡ï¼backgroundprocessï¼ç± containerbase æ¥å®ç°çï¼å¹¶ä¸åªæå¨é¡¶å±å®¹å¨ ä¸­æä¼å¼å¯çº¿ç¨ã(backgroundprocessordelay=10 æ å¿ä½æ¥æ§å¶)\n\n\n# 4.3. lifecycle\n\n\n\n# 4.3.1. è¯·æ±å¤çè¿ç¨\n\n\n 1. æ ¹æ® server.xml éç½®çæå®ç connector ä»¥åç«¯å£çå¬ httpãæè ajp è¯·æ±\n 2. è¯·æ±å°æ¥æ¶å»ºç«è¿æ¥,è§£æè¯·æ±åæ°,åå»º request å response å¯¹è±¡,è°ç¨é¡¶å±å®¹å¨ pipeline ç invoke æ¹æ³\n 3. å®¹å¨ä¹é´å±å±è°ç¨,æç»è°ç¨ä¸å¡ servlet ç service æ¹æ³\n 4. connector å° response æµä¸­çæ°æ®åå° socket ä¸­\n\n\n# 4.4. connector æµç¨\n\n\n\n# 4.4.1. é»å¡ io\n\n\n\n# 4.4.2. éé»å¡ io\n\n\n\n# 4.4.3. io å¤è·¯å¤ç¨\n\n\n\né»å¡ä¸éé»å¡çåºå«å¨äºè¿è¡è¯»æä½ååæä½çç³»ç»è°ç¨æ¶ï¼å¦ææ­¤æ¶åæ ¸ææ²¡ææ°æ®å¯è¯»æèæ²¡æç¼å²ç©ºé´å¯åæ¶ï¼æ¯å¦é»å¡ã\n\nio å¤è·¯å¤ç¨çå¥½å¤å¨äºå¯åæ¶çå¬å¤ä¸ª socket çå¯è¯»åå¯åäºä»¶ï¼è¿æ ·å°±è½ä½¿å¾åºç¨å¯ä»¥åæ¶çå¬å¤ä¸ª socketï¼éæ¾äºåºç¨çº¿ç¨èµæºã\n\n# 4.4.4. tomcat åç±» connector å¯¹æ¯\n\n\n * jioï¼ç¨ java.io ç¼åç tcp æ¨¡åï¼é»å¡ io\n * nioï¼ç¨ java.nio ç¼åç tcp æ¨¡åï¼éé»å¡ ioï¼ï¼io å¤è·¯å¤ç¨ï¼\n * aprï¼å¨ç§° apache portable runtimeï¼ä½¿ç¨ jni çæ¹å¼æ¥è¿è¡è¯»åæä»¶ä»¥åè¿è¡ç½ç»ä¼ è¾\n\napache portable runtime æ¯ä¸ä¸ªé«åº¦å¯ç§»æ¤çåºï¼å®æ¯ apache http server 2.x çæ ¸å¿ã apr å·æè®¸å¤ç¨éï¼åæ¬è®¿é®é«çº§ io åè½ï¼å¦ sendfileï¼epoll å opensslï¼ï¼æä½ç³»ç»çº§åè½ï¼éæºæ°çæï¼ç³»ç»ç¶æç­ï¼åæ¬å°è¿ç¨å¤çï¼å±äº«åå­ï¼nt ç®¡éå unix å¥æ¥å­ï¼ã\n\nè¡¨æ ¼ä¸­å­æ®µå«ä¹è¯´æï¼\n\n * support polling - æ¯å¦æ¯æåºäº io å¤è·¯å¤ç¨ç socket äºä»¶è½®è¯¢\n * polling size - è½®è¯¢çæå¤§è¿æ¥æ°\n * wait for next request - å¨ç­å¾ä¸ä¸ä¸ªè¯·æ±æ¶ï¼å¤ççº¿ç¨æ¯å¦éæ¾ï¼bio æ¯æ²¡æéæ¾çï¼æä»¥å¨ keep-alive=true çæåµä¸å¤ççå¹¶åè¿æ¥æ°æé\n * read request headers - ç±äº request header æ°æ®è¾å°ï¼å¯ä»¥ç±å®¹å¨æåè§£æå®æ¯ï¼ä¸éè¦é»å¡\n * read request body - è¯»å request body çæ°æ®æ¯åºç¨ä¸å¡é»è¾çäºæï¼åæ¶ servlet çéå¶ï¼æ¯éè¦é»å¡è¯»åç\n * write response - è·è¯»å request body çé»è¾ç±»ä¼¼ï¼åæ ·éè¦é»å¡å\n\nnio å¤çç¸å³ç±»\n\n\n\npoller çº¿ç¨ä» eventqueue è·å pollereventï¼å¹¶æ§è¡ pollerevent ç run æ¹æ³ï¼è°ç¨ selector ç select æ¹æ³ï¼å¦ææå¯è¯»ç socket ååå»º http11nioprocessorï¼æ¾å¥å°çº¿ç¨æ± ä¸­æ§è¡ï¼\n\ncoyoteadapter æ¯ connector å° container çééå¨ï¼http11nioprocessor è°ç¨å¶æä¾ç service æ¹æ³ï¼åé¨åå»º request å response å¯¹è±¡ï¼å¹¶è°ç¨æé¡¶å±å®¹å¨ç pipeline ä¸­çç¬¬ä¸ä¸ª valve ç invoke æ¹æ³\n\nmapper ä¸»è¦å¤ç http url å° servlet çæ å°è§åçè§£æï¼å¯¹å¤æä¾ map æ¹æ³\n\n\n# 4.5. comet\n\ncomet æ¯ä¸ç§ç¨äº web çæ¨éææ¯ï¼è½ä½¿æå¡å¨å®æ¶å°å°æ´æ°çä¿¡æ¯ä¼ éå°å®¢æ·ç«¯ï¼èæ é¡»å®¢æ·ç«¯ååºè¯·æ± å¨ websocket åºæ¥ä¹åï¼å¦æä¸éç¨ cometï¼åªè½éè¿æµè§å¨ç«¯è½®è¯¢ server æ¥æ¨¡æå®ç°æå¡å¨ç«¯æ¨éã comet æ¯æ servlet å¼æ­¥å¤ç ioï¼å½è¿æ¥ä¸æ°æ®å¯è¯»æ¶è§¦åäºä»¶ï¼å¹¶å¼æ­¥åæ°æ®(é»å¡)\n\ntomcat è¦å®ç° cometï¼åªéç»§æ¿ httpservlet åæ¶ï¼å®ç° cometprocessor æ¥å£\n\n * beginï¼æ°çè¯·æ±è¿æ¥æ¥å¥è°ç¨ï¼å¯è¿è¡ä¸ request å response ç¸å³çå¯¹è±¡åå§åæä½ï¼å¹¶ä¿å­ response å¯¹è±¡ï¼ç¨äºåç»­åå¥æ°æ®\n * readï¼è¯·æ±è¿æ¥ææ°æ®å¯è¯»æ¶è°ç¨\n * endï¼å½æ°æ®å¯ç¨æ¶ï¼å¦æè¯»åå°æä»¶ç»ææè response è¢«å³é­æ¶åè¢«è°ç¨\n * errorï¼å¨è¿æ¥ä¸åçå¼å¸¸æ¶è°ç¨ï¼æ°æ®è¯»åå¼å¸¸ãè¿æ¥æ­å¼ãå¤çå¼å¸¸ãsocket è¶æ¶\n\nnoteï¼\n\n * readï¼å¨ post è¯·æ±ææ°æ®ï¼ä½å¨ begin äºä»¶ä¸­æ²¡æå¤çï¼åä¼è°ç¨ readï¼å¦æ read æ²¡æè¯»åæ°æ®ï¼å¨ä¼è§¦å error åè°ï¼å³é­ socket\n * endï¼å½ socket è¶æ¶ï¼å¹¶ä¸ response è¢«å³é­æ¶ä¹ä¼è°ç¨ï¼server è¢«å³é­æ¶è°ç¨\n * errorï¼é¤äº socket è¶æ¶ä¸ä¼å³é­ socketï¼å¶ä»é½ä¼å³é­ socket\n * end å error æ¶é´è§¦åæ¶åºå³é­å½å comet ä¼è¯ï¼å³è°ç¨ cometevent ç close æ¹æ³ noteï¼å¨äºä»¶è§¦åæ¶è¦åå¥½çº¿ç¨å®å¨çæä½\n\n\n# 4.6. å¼æ­¥ servlet\n\n\n\nä¼ ç»æµç¨ï¼\n\n * é¦åï¼servlet æ¥æ¶å°è¯·æ±ä¹åï¼request æ°æ®è§£æï¼\n * æ¥çï¼è°ç¨ä¸å¡æ¥å£çæäºæ¹æ³ï¼ä»¥å®æä¸å¡å¤çï¼\n * æåï¼æ ¹æ®å¤ççç»ææäº¤ååºï¼servlet çº¿ç¨ç»æ\n\n\n\nå¼æ­¥å¤çæµç¨ï¼\n\n * å®¢æ·ç«¯åéä¸ä¸ªè¯·æ±\n * servlet å®¹å¨åéä¸ä¸ªçº¿ç¨æ¥å¤çå®¹å¨ä¸­çä¸ä¸ª servlet\n * servlet è°ç¨ request.startasync()ï¼ä¿å­ asynccontext, ç¶åè¿å\n * ä»»ä½æ¹å¼å­å¨çå®¹å¨çº¿ç¨é½å°éåºï¼ä½æ¯ response ä»ç¶ä¿æå¼æ¾\n * ä¸å¡çº¿ç¨ä½¿ç¨ä¿å­ç asynccontext æ¥å®æååºï¼çº¿ç¨æ± ï¼\n * å®¢æ·ç«¯æ¶å°ååº\n\nservlet çº¿ç¨å°è¯·æ±è½¬äº¤ç»ä¸ä¸ªå¼æ­¥çº¿ç¨æ¥æ§è¡ä¸å¡å¤çï¼çº¿ç¨æ¬èº«è¿åè³å®¹å¨ï¼æ­¤æ¶ servlet è¿æ²¡æçæååºæ°æ®ï¼å¼æ­¥çº¿ç¨å¤çå®ä¸å¡ä»¥åï¼å¯ä»¥ç´æ¥çæååºæ°æ®ï¼å¼æ­¥çº¿ç¨æ¥æ servletrequest å servletresponse å¯¹è±¡çå¼ç¨ï¼\n\nä¸ºä»ä¹ web åºç¨ä¸­æ¯æå¼æ­¥ï¼\n\næ¨åºå¼æ­¥ï¼ä¸»è¦æ¯éå¯¹é£äºæ¯è¾èæ¶çè¯·æ±ï¼æ¯å¦ä¸æ¬¡ç¼æ¢çæ°æ®åºæ¥è¯¢ï¼ä¸æ¬¡å¤é¨ rest api è°ç¨, æèæ¯å¶ä»ä¸äº i/o å¯éåæä½ãè¿ç§èæ¶çè¯·æ±ä¼å¾å¿«çèå servlet å®¹å¨ççº¿ç¨æ± ï¼ç»§èå½±åå¯æ©å±æ§ã\n\nnoteï¼ä»å®¢æ·ç«¯çè§åº¦æ¥çï¼request ä»ç¶åä»»ä½å¶ä»ç http ç request-response äº¤äºä¸æ ·ï¼åªæ¯èè´¹äºæ´é¿çæ¶é´èå·²\n\nå¼æ­¥äºä»¶çå¬\n\n * onstartasyncï¼request è°ç¨ startasync æ¹æ³æ¶è§¦å\n * oncompleteï¼synccontext è°ç¨ complete æ¹æ³æ¶è§¦å\n * onerrorï¼å¤çè¯·æ±çè¿ç¨åºç°å¼å¸¸æ¶è§¦å\n * ontimeoutï¼socket è¶æ¶è§¦å\n\nnote : onerror/ ontimeout è§¦ååï¼ä¼ç´§æ¥çåè° oncomplete oncomplete æ§è¡åï¼å°±ä¸å¯åæä½ request å response\n\n\n# 5. åèèµæ\n\n * å®æ¹\n   \n   * tomcat å®æ¹ç½ç«\n   * tomcat wiki\n   * tomee å®æ¹ç½ç«\n\n * æç« \n   \n   * creating a web app with bootstrap and tomcat embedded\n   * tomcat ç»æä¸å·¥ä½åç\n   * tomcat å·¥ä½åç\n   * tomcat è®¾è®¡æ¨¡å¼åæ',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Tomcatè¿æ¥å¨",frontmatter:{title:"Tomcatè¿æ¥å¨",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Tomcat"],abbrlink:"23822cab",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/3c954b/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/01.Tomcat/02.Tomcat%E8%BF%9E%E6%8E%A5%E5%99%A8.html",relativePath:"02.JavaEE/02.æå¡å¨/01.Tomcat/02.Tomcatè¿æ¥å¨.md",key:"v-f0e9a0d2",path:"/pages/3c954b/",headers:[{level:2,title:"1. NioEndpoint ç»ä»¶",slug:"_1-nioendpoint-ç»ä»¶",normalizedTitle:"1. nioendpoint ç»ä»¶",charIndex:17},{level:3,title:"1.1. LimitLatch",slug:"_1-1-limitlatch",normalizedTitle:"1.1. limitlatch",charIndex:891},{level:3,title:"1.2. Acceptor",slug:"_1-2-acceptor",normalizedTitle:"1.2. acceptor",charIndex:2483},{level:3,title:"1.3. Poller",slug:"_1-3-poller",normalizedTitle:"1.3. poller",charIndex:3163},{level:3,title:"1.4. SocketProcessor",slug:"_1-4-socketprocessor",normalizedTitle:"1.4. socketprocessor",charIndex:3708},{level:2,title:"2. Nio2Endpoint ç»ä»¶",slug:"_2-nio2endpoint-ç»ä»¶",normalizedTitle:"2. nio2endpoint ç»ä»¶",charIndex:4180},{level:3,title:"2.1. Nio2Acceptor",slug:"_2-1-nio2acceptor",normalizedTitle:"2.1. nio2acceptor",charIndex:4852},{level:3,title:"2.2. Nio2SocketWrapper",slug:"_2-2-nio2socketwrapper",normalizedTitle:"2.2. nio2socketwrapper",charIndex:6316},{level:2,title:"3. AprEndpoint ç»ä»¶",slug:"_3-aprendpoint-ç»ä»¶",normalizedTitle:"3. aprendpoint ç»ä»¶",charIndex:7769},{level:3,title:"3.1. AprEndpoint å·¥ä½æµç¨",slug:"_3-1-aprendpoint-å·¥ä½æµç¨",normalizedTitle:"3.1. aprendpoint å·¥ä½æµç¨",charIndex:8655},{level:4,title:"3.1.1. Acceptor",slug:"_3-1-1-acceptor",normalizedTitle:"3.1.1. acceptor",charIndex:8682},{level:4,title:"3.1.2. Poller",slug:"_3-1-2-poller",normalizedTitle:"3.1.2. poller",charIndex:9767},{level:3,title:"3.2. APR æåæ§è½çç§å¯",slug:"_3-2-apr-æåæ§è½çç§å¯",normalizedTitle:"3.2. apr æåæ§è½çç§å¯",charIndex:10320},{level:4,title:"3.2.1. sendfile",slug:"_3-2-1-sendfile",normalizedTitle:"3.2.1. sendfile",charIndex:12292},{level:2,title:"4. Executor ç»ä»¶",slug:"_4-executor-ç»ä»¶",normalizedTitle:"4. executor ç»ä»¶",charIndex:12966},{level:3,title:"4.1. Tomcat å®å¶çº¿ç¨æ± ",slug:"_4-1-tomcat-å®å¶çº¿ç¨æ± ",normalizedTitle:"4.1. tomcat å®å¶çº¿ç¨æ± ",charIndex:13067},{level:3,title:"4.2. Tomcat å®å¶ä»»å¡éå",slug:"_4-2-tomcat-å®å¶ä»»å¡éå",normalizedTitle:"4.2. tomcat å®å¶ä»»å¡éå",charIndex:15220},{level:2,title:"5. WebSocket ç»ä»¶",slug:"_5-websocket-ç»ä»¶",normalizedTitle:"5. websocket ç»ä»¶",charIndex:17124},{level:3,title:"5.1. WebSocket å è½½",slug:"_5-1-websocket-å è½½",normalizedTitle:"5.1. websocket å è½½",charIndex:17531},{level:3,title:"5.2. WebSocket è¯·æ±å¤ç",slug:"_5-2-websocket-è¯·æ±å¤ç",normalizedTitle:"5.2. websocket è¯·æ±å¤ç",charIndex:18654},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:19738}],headersStr:"1. NioEndpoint ç»ä»¶ 1.1. LimitLatch 1.2. Acceptor 1.3. Poller 1.4. SocketProcessor 2. Nio2Endpoint ç»ä»¶ 2.1. Nio2Acceptor 2.2. Nio2SocketWrapper 3. AprEndpoint ç»ä»¶ 3.1. AprEndpoint å·¥ä½æµç¨ 3.1.1. Acceptor 3.1.2. Poller 3.2. APR æåæ§è½çç§å¯ 3.2.1. sendfile 4. Executor ç»ä»¶ 4.1. Tomcat å®å¶çº¿ç¨æ±  4.2. Tomcat å®å¶ä»»å¡éå 5. WebSocket ç»ä»¶ 5.1. WebSocket å è½½ 5.2. WebSocket è¯·æ±å¤ç 6. åèèµæ",content:'# Tomcat è¿æ¥å¨\n\n\n# 1. NioEndpoint ç»ä»¶\n\nTomcat ç NioEndPoint ç»ä»¶å©ç¨ Java NIO å®ç°äº I/O å¤è·¯å¤ç¨æ¨¡åã\n\n\n\nNioEndPoint å­ç»ä»¶åè½ç®ä»ï¼\n\n * LimitLatch æ¯è¿æ¥æ§å¶å¨ï¼è´è´£æ§å¶æå¤§è¿æ¥æ°ãNIO æ¨¡å¼ä¸é»è®¤æ¯ 10000ï¼è¾¾å°è¿ä¸ªéå¼åï¼è¿æ¥è¯·æ±è¢«æç»ã\n * Acceptor è´è´£çå¬è¿æ¥è¯·æ±ãAcceptor è¿è¡å¨ä¸ä¸ªåç¬ççº¿ç¨éï¼å®å¨ä¸ä¸ªæ­»å¾ªç¯éè°ç¨ accept æ¹æ³æ¥æ¥æ¶æ°è¿æ¥ï¼ä¸æ¦ææ°çè¿æ¥è¯·æ±å°æ¥ï¼accept æ¹æ³è¿åä¸ä¸ª Channel å¯¹è±¡ï¼æ¥çæ Channel å¯¹è±¡äº¤ç» Poller å»å¤çã\n * Poller çæ¬è´¨æ¯ä¸ä¸ª Selectorï¼ä¹è¿è¡å¨åç¬çº¿ç¨éãPoller åé¨ç»´æ¤ä¸ä¸ª Channel æ°ç»ï¼å®å¨ä¸ä¸ªæ­»å¾ªç¯éä¸æ­æ£æµ Channel çæ°æ®å°±ç»ªç¶æï¼ä¸æ¦æ Channel å¯è¯»ï¼å°±çæä¸ä¸ª SocketProcessor ä»»å¡å¯¹è±¡æç» Executor å»å¤çã\n * Executor å°±æ¯çº¿ç¨æ± ï¼è´è´£è¿è¡ SocketProcessor ä»»å¡ç±»ï¼SocketProcessor ç run æ¹æ³ä¼è°ç¨ Http11Processor æ¥è¯»ååè§£æè¯·æ±æ°æ®ãæä»¬ç¥éï¼Http11Processor æ¯åºç¨å±åè®®çå°è£ï¼å®ä¼è°ç¨å®¹å¨è·å¾ååºï¼åæååºéè¿ Channel ååºã\n\nNioEndpoint å¦ä½å®ç°é«å¹¶åçå¢ï¼\n\nè¦å®ç°é«å¹¶åéè¦åçè®¾è®¡çº¿ç¨æ¨¡åååå©ç¨ CPU èµæºï¼å°½éä¸è¦è®©çº¿ç¨é»å¡ï¼å¦å¤ï¼å°±æ¯æå¤å°ä»»å¡ï¼å°±ç¨ç¸åºè§æ¨¡ççº¿ç¨æ°å»å¤çã\n\nNioEndpoint è¦å®æä¸ä»¶äºæï¼æ¥æ¶è¿æ¥ãæ£æµ I/O äºä»¶ä»¥åå¤çè¯·æ±ï¼é£ä¹ææ ¸å¿çå°±æ¯æè¿ä¸ä»¶äºæåå¼ï¼ç¨ä¸åè§æ¨¡ççº¿ç¨å»å¤çï¼æ¯å¦ç¨ä¸é¨ççº¿ç¨ç»å»è· Acceptorï¼å¹¶ä¸ Acceptor çä¸ªæ°å¯ä»¥éç½®ï¼ç¨ä¸é¨ççº¿ç¨ç»å»è· Pollerï¼Poller çä¸ªæ°ä¹å¯ä»¥éç½®ï¼æåå·ä½ä»»å¡çæ§è¡ä¹ç±ä¸é¨ççº¿ç¨æ± æ¥å¤çï¼ä¹å¯ä»¥éç½®çº¿ç¨æ± çå¤§å°ã\n\n\n# 1.1. LimitLatch\n\nLimitLatch ç¨æ¥æ§å¶è¿æ¥ä¸ªæ°ï¼å½è¿æ¥æ°å°è¾¾æå¤§æ¶é»å¡çº¿ç¨ï¼ç´å°åç»­ç»ä»¶å¤çå®ä¸ä¸ªè¿æ¥åå°è¿æ¥æ°å 1ãè¯·ä½ æ³¨æå°è¾¾æå¤§è¿æ¥æ°åæä½ç³»ç»åºå±è¿æ¯ä¼æ¥æ¶å®¢æ·ç«¯è¿æ¥ï¼ä½ç¨æ·å±å·²ç»ä¸åæ¥æ¶ã\n\npublic class LimitLatch {\n    private class Sync extends AbstractQueuedSynchronizer {\n\n        @Override\n        protected int tryAcquireShared() {\n            long newCount = count.incrementAndGet();\n            if (newCount > limit) {\n                count.decrementAndGet();\n                return -1;\n            } else {\n                return 1;\n            }\n        }\n\n        @Override\n        protected boolean tryReleaseShared(int arg) {\n            count.decrementAndGet();\n            return true;\n        }\n    }\n\n    private final Sync sync;\n    private final AtomicLong count;\n    private volatile long limit;\n\n    // çº¿ç¨è°ç¨è¿ä¸ªæ¹æ³æ¥è·å¾æ¥æ¶æ°è¿æ¥çè®¸å¯ï¼çº¿ç¨å¯è½è¢«é»å¡\n    public void countUpOrAwait() throws InterruptedException {\n      sync.acquireSharedInterruptibly(1);\n    }\n\n    // è°ç¨è¿ä¸ªæ¹æ³æ¥éæ¾ä¸ä¸ªè¿æ¥è®¸å¯ï¼é£ä¹åé¢é»å¡ççº¿ç¨å¯è½è¢«å¤é\n    public long countDown() {\n      sync.releaseShared(0);\n      long result = getCount();\n      return result;\n   }\n}\n\n\nLimitLatch åæ­¥å®ä¹äºåé¨ç±» Syncï¼è Sync æ©å±äº AQSï¼AQS æ¯ Java å¹¶ååä¸­çä¸ä¸ªæ ¸å¿ç±»ï¼å®å¨åé¨ç»´æ¤ä¸ä¸ªç¶æåä¸ä¸ªçº¿ç¨éåï¼å¯ä»¥ç¨æ¥æ§å¶çº¿ç¨ä»ä¹æ¶åæèµ·ï¼ä»ä¹æ¶åå¤éãæä»¬å¯ä»¥æ©å±å®æ¥å®ç°èªå·±çåæ­¥å¨ï¼å®éä¸ Java å¹¶ååéçéåæ¡ä»¶åéç­ç­é½æ¯éè¿ AQS æ¥å®ç°çï¼èè¿éç LimitLatch ä¹ä¸ä¾å¤ã\n\nçè§£æºç è¦ç¹ï¼\n\n * ç¨æ·çº¿ç¨éè¿è°ç¨ LimitLatch ç countUpOrAwait æ¹æ³æ¥æ¿å°éï¼å¦æææ¶æ æ³è·åï¼è¿ä¸ªçº¿ç¨ä¼è¢«é»å¡å° AQS çéåä¸­ãé£ AQS æä¹ç¥éæ¯é»å¡è¿æ¯ä¸é»å¡ç¨æ·çº¿ç¨å¢ï¼å¶å®è¿æ¯ç± AQS çä½¿ç¨èæ¥å³å®çï¼ä¹å°±æ¯åé¨ç±» Sync æ¥å³å®çï¼å ä¸º Sync ç±»éåäº AQS çtryAcquireShared() æ¹æ³ãå®çå®ç°é»è¾æ¯å¦æå½åè¿æ¥æ° count å°äº limitï¼çº¿ç¨è½è·åéï¼è¿å 1ï¼å¦åè¿å -1ã\n * å¦ä½ç¨æ·çº¿ç¨è¢«é»å¡å°äº AQS çéåï¼é£ä»ä¹æ¶åå¤éå¢ï¼åæ ·æ¯ç± Sync åé¨ç±»å³å®ï¼Sync éåäº AQS çreleaseShared() æ¹æ³ï¼å¶å®å°±æ¯å½ä¸ä¸ªè¿æ¥è¯·æ±å¤çå®äºï¼è¿æ¶åå¯ä»¥æ¥æ¶ä¸ä¸ªæ°è¿æ¥äºï¼è¿æ ·åé¢é»å¡ççº¿ç¨å°ä¼è¢«å¤éã\n\n\n# 1.2. Acceptor\n\nAcceptor å®ç°äº Runnable æ¥å£ï¼å æ­¤å¯ä»¥è·å¨åç¬çº¿ç¨éãä¸ä¸ªç«¯å£å·åªè½å¯¹åºä¸ä¸ª ServerSocketChannelï¼å æ­¤è¿ä¸ª ServerSocketChannel æ¯å¨å¤ä¸ª Acceptor çº¿ç¨ä¹é´å±äº«çï¼å®æ¯ Endpoint çå±æ§ï¼ç± Endpoint å®æåå§ååç«¯å£ç»å®ã\n\nserverSock = ServerSocketChannel.open();\nserverSock.socket().bind(addr,getAcceptCount());\nserverSock.configureBlocking(true);\n\n\n * bind æ¹æ³çç¬¬äºä¸ªåæ°è¡¨ç¤ºæä½ç³»ç»çç­å¾éåé¿åº¦ï¼æå¨ä¸é¢æå°ï¼å½åºç¨å±é¢çè¿æ¥æ°å°è¾¾æå¤§å¼æ¶ï¼æä½ç³»ç»å¯ä»¥ç»§ç»­æ¥æ¶è¿æ¥ï¼é£ä¹æä½ç³»ç»è½ç»§ç»­æ¥æ¶çæå¤§è¿æ¥æ°å°±æ¯è¿ä¸ªéåé¿åº¦ï¼å¯ä»¥éè¿ acceptCount åæ°éç½®ï¼é»è®¤æ¯ 100ã\n * ServerSocketChannel è¢«è®¾ç½®æé»å¡æ¨¡å¼ï¼ä¹å°±æ¯è¯´å®æ¯ä»¥é»å¡çæ¹å¼æ¥æ¶è¿æ¥çãServerSocketChannel éè¿ accept() æ¥åæ°çè¿æ¥ï¼accept() æ¹æ³è¿åè·å¾ SocketChannel å¯¹è±¡ï¼ç¶åå° SocketChannel å¯¹è±¡å°è£å¨ä¸ä¸ª PollerEvent å¯¹è±¡ä¸­ï¼å¹¶å° PollerEvent å¯¹è±¡åå¥ Poller ç Queue éï¼è¿æ¯ä¸ªå¸åççäº§è - æ¶è´¹èæ¨¡å¼ï¼Acceptor ä¸ Poller çº¿ç¨ä¹é´éè¿ Queue éä¿¡ã\n\n\n# 1.3. Poller\n\nPoller æ¬è´¨æ¯ä¸ä¸ª Selectorï¼å®åé¨ç»´æ¤ä¸ä¸ª Queueã\n\nprivate final SynchronizedQueue<PollerEvent> events = new SynchronizedQueue<>();\n\n\nSynchronizedQueue çæ ¸å¿æ¹æ³é½ä½¿ç¨äº Synchronized å³é®å­è¿è¡ä¿®é¥°ï¼ç¨æ¥ä¿è¯åä¸æ¶å»åªæä¸ä¸ªçº¿ç¨è¿è¡è¯»åã\n\nä½¿ç¨ SynchronizedQueueï¼æå³çåä¸æ¶å»åªæä¸ä¸ª Acceptor çº¿ç¨å¯¹éåè¿è¡è¯»åï¼åæ¶æå¤ä¸ª Poller çº¿ç¨å¨è¿è¡ï¼æ¯ä¸ª Poller çº¿ç¨é½æèªå·±çéåãæ¯ä¸ª Poller çº¿ç¨å¯è½åæ¶è¢«å¤ä¸ª Acceptor çº¿ç¨è°ç¨æ¥æ³¨å PollerEventãåæ · Poller çä¸ªæ°å¯ä»¥éè¿ pollers åæ°éç½®ã\n\nPoller ä¸æ­çéè¿åé¨ç Selector å¯¹è±¡ååæ ¸æ¥è¯¢ Channel çç¶æï¼ä¸æ¦å¯è¯»å°±çæä»»å¡ç±» SocketProcessor äº¤ç» Executor å»å¤çãPoller çå¦ä¸ä¸ªéè¦ä»»å¡æ¯å¾ªç¯éåæ£æ¥èªå·±æç®¡çç SocketChannel æ¯å¦å·²ç»è¶æ¶ï¼å¦ææè¶æ¶å°±å³é­è¿ä¸ª SocketChannelã\n\n\n# 1.4. SocketProcessor\n\næä»¬ç¥éï¼Poller ä¼åå»º SocketProcessor ä»»å¡ç±»äº¤ç»çº¿ç¨æ± å¤çï¼è SocketProcessor å®ç°äº Runnable æ¥å£ï¼ç¨æ¥å®ä¹ Executor ä¸­çº¿ç¨ææ§è¡çä»»å¡ï¼ä¸»è¦å°±æ¯è°ç¨ Http11Processor ç»ä»¶æ¥å¤çè¯·æ±ãHttp11Processor è¯»å Channel çæ°æ®æ¥çæ ServletRequest å¯¹è±¡ï¼è¿éè¯·ä½ æ³¨æï¼\n\nHttp11Processor å¹¶ä¸æ¯ç´æ¥è¯»å Channel çãè¿æ¯å ä¸º Tomcat æ¯æåæ­¥éé»å¡ I/O æ¨¡ååå¼æ­¥ I/O æ¨¡åï¼å¨ Java API ä¸­ï¼ç¸åºç Channel ç±»ä¹æ¯ä¸ä¸æ ·çï¼æ¯å¦æ AsynchronousSocketChannel å SocketChannelï¼ä¸ºäºå¯¹ Http11Processor å±è½è¿äºå·®å¼ï¼Tomcat è®¾è®¡äºä¸ä¸ªåè£ç±»å«ä½ SocketWrapperï¼Http11Processor åªè°ç¨ SocketWrapper çæ¹æ³å»è¯»åæ°æ®ã\n\n\n# 2. Nio2Endpoint ç»ä»¶\n\nNio2Endpoint å·¥ä½æµç¨è· NioEndpoint è¾ä¸ºç¸ä¼¼ã\n\n\n\nNio2Endpoint å­ç»ä»¶åè½è¯´æï¼\n\n * LimitLatch æ¯è¿æ¥æ§å¶å¨ï¼å®è´è´£æ§å¶æå¤§è¿æ¥æ°ã\n * Nio2Acceptor æ©å±äº Acceptorï¼ç¨å¼æ­¥ I/O çæ¹å¼æ¥æ¥æ¶è¿æ¥ï¼è·å¨ä¸ä¸ªåç¬ççº¿ç¨éï¼ä¹æ¯ä¸ä¸ªçº¿ç¨ç»ãNio2Acceptor æ¥æ¶æ°çè¿æ¥åï¼å¾å°ä¸ä¸ª AsynchronousSocketChannelï¼Nio2Acceptor æ AsynchronousSocketChannel å°è£æä¸ä¸ª Nio2SocketWrapperï¼å¹¶åå»ºä¸ä¸ª SocketProcessor ä»»å¡ç±»äº¤ç»çº¿ç¨æ± å¤çï¼å¹¶ä¸ SocketProcessor ææ Nio2SocketWrapper å¯¹è±¡ã\n * Executor å¨æ§è¡ SocketProcessor æ¶ï¼SocketProcessor ç run æ¹æ³ä¼è°ç¨ Http11Processor æ¥å¤çè¯·æ±ï¼Http11Processor ä¼éè¿ Nio2SocketWrapper è¯»ååè§£æè¯·æ±æ°æ®ï¼è¯·æ±ç»è¿å®¹å¨å¤çåï¼åæååºéè¿ Nio2SocketWrapper ååºã\n\nNio2Endpoint è· NioEndpoint çä¸ä¸ªææ¾ä¸åç¹æ¯ï¼Nio2Endpoint ä¸­æ²¡æ Poller ç»ä»¶ï¼ä¹å°±æ¯æ²¡æ Selectorãè¿æ¯ä¸ºä»ä¹å¢ï¼å ä¸ºå¨å¼æ­¥ I/O æ¨¡å¼ä¸ï¼Selector çå·¥ä½äº¤ç»åæ ¸æ¥åäºã\n\n\n# 2.1. Nio2Acceptor\n\nå NioEndpint ä¸æ ·ï¼Nio2Endpoint çåºæ¬æè·¯æ¯ç¨ LimitLatch ç»ä»¶æ¥æ§å¶è¿æ¥æ°ã\n\nä½æ¯ Nio2Acceptor ççå¬è¿æ¥çè¿ç¨ä¸æ¯å¨ä¸ä¸ªæ­»å¾ªç¯éä¸æ­çè° accept æ¹æ³ï¼èæ¯éè¿åè°å½æ°æ¥å®æçãæä»¬æ¥ççå®çè¿æ¥çå¬æ¹æ³ï¼\n\nserverSock.accept(null, this);\n\n\nå¶å®å°±æ¯è°ç¨äº accept æ¹æ³ï¼æ³¨æå®çç¬¬äºä¸ªåæ°æ¯ thisï¼è¡¨æ Nio2Acceptor èªå·±å°±æ¯å¤çè¿æ¥çåè°ç±»ï¼å æ­¤ Nio2Acceptor å®ç°äº CompletionHandler æ¥å£ãé£ä¹å®æ¯å¦ä½å®ç° CompletionHandler æ¥å£çå¢ï¼\n\nprotected class Nio2Acceptor extends Acceptor<AsynchronousSocketChannel>\n    implements CompletionHandler<AsynchronousSocketChannel, Void> {\n\n    @Override\n    public void completed(AsynchronousSocketChannel socket,\n        Void attachment) {\n\n        if (isRunning() && !isPaused()) {\n            if (getMaxConnections() == -1) {\n                // å¦ææ²¡æè¿æ¥éå¶ï¼ç»§ç»­æ¥æ¶æ°çè¿æ¥\n                serverSock.accept(null, this);\n            } else {\n                // å¦ææè¿æ¥éå¶ï¼å°±å¨çº¿ç¨æ± éè· Run æ¹æ³ï¼Run æ¹æ³ä¼æ£æ¥è¿æ¥æ°\n                getExecutor().execute(this);\n            }\n            // å¤çè¯·æ±\n            if (!setSocketOptions(socket)) {\n                closeSocket(socket);\n            }\n        }\n    }\n}\n\n\nå¯ä»¥çå° CompletionHandler çä¸¤ä¸ªæ¨¡æ¿åæ°åå«æ¯ AsynchronousServerSocketChannel å Voidï¼æå¨åé¢è¯´è¿ç¬¬ä¸ä¸ªåæ°å°±æ¯ accept æ¹æ³çè¿åå¼ï¼ç¬¬äºä¸ªåæ°æ¯éä»¶ç±»ï¼ç±ç¨æ·èªå·±å³å®ï¼è¿éä¸º Voidãcompleted æ¹æ³çå¤çé»è¾æ¯è¾ç®åï¼\n\n * å¦ææ²¡æè¿æ¥éå¶ï¼ç»§ç»­å¨æ¬çº¿ç¨ä¸­è°ç¨ accept æ¹æ³æ¥æ¶æ°çè¿æ¥ã\n * å¦ææè¿æ¥éå¶ï¼å°±å¨çº¿ç¨æ± éè· run æ¹æ³å»æ¥æ¶æ°çè¿æ¥ãé£ä¸ºä»ä¹è¦è· run æ¹æ³å¢ï¼å ä¸ºå¨ run æ¹æ³éä¼æ£æ¥è¿æ¥æ°ï¼å½è¿æ¥è¾¾å°æå¤§æ°æ¶ï¼çº¿ç¨å¯è½ä¼è¢« LimitLatch é»å¡ãä¸ºä»ä¹è¦æ¾å¨çº¿ç¨æ± éè·å¢ï¼è¿æ¯å ä¸ºå¦ææ¾å¨å½åçº¿ç¨éæ§è¡ï¼completed æ¹æ³å¯è½è¢«é»å¡ï¼ä¼å¯¼è´è¿ä¸ªåè°æ¹æ³ä¸ç´ä¸è¿åã\n\næ¥ç completed æ¹æ³ä¼è°ç¨ setSocketOptions æ¹æ³ï¼å¨è¿ä¸ªæ¹æ³éï¼ä¼åå»º Nio2SocketWrapper å SocketProcessorï¼å¹¶äº¤ç»çº¿ç¨æ± å¤çã\n\n\n# 2.2. Nio2SocketWrapper\n\nNio2SocketWrapper çä¸»è¦ä½ç¨æ¯å°è£ Channelï¼å¹¶æä¾æ¥å£ç» Http11Processor è¯»åæ°æ®ãè®²å°è¿éä½ æ¯ä¸æ¯æä¸ªçé®ï¼Http11Processor æ¯ä¸è½é»å¡ç­å¾æ°æ®çï¼æç§å¼æ­¥ I/O çå¥è·¯ï¼Http11Processor å¨è°ç¨ Nio2SocketWrapper ç read æ¹æ³æ¶éè¦æ³¨ååè°ç±»ï¼read è°ç¨ä¼ç«å³è¿åï¼é®é¢æ¯ç«å³è¿åå Http11Processor è¿æ²¡æè¯»å°æ°æ®ï¼ æä¹åå¢ï¼è¿ä¸ªè¯·æ±çå¤çä¸å°±å¤±è´¥äºåï¼\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼Http11Processor æ¯éè¿ 2 æ¬¡ read è°ç¨æ¥å®ææ°æ®è¯»åæä½çã\n\n * ç¬¬ä¸æ¬¡ read è°ç¨ï¼è¿æ¥ååå»ºç«å¥½åï¼Acceptor åå»º SocketProcessor ä»»å¡ç±»äº¤ç»çº¿ç¨æ± å»å¤çï¼Http11Processor å¨å¤çè¯·æ±çè¿ç¨ä¸­ï¼ä¼è°ç¨ Nio2SocketWrapper ç read æ¹æ³ååºç¬¬ä¸æ¬¡è¯»è¯·æ±ï¼åæ¶æ³¨åäºåè°ç±» readCompletionHandlerï¼å ä¸ºæ°æ®æ²¡è¯»å°ï¼Http11Processor æå½åç Nio2SocketWrapper æ è®°ä¸ºæ°æ®ä¸å®æ´ãæ¥ç SocketProcessor çº¿ç¨è¢«åæ¶ï¼Http11Processor å¹¶æ²¡æé»å¡ç­å¾æ°æ®ãè¿éè¯·æ³¨æï¼Http11Processor ç»´æ¤äºä¸ä¸ª Nio2SocketWrapper åè¡¨ï¼ä¹å°±æ¯ç»´æ¤äºè¿æ¥çç¶æã\n * ç¬¬äºæ¬¡ read è°ç¨ï¼å½æ°æ®å°è¾¾åï¼åæ ¸å·²ç»ææ°æ®æ·è´å° Http11Processor æå®ç Buffer éï¼åæ¶åè°ç±» readCompletionHandler è¢«è°ç¨ï¼å¨è¿ä¸ªåè°å¤çæ¹æ³éä¼éæ°åå»ºä¸ä¸ªæ°ç SocketProcessor ä»»å¡æ¥ç»§ç»­å¤çè¿ä¸ªè¿æ¥ï¼èè¿ä¸ªæ°ç SocketProcessor ä»»å¡ç±»ææåæ¥é£ä¸ª Nio2SocketWrapperï¼è¿ä¸æ¬¡ Http11Processor å¯ä»¥éè¿ Nio2SocketWrapper è¯»åæ°æ®äºï¼å ä¸ºæ°æ®å·²ç»å°äºåºç¨å±ç Bufferã\n\nè¿ä¸ªåè°ç±» readCompletionHandler çæºç å¦ä¸ï¼æå³é®çä¸ç¹æ¯ï¼Nio2SocketWrapper æ¯ä½ä¸ºéä»¶ç±»æ¥ä¼ éçï¼è¿æ ·å¨åè°å½æ°éè½æ¿å°ææçä¸ä¸æã\n\nthis.readCompletionHandler = new CompletionHandler<Integer, SocketWrapperBase<Nio2Channel>>() {\n    public void completed(Integer nBytes, SocketWrapperBase<Nio2Channel> attachment) {\n        ...\n        // éè¿éä»¶ç±» SocketWrapper æ¿å°ææçä¸ä¸æ\n        Nio2SocketWrapper.this.getEndpoint().processSocket(attachment, SocketEvent.OPEN_READ, false);\n    }\n\n    public void failed(Throwable exc, SocketWrapperBase<Nio2Channel> attachment) {\n        ...\n    }\n}\n\n\n\n# 3. AprEndpoint ç»ä»¶\n\næä»¬å¨ä½¿ç¨ Tomcat æ¶ï¼å¯è½ä¼å¨å¯å¨æ¥å¿éçå°è¿æ ·çæç¤ºä¿¡æ¯ï¼\n\n> The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: ***\n\nè¿å¥è¯çææå°±æ¯æ¨èä½ å»å®è£ APR åºï¼å¯ä»¥æé«ç³»ç»æ§è½ã\n\nAPRï¼Apache Portable Runtime Librariesï¼æ¯ Apache å¯ç§»æ¤è¿è¡æ¶åºï¼å®æ¯ç¨ C è¯­è¨å®ç°çï¼å¶ç®çæ¯åä¸å±åºç¨ç¨åºæä¾ä¸ä¸ªè·¨å¹³å°çæä½ç³»ç»æ¥å£åºãTomcat å¯ä»¥ç¨å®æ¥å¤çåæ¬æä»¶åç½ç» I/Oï¼ä»èæåæ§è½ãTomcat æ¯æçè¿æ¥å¨æ NIOãNIO.2 å APRãè· NioEndpoint ä¸æ ·ï¼AprEndpoint ä¹å®ç°äºéé»å¡ I/Oï¼å®ä»¬çåºå«æ¯ï¼NioEndpoint éè¿è°ç¨ Java ç NIO API æ¥å®ç°éé»å¡ I/Oï¼è AprEndpoint æ¯éè¿ JNI è°ç¨ APR æ¬å°åºèå®ç°éé»å¡ I/O çã\n\nåæ ·æ¯éé»å¡ I/Oï¼ä¸ºä»ä¹ Tomcat ä¼æç¤ºä½¿ç¨ APR æ¬å°åºçæ§è½ä¼æ´å¥½å¢ï¼è¿æ¯å ä¸ºå¨æäºåºæ¯ä¸ï¼æ¯å¦éè¦é¢ç¹ä¸æä½ç³»ç»è¿è¡äº¤äºï¼Socket ç½ç»éä¿¡å°±æ¯è¿æ ·ä¸ä¸ªåºæ¯ï¼ç¹å«æ¯å¦æä½ ç Web åºç¨ä½¿ç¨äº TLS æ¥å å¯ä¼ è¾ï¼æä»¬ç¥é TLS åè®®å¨æ¡æè¿ç¨ä¸­æå¤æ¬¡ç½ç»äº¤äºï¼å¨è¿ç§æåµä¸ Java è· C è¯­è¨ç¨åºç¸æ¯è¿æ¯æä¸å®çå·®è·ï¼èè¿æ­£æ¯ APR çå¼ºé¡¹ã\n\nTomcat æ¬èº«æ¯ Java ç¼åçï¼ä¸ºäºè°ç¨ C è¯­è¨ç¼åç APRï¼éè¦éè¿ JNI æ¹å¼æ¥è°ç¨ãJNIï¼Java Native Interfaceï¼ æ¯ JDK æä¾çä¸ä¸ªç¼ç¨æ¥å£ï¼å®åè®¸ Java ç¨åºè°ç¨å¶ä»è¯­è¨ç¼åçç¨åºæèä»£ç åºï¼å¶å® JDK æ¬èº«çå®ç°ä¹å¤§éç¨å° JNI ææ¯æ¥è°ç¨æ¬å° C ç¨åºåºã\n\n\n# 3.1. AprEndpoint å·¥ä½æµç¨\n\n\n\n# 3.1.1. Acceptor\n\nAccpetor çåè½å°±æ¯çå¬è¿æ¥ï¼æ¥æ¶å¹¶å»ºç«è¿æ¥ãå®çæ¬è´¨å°±æ¯è°ç¨äºåä¸ªæä½ç³»ç» APIï¼socketãbindãlisten å acceptãé£ Java è¯­è¨å¦ä½ç´æ¥è°ç¨ C è¯­è¨ API å¢ï¼ç­æ¡å°±æ¯éè¿ JNIãå·ä½æ¥è¯´å°±æ¯ä¸¤æ­¥ï¼åå°è£ä¸ä¸ª Java ç±»ï¼å¨éé¢å®ä¹ä¸å ç¨native å³é®å­ä¿®é¥°çæ¹æ³ï¼åä¸é¢è¿æ ·ã\n\npublic class Socket {\n  ...\n  // ç¨ native ä¿®é¥°è¿ä¸ªæ¹æ³ï¼è¡¨æè¿ä¸ªå½æ°æ¯ C è¯­è¨å®ç°\n  public static native long create(int family, int type,\n                                 int protocol, long cont)\n\n  public static native int bind(long sock, long sa);\n\n  public static native int listen(long sock, int backlog);\n\n  public static native long accept(long sock)\n}\n\n\næ¥çç¨ C ä»£ç å®ç°è¿äºæ¹æ³ï¼æ¯å¦ bind å½æ°å°±æ¯è¿æ ·å®ç°çï¼\n\n// æ³¨æå½æ°çåå­è¦ç¬¦å JNI è§èçè¦æ±\nJNIEXPORT jint JNICALL\nJava_org_apache_tomcat_jni_Socket_bind(JNIEnv *e, jlong sock,jlong sa)\n\t{\n\t    jint rv = APR_SUCCESS;\n\t    tcn_socket_t *s = (tcn_socket_t *ï¼sock;\n\t    apr_sockaddr_t *a = (apr_sockaddr_t *) sa;\n\n        // è°ç¨ APR åºèªå·±å®ç°ç bind å½æ°\n\t    rv = (jint)apr_socket_bind(s->sock, a);\n\t    return rv;\n\t}\n\n\nä¸æ éæå°±ä¸å±å¼ JNI çç»èäºï¼ä½ å¯ä»¥æ©å±éè¯»è·å¾æ´å¤ä¿¡æ¯åä¾å­ãæä»¬è¦æ³¨æçæ¯å½æ°åå­è¦ç¬¦å JNI çè§èï¼ä»¥å Java å C è¯­è¨å¦ä½äºç¸ä¼ éåæ°ï¼æ¯å¦å¨ C è¯­è¨ææéï¼Java æ²¡ææéçæ¦å¿µï¼æä»¥å¨ Java ä¸­ç¨ long ç±»åæ¥è¡¨ç¤ºæéãAprEndpoint ç Acceptor ç»ä»¶å°±æ¯è°ç¨äº APR å®ç°çåä¸ª APIã\n\n# 3.1.2. Poller\n\nAcceptor æ¥æ¶å°ä¸ä¸ªæ°ç Socket è¿æ¥åï¼æç§ NioEndpoint çå®ç°ï¼å®ä¼æè¿ä¸ª Socket äº¤ç» Poller å»æ¥è¯¢ I/O äºä»¶ãAprEndpoint ä¹æ¯è¿æ ·åçï¼ä¸è¿ AprEndpoint ç Poller å¹¶ä¸æ¯è°ç¨ Java NIO éç Selector æ¥æ¥è¯¢ Socket çç¶æï¼èæ¯éè¿ JNI è°ç¨ APR ä¸­ç poll æ¹æ³ï¼è APR åæ¯è°ç¨äºæä½ç³»ç»ç epoll API æ¥å®ç°çã\n\nè¿éæä¸ªç¹å«çå°æ¹æ¯å¨ AprEndpoint ä¸­ï¼æä»¬å¯ä»¥éç½®ä¸ä¸ªå«deferAcceptçåæ°ï¼å®å¯¹åºçæ¯ TCP åè®®ä¸­çTCP_DEFER_ACCEPTï¼è®¾ç½®è¿ä¸ªåæ°åï¼å½ TCP å®¢æ·ç«¯ææ°çè¿æ¥è¯·æ±å°è¾¾æ¶ï¼TCP æå¡ç«¯åä¸å»ºç«è¿æ¥ï¼èæ¯åç­ç­ï¼ç´å°å®¢æ·ç«¯æè¯·æ±æ°æ®åè¿æ¥æ¶åå»ºç«è¿æ¥ãè¿æ ·çå¥½å¤æ¯æå¡ç«¯ä¸éè¦ç¨ Selector å»åå¤æ¥è¯¢è¯·æ±æ°æ®æ¯å¦å°±ç»ªã\n\nè¿æ¯ä¸ç§ TCP åè®®å±çä¼åï¼ä¸æ¯æ¯ä¸ªæä½ç³»ç»åæ ¸é½æ¯æï¼å ä¸º Java ä½ä¸ºä¸ç§è·¨å¹³å°è¯­è¨ï¼éè¦å±è½åç§æä½ç³»ç»çå·®å¼ï¼å æ­¤å¹¶æ²¡ææè¿ä¸ªåæ°æä¾ç»ç¨æ·ï¼ä½æ¯å¯¹äº APR æ¥è¯´ï¼å®çç®çå°±æ¯å°½å¯è½æåæ§è½ï¼å æ­¤å®åç¨æ·æ´é²äºè¿ä¸ªåæ°ã\n\n\n# 3.2. APR æåæ§è½çç§å¯\n\nAPR è¿æ¥å¨ä¹æä»¥è½æé« Tomcat çæ§è½ï¼é¤äº APR æ¬èº«æ¯ C ç¨åºåºä¹å¤ï¼è¿æåªäºæéçç§å¯å¢ï¼\n\nJVM å  VS æ¬å°åå­\n\næä»¬ç¥é Java çç±»å®ä¾ä¸è¬å¨ JVM å ä¸åéï¼è Java æ¯éè¿ JNI è°ç¨ C ä»£ç æ¥å®ç° Socket éä¿¡çï¼é£ä¹ C ä»£ç å¨è¿è¡è¿ç¨ä¸­éè¦çåå­åæ¯ä»åªéåéçå¢ï¼C ä»£ç è½å¦ç´æ¥æä½ Java å ï¼\n\nä¸ºäºåç­è¿äºé®é¢ï¼æåæ¥è¯´è¯´ JVM åç¨æ·è¿ç¨çå³ç³»ãå¦æä½ æ³è¿è¡ä¸ä¸ª Java ç±»æä»¶ï¼å¯ä»¥ç¨ä¸é¢ç Java å½ä»¤æ¥æ§è¡ã\n\njava my.class\n\n\nè¿ä¸ªå½ä»¤è¡ä¸­çjavaå¶å®æ¯ä¸ä¸ªå¯æ§è¡ç¨åºï¼è¿ä¸ªç¨åºä¼åå»º JVM æ¥å è½½åè¿è¡ä½ ç Java ç±»ãæä½ç³»ç»ä¼åå»ºä¸ä¸ªè¿ç¨æ¥æ§è¡è¿ä¸ªjavaå¯æ§è¡ç¨åºï¼èæ¯ä¸ªè¿ç¨é½æèªå·±çèæå°åç©ºé´ï¼JVM ç¨å°çåå­ï¼åæ¬å ãæ åæ¹æ³åºï¼å°±æ¯ä»è¿ç¨çèæå°åç©ºé´ä¸åéçãè¯·ä½ æ³¨æçæ¯ï¼JVM åå­åªæ¯è¿ç¨ç©ºé´çä¸é¨åï¼é¤æ­¤ä¹å¤è¿ç¨ç©ºé´åè¿æä»£ç æ®µãæ°æ®æ®µãåå­æ å°åºãåæ ¸ç©ºé´ç­ãä» JVM çè§åº¦çï¼JVM åå­ä¹å¤çé¨åå«ä½æ¬å°åå­ï¼C ç¨åºä»£ç å¨è¿è¡è¿ç¨ä¸­ç¨å°çåå­å°±æ¯æ¬å°åå­ä¸­åéçãä¸é¢æä»¬éè¿ä¸å¼ å¾æ¥çè§£ä¸ä¸ã\n\n\n\nTomcat ç Endpoint ç»ä»¶å¨æ¥æ¶ç½ç»æ°æ®æ¶éè¦é¢ååéå¥½ä¸å Bufferï¼æè°ç Buffer å°±æ¯å­èæ°ç»byte[]ï¼Java éè¿ JNI è°ç¨æè¿å Buffer çå°åä¼ ç» C ä»£ç ï¼C ä»£ç éè¿æä½ç³»ç» API è¯»å Socket å¹¶ææ°æ®å¡«åå°è¿å BufferãJava NIO API æä¾äºä¸¤ç§ Buffer æ¥æ¥æ¶æ°æ®ï¼HeapByteBuffer å DirectByteBufferï¼ä¸é¢çä»£ç æ¼ç¤ºäºå¦ä½åå»ºä¸¤ç§ Bufferã\n\n// åé HeapByteBuffer\nByteBuffer buf = ByteBuffer.allocate(1024);\n\n// åé DirectByteBuffer\nByteBuffer buf = ByteBuffer.allocateDirect(1024);\n\n\nåå»ºå¥½ Buffer åç´æ¥ä¼ ç» Channel ç read æè write å½æ°ï¼æç»è¿å Buffer ä¼éè¿ JNI è°ç¨ä¼ éç» C ç¨åºã\n\n// å° buf ä½ä¸º read å½æ°çåæ°\nint bytesRead = socketChannel.read(buf);\n\n\né£ HeapByteBuffer å DirectByteBuffer æä»ä¹åºå«å¢ï¼HeapByteBuffer å¯¹è±¡æ¬èº«å¨ JVM å ä¸åéï¼å¹¶ä¸å®ææçå­èæ°ç»byte[]ä¹æ¯å¨ JVM å ä¸åéãä½æ¯å¦æç¨HeapByteBufferæ¥æ¥æ¶ç½ç»æ°æ®ï¼éè¦ææ°æ®ä»åæ ¸åæ·è´å°ä¸ä¸ªä¸´æ¶çæ¬å°åå­ï¼åä»ä¸´æ¶æ¬å°åå­æ·è´å° JVM å ï¼èä¸æ¯ç´æ¥ä»åæ ¸æ·è´å° JVM å ä¸ãè¿æ¯ä¸ºä»ä¹å¢ï¼è¿æ¯å ä¸ºæ°æ®ä»åæ ¸æ·è´å° JVM å çè¿ç¨ä¸­ï¼JVM å¯è½ä¼åç GCï¼GC è¿ç¨ä¸­å¯¹è±¡å¯è½ä¼è¢«ç§»å¨ï¼ä¹å°±æ¯è¯´ JVM å ä¸çå­èæ°ç»å¯è½ä¼è¢«ç§»å¨ï¼è¿æ ·çè¯ Buffer å°åå°±å¤±æäºãå¦æè¿ä¸­é´ç»è¿æ¬å°åå­ä¸­è½¬ï¼ä»æ¬å°åå­å° JVM å çæ·è´è¿ç¨ä¸­ JVM å¯ä»¥ä¿è¯ä¸å GCã\n\nå¦æä½¿ç¨ HeapByteBufferï¼ä½ ä¼åç° JVM å ååæ ¸ä¹é´å¤äºä¸å±ä¸­è½¬ï¼è DirectByteBuffer ç¨æ¥è§£å³è¿ä¸ªé®é¢ï¼DirectByteBuffer å¯¹è±¡æ¬èº«å¨ JVM å ä¸ï¼ä½æ¯å®ææçå­èæ°ç»ä¸æ¯ä» JVM å ä¸åéçï¼èæ¯ä»æ¬å°åå­åéçãDirectByteBuffer å¯¹è±¡ä¸­æä¸ª long ç±»åå­æ®µ addressï¼è®°å½çæ¬å°åå­çå°åï¼è¿æ ·å¨æ¥æ¶æ°æ®çæ¶åï¼ç´æ¥æè¿ä¸ªæ¬å°åå­å°åä¼ éç» C ç¨åºï¼C ç¨åºä¼å°ç½ç»æ°æ®ä»åæ ¸æ·è´å°è¿ä¸ªæ¬å°åå­ï¼JVM å¯ä»¥ç´æ¥è¯»åè¿ä¸ªæ¬å°åå­ï¼è¿ç§æ¹å¼æ¯ HeapByteBuffer å°äºä¸æ¬¡æ·è´ï¼å æ­¤ä¸è¬æ¥è¯´å®çéåº¦ä¼æ¯ HeapByteBuffer å¿«å¥½å åãä½ å¯ä»¥éè¿ä¸é¢çå¾å æ·±çè§£ã\n\nTomcat ä¸­ç AprEndpoint å°±æ¯éè¿ DirectByteBuffer æ¥æ¥æ¶æ°æ®çï¼è NioEndpoint å Nio2Endpoint æ¯éè¿ HeapByteBuffer æ¥æ¥æ¶æ°æ®çãä½ å¯è½ä¼é®ï¼NioEndpoint å Nio2Endpoint ä¸ºä»ä¹ä¸ç¨ DirectByteBuffer å¢ï¼è¿æ¯å ä¸ºæ¬å°åå­ä¸å¥½ç®¡çï¼åçåå­æ³æ¼é¾ä»¥å®ä½ï¼ä»ç¨³å®æ§èèï¼NioEndpoint å Nio2Endpoint æ²¡æå»åè¿ä¸ªé©ã\n\n# 3.2.1. sendfile\n\næä»¬åæ¥èèå¦ä¸ä¸ªç½ç»éä¿¡çåºæ¯ï¼ä¹å°±æ¯éææä»¶çå¤çãæµè§å¨éè¿ Tomcat æ¥è·åä¸ä¸ª HTML æä»¶ï¼è Tomcat çå¤çé»è¾æ éæ¯ä¸¤æ­¥ï¼\n\n 1. ä»ç£çè¯»å HTML å°åå­ã\n 2. å°è¿æ®µåå­çåå®¹éè¿ Socket åéåºå»ã\n\nä½æ¯å¨ä¼ ç»æ¹å¼ä¸ï¼æå¾å¤æ¬¡çåå­æ·è´ï¼\n\n * è¯»åæä»¶æ¶ï¼é¦åæ¯åæ ¸ææä»¶åå®¹è¯»åå°åæ ¸ç¼å²åºã\n * å¦æä½¿ç¨ HeapByteBufferï¼æä»¶æ°æ®ä»åæ ¸å° JVM å åå­éè¦ç»è¿æ¬å°åå­ä¸­è½¬ã\n * åæ ·å¨å°æä»¶åå®¹æ¨å¥ç½ç»æ¶ï¼ä» JVM å å°åæ ¸ç¼å²åºéè¦ç»è¿æ¬å°åå­ä¸­è½¬ã\n * æåè¿éè¦ææä»¶ä»åæ ¸ç¼å²åºæ·è´å°ç½å¡ç¼å²åºã\n\nä»ä¸é¢çå¾ä½ ä¼åç°è¿ä¸ªè¿ç¨æ 6 æ¬¡åå­æ·è´ï¼å¹¶ä¸ read å write ç­ç³»ç»è°ç¨å°å¯¼è´è¿ç¨ä»ç¨æ·æå°åæ ¸æçåæ¢ï¼ä¼èè´¹å¤§éç CPU ååå­èµæºã\n\n\n\nè Tomcat ç AprEndpoint éè¿æä½ç³»ç»å±é¢ç sendfile ç¹æ§è§£å³äºè¿ä¸ªé®é¢ï¼sendfile ç³»ç»è°ç¨æ¹å¼éå¸¸ç®æ´ã\n\nsendfile(socket, file, len);\n\n\nå®å¸¦æä¸¤ä¸ªå³é®åæ°ï¼Socket åæä»¶å¥æãå°æä»¶ä»ç£çåå¥ Socket çè¿ç¨åªæä¸¤æ­¥ï¼\n\nç¬¬ä¸æ­¥ï¼å°æä»¶åå®¹è¯»åå°åæ ¸ç¼å²åºã\n\nç¬¬äºæ­¥ï¼æ°æ®å¹¶æ²¡æä»åæ ¸ç¼å²åºå¤å¶å° Socket å³èçç¼å²åºï¼åªæè®°å½æ°æ®ä½ç½®åé¿åº¦çæè¿°ç¬¦è¢«æ·»å å° Socket ç¼å²åºä¸­ï¼æ¥çææ°æ®ç´æ¥ä»åæ ¸ç¼å²åºä¼ éç»ç½å¡ãè¿ä¸ªè¿ç¨ä½ å¯ä»¥çä¸é¢çå¾ã\n\n\n\n\n# 4. Executor ç»ä»¶\n\nä¸ºäºæé«å¤çè½ååå¹¶ååº¦ï¼Web å®¹å¨ä¸è¬ä¼æå¤çè¯·æ±çå·¥ä½æ¾å°çº¿ç¨æ± éæ¥æ§è¡ï¼Tomcat æ©å±äºåçç Java çº¿ç¨æ± ï¼æ¥æ»¡è¶³ Web å®¹å¨é«å¹¶åçéæ±ã\n\n\n# 4.1. Tomcat å®å¶çº¿ç¨æ± \n\nTomcat ççº¿ç¨æ± ä¹æ¯ä¸ä¸ªå®å¶çç ThreadPoolExecutorãTomcat ä¼ å¥çåæ°æ¯è¿æ ·çï¼\n\n// å®å¶ççä»»å¡éå\ntaskqueue = new TaskQueue(maxQueueSize);\n\n// å®å¶çççº¿ç¨å·¥å\nTaskThreadFactory tf = new TaskThreadFactory(namePrefix,daemon,getThreadPriority());\n\n// å®å¶çççº¿ç¨æ± \nexecutor = new ThreadPoolExecutor(getMinSpareThreads(), getMaxThreads(), maxIdleTime, TimeUnit.MILLISECONDS,taskqueue, tf);\n\n\nå¶ä¸­çä¸¤ä¸ªå³é®ç¹ï¼\n\n * Tomcat æèªå·±çå®å¶çä»»å¡éååçº¿ç¨å·¥åï¼å¹¶ä¸å¯ä»¥éå¶ä»»å¡éåçé¿åº¦ï¼å®çæå¤§é¿åº¦æ¯ maxQueueSizeã\n * Tomcat å¯¹çº¿ç¨æ°ä¹æéå¶ï¼è®¾ç½®äºæ ¸å¿çº¿ç¨æ°ï¼minSpareThreadsï¼åæå¤§çº¿ç¨æ± æ°ï¼maxThreadsï¼ã\n\né¤äºèµæºéå¶ä»¥å¤ï¼Tomcat çº¿ç¨æ± è¿å®å¶èªå·±çä»»å¡å¤çæµç¨ãæä»¬ç¥é Java åççº¿ç¨æ± çä»»å¡å¤çé»è¾æ¯è¾ç®åï¼\n\n 1. å corePoolSize ä¸ªä»»å¡æ¶ï¼æ¥ä¸ä¸ªä»»å¡å°±åå»ºä¸ä¸ªæ°çº¿ç¨ã\n 2. åé¢åæ¥ä»»å¡ï¼å°±æä»»å¡æ·»å å°ä»»å¡éåéè®©ææççº¿ç¨å»æ¢ï¼å¦æéåæ»¡äºå°±åå»ºä¸´æ¶çº¿ç¨ã\n 3. å¦ææ»çº¿ç¨æ°è¾¾å° maximumPoolSizeï¼æ§è¡æç»ç­ç¥ã\n\nTomcat çº¿ç¨æ± æ©å±äºåçç ThreadPoolExecutorï¼éè¿éå execute æ¹æ³å®ç°äºèªå·±çä»»å¡å¤çé»è¾ï¼\n\n 1. å corePoolSize ä¸ªä»»å¡æ¶ï¼æ¥ä¸ä¸ªä»»å¡å°±åå»ºä¸ä¸ªæ°çº¿ç¨ã\n 2. åæ¥ä»»å¡çè¯ï¼å°±æä»»å¡æ·»å å°ä»»å¡éåéè®©ææççº¿ç¨å»æ¢ï¼å¦æéåæ»¡äºå°±åå»ºä¸´æ¶çº¿ç¨ã\n 3. å¦ææ»çº¿ç¨æ°è¾¾å° maximumPoolSizeï¼åç»§ç»­å°è¯æä»»å¡æ·»å å°ä»»å¡éåä¸­å»ã\n 4. å¦æç¼å²éåä¹æ»¡äºï¼æå¥å¤±è´¥ï¼æ§è¡æç»ç­ç¥ã\n\nè§å¯ Tomcat çº¿ç¨æ± å Java åççº¿ç¨æ± çåºå«ï¼å¶å®å°±æ¯å¨ç¬¬ 3 æ­¥ï¼Tomcat å¨çº¿ç¨æ»æ°è¾¾å°æå¤§æ°æ¶ï¼ä¸æ¯ç«å³æ§è¡æç»ç­ç¥ï¼èæ¯åå°è¯åä»»å¡éåæ·»å ä»»å¡ï¼æ·»å å¤±è´¥ååæ§è¡æç»ç­ç¥ãé£å·ä½å¦ä½å®ç°å¢ï¼å¶å®å¾ç®åï¼æä»¬æ¥çä¸ä¸ Tomcat çº¿ç¨æ± ç execute æ¹æ³çæ ¸å¿ä»£ç ã\n\npublic class ThreadPoolExecutor extends java.util.concurrent.ThreadPoolExecutor {\n\n  ...\n\n  public void execute(Runnable command, long timeout, TimeUnit unit) {\n      submittedCount.incrementAndGet();\n      try {\n          // è°ç¨ Java åççº¿ç¨æ± ç execute å»æ§è¡ä»»å¡\n          super.execute(command);\n      } catch (RejectedExecutionException rx) {\n         // å¦ææ»çº¿ç¨æ°è¾¾å° maximumPoolSizeï¼Java åççº¿ç¨æ± æ§è¡æç»ç­ç¥\n          if (super.getQueue() instanceof TaskQueue) {\n              final TaskQueue queue = (TaskQueue)super.getQueue();\n              try {\n                  // ç»§ç»­å°è¯æä»»å¡æ¾å°ä»»å¡éåä¸­å»\n                  if (!queue.force(command, timeout, unit)) {\n                      submittedCount.decrementAndGet();\n                      // å¦æç¼å²éåä¹æ»¡äºï¼æå¥å¤±è´¥ï¼æ§è¡æç»ç­ç¥ã\n                      throw new RejectedExecutionException("...");\n                  }\n              }\n          }\n      }\n}\n\n\nä»è¿ä¸ªæ¹æ³ä½ å¯ä»¥çå°ï¼Tomcat çº¿ç¨æ± ç execute æ¹æ³ä¼è°ç¨ Java åççº¿ç¨æ± ç execute å»æ§è¡ä»»å¡ï¼å¦ææ»çº¿ç¨æ°è¾¾å° maximumPoolSizeï¼Java åççº¿ç¨æ± ç execute æ¹æ³ä¼æåº RejectedExecutionException å¼å¸¸ï¼ä½æ¯è¿ä¸ªå¼å¸¸ä¼è¢« Tomcat çº¿ç¨æ± ç execute æ¹æ³æè·å°ï¼å¹¶ç»§ç»­å°è¯æè¿ä¸ªä»»å¡æ¾å°ä»»å¡éåä¸­å»ï¼å¦æä»»å¡éåä¹æ»¡äºï¼åæ§è¡æç»ç­ç¥ã\n\n\n# 4.2. Tomcat å®å¶ä»»å¡éå\n\nç»å¿çä½ ææ²¡æåç°ï¼å¨ Tomcat çº¿ç¨æ± ç execute æ¹æ³æå¼å§æè¿ä¹ä¸è¡ï¼\n\nsubmittedCount.incrementAndGet();\n\n\nè¿è¡ä»£ç çæææ submittedCount è¿ä¸ªåå­åéå ä¸ï¼å¹¶ä¸å¨ä»»å¡æ§è¡å¤±è´¥ï¼æåºæç»å¼å¸¸æ¶ï¼å°è¿ä¸ªåå­åéåä¸ï¼\n\nsubmittedCount.decrementAndGet();\n\n\nå¶å® Tomcat çº¿ç¨æ± æ¯ç¨è¿ä¸ªåé submittedCount æ¥ç»´æ¤å·²ç»æäº¤å°äºçº¿ç¨æ± ï¼ä½æ¯è¿æ²¡ææ§è¡å®çä»»å¡ä¸ªæ°ãTomcat ä¸ºä»ä¹è¦ç»´æ¤è¿ä¸ªåéå¢ï¼è¿è· Tomcat çå®å¶ççä»»å¡éåæå³ãTomcat çä»»å¡éå TaskQueue æ©å±äº Java ä¸­ç LinkedBlockingQueueï¼æä»¬ç¥é LinkedBlockingQueue é»è®¤æåµä¸é¿åº¦æ¯æ²¡æéå¶çï¼é¤éç»å®ä¸ä¸ª capacityãå æ­¤ Tomcat ç»äºå®ä¸ä¸ª capacityï¼TaskQueue çæé å½æ°ä¸­æä¸ªæ´åçåæ° capacityï¼TaskQueue å° capacity ä¼ ç»ç¶ç±» LinkedBlockingQueue çæé å½æ°ã\n\npublic class TaskQueue extends LinkedBlockingQueue<Runnable> {\n\n  public TaskQueue(int capacity) {\n      super(capacity);\n  }\n  ...\n}\n\n\nè¿ä¸ª capacity åæ°æ¯éè¿ Tomcat ç maxQueueSize åæ°æ¥è®¾ç½®çï¼ä½é®é¢æ¯é»è®¤æåµä¸ maxQueueSize çå¼æ¯Integer.MAX_VALUEï¼ç­äºæ²¡æéå¶ï¼è¿æ ·å°±å¸¦æ¥ä¸ä¸ªé®é¢ï¼å½åçº¿ç¨æ°è¾¾å°æ ¸å¿çº¿ç¨æ°ä¹åï¼åæ¥ä»»å¡çè¯çº¿ç¨æ± ä¼æä»»å¡æ·»å å°ä»»å¡éåï¼å¹¶ä¸æ»æ¯ä¼æåï¼è¿æ ·æ°¸è¿ä¸ä¼ææºä¼åå»ºæ°çº¿ç¨äºã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼TaskQueue éåäº LinkedBlockingQueue ç offer æ¹æ³ï¼å¨åéçæ¶æºè¿å falseï¼è¿å false è¡¨ç¤ºä»»å¡æ·»å å¤±è´¥ï¼è¿æ¶çº¿ç¨æ± ä¼åå»ºæ°ççº¿ç¨ãé£ä»ä¹æ¯åéçæ¶æºå¢ï¼è¯·çä¸é¢ offer æ¹æ³çæ ¸å¿æºç ï¼\n\npublic class TaskQueue extends LinkedBlockingQueue<Runnable> {\n\n  ...\n   @Override\n  // çº¿ç¨æ± è°ç¨ä»»å¡éåçæ¹æ³æ¶ï¼å½åçº¿ç¨æ°è¯å®å·²ç»å¤§äºæ ¸å¿çº¿ç¨æ°äº\n  public boolean offer(Runnable o) {\n\n      // å¦æçº¿ç¨æ°å·²ç»å°äºæå¤§å¼ï¼ä¸è½åå»ºæ°çº¿ç¨äºï¼åªè½æä»»å¡æ·»å å°ä»»å¡éåã\n      if (parent.getPoolSize() == parent.getMaximumPoolSize())\n          return super.offer(o);\n\n      // æ§è¡å°è¿éï¼è¡¨æå½åçº¿ç¨æ°å¤§äºæ ¸å¿çº¿ç¨æ°ï¼å¹¶ä¸å°äºæå¤§çº¿ç¨æ°ã\n      // è¡¨ææ¯å¯ä»¥åå»ºæ°çº¿ç¨çï¼é£å°åºè¦ä¸è¦åå»ºå¢ï¼åä¸¤ç§æåµï¼\n\n      //1. å¦æå·²æäº¤çä»»å¡æ°å°äºå½åçº¿ç¨æ°ï¼è¡¨ç¤ºè¿æç©ºé²çº¿ç¨ï¼æ éåå»ºæ°çº¿ç¨\n      if (parent.getSubmittedCount()<=(parent.getPoolSize()))\n          return super.offer(o);\n\n      //2. å¦æå·²æäº¤çä»»å¡æ°å¤§äºå½åçº¿ç¨æ°ï¼çº¿ç¨ä¸å¤ç¨äºï¼è¿å false å»åå»ºæ°çº¿ç¨\n      if (parent.getPoolSize()<parent.getMaximumPoolSize())\n          return false;\n\n      // é»è®¤æåµä¸æ»æ¯æä»»å¡æ·»å å°ä»»å¡éå\n      return super.offer(o);\n  }\n\n}\n\n\nä»ä¸é¢çä»£ç æä»¬çå°ï¼åªæå½åçº¿ç¨æ°å¤§äºæ ¸å¿çº¿ç¨æ°ãå°äºæå¤§çº¿ç¨æ°ï¼å¹¶ä¸å·²æäº¤çä»»å¡ä¸ªæ°å¤§äºå½åçº¿ç¨æ°æ¶ï¼ä¹å°±æ¯è¯´çº¿ç¨ä¸å¤ç¨äºï¼ä½æ¯çº¿ç¨æ°åæ²¡è¾¾å°æéï¼æä¼å»åå»ºæ°ççº¿ç¨ãè¿å°±æ¯ä¸ºä»ä¹ Tomcat éè¦ç»´æ¤å·²æäº¤ä»»å¡æ°è¿ä¸ªåéï¼å®çç®çå°±æ¯å¨ä»»å¡éåçé¿åº¦æ éå¶çæåµä¸ï¼è®©çº¿ç¨æ± ææºä¼åå»ºæ°ççº¿ç¨ã\n\nå½ç¶é»è®¤æåµä¸ Tomcat çä»»å¡éåæ¯æ²¡æéå¶çï¼ä½ å¯ä»¥éè¿è®¾ç½® maxQueueSize åæ°æ¥éå¶ä»»å¡éåçé¿åº¦ã\n\n\n# 5. WebSocket ç»ä»¶\n\nHTTP åè®®æ¯âè¯·æ± - ååºâæ¨¡å¼ï¼æµè§å¨å¿é¡»ååè¯·æ±ç»æå¡å¨ï¼æå¡å¨æä¼ååºè¿ä¸ªè¯·æ±ãä¹å°±æ¯è¯´ï¼æå¡å¨ä¸ä¼ä¸»å¨åéæ°æ®ç»æµè§å¨ã\n\nå¯¹äºå®æ¶æ§è¦æ±æ¯è¾çé«çåºç¨ï¼æ¯å¦å¨çº¿æ¸¸æãè¡ç¥¨åºéå®æ¶æ¥ä»·åå¨çº¿ååç¼è¾ç­ï¼æµè§å¨éè¦å®æ¶æ¾ç¤ºæå¡å¨ä¸ææ°çæ°æ®ï¼å æ­¤åºç°äº Ajax å Comet ææ¯ãAjax æ¬è´¨ä¸è¿æ¯è½®è¯¢ï¼è Comet æ¯å¨ HTTP é¿è¿æ¥çåºç¡ä¸åäºä¸äº hackï¼ä½æ¯å®ä»¬çå®æ¶æ§ä¸é«ï¼å¦å¤é¢ç¹çè¯·æ±ä¼ç»æå¡å¨å¸¦æ¥ååï¼ä¹ä¼æµªè´¹ç½ç»æµéåå¸¦å®½ãäºæ¯ HTML5 æ¨åºäº WebSocket æ åï¼ä½¿å¾æµè§å¨åæå¡å¨ä¹é´ä»»ä½ä¸æ¹é½å¯ä»¥ä¸»å¨åæ¶æ¯ç»å¯¹æ¹ï¼è¿æ ·æå¡å¨ææ°æ°æ®æ¶å¯ä»¥ä¸»å¨æ¨éç»æµè§å¨ã\n\nTomcat å¦ä½æ¯æ WebSocketï¼ç®åæ¥è¯´ï¼Tomcat åäºä¸¤ä»¶äºï¼\n\n * Endpoint å è½½\n * WebSocket è¯·æ±å¤ç\n\n\n# 5.1. WebSocket å è½½\n\nTomcat ç WebSocket å è½½æ¯éè¿ SCI æºå¶å®æçãSCI å¨ç§° ServletContainerInitializerï¼æ¯ Servlet 3.0 è§èä¸­å®ä¹çç¨æ¥æ¥æ¶ Web åºç¨å¯å¨äºä»¶çæ¥å£ãé£ä¸ºä»ä¹è¦çå¬ Servlet å®¹å¨çå¯å¨äºä»¶å¢ï¼å ä¸ºè¿æ ·æä»¬ææºä¼å¨ Web åºç¨å¯å¨æ¶åä¸äºåå§åå·¥ä½ï¼æ¯å¦ WebSocket éè¦æ«æåå è½½ Endpoint ç±»ãSCI çä½¿ç¨ä¹æ¯è¾ç®åï¼å°å®ç° ServletContainerInitializer æ¥å£çç±»å¢å  HandlesTypes æ³¨è§£ï¼å¹¶ä¸å¨æ³¨è§£åæå®çä¸ç³»åç±»åæ¥å£éåãæ¯å¦ Tomcat ä¸ºäºæ«æåå è½½ Endpoint èå®ä¹ç SCI ç±»å¦ä¸ï¼\n\n@HandlesTypes({ServerEndpoint.class, ServerApplicationConfig.class, Endpoint.class})\npublic class WsSci implements ServletContainerInitializer {\n\n  public void onStartup(Set<Class<?>> clazzes, ServletContext ctx) throws ServletException {\n  ...\n  }\n}\n\n\nä¸æ¦å®ä¹å¥½äº SCIï¼Tomcat å¨å¯å¨é¶æ®µæ«æç±»æ¶ï¼ä¼å° HandlesTypes æ³¨è§£ä¸­æå®çç±»é½æ«æåºæ¥ï¼ä½ä¸º SCI ç onStartup æ¹æ³çåæ°ï¼å¹¶è°ç¨ SCI ç onStartup æ¹æ³ãæ³¨æå° WsSci ç HandlesTypes æ³¨è§£ä¸­å®ä¹äºServerEndpoint.classãServerApplicationConfig.classåEndpoint.classï¼å æ­¤å¨ Tomcat çå¯å¨é¶æ®µä¼å°è¿äºç±»çç±»å®ä¾ï¼æ³¨æä¸æ¯å¯¹è±¡å®ä¾ï¼ä¼ éç» WsSci ç onStartup æ¹æ³ãé£ä¹ WsSci ç onStartup æ¹æ³ååäºä»ä¹äºå¢ï¼\n\nå®ä¼æé ä¸ä¸ª WebSocketContainer å®ä¾ï¼ä½ å¯ä»¥æ WebSocketContainer çè§£æä¸ä¸ªä¸é¨å¤ç WebSocket è¯·æ±çEndpoint å®¹å¨ãä¹å°±æ¯è¯´ Tomcat ä¼ææ«æå°ç Endpoint å­ç±»åæ·»å äºæ³¨è§£@ServerEndpointçç±»æ³¨åå°è¿ä¸ªå®¹å¨ä¸­ï¼å¹¶ä¸è¿ä¸ªå®¹å¨è¿ç»´æ¤äº URL å° Endpoint çæ å°å³ç³»ï¼è¿æ ·éè¿è¯·æ± URL å°±è½æ¾å°å·ä½ç Endpoint æ¥å¤ç WebSocket è¯·æ±ã\n\n\n# 5.2. WebSocket è¯·æ±å¤ç\n\nTomcat ç¨ ProtocolHandler ç»ä»¶å±è½åºç¨å±åè®®çå·®å¼ï¼å¶ä¸­ ProtocolHandler ä¸­æä¸¤ä¸ªå³é®ç»ä»¶ï¼Endpoint å Processorãéè¦æ³¨æï¼è¿éç Endpoint è·ä¸ææå°ç WebSocket ä¸­ç Endpoint å®å¨æ¯ä¸¤åäºï¼è¿æ¥å¨ä¸­ç Endpoint ç»ä»¶ç¨æ¥å¤ç I/O éä¿¡ãWebSocket æ¬è´¨å°±æ¯ä¸ä¸ªåºç¨å±åè®®ï¼å æ­¤ä¸è½ç¨ HttpProcessor æ¥å¤ç WebSocket è¯·æ±ï¼èè¦ç¨ä¸é¨ Processor æ¥å¤çï¼èå¨ Tomcat ä¸­è¿æ ·ç Processor å«ä½ UpgradeProcessorã\n\nä¸ºä»ä¹å« Upgrade Processor å¢ï¼è¿æ¯å ä¸º Tomcat æ¯å° HTTP åè®®åçº§æ WebSocket åè®®çã\n\nWebSocket æ¯éè¿ HTTP åè®®æ¥è¿è¡æ¡æçï¼å æ­¤å½ WebSocket çæ¡æè¯·æ±å°æ¥æ¶ï¼HttpProtocolHandler é¦åæ¥æ¶å°è¿ä¸ªè¯·æ±ï¼å¨å¤çè¿ä¸ª HTTP è¯·æ±æ¶ï¼Tomcat éè¿ä¸ä¸ªç¹æ®ç Filter å¤æ­è¯¥å½å HTTP è¯·æ±æ¯å¦æ¯ä¸ä¸ª WebSocket Upgrade è¯·æ±ï¼å³åå«Upgrade: websocketç HTTP å¤´ä¿¡æ¯ï¼ï¼å¦ææ¯ï¼åå¨ HTTP ååºéæ·»å  WebSocket ç¸å³çååºå¤´ä¿¡æ¯ï¼å¹¶è¿è¡åè®®åçº§ãå·ä½æ¥è¯´å°±æ¯ç¨ UpgradeProtocolHandler æ¿æ¢å½åç HttpProtocolHandlerï¼ç¸åºçï¼æå½å Socket ç Processor æ¿æ¢æ UpgradeProcessorï¼åæ¶ Tomcat ä¼åå»º WebSocket Session å®ä¾å Endpoint å®ä¾ï¼å¹¶è·å½åç WebSocket è¿æ¥ä¸ä¸å¯¹åºèµ·æ¥ãè¿ä¸ª WebSocket è¿æ¥ä¸ä¼ç«å³å³é­ï¼å¹¶ä¸å¨è¯·æ±å¤çä¸­ï¼ä¸åä½¿ç¨åæç HttpProcessorï¼èæ¯ç¨ä¸é¨ç UpgradeProcessorï¼UpgradeProcessor æç»ä¼è°ç¨ç¸åºç Endpoint å®ä¾æ¥å¤çè¯·æ±ã\n\n\n\nä½ å¯ä»¥çå°ï¼Tomcat å¯¹ WebSocket è¯·æ±çå¤çæ²¡æç»è¿ Servlet å®¹å¨ï¼èæ¯éè¿ UpgradeProcessor ç»ä»¶ç´æ¥æè¯·æ±åå° ServerEndpoint å®ä¾ï¼å¹¶ä¸ Tomcat ç WebSocket å®ç°ä¸éè¦å³æ³¨å·ä½ I/O æ¨¡åçç»èï¼ä»èå®ç°äºä¸å·ä½ I/O æ¹å¼çè§£è¦ã\n\n\n# 6. åèèµæ\n\n * å®æ¹\n   * Tomcat å®æ¹ç½ç«\n   * Tomcat Wiki\n   * Tomee å®æ¹ç½ç«\n * æç¨\n   * æ·±å¥æè§£ Tomcat & Jetty',normalizedContent:'# tomcat è¿æ¥å¨\n\n\n# 1. nioendpoint ç»ä»¶\n\ntomcat ç nioendpoint ç»ä»¶å©ç¨ java nio å®ç°äº i/o å¤è·¯å¤ç¨æ¨¡åã\n\n\n\nnioendpoint å­ç»ä»¶åè½ç®ä»ï¼\n\n * limitlatch æ¯è¿æ¥æ§å¶å¨ï¼è´è´£æ§å¶æå¤§è¿æ¥æ°ãnio æ¨¡å¼ä¸é»è®¤æ¯ 10000ï¼è¾¾å°è¿ä¸ªéå¼åï¼è¿æ¥è¯·æ±è¢«æç»ã\n * acceptor è´è´£çå¬è¿æ¥è¯·æ±ãacceptor è¿è¡å¨ä¸ä¸ªåç¬ççº¿ç¨éï¼å®å¨ä¸ä¸ªæ­»å¾ªç¯éè°ç¨ accept æ¹æ³æ¥æ¥æ¶æ°è¿æ¥ï¼ä¸æ¦ææ°çè¿æ¥è¯·æ±å°æ¥ï¼accept æ¹æ³è¿åä¸ä¸ª channel å¯¹è±¡ï¼æ¥çæ channel å¯¹è±¡äº¤ç» poller å»å¤çã\n * poller çæ¬è´¨æ¯ä¸ä¸ª selectorï¼ä¹è¿è¡å¨åç¬çº¿ç¨éãpoller åé¨ç»´æ¤ä¸ä¸ª channel æ°ç»ï¼å®å¨ä¸ä¸ªæ­»å¾ªç¯éä¸æ­æ£æµ channel çæ°æ®å°±ç»ªç¶æï¼ä¸æ¦æ channel å¯è¯»ï¼å°±çæä¸ä¸ª socketprocessor ä»»å¡å¯¹è±¡æç» executor å»å¤çã\n * executor å°±æ¯çº¿ç¨æ± ï¼è´è´£è¿è¡ socketprocessor ä»»å¡ç±»ï¼socketprocessor ç run æ¹æ³ä¼è°ç¨ http11processor æ¥è¯»ååè§£æè¯·æ±æ°æ®ãæä»¬ç¥éï¼http11processor æ¯åºç¨å±åè®®çå°è£ï¼å®ä¼è°ç¨å®¹å¨è·å¾ååºï¼åæååºéè¿ channel ååºã\n\nnioendpoint å¦ä½å®ç°é«å¹¶åçå¢ï¼\n\nè¦å®ç°é«å¹¶åéè¦åçè®¾è®¡çº¿ç¨æ¨¡åååå©ç¨ cpu èµæºï¼å°½éä¸è¦è®©çº¿ç¨é»å¡ï¼å¦å¤ï¼å°±æ¯æå¤å°ä»»å¡ï¼å°±ç¨ç¸åºè§æ¨¡ççº¿ç¨æ°å»å¤çã\n\nnioendpoint è¦å®æä¸ä»¶äºæï¼æ¥æ¶è¿æ¥ãæ£æµ i/o äºä»¶ä»¥åå¤çè¯·æ±ï¼é£ä¹ææ ¸å¿çå°±æ¯æè¿ä¸ä»¶äºæåå¼ï¼ç¨ä¸åè§æ¨¡ççº¿ç¨å»å¤çï¼æ¯å¦ç¨ä¸é¨ççº¿ç¨ç»å»è· acceptorï¼å¹¶ä¸ acceptor çä¸ªæ°å¯ä»¥éç½®ï¼ç¨ä¸é¨ççº¿ç¨ç»å»è· pollerï¼poller çä¸ªæ°ä¹å¯ä»¥éç½®ï¼æåå·ä½ä»»å¡çæ§è¡ä¹ç±ä¸é¨ççº¿ç¨æ± æ¥å¤çï¼ä¹å¯ä»¥éç½®çº¿ç¨æ± çå¤§å°ã\n\n\n# 1.1. limitlatch\n\nlimitlatch ç¨æ¥æ§å¶è¿æ¥ä¸ªæ°ï¼å½è¿æ¥æ°å°è¾¾æå¤§æ¶é»å¡çº¿ç¨ï¼ç´å°åç»­ç»ä»¶å¤çå®ä¸ä¸ªè¿æ¥åå°è¿æ¥æ°å 1ãè¯·ä½ æ³¨æå°è¾¾æå¤§è¿æ¥æ°åæä½ç³»ç»åºå±è¿æ¯ä¼æ¥æ¶å®¢æ·ç«¯è¿æ¥ï¼ä½ç¨æ·å±å·²ç»ä¸åæ¥æ¶ã\n\npublic class limitlatch {\n    private class sync extends abstractqueuedsynchronizer {\n\n        @override\n        protected int tryacquireshared() {\n            long newcount = count.incrementandget();\n            if (newcount > limit) {\n                count.decrementandget();\n                return -1;\n            } else {\n                return 1;\n            }\n        }\n\n        @override\n        protected boolean tryreleaseshared(int arg) {\n            count.decrementandget();\n            return true;\n        }\n    }\n\n    private final sync sync;\n    private final atomiclong count;\n    private volatile long limit;\n\n    // çº¿ç¨è°ç¨è¿ä¸ªæ¹æ³æ¥è·å¾æ¥æ¶æ°è¿æ¥çè®¸å¯ï¼çº¿ç¨å¯è½è¢«é»å¡\n    public void countuporawait() throws interruptedexception {\n      sync.acquiresharedinterruptibly(1);\n    }\n\n    // è°ç¨è¿ä¸ªæ¹æ³æ¥éæ¾ä¸ä¸ªè¿æ¥è®¸å¯ï¼é£ä¹åé¢é»å¡ççº¿ç¨å¯è½è¢«å¤é\n    public long countdown() {\n      sync.releaseshared(0);\n      long result = getcount();\n      return result;\n   }\n}\n\n\nlimitlatch åæ­¥å®ä¹äºåé¨ç±» syncï¼è sync æ©å±äº aqsï¼aqs æ¯ java å¹¶ååä¸­çä¸ä¸ªæ ¸å¿ç±»ï¼å®å¨åé¨ç»´æ¤ä¸ä¸ªç¶æåä¸ä¸ªçº¿ç¨éåï¼å¯ä»¥ç¨æ¥æ§å¶çº¿ç¨ä»ä¹æ¶åæèµ·ï¼ä»ä¹æ¶åå¤éãæä»¬å¯ä»¥æ©å±å®æ¥å®ç°èªå·±çåæ­¥å¨ï¼å®éä¸ java å¹¶ååéçéåæ¡ä»¶åéç­ç­é½æ¯éè¿ aqs æ¥å®ç°çï¼èè¿éç limitlatch ä¹ä¸ä¾å¤ã\n\nçè§£æºç è¦ç¹ï¼\n\n * ç¨æ·çº¿ç¨éè¿è°ç¨ limitlatch ç countuporawait æ¹æ³æ¥æ¿å°éï¼å¦æææ¶æ æ³è·åï¼è¿ä¸ªçº¿ç¨ä¼è¢«é»å¡å° aqs çéåä¸­ãé£ aqs æä¹ç¥éæ¯é»å¡è¿æ¯ä¸é»å¡ç¨æ·çº¿ç¨å¢ï¼å¶å®è¿æ¯ç± aqs çä½¿ç¨èæ¥å³å®çï¼ä¹å°±æ¯åé¨ç±» sync æ¥å³å®çï¼å ä¸º sync ç±»éåäº aqs çtryacquireshared() æ¹æ³ãå®çå®ç°é»è¾æ¯å¦æå½åè¿æ¥æ° count å°äº limitï¼çº¿ç¨è½è·åéï¼è¿å 1ï¼å¦åè¿å -1ã\n * å¦ä½ç¨æ·çº¿ç¨è¢«é»å¡å°äº aqs çéåï¼é£ä»ä¹æ¶åå¤éå¢ï¼åæ ·æ¯ç± sync åé¨ç±»å³å®ï¼sync éåäº aqs çreleaseshared() æ¹æ³ï¼å¶å®å°±æ¯å½ä¸ä¸ªè¿æ¥è¯·æ±å¤çå®äºï¼è¿æ¶åå¯ä»¥æ¥æ¶ä¸ä¸ªæ°è¿æ¥äºï¼è¿æ ·åé¢é»å¡ççº¿ç¨å°ä¼è¢«å¤éã\n\n\n# 1.2. acceptor\n\nacceptor å®ç°äº runnable æ¥å£ï¼å æ­¤å¯ä»¥è·å¨åç¬çº¿ç¨éãä¸ä¸ªç«¯å£å·åªè½å¯¹åºä¸ä¸ª serversocketchannelï¼å æ­¤è¿ä¸ª serversocketchannel æ¯å¨å¤ä¸ª acceptor çº¿ç¨ä¹é´å±äº«çï¼å®æ¯ endpoint çå±æ§ï¼ç± endpoint å®æåå§ååç«¯å£ç»å®ã\n\nserversock = serversocketchannel.open();\nserversock.socket().bind(addr,getacceptcount());\nserversock.configureblocking(true);\n\n\n * bind æ¹æ³çç¬¬äºä¸ªåæ°è¡¨ç¤ºæä½ç³»ç»çç­å¾éåé¿åº¦ï¼æå¨ä¸é¢æå°ï¼å½åºç¨å±é¢çè¿æ¥æ°å°è¾¾æå¤§å¼æ¶ï¼æä½ç³»ç»å¯ä»¥ç»§ç»­æ¥æ¶è¿æ¥ï¼é£ä¹æä½ç³»ç»è½ç»§ç»­æ¥æ¶çæå¤§è¿æ¥æ°å°±æ¯è¿ä¸ªéåé¿åº¦ï¼å¯ä»¥éè¿ acceptcount åæ°éç½®ï¼é»è®¤æ¯ 100ã\n * serversocketchannel è¢«è®¾ç½®æé»å¡æ¨¡å¼ï¼ä¹å°±æ¯è¯´å®æ¯ä»¥é»å¡çæ¹å¼æ¥æ¶è¿æ¥çãserversocketchannel éè¿ accept() æ¥åæ°çè¿æ¥ï¼accept() æ¹æ³è¿åè·å¾ socketchannel å¯¹è±¡ï¼ç¶åå° socketchannel å¯¹è±¡å°è£å¨ä¸ä¸ª pollerevent å¯¹è±¡ä¸­ï¼å¹¶å° pollerevent å¯¹è±¡åå¥ poller ç queue éï¼è¿æ¯ä¸ªå¸åççäº§è - æ¶è´¹èæ¨¡å¼ï¼acceptor ä¸ poller çº¿ç¨ä¹é´éè¿ queue éä¿¡ã\n\n\n# 1.3. poller\n\npoller æ¬è´¨æ¯ä¸ä¸ª selectorï¼å®åé¨ç»´æ¤ä¸ä¸ª queueã\n\nprivate final synchronizedqueue<pollerevent> events = new synchronizedqueue<>();\n\n\nsynchronizedqueue çæ ¸å¿æ¹æ³é½ä½¿ç¨äº synchronized å³é®å­è¿è¡ä¿®é¥°ï¼ç¨æ¥ä¿è¯åä¸æ¶å»åªæä¸ä¸ªçº¿ç¨è¿è¡è¯»åã\n\nä½¿ç¨ synchronizedqueueï¼æå³çåä¸æ¶å»åªæä¸ä¸ª acceptor çº¿ç¨å¯¹éåè¿è¡è¯»åï¼åæ¶æå¤ä¸ª poller çº¿ç¨å¨è¿è¡ï¼æ¯ä¸ª poller çº¿ç¨é½æèªå·±çéåãæ¯ä¸ª poller çº¿ç¨å¯è½åæ¶è¢«å¤ä¸ª acceptor çº¿ç¨è°ç¨æ¥æ³¨å pollereventãåæ · poller çä¸ªæ°å¯ä»¥éè¿ pollers åæ°éç½®ã\n\npoller ä¸æ­çéè¿åé¨ç selector å¯¹è±¡ååæ ¸æ¥è¯¢ channel çç¶æï¼ä¸æ¦å¯è¯»å°±çæä»»å¡ç±» socketprocessor äº¤ç» executor å»å¤çãpoller çå¦ä¸ä¸ªéè¦ä»»å¡æ¯å¾ªç¯éåæ£æ¥èªå·±æç®¡çç socketchannel æ¯å¦å·²ç»è¶æ¶ï¼å¦ææè¶æ¶å°±å³é­è¿ä¸ª socketchannelã\n\n\n# 1.4. socketprocessor\n\næä»¬ç¥éï¼poller ä¼åå»º socketprocessor ä»»å¡ç±»äº¤ç»çº¿ç¨æ± å¤çï¼è socketprocessor å®ç°äº runnable æ¥å£ï¼ç¨æ¥å®ä¹ executor ä¸­çº¿ç¨ææ§è¡çä»»å¡ï¼ä¸»è¦å°±æ¯è°ç¨ http11processor ç»ä»¶æ¥å¤çè¯·æ±ãhttp11processor è¯»å channel çæ°æ®æ¥çæ servletrequest å¯¹è±¡ï¼è¿éè¯·ä½ æ³¨æï¼\n\nhttp11processor å¹¶ä¸æ¯ç´æ¥è¯»å channel çãè¿æ¯å ä¸º tomcat æ¯æåæ­¥éé»å¡ i/o æ¨¡ååå¼æ­¥ i/o æ¨¡åï¼å¨ java api ä¸­ï¼ç¸åºç channel ç±»ä¹æ¯ä¸ä¸æ ·çï¼æ¯å¦æ asynchronoussocketchannel å socketchannelï¼ä¸ºäºå¯¹ http11processor å±è½è¿äºå·®å¼ï¼tomcat è®¾è®¡äºä¸ä¸ªåè£ç±»å«ä½ socketwrapperï¼http11processor åªè°ç¨ socketwrapper çæ¹æ³å»è¯»åæ°æ®ã\n\n\n# 2. nio2endpoint ç»ä»¶\n\nnio2endpoint å·¥ä½æµç¨è· nioendpoint è¾ä¸ºç¸ä¼¼ã\n\n\n\nnio2endpoint å­ç»ä»¶åè½è¯´æï¼\n\n * limitlatch æ¯è¿æ¥æ§å¶å¨ï¼å®è´è´£æ§å¶æå¤§è¿æ¥æ°ã\n * nio2acceptor æ©å±äº acceptorï¼ç¨å¼æ­¥ i/o çæ¹å¼æ¥æ¥æ¶è¿æ¥ï¼è·å¨ä¸ä¸ªåç¬ççº¿ç¨éï¼ä¹æ¯ä¸ä¸ªçº¿ç¨ç»ãnio2acceptor æ¥æ¶æ°çè¿æ¥åï¼å¾å°ä¸ä¸ª asynchronoussocketchannelï¼nio2acceptor æ asynchronoussocketchannel å°è£æä¸ä¸ª nio2socketwrapperï¼å¹¶åå»ºä¸ä¸ª socketprocessor ä»»å¡ç±»äº¤ç»çº¿ç¨æ± å¤çï¼å¹¶ä¸ socketprocessor ææ nio2socketwrapper å¯¹è±¡ã\n * executor å¨æ§è¡ socketprocessor æ¶ï¼socketprocessor ç run æ¹æ³ä¼è°ç¨ http11processor æ¥å¤çè¯·æ±ï¼http11processor ä¼éè¿ nio2socketwrapper è¯»ååè§£æè¯·æ±æ°æ®ï¼è¯·æ±ç»è¿å®¹å¨å¤çåï¼åæååºéè¿ nio2socketwrapper ååºã\n\nnio2endpoint è· nioendpoint çä¸ä¸ªææ¾ä¸åç¹æ¯ï¼nio2endpoint ä¸­æ²¡æ poller ç»ä»¶ï¼ä¹å°±æ¯æ²¡æ selectorãè¿æ¯ä¸ºä»ä¹å¢ï¼å ä¸ºå¨å¼æ­¥ i/o æ¨¡å¼ä¸ï¼selector çå·¥ä½äº¤ç»åæ ¸æ¥åäºã\n\n\n# 2.1. nio2acceptor\n\nå nioendpint ä¸æ ·ï¼nio2endpoint çåºæ¬æè·¯æ¯ç¨ limitlatch ç»ä»¶æ¥æ§å¶è¿æ¥æ°ã\n\nä½æ¯ nio2acceptor ççå¬è¿æ¥çè¿ç¨ä¸æ¯å¨ä¸ä¸ªæ­»å¾ªç¯éä¸æ­çè° accept æ¹æ³ï¼èæ¯éè¿åè°å½æ°æ¥å®æçãæä»¬æ¥ççå®çè¿æ¥çå¬æ¹æ³ï¼\n\nserversock.accept(null, this);\n\n\nå¶å®å°±æ¯è°ç¨äº accept æ¹æ³ï¼æ³¨æå®çç¬¬äºä¸ªåæ°æ¯ thisï¼è¡¨æ nio2acceptor èªå·±å°±æ¯å¤çè¿æ¥çåè°ç±»ï¼å æ­¤ nio2acceptor å®ç°äº completionhandler æ¥å£ãé£ä¹å®æ¯å¦ä½å®ç° completionhandler æ¥å£çå¢ï¼\n\nprotected class nio2acceptor extends acceptor<asynchronoussocketchannel>\n    implements completionhandler<asynchronoussocketchannel, void> {\n\n    @override\n    public void completed(asynchronoussocketchannel socket,\n        void attachment) {\n\n        if (isrunning() && !ispaused()) {\n            if (getmaxconnections() == -1) {\n                // å¦ææ²¡æè¿æ¥éå¶ï¼ç»§ç»­æ¥æ¶æ°çè¿æ¥\n                serversock.accept(null, this);\n            } else {\n                // å¦ææè¿æ¥éå¶ï¼å°±å¨çº¿ç¨æ± éè· run æ¹æ³ï¼run æ¹æ³ä¼æ£æ¥è¿æ¥æ°\n                getexecutor().execute(this);\n            }\n            // å¤çè¯·æ±\n            if (!setsocketoptions(socket)) {\n                closesocket(socket);\n            }\n        }\n    }\n}\n\n\nå¯ä»¥çå° completionhandler çä¸¤ä¸ªæ¨¡æ¿åæ°åå«æ¯ asynchronousserversocketchannel å voidï¼æå¨åé¢è¯´è¿ç¬¬ä¸ä¸ªåæ°å°±æ¯ accept æ¹æ³çè¿åå¼ï¼ç¬¬äºä¸ªåæ°æ¯éä»¶ç±»ï¼ç±ç¨æ·èªå·±å³å®ï¼è¿éä¸º voidãcompleted æ¹æ³çå¤çé»è¾æ¯è¾ç®åï¼\n\n * å¦ææ²¡æè¿æ¥éå¶ï¼ç»§ç»­å¨æ¬çº¿ç¨ä¸­è°ç¨ accept æ¹æ³æ¥æ¶æ°çè¿æ¥ã\n * å¦ææè¿æ¥éå¶ï¼å°±å¨çº¿ç¨æ± éè· run æ¹æ³å»æ¥æ¶æ°çè¿æ¥ãé£ä¸ºä»ä¹è¦è· run æ¹æ³å¢ï¼å ä¸ºå¨ run æ¹æ³éä¼æ£æ¥è¿æ¥æ°ï¼å½è¿æ¥è¾¾å°æå¤§æ°æ¶ï¼çº¿ç¨å¯è½ä¼è¢« limitlatch é»å¡ãä¸ºä»ä¹è¦æ¾å¨çº¿ç¨æ± éè·å¢ï¼è¿æ¯å ä¸ºå¦ææ¾å¨å½åçº¿ç¨éæ§è¡ï¼completed æ¹æ³å¯è½è¢«é»å¡ï¼ä¼å¯¼è´è¿ä¸ªåè°æ¹æ³ä¸ç´ä¸è¿åã\n\næ¥ç completed æ¹æ³ä¼è°ç¨ setsocketoptions æ¹æ³ï¼å¨è¿ä¸ªæ¹æ³éï¼ä¼åå»º nio2socketwrapper å socketprocessorï¼å¹¶äº¤ç»çº¿ç¨æ± å¤çã\n\n\n# 2.2. nio2socketwrapper\n\nnio2socketwrapper çä¸»è¦ä½ç¨æ¯å°è£ channelï¼å¹¶æä¾æ¥å£ç» http11processor è¯»åæ°æ®ãè®²å°è¿éä½ æ¯ä¸æ¯æä¸ªçé®ï¼http11processor æ¯ä¸è½é»å¡ç­å¾æ°æ®çï¼æç§å¼æ­¥ i/o çå¥è·¯ï¼http11processor å¨è°ç¨ nio2socketwrapper ç read æ¹æ³æ¶éè¦æ³¨ååè°ç±»ï¼read è°ç¨ä¼ç«å³è¿åï¼é®é¢æ¯ç«å³è¿åå http11processor è¿æ²¡æè¯»å°æ°æ®ï¼ æä¹åå¢ï¼è¿ä¸ªè¯·æ±çå¤çä¸å°±å¤±è´¥äºåï¼\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼http11processor æ¯éè¿ 2 æ¬¡ read è°ç¨æ¥å®ææ°æ®è¯»åæä½çã\n\n * ç¬¬ä¸æ¬¡ read è°ç¨ï¼è¿æ¥ååå»ºç«å¥½åï¼acceptor åå»º socketprocessor ä»»å¡ç±»äº¤ç»çº¿ç¨æ± å»å¤çï¼http11processor å¨å¤çè¯·æ±çè¿ç¨ä¸­ï¼ä¼è°ç¨ nio2socketwrapper ç read æ¹æ³ååºç¬¬ä¸æ¬¡è¯»è¯·æ±ï¼åæ¶æ³¨åäºåè°ç±» readcompletionhandlerï¼å ä¸ºæ°æ®æ²¡è¯»å°ï¼http11processor æå½åç nio2socketwrapper æ è®°ä¸ºæ°æ®ä¸å®æ´ãæ¥ç socketprocessor çº¿ç¨è¢«åæ¶ï¼http11processor å¹¶æ²¡æé»å¡ç­å¾æ°æ®ãè¿éè¯·æ³¨æï¼http11processor ç»´æ¤äºä¸ä¸ª nio2socketwrapper åè¡¨ï¼ä¹å°±æ¯ç»´æ¤äºè¿æ¥çç¶æã\n * ç¬¬äºæ¬¡ read è°ç¨ï¼å½æ°æ®å°è¾¾åï¼åæ ¸å·²ç»ææ°æ®æ·è´å° http11processor æå®ç buffer éï¼åæ¶åè°ç±» readcompletionhandler è¢«è°ç¨ï¼å¨è¿ä¸ªåè°å¤çæ¹æ³éä¼éæ°åå»ºä¸ä¸ªæ°ç socketprocessor ä»»å¡æ¥ç»§ç»­å¤çè¿ä¸ªè¿æ¥ï¼èè¿ä¸ªæ°ç socketprocessor ä»»å¡ç±»ææåæ¥é£ä¸ª nio2socketwrapperï¼è¿ä¸æ¬¡ http11processor å¯ä»¥éè¿ nio2socketwrapper è¯»åæ°æ®äºï¼å ä¸ºæ°æ®å·²ç»å°äºåºç¨å±ç bufferã\n\nè¿ä¸ªåè°ç±» readcompletionhandler çæºç å¦ä¸ï¼æå³é®çä¸ç¹æ¯ï¼nio2socketwrapper æ¯ä½ä¸ºéä»¶ç±»æ¥ä¼ éçï¼è¿æ ·å¨åè°å½æ°éè½æ¿å°ææçä¸ä¸æã\n\nthis.readcompletionhandler = new completionhandler<integer, socketwrapperbase<nio2channel>>() {\n    public void completed(integer nbytes, socketwrapperbase<nio2channel> attachment) {\n        ...\n        // éè¿éä»¶ç±» socketwrapper æ¿å°ææçä¸ä¸æ\n        nio2socketwrapper.this.getendpoint().processsocket(attachment, socketevent.open_read, false);\n    }\n\n    public void failed(throwable exc, socketwrapperbase<nio2channel> attachment) {\n        ...\n    }\n}\n\n\n\n# 3. aprendpoint ç»ä»¶\n\næä»¬å¨ä½¿ç¨ tomcat æ¶ï¼å¯è½ä¼å¨å¯å¨æ¥å¿éçå°è¿æ ·çæç¤ºä¿¡æ¯ï¼\n\n> the apr based apache tomcat native library which allows optimal performance in production environments was not found on the java.library.path: ***\n\nè¿å¥è¯çææå°±æ¯æ¨èä½ å»å®è£ apr åºï¼å¯ä»¥æé«ç³»ç»æ§è½ã\n\naprï¼apache portable runtime librariesï¼æ¯ apache å¯ç§»æ¤è¿è¡æ¶åºï¼å®æ¯ç¨ c è¯­è¨å®ç°çï¼å¶ç®çæ¯åä¸å±åºç¨ç¨åºæä¾ä¸ä¸ªè·¨å¹³å°çæä½ç³»ç»æ¥å£åºãtomcat å¯ä»¥ç¨å®æ¥å¤çåæ¬æä»¶åç½ç» i/oï¼ä»èæåæ§è½ãtomcat æ¯æçè¿æ¥å¨æ nioãnio.2 å aprãè· nioendpoint ä¸æ ·ï¼aprendpoint ä¹å®ç°äºéé»å¡ i/oï¼å®ä»¬çåºå«æ¯ï¼nioendpoint éè¿è°ç¨ java ç nio api æ¥å®ç°éé»å¡ i/oï¼è aprendpoint æ¯éè¿ jni è°ç¨ apr æ¬å°åºèå®ç°éé»å¡ i/o çã\n\nåæ ·æ¯éé»å¡ i/oï¼ä¸ºä»ä¹ tomcat ä¼æç¤ºä½¿ç¨ apr æ¬å°åºçæ§è½ä¼æ´å¥½å¢ï¼è¿æ¯å ä¸ºå¨æäºåºæ¯ä¸ï¼æ¯å¦éè¦é¢ç¹ä¸æä½ç³»ç»è¿è¡äº¤äºï¼socket ç½ç»éä¿¡å°±æ¯è¿æ ·ä¸ä¸ªåºæ¯ï¼ç¹å«æ¯å¦æä½ ç web åºç¨ä½¿ç¨äº tls æ¥å å¯ä¼ è¾ï¼æä»¬ç¥é tls åè®®å¨æ¡æè¿ç¨ä¸­æå¤æ¬¡ç½ç»äº¤äºï¼å¨è¿ç§æåµä¸ java è· c è¯­è¨ç¨åºç¸æ¯è¿æ¯æä¸å®çå·®è·ï¼èè¿æ­£æ¯ apr çå¼ºé¡¹ã\n\ntomcat æ¬èº«æ¯ java ç¼åçï¼ä¸ºäºè°ç¨ c è¯­è¨ç¼åç aprï¼éè¦éè¿ jni æ¹å¼æ¥è°ç¨ãjniï¼java native interfaceï¼ æ¯ jdk æä¾çä¸ä¸ªç¼ç¨æ¥å£ï¼å®åè®¸ java ç¨åºè°ç¨å¶ä»è¯­è¨ç¼åçç¨åºæèä»£ç åºï¼å¶å® jdk æ¬èº«çå®ç°ä¹å¤§éç¨å° jni ææ¯æ¥è°ç¨æ¬å° c ç¨åºåºã\n\n\n# 3.1. aprendpoint å·¥ä½æµç¨\n\n\n\n# 3.1.1. acceptor\n\naccpetor çåè½å°±æ¯çå¬è¿æ¥ï¼æ¥æ¶å¹¶å»ºç«è¿æ¥ãå®çæ¬è´¨å°±æ¯è°ç¨äºåä¸ªæä½ç³»ç» apiï¼socketãbindãlisten å acceptãé£ java è¯­è¨å¦ä½ç´æ¥è°ç¨ c è¯­è¨ api å¢ï¼ç­æ¡å°±æ¯éè¿ jniãå·ä½æ¥è¯´å°±æ¯ä¸¤æ­¥ï¼åå°è£ä¸ä¸ª java ç±»ï¼å¨éé¢å®ä¹ä¸å ç¨native å³é®å­ä¿®é¥°çæ¹æ³ï¼åä¸é¢è¿æ ·ã\n\npublic class socket {\n  ...\n  // ç¨ native ä¿®é¥°è¿ä¸ªæ¹æ³ï¼è¡¨æè¿ä¸ªå½æ°æ¯ c è¯­è¨å®ç°\n  public static native long create(int family, int type,\n                                 int protocol, long cont)\n\n  public static native int bind(long sock, long sa);\n\n  public static native int listen(long sock, int backlog);\n\n  public static native long accept(long sock)\n}\n\n\næ¥çç¨ c ä»£ç å®ç°è¿äºæ¹æ³ï¼æ¯å¦ bind å½æ°å°±æ¯è¿æ ·å®ç°çï¼\n\n// æ³¨æå½æ°çåå­è¦ç¬¦å jni è§èçè¦æ±\njniexport jint jnicall\njava_org_apache_tomcat_jni_socket_bind(jnienv *e, jlong sock,jlong sa)\n\t{\n\t    jint rv = apr_success;\n\t    tcn_socket_t *s = (tcn_socket_t *ï¼sock;\n\t    apr_sockaddr_t *a = (apr_sockaddr_t *) sa;\n\n        // è°ç¨ apr åºèªå·±å®ç°ç bind å½æ°\n\t    rv = (jint)apr_socket_bind(s->sock, a);\n\t    return rv;\n\t}\n\n\nä¸æ éæå°±ä¸å±å¼ jni çç»èäºï¼ä½ å¯ä»¥æ©å±éè¯»è·å¾æ´å¤ä¿¡æ¯åä¾å­ãæä»¬è¦æ³¨æçæ¯å½æ°åå­è¦ç¬¦å jni çè§èï¼ä»¥å java å c è¯­è¨å¦ä½äºç¸ä¼ éåæ°ï¼æ¯å¦å¨ c è¯­è¨ææéï¼java æ²¡ææéçæ¦å¿µï¼æä»¥å¨ java ä¸­ç¨ long ç±»åæ¥è¡¨ç¤ºæéãaprendpoint ç acceptor ç»ä»¶å°±æ¯è°ç¨äº apr å®ç°çåä¸ª apiã\n\n# 3.1.2. poller\n\nacceptor æ¥æ¶å°ä¸ä¸ªæ°ç socket è¿æ¥åï¼æç§ nioendpoint çå®ç°ï¼å®ä¼æè¿ä¸ª socket äº¤ç» poller å»æ¥è¯¢ i/o äºä»¶ãaprendpoint ä¹æ¯è¿æ ·åçï¼ä¸è¿ aprendpoint ç poller å¹¶ä¸æ¯è°ç¨ java nio éç selector æ¥æ¥è¯¢ socket çç¶æï¼èæ¯éè¿ jni è°ç¨ apr ä¸­ç poll æ¹æ³ï¼è apr åæ¯è°ç¨äºæä½ç³»ç»ç epoll api æ¥å®ç°çã\n\nè¿éæä¸ªç¹å«çå°æ¹æ¯å¨ aprendpoint ä¸­ï¼æä»¬å¯ä»¥éç½®ä¸ä¸ªå«deferacceptçåæ°ï¼å®å¯¹åºçæ¯ tcp åè®®ä¸­çtcp_defer_acceptï¼è®¾ç½®è¿ä¸ªåæ°åï¼å½ tcp å®¢æ·ç«¯ææ°çè¿æ¥è¯·æ±å°è¾¾æ¶ï¼tcp æå¡ç«¯åä¸å»ºç«è¿æ¥ï¼èæ¯åç­ç­ï¼ç´å°å®¢æ·ç«¯æè¯·æ±æ°æ®åè¿æ¥æ¶åå»ºç«è¿æ¥ãè¿æ ·çå¥½å¤æ¯æå¡ç«¯ä¸éè¦ç¨ selector å»åå¤æ¥è¯¢è¯·æ±æ°æ®æ¯å¦å°±ç»ªã\n\nè¿æ¯ä¸ç§ tcp åè®®å±çä¼åï¼ä¸æ¯æ¯ä¸ªæä½ç³»ç»åæ ¸é½æ¯æï¼å ä¸º java ä½ä¸ºä¸ç§è·¨å¹³å°è¯­è¨ï¼éè¦å±è½åç§æä½ç³»ç»çå·®å¼ï¼å æ­¤å¹¶æ²¡ææè¿ä¸ªåæ°æä¾ç»ç¨æ·ï¼ä½æ¯å¯¹äº apr æ¥è¯´ï¼å®çç®çå°±æ¯å°½å¯è½æåæ§è½ï¼å æ­¤å®åç¨æ·æ´é²äºè¿ä¸ªåæ°ã\n\n\n# 3.2. apr æåæ§è½çç§å¯\n\napr è¿æ¥å¨ä¹æä»¥è½æé« tomcat çæ§è½ï¼é¤äº apr æ¬èº«æ¯ c ç¨åºåºä¹å¤ï¼è¿æåªäºæéçç§å¯å¢ï¼\n\njvm å  vs æ¬å°åå­\n\næä»¬ç¥é java çç±»å®ä¾ä¸è¬å¨ jvm å ä¸åéï¼è java æ¯éè¿ jni è°ç¨ c ä»£ç æ¥å®ç° socket éä¿¡çï¼é£ä¹ c ä»£ç å¨è¿è¡è¿ç¨ä¸­éè¦çåå­åæ¯ä»åªéåéçå¢ï¼c ä»£ç è½å¦ç´æ¥æä½ java å ï¼\n\nä¸ºäºåç­è¿äºé®é¢ï¼æåæ¥è¯´è¯´ jvm åç¨æ·è¿ç¨çå³ç³»ãå¦æä½ æ³è¿è¡ä¸ä¸ª java ç±»æä»¶ï¼å¯ä»¥ç¨ä¸é¢ç java å½ä»¤æ¥æ§è¡ã\n\njava my.class\n\n\nè¿ä¸ªå½ä»¤è¡ä¸­çjavaå¶å®æ¯ä¸ä¸ªå¯æ§è¡ç¨åºï¼è¿ä¸ªç¨åºä¼åå»º jvm æ¥å è½½åè¿è¡ä½ ç java ç±»ãæä½ç³»ç»ä¼åå»ºä¸ä¸ªè¿ç¨æ¥æ§è¡è¿ä¸ªjavaå¯æ§è¡ç¨åºï¼èæ¯ä¸ªè¿ç¨é½æèªå·±çèæå°åç©ºé´ï¼jvm ç¨å°çåå­ï¼åæ¬å ãæ åæ¹æ³åºï¼å°±æ¯ä»è¿ç¨çèæå°åç©ºé´ä¸åéçãè¯·ä½ æ³¨æçæ¯ï¼jvm åå­åªæ¯è¿ç¨ç©ºé´çä¸é¨åï¼é¤æ­¤ä¹å¤è¿ç¨ç©ºé´åè¿æä»£ç æ®µãæ°æ®æ®µãåå­æ å°åºãåæ ¸ç©ºé´ç­ãä» jvm çè§åº¦çï¼jvm åå­ä¹å¤çé¨åå«ä½æ¬å°åå­ï¼c ç¨åºä»£ç å¨è¿è¡è¿ç¨ä¸­ç¨å°çåå­å°±æ¯æ¬å°åå­ä¸­åéçãä¸é¢æä»¬éè¿ä¸å¼ å¾æ¥çè§£ä¸ä¸ã\n\n\n\ntomcat ç endpoint ç»ä»¶å¨æ¥æ¶ç½ç»æ°æ®æ¶éè¦é¢ååéå¥½ä¸å bufferï¼æè°ç buffer å°±æ¯å­èæ°ç»byte[]ï¼java éè¿ jni è°ç¨æè¿å buffer çå°åä¼ ç» c ä»£ç ï¼c ä»£ç éè¿æä½ç³»ç» api è¯»å socket å¹¶ææ°æ®å¡«åå°è¿å bufferãjava nio api æä¾äºä¸¤ç§ buffer æ¥æ¥æ¶æ°æ®ï¼heapbytebuffer å directbytebufferï¼ä¸é¢çä»£ç æ¼ç¤ºäºå¦ä½åå»ºä¸¤ç§ bufferã\n\n// åé heapbytebuffer\nbytebuffer buf = bytebuffer.allocate(1024);\n\n// åé directbytebuffer\nbytebuffer buf = bytebuffer.allocatedirect(1024);\n\n\nåå»ºå¥½ buffer åç´æ¥ä¼ ç» channel ç read æè write å½æ°ï¼æç»è¿å buffer ä¼éè¿ jni è°ç¨ä¼ éç» c ç¨åºã\n\n// å° buf ä½ä¸º read å½æ°çåæ°\nint bytesread = socketchannel.read(buf);\n\n\né£ heapbytebuffer å directbytebuffer æä»ä¹åºå«å¢ï¼heapbytebuffer å¯¹è±¡æ¬èº«å¨ jvm å ä¸åéï¼å¹¶ä¸å®ææçå­èæ°ç»byte[]ä¹æ¯å¨ jvm å ä¸åéãä½æ¯å¦æç¨heapbytebufferæ¥æ¥æ¶ç½ç»æ°æ®ï¼éè¦ææ°æ®ä»åæ ¸åæ·è´å°ä¸ä¸ªä¸´æ¶çæ¬å°åå­ï¼åä»ä¸´æ¶æ¬å°åå­æ·è´å° jvm å ï¼èä¸æ¯ç´æ¥ä»åæ ¸æ·è´å° jvm å ä¸ãè¿æ¯ä¸ºä»ä¹å¢ï¼è¿æ¯å ä¸ºæ°æ®ä»åæ ¸æ·è´å° jvm å çè¿ç¨ä¸­ï¼jvm å¯è½ä¼åç gcï¼gc è¿ç¨ä¸­å¯¹è±¡å¯è½ä¼è¢«ç§»å¨ï¼ä¹å°±æ¯è¯´ jvm å ä¸çå­èæ°ç»å¯è½ä¼è¢«ç§»å¨ï¼è¿æ ·çè¯ buffer å°åå°±å¤±æäºãå¦æè¿ä¸­é´ç»è¿æ¬å°åå­ä¸­è½¬ï¼ä»æ¬å°åå­å° jvm å çæ·è´è¿ç¨ä¸­ jvm å¯ä»¥ä¿è¯ä¸å gcã\n\nå¦æä½¿ç¨ heapbytebufferï¼ä½ ä¼åç° jvm å ååæ ¸ä¹é´å¤äºä¸å±ä¸­è½¬ï¼è directbytebuffer ç¨æ¥è§£å³è¿ä¸ªé®é¢ï¼directbytebuffer å¯¹è±¡æ¬èº«å¨ jvm å ä¸ï¼ä½æ¯å®ææçå­èæ°ç»ä¸æ¯ä» jvm å ä¸åéçï¼èæ¯ä»æ¬å°åå­åéçãdirectbytebuffer å¯¹è±¡ä¸­æä¸ª long ç±»åå­æ®µ addressï¼è®°å½çæ¬å°åå­çå°åï¼è¿æ ·å¨æ¥æ¶æ°æ®çæ¶åï¼ç´æ¥æè¿ä¸ªæ¬å°åå­å°åä¼ éç» c ç¨åºï¼c ç¨åºä¼å°ç½ç»æ°æ®ä»åæ ¸æ·è´å°è¿ä¸ªæ¬å°åå­ï¼jvm å¯ä»¥ç´æ¥è¯»åè¿ä¸ªæ¬å°åå­ï¼è¿ç§æ¹å¼æ¯ heapbytebuffer å°äºä¸æ¬¡æ·è´ï¼å æ­¤ä¸è¬æ¥è¯´å®çéåº¦ä¼æ¯ heapbytebuffer å¿«å¥½å åãä½ å¯ä»¥éè¿ä¸é¢çå¾å æ·±çè§£ã\n\ntomcat ä¸­ç aprendpoint å°±æ¯éè¿ directbytebuffer æ¥æ¥æ¶æ°æ®çï¼è nioendpoint å nio2endpoint æ¯éè¿ heapbytebuffer æ¥æ¥æ¶æ°æ®çãä½ å¯è½ä¼é®ï¼nioendpoint å nio2endpoint ä¸ºä»ä¹ä¸ç¨ directbytebuffer å¢ï¼è¿æ¯å ä¸ºæ¬å°åå­ä¸å¥½ç®¡çï¼åçåå­æ³æ¼é¾ä»¥å®ä½ï¼ä»ç¨³å®æ§èèï¼nioendpoint å nio2endpoint æ²¡æå»åè¿ä¸ªé©ã\n\n# 3.2.1. sendfile\n\næä»¬åæ¥èèå¦ä¸ä¸ªç½ç»éä¿¡çåºæ¯ï¼ä¹å°±æ¯éææä»¶çå¤çãæµè§å¨éè¿ tomcat æ¥è·åä¸ä¸ª html æä»¶ï¼è tomcat çå¤çé»è¾æ éæ¯ä¸¤æ­¥ï¼\n\n 1. ä»ç£çè¯»å html å°åå­ã\n 2. å°è¿æ®µåå­çåå®¹éè¿ socket åéåºå»ã\n\nä½æ¯å¨ä¼ ç»æ¹å¼ä¸ï¼æå¾å¤æ¬¡çåå­æ·è´ï¼\n\n * è¯»åæä»¶æ¶ï¼é¦åæ¯åæ ¸ææä»¶åå®¹è¯»åå°åæ ¸ç¼å²åºã\n * å¦æä½¿ç¨ heapbytebufferï¼æä»¶æ°æ®ä»åæ ¸å° jvm å åå­éè¦ç»è¿æ¬å°åå­ä¸­è½¬ã\n * åæ ·å¨å°æä»¶åå®¹æ¨å¥ç½ç»æ¶ï¼ä» jvm å å°åæ ¸ç¼å²åºéè¦ç»è¿æ¬å°åå­ä¸­è½¬ã\n * æåè¿éè¦ææä»¶ä»åæ ¸ç¼å²åºæ·è´å°ç½å¡ç¼å²åºã\n\nä»ä¸é¢çå¾ä½ ä¼åç°è¿ä¸ªè¿ç¨æ 6 æ¬¡åå­æ·è´ï¼å¹¶ä¸ read å write ç­ç³»ç»è°ç¨å°å¯¼è´è¿ç¨ä»ç¨æ·æå°åæ ¸æçåæ¢ï¼ä¼èè´¹å¤§éç cpu ååå­èµæºã\n\n\n\nè tomcat ç aprendpoint éè¿æä½ç³»ç»å±é¢ç sendfile ç¹æ§è§£å³äºè¿ä¸ªé®é¢ï¼sendfile ç³»ç»è°ç¨æ¹å¼éå¸¸ç®æ´ã\n\nsendfile(socket, file, len);\n\n\nå®å¸¦æä¸¤ä¸ªå³é®åæ°ï¼socket åæä»¶å¥æãå°æä»¶ä»ç£çåå¥ socket çè¿ç¨åªæä¸¤æ­¥ï¼\n\nç¬¬ä¸æ­¥ï¼å°æä»¶åå®¹è¯»åå°åæ ¸ç¼å²åºã\n\nç¬¬äºæ­¥ï¼æ°æ®å¹¶æ²¡æä»åæ ¸ç¼å²åºå¤å¶å° socket å³èçç¼å²åºï¼åªæè®°å½æ°æ®ä½ç½®åé¿åº¦çæè¿°ç¬¦è¢«æ·»å å° socket ç¼å²åºä¸­ï¼æ¥çææ°æ®ç´æ¥ä»åæ ¸ç¼å²åºä¼ éç»ç½å¡ãè¿ä¸ªè¿ç¨ä½ å¯ä»¥çä¸é¢çå¾ã\n\n\n\n\n# 4. executor ç»ä»¶\n\nä¸ºäºæé«å¤çè½ååå¹¶ååº¦ï¼web å®¹å¨ä¸è¬ä¼æå¤çè¯·æ±çå·¥ä½æ¾å°çº¿ç¨æ± éæ¥æ§è¡ï¼tomcat æ©å±äºåçç java çº¿ç¨æ± ï¼æ¥æ»¡è¶³ web å®¹å¨é«å¹¶åçéæ±ã\n\n\n# 4.1. tomcat å®å¶çº¿ç¨æ± \n\ntomcat ççº¿ç¨æ± ä¹æ¯ä¸ä¸ªå®å¶çç threadpoolexecutorãtomcat ä¼ å¥çåæ°æ¯è¿æ ·çï¼\n\n// å®å¶ççä»»å¡éå\ntaskqueue = new taskqueue(maxqueuesize);\n\n// å®å¶çççº¿ç¨å·¥å\ntaskthreadfactory tf = new taskthreadfactory(nameprefix,daemon,getthreadpriority());\n\n// å®å¶çççº¿ç¨æ± \nexecutor = new threadpoolexecutor(getminsparethreads(), getmaxthreads(), maxidletime, timeunit.milliseconds,taskqueue, tf);\n\n\nå¶ä¸­çä¸¤ä¸ªå³é®ç¹ï¼\n\n * tomcat æèªå·±çå®å¶çä»»å¡éååçº¿ç¨å·¥åï¼å¹¶ä¸å¯ä»¥éå¶ä»»å¡éåçé¿åº¦ï¼å®çæå¤§é¿åº¦æ¯ maxqueuesizeã\n * tomcat å¯¹çº¿ç¨æ°ä¹æéå¶ï¼è®¾ç½®äºæ ¸å¿çº¿ç¨æ°ï¼minsparethreadsï¼åæå¤§çº¿ç¨æ± æ°ï¼maxthreadsï¼ã\n\né¤äºèµæºéå¶ä»¥å¤ï¼tomcat çº¿ç¨æ± è¿å®å¶èªå·±çä»»å¡å¤çæµç¨ãæä»¬ç¥é java åççº¿ç¨æ± çä»»å¡å¤çé»è¾æ¯è¾ç®åï¼\n\n 1. å corepoolsize ä¸ªä»»å¡æ¶ï¼æ¥ä¸ä¸ªä»»å¡å°±åå»ºä¸ä¸ªæ°çº¿ç¨ã\n 2. åé¢åæ¥ä»»å¡ï¼å°±æä»»å¡æ·»å å°ä»»å¡éåéè®©ææççº¿ç¨å»æ¢ï¼å¦æéåæ»¡äºå°±åå»ºä¸´æ¶çº¿ç¨ã\n 3. å¦ææ»çº¿ç¨æ°è¾¾å° maximumpoolsizeï¼æ§è¡æç»ç­ç¥ã\n\ntomcat çº¿ç¨æ± æ©å±äºåçç threadpoolexecutorï¼éè¿éå execute æ¹æ³å®ç°äºèªå·±çä»»å¡å¤çé»è¾ï¼\n\n 1. å corepoolsize ä¸ªä»»å¡æ¶ï¼æ¥ä¸ä¸ªä»»å¡å°±åå»ºä¸ä¸ªæ°çº¿ç¨ã\n 2. åæ¥ä»»å¡çè¯ï¼å°±æä»»å¡æ·»å å°ä»»å¡éåéè®©ææççº¿ç¨å»æ¢ï¼å¦æéåæ»¡äºå°±åå»ºä¸´æ¶çº¿ç¨ã\n 3. å¦ææ»çº¿ç¨æ°è¾¾å° maximumpoolsizeï¼åç»§ç»­å°è¯æä»»å¡æ·»å å°ä»»å¡éåä¸­å»ã\n 4. å¦æç¼å²éåä¹æ»¡äºï¼æå¥å¤±è´¥ï¼æ§è¡æç»ç­ç¥ã\n\nè§å¯ tomcat çº¿ç¨æ± å java åççº¿ç¨æ± çåºå«ï¼å¶å®å°±æ¯å¨ç¬¬ 3 æ­¥ï¼tomcat å¨çº¿ç¨æ»æ°è¾¾å°æå¤§æ°æ¶ï¼ä¸æ¯ç«å³æ§è¡æç»ç­ç¥ï¼èæ¯åå°è¯åä»»å¡éåæ·»å ä»»å¡ï¼æ·»å å¤±è´¥ååæ§è¡æç»ç­ç¥ãé£å·ä½å¦ä½å®ç°å¢ï¼å¶å®å¾ç®åï¼æä»¬æ¥çä¸ä¸ tomcat çº¿ç¨æ± ç execute æ¹æ³çæ ¸å¿ä»£ç ã\n\npublic class threadpoolexecutor extends java.util.concurrent.threadpoolexecutor {\n\n  ...\n\n  public void execute(runnable command, long timeout, timeunit unit) {\n      submittedcount.incrementandget();\n      try {\n          // è°ç¨ java åççº¿ç¨æ± ç execute å»æ§è¡ä»»å¡\n          super.execute(command);\n      } catch (rejectedexecutionexception rx) {\n         // å¦ææ»çº¿ç¨æ°è¾¾å° maximumpoolsizeï¼java åççº¿ç¨æ± æ§è¡æç»ç­ç¥\n          if (super.getqueue() instanceof taskqueue) {\n              final taskqueue queue = (taskqueue)super.getqueue();\n              try {\n                  // ç»§ç»­å°è¯æä»»å¡æ¾å°ä»»å¡éåä¸­å»\n                  if (!queue.force(command, timeout, unit)) {\n                      submittedcount.decrementandget();\n                      // å¦æç¼å²éåä¹æ»¡äºï¼æå¥å¤±è´¥ï¼æ§è¡æç»ç­ç¥ã\n                      throw new rejectedexecutionexception("...");\n                  }\n              }\n          }\n      }\n}\n\n\nä»è¿ä¸ªæ¹æ³ä½ å¯ä»¥çå°ï¼tomcat çº¿ç¨æ± ç execute æ¹æ³ä¼è°ç¨ java åççº¿ç¨æ± ç execute å»æ§è¡ä»»å¡ï¼å¦ææ»çº¿ç¨æ°è¾¾å° maximumpoolsizeï¼java åççº¿ç¨æ± ç execute æ¹æ³ä¼æåº rejectedexecutionexception å¼å¸¸ï¼ä½æ¯è¿ä¸ªå¼å¸¸ä¼è¢« tomcat çº¿ç¨æ± ç execute æ¹æ³æè·å°ï¼å¹¶ç»§ç»­å°è¯æè¿ä¸ªä»»å¡æ¾å°ä»»å¡éåä¸­å»ï¼å¦æä»»å¡éåä¹æ»¡äºï¼åæ§è¡æç»ç­ç¥ã\n\n\n# 4.2. tomcat å®å¶ä»»å¡éå\n\nç»å¿çä½ ææ²¡æåç°ï¼å¨ tomcat çº¿ç¨æ± ç execute æ¹æ³æå¼å§æè¿ä¹ä¸è¡ï¼\n\nsubmittedcount.incrementandget();\n\n\nè¿è¡ä»£ç çæææ submittedcount è¿ä¸ªåå­åéå ä¸ï¼å¹¶ä¸å¨ä»»å¡æ§è¡å¤±è´¥ï¼æåºæç»å¼å¸¸æ¶ï¼å°è¿ä¸ªåå­åéåä¸ï¼\n\nsubmittedcount.decrementandget();\n\n\nå¶å® tomcat çº¿ç¨æ± æ¯ç¨è¿ä¸ªåé submittedcount æ¥ç»´æ¤å·²ç»æäº¤å°äºçº¿ç¨æ± ï¼ä½æ¯è¿æ²¡ææ§è¡å®çä»»å¡ä¸ªæ°ãtomcat ä¸ºä»ä¹è¦ç»´æ¤è¿ä¸ªåéå¢ï¼è¿è· tomcat çå®å¶ççä»»å¡éåæå³ãtomcat çä»»å¡éå taskqueue æ©å±äº java ä¸­ç linkedblockingqueueï¼æä»¬ç¥é linkedblockingqueue é»è®¤æåµä¸é¿åº¦æ¯æ²¡æéå¶çï¼é¤éç»å®ä¸ä¸ª capacityãå æ­¤ tomcat ç»äºå®ä¸ä¸ª capacityï¼taskqueue çæé å½æ°ä¸­æä¸ªæ´åçåæ° capacityï¼taskqueue å° capacity ä¼ ç»ç¶ç±» linkedblockingqueue çæé å½æ°ã\n\npublic class taskqueue extends linkedblockingqueue<runnable> {\n\n  public taskqueue(int capacity) {\n      super(capacity);\n  }\n  ...\n}\n\n\nè¿ä¸ª capacity åæ°æ¯éè¿ tomcat ç maxqueuesize åæ°æ¥è®¾ç½®çï¼ä½é®é¢æ¯é»è®¤æåµä¸ maxqueuesize çå¼æ¯integer.max_valueï¼ç­äºæ²¡æéå¶ï¼è¿æ ·å°±å¸¦æ¥ä¸ä¸ªé®é¢ï¼å½åçº¿ç¨æ°è¾¾å°æ ¸å¿çº¿ç¨æ°ä¹åï¼åæ¥ä»»å¡çè¯çº¿ç¨æ± ä¼æä»»å¡æ·»å å°ä»»å¡éåï¼å¹¶ä¸æ»æ¯ä¼æåï¼è¿æ ·æ°¸è¿ä¸ä¼ææºä¼åå»ºæ°çº¿ç¨äºã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼taskqueue éåäº linkedblockingqueue ç offer æ¹æ³ï¼å¨åéçæ¶æºè¿å falseï¼è¿å false è¡¨ç¤ºä»»å¡æ·»å å¤±è´¥ï¼è¿æ¶çº¿ç¨æ± ä¼åå»ºæ°ççº¿ç¨ãé£ä»ä¹æ¯åéçæ¶æºå¢ï¼è¯·çä¸é¢ offer æ¹æ³çæ ¸å¿æºç ï¼\n\npublic class taskqueue extends linkedblockingqueue<runnable> {\n\n  ...\n   @override\n  // çº¿ç¨æ± è°ç¨ä»»å¡éåçæ¹æ³æ¶ï¼å½åçº¿ç¨æ°è¯å®å·²ç»å¤§äºæ ¸å¿çº¿ç¨æ°äº\n  public boolean offer(runnable o) {\n\n      // å¦æçº¿ç¨æ°å·²ç»å°äºæå¤§å¼ï¼ä¸è½åå»ºæ°çº¿ç¨äºï¼åªè½æä»»å¡æ·»å å°ä»»å¡éåã\n      if (parent.getpoolsize() == parent.getmaximumpoolsize())\n          return super.offer(o);\n\n      // æ§è¡å°è¿éï¼è¡¨æå½åçº¿ç¨æ°å¤§äºæ ¸å¿çº¿ç¨æ°ï¼å¹¶ä¸å°äºæå¤§çº¿ç¨æ°ã\n      // è¡¨ææ¯å¯ä»¥åå»ºæ°çº¿ç¨çï¼é£å°åºè¦ä¸è¦åå»ºå¢ï¼åä¸¤ç§æåµï¼\n\n      //1. å¦æå·²æäº¤çä»»å¡æ°å°äºå½åçº¿ç¨æ°ï¼è¡¨ç¤ºè¿æç©ºé²çº¿ç¨ï¼æ éåå»ºæ°çº¿ç¨\n      if (parent.getsubmittedcount()<=(parent.getpoolsize()))\n          return super.offer(o);\n\n      //2. å¦æå·²æäº¤çä»»å¡æ°å¤§äºå½åçº¿ç¨æ°ï¼çº¿ç¨ä¸å¤ç¨äºï¼è¿å false å»åå»ºæ°çº¿ç¨\n      if (parent.getpoolsize()<parent.getmaximumpoolsize())\n          return false;\n\n      // é»è®¤æåµä¸æ»æ¯æä»»å¡æ·»å å°ä»»å¡éå\n      return super.offer(o);\n  }\n\n}\n\n\nä»ä¸é¢çä»£ç æä»¬çå°ï¼åªæå½åçº¿ç¨æ°å¤§äºæ ¸å¿çº¿ç¨æ°ãå°äºæå¤§çº¿ç¨æ°ï¼å¹¶ä¸å·²æäº¤çä»»å¡ä¸ªæ°å¤§äºå½åçº¿ç¨æ°æ¶ï¼ä¹å°±æ¯è¯´çº¿ç¨ä¸å¤ç¨äºï¼ä½æ¯çº¿ç¨æ°åæ²¡è¾¾å°æéï¼æä¼å»åå»ºæ°ççº¿ç¨ãè¿å°±æ¯ä¸ºä»ä¹ tomcat éè¦ç»´æ¤å·²æäº¤ä»»å¡æ°è¿ä¸ªåéï¼å®çç®çå°±æ¯å¨ä»»å¡éåçé¿åº¦æ éå¶çæåµä¸ï¼è®©çº¿ç¨æ± ææºä¼åå»ºæ°ççº¿ç¨ã\n\nå½ç¶é»è®¤æåµä¸ tomcat çä»»å¡éåæ¯æ²¡æéå¶çï¼ä½ å¯ä»¥éè¿è®¾ç½® maxqueuesize åæ°æ¥éå¶ä»»å¡éåçé¿åº¦ã\n\n\n# 5. websocket ç»ä»¶\n\nhttp åè®®æ¯âè¯·æ± - ååºâæ¨¡å¼ï¼æµè§å¨å¿é¡»ååè¯·æ±ç»æå¡å¨ï¼æå¡å¨æä¼ååºè¿ä¸ªè¯·æ±ãä¹å°±æ¯è¯´ï¼æå¡å¨ä¸ä¼ä¸»å¨åéæ°æ®ç»æµè§å¨ã\n\nå¯¹äºå®æ¶æ§è¦æ±æ¯è¾çé«çåºç¨ï¼æ¯å¦å¨çº¿æ¸¸æãè¡ç¥¨åºéå®æ¶æ¥ä»·åå¨çº¿ååç¼è¾ç­ï¼æµè§å¨éè¦å®æ¶æ¾ç¤ºæå¡å¨ä¸ææ°çæ°æ®ï¼å æ­¤åºç°äº ajax å comet ææ¯ãajax æ¬è´¨ä¸è¿æ¯è½®è¯¢ï¼è comet æ¯å¨ http é¿è¿æ¥çåºç¡ä¸åäºä¸äº hackï¼ä½æ¯å®ä»¬çå®æ¶æ§ä¸é«ï¼å¦å¤é¢ç¹çè¯·æ±ä¼ç»æå¡å¨å¸¦æ¥ååï¼ä¹ä¼æµªè´¹ç½ç»æµéåå¸¦å®½ãäºæ¯ html5 æ¨åºäº websocket æ åï¼ä½¿å¾æµè§å¨åæå¡å¨ä¹é´ä»»ä½ä¸æ¹é½å¯ä»¥ä¸»å¨åæ¶æ¯ç»å¯¹æ¹ï¼è¿æ ·æå¡å¨ææ°æ°æ®æ¶å¯ä»¥ä¸»å¨æ¨éç»æµè§å¨ã\n\ntomcat å¦ä½æ¯æ websocketï¼ç®åæ¥è¯´ï¼tomcat åäºä¸¤ä»¶äºï¼\n\n * endpoint å è½½\n * websocket è¯·æ±å¤ç\n\n\n# 5.1. websocket å è½½\n\ntomcat ç websocket å è½½æ¯éè¿ sci æºå¶å®æçãsci å¨ç§° servletcontainerinitializerï¼æ¯ servlet 3.0 è§èä¸­å®ä¹çç¨æ¥æ¥æ¶ web åºç¨å¯å¨äºä»¶çæ¥å£ãé£ä¸ºä»ä¹è¦çå¬ servlet å®¹å¨çå¯å¨äºä»¶å¢ï¼å ä¸ºè¿æ ·æä»¬ææºä¼å¨ web åºç¨å¯å¨æ¶åä¸äºåå§åå·¥ä½ï¼æ¯å¦ websocket éè¦æ«æåå è½½ endpoint ç±»ãsci çä½¿ç¨ä¹æ¯è¾ç®åï¼å°å®ç° servletcontainerinitializer æ¥å£çç±»å¢å  handlestypes æ³¨è§£ï¼å¹¶ä¸å¨æ³¨è§£åæå®çä¸ç³»åç±»åæ¥å£éåãæ¯å¦ tomcat ä¸ºäºæ«æåå è½½ endpoint èå®ä¹ç sci ç±»å¦ä¸ï¼\n\n@handlestypes({serverendpoint.class, serverapplicationconfig.class, endpoint.class})\npublic class wssci implements servletcontainerinitializer {\n\n  public void onstartup(set<class<?>> clazzes, servletcontext ctx) throws servletexception {\n  ...\n  }\n}\n\n\nä¸æ¦å®ä¹å¥½äº sciï¼tomcat å¨å¯å¨é¶æ®µæ«æç±»æ¶ï¼ä¼å° handlestypes æ³¨è§£ä¸­æå®çç±»é½æ«æåºæ¥ï¼ä½ä¸º sci ç onstartup æ¹æ³çåæ°ï¼å¹¶è°ç¨ sci ç onstartup æ¹æ³ãæ³¨æå° wssci ç handlestypes æ³¨è§£ä¸­å®ä¹äºserverendpoint.classãserverapplicationconfig.classåendpoint.classï¼å æ­¤å¨ tomcat çå¯å¨é¶æ®µä¼å°è¿äºç±»çç±»å®ä¾ï¼æ³¨æä¸æ¯å¯¹è±¡å®ä¾ï¼ä¼ éç» wssci ç onstartup æ¹æ³ãé£ä¹ wssci ç onstartup æ¹æ³ååäºä»ä¹äºå¢ï¼\n\nå®ä¼æé ä¸ä¸ª websocketcontainer å®ä¾ï¼ä½ å¯ä»¥æ websocketcontainer çè§£æä¸ä¸ªä¸é¨å¤ç websocket è¯·æ±çendpoint å®¹å¨ãä¹å°±æ¯è¯´ tomcat ä¼ææ«æå°ç endpoint å­ç±»åæ·»å äºæ³¨è§£@serverendpointçç±»æ³¨åå°è¿ä¸ªå®¹å¨ä¸­ï¼å¹¶ä¸è¿ä¸ªå®¹å¨è¿ç»´æ¤äº url å° endpoint çæ å°å³ç³»ï¼è¿æ ·éè¿è¯·æ± url å°±è½æ¾å°å·ä½ç endpoint æ¥å¤ç websocket è¯·æ±ã\n\n\n# 5.2. websocket è¯·æ±å¤ç\n\ntomcat ç¨ protocolhandler ç»ä»¶å±è½åºç¨å±åè®®çå·®å¼ï¼å¶ä¸­ protocolhandler ä¸­æä¸¤ä¸ªå³é®ç»ä»¶ï¼endpoint å processorãéè¦æ³¨æï¼è¿éç endpoint è·ä¸ææå°ç websocket ä¸­ç endpoint å®å¨æ¯ä¸¤åäºï¼è¿æ¥å¨ä¸­ç endpoint ç»ä»¶ç¨æ¥å¤ç i/o éä¿¡ãwebsocket æ¬è´¨å°±æ¯ä¸ä¸ªåºç¨å±åè®®ï¼å æ­¤ä¸è½ç¨ httpprocessor æ¥å¤ç websocket è¯·æ±ï¼èè¦ç¨ä¸é¨ processor æ¥å¤çï¼èå¨ tomcat ä¸­è¿æ ·ç processor å«ä½ upgradeprocessorã\n\nä¸ºä»ä¹å« upgrade processor å¢ï¼è¿æ¯å ä¸º tomcat æ¯å° http åè®®åçº§æ websocket åè®®çã\n\nwebsocket æ¯éè¿ http åè®®æ¥è¿è¡æ¡æçï¼å æ­¤å½ websocket çæ¡æè¯·æ±å°æ¥æ¶ï¼httpprotocolhandler é¦åæ¥æ¶å°è¿ä¸ªè¯·æ±ï¼å¨å¤çè¿ä¸ª http è¯·æ±æ¶ï¼tomcat éè¿ä¸ä¸ªç¹æ®ç filter å¤æ­è¯¥å½å http è¯·æ±æ¯å¦æ¯ä¸ä¸ª websocket upgrade è¯·æ±ï¼å³åå«upgrade: websocketç http å¤´ä¿¡æ¯ï¼ï¼å¦ææ¯ï¼åå¨ http ååºéæ·»å  websocket ç¸å³çååºå¤´ä¿¡æ¯ï¼å¹¶è¿è¡åè®®åçº§ãå·ä½æ¥è¯´å°±æ¯ç¨ upgradeprotocolhandler æ¿æ¢å½åç httpprotocolhandlerï¼ç¸åºçï¼æå½å socket ç processor æ¿æ¢æ upgradeprocessorï¼åæ¶ tomcat ä¼åå»º websocket session å®ä¾å endpoint å®ä¾ï¼å¹¶è·å½åç websocket è¿æ¥ä¸ä¸å¯¹åºèµ·æ¥ãè¿ä¸ª websocket è¿æ¥ä¸ä¼ç«å³å³é­ï¼å¹¶ä¸å¨è¯·æ±å¤çä¸­ï¼ä¸åä½¿ç¨åæç httpprocessorï¼èæ¯ç¨ä¸é¨ç upgradeprocessorï¼upgradeprocessor æç»ä¼è°ç¨ç¸åºç endpoint å®ä¾æ¥å¤çè¯·æ±ã\n\n\n\nä½ å¯ä»¥çå°ï¼tomcat å¯¹ websocket è¯·æ±çå¤çæ²¡æç»è¿ servlet å®¹å¨ï¼èæ¯éè¿ upgradeprocessor ç»ä»¶ç´æ¥æè¯·æ±åå° serverendpoint å®ä¾ï¼å¹¶ä¸ tomcat ç websocket å®ç°ä¸éè¦å³æ³¨å·ä½ i/o æ¨¡åçç»èï¼ä»èå®ç°äºä¸å·ä½ i/o æ¹å¼çè§£è¦ã\n\n\n# 6. åèèµæ\n\n * å®æ¹\n   * tomcat å®æ¹ç½ç«\n   * tomcat wiki\n   * tomee å®æ¹ç½ç«\n * æç¨\n   * æ·±å¥æè§£ tomcat & jetty',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Tomcatå®¹å¨",frontmatter:{title:"Tomcatå®¹å¨",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Tomcat"],abbrlink:"fc56014a",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/2fea08/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/01.Tomcat/03.Tomcat%E5%AE%B9%E5%99%A8.html",relativePath:"02.JavaEE/02.æå¡å¨/01.Tomcat/03.Tomcatå®¹å¨.md",key:"v-0a24b240",path:"/pages/2fea08/",headers:[{level:2,title:"Tomcat å®ç°ç­é¨ç½²åç­å è½½",slug:"tomcat-å®ç°ç­é¨ç½²åç­å è½½",normalizedTitle:"tomcat å®ç°ç­é¨ç½²åç­å è½½",charIndex:16},{level:3,title:"ContainerBackgroundProcessor å®ç°",slug:"containerbackgroundprocessor-å®ç°",normalizedTitle:"containerbackgroundprocessor å®ç°",charIndex:732},{level:3,title:"backgroundProcess æ¹æ³",slug:"backgroundprocess-æ¹æ³",normalizedTitle:"backgroundprocess æ¹æ³",charIndex:1101},{level:3,title:"Tomcat ç­å è½½",slug:"tomcat-ç­å è½½",normalizedTitle:"tomcat ç­å è½½",charIndex:3363},{level:3,title:"Tomcat ç­é¨ç½²",slug:"tomcat-ç­é¨ç½²",normalizedTitle:"tomcat ç­é¨ç½²",charIndex:4898},{level:2,title:"Tomcat çç±»å è½½æºå¶",slug:"tomcat-çç±»å è½½æºå¶",normalizedTitle:"tomcat çç±»å è½½æºå¶",charIndex:6049},{level:3,title:"findClass æ¹æ³",slug:"findclass-æ¹æ³",normalizedTitle:"findclass æ¹æ³",charIndex:6213},{level:3,title:"loadClass æ¹æ³",slug:"loadclass-æ¹æ³",normalizedTitle:"loadclass æ¹æ³",charIndex:7015},{level:3,title:"Tomcat å®ç°åºç¨éç¦»",slug:"tomcat-å®ç°åºç¨éç¦»",normalizedTitle:"tomcat å®ç°åºç¨éç¦»",charIndex:9756},{level:4,title:"WebAppClassLoader",slug:"webappclassloader",normalizedTitle:"webappclassloader",charIndex:6080},{level:4,title:"SharedClassLoader",slug:"sharedclassloader",normalizedTitle:"sharedclassloader",charIndex:10577},{level:4,title:"CatalinaClassloader",slug:"catalinaclassloader",normalizedTitle:"catalinaclassloader",charIndex:10953},{level:4,title:"CommonClassLoader",slug:"commonclassloader",normalizedTitle:"commonclassloader",charIndex:11185},{level:2,title:"Tomcat å®ç° Servlet è§è",slug:"tomcat-å®ç°-servlet-è§è",normalizedTitle:"tomcat å®ç° servlet è§è",charIndex:11493},{level:3,title:"Servlet ç®¡ç",slug:"servlet-ç®¡ç",normalizedTitle:"servlet ç®¡ç",charIndex:11984},{level:3,title:"Filter ç®¡ç",slug:"filter-ç®¡ç",normalizedTitle:"filter ç®¡ç",charIndex:14030},{level:3,title:"Listener ç®¡ç",slug:"listener-ç®¡ç",normalizedTitle:"listener ç®¡ç",charIndex:16214},{level:2,title:"Tomcat æ¯æå¼æ­¥ Servlet",slug:"tomcat-æ¯æå¼æ­¥-servlet",normalizedTitle:"tomcat æ¯æå¼æ­¥ servlet",charIndex:17460},{level:3,title:"å¼æ­¥ç¤ºä¾",slug:"å¼æ­¥ç¤ºä¾",normalizedTitle:"å¼æ­¥ç¤ºä¾",charIndex:17484},{level:3,title:"å¼æ­¥ Servlet åç",slug:"å¼æ­¥-servlet-åç",normalizedTitle:"å¼æ­¥ servlet åç",charIndex:18733},{level:4,title:"startAsync æ¹æ³",slug:"startasync-æ¹æ³",normalizedTitle:"startasync æ¹æ³",charIndex:18426},{level:4,title:"complete æ¹æ³",slug:"complete-æ¹æ³",normalizedTitle:"complete æ¹æ³",charIndex:18208},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:22919}],headersStr:"Tomcat å®ç°ç­é¨ç½²åç­å è½½ ContainerBackgroundProcessor å®ç° backgroundProcess æ¹æ³ Tomcat ç­å è½½ Tomcat ç­é¨ç½² Tomcat çç±»å è½½æºå¶ findClass æ¹æ³ loadClass æ¹æ³ Tomcat å®ç°åºç¨éç¦» WebAppClassLoader SharedClassLoader CatalinaClassloader CommonClassLoader Tomcat å®ç° Servlet è§è Servlet ç®¡ç Filter ç®¡ç Listener ç®¡ç Tomcat æ¯æå¼æ­¥ Servlet å¼æ­¥ç¤ºä¾ å¼æ­¥ Servlet åç startAsync æ¹æ³ complete æ¹æ³ åèèµæ",content:'# Tomcat å®¹å¨\n\n\n# Tomcat å®ç°ç­é¨ç½²åç­å è½½\n\n * ç­å è½½çå®ç°æ¹å¼æ¯ Web å®¹å¨å¯å¨ä¸ä¸ªåå°çº¿ç¨ï¼å®ææ£æµç±»æä»¶çååï¼å¦ææååï¼å°±éæ°å è½½ç±»ï¼å¨è¿ä¸ªè¿ç¨ä¸­ä¸ä¼æ¸ç©º Session ï¼ä¸è¬ç¨å¨å¼åç¯å¢ã\n * ç­é¨ç½²åçç±»ä¼¼ï¼ä¹æ¯ç±åå°çº¿ç¨å®æ¶æ£æµ Web åºç¨çååï¼ä½å®ä¼éæ°å è½½æ´ä¸ª Web åºç¨ãè¿ç§æ¹å¼ä¼æ¸ç©º Sessionï¼æ¯ç­å è½½æ´å å¹²åãå½»åºï¼ä¸è¬ç¨å¨çäº§ç¯å¢ã\n\nTomcat éè¿å¼å¯åå°çº¿ç¨ï¼ä½¿å¾åä¸ªå±æ¬¡çå®¹å¨ç»ä»¶é½ææºä¼å®æä¸äºå¨ææ§ä»»å¡ãTomcat æ¯åºäº ScheduledThreadPoolExecutor å®ç°å¨ææ§ä»»å¡çï¼\n\nbgFuture = exec.scheduleWithFixedDelay(\n              new ContainerBackgroundProcessor(),// è¦æ§è¡ç Runnable\n              backgroundProcessorDelay, // ç¬¬ä¸æ¬¡æ§è¡å»¶è¿å¤ä¹\n              backgroundProcessorDelay, // ä¹åæ¯æ¬¡æ§è¡é´éå¤ä¹\n              TimeUnit.SECONDS);        // æ¶é´åä½\n\n\nç¬¬ä¸ä¸ªåæ°å°±æ¯è¦å¨ææ§æ§è¡çä»»å¡ç±» ContainerBackgroundProcessorï¼å®æ¯ä¸ä¸ª Runnableï¼åæ¶ä¹æ¯ ContainerBase çåé¨ç±»ï¼ContainerBase æ¯ææå®¹å¨ç»ä»¶çåºç±»ï¼æä»¬æ¥åå¿ä¸ä¸å®¹å¨ç»ä»¶æåªäºï¼æ EngineãHostãContext å Wrapper ç­ï¼å®ä»¬å·æç¶å­å³ç³»ã\n\n\n# ContainerBackgroundProcessor å®ç°\n\næä»¬æ¥æ¥ç ContainerBackgroundProcessor å·ä½æ¯å¦ä½å®ç°çã\n\nprotected class ContainerBackgroundProcessor implements Runnable {\n\n    @Override\n    public void run() {\n        // è¯·æ³¨æè¿éä¼ å¥çåæ°æ¯ " å®¿ä¸»ç±» " çå®ä¾\n        processChildren(ContainerBase.this);\n    }\n\n    protected void processChildren(Container container) {\n        try {\n            //1. è°ç¨å½åå®¹å¨ç backgroundProcess æ¹æ³ã\n            container.backgroundProcess();\n\n            //2. éåææçå­å®¹å¨ï¼éå½è°ç¨ processChildrenï¼\n            // è¿æ ·å½åå®¹å¨çå­å­é½ä¼è¢«å¤ç\n            Container[] children = container.findChildren();\n            for (int i = 0; i < children.length; i++) {\n            // è¿éè¯·ä½ æ³¨æï¼å®¹å¨åºç±»æä¸ªåéå«å backgroundProcessorDelayï¼å¦æå¤§äº 0ï¼è¡¨æå­å®¹å¨æèªå·±çåå°çº¿ç¨ï¼æ éç¶å®¹å¨æ¥è°ç¨å®ç processChildren æ¹æ³ã\n                if (children[i].getBackgroundProcessorDelay() <= 0) {\n                    processChildren(children[i]);\n                }\n            }\n        } catch (Throwable t) { ... }\n\n\nä¸é¢çä»£ç é»è¾ä¹æ¯æ¯è¾æ¸æ°çï¼é¦å ContainerBackgroundProcessor æ¯ä¸ä¸ª Runnableï¼å®éè¦å®ç° run æ¹æ³ï¼å®ç run å¾ç®åï¼å°±æ¯è°ç¨äº processChildren æ¹æ³ãè¿éæä¸ªå°æå·§ï¼å®æâå®¿ä¸»ç±»âï¼ä¹å°±æ¯ContainerBase çç±»å®ä¾å½æåæ°ä¼ ç»äº run æ¹æ³ã\n\nèå¨ processChildren æ¹æ³éï¼å°±åäºä¸¤æ­¥ï¼è°ç¨å½åå®¹å¨ç backgroundProcess æ¹æ³ï¼ä»¥åéå½è°ç¨å­å­ç backgroundProcess æ¹æ³ãè¯·ä½ æ³¨æ backgroundProcess æ¯ Container æ¥å£ä¸­çæ¹æ³ï¼ä¹å°±æ¯è¯´ææç±»åçå®¹å¨é½å¯ä»¥å®ç°è¿ä¸ªæ¹æ³ï¼å¨è¿ä¸ªæ¹æ³éå®æéè¦å¨ææ§æ§è¡çä»»å¡ã\n\nè¿æ ·çè®¾è®¡æå³çä»ä¹å¢ï¼æä»¬åªéè¦å¨é¡¶å±å®¹å¨ï¼ä¹å°±æ¯ Engine å®¹å¨ä¸­å¯å¨ä¸ä¸ªåå°çº¿ç¨ï¼é£ä¹è¿ä¸ªçº¿ç¨ä¸ä½ä¼æ§è¡ Engine å®¹å¨çå¨ææ§ä»»å¡ï¼å®è¿ä¼æ§è¡ææå­å®¹å¨çå¨ææ§ä»»å¡ã\n\n\n# backgroundProcess æ¹æ³\n\nä¸è¿°ä»£ç é½æ¯å¨åºç±» ContainerBase ä¸­å®ç°çï¼é£å·ä½å®¹å¨ç±»éè¦åä»ä¹å¢ï¼å¶å®å¾ç®åï¼å¦ææå¨ææ§ä»»å¡è¦æ§è¡ï¼å°±å®ç° backgroundProcess æ¹æ³ï¼å¦ææ²¡æï¼å°±éç¨åºç±» ContainerBase çæ¹æ³ãContainerBase ç backgroundProcess æ¹æ³å®ç°å¦ä¸ï¼\n\npublic void backgroundProcess() {\n\n    //1. æ§è¡å®¹å¨ä¸­ Cluster ç»ä»¶çå¨ææ§ä»»å¡\n    Cluster cluster = getClusterInternal();\n    if (cluster != null) {\n        cluster.backgroundProcess();\n    }\n\n    //2. æ§è¡å®¹å¨ä¸­ Realm ç»ä»¶çå¨ææ§ä»»å¡\n    Realm realm = getRealmInternal();\n    if (realm != null) {\n        realm.backgroundProcess();\n   }\n\n   //3. æ§è¡å®¹å¨ä¸­ Valve ç»ä»¶çå¨ææ§ä»»å¡\n    Valve current = pipeline.getFirst();\n    while (current != null) {\n       current.backgroundProcess();\n       current = current.getNext();\n    }\n\n    //4. è§¦åå®¹å¨ç " å¨æäºä»¶ "ï¼Host å®¹å¨ççå¬å¨ HostConfig å°±é å®æ¥è°ç¨\n    fireLifecycleEvent(Lifecycle.PERIODIC_EVENT, null);\n}\n\n\nä»ä¸é¢çä»£ç å¯ä»¥çå°ï¼ä¸ä»æ¯ä¸ªå®¹å¨å¯ä»¥æå¨ææ§ä»»å¡ï¼æ¯ä¸ªå®¹å¨ä¸­çå¶ä»éç¨ç»ä»¶ï¼æ¯å¦è·éç¾¤ç®¡çæå³ç Cluster ç»ä»¶ãè·å®å¨ç®¡çæå³ç Realm ç»ä»¶é½å¯ä»¥æèªå·±çå¨ææ§ä»»å¡ã\n\næå¨åé¢çä¸æ éæå°è¿ï¼å®¹å¨ä¹é´çé¾å¼è°ç¨æ¯éè¿ Pipeline-Valve æºå¶æ¥å®ç°çï¼ä»ä¸é¢çä»£ç ä½ å¯ä»¥çå°å®¹å¨ä¸­ç Valve ä¹å¯ä»¥æå¨ææ§ä»»å¡ï¼å¹¶ä¸è¢« ContainerBase ç»ä¸å¤çã\n\nè¯·ä½ ç¹å«æ³¨æçæ¯ï¼å¨ backgroundProcess æ¹æ³çæåï¼è¿è§¦åäºå®¹å¨çâå¨æäºä»¶âãæä»¬ç¥éå®¹å¨ççå½å¨æäºä»¶æåå§åãå¯å¨ååæ­¢ç­ï¼é£âå¨æäºä»¶âåæ¯ä»ä¹å¢ï¼å®è·çå½å¨æäºä»¶ä¸æ ·ï¼æ¯ä¸ç§æ©å±æºå¶ï¼ä½ å¯ä»¥è¿æ ·çè§£ï¼\n\nåä¸æ®µæ¶é´è¿å»äºï¼å®¹å¨è¿æ´»çï¼ä½ æ³åç¹ä»ä¹åï¼å¦æä½ æ³åç¹ä»ä¹ï¼å°±åå»ºä¸ä¸ªçå¬å¨æ¥çå¬è¿ä¸ªâå¨æäºä»¶âï¼äºä»¶å°äºæè´è´£è°ç¨ä½ çæ¹æ³ã\n\næ»ä¹ï¼æäº ContainerBase ä¸­çåå°çº¿ç¨å backgroundProcess æ¹æ³ï¼åç§å­å®¹å¨åéç¨ç»ä»¶ä¸éè¦åèªå¼ä¸ä¸ªåå°çº¿ç¨æ¥å¤çå¨ææ§ä»»å¡ï¼è¿æ ·çè®¾è®¡æ¾å¾ä¼éåæ´æ´ã\n\n\n# Tomcat ç­å è½½\n\næäº ContainerBase çå¨ææ§ä»»å¡å¤çâæ¡æ¶âï¼ä½ä¸ºå·ä½å®¹å¨å­ç±»ï¼åªéè¦å®ç°èªå·±çå¨ææ§ä»»å¡å°±è¡ãè Tomcat çç­å è½½ï¼å°±æ¯å¨ Context å®¹å¨ä¸­å®ç°çãContext å®¹å¨ç backgroundProcess æ¹æ³æ¯è¿æ ·å®ç°çï¼\n\npublic void backgroundProcess() {\n\n    //WebappLoader å¨ææ§çæ£æ¥ WEB-INF/classes å WEB-INF/lib ç®å½ä¸çç±»æä»¶\n    Loader loader = getLoader();\n    if (loader != null) {\n        loader.backgroundProcess();\n    }\n\n    //Session ç®¡çå¨å¨ææ§çæ£æ¥æ¯å¦æè¿æç Session\n    Manager manager = getManager();\n    if (manager != null) {\n        manager.backgroundProcess();\n    }\n\n    // å¨ææ§çæ£æ¥éæèµæºæ¯å¦æåå\n    WebResourceRoot resources = getResources();\n    if (resources != null) {\n        resources.backgroundProcess();\n    }\n\n    // è°ç¨ç¶ç±» ContainerBase ç backgroundProcess æ¹æ³\n    super.backgroundProcess();\n}\n\n\nä»ä¸é¢çä»£ç æä»¬çå° Context å®¹å¨éè¿ WebappLoader æ¥æ£æ¥ç±»æä»¶æ¯å¦ææ´æ°ï¼éè¿ Session ç®¡çå¨æ¥æ£æ¥æ¯å¦æ Session è¿æï¼å¹¶ä¸éè¿èµæºç®¡çå¨æ¥æ£æ¥éæèµæºæ¯å¦ææ´æ°ï¼æåè¿è°ç¨äºç¶ç±» ContainerBase ç backgroundProcess æ¹æ³ã\n\nè¿éæä»¬è¦éç¹å³æ³¨ï¼WebappLoader æ¯å¦ä½å®ç°ç­å è½½çï¼å®ä¸»è¦æ¯è°ç¨äº Context å®¹å¨ç reload æ¹æ³ï¼è Context ç reload æ¹æ³æ¯è¾å¤æï¼æ»ç»èµ·æ¥ï¼ä¸»è¦å®æäºä¸é¢è¿äºä»»å¡ï¼\n\n 1. åæ­¢åéæ¯ Context å®¹å¨åå¶ææå­å®¹å¨ï¼å­å®¹å¨å¶å®å°±æ¯ Wrapperï¼ä¹å°±æ¯è¯´ Wrapper éé¢ Servlet å®ä¾ä¹è¢«éæ¯äºã\n 2. åæ­¢åéæ¯ Context å®¹å¨å³èç Listener å Filterã\n 3. åæ­¢åéæ¯ Context ä¸ç Pipeline ååç§ Valveã\n 4. åæ­¢åéæ¯ Context çç±»å è½½å¨ï¼ä»¥åç±»å è½½å¨å è½½çç±»æä»¶èµæºã\n 5. å¯å¨ Context å®¹å¨ï¼å¨è¿ä¸ªè¿ç¨ä¸­ä¼éæ°åå»ºåé¢åæ­¥è¢«éæ¯çèµæºã\n\nå¨è¿ä¸ªè¿ç¨ä¸­ï¼ç±»å è½½å¨åæ¥çå³é®ä½ç¨ãä¸ä¸ª Context å®¹å¨å¯¹åºä¸ä¸ªç±»å è½½å¨ï¼ç±»å è½½å¨å¨éæ¯çè¿ç¨ä¸­ä¼æå®å è½½çææç±»ä¹å¨é¨éæ¯ãContext å®¹å¨å¨å¯å¨è¿ç¨ä¸­ï¼ä¼åå»ºä¸ä¸ªæ°çç±»å è½½å¨æ¥å è½½æ°çç±»æä»¶ã\n\nå¨ Context ç reload æ¹æ³éï¼å¹¶æ²¡æè°ç¨ Session ç®¡çå¨ç distroy æ¹æ³ï¼ä¹å°±æ¯è¯´è¿ä¸ª Context å³èç Session æ¯æ²¡æéæ¯çãä½ è¿éè¦æ³¨æçæ¯ï¼Tomcat çç­å è½½é»è®¤æ¯å³é­çï¼ä½ éè¦å¨ conf ç®å½ä¸ç Context.xml æä»¶ä¸­è®¾ç½® reloadable åæ°æ¥å¼å¯è¿ä¸ªåè½ï¼åä¸é¢è¿æ ·ï¼\n\n<Context reloadable="true"/>\n\n\n\n# Tomcat ç­é¨ç½²\n\næä»¬åæ¥ççç­é¨ç½²ï¼ç­é¨ç½²è·ç­å è½½çæ¬è´¨åºå«æ¯ï¼ç­é¨ç½²ä¼éæ°é¨ç½² Web åºç¨ï¼åæ¥ç Context å¯¹è±¡ä¼æ´ä¸ªè¢«éæ¯æï¼å æ­¤è¿ä¸ª Context æå³èçä¸åèµæºé½ä¼è¢«éæ¯ï¼åæ¬ Sessionã\n\né£ä¹ Tomcat ç­é¨ç½²åæ¯ç±åªä¸ªå®¹å¨æ¥å®ç°çå¢ï¼åºè¯¥ä¸æ¯ç± Contextï¼å ä¸ºç­é¨ç½²è¿ç¨ä¸­ Context å®¹å¨è¢«éæ¯äºï¼é£ä¹è¿ä¸ªéæå°±è½å¨ Host èº«ä¸äºï¼å ä¸ºå®æ¯ Context çç¶å®¹å¨ã\n\nè· Context ä¸ä¸æ ·ï¼Host å®¹å¨å¹¶æ²¡æå¨ backgroundProcess æ¹æ³ä¸­å®ç°å¨ææ§æ£æµçä»»å¡ï¼èæ¯éè¿çå¬å¨ HostConfig æ¥å®ç°çï¼HostConfig å°±æ¯åé¢æå°çâå¨æäºä»¶âççå¬å¨ï¼é£âå¨æäºä»¶âè¾¾å°æ¶ï¼HostConfig ä¼åä»ä¹äºå¢ï¼\n\npublic void lifecycleEvent(LifecycleEvent event) {\n    // æ§è¡ check æ¹æ³ã\n    if (event.getType().equals(Lifecycle.PERIODIC_EVENT)) {\n        check();\n    }\n}\n\n\nå®æ§è¡äº check æ¹æ³ï¼æä»¬æ¥çæ¥ç check æ¹æ³éåäºä»ä¹ã\n\nprotected void check() {\n\n    if (host.getAutoDeploy()) {\n        // æ£æ¥è¿ä¸ª Host ä¸ææå·²ç»é¨ç½²ç Web åºç¨\n        DeployedApplication[] apps =\n            deployed.values().toArray(new DeployedApplication[0]);\n\n        for (int i = 0; i < apps.length; i++) {\n            // æ£æ¥ Web åºç¨ç®å½æ¯å¦æåå\n            checkResources(apps[i], false);\n        }\n\n        // æ§è¡é¨ç½²\n        deployApps();\n    }\n}\n\n\nå¶å® HostConfig ä¼æ£æ¥ webapps ç®å½ä¸çææ Web åºç¨ï¼\n\n * å¦æåæ¥ Web åºç¨ç®å½è¢«å æäºï¼å°±æç¸åº Context å®¹å¨æ´ä¸ªéæ¯æã\n * æ¯å¦ææ°ç Web åºç¨ç®å½æ¾è¿æ¥äºï¼æèææ°ç WAR åæ¾è¿æ¥äºï¼å°±é¨ç½²ç¸åºç Web åºç¨ã\n\nå æ­¤ HostConfig åçäºæé½æ¯æ¯è¾âå®è§âçï¼å®ä¸ä¼å»æ£æ¥å·ä½ç±»æä»¶æèèµæºæä»¶æ¯å¦æååï¼èæ¯æ£æ¥ Web åºç¨ç®å½çº§å«çååã\n\n\n# Tomcat çç±»å è½½æºå¶\n\nTomcat çèªå®ä¹ç±»å è½½å¨ WebAppClassLoader æç ´äºåäº²å§æ´¾æºå¶ï¼å®é¦åèªå·±å°è¯å»å è½½æä¸ªç±»ï¼å¦ææ¾ä¸å°åä»£çç»ç¶ç±»å è½½å¨ï¼å¶ç®çæ¯ä¼åå è½½ Web åºç¨èªå·±å®ä¹çç±»ãå·ä½å®ç°å°±æ¯éå ClassLoader çä¸¤ä¸ªæ¹æ³ï¼findClass å loadClassã\n\n\n# findClass æ¹æ³\n\næä»¬åæ¥çç findClass æ¹æ³çå®ç°ï¼ä¸ºäºæ¹ä¾¿çè§£åéè¯»ï¼æå»æäºä¸äºç»èï¼\n\npublic Class<?> findClass(String name) throws ClassNotFoundException {\n    ...\n\n    Class<?> clazz = null;\n    try {\n            //1. åå¨ Web åºç¨ç®å½ä¸æ¥æ¾ç±»\n            clazz = findClassInternal(name);\n    }  catch (RuntimeException e) {\n           throw e;\n       }\n\n    if (clazz == null) {\n    try {\n            //2. å¦æå¨æ¬å°ç®å½æ²¡ææ¾å°ï¼äº¤ç»ç¶å è½½å¨å»æ¥æ¾\n            clazz = super.findClass(name);\n    }  catch (RuntimeException e) {\n           throw e;\n       }\n\n    //3. å¦æç¶ç±»ä¹æ²¡æ¾å°ï¼æåº ClassNotFoundException\n    if (clazz == null) {\n        throw new ClassNotFoundException(name);\n     }\n\n    return clazz;\n}\n\n\nå¨ findClass æ¹æ³éï¼ä¸»è¦æä¸ä¸ªæ­¥éª¤ï¼\n\n 1. åå¨ Web åºç¨æ¬å°ç®å½ä¸æ¥æ¾è¦å è½½çç±»ã\n 2. å¦ææ²¡ææ¾å°ï¼äº¤ç»ç¶å è½½å¨å»æ¥æ¾ï¼å®çç¶å è½½å¨å°±æ¯ä¸é¢æå°çç³»ç»ç±»å è½½å¨ AppClassLoaderã\n 3. å¦ä½ç¶å è½½å¨ä¹æ²¡æ¾å°è¿ä¸ªç±»ï¼æåº ClassNotFound å¼å¸¸ã\n\n\n# loadClass æ¹æ³\n\næ¥çæä»¬åæ¥ç Tomcat ç±»å è½½å¨ç loadClass æ¹æ³çå®ç°ï¼åæ ·æä¹å»æäºä¸äºç»èï¼\n\npublic Class<?> loadClass(String name, boolean resolve) throws ClassNotFoundException {\n\n    synchronized (getClassLoadingLock(name)) {\n\n        Class<?> clazz = null;\n\n        //1. åå¨æ¬å° cache æ¥æ¾è¯¥ç±»æ¯å¦å·²ç»å è½½è¿\n        clazz = findLoadedClass0(name);\n        if (clazz != null) {\n            if (resolve)\n                resolveClass(clazz);\n            return clazz;\n        }\n\n        //2. ä»ç³»ç»ç±»å è½½å¨ç cache ä¸­æ¥æ¾æ¯å¦å è½½è¿\n        clazz = findLoadedClass(name);\n        if (clazz != null) {\n            if (resolve)\n                resolveClass(clazz);\n            return clazz;\n        }\n\n        // 3. å°è¯ç¨ ExtClassLoader ç±»å è½½å¨ç±»å è½½ï¼ä¸ºä»ä¹ï¼\n        ClassLoader javaseLoader = getJavaseClassLoader();\n        try {\n            clazz = javaseLoader.loadClass(name);\n            if (clazz != null) {\n                if (resolve)\n                    resolveClass(clazz);\n                return clazz;\n            }\n        } catch (ClassNotFoundException e) {\n            // Ignore\n        }\n\n        // 4. å°è¯å¨æ¬å°ç®å½æç´¢ class å¹¶å è½½\n        try {\n            clazz = findClass(name);\n            if (clazz != null) {\n                if (resolve)\n                    resolveClass(clazz);\n                return clazz;\n            }\n        } catch (ClassNotFoundException e) {\n            // Ignore\n        }\n\n        // 5. å°è¯ç¨ç³»ç»ç±»å è½½å¨ (ä¹å°±æ¯ AppClassLoader) æ¥å è½½\n            try {\n                clazz = Class.forName(name, false, parent);\n                if (clazz != null) {\n                    if (resolve)\n                        resolveClass(clazz);\n                    return clazz;\n                }\n            } catch (ClassNotFoundException e) {\n                // Ignore\n            }\n       }\n\n    //6. ä¸è¿°è¿ç¨é½å è½½å¤±è´¥ï¼æåºå¼å¸¸\n    throw new ClassNotFoundException(name);\n}\n\n\nloadClass æ¹æ³ç¨å¾®å¤æä¸ç¹ï¼ä¸»è¦æå­ä¸ªæ­¥éª¤ï¼\n\n 1. åå¨æ¬å° Cache æ¥æ¾è¯¥ç±»æ¯å¦å·²ç»å è½½è¿ï¼ä¹å°±æ¯è¯´ Tomcat çç±»å è½½å¨æ¯å¦å·²ç»å è½½è¿è¿ä¸ªç±»ã\n 2. å¦æ Tomcat ç±»å è½½å¨æ²¡æå è½½è¿è¿ä¸ªç±»ï¼åççç³»ç»ç±»å è½½å¨æ¯å¦å è½½è¿ã\n 3. å¦æé½æ²¡æï¼å°±è®©ExtClassLoaderå»å è½½ï¼è¿ä¸æ­¥æ¯è¾å³é®ï¼ç®çé²æ­¢ Web åºç¨èªå·±çç±»è¦ç JRE çæ ¸å¿ç±»ãå ä¸º Tomcat éè¦æç ´åäº²å§æ´¾æºå¶ï¼åå¦ Web åºç¨éèªå®ä¹äºä¸ä¸ªå« Object çç±»ï¼å¦æåå è½½è¿ä¸ª Object ç±»ï¼å°±ä¼è¦ç JRE éé¢çé£ä¸ª Object ç±»ï¼è¿å°±æ¯ä¸ºä»ä¹ Tomcat çç±»å è½½å¨ä¼ä¼åå°è¯ç¨ ExtClassLoader å»å è½½ï¼å ä¸º ExtClassLoader ä¼å§æç» BootstrapClassLoader å»å è½½ï¼BootstrapClassLoader åç°èªå·±å·²ç»å è½½äº Object ç±»ï¼ç´æ¥è¿åç» Tomcat çç±»å è½½å¨ï¼è¿æ · Tomcat çç±»å è½½å¨å°±ä¸ä¼å»å è½½ Web åºç¨ä¸ç Object ç±»äºï¼ä¹å°±é¿åäºè¦ç JRE æ ¸å¿ç±»çé®é¢ã\n 4. å¦æ ExtClassLoader å è½½å¨å è½½å¤±è´¥ï¼ä¹å°±æ¯è¯´ JRE æ ¸å¿ç±»ä¸­æ²¡æè¿ç±»ï¼é£ä¹å°±å¨æ¬å° Web åºç¨ç®å½ä¸æ¥æ¾å¹¶å è½½ã\n 5. å¦ææ¬å°ç®å½ä¸æ²¡æè¿ä¸ªç±»ï¼è¯´æä¸æ¯ Web åºç¨èªå·±å®ä¹çç±»ï¼é£ä¹ç±ç³»ç»ç±»å è½½å¨å»å è½½ãè¿éè¯·ä½ æ³¨æï¼Web åºç¨æ¯éè¿Class.forNameè°ç¨äº¤ç»ç³»ç»ç±»å è½½å¨çï¼å ä¸ºClass.forNameçé»è®¤å è½½å¨å°±æ¯ç³»ç»ç±»å è½½å¨ã\n 6. å¦æä¸è¿°å è½½è¿ç¨å¨é¨å¤±è´¥ï¼æåº ClassNotFound å¼å¸¸ã\n\nä»ä¸é¢çè¿ç¨æä»¬å¯ä»¥çå°ï¼Tomcat çç±»å è½½å¨æç ´äºåäº²å§æ´¾æºå¶ï¼æ²¡æä¸ä¸æ¥å°±ç´æ¥å§æç»ç¶å è½½å¨ï¼èæ¯åå¨æ¬å°ç®å½ä¸å è½½ï¼ä¸ºäºé¿åæ¬å°ç®å½ä¸çç±»è¦ç JRE çæ ¸å¿ç±»ï¼åå°è¯ç¨ JVM æ©å±ç±»å è½½å¨ ExtClassLoader å»å è½½ãé£ä¸ºä»ä¹ä¸åç¨ç³»ç»ç±»å è½½å¨ AppClassLoader å»å è½½ï¼å¾æ¾ç¶ï¼å¦ææ¯è¿æ ·çè¯ï¼é£å°±åæåäº²å§æ´¾æºå¶äºï¼è¿å°±æ¯ Tomcat ç±»å è½½å¨çå·§å¦ä¹å¤ã\n\n\n# Tomcat å®ç°åºç¨éç¦»\n\nTomcat ä½ä¸º Web å®¹å¨ï¼éè¦è§£å³ä»¥ä¸é®é¢ï¼\n\n 1. å¦æå¨ Tomcat ä¸­è¿è¡äºä¸¤ä¸ª Web åºç¨ç¨åºï¼ä¸¤ä¸ª Web åºç¨ä¸­æååç Servletï¼ä½æ¯åè½ä¸åï¼Tomcat éè¦åæ¶å è½½åç®¡çè¿ä¸¤ä¸ªååç Servlet ç±»ï¼ä¿è¯å®ä»¬ä¸ä¼å²çªï¼å æ­¤ Web åºç¨ä¹é´çç±»éè¦éç¦»ã\n 2. ä¸¤ä¸ª Web åºç¨é½ä¾èµåä¸ä¸ªç¬¬ä¸æ¹ç JAR åï¼æ¯å¦ Springï¼é£ Spring ç JAR åè¢«å è½½å°åå­åï¼Tomcat è¦ä¿è¯è¿ä¸¤ä¸ª Web åºç¨è½å¤å±äº«ï¼ä¹å°±æ¯è¯´ Spring ç JAR ååªè¢«å è½½ä¸æ¬¡ï¼å¦åéçä¾èµçç¬¬ä¸æ¹ JAR åå¢å¤ï¼JVM çåå­ä¼è¨èã\n 3. éè¦éç¦» Tomcat æ¬èº«çç±»å Web åºç¨çç±»ã\n\n\n\n# WebAppClassLoader\n\néå¯¹ç¬¬ä¸ä¸ªé®é¢ï¼\n\nå¦æä½¿ç¨ JVM é»è®¤ AppClassLoader æ¥å è½½ Web åºç¨ï¼AppClassLoader åªè½å è½½ä¸ä¸ª Servlet ç±»ï¼å¨å è½½ç¬¬äºä¸ªåå Servlet ç±»æ¶ï¼AppClassLoader ä¼è¿åç¬¬ä¸ä¸ª Servlet ç±»ç Class å®ä¾ï¼è¿æ¯å ä¸ºå¨ AppClassLoader çæ¥ï¼ååç Servlet ç±»åªè¢«å è½½ä¸æ¬¡ã\n\nTomcat çè§£å³æ¹æ¡æ¯èªå®ä¹ä¸ä¸ªç±»å è½½å¨ WebAppClassLoaderï¼ å¹¶ä¸ç»æ¯ä¸ª Web åºç¨åå»ºä¸ä¸ªç±»å è½½å¨å®ä¾ãæä»¬ç¥éï¼Context å®¹å¨ç»ä»¶å¯¹åºä¸ä¸ª Web åºç¨ï¼å æ­¤ï¼æ¯ä¸ª Context å®¹å¨è´è´£åå»ºåç»´æ¤ä¸ä¸ª WebAppClassLoader å è½½å¨å®ä¾ãè¿èåçåçæ¯ï¼ä¸åçå è½½å¨å®ä¾å è½½çç±»è¢«è®¤ä¸ºæ¯ä¸åçç±»ï¼å³ä½¿å®ä»¬çç±»åç¸åãè¿å°±ç¸å½äºå¨ Java èææºåé¨åå»ºäºä¸ä¸ªä¸ªç¸äºéç¦»ç Java ç±»ç©ºé´ï¼æ¯ä¸ä¸ª Web åºç¨é½æèªå·±çç±»ç©ºé´ï¼Web åºç¨ä¹é´éè¿åèªçç±»å è½½å¨äºç¸éç¦»ã\n\n# SharedClassLoader\n\néå¯¹ç¬¬äºä¸ªé®é¢ï¼\n\næ¬è´¨éæ±æ¯ä¸¤ä¸ª Web åºç¨ä¹é´æä¹å±äº«åºç±»ï¼å¹¶ä¸ä¸è½éå¤å è½½ç¸åçç±»ãæä»¬ç¥éï¼å¨åäº²å§æ´¾æºå¶éï¼åä¸ªå­å è½½å¨é½å¯ä»¥éè¿ç¶å è½½å¨å»å è½½ç±»ï¼é£ä¹æéè¦å±äº«çç±»æ¾å°ç¶å è½½å¨çå è½½è·¯å¾ä¸ä¸å°±è¡äºåï¼åºç¨ç¨åºä¹æ­£æ¯éè¿è¿ç§æ¹å¼å±äº« JRE çæ ¸å¿ç±»ãå æ­¤ Tomcat çè®¾è®¡èåå äºä¸ä¸ªç±»å è½½å¨ SharedClassLoaderï¼ä½ä¸º WebAppClassLoader çç¶å è½½å¨ï¼ä¸é¨æ¥å è½½ Web åºç¨ä¹é´å±äº«çç±»ãå¦æ WebAppClassLoader èªå·±æ²¡æå è½½å°æä¸ªç±»ï¼å°±ä¼å§æç¶å è½½å¨ SharedClassLoader å»å è½½è¿ä¸ªç±»ï¼SharedClassLoader ä¼å¨æå®ç®å½ä¸å è½½å±äº«ç±»ï¼ä¹åè¿åç» WebAppClassLoaderï¼è¿æ ·å±äº«çé®é¢å°±è§£å³äºã\n\n# CatalinaClassloader\n\nå¦ä½éç¦» Tomcat æ¬èº«çç±»å Web åºç¨çç±»ï¼\n\nè¦å±äº«å¯ä»¥éè¿ç¶å­å³ç³»ï¼è¦éç¦»é£å°±éè¦åå¼å³ç³»äºãåå¼å³ç³»å°±æ¯æä¸¤ä¸ªç±»å è½½å¨æ¯å¹³è¡çï¼å®ä»¬å¯è½æ¥æåä¸ä¸ªç¶å è½½å¨ï¼ä½æ¯ä¸¤ä¸ªåå¼ç±»å è½½å¨å è½½çç±»æ¯éç¦»çãåºäºæ­¤ Tomcat åè®¾è®¡ä¸ä¸ªç±»å è½½å¨ CatalinaClassloaderï¼ä¸é¨æ¥å è½½ Tomcat èªèº«çç±»ãè¿æ ·è®¾è®¡æä¸ªé®é¢ï¼é£ Tomcat åå Web åºç¨ä¹é´éè¦å±äº«ä¸äºç±»æ¶è¯¥æä¹åå¢ï¼\n\n# CommonClassLoader\n\nèåæ³ï¼è¿æ¯åå¢å ä¸ä¸ª CommonClassLoaderï¼ä½ä¸º CatalinaClassloader å SharedClassLoader çç¶å è½½å¨ãCommonClassLoader è½å è½½çç±»é½å¯ä»¥è¢« CatalinaClassLoader å SharedClassLoader ä½¿ç¨ï¼è CatalinaClassLoader å SharedClassLoader è½å è½½çç±»åä¸å¯¹æ¹ç¸äºéç¦»ãWebAppClassLoader å¯ä»¥ä½¿ç¨ SharedClassLoader å è½½å°çç±»ï¼ä½åä¸ª WebAppClassLoader å®ä¾ä¹é´ç¸äºéç¦»ã\n\n\n# Tomcat å®ç° Servlet è§è\n\nServlet å®¹å¨æéè¦çä»»å¡å°±æ¯åå»º Servlet çå®ä¾å¹¶ä¸è°ç¨ Servletã\n\nä¸ä¸ª Web åºç¨éå¾å¾æå¤ä¸ª Servletï¼èå¨ Tomcat ä¸­ä¸ä¸ª Web åºç¨å¯¹åºä¸ä¸ª Context å®¹å¨ï¼ä¹å°±æ¯è¯´ä¸ä¸ª Context å®¹å¨éè¦ç®¡çå¤ä¸ª Servlet å®ä¾ãä½ Context å®¹å¨å¹¶ä¸ç´æ¥ææ Servlet å®ä¾ï¼èæ¯éè¿å­å®¹å¨ Wrapper æ¥ç®¡ç Servletï¼ä½ å¯ä»¥æ Wrapper å®¹å¨çä½æ¯ Servlet çåè£ã\n\nä¸ºä»ä¹éè¦ Wrapper å¢ï¼Context å®¹å¨ç´æ¥ç»´æ¤ä¸ä¸ª Servlet æ°ç»ä¸å°±è¡äºåï¼è¿æ¯å ä¸º Servlet ä¸ä»ä»æ¯ä¸ä¸ªç±»å®ä¾ï¼å®è¿æç¸å³çéç½®ä¿¡æ¯ï¼æ¯å¦å®ç URL æ å°ãå®çåå§ååæ°ï¼å æ­¤è®¾è®¡åºäºä¸ä¸ªåè£å¨ï¼æ Servlet æ¬èº«åå®ç¸å³çæ°æ®åèµ·æ¥ï¼æ²¡éï¼è¿å°±æ¯é¢åå¯¹è±¡çææ³ã\n\né¤æ­¤ä»¥å¤ï¼Servlet è§èä¸­è¿æä¸¤ä¸ªéè¦ç¹æ§ï¼Listener å Filterï¼Tomcat ä¹éè¦åå»ºå®ä»¬çå®ä¾ï¼å¹¶å¨åéçæ¶æºå»è°ç¨å®ä»¬çæ¹æ³ã\n\n\n# Servlet ç®¡ç\n\nTomcat æ¯ç¨ Wrapper å®¹å¨æ¥ç®¡ç Servlet çï¼é£ Wrapper å®¹å¨å·ä½é¿ä»ä¹æ ·å­å¢ï¼æä»¬åæ¥ççå®éé¢æåªäºå³é®çæååéï¼\n\nprotected volatile Servlet instance = null;\n\n\nå®æ¥æä¸ä¸ª Servlet å®ä¾ï¼å¹¶ä¸ Wrapper éè¿ loadServlet æ¹æ³æ¥å®ä¾å Servletãä¸ºäºæ¹ä¾¿ä½ éè¯»ï¼æç®åäºä»£ç ï¼\n\npublic synchronized Servlet loadServlet() throws ServletException {\n    Servlet servlet;\n\n    //1. åå»ºä¸ä¸ª Servlet å®ä¾\n    servlet = (Servlet) instanceManager.newInstance(servletClass);\n\n    //2. è°ç¨äº Servlet ç init æ¹æ³ï¼è¿æ¯ Servlet è§èè¦æ±ç\n    initServlet(servlet);\n\n    return servlet;\n}\n\n\nå¶å® loadServlet ä¸»è¦åäºä¸¤ä»¶äºï¼åå»º Servlet çå®ä¾ï¼å¹¶ä¸è°ç¨ Servlet ç init æ¹æ³ï¼å ä¸ºè¿æ¯ Servlet è§èè¦æ±çã\n\né£æ¥ä¸æ¥çé®é¢æ¯ï¼ä»ä¹æ¶åä¼è°å°è¿ä¸ª loadServlet æ¹æ³å¢ï¼ä¸ºäºå å¿«ç³»ç»çå¯å¨éåº¦ï¼æä»¬å¾å¾ä¼éåèµæºå»¶è¿å è½½çç­ç¥ï¼Tomcat ä¹ä¸ä¾å¤ï¼é»è®¤æåµä¸ Tomcat å¨å¯å¨æ¶ä¸ä¼å è½½ä½ ç Servletï¼é¤éä½ æ Servlet çloadOnStartupåæ°è®¾ç½®ä¸ºtrueã\n\nè¿éè¿éè¦ä½ æ³¨æçæ¯ï¼è½ç¶ Tomcat å¨å¯å¨æ¶ä¸ä¼åå»º Servlet å®ä¾ï¼ä½æ¯ä¼åå»º Wrapper å®¹å¨ï¼å°±å¥½æ¯å°½ç®¡æªéé¢è¿æ²¡æå­å¼¹ï¼åææªé åºæ¥ãé£å­å¼¹ä»ä¹æ¶åé å¢ï¼æ¯çæ­£éè¦å¼æªçæ¶åï¼ä¹å°±æ¯è¯´æè¯·æ±æ¥è®¿é®æä¸ª Servlet æ¶ï¼è¿ä¸ª Servlet çå®ä¾æä¼è¢«åå»ºã\n\né£ Servlet æ¯è¢«è°è°ç¨çå¢ï¼æä»¬åå¿ä¸ä¸ä¸æ åé¢æå°è¿ Tomcat ç Pipeline-Valve æºå¶ï¼æ¯ä¸ªå®¹å¨ç»ä»¶é½æèªå·±ç Pipelineï¼æ¯ä¸ª Pipeline ä¸­æä¸ä¸ª Valve é¾ï¼å¹¶ä¸æ¯ä¸ªå®¹å¨ç»ä»¶æä¸ä¸ª BasicValveï¼åºç¡éï¼ãWrapper ä½ä¸ºä¸ä¸ªå®¹å¨ç»ä»¶ï¼å®ä¹æèªå·±ç Pipeline å BasicValveï¼Wrapper ç BasicValve å« StandardWrapperValveã\n\nä½ å¯ä»¥æ³å°ï¼å½è¯·æ±å°æ¥æ¶ï¼Context å®¹å¨ç BasicValve ä¼è°ç¨ Wrapper å®¹å¨ä¸­ Pipeline ä¸­çç¬¬ä¸ä¸ª Valveï¼ç¶åä¼è°ç¨å° StandardWrapperValveãæä»¬åæ¥ççå®ç invoke æ¹æ³æ¯å¦ä½å®ç°çï¼åæ ·ä¸ºäºæ¹ä¾¿ä½ éè¯»ï¼æç®åäºä»£ç ï¼\n\npublic final void invoke(Request request, Response response) {\n\n    //1. å®ä¾å Servlet\n    servlet = wrapper.allocate();\n\n    //2. ç»å½åè¯·æ±åå»ºä¸ä¸ª Filter é¾\n    ApplicationFilterChain filterChain =\n        ApplicationFilterFactory.createFilterChain(request, wrapper, servlet);\n\n   //3. è°ç¨è¿ä¸ª Filter é¾ï¼Filter é¾ä¸­çæåä¸ä¸ª Filter ä¼è°ç¨ Servlet\n   filterChain.doFilter(request.getRequest(), response.getResponse());\n\n}\n\n\nStandardWrapperValve ç invoke æ¹æ³æ¯è¾å¤æï¼å»æå¶ä»å¼å¸¸å¤ççä¸äºç»èï¼æ¬è´¨ä¸å°±æ¯ä¸æ­¥ï¼\n\n * ç¬¬ä¸æ­¥ï¼åå»º Servlet å®ä¾ï¼\n * ç¬¬äºæ­¥ï¼ç»å½åè¯·æ±åå»ºä¸ä¸ª Filter é¾ï¼\n * ç¬¬ä¸æ­¥ï¼è°ç¨è¿ä¸ª Filter é¾ã\n\nä½ å¯è½ä¼é®ï¼ä¸ºä»ä¹éè¦ç»æ¯ä¸ªè¯·æ±åå»ºä¸ä¸ª Filter é¾ï¼è¿æ¯å ä¸ºæ¯ä¸ªè¯·æ±çè¯·æ±è·¯å¾é½ä¸ä¸æ ·ï¼è Filter é½æç¸åºçè·¯å¾æ å°ï¼å æ­¤ä¸æ¯ææç Filter é½éè¦æ¥å¤çå½åçè¯·æ±ï¼æä»¬éè¦æ ¹æ®è¯·æ±çè·¯å¾æ¥éæ©ç¹å®çä¸äº Filter æ¥å¤çã\n\nç¬¬äºä¸ªé®é¢æ¯ï¼ä¸ºä»ä¹æ²¡æçå°è°å° Servlet ç service æ¹æ³ï¼è¿æ¯å ä¸º Filter é¾ç doFilter æ¹æ³ä¼è´è´£è°ç¨ Servletï¼å·ä½æ¥è¯´å°±æ¯ Filter é¾ä¸­çæåä¸ä¸ª Filter ä¼è´è´£è°ç¨ Servletã\n\næ¥ä¸æ¥æä»¬æ¥ç Filter çå®ç°åçã\n\n\n# Filter ç®¡ç\n\næä»¬ç¥éï¼è· Servlet ä¸æ ·ï¼Filter ä¹å¯ä»¥å¨web.xmlæä»¶éè¿è¡éç½®ï¼ä¸åçæ¯ï¼Filter çä½ç¨åæ¯æ´ä¸ª Web åºç¨ï¼å æ­¤ Filter çå®ä¾æ¯å¨ Context å®¹å¨ä¸­è¿è¡ç®¡ççï¼Context å®¹å¨ç¨ Map éåæ¥ä¿å­ Filterã\n\nprivate Map<String, FilterDef> filterDefs = new HashMap<>();\n\n\né£ä¸é¢æå°ç Filter é¾åæ¯ä»ä¹å¢ï¼Filter é¾çå­æ´»æå¾ç­ï¼å®æ¯è·æ¯ä¸ªè¯·æ±å¯¹åºçãä¸ä¸ªæ°çè¯·æ±æ¥äºï¼å°±å¨æåå»ºä¸ä¸ª FIlter é¾ï¼è¯·æ±å¤çå®äºï¼Filter é¾ä¹å°±è¢«åæ¶äºãçè§£å®çåçä¹éå¸¸å³é®ï¼æä»¬è¿æ¯æ¥ççæºç ï¼\n\npublic final class ApplicationFilterChain implements FilterChain {\n\n  //Filter é¾ä¸­æ Filter æ°ç»ï¼è¿ä¸ªå¥½çè§£\n  private ApplicationFilterConfig[] filters = new ApplicationFilterConfig[0];\n\n  //Filter é¾ä¸­çå½åçè°ç¨ä½ç½®\n  private int pos = 0;\n\n  // æ»å±æå¤å°äº Filter\n  private int n = 0;\n\n  // æ¯ä¸ª Filter é¾å¯¹åºä¸ä¸ª Servletï¼ä¹å°±æ¯å®è¦è°ç¨ç Servlet\n  private Servlet servlet = null;\n\n  public void doFilter(ServletRequest req, ServletResponse res) {\n        internalDoFilter(request,response);\n  }\n\n  private void internalDoFilter(ServletRequest req,\n                                ServletResponse res){\n\n    // æ¯ä¸ª Filter é¾å¨åé¨ç»´æ¤äºä¸ä¸ª Filter æ°ç»\n    if (pos < n) {\n        ApplicationFilterConfig filterConfig = filters[pos++];\n        Filter filter = filterConfig.getFilter();\n\n        filter.doFilter(request, response, this);\n        return;\n    }\n\n    servlet.service(request, response);\n\n}\n\n\nä» ApplicationFilterChain çæºç æä»¬å¯ä»¥çå°å ä¸ªå³é®ä¿¡æ¯ï¼\n\n * Filter é¾ä¸­é¤äºæ Filter å¯¹è±¡çæ°ç»ï¼è¿æä¸ä¸ªæ´æ°åé posï¼è¿ä¸ªåéç¨æ¥è®°å½å½åè¢«è°ç¨ç Filter å¨æ°ç»ä¸­çä½ç½®ã\n * Filter é¾ä¸­æä¸ª Servlet å®ä¾ï¼è¿ä¸ªå¥½çè§£ï¼å ä¸ºä¸é¢æå°äºï¼æ¯ä¸ª Filter é¾æåé½ä¼è°å°ä¸ä¸ª Servletã\n * Filter é¾æ¬èº«ä¹å®ç°äº doFilter æ¹æ³ï¼ç´æ¥è°ç¨äºä¸ä¸ªåé¨æ¹æ³ internalDoFilterã\n * internalDoFilter æ¹æ³çå®ç°æ¯è¾æææï¼å®åäºä¸ä¸ªå¤æ­ï¼å¦æå½å Filter çä½ç½®å°äº Filter æ°ç»çé¿åº¦ï¼ä¹å°±æ¯è¯´ Filter è¿æ²¡è°å®ï¼å°±ä» Filter æ°ç»æ¿ä¸ä¸ä¸ª Filterï¼è°ç¨å®ç doFilter æ¹æ³ãå¦åï¼æå³çææ Filter é½è°å°äºï¼å°±è°ç¨ Servlet ç service æ¹æ³ã\n\nä½é®é¢æ¯ï¼æ¹æ³ä½éæ²¡çå°å¾ªç¯ï¼è°å¨ä¸åå°è°ç¨ Filter é¾ç doFIlter æ¹æ³å¢ï¼Filter æ¯æä¹ä¾æ¬¡è°å°çå¢ï¼\n\nç­æ¡æ¯Filter æ¬èº«ç doFilter æ¹æ³ä¼è°ç¨ Filter é¾ç doFilter æ¹æ³ï¼æä»¬è¿æ¯æ¥ççä»£ç å°±æç½äºï¼\n\npublic void doFilter(ServletRequest request, ServletResponse response,\n        FilterChain chain){\n\n          ...\n\n          // è°ç¨ Filter çæ¹æ³\n          chain.doFilter(request, response);\n\n      }\n\n\næ³¨æ Filter ç doFilter æ¹æ³æä¸ªå³é®åæ° FilterChainï¼å°±æ¯ Filter é¾ãå¹¶ä¸æ¯ä¸ª Filter å¨å®ç° doFilter æ¶ï¼å¿é¡»è¦è°ç¨ Filter é¾ç doFilter æ¹æ³ï¼è Filter é¾ä¸­ä¿å­å½å FIlter çä½ç½®ï¼ä¼è°ç¨ä¸ä¸ä¸ª FIlter ç doFilter æ¹æ³ï¼è¿æ ·é¾å¼è°ç¨å°±å®æäºã\n\nFilter é¾è· Tomcat ç Pipeline-Valve æ¬è´¨é½æ¯è´£ä»»é¾æ¨¡å¼ï¼ä½æ¯å¨å·ä½å®ç°ä¸ç¨æä¸åï¼ä½ å¯ä»¥ç»ç»ä½ä¼ä¸ä¸ã\n\n\n# Listener ç®¡ç\n\næä»¬æ¥çè Servlet è§èé Listenerãè· Filter ä¸æ ·ï¼Listener ä¹æ¯ä¸ç§æ©å±æºå¶ï¼ä½ å¯ä»¥çå¬å®¹å¨åé¨åççäºä»¶ï¼ä¸»è¦æä¸¤ç±»äºä»¶ï¼\n\n * ç¬¬ä¸ç±»æ¯çå½ç¶æçååï¼æ¯å¦ Context å®¹å¨å¯å¨ååæ­¢ãSession çåå»ºåéæ¯ã\n * ç¬¬äºç±»æ¯å±æ§çååï¼æ¯å¦ Context å®¹å¨æä¸ªå±æ§å¼åäºãSession çæä¸ªå±æ§å¼åäºä»¥åæ°çè¯·æ±æ¥äºç­ã\n\næä»¬å¯ä»¥å¨web.xmléç½®æèéè¿æ³¨è§£çæ¹å¼æ¥æ·»å çå¬å¨ï¼å¨çå¬å¨éå®ç°æä»¬çä¸å¡é»è¾ãå¯¹äº Tomcat æ¥è¯´ï¼å®éè¦è¯»åéç½®æä»¶ï¼æ¿å°çå¬å¨ç±»çåå­ï¼å®ä¾åè¿äºç±»ï¼å¹¶ä¸å¨åéçæ¶æºè°ç¨è¿äºçå¬å¨çæ¹æ³ã\n\nTomcat æ¯éè¿ Context å®¹å¨æ¥ç®¡çè¿äºçå¬å¨çãContext å®¹å¨å°ä¸¤ç±»äºä»¶åå¼æ¥ç®¡çï¼åå«ç¨ä¸åçéåæ¥å­æ¾ä¸åç±»åäºä»¶ççå¬å¨ï¼\n\n// çå¬å±æ§å¼ååççå¬å¨\nprivate List<Object> applicationEventListenersList = new CopyOnWriteArrayList<>();\n\n// çå¬çå½äºä»¶ççå¬å¨\nprivate Object applicationLifecycleListenersObjects[] = new Object[0];\n\n\nå©ä¸çäºæå°±æ¯è§¦åçå¬å¨äºï¼æ¯å¦å¨ Context å®¹å¨çå¯å¨æ¹æ³éï¼å°±è§¦åäºææç ServletContextListenerï¼\n\n//1. æ¿å°ææççå½å¨æçå¬å¨\nObject instances[] = getApplicationLifecycleListeners();\n\nfor (int i = 0; i < instances.length; i++) {\n   //2. å¤æ­ Listener çç±»åæ¯ä¸æ¯ ServletContextListener\n   if (!(instances[i] instanceof ServletContextListener))\n      continue;\n\n   //3. è§¦å Listener çæ¹æ³\n   ServletContextListener lr = (ServletContextListener) instances[i];\n   lr.contextInitialized(event);\n}\n\n\néè¦æ³¨æçæ¯ï¼è¿éç ServletContextListener æ¥å£æ¯ä¸ç§çç»ç¨æ·çæ©å±æºå¶ï¼ç¨æ·å¯ä»¥å®ç°è¿ä¸ªæ¥å£æ¥å®ä¹èªå·±ççå¬å¨ï¼çå¬ Context å®¹å¨çå¯åäºä»¶ãSpring å°±æ¯è¿ä¹åçãServletContextListener è· Tomcat èªå·±ççå½å¨æäºä»¶ LifecycleListener æ¯ä¸åçãLifecycleListener å®ä¹å¨çå½å¨æç®¡çç»ä»¶ä¸­ï¼ç±åºç±» LifeCycleBase ç»ä¸ç®¡çã\n\n\n# Tomcat æ¯æå¼æ­¥ Servlet\n\n\n# å¼æ­¥ç¤ºä¾\n\n@WebServlet(urlPatterns = {"/async"}, asyncSupported = true)\npublic class AsyncServlet extends HttpServlet {\n\n    //Web åºç¨çº¿ç¨æ± ï¼ç¨æ¥å¤çå¼æ­¥ Servlet\n    ExecutorService executor = Executors.newSingleThreadExecutor();\n\n    public void service(HttpServletRequest req, HttpServletResponse resp) {\n        //1. è°ç¨ startAsync æèå¼æ­¥ä¸ä¸æ\n        final AsyncContext ctx = req.startAsync();\n\n       // ç¨çº¿ç¨æ± æ¥æ§è¡èæ¶æä½\n        executor.execute(new Runnable() {\n\n            @Override\n            public void run() {\n\n                // å¨è¿éåèæ¶çæä½\n                try {\n                    ctx.getResponse().getWriter().println("Handling Async Servlet");\n                } catch (IOException e) {}\n\n                //3. å¼æ­¥ Servlet å¤çå®äºè°ç¨å¼æ­¥ä¸ä¸æç complete æ¹æ³\n                ctx.complete();\n            }\n\n        });\n    }\n}\n\n\næä¸ä¸ªè¦ç¹ï¼\n\n 1. éè¿æ³¨è§£çæ¹å¼æ¥æ³¨å Servletï¼é¤äº @WebServlet æ³¨è§£ï¼è¿éè¦å ä¸ asyncSupported=true çå±æ§ï¼è¡¨æå½åç Servlet æ¯ä¸ä¸ªå¼æ­¥ Servletã\n 2. Web åºç¨ç¨åºéè¦è°ç¨ Request å¯¹è±¡ç startAsync æ¹æ³æ¥æ¿å°ä¸ä¸ªå¼æ­¥ä¸ä¸æ AsyncContextãè¿ä¸ªä¸ä¸æä¿å­äºè¯·æ±åååºå¯¹è±¡ã\n 3. Web åºç¨éè¦å¼å¯ä¸ä¸ªæ°çº¿ç¨æ¥å¤çèæ¶çæä½ï¼å¤çå®æåéè¦è°ç¨ AsyncContext ç complete æ¹æ³ãç®çæ¯åè¯ Tomcatï¼è¯·æ±å·²ç»å¤çå®æã\n\nè¿éè¯·ä½ æ³¨æï¼è½ç¶å¼æ­¥ Servlet åè®¸ç¨æ´é¿çæ¶é´æ¥å¤çè¯·æ±ï¼ä½æ¯ä¹æè¶æ¶éå¶çï¼é»è®¤æ¯ 30 ç§ï¼å¦æ 30 ç§åè¯·æ±è¿æ²¡å¤çå®ï¼Tomcat ä¼è§¦åè¶æ¶æºå¶ï¼åæµè§å¨è¿åè¶æ¶éè¯¯ï¼å¦æè¿ä¸ªæ¶åä½ ç Web åºç¨åè°ç¨ctx.completeæ¹æ³ï¼ä¼å¾å°ä¸ä¸ª IllegalStateException å¼å¸¸ã\n\n\n# å¼æ­¥ Servlet åç\n\néè¿ä¸é¢çä¾å­ï¼ç¸ä¿¡ä½ å¯¹ Servlet çå¼æ­¥å®ç°æäºåºæ¬ççè§£ãè¦çè§£ Tomcat å¨è¿ä¸ªè¿ç¨é½åäºä»ä¹äºæï¼å³é®å°±æ¯è¦å¼æ¸æ¥req.startAsyncæ¹æ³åctx.completeæ¹æ³é½åäºä»ä¹ã\n\n# startAsync æ¹æ³\n\nstartAsync æ¹æ³å¶å®å°±æ¯åå»ºäºä¸ä¸ªå¼æ­¥ä¸ä¸æ AsyncContext å¯¹è±¡ï¼AsyncContext å¯¹è±¡çä½ç¨æ¯ä¿å­è¯·æ±çä¸­é´ä¿¡æ¯ï¼æ¯å¦ Request å Response å¯¹è±¡ç­ä¸ä¸æä¿¡æ¯ãä½ æ¥æèä¸ä¸ä¸ºä»ä¹éè¦ä¿å­è¿äºä¿¡æ¯å¢ï¼\n\nè¿æ¯å ä¸º Tomcat çå·¥ä½çº¿ç¨å¨Request.startAsyncè°ç¨ä¹åï¼å°±ç´æ¥ç»æåå°çº¿ç¨æ± ä¸­äºï¼çº¿ç¨æ¬èº«ä¸ä¼ä¿å­ä»»ä½ä¿¡æ¯ãä¹å°±æ¯è¯´ä¸ä¸ªè¯·æ±å°æå¡ç«¯ï¼æ§è¡å°ä¸åï¼ä½ ç Web åºç¨æ­£å¨å¤çï¼è¿ä¸ªæ¶å Tomcat çå·¥ä½çº¿ç¨æ²¡äºï¼è¿å°±éè¦æä¸ªç¼å­è½å¤ä¿å­åå§ç Request å Response å¯¹è±¡ï¼èè¿ä¸ªç¼å­å°±æ¯ AsyncContextã\n\næäº AsyncContextï¼ä½ ç Web åºç¨éè¿å®æ¿å° request å response å¯¹è±¡ï¼æ¿å° Request å¯¹è±¡åå°±å¯ä»¥è¯»åè¯·æ±ä¿¡æ¯ï¼è¯·æ±å¤çå®äºè¿éè¦éè¿ Response å¯¹è±¡å° HTTP ååºåéç»æµè§å¨ã\n\né¤äºåå»º AsyncContext å¯¹è±¡ï¼startAsync è¿éè¦å®æä¸ä¸ªå³é®ä»»å¡ï¼é£å°±æ¯åè¯ Tomcat å½åç Servlet å¤çæ¹æ³è¿åæ¶ï¼ä¸è¦æååºåå°æµè§å¨ï¼å ä¸ºè¿ä¸ªæ¶åï¼ååºè¿æ²¡çæå¢ï¼å¹¶ä¸ä¸è½æ Request å¯¹è±¡å Response å¯¹è±¡éæ¯ï¼å ä¸ºåé¢ Web åºç¨è¿è¦ç¨å¢ã\n\nå¨ Tomcat ä¸­ï¼è´è´£ flush ååºæ°æ®çæ¯ CoyoteAdaptorï¼å®è¿ä¼éæ¯ Request å¯¹è±¡å Response å¯¹è±¡ï¼å æ­¤éè¦éè¿æç§æºå¶éç¥ CoyoteAdaptorï¼å·ä½æ¥è¯´æ¯éè¿ä¸é¢è¿è¡ä»£ç ï¼\n\nthis.request.getCoyoteRequest().action(ActionCode.ASYNC_START, this);\n\n\nä½ å¯ä»¥æå®çè§£ä¸ºä¸ä¸ª Callbackï¼å¨è¿ä¸ª action æ¹æ³éè®¾ç½®äº Request å¯¹è±¡çç¶æï¼è®¾ç½®å®ä¸ºä¸ä¸ªå¼æ­¥ Servlet è¯·æ±ã\n\næä»¬ç¥éè¿æ¥å¨æ¯è°ç¨ CoyoteAdapter ç service æ¹æ³æ¥å¤çè¯·æ±çï¼è CoyoteAdapter ä¼è°ç¨å®¹å¨ç service æ¹æ³ï¼å½å®¹å¨ç service æ¹æ³è¿åæ¶ï¼CoyoteAdapter å¤æ­å½åçè¯·æ±æ¯ä¸æ¯å¼æ­¥ Servlet è¯·æ±ï¼å¦ææ¯ï¼å°±ä¸ä¼éæ¯ Request å Response å¯¹è±¡ï¼ä¹ä¸ä¼æååºä¿¡æ¯åå°æµè§å¨ãä½ å¯ä»¥éè¿ä¸é¢çä»£ç çè§£ä¸ä¸ï¼è¿æ¯ CoyoteAdapter ç service æ¹æ³ï¼æå¯¹å®è¿è¡äºç®åï¼\n\npublic void service(org.apache.coyote.Request req, org.apache.coyote.Response res) {\n\n   // è°ç¨å®¹å¨ç service æ¹æ³å¤çè¯·æ±\n    connector.getService().getContainer().getPipeline().\n           getFirst().invoke(request, response);\n\n   // å¦ææ¯å¼æ­¥ Servlet è¯·æ±ï¼ä»ä»è®¾ç½®ä¸ä¸ªæ å¿ï¼\n   // å¦åè¯´ææ¯åæ­¥ Servlet è¯·æ±ï¼å°±å°ååºæ°æ®å·å°æµè§å¨\n    if (request.isAsync()) {\n        async = true;\n    } else {\n        request.finishRequest();\n        response.finishResponse();\n    }\n\n   // å¦æä¸æ¯å¼æ­¥ Servlet è¯·æ±ï¼å°±éæ¯ Request å¯¹è±¡å Response å¯¹è±¡\n    if (!async) {\n        request.recycle();\n        response.recycle();\n    }\n}\n\n\næ¥ä¸æ¥ï¼å½ CoyoteAdaptor ç service æ¹æ³è¿åå° ProtocolHandler ç»ä»¶æ¶ï¼ProtocolHandler å¤æ­è¿åå¼ï¼å¦æå½åè¯·æ±æ¯ä¸ä¸ªå¼æ­¥ Servlet è¯·æ±ï¼å®ä¼æå½å Socket çåè®®å¤çè Processor ç¼å­èµ·æ¥ï¼å° SocketWrapper å¯¹è±¡åç¸åºç Processor å­å°ä¸ä¸ª Map æ°æ®ç»æéã\n\nprivate final Map<S,Processor> connections = new ConcurrentHashMap<>();\n\n\nä¹æä»¥è¦ç¼å­æ¯å ä¸ºè¿ä¸ªè¯·æ±æ¥ä¸æ¥è¿è¦æ¥çå¤çï¼è¿æ¯ç±åæ¥ç Processor æ¥å¤çï¼éè¿ SocketWrapper å°±è½ä» Map éæ¾å°ç¸åºç Processorã\n\n# complete æ¹æ³\n\næ¥çæä»¬åæ¥çå³é®çctx.completeæ¹æ³ï¼å½è¯·æ±å¤çå®ææ¶ï¼Web åºç¨è°ç¨è¿ä¸ªæ¹æ³ãé£ä¹è¿ä¸ªæ¹æ³åäºäºä»ä¹äºæå¢ï¼æéè¦çå°±æ¯æååºæ°æ®åéå°æµè§å¨ã\n\nè¿ä»¶äºæä¸è½ç± Web åºç¨çº¿ç¨æ¥åï¼ä¹å°±æ¯è¯´ctx.completeæ¹æ³ä¸è½ç´æ¥æååºæ°æ®åéå°æµè§å¨ï¼å ä¸ºè¿ä»¶äºæåºè¯¥ç± Tomcat çº¿ç¨æ¥åï¼ä½å·ä½æä¹åå¢ï¼\n\næä»¬ç¥éï¼è¿æ¥å¨ä¸­ç Endpoint ç»ä»¶æ£æµå°æè¯·æ±æ°æ®è¾¾å°æ¶ï¼ä¼åå»ºä¸ä¸ª SocketProcessor å¯¹è±¡äº¤ç»çº¿ç¨æ± å»å¤çï¼å æ­¤ Endpoint çéä¿¡å¤çåå·ä½è¯·æ±å¤çå¨ä¸¤ä¸ªçº¿ç¨éè¿è¡ã\n\nå¨å¼æ­¥ Servlet çåºæ¯éï¼Web åºç¨éè¿è°ç¨ctx.completeæ¹æ³æ¶ï¼ä¹å¯ä»¥çæä¸ä¸ªæ°ç SocketProcessor ä»»å¡ç±»ï¼äº¤ç»çº¿ç¨æ± å¤çãå¯¹äºå¼æ­¥ Servlet è¯·æ±æ¥è¯´ï¼ç¸åºç Socket ååè®®å¤çç»ä»¶ Processor é½è¢«ç¼å­èµ·æ¥äºï¼å¹¶ä¸è¿äºå¯¹è±¡é½å¯ä»¥éè¿ Request å¯¹è±¡æ¿å°ã\n\nè®²å°è¿éï¼ä½ å¯è½å·²ç»çå°ctx.completeæ¯å¦ä½å®ç°çäºï¼\n\npublic void complete() {\n    // æ£æ¥ç¶æåæ³æ§ï¼æä»¬åå¿½ç¥è¿å¥\n    check();\n\n    // è°ç¨ Request å¯¹è±¡ç action æ¹æ³ï¼å¶å®å°±æ¯éç¥è¿æ¥å¨ï¼è¿ä¸ªå¼æ­¥è¯·æ±å¤çå®äº\nrequest.getCoyoteRequest().action(ActionCode.ASYNC_COMPLETE, null);\n\n}\n\n\næä»¬å¯ä»¥çå° complete æ¹æ³è°ç¨äº Request å¯¹è±¡ç action æ¹æ³ãèå¨ action æ¹æ³éï¼åæ¯è°ç¨äº Processor ç processSocketEvent æ¹æ³ï¼å¹¶ä¸ä¼ å¥äºæä½ç  OPEN_READã\n\ncase ASYNC_COMPLETE: {\n    clearDispatches();\n    if (asyncStateMachine.asyncComplete()) {\n        processSocketEvent(SocketEvent.OPEN_READ, true);\n    }\n    break;\n}\n\n\næä»¬æ¥çç processSocketEvent æ¹æ³ï¼å®è°ç¨ SocketWrapper ç processSocket æ¹æ³ï¼\n\nprotected void processSocketEvent(SocketEvent event, boolean dispatch) {\n    SocketWrapperBase<?> socketWrapper = getSocketWrapper();\n    if (socketWrapper != null) {\n        socketWrapper.processSocket(event, dispatch);\n    }\n}\n\n\nè SocketWrapper ç processSocket æ¹æ³ä¼åå»º SocketProcessor ä»»å¡ç±»ï¼å¹¶éè¿ Tomcat çº¿ç¨æ± æ¥å¤çï¼\n\npublic boolean processSocket(SocketWrapperBase<S> socketWrapper,\n        SocketEvent event, boolean dispatch) {\n\n      if (socketWrapper == null) {\n          return false;\n      }\n\n      SocketProcessorBase<S> sc = processorCache.pop();\n      if (sc == null) {\n          sc = createSocketProcessor(socketWrapper, event);\n      } else {\n          sc.reset(socketWrapper, event);\n      }\n      // çº¿ç¨æ± è¿è¡\n      Executor executor = getExecutor();\n      if (dispatch && executor != null) {\n          executor.execute(sc);\n      } else {\n          sc.run();\n      }\n}\n\n\nè¯·ä½ æ³¨æ createSocketProcessor å½æ°çç¬¬äºä¸ªåæ°æ¯ SocketEventï¼è¿éæä»¬ä¼ å¥çæ¯ OPEN_READãéè¿è¿ä¸ªåæ°ï¼æä»¬å°±è½æ§å¶ SocketProcessor çè¡ä¸ºï¼å ä¸ºæä»¬ä¸éè¦åæè¯·æ±åéå°å®¹å¨è¿è¡å¤çï¼åªéè¦åæµè§å¨ç«¯åéæ°æ®ï¼å¹¶ä¸éæ°å¨è¿ä¸ª Socket ä¸çå¬æ°çè¯·æ±å°±è¡äºã\n\n\n# åèèµæ\n\n * å®æ¹\n   * Tomcat å®æ¹ç½ç«\n   * Tomcat Wiki\n   * Tomee å®æ¹ç½ç«\n * æç¨\n   * æ·±å¥æè§£ Tomcat & Jetty',normalizedContent:'# tomcat å®¹å¨\n\n\n# tomcat å®ç°ç­é¨ç½²åç­å è½½\n\n * ç­å è½½çå®ç°æ¹å¼æ¯ web å®¹å¨å¯å¨ä¸ä¸ªåå°çº¿ç¨ï¼å®ææ£æµç±»æä»¶çååï¼å¦ææååï¼å°±éæ°å è½½ç±»ï¼å¨è¿ä¸ªè¿ç¨ä¸­ä¸ä¼æ¸ç©º session ï¼ä¸è¬ç¨å¨å¼åç¯å¢ã\n * ç­é¨ç½²åçç±»ä¼¼ï¼ä¹æ¯ç±åå°çº¿ç¨å®æ¶æ£æµ web åºç¨çååï¼ä½å®ä¼éæ°å è½½æ´ä¸ª web åºç¨ãè¿ç§æ¹å¼ä¼æ¸ç©º sessionï¼æ¯ç­å è½½æ´å å¹²åãå½»åºï¼ä¸è¬ç¨å¨çäº§ç¯å¢ã\n\ntomcat éè¿å¼å¯åå°çº¿ç¨ï¼ä½¿å¾åä¸ªå±æ¬¡çå®¹å¨ç»ä»¶é½ææºä¼å®æä¸äºå¨ææ§ä»»å¡ãtomcat æ¯åºäº scheduledthreadpoolexecutor å®ç°å¨ææ§ä»»å¡çï¼\n\nbgfuture = exec.schedulewithfixeddelay(\n              new containerbackgroundprocessor(),// è¦æ§è¡ç runnable\n              backgroundprocessordelay, // ç¬¬ä¸æ¬¡æ§è¡å»¶è¿å¤ä¹\n              backgroundprocessordelay, // ä¹åæ¯æ¬¡æ§è¡é´éå¤ä¹\n              timeunit.seconds);        // æ¶é´åä½\n\n\nç¬¬ä¸ä¸ªåæ°å°±æ¯è¦å¨ææ§æ§è¡çä»»å¡ç±» containerbackgroundprocessorï¼å®æ¯ä¸ä¸ª runnableï¼åæ¶ä¹æ¯ containerbase çåé¨ç±»ï¼containerbase æ¯ææå®¹å¨ç»ä»¶çåºç±»ï¼æä»¬æ¥åå¿ä¸ä¸å®¹å¨ç»ä»¶æåªäºï¼æ engineãhostãcontext å wrapper ç­ï¼å®ä»¬å·æç¶å­å³ç³»ã\n\n\n# containerbackgroundprocessor å®ç°\n\næä»¬æ¥æ¥ç containerbackgroundprocessor å·ä½æ¯å¦ä½å®ç°çã\n\nprotected class containerbackgroundprocessor implements runnable {\n\n    @override\n    public void run() {\n        // è¯·æ³¨æè¿éä¼ å¥çåæ°æ¯ " å®¿ä¸»ç±» " çå®ä¾\n        processchildren(containerbase.this);\n    }\n\n    protected void processchildren(container container) {\n        try {\n            //1. è°ç¨å½åå®¹å¨ç backgroundprocess æ¹æ³ã\n            container.backgroundprocess();\n\n            //2. éåææçå­å®¹å¨ï¼éå½è°ç¨ processchildrenï¼\n            // è¿æ ·å½åå®¹å¨çå­å­é½ä¼è¢«å¤ç\n            container[] children = container.findchildren();\n            for (int i = 0; i < children.length; i++) {\n            // è¿éè¯·ä½ æ³¨æï¼å®¹å¨åºç±»æä¸ªåéå«å backgroundprocessordelayï¼å¦æå¤§äº 0ï¼è¡¨æå­å®¹å¨æèªå·±çåå°çº¿ç¨ï¼æ éç¶å®¹å¨æ¥è°ç¨å®ç processchildren æ¹æ³ã\n                if (children[i].getbackgroundprocessordelay() <= 0) {\n                    processchildren(children[i]);\n                }\n            }\n        } catch (throwable t) { ... }\n\n\nä¸é¢çä»£ç é»è¾ä¹æ¯æ¯è¾æ¸æ°çï¼é¦å containerbackgroundprocessor æ¯ä¸ä¸ª runnableï¼å®éè¦å®ç° run æ¹æ³ï¼å®ç run å¾ç®åï¼å°±æ¯è°ç¨äº processchildren æ¹æ³ãè¿éæä¸ªå°æå·§ï¼å®æâå®¿ä¸»ç±»âï¼ä¹å°±æ¯containerbase çç±»å®ä¾å½æåæ°ä¼ ç»äº run æ¹æ³ã\n\nèå¨ processchildren æ¹æ³éï¼å°±åäºä¸¤æ­¥ï¼è°ç¨å½åå®¹å¨ç backgroundprocess æ¹æ³ï¼ä»¥åéå½è°ç¨å­å­ç backgroundprocess æ¹æ³ãè¯·ä½ æ³¨æ backgroundprocess æ¯ container æ¥å£ä¸­çæ¹æ³ï¼ä¹å°±æ¯è¯´ææç±»åçå®¹å¨é½å¯ä»¥å®ç°è¿ä¸ªæ¹æ³ï¼å¨è¿ä¸ªæ¹æ³éå®æéè¦å¨ææ§æ§è¡çä»»å¡ã\n\nè¿æ ·çè®¾è®¡æå³çä»ä¹å¢ï¼æä»¬åªéè¦å¨é¡¶å±å®¹å¨ï¼ä¹å°±æ¯ engine å®¹å¨ä¸­å¯å¨ä¸ä¸ªåå°çº¿ç¨ï¼é£ä¹è¿ä¸ªçº¿ç¨ä¸ä½ä¼æ§è¡ engine å®¹å¨çå¨ææ§ä»»å¡ï¼å®è¿ä¼æ§è¡ææå­å®¹å¨çå¨ææ§ä»»å¡ã\n\n\n# backgroundprocess æ¹æ³\n\nä¸è¿°ä»£ç é½æ¯å¨åºç±» containerbase ä¸­å®ç°çï¼é£å·ä½å®¹å¨ç±»éè¦åä»ä¹å¢ï¼å¶å®å¾ç®åï¼å¦ææå¨ææ§ä»»å¡è¦æ§è¡ï¼å°±å®ç° backgroundprocess æ¹æ³ï¼å¦ææ²¡æï¼å°±éç¨åºç±» containerbase çæ¹æ³ãcontainerbase ç backgroundprocess æ¹æ³å®ç°å¦ä¸ï¼\n\npublic void backgroundprocess() {\n\n    //1. æ§è¡å®¹å¨ä¸­ cluster ç»ä»¶çå¨ææ§ä»»å¡\n    cluster cluster = getclusterinternal();\n    if (cluster != null) {\n        cluster.backgroundprocess();\n    }\n\n    //2. æ§è¡å®¹å¨ä¸­ realm ç»ä»¶çå¨ææ§ä»»å¡\n    realm realm = getrealminternal();\n    if (realm != null) {\n        realm.backgroundprocess();\n   }\n\n   //3. æ§è¡å®¹å¨ä¸­ valve ç»ä»¶çå¨ææ§ä»»å¡\n    valve current = pipeline.getfirst();\n    while (current != null) {\n       current.backgroundprocess();\n       current = current.getnext();\n    }\n\n    //4. è§¦åå®¹å¨ç " å¨æäºä»¶ "ï¼host å®¹å¨ççå¬å¨ hostconfig å°±é å®æ¥è°ç¨\n    firelifecycleevent(lifecycle.periodic_event, null);\n}\n\n\nä»ä¸é¢çä»£ç å¯ä»¥çå°ï¼ä¸ä»æ¯ä¸ªå®¹å¨å¯ä»¥æå¨ææ§ä»»å¡ï¼æ¯ä¸ªå®¹å¨ä¸­çå¶ä»éç¨ç»ä»¶ï¼æ¯å¦è·éç¾¤ç®¡çæå³ç cluster ç»ä»¶ãè·å®å¨ç®¡çæå³ç realm ç»ä»¶é½å¯ä»¥æèªå·±çå¨ææ§ä»»å¡ã\n\næå¨åé¢çä¸æ éæå°è¿ï¼å®¹å¨ä¹é´çé¾å¼è°ç¨æ¯éè¿ pipeline-valve æºå¶æ¥å®ç°çï¼ä»ä¸é¢çä»£ç ä½ å¯ä»¥çå°å®¹å¨ä¸­ç valve ä¹å¯ä»¥æå¨ææ§ä»»å¡ï¼å¹¶ä¸è¢« containerbase ç»ä¸å¤çã\n\nè¯·ä½ ç¹å«æ³¨æçæ¯ï¼å¨ backgroundprocess æ¹æ³çæåï¼è¿è§¦åäºå®¹å¨çâå¨æäºä»¶âãæä»¬ç¥éå®¹å¨ççå½å¨æäºä»¶æåå§åãå¯å¨ååæ­¢ç­ï¼é£âå¨æäºä»¶âåæ¯ä»ä¹å¢ï¼å®è·çå½å¨æäºä»¶ä¸æ ·ï¼æ¯ä¸ç§æ©å±æºå¶ï¼ä½ å¯ä»¥è¿æ ·çè§£ï¼\n\nåä¸æ®µæ¶é´è¿å»äºï¼å®¹å¨è¿æ´»çï¼ä½ æ³åç¹ä»ä¹åï¼å¦æä½ æ³åç¹ä»ä¹ï¼å°±åå»ºä¸ä¸ªçå¬å¨æ¥çå¬è¿ä¸ªâå¨æäºä»¶âï¼äºä»¶å°äºæè´è´£è°ç¨ä½ çæ¹æ³ã\n\næ»ä¹ï¼æäº containerbase ä¸­çåå°çº¿ç¨å backgroundprocess æ¹æ³ï¼åç§å­å®¹å¨åéç¨ç»ä»¶ä¸éè¦åèªå¼ä¸ä¸ªåå°çº¿ç¨æ¥å¤çå¨ææ§ä»»å¡ï¼è¿æ ·çè®¾è®¡æ¾å¾ä¼éåæ´æ´ã\n\n\n# tomcat ç­å è½½\n\næäº containerbase çå¨ææ§ä»»å¡å¤çâæ¡æ¶âï¼ä½ä¸ºå·ä½å®¹å¨å­ç±»ï¼åªéè¦å®ç°èªå·±çå¨ææ§ä»»å¡å°±è¡ãè tomcat çç­å è½½ï¼å°±æ¯å¨ context å®¹å¨ä¸­å®ç°çãcontext å®¹å¨ç backgroundprocess æ¹æ³æ¯è¿æ ·å®ç°çï¼\n\npublic void backgroundprocess() {\n\n    //webapploader å¨ææ§çæ£æ¥ web-inf/classes å web-inf/lib ç®å½ä¸çç±»æä»¶\n    loader loader = getloader();\n    if (loader != null) {\n        loader.backgroundprocess();\n    }\n\n    //session ç®¡çå¨å¨ææ§çæ£æ¥æ¯å¦æè¿æç session\n    manager manager = getmanager();\n    if (manager != null) {\n        manager.backgroundprocess();\n    }\n\n    // å¨ææ§çæ£æ¥éæèµæºæ¯å¦æåå\n    webresourceroot resources = getresources();\n    if (resources != null) {\n        resources.backgroundprocess();\n    }\n\n    // è°ç¨ç¶ç±» containerbase ç backgroundprocess æ¹æ³\n    super.backgroundprocess();\n}\n\n\nä»ä¸é¢çä»£ç æä»¬çå° context å®¹å¨éè¿ webapploader æ¥æ£æ¥ç±»æä»¶æ¯å¦ææ´æ°ï¼éè¿ session ç®¡çå¨æ¥æ£æ¥æ¯å¦æ session è¿æï¼å¹¶ä¸éè¿èµæºç®¡çå¨æ¥æ£æ¥éæèµæºæ¯å¦ææ´æ°ï¼æåè¿è°ç¨äºç¶ç±» containerbase ç backgroundprocess æ¹æ³ã\n\nè¿éæä»¬è¦éç¹å³æ³¨ï¼webapploader æ¯å¦ä½å®ç°ç­å è½½çï¼å®ä¸»è¦æ¯è°ç¨äº context å®¹å¨ç reload æ¹æ³ï¼è context ç reload æ¹æ³æ¯è¾å¤æï¼æ»ç»èµ·æ¥ï¼ä¸»è¦å®æäºä¸é¢è¿äºä»»å¡ï¼\n\n 1. åæ­¢åéæ¯ context å®¹å¨åå¶ææå­å®¹å¨ï¼å­å®¹å¨å¶å®å°±æ¯ wrapperï¼ä¹å°±æ¯è¯´ wrapper éé¢ servlet å®ä¾ä¹è¢«éæ¯äºã\n 2. åæ­¢åéæ¯ context å®¹å¨å³èç listener å filterã\n 3. åæ­¢åéæ¯ context ä¸ç pipeline ååç§ valveã\n 4. åæ­¢åéæ¯ context çç±»å è½½å¨ï¼ä»¥åç±»å è½½å¨å è½½çç±»æä»¶èµæºã\n 5. å¯å¨ context å®¹å¨ï¼å¨è¿ä¸ªè¿ç¨ä¸­ä¼éæ°åå»ºåé¢åæ­¥è¢«éæ¯çèµæºã\n\nå¨è¿ä¸ªè¿ç¨ä¸­ï¼ç±»å è½½å¨åæ¥çå³é®ä½ç¨ãä¸ä¸ª context å®¹å¨å¯¹åºä¸ä¸ªç±»å è½½å¨ï¼ç±»å è½½å¨å¨éæ¯çè¿ç¨ä¸­ä¼æå®å è½½çææç±»ä¹å¨é¨éæ¯ãcontext å®¹å¨å¨å¯å¨è¿ç¨ä¸­ï¼ä¼åå»ºä¸ä¸ªæ°çç±»å è½½å¨æ¥å è½½æ°çç±»æä»¶ã\n\nå¨ context ç reload æ¹æ³éï¼å¹¶æ²¡æè°ç¨ session ç®¡çå¨ç distroy æ¹æ³ï¼ä¹å°±æ¯è¯´è¿ä¸ª context å³èç session æ¯æ²¡æéæ¯çãä½ è¿éè¦æ³¨æçæ¯ï¼tomcat çç­å è½½é»è®¤æ¯å³é­çï¼ä½ éè¦å¨ conf ç®å½ä¸ç context.xml æä»¶ä¸­è®¾ç½® reloadable åæ°æ¥å¼å¯è¿ä¸ªåè½ï¼åä¸é¢è¿æ ·ï¼\n\n<context reloadable="true"/>\n\n\n\n# tomcat ç­é¨ç½²\n\næä»¬åæ¥ççç­é¨ç½²ï¼ç­é¨ç½²è·ç­å è½½çæ¬è´¨åºå«æ¯ï¼ç­é¨ç½²ä¼éæ°é¨ç½² web åºç¨ï¼åæ¥ç context å¯¹è±¡ä¼æ´ä¸ªè¢«éæ¯æï¼å æ­¤è¿ä¸ª context æå³èçä¸åèµæºé½ä¼è¢«éæ¯ï¼åæ¬ sessionã\n\né£ä¹ tomcat ç­é¨ç½²åæ¯ç±åªä¸ªå®¹å¨æ¥å®ç°çå¢ï¼åºè¯¥ä¸æ¯ç± contextï¼å ä¸ºç­é¨ç½²è¿ç¨ä¸­ context å®¹å¨è¢«éæ¯äºï¼é£ä¹è¿ä¸ªéæå°±è½å¨ host èº«ä¸äºï¼å ä¸ºå®æ¯ context çç¶å®¹å¨ã\n\nè· context ä¸ä¸æ ·ï¼host å®¹å¨å¹¶æ²¡æå¨ backgroundprocess æ¹æ³ä¸­å®ç°å¨ææ§æ£æµçä»»å¡ï¼èæ¯éè¿çå¬å¨ hostconfig æ¥å®ç°çï¼hostconfig å°±æ¯åé¢æå°çâå¨æäºä»¶âççå¬å¨ï¼é£âå¨æäºä»¶âè¾¾å°æ¶ï¼hostconfig ä¼åä»ä¹äºå¢ï¼\n\npublic void lifecycleevent(lifecycleevent event) {\n    // æ§è¡ check æ¹æ³ã\n    if (event.gettype().equals(lifecycle.periodic_event)) {\n        check();\n    }\n}\n\n\nå®æ§è¡äº check æ¹æ³ï¼æä»¬æ¥çæ¥ç check æ¹æ³éåäºä»ä¹ã\n\nprotected void check() {\n\n    if (host.getautodeploy()) {\n        // æ£æ¥è¿ä¸ª host ä¸ææå·²ç»é¨ç½²ç web åºç¨\n        deployedapplication[] apps =\n            deployed.values().toarray(new deployedapplication[0]);\n\n        for (int i = 0; i < apps.length; i++) {\n            // æ£æ¥ web åºç¨ç®å½æ¯å¦æåå\n            checkresources(apps[i], false);\n        }\n\n        // æ§è¡é¨ç½²\n        deployapps();\n    }\n}\n\n\nå¶å® hostconfig ä¼æ£æ¥ webapps ç®å½ä¸çææ web åºç¨ï¼\n\n * å¦æåæ¥ web åºç¨ç®å½è¢«å æäºï¼å°±æç¸åº context å®¹å¨æ´ä¸ªéæ¯æã\n * æ¯å¦ææ°ç web åºç¨ç®å½æ¾è¿æ¥äºï¼æèææ°ç war åæ¾è¿æ¥äºï¼å°±é¨ç½²ç¸åºç web åºç¨ã\n\nå æ­¤ hostconfig åçäºæé½æ¯æ¯è¾âå®è§âçï¼å®ä¸ä¼å»æ£æ¥å·ä½ç±»æä»¶æèèµæºæä»¶æ¯å¦æååï¼èæ¯æ£æ¥ web åºç¨ç®å½çº§å«çååã\n\n\n# tomcat çç±»å è½½æºå¶\n\ntomcat çèªå®ä¹ç±»å è½½å¨ webappclassloader æç ´äºåäº²å§æ´¾æºå¶ï¼å®é¦åèªå·±å°è¯å»å è½½æä¸ªç±»ï¼å¦ææ¾ä¸å°åä»£çç»ç¶ç±»å è½½å¨ï¼å¶ç®çæ¯ä¼åå è½½ web åºç¨èªå·±å®ä¹çç±»ãå·ä½å®ç°å°±æ¯éå classloader çä¸¤ä¸ªæ¹æ³ï¼findclass å loadclassã\n\n\n# findclass æ¹æ³\n\næä»¬åæ¥çç findclass æ¹æ³çå®ç°ï¼ä¸ºäºæ¹ä¾¿çè§£åéè¯»ï¼æå»æäºä¸äºç»èï¼\n\npublic class<?> findclass(string name) throws classnotfoundexception {\n    ...\n\n    class<?> clazz = null;\n    try {\n            //1. åå¨ web åºç¨ç®å½ä¸æ¥æ¾ç±»\n            clazz = findclassinternal(name);\n    }  catch (runtimeexception e) {\n           throw e;\n       }\n\n    if (clazz == null) {\n    try {\n            //2. å¦æå¨æ¬å°ç®å½æ²¡ææ¾å°ï¼äº¤ç»ç¶å è½½å¨å»æ¥æ¾\n            clazz = super.findclass(name);\n    }  catch (runtimeexception e) {\n           throw e;\n       }\n\n    //3. å¦æç¶ç±»ä¹æ²¡æ¾å°ï¼æåº classnotfoundexception\n    if (clazz == null) {\n        throw new classnotfoundexception(name);\n     }\n\n    return clazz;\n}\n\n\nå¨ findclass æ¹æ³éï¼ä¸»è¦æä¸ä¸ªæ­¥éª¤ï¼\n\n 1. åå¨ web åºç¨æ¬å°ç®å½ä¸æ¥æ¾è¦å è½½çç±»ã\n 2. å¦ææ²¡ææ¾å°ï¼äº¤ç»ç¶å è½½å¨å»æ¥æ¾ï¼å®çç¶å è½½å¨å°±æ¯ä¸é¢æå°çç³»ç»ç±»å è½½å¨ appclassloaderã\n 3. å¦ä½ç¶å è½½å¨ä¹æ²¡æ¾å°è¿ä¸ªç±»ï¼æåº classnotfound å¼å¸¸ã\n\n\n# loadclass æ¹æ³\n\næ¥çæä»¬åæ¥ç tomcat ç±»å è½½å¨ç loadclass æ¹æ³çå®ç°ï¼åæ ·æä¹å»æäºä¸äºç»èï¼\n\npublic class<?> loadclass(string name, boolean resolve) throws classnotfoundexception {\n\n    synchronized (getclassloadinglock(name)) {\n\n        class<?> clazz = null;\n\n        //1. åå¨æ¬å° cache æ¥æ¾è¯¥ç±»æ¯å¦å·²ç»å è½½è¿\n        clazz = findloadedclass0(name);\n        if (clazz != null) {\n            if (resolve)\n                resolveclass(clazz);\n            return clazz;\n        }\n\n        //2. ä»ç³»ç»ç±»å è½½å¨ç cache ä¸­æ¥æ¾æ¯å¦å è½½è¿\n        clazz = findloadedclass(name);\n        if (clazz != null) {\n            if (resolve)\n                resolveclass(clazz);\n            return clazz;\n        }\n\n        // 3. å°è¯ç¨ extclassloader ç±»å è½½å¨ç±»å è½½ï¼ä¸ºä»ä¹ï¼\n        classloader javaseloader = getjavaseclassloader();\n        try {\n            clazz = javaseloader.loadclass(name);\n            if (clazz != null) {\n                if (resolve)\n                    resolveclass(clazz);\n                return clazz;\n            }\n        } catch (classnotfoundexception e) {\n            // ignore\n        }\n\n        // 4. å°è¯å¨æ¬å°ç®å½æç´¢ class å¹¶å è½½\n        try {\n            clazz = findclass(name);\n            if (clazz != null) {\n                if (resolve)\n                    resolveclass(clazz);\n                return clazz;\n            }\n        } catch (classnotfoundexception e) {\n            // ignore\n        }\n\n        // 5. å°è¯ç¨ç³»ç»ç±»å è½½å¨ (ä¹å°±æ¯ appclassloader) æ¥å è½½\n            try {\n                clazz = class.forname(name, false, parent);\n                if (clazz != null) {\n                    if (resolve)\n                        resolveclass(clazz);\n                    return clazz;\n                }\n            } catch (classnotfoundexception e) {\n                // ignore\n            }\n       }\n\n    //6. ä¸è¿°è¿ç¨é½å è½½å¤±è´¥ï¼æåºå¼å¸¸\n    throw new classnotfoundexception(name);\n}\n\n\nloadclass æ¹æ³ç¨å¾®å¤æä¸ç¹ï¼ä¸»è¦æå­ä¸ªæ­¥éª¤ï¼\n\n 1. åå¨æ¬å° cache æ¥æ¾è¯¥ç±»æ¯å¦å·²ç»å è½½è¿ï¼ä¹å°±æ¯è¯´ tomcat çç±»å è½½å¨æ¯å¦å·²ç»å è½½è¿è¿ä¸ªç±»ã\n 2. å¦æ tomcat ç±»å è½½å¨æ²¡æå è½½è¿è¿ä¸ªç±»ï¼åççç³»ç»ç±»å è½½å¨æ¯å¦å è½½è¿ã\n 3. å¦æé½æ²¡æï¼å°±è®©extclassloaderå»å è½½ï¼è¿ä¸æ­¥æ¯è¾å³é®ï¼ç®çé²æ­¢ web åºç¨èªå·±çç±»è¦ç jre çæ ¸å¿ç±»ãå ä¸º tomcat éè¦æç ´åäº²å§æ´¾æºå¶ï¼åå¦ web åºç¨éèªå®ä¹äºä¸ä¸ªå« object çç±»ï¼å¦æåå è½½è¿ä¸ª object ç±»ï¼å°±ä¼è¦ç jre éé¢çé£ä¸ª object ç±»ï¼è¿å°±æ¯ä¸ºä»ä¹ tomcat çç±»å è½½å¨ä¼ä¼åå°è¯ç¨ extclassloader å»å è½½ï¼å ä¸º extclassloader ä¼å§æç» bootstrapclassloader å»å è½½ï¼bootstrapclassloader åç°èªå·±å·²ç»å è½½äº object ç±»ï¼ç´æ¥è¿åç» tomcat çç±»å è½½å¨ï¼è¿æ · tomcat çç±»å è½½å¨å°±ä¸ä¼å»å è½½ web åºç¨ä¸ç object ç±»äºï¼ä¹å°±é¿åäºè¦ç jre æ ¸å¿ç±»çé®é¢ã\n 4. å¦æ extclassloader å è½½å¨å è½½å¤±è´¥ï¼ä¹å°±æ¯è¯´ jre æ ¸å¿ç±»ä¸­æ²¡æè¿ç±»ï¼é£ä¹å°±å¨æ¬å° web åºç¨ç®å½ä¸æ¥æ¾å¹¶å è½½ã\n 5. å¦ææ¬å°ç®å½ä¸æ²¡æè¿ä¸ªç±»ï¼è¯´æä¸æ¯ web åºç¨èªå·±å®ä¹çç±»ï¼é£ä¹ç±ç³»ç»ç±»å è½½å¨å»å è½½ãè¿éè¯·ä½ æ³¨æï¼web åºç¨æ¯éè¿class.fornameè°ç¨äº¤ç»ç³»ç»ç±»å è½½å¨çï¼å ä¸ºclass.fornameçé»è®¤å è½½å¨å°±æ¯ç³»ç»ç±»å è½½å¨ã\n 6. å¦æä¸è¿°å è½½è¿ç¨å¨é¨å¤±è´¥ï¼æåº classnotfound å¼å¸¸ã\n\nä»ä¸é¢çè¿ç¨æä»¬å¯ä»¥çå°ï¼tomcat çç±»å è½½å¨æç ´äºåäº²å§æ´¾æºå¶ï¼æ²¡æä¸ä¸æ¥å°±ç´æ¥å§æç»ç¶å è½½å¨ï¼èæ¯åå¨æ¬å°ç®å½ä¸å è½½ï¼ä¸ºäºé¿åæ¬å°ç®å½ä¸çç±»è¦ç jre çæ ¸å¿ç±»ï¼åå°è¯ç¨ jvm æ©å±ç±»å è½½å¨ extclassloader å»å è½½ãé£ä¸ºä»ä¹ä¸åç¨ç³»ç»ç±»å è½½å¨ appclassloader å»å è½½ï¼å¾æ¾ç¶ï¼å¦ææ¯è¿æ ·çè¯ï¼é£å°±åæåäº²å§æ´¾æºå¶äºï¼è¿å°±æ¯ tomcat ç±»å è½½å¨çå·§å¦ä¹å¤ã\n\n\n# tomcat å®ç°åºç¨éç¦»\n\ntomcat ä½ä¸º web å®¹å¨ï¼éè¦è§£å³ä»¥ä¸é®é¢ï¼\n\n 1. å¦æå¨ tomcat ä¸­è¿è¡äºä¸¤ä¸ª web åºç¨ç¨åºï¼ä¸¤ä¸ª web åºç¨ä¸­æååç servletï¼ä½æ¯åè½ä¸åï¼tomcat éè¦åæ¶å è½½åç®¡çè¿ä¸¤ä¸ªååç servlet ç±»ï¼ä¿è¯å®ä»¬ä¸ä¼å²çªï¼å æ­¤ web åºç¨ä¹é´çç±»éè¦éç¦»ã\n 2. ä¸¤ä¸ª web åºç¨é½ä¾èµåä¸ä¸ªç¬¬ä¸æ¹ç jar åï¼æ¯å¦ springï¼é£ spring ç jar åè¢«å è½½å°åå­åï¼tomcat è¦ä¿è¯è¿ä¸¤ä¸ª web åºç¨è½å¤å±äº«ï¼ä¹å°±æ¯è¯´ spring ç jar ååªè¢«å è½½ä¸æ¬¡ï¼å¦åéçä¾èµçç¬¬ä¸æ¹ jar åå¢å¤ï¼jvm çåå­ä¼è¨èã\n 3. éè¦éç¦» tomcat æ¬èº«çç±»å web åºç¨çç±»ã\n\n\n\n# webappclassloader\n\néå¯¹ç¬¬ä¸ä¸ªé®é¢ï¼\n\nå¦æä½¿ç¨ jvm é»è®¤ appclassloader æ¥å è½½ web åºç¨ï¼appclassloader åªè½å è½½ä¸ä¸ª servlet ç±»ï¼å¨å è½½ç¬¬äºä¸ªåå servlet ç±»æ¶ï¼appclassloader ä¼è¿åç¬¬ä¸ä¸ª servlet ç±»ç class å®ä¾ï¼è¿æ¯å ä¸ºå¨ appclassloader çæ¥ï¼ååç servlet ç±»åªè¢«å è½½ä¸æ¬¡ã\n\ntomcat çè§£å³æ¹æ¡æ¯èªå®ä¹ä¸ä¸ªç±»å è½½å¨ webappclassloaderï¼ å¹¶ä¸ç»æ¯ä¸ª web åºç¨åå»ºä¸ä¸ªç±»å è½½å¨å®ä¾ãæä»¬ç¥éï¼context å®¹å¨ç»ä»¶å¯¹åºä¸ä¸ª web åºç¨ï¼å æ­¤ï¼æ¯ä¸ª context å®¹å¨è´è´£åå»ºåç»´æ¤ä¸ä¸ª webappclassloader å è½½å¨å®ä¾ãè¿èåçåçæ¯ï¼ä¸åçå è½½å¨å®ä¾å è½½çç±»è¢«è®¤ä¸ºæ¯ä¸åçç±»ï¼å³ä½¿å®ä»¬çç±»åç¸åãè¿å°±ç¸å½äºå¨ java èææºåé¨åå»ºäºä¸ä¸ªä¸ªç¸äºéç¦»ç java ç±»ç©ºé´ï¼æ¯ä¸ä¸ª web åºç¨é½æèªå·±çç±»ç©ºé´ï¼web åºç¨ä¹é´éè¿åèªçç±»å è½½å¨äºç¸éç¦»ã\n\n# sharedclassloader\n\néå¯¹ç¬¬äºä¸ªé®é¢ï¼\n\næ¬è´¨éæ±æ¯ä¸¤ä¸ª web åºç¨ä¹é´æä¹å±äº«åºç±»ï¼å¹¶ä¸ä¸è½éå¤å è½½ç¸åçç±»ãæä»¬ç¥éï¼å¨åäº²å§æ´¾æºå¶éï¼åä¸ªå­å è½½å¨é½å¯ä»¥éè¿ç¶å è½½å¨å»å è½½ç±»ï¼é£ä¹æéè¦å±äº«çç±»æ¾å°ç¶å è½½å¨çå è½½è·¯å¾ä¸ä¸å°±è¡äºåï¼åºç¨ç¨åºä¹æ­£æ¯éè¿è¿ç§æ¹å¼å±äº« jre çæ ¸å¿ç±»ãå æ­¤ tomcat çè®¾è®¡èåå äºä¸ä¸ªç±»å è½½å¨ sharedclassloaderï¼ä½ä¸º webappclassloader çç¶å è½½å¨ï¼ä¸é¨æ¥å è½½ web åºç¨ä¹é´å±äº«çç±»ãå¦æ webappclassloader èªå·±æ²¡æå è½½å°æä¸ªç±»ï¼å°±ä¼å§æç¶å è½½å¨ sharedclassloader å»å è½½è¿ä¸ªç±»ï¼sharedclassloader ä¼å¨æå®ç®å½ä¸å è½½å±äº«ç±»ï¼ä¹åè¿åç» webappclassloaderï¼è¿æ ·å±äº«çé®é¢å°±è§£å³äºã\n\n# catalinaclassloader\n\nå¦ä½éç¦» tomcat æ¬èº«çç±»å web åºç¨çç±»ï¼\n\nè¦å±äº«å¯ä»¥éè¿ç¶å­å³ç³»ï¼è¦éç¦»é£å°±éè¦åå¼å³ç³»äºãåå¼å³ç³»å°±æ¯æä¸¤ä¸ªç±»å è½½å¨æ¯å¹³è¡çï¼å®ä»¬å¯è½æ¥æåä¸ä¸ªç¶å è½½å¨ï¼ä½æ¯ä¸¤ä¸ªåå¼ç±»å è½½å¨å è½½çç±»æ¯éç¦»çãåºäºæ­¤ tomcat åè®¾è®¡ä¸ä¸ªç±»å è½½å¨ catalinaclassloaderï¼ä¸é¨æ¥å è½½ tomcat èªèº«çç±»ãè¿æ ·è®¾è®¡æä¸ªé®é¢ï¼é£ tomcat åå web åºç¨ä¹é´éè¦å±äº«ä¸äºç±»æ¶è¯¥æä¹åå¢ï¼\n\n# commonclassloader\n\nèåæ³ï¼è¿æ¯åå¢å ä¸ä¸ª commonclassloaderï¼ä½ä¸º catalinaclassloader å sharedclassloader çç¶å è½½å¨ãcommonclassloader è½å è½½çç±»é½å¯ä»¥è¢« catalinaclassloader å sharedclassloader ä½¿ç¨ï¼è catalinaclassloader å sharedclassloader è½å è½½çç±»åä¸å¯¹æ¹ç¸äºéç¦»ãwebappclassloader å¯ä»¥ä½¿ç¨ sharedclassloader å è½½å°çç±»ï¼ä½åä¸ª webappclassloader å®ä¾ä¹é´ç¸äºéç¦»ã\n\n\n# tomcat å®ç° servlet è§è\n\nservlet å®¹å¨æéè¦çä»»å¡å°±æ¯åå»º servlet çå®ä¾å¹¶ä¸è°ç¨ servletã\n\nä¸ä¸ª web åºç¨éå¾å¾æå¤ä¸ª servletï¼èå¨ tomcat ä¸­ä¸ä¸ª web åºç¨å¯¹åºä¸ä¸ª context å®¹å¨ï¼ä¹å°±æ¯è¯´ä¸ä¸ª context å®¹å¨éè¦ç®¡çå¤ä¸ª servlet å®ä¾ãä½ context å®¹å¨å¹¶ä¸ç´æ¥ææ servlet å®ä¾ï¼èæ¯éè¿å­å®¹å¨ wrapper æ¥ç®¡ç servletï¼ä½ å¯ä»¥æ wrapper å®¹å¨çä½æ¯ servlet çåè£ã\n\nä¸ºä»ä¹éè¦ wrapper å¢ï¼context å®¹å¨ç´æ¥ç»´æ¤ä¸ä¸ª servlet æ°ç»ä¸å°±è¡äºåï¼è¿æ¯å ä¸º servlet ä¸ä»ä»æ¯ä¸ä¸ªç±»å®ä¾ï¼å®è¿æç¸å³çéç½®ä¿¡æ¯ï¼æ¯å¦å®ç url æ å°ãå®çåå§ååæ°ï¼å æ­¤è®¾è®¡åºäºä¸ä¸ªåè£å¨ï¼æ servlet æ¬èº«åå®ç¸å³çæ°æ®åèµ·æ¥ï¼æ²¡éï¼è¿å°±æ¯é¢åå¯¹è±¡çææ³ã\n\né¤æ­¤ä»¥å¤ï¼servlet è§èä¸­è¿æä¸¤ä¸ªéè¦ç¹æ§ï¼listener å filterï¼tomcat ä¹éè¦åå»ºå®ä»¬çå®ä¾ï¼å¹¶å¨åéçæ¶æºå»è°ç¨å®ä»¬çæ¹æ³ã\n\n\n# servlet ç®¡ç\n\ntomcat æ¯ç¨ wrapper å®¹å¨æ¥ç®¡ç servlet çï¼é£ wrapper å®¹å¨å·ä½é¿ä»ä¹æ ·å­å¢ï¼æä»¬åæ¥ççå®éé¢æåªäºå³é®çæååéï¼\n\nprotected volatile servlet instance = null;\n\n\nå®æ¥æä¸ä¸ª servlet å®ä¾ï¼å¹¶ä¸ wrapper éè¿ loadservlet æ¹æ³æ¥å®ä¾å servletãä¸ºäºæ¹ä¾¿ä½ éè¯»ï¼æç®åäºä»£ç ï¼\n\npublic synchronized servlet loadservlet() throws servletexception {\n    servlet servlet;\n\n    //1. åå»ºä¸ä¸ª servlet å®ä¾\n    servlet = (servlet) instancemanager.newinstance(servletclass);\n\n    //2. è°ç¨äº servlet ç init æ¹æ³ï¼è¿æ¯ servlet è§èè¦æ±ç\n    initservlet(servlet);\n\n    return servlet;\n}\n\n\nå¶å® loadservlet ä¸»è¦åäºä¸¤ä»¶äºï¼åå»º servlet çå®ä¾ï¼å¹¶ä¸è°ç¨ servlet ç init æ¹æ³ï¼å ä¸ºè¿æ¯ servlet è§èè¦æ±çã\n\né£æ¥ä¸æ¥çé®é¢æ¯ï¼ä»ä¹æ¶åä¼è°å°è¿ä¸ª loadservlet æ¹æ³å¢ï¼ä¸ºäºå å¿«ç³»ç»çå¯å¨éåº¦ï¼æä»¬å¾å¾ä¼éåèµæºå»¶è¿å è½½çç­ç¥ï¼tomcat ä¹ä¸ä¾å¤ï¼é»è®¤æåµä¸ tomcat å¨å¯å¨æ¶ä¸ä¼å è½½ä½ ç servletï¼é¤éä½ æ servlet çloadonstartupåæ°è®¾ç½®ä¸ºtrueã\n\nè¿éè¿éè¦ä½ æ³¨æçæ¯ï¼è½ç¶ tomcat å¨å¯å¨æ¶ä¸ä¼åå»º servlet å®ä¾ï¼ä½æ¯ä¼åå»º wrapper å®¹å¨ï¼å°±å¥½æ¯å°½ç®¡æªéé¢è¿æ²¡æå­å¼¹ï¼åææªé åºæ¥ãé£å­å¼¹ä»ä¹æ¶åé å¢ï¼æ¯çæ­£éè¦å¼æªçæ¶åï¼ä¹å°±æ¯è¯´æè¯·æ±æ¥è®¿é®æä¸ª servlet æ¶ï¼è¿ä¸ª servlet çå®ä¾æä¼è¢«åå»ºã\n\né£ servlet æ¯è¢«è°è°ç¨çå¢ï¼æä»¬åå¿ä¸ä¸ä¸æ åé¢æå°è¿ tomcat ç pipeline-valve æºå¶ï¼æ¯ä¸ªå®¹å¨ç»ä»¶é½æèªå·±ç pipelineï¼æ¯ä¸ª pipeline ä¸­æä¸ä¸ª valve é¾ï¼å¹¶ä¸æ¯ä¸ªå®¹å¨ç»ä»¶æä¸ä¸ª basicvalveï¼åºç¡éï¼ãwrapper ä½ä¸ºä¸ä¸ªå®¹å¨ç»ä»¶ï¼å®ä¹æèªå·±ç pipeline å basicvalveï¼wrapper ç basicvalve å« standardwrappervalveã\n\nä½ å¯ä»¥æ³å°ï¼å½è¯·æ±å°æ¥æ¶ï¼context å®¹å¨ç basicvalve ä¼è°ç¨ wrapper å®¹å¨ä¸­ pipeline ä¸­çç¬¬ä¸ä¸ª valveï¼ç¶åä¼è°ç¨å° standardwrappervalveãæä»¬åæ¥ççå®ç invoke æ¹æ³æ¯å¦ä½å®ç°çï¼åæ ·ä¸ºäºæ¹ä¾¿ä½ éè¯»ï¼æç®åäºä»£ç ï¼\n\npublic final void invoke(request request, response response) {\n\n    //1. å®ä¾å servlet\n    servlet = wrapper.allocate();\n\n    //2. ç»å½åè¯·æ±åå»ºä¸ä¸ª filter é¾\n    applicationfilterchain filterchain =\n        applicationfilterfactory.createfilterchain(request, wrapper, servlet);\n\n   //3. è°ç¨è¿ä¸ª filter é¾ï¼filter é¾ä¸­çæåä¸ä¸ª filter ä¼è°ç¨ servlet\n   filterchain.dofilter(request.getrequest(), response.getresponse());\n\n}\n\n\nstandardwrappervalve ç invoke æ¹æ³æ¯è¾å¤æï¼å»æå¶ä»å¼å¸¸å¤ççä¸äºç»èï¼æ¬è´¨ä¸å°±æ¯ä¸æ­¥ï¼\n\n * ç¬¬ä¸æ­¥ï¼åå»º servlet å®ä¾ï¼\n * ç¬¬äºæ­¥ï¼ç»å½åè¯·æ±åå»ºä¸ä¸ª filter é¾ï¼\n * ç¬¬ä¸æ­¥ï¼è°ç¨è¿ä¸ª filter é¾ã\n\nä½ å¯è½ä¼é®ï¼ä¸ºä»ä¹éè¦ç»æ¯ä¸ªè¯·æ±åå»ºä¸ä¸ª filter é¾ï¼è¿æ¯å ä¸ºæ¯ä¸ªè¯·æ±çè¯·æ±è·¯å¾é½ä¸ä¸æ ·ï¼è filter é½æç¸åºçè·¯å¾æ å°ï¼å æ­¤ä¸æ¯ææç filter é½éè¦æ¥å¤çå½åçè¯·æ±ï¼æä»¬éè¦æ ¹æ®è¯·æ±çè·¯å¾æ¥éæ©ç¹å®çä¸äº filter æ¥å¤çã\n\nç¬¬äºä¸ªé®é¢æ¯ï¼ä¸ºä»ä¹æ²¡æçå°è°å° servlet ç service æ¹æ³ï¼è¿æ¯å ä¸º filter é¾ç dofilter æ¹æ³ä¼è´è´£è°ç¨ servletï¼å·ä½æ¥è¯´å°±æ¯ filter é¾ä¸­çæåä¸ä¸ª filter ä¼è´è´£è°ç¨ servletã\n\næ¥ä¸æ¥æä»¬æ¥ç filter çå®ç°åçã\n\n\n# filter ç®¡ç\n\næä»¬ç¥éï¼è· servlet ä¸æ ·ï¼filter ä¹å¯ä»¥å¨web.xmlæä»¶éè¿è¡éç½®ï¼ä¸åçæ¯ï¼filter çä½ç¨åæ¯æ´ä¸ª web åºç¨ï¼å æ­¤ filter çå®ä¾æ¯å¨ context å®¹å¨ä¸­è¿è¡ç®¡ççï¼context å®¹å¨ç¨ map éåæ¥ä¿å­ filterã\n\nprivate map<string, filterdef> filterdefs = new hashmap<>();\n\n\né£ä¸é¢æå°ç filter é¾åæ¯ä»ä¹å¢ï¼filter é¾çå­æ´»æå¾ç­ï¼å®æ¯è·æ¯ä¸ªè¯·æ±å¯¹åºçãä¸ä¸ªæ°çè¯·æ±æ¥äºï¼å°±å¨æåå»ºä¸ä¸ª filter é¾ï¼è¯·æ±å¤çå®äºï¼filter é¾ä¹å°±è¢«åæ¶äºãçè§£å®çåçä¹éå¸¸å³é®ï¼æä»¬è¿æ¯æ¥ççæºç ï¼\n\npublic final class applicationfilterchain implements filterchain {\n\n  //filter é¾ä¸­æ filter æ°ç»ï¼è¿ä¸ªå¥½çè§£\n  private applicationfilterconfig[] filters = new applicationfilterconfig[0];\n\n  //filter é¾ä¸­çå½åçè°ç¨ä½ç½®\n  private int pos = 0;\n\n  // æ»å±æå¤å°äº filter\n  private int n = 0;\n\n  // æ¯ä¸ª filter é¾å¯¹åºä¸ä¸ª servletï¼ä¹å°±æ¯å®è¦è°ç¨ç servlet\n  private servlet servlet = null;\n\n  public void dofilter(servletrequest req, servletresponse res) {\n        internaldofilter(request,response);\n  }\n\n  private void internaldofilter(servletrequest req,\n                                servletresponse res){\n\n    // æ¯ä¸ª filter é¾å¨åé¨ç»´æ¤äºä¸ä¸ª filter æ°ç»\n    if (pos < n) {\n        applicationfilterconfig filterconfig = filters[pos++];\n        filter filter = filterconfig.getfilter();\n\n        filter.dofilter(request, response, this);\n        return;\n    }\n\n    servlet.service(request, response);\n\n}\n\n\nä» applicationfilterchain çæºç æä»¬å¯ä»¥çå°å ä¸ªå³é®ä¿¡æ¯ï¼\n\n * filter é¾ä¸­é¤äºæ filter å¯¹è±¡çæ°ç»ï¼è¿æä¸ä¸ªæ´æ°åé posï¼è¿ä¸ªåéç¨æ¥è®°å½å½åè¢«è°ç¨ç filter å¨æ°ç»ä¸­çä½ç½®ã\n * filter é¾ä¸­æä¸ª servlet å®ä¾ï¼è¿ä¸ªå¥½çè§£ï¼å ä¸ºä¸é¢æå°äºï¼æ¯ä¸ª filter é¾æåé½ä¼è°å°ä¸ä¸ª servletã\n * filter é¾æ¬èº«ä¹å®ç°äº dofilter æ¹æ³ï¼ç´æ¥è°ç¨äºä¸ä¸ªåé¨æ¹æ³ internaldofilterã\n * internaldofilter æ¹æ³çå®ç°æ¯è¾æææï¼å®åäºä¸ä¸ªå¤æ­ï¼å¦æå½å filter çä½ç½®å°äº filter æ°ç»çé¿åº¦ï¼ä¹å°±æ¯è¯´ filter è¿æ²¡è°å®ï¼å°±ä» filter æ°ç»æ¿ä¸ä¸ä¸ª filterï¼è°ç¨å®ç dofilter æ¹æ³ãå¦åï¼æå³çææ filter é½è°å°äºï¼å°±è°ç¨ servlet ç service æ¹æ³ã\n\nä½é®é¢æ¯ï¼æ¹æ³ä½éæ²¡çå°å¾ªç¯ï¼è°å¨ä¸åå°è°ç¨ filter é¾ç dofilter æ¹æ³å¢ï¼filter æ¯æä¹ä¾æ¬¡è°å°çå¢ï¼\n\nç­æ¡æ¯filter æ¬èº«ç dofilter æ¹æ³ä¼è°ç¨ filter é¾ç dofilter æ¹æ³ï¼æä»¬è¿æ¯æ¥ççä»£ç å°±æç½äºï¼\n\npublic void dofilter(servletrequest request, servletresponse response,\n        filterchain chain){\n\n          ...\n\n          // è°ç¨ filter çæ¹æ³\n          chain.dofilter(request, response);\n\n      }\n\n\næ³¨æ filter ç dofilter æ¹æ³æä¸ªå³é®åæ° filterchainï¼å°±æ¯ filter é¾ãå¹¶ä¸æ¯ä¸ª filter å¨å®ç° dofilter æ¶ï¼å¿é¡»è¦è°ç¨ filter é¾ç dofilter æ¹æ³ï¼è filter é¾ä¸­ä¿å­å½å filter çä½ç½®ï¼ä¼è°ç¨ä¸ä¸ä¸ª filter ç dofilter æ¹æ³ï¼è¿æ ·é¾å¼è°ç¨å°±å®æäºã\n\nfilter é¾è· tomcat ç pipeline-valve æ¬è´¨é½æ¯è´£ä»»é¾æ¨¡å¼ï¼ä½æ¯å¨å·ä½å®ç°ä¸ç¨æä¸åï¼ä½ å¯ä»¥ç»ç»ä½ä¼ä¸ä¸ã\n\n\n# listener ç®¡ç\n\næä»¬æ¥çè servlet è§èé listenerãè· filter ä¸æ ·ï¼listener ä¹æ¯ä¸ç§æ©å±æºå¶ï¼ä½ å¯ä»¥çå¬å®¹å¨åé¨åççäºä»¶ï¼ä¸»è¦æä¸¤ç±»äºä»¶ï¼\n\n * ç¬¬ä¸ç±»æ¯çå½ç¶æçååï¼æ¯å¦ context å®¹å¨å¯å¨ååæ­¢ãsession çåå»ºåéæ¯ã\n * ç¬¬äºç±»æ¯å±æ§çååï¼æ¯å¦ context å®¹å¨æä¸ªå±æ§å¼åäºãsession çæä¸ªå±æ§å¼åäºä»¥åæ°çè¯·æ±æ¥äºç­ã\n\næä»¬å¯ä»¥å¨web.xmléç½®æèéè¿æ³¨è§£çæ¹å¼æ¥æ·»å çå¬å¨ï¼å¨çå¬å¨éå®ç°æä»¬çä¸å¡é»è¾ãå¯¹äº tomcat æ¥è¯´ï¼å®éè¦è¯»åéç½®æä»¶ï¼æ¿å°çå¬å¨ç±»çåå­ï¼å®ä¾åè¿äºç±»ï¼å¹¶ä¸å¨åéçæ¶æºè°ç¨è¿äºçå¬å¨çæ¹æ³ã\n\ntomcat æ¯éè¿ context å®¹å¨æ¥ç®¡çè¿äºçå¬å¨çãcontext å®¹å¨å°ä¸¤ç±»äºä»¶åå¼æ¥ç®¡çï¼åå«ç¨ä¸åçéåæ¥å­æ¾ä¸åç±»åäºä»¶ççå¬å¨ï¼\n\n// çå¬å±æ§å¼ååççå¬å¨\nprivate list<object> applicationeventlistenerslist = new copyonwritearraylist<>();\n\n// çå¬çå½äºä»¶ççå¬å¨\nprivate object applicationlifecyclelistenersobjects[] = new object[0];\n\n\nå©ä¸çäºæå°±æ¯è§¦åçå¬å¨äºï¼æ¯å¦å¨ context å®¹å¨çå¯å¨æ¹æ³éï¼å°±è§¦åäºææç servletcontextlistenerï¼\n\n//1. æ¿å°ææççå½å¨æçå¬å¨\nobject instances[] = getapplicationlifecyclelisteners();\n\nfor (int i = 0; i < instances.length; i++) {\n   //2. å¤æ­ listener çç±»åæ¯ä¸æ¯ servletcontextlistener\n   if (!(instances[i] instanceof servletcontextlistener))\n      continue;\n\n   //3. è§¦å listener çæ¹æ³\n   servletcontextlistener lr = (servletcontextlistener) instances[i];\n   lr.contextinitialized(event);\n}\n\n\néè¦æ³¨æçæ¯ï¼è¿éç servletcontextlistener æ¥å£æ¯ä¸ç§çç»ç¨æ·çæ©å±æºå¶ï¼ç¨æ·å¯ä»¥å®ç°è¿ä¸ªæ¥å£æ¥å®ä¹èªå·±ççå¬å¨ï¼çå¬ context å®¹å¨çå¯åäºä»¶ãspring å°±æ¯è¿ä¹åçãservletcontextlistener è· tomcat èªå·±ççå½å¨æäºä»¶ lifecyclelistener æ¯ä¸åçãlifecyclelistener å®ä¹å¨çå½å¨æç®¡çç»ä»¶ä¸­ï¼ç±åºç±» lifecyclebase ç»ä¸ç®¡çã\n\n\n# tomcat æ¯æå¼æ­¥ servlet\n\n\n# å¼æ­¥ç¤ºä¾\n\n@webservlet(urlpatterns = {"/async"}, asyncsupported = true)\npublic class asyncservlet extends httpservlet {\n\n    //web åºç¨çº¿ç¨æ± ï¼ç¨æ¥å¤çå¼æ­¥ servlet\n    executorservice executor = executors.newsinglethreadexecutor();\n\n    public void service(httpservletrequest req, httpservletresponse resp) {\n        //1. è°ç¨ startasync æèå¼æ­¥ä¸ä¸æ\n        final asynccontext ctx = req.startasync();\n\n       // ç¨çº¿ç¨æ± æ¥æ§è¡èæ¶æä½\n        executor.execute(new runnable() {\n\n            @override\n            public void run() {\n\n                // å¨è¿éåèæ¶çæä½\n                try {\n                    ctx.getresponse().getwriter().println("handling async servlet");\n                } catch (ioexception e) {}\n\n                //3. å¼æ­¥ servlet å¤çå®äºè°ç¨å¼æ­¥ä¸ä¸æç complete æ¹æ³\n                ctx.complete();\n            }\n\n        });\n    }\n}\n\n\næä¸ä¸ªè¦ç¹ï¼\n\n 1. éè¿æ³¨è§£çæ¹å¼æ¥æ³¨å servletï¼é¤äº @webservlet æ³¨è§£ï¼è¿éè¦å ä¸ asyncsupported=true çå±æ§ï¼è¡¨æå½åç servlet æ¯ä¸ä¸ªå¼æ­¥ servletã\n 2. web åºç¨ç¨åºéè¦è°ç¨ request å¯¹è±¡ç startasync æ¹æ³æ¥æ¿å°ä¸ä¸ªå¼æ­¥ä¸ä¸æ asynccontextãè¿ä¸ªä¸ä¸æä¿å­äºè¯·æ±åååºå¯¹è±¡ã\n 3. web åºç¨éè¦å¼å¯ä¸ä¸ªæ°çº¿ç¨æ¥å¤çèæ¶çæä½ï¼å¤çå®æåéè¦è°ç¨ asynccontext ç complete æ¹æ³ãç®çæ¯åè¯ tomcatï¼è¯·æ±å·²ç»å¤çå®æã\n\nè¿éè¯·ä½ æ³¨æï¼è½ç¶å¼æ­¥ servlet åè®¸ç¨æ´é¿çæ¶é´æ¥å¤çè¯·æ±ï¼ä½æ¯ä¹æè¶æ¶éå¶çï¼é»è®¤æ¯ 30 ç§ï¼å¦æ 30 ç§åè¯·æ±è¿æ²¡å¤çå®ï¼tomcat ä¼è§¦åè¶æ¶æºå¶ï¼åæµè§å¨è¿åè¶æ¶éè¯¯ï¼å¦æè¿ä¸ªæ¶åä½ ç web åºç¨åè°ç¨ctx.completeæ¹æ³ï¼ä¼å¾å°ä¸ä¸ª illegalstateexception å¼å¸¸ã\n\n\n# å¼æ­¥ servlet åç\n\néè¿ä¸é¢çä¾å­ï¼ç¸ä¿¡ä½ å¯¹ servlet çå¼æ­¥å®ç°æäºåºæ¬ççè§£ãè¦çè§£ tomcat å¨è¿ä¸ªè¿ç¨é½åäºä»ä¹äºæï¼å³é®å°±æ¯è¦å¼æ¸æ¥req.startasyncæ¹æ³åctx.completeæ¹æ³é½åäºä»ä¹ã\n\n# startasync æ¹æ³\n\nstartasync æ¹æ³å¶å®å°±æ¯åå»ºäºä¸ä¸ªå¼æ­¥ä¸ä¸æ asynccontext å¯¹è±¡ï¼asynccontext å¯¹è±¡çä½ç¨æ¯ä¿å­è¯·æ±çä¸­é´ä¿¡æ¯ï¼æ¯å¦ request å response å¯¹è±¡ç­ä¸ä¸æä¿¡æ¯ãä½ æ¥æèä¸ä¸ä¸ºä»ä¹éè¦ä¿å­è¿äºä¿¡æ¯å¢ï¼\n\nè¿æ¯å ä¸º tomcat çå·¥ä½çº¿ç¨å¨request.startasyncè°ç¨ä¹åï¼å°±ç´æ¥ç»æåå°çº¿ç¨æ± ä¸­äºï¼çº¿ç¨æ¬èº«ä¸ä¼ä¿å­ä»»ä½ä¿¡æ¯ãä¹å°±æ¯è¯´ä¸ä¸ªè¯·æ±å°æå¡ç«¯ï¼æ§è¡å°ä¸åï¼ä½ ç web åºç¨æ­£å¨å¤çï¼è¿ä¸ªæ¶å tomcat çå·¥ä½çº¿ç¨æ²¡äºï¼è¿å°±éè¦æä¸ªç¼å­è½å¤ä¿å­åå§ç request å response å¯¹è±¡ï¼èè¿ä¸ªç¼å­å°±æ¯ asynccontextã\n\næäº asynccontextï¼ä½ ç web åºç¨éè¿å®æ¿å° request å response å¯¹è±¡ï¼æ¿å° request å¯¹è±¡åå°±å¯ä»¥è¯»åè¯·æ±ä¿¡æ¯ï¼è¯·æ±å¤çå®äºè¿éè¦éè¿ response å¯¹è±¡å° http ååºåéç»æµè§å¨ã\n\né¤äºåå»º asynccontext å¯¹è±¡ï¼startasync è¿éè¦å®æä¸ä¸ªå³é®ä»»å¡ï¼é£å°±æ¯åè¯ tomcat å½åç servlet å¤çæ¹æ³è¿åæ¶ï¼ä¸è¦æååºåå°æµè§å¨ï¼å ä¸ºè¿ä¸ªæ¶åï¼ååºè¿æ²¡çæå¢ï¼å¹¶ä¸ä¸è½æ request å¯¹è±¡å response å¯¹è±¡éæ¯ï¼å ä¸ºåé¢ web åºç¨è¿è¦ç¨å¢ã\n\nå¨ tomcat ä¸­ï¼è´è´£ flush ååºæ°æ®çæ¯ coyoteadaptorï¼å®è¿ä¼éæ¯ request å¯¹è±¡å response å¯¹è±¡ï¼å æ­¤éè¦éè¿æç§æºå¶éç¥ coyoteadaptorï¼å·ä½æ¥è¯´æ¯éè¿ä¸é¢è¿è¡ä»£ç ï¼\n\nthis.request.getcoyoterequest().action(actioncode.async_start, this);\n\n\nä½ å¯ä»¥æå®çè§£ä¸ºä¸ä¸ª callbackï¼å¨è¿ä¸ª action æ¹æ³éè®¾ç½®äº request å¯¹è±¡çç¶æï¼è®¾ç½®å®ä¸ºä¸ä¸ªå¼æ­¥ servlet è¯·æ±ã\n\næä»¬ç¥éè¿æ¥å¨æ¯è°ç¨ coyoteadapter ç service æ¹æ³æ¥å¤çè¯·æ±çï¼è coyoteadapter ä¼è°ç¨å®¹å¨ç service æ¹æ³ï¼å½å®¹å¨ç service æ¹æ³è¿åæ¶ï¼coyoteadapter å¤æ­å½åçè¯·æ±æ¯ä¸æ¯å¼æ­¥ servlet è¯·æ±ï¼å¦ææ¯ï¼å°±ä¸ä¼éæ¯ request å response å¯¹è±¡ï¼ä¹ä¸ä¼æååºä¿¡æ¯åå°æµè§å¨ãä½ å¯ä»¥éè¿ä¸é¢çä»£ç çè§£ä¸ä¸ï¼è¿æ¯ coyoteadapter ç service æ¹æ³ï¼æå¯¹å®è¿è¡äºç®åï¼\n\npublic void service(org.apache.coyote.request req, org.apache.coyote.response res) {\n\n   // è°ç¨å®¹å¨ç service æ¹æ³å¤çè¯·æ±\n    connector.getservice().getcontainer().getpipeline().\n           getfirst().invoke(request, response);\n\n   // å¦ææ¯å¼æ­¥ servlet è¯·æ±ï¼ä»ä»è®¾ç½®ä¸ä¸ªæ å¿ï¼\n   // å¦åè¯´ææ¯åæ­¥ servlet è¯·æ±ï¼å°±å°ååºæ°æ®å·å°æµè§å¨\n    if (request.isasync()) {\n        async = true;\n    } else {\n        request.finishrequest();\n        response.finishresponse();\n    }\n\n   // å¦æä¸æ¯å¼æ­¥ servlet è¯·æ±ï¼å°±éæ¯ request å¯¹è±¡å response å¯¹è±¡\n    if (!async) {\n        request.recycle();\n        response.recycle();\n    }\n}\n\n\næ¥ä¸æ¥ï¼å½ coyoteadaptor ç service æ¹æ³è¿åå° protocolhandler ç»ä»¶æ¶ï¼protocolhandler å¤æ­è¿åå¼ï¼å¦æå½åè¯·æ±æ¯ä¸ä¸ªå¼æ­¥ servlet è¯·æ±ï¼å®ä¼æå½å socket çåè®®å¤çè processor ç¼å­èµ·æ¥ï¼å° socketwrapper å¯¹è±¡åç¸åºç processor å­å°ä¸ä¸ª map æ°æ®ç»æéã\n\nprivate final map<s,processor> connections = new concurrenthashmap<>();\n\n\nä¹æä»¥è¦ç¼å­æ¯å ä¸ºè¿ä¸ªè¯·æ±æ¥ä¸æ¥è¿è¦æ¥çå¤çï¼è¿æ¯ç±åæ¥ç processor æ¥å¤çï¼éè¿ socketwrapper å°±è½ä» map éæ¾å°ç¸åºç processorã\n\n# complete æ¹æ³\n\næ¥çæä»¬åæ¥çå³é®çctx.completeæ¹æ³ï¼å½è¯·æ±å¤çå®ææ¶ï¼web åºç¨è°ç¨è¿ä¸ªæ¹æ³ãé£ä¹è¿ä¸ªæ¹æ³åäºäºä»ä¹äºæå¢ï¼æéè¦çå°±æ¯æååºæ°æ®åéå°æµè§å¨ã\n\nè¿ä»¶äºæä¸è½ç± web åºç¨çº¿ç¨æ¥åï¼ä¹å°±æ¯è¯´ctx.completeæ¹æ³ä¸è½ç´æ¥æååºæ°æ®åéå°æµè§å¨ï¼å ä¸ºè¿ä»¶äºæåºè¯¥ç± tomcat çº¿ç¨æ¥åï¼ä½å·ä½æä¹åå¢ï¼\n\næä»¬ç¥éï¼è¿æ¥å¨ä¸­ç endpoint ç»ä»¶æ£æµå°æè¯·æ±æ°æ®è¾¾å°æ¶ï¼ä¼åå»ºä¸ä¸ª socketprocessor å¯¹è±¡äº¤ç»çº¿ç¨æ± å»å¤çï¼å æ­¤ endpoint çéä¿¡å¤çåå·ä½è¯·æ±å¤çå¨ä¸¤ä¸ªçº¿ç¨éè¿è¡ã\n\nå¨å¼æ­¥ servlet çåºæ¯éï¼web åºç¨éè¿è°ç¨ctx.completeæ¹æ³æ¶ï¼ä¹å¯ä»¥çæä¸ä¸ªæ°ç socketprocessor ä»»å¡ç±»ï¼äº¤ç»çº¿ç¨æ± å¤çãå¯¹äºå¼æ­¥ servlet è¯·æ±æ¥è¯´ï¼ç¸åºç socket ååè®®å¤çç»ä»¶ processor é½è¢«ç¼å­èµ·æ¥äºï¼å¹¶ä¸è¿äºå¯¹è±¡é½å¯ä»¥éè¿ request å¯¹è±¡æ¿å°ã\n\nè®²å°è¿éï¼ä½ å¯è½å·²ç»çå°ctx.completeæ¯å¦ä½å®ç°çäºï¼\n\npublic void complete() {\n    // æ£æ¥ç¶æåæ³æ§ï¼æä»¬åå¿½ç¥è¿å¥\n    check();\n\n    // è°ç¨ request å¯¹è±¡ç action æ¹æ³ï¼å¶å®å°±æ¯éç¥è¿æ¥å¨ï¼è¿ä¸ªå¼æ­¥è¯·æ±å¤çå®äº\nrequest.getcoyoterequest().action(actioncode.async_complete, null);\n\n}\n\n\næä»¬å¯ä»¥çå° complete æ¹æ³è°ç¨äº request å¯¹è±¡ç action æ¹æ³ãèå¨ action æ¹æ³éï¼åæ¯è°ç¨äº processor ç processsocketevent æ¹æ³ï¼å¹¶ä¸ä¼ å¥äºæä½ç  open_readã\n\ncase async_complete: {\n    cleardispatches();\n    if (asyncstatemachine.asynccomplete()) {\n        processsocketevent(socketevent.open_read, true);\n    }\n    break;\n}\n\n\næä»¬æ¥çç processsocketevent æ¹æ³ï¼å®è°ç¨ socketwrapper ç processsocket æ¹æ³ï¼\n\nprotected void processsocketevent(socketevent event, boolean dispatch) {\n    socketwrapperbase<?> socketwrapper = getsocketwrapper();\n    if (socketwrapper != null) {\n        socketwrapper.processsocket(event, dispatch);\n    }\n}\n\n\nè socketwrapper ç processsocket æ¹æ³ä¼åå»º socketprocessor ä»»å¡ç±»ï¼å¹¶éè¿ tomcat çº¿ç¨æ± æ¥å¤çï¼\n\npublic boolean processsocket(socketwrapperbase<s> socketwrapper,\n        socketevent event, boolean dispatch) {\n\n      if (socketwrapper == null) {\n          return false;\n      }\n\n      socketprocessorbase<s> sc = processorcache.pop();\n      if (sc == null) {\n          sc = createsocketprocessor(socketwrapper, event);\n      } else {\n          sc.reset(socketwrapper, event);\n      }\n      // çº¿ç¨æ± è¿è¡\n      executor executor = getexecutor();\n      if (dispatch && executor != null) {\n          executor.execute(sc);\n      } else {\n          sc.run();\n      }\n}\n\n\nè¯·ä½ æ³¨æ createsocketprocessor å½æ°çç¬¬äºä¸ªåæ°æ¯ socketeventï¼è¿éæä»¬ä¼ å¥çæ¯ open_readãéè¿è¿ä¸ªåæ°ï¼æä»¬å°±è½æ§å¶ socketprocessor çè¡ä¸ºï¼å ä¸ºæä»¬ä¸éè¦åæè¯·æ±åéå°å®¹å¨è¿è¡å¤çï¼åªéè¦åæµè§å¨ç«¯åéæ°æ®ï¼å¹¶ä¸éæ°å¨è¿ä¸ª socket ä¸çå¬æ°çè¯·æ±å°±è¡äºã\n\n\n# åèèµæ\n\n * å®æ¹\n   * tomcat å®æ¹ç½ç«\n   * tomcat wiki\n   * tomee å®æ¹ç½ç«\n * æç¨\n   * æ·±å¥æè§£ tomcat & jetty',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Tomcatä¼å",frontmatter:{title:"Tomcatä¼å",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Tomcat"],abbrlink:"c37025e9",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/6c22f4/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/01.Tomcat/04.Tomcat%E4%BC%98%E5%8C%96.html",relativePath:"02.JavaEE/02.æå¡å¨/01.Tomcat/04.Tomcatä¼å.md",key:"v-2626d1fc",path:"/pages/6c22f4/",headers:[{level:2,title:"Tomcat å¯å¨ä¼å",slug:"tomcat-å¯å¨ä¼å",normalizedTitle:"tomcat å¯å¨ä¼å",charIndex:16},{level:3,title:"æ¸ç Tomcat",slug:"æ¸ç-tomcat",normalizedTitle:"æ¸ç tomcat",charIndex:59},{level:3,title:"ç¦æ­¢ Tomcat TLD æ«æ",slug:"ç¦æ­¢-tomcat-tld-æ«æ",normalizedTitle:"ç¦æ­¢ tomcat tld æ«æ",charIndex:595},{level:3,title:"å³é­ WebSocket æ¯æ",slug:"å³é­-websocket-æ¯æ",normalizedTitle:"å³é­ websocket æ¯æ",charIndex:1673},{level:3,title:"å³é­ JSP æ¯æ",slug:"å³é­-jsp-æ¯æ",normalizedTitle:"å³é­ jsp æ¯æ",charIndex:2063},{level:3,title:"ç¦æ­¢æ«æ Servlet æ³¨è§£",slug:"ç¦æ­¢æ«æ-servlet-æ³¨è§£",normalizedTitle:"ç¦æ­¢æ«æ servlet æ³¨è§£",charIndex:2363},{level:3,title:"éç½® Web-Fragment æ«æ",slug:"éç½®-web-fragment-æ«æ",normalizedTitle:"éç½® web-fragment æ«æ",charIndex:2699},{level:3,title:"éæºæ°çµæºä¼å",slug:"éæºæ°çµæºä¼å",normalizedTitle:"éæºæ°çµæºä¼å",charIndex:3113},{level:3,title:"å¹¶è¡å¯å¨å¤ä¸ª Web åºç¨",slug:"å¹¶è¡å¯å¨å¤ä¸ª-web-åºç¨",normalizedTitle:"å¹¶è¡å¯å¨å¤ä¸ª web åºç¨",charIndex:3812},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:4273}],headersStr:"Tomcat å¯å¨ä¼å æ¸ç Tomcat ç¦æ­¢ Tomcat TLD æ«æ å³é­ WebSocket æ¯æ å³é­ JSP æ¯æ ç¦æ­¢æ«æ Servlet æ³¨è§£ éç½® Web-Fragment æ«æ éæºæ°çµæºä¼å å¹¶è¡å¯å¨å¤ä¸ª Web åºç¨ åèèµæ",content:'# Tomcat ä¼å\n\n\n# Tomcat å¯å¨ä¼å\n\nå¦æ Tomcat å¯å¨æ¯è¾æ¢ï¼å¯ä»¥èèä¸äºä¼åç¹\n\n\n# æ¸ç Tomcat\n\n * æ¸çä¸å¿è¦ç Web åºç¨ï¼é¦åæä»¬è¦åçæ¯å é¤æ webapps æä»¶å¤¹ä¸ä¸éè¦çå·¥ç¨ï¼ä¸è¬æ¯ host-managerãexampleãdoc ç­è¿äºé»è®¤çå·¥ç¨ï¼å¯è½è¿æä»¥åæ·»å çä½ç°å¨ç¨ä¸ççå·¥ç¨ï¼æå¥½æè¿äºå¨é½å é¤æã\n * æ¸ç XML éç½®æä»¶ï¼Tomcat å¨å¯å¨æ¶ä¼è§£æææç XML éç½®æä»¶ï¼è§£æ XML è¾ä¸ºèæ¶ï¼æä»¥åºè¯¥å°½éä¿æéç½®æä»¶çç®æ´ã\n * æ¸ç JAR æä»¶ï¼JVM çç±»å è½½å¨å¨å è½½ç±»æ¶ï¼éè¦æ¥æ¾æ¯ä¸ä¸ª JAR æä»¶ï¼å»æ¾å°æéè¦çç±»ãå¦æå é¤äºä¸éè¦ç JAR æä»¶ï¼æ¥æ¾çéåº¦å°±ä¼å¿«ä¸äºãè¿éè¯·æ³¨æï¼Web åºç¨ä¸­ç lib ç®å½ä¸ä¸åºè¯¥åºç° Servlet API æè Tomcat èªèº«ç JARï¼è¿äº JAR ç± Tomcat è´è´£æä¾ã\n * æ¸çå¶ä»æä»¶ï¼åæ¶æ¸çæ¥å¿ï¼å é¤ logs æä»¶å¤¹ä¸ä¸éè¦çæ¥å¿æä»¶ãåæ ·è¿æ work æä»¶å¤¹ä¸ç catalina æä»¶å¤¹ï¼å®å¶å®æ¯ Tomcat æ JSP è½¬æ¢ä¸º Class æä»¶çå·¥ä½ç®å½ãææ¶åæä»¬ä¹è®¸ä¼éå°ä¿®æ¹äºä»£ç ï¼éå¯äº Tomcatï¼ä½æ¯ä»æ²¡ææï¼è¿æ¶åä¾¿å¯ä»¥å é¤æè¿ä¸ªæä»¶å¤¹ï¼Tomcat ä¸æ¬¡å¯å¨çæ¶åä¼éæ°çæã\n\n\n# ç¦æ­¢ Tomcat TLD æ«æ\n\nTomcat ä¸ºäºæ¯æ JSPï¼å¨åºç¨å¯å¨çæ¶åä¼æ«æ JAR åéé¢ç TLD æä»¶ï¼å è½½éé¢å®ä¹çæ ç­¾åºãæä»¥å¨ Tomcat çå¯å¨æ¥å¿éï¼ä½ å¯è½ä¼ç¢°å°è¿ç§æç¤ºï¼\n\n> At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.\n\nTomcat çæææ¯ï¼ææ«æäºä½  Web åºç¨ä¸ç JAR åï¼åç° JAR åéæ²¡æ TLD æä»¶ãæå»ºè®®éç½®ä¸ä¸ Tomcat ä¸è¦å»æ«æè¿äº JAR åï¼è¿æ ·å¯ä»¥æé« Tomcat çå¯å¨éåº¦ï¼å¹¶èç JSP ç¼è¯æ¶é´ã\n\nå¦ä½éç½®ä¸å»æ«æè¿äº JAR åå¢ï¼è¿éåä¸¤ç§æåµï¼\n\n * å¦æä½ çé¡¹ç®æ²¡æä½¿ç¨ JSP ä½ä¸º Web é¡µé¢æ¨¡æ¿ï¼èæ¯ä½¿ç¨ Velocity ä¹ç±»çæ¨¡æ¿å¼æï¼ä½ å®å¨å¯ä»¥æ TLD æ«æç¦æ­¢æãæ¹æ³æ¯ï¼æ¾å° Tomcat çconf/ç®å½ä¸çcontext.xmlæä»¶ï¼å¨è¿ä¸ªæä»¶é Context æ ç­¾ä¸ï¼å ä¸JarScanneråJarScanFilterå­æ ç­¾ï¼åä¸é¢è¿æ ·ã\n   \n   <Context>\n      <JarScanner >\n         <JarScanFilter defaultTldScan="true" defaultpluggabilityScan="true" />\n      </JarScanner>\n   </Context>\n   \n\n * å¦æä½ çé¡¹ç®ä½¿ç¨äº JSP ä½ä¸º Web é¡µé¢æ¨¡åï¼æå³ç TLD æ«ææ æ³é¿åï¼ä½æ¯æä»¬å¯ä»¥éè¿éç½®æ¥åè¯ Tomcatï¼åªæ«æé£äºåå« TLD æä»¶ç JAR åãæ¹æ³æ¯ï¼æ¾å° Tomcat çconf/ç®å½ä¸çcatalina.propertiesæä»¶ï¼å¨è¿ä¸ªæä»¶éç jarsToSkip éç½®é¡¹ä¸­ï¼å ä¸ä½ ç JAR åã\n   \n   tomcat.util.scan.StandardJarScanFilter.jarsToSkip=xxx.jar\n   \n\n\n# å³é­ WebSocket æ¯æ\n\nTomcat ä¼æ«æ WebSocket æ³¨è§£ç API å®ç°ï¼æ¯å¦ @ServerEndpoint æ³¨è§£çç±»ãå¦æä¸éè¦ä½¿ç¨ WebSockets å°±å¯ä»¥å³é­å®ãå·ä½æ¹æ³æ¯ï¼æ¾å° Tomcat ç conf/ ç®å½ä¸ç context.xml æä»¶ï¼ç» Context æ ç­¾å ä¸ä¸ª containerSciFilter çå±æ§ï¼\n\n<Context containerSciFilter="org.apache.tomcat.websocket.server.WsSci">\n...\n</Context>\n\n\næ´è¿ä¸æ­¥ï¼å¦æä½ ä¸éè¦ WebSockets è¿ä¸ªåè½ï¼ä½ å¯ä»¥æ Tomcat lib ç®å½ä¸ç websocket-api.jar å tomcat-websocket.jar è¿ä¸¤ä¸ª JAR æä»¶å é¤æï¼è¿ä¸æ­¥æé«æ§è½ã\n\n\n# å³é­ JSP æ¯æ\n\nå¦æä¸éè¦ä½¿ç¨ JSPï¼å¯ä»¥å³é­ JSP åè½ï¼\n\n<Context containerSciFilter="org.apache.jasper.servlet.JasperInitializer">\n...\n</Context>\n\n\nå¦æè¦åæ¶å³é­ WebSocket å Jspï¼å¯ä»¥è¿æ ·éç½®ï¼\n\n<Context containerSciFilter="org.apache.tomcat.websocket.server.WsSci | org.apache.jasper.servlet.JasperInitializer">\n...\n</Context>\n\n\n\n# ç¦æ­¢æ«æ Servlet æ³¨è§£\n\nServlet 3.0 å¼å¥äºæ³¨è§£ Servletï¼Tomcat ä¸ºäºæ¯æè¿ä¸ªç¹æ§ï¼ä¼å¨ Web åºç¨å¯å¨æ¶æ«æä½ çç±»æä»¶ï¼å æ­¤å¦æä½ æ²¡æä½¿ç¨ Servlet æ³¨è§£è¿ä¸ªåè½ï¼å¯ä»¥åè¯ Tomcat ä¸è¦å»æ«æ Servlet æ³¨è§£ãå·ä½éç½®æ¹æ³æ¯ï¼å¨ä½ ç Web åºç¨çweb.xmlæä»¶ä¸­ï¼è®¾ç½®<web-app>åç´ çå±æ§metadata-complete="true"ï¼åä¸é¢è¿æ ·ã\n\n<web-app metadata-complete="true">\n</web-app>\n\n\nmetadata-complete çæææ¯ï¼web.xml ééç½®ç Servlet æ¯å®æ´çï¼ä¸éè¦åå»åºç±»ä¸­æ¾ Servlet çå®ä¹ã\n\n\n# éç½® Web-Fragment æ«æ\n\nServlet 3.0 è¿å¼å¥äºâWeb æ¨¡åé¨ç½²æè¿°ç¬¦çæ®µâç web-fragment.xmlï¼è¿æ¯ä¸ä¸ªé¨ç½²æè¿°æä»¶ï¼å¯ä»¥å®æ web.xml çéç½®åè½ãèè¿ä¸ª web-fragment.xml æä»¶å¿é¡»å­æ¾å¨ JAR æä»¶ç META-INF ç®å½ä¸ï¼è JAR åéå¸¸æ¾å¨ WEB-INF/lib ç®å½ä¸ï¼å æ­¤ Tomcat éè¦å¯¹ JAR æä»¶è¿è¡æ«ææè½æ¯æè¿ä¸ªåè½ã\n\nå¯ä»¥éè¿éç½® web.xml éé¢ç <absolute-ordering> åç´ ç´æ¥æå®äºåªäº JAR åéè¦æ«æ web fragmentï¼å¦æ <absolute-ordering/> åç´ æ¯ç©ºçï¼ åè¡¨ç¤ºä¸éè¦æ«æï¼åä¸é¢è¿æ ·ã\n\n<web-app metadata-complete="true">\n...\n<absolute-ordering />\n...\n</web-app>\n\n\n\n# éæºæ°çµæºä¼å\n\nTomcat 7 ä»¥ä¸ççæ¬ä¾èµ Java ç SecureRandom ç±»æ¥çæéæºæ°ï¼æ¯å¦ Session IDãè JVM é»è®¤ä½¿ç¨é»å¡å¼çµæºï¼/dev/randomï¼ï¼ å¨æäºæåµä¸å°±ä¼å¯¼è´ Tomcat å¯å¨åæ¢ãå½é»å¡æ¶é´è¾é¿æ¶ï¼ ä½ ä¼çå°è¿æ ·ä¸æ¡è­¦åæ¥å¿ï¼\n\n<DATE> org.apache.catalina.util.SessionIdGenerator createSecureRandom\nINFO: Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [8152] milliseconds.\n\n\nè§£å³æ¹æ¡æ¯éè¿è®¾ç½®ï¼è®© JVM ä½¿ç¨éé»å¡å¼ççµæºã\n\næä»¬å¯ä»¥è®¾ç½® JVM çåæ°ï¼\n\n-Djava.security.egd=file:/dev/./urandom\n\n\næèæ¯è®¾ç½® java.security æä»¶ï¼ä½äº $JAVA_HOME/jre/lib/security ç®å½ä¹ä¸ï¼ securerandom.source=file:/dev/./urandom\n\nè¿éè¯·ä½ æ³¨æï¼/dev/./urandom ä¸­é´æä¸ª ./ çåå æ¯ Oracle JRE ä¸­ç Bugï¼Java 8 éé¢ç SecureRandom ç±»å·²ç»ä¿®æ­£è¿ä¸ª Bugã é»å¡å¼ççµæºï¼/dev/randomï¼å®å¨æ§è¾é«ï¼ éé»å¡å¼ççµæºï¼/dev/./urandomï¼å®å¨æ§ä¼ä½ä¸äºï¼å ä¸ºå¦æä½ å¯¹éæºæ°çè¦æ±æ¯è¾é«ï¼ å¯ä»¥èèä½¿ç¨ç¡¬ä»¶æ¹å¼çæçµæºã\n\n\n# å¹¶è¡å¯å¨å¤ä¸ª Web åºç¨\n\nTomcat å¯å¨çæ¶åï¼é»è®¤æåµä¸ Web åºç¨é½æ¯ä¸ä¸ªä¸ä¸ªå¯å¨çï¼ç­ææ Web åºç¨å¨é¨å¯å¨å®æï¼Tomcat æç®å¯å¨å®æ¯ãå¦æå¨ä¸ä¸ª Tomcat ä¸æå¤ä¸ª Web åºç¨ï¼ä¸ºäºä¼åå¯å¨éåº¦ï¼ä½ å¯ä»¥éç½®å¤ä¸ªåºç¨ç¨åºå¹¶è¡å¯å¨ï¼å¯ä»¥éè¿ä¿®æ¹ server.xml ä¸­ Host åç´ ç startStopThreads å±æ§æ¥å®æãstartStopThreads çå¼è¡¨ç¤ºä½ æ³ç¨å¤å°ä¸ªçº¿ç¨æ¥å¯å¨ä½ ç Web åºç¨ï¼å¦æè®¾æ 0 è¡¨ç¤ºä½ è¦å¹¶è¡å¯å¨ Web åºç¨ï¼åä¸é¢è¿æ ·çéç½®ã\n\n<Engine startStopThreads="0">\n    ...\n    <Host startStopThreads="0">\n        ...\n    </Host>\n    ...\n</Engine>\n\n\néè¦æ³¨æçæ¯ï¼Engine åç´ éä¹éç½®äºè¿ä¸ªåæ°ï¼è¿æå³çå¦æä½ ç Tomcat éç½®äºå¤ä¸ª Hostï¼èæä¸»æºï¼ï¼Tomcat ä¼ä»¥å¹¶è¡çæ¹å¼å¯å¨å¤ä¸ª Hostã\n\n\n# åèèµæ\n\n * å®æ¹\n   * Tomcat å®æ¹ç½ç«\n   * Tomcat Wiki\n   * Tomee å®æ¹ç½ç«\n * æç¨\n   * æ·±å¥æè§£ Tomcat & Jetty',normalizedContent:'# tomcat ä¼å\n\n\n# tomcat å¯å¨ä¼å\n\nå¦æ tomcat å¯å¨æ¯è¾æ¢ï¼å¯ä»¥èèä¸äºä¼åç¹\n\n\n# æ¸ç tomcat\n\n * æ¸çä¸å¿è¦ç web åºç¨ï¼é¦åæä»¬è¦åçæ¯å é¤æ webapps æä»¶å¤¹ä¸ä¸éè¦çå·¥ç¨ï¼ä¸è¬æ¯ host-managerãexampleãdoc ç­è¿äºé»è®¤çå·¥ç¨ï¼å¯è½è¿æä»¥åæ·»å çä½ç°å¨ç¨ä¸ççå·¥ç¨ï¼æå¥½æè¿äºå¨é½å é¤æã\n * æ¸ç xml éç½®æä»¶ï¼tomcat å¨å¯å¨æ¶ä¼è§£æææç xml éç½®æä»¶ï¼è§£æ xml è¾ä¸ºèæ¶ï¼æä»¥åºè¯¥å°½éä¿æéç½®æä»¶çç®æ´ã\n * æ¸ç jar æä»¶ï¼jvm çç±»å è½½å¨å¨å è½½ç±»æ¶ï¼éè¦æ¥æ¾æ¯ä¸ä¸ª jar æä»¶ï¼å»æ¾å°æéè¦çç±»ãå¦æå é¤äºä¸éè¦ç jar æä»¶ï¼æ¥æ¾çéåº¦å°±ä¼å¿«ä¸äºãè¿éè¯·æ³¨æï¼web åºç¨ä¸­ç lib ç®å½ä¸ä¸åºè¯¥åºç° servlet api æè tomcat èªèº«ç jarï¼è¿äº jar ç± tomcat è´è´£æä¾ã\n * æ¸çå¶ä»æä»¶ï¼åæ¶æ¸çæ¥å¿ï¼å é¤ logs æä»¶å¤¹ä¸ä¸éè¦çæ¥å¿æä»¶ãåæ ·è¿æ work æä»¶å¤¹ä¸ç catalina æä»¶å¤¹ï¼å®å¶å®æ¯ tomcat æ jsp è½¬æ¢ä¸º class æä»¶çå·¥ä½ç®å½ãææ¶åæä»¬ä¹è®¸ä¼éå°ä¿®æ¹äºä»£ç ï¼éå¯äº tomcatï¼ä½æ¯ä»æ²¡ææï¼è¿æ¶åä¾¿å¯ä»¥å é¤æè¿ä¸ªæä»¶å¤¹ï¼tomcat ä¸æ¬¡å¯å¨çæ¶åä¼éæ°çæã\n\n\n# ç¦æ­¢ tomcat tld æ«æ\n\ntomcat ä¸ºäºæ¯æ jspï¼å¨åºç¨å¯å¨çæ¶åä¼æ«æ jar åéé¢ç tld æä»¶ï¼å è½½éé¢å®ä¹çæ ç­¾åºãæä»¥å¨ tomcat çå¯å¨æ¥å¿éï¼ä½ å¯è½ä¼ç¢°å°è¿ç§æç¤ºï¼\n\n> at least one jar was scanned for tlds yet contained no tlds. enable debug logging for this logger for a complete list of jars that were scanned but no tlds were found in them. skipping unneeded jars during scanning can improve startup time and jsp compilation time.\n\ntomcat çæææ¯ï¼ææ«æäºä½  web åºç¨ä¸ç jar åï¼åç° jar åéæ²¡æ tld æä»¶ãæå»ºè®®éç½®ä¸ä¸ tomcat ä¸è¦å»æ«æè¿äº jar åï¼è¿æ ·å¯ä»¥æé« tomcat çå¯å¨éåº¦ï¼å¹¶èç jsp ç¼è¯æ¶é´ã\n\nå¦ä½éç½®ä¸å»æ«æè¿äº jar åå¢ï¼è¿éåä¸¤ç§æåµï¼\n\n * å¦æä½ çé¡¹ç®æ²¡æä½¿ç¨ jsp ä½ä¸º web é¡µé¢æ¨¡æ¿ï¼èæ¯ä½¿ç¨ velocity ä¹ç±»çæ¨¡æ¿å¼æï¼ä½ å®å¨å¯ä»¥æ tld æ«æç¦æ­¢æãæ¹æ³æ¯ï¼æ¾å° tomcat çconf/ç®å½ä¸çcontext.xmlæä»¶ï¼å¨è¿ä¸ªæä»¶é context æ ç­¾ä¸ï¼å ä¸jarscanneråjarscanfilterå­æ ç­¾ï¼åä¸é¢è¿æ ·ã\n   \n   <context>\n      <jarscanner >\n         <jarscanfilter defaulttldscan="true" defaultpluggabilityscan="true" />\n      </jarscanner>\n   </context>\n   \n\n * å¦æä½ çé¡¹ç®ä½¿ç¨äº jsp ä½ä¸º web é¡µé¢æ¨¡åï¼æå³ç tld æ«ææ æ³é¿åï¼ä½æ¯æä»¬å¯ä»¥éè¿éç½®æ¥åè¯ tomcatï¼åªæ«æé£äºåå« tld æä»¶ç jar åãæ¹æ³æ¯ï¼æ¾å° tomcat çconf/ç®å½ä¸çcatalina.propertiesæä»¶ï¼å¨è¿ä¸ªæä»¶éç jarstoskip éç½®é¡¹ä¸­ï¼å ä¸ä½ ç jar åã\n   \n   tomcat.util.scan.standardjarscanfilter.jarstoskip=xxx.jar\n   \n\n\n# å³é­ websocket æ¯æ\n\ntomcat ä¼æ«æ websocket æ³¨è§£ç api å®ç°ï¼æ¯å¦ @serverendpoint æ³¨è§£çç±»ãå¦æä¸éè¦ä½¿ç¨ websockets å°±å¯ä»¥å³é­å®ãå·ä½æ¹æ³æ¯ï¼æ¾å° tomcat ç conf/ ç®å½ä¸ç context.xml æä»¶ï¼ç» context æ ç­¾å ä¸ä¸ª containerscifilter çå±æ§ï¼\n\n<context containerscifilter="org.apache.tomcat.websocket.server.wssci">\n...\n</context>\n\n\næ´è¿ä¸æ­¥ï¼å¦æä½ ä¸éè¦ websockets è¿ä¸ªåè½ï¼ä½ å¯ä»¥æ tomcat lib ç®å½ä¸ç websocket-api.jar å tomcat-websocket.jar è¿ä¸¤ä¸ª jar æä»¶å é¤æï¼è¿ä¸æ­¥æé«æ§è½ã\n\n\n# å³é­ jsp æ¯æ\n\nå¦æä¸éè¦ä½¿ç¨ jspï¼å¯ä»¥å³é­ jsp åè½ï¼\n\n<context containerscifilter="org.apache.jasper.servlet.jasperinitializer">\n...\n</context>\n\n\nå¦æè¦åæ¶å³é­ websocket å jspï¼å¯ä»¥è¿æ ·éç½®ï¼\n\n<context containerscifilter="org.apache.tomcat.websocket.server.wssci | org.apache.jasper.servlet.jasperinitializer">\n...\n</context>\n\n\n\n# ç¦æ­¢æ«æ servlet æ³¨è§£\n\nservlet 3.0 å¼å¥äºæ³¨è§£ servletï¼tomcat ä¸ºäºæ¯æè¿ä¸ªç¹æ§ï¼ä¼å¨ web åºç¨å¯å¨æ¶æ«æä½ çç±»æä»¶ï¼å æ­¤å¦æä½ æ²¡æä½¿ç¨ servlet æ³¨è§£è¿ä¸ªåè½ï¼å¯ä»¥åè¯ tomcat ä¸è¦å»æ«æ servlet æ³¨è§£ãå·ä½éç½®æ¹æ³æ¯ï¼å¨ä½ ç web åºç¨çweb.xmlæä»¶ä¸­ï¼è®¾ç½®<web-app>åç´ çå±æ§metadata-complete="true"ï¼åä¸é¢è¿æ ·ã\n\n<web-app metadata-complete="true">\n</web-app>\n\n\nmetadata-complete çæææ¯ï¼web.xml ééç½®ç servlet æ¯å®æ´çï¼ä¸éè¦åå»åºç±»ä¸­æ¾ servlet çå®ä¹ã\n\n\n# éç½® web-fragment æ«æ\n\nservlet 3.0 è¿å¼å¥äºâweb æ¨¡åé¨ç½²æè¿°ç¬¦çæ®µâç web-fragment.xmlï¼è¿æ¯ä¸ä¸ªé¨ç½²æè¿°æä»¶ï¼å¯ä»¥å®æ web.xml çéç½®åè½ãèè¿ä¸ª web-fragment.xml æä»¶å¿é¡»å­æ¾å¨ jar æä»¶ç meta-inf ç®å½ä¸ï¼è jar åéå¸¸æ¾å¨ web-inf/lib ç®å½ä¸ï¼å æ­¤ tomcat éè¦å¯¹ jar æä»¶è¿è¡æ«ææè½æ¯æè¿ä¸ªåè½ã\n\nå¯ä»¥éè¿éç½® web.xml éé¢ç <absolute-ordering> åç´ ç´æ¥æå®äºåªäº jar åéè¦æ«æ web fragmentï¼å¦æ <absolute-ordering/> åç´ æ¯ç©ºçï¼ åè¡¨ç¤ºä¸éè¦æ«æï¼åä¸é¢è¿æ ·ã\n\n<web-app metadata-complete="true">\n...\n<absolute-ordering />\n...\n</web-app>\n\n\n\n# éæºæ°çµæºä¼å\n\ntomcat 7 ä»¥ä¸ççæ¬ä¾èµ java ç securerandom ç±»æ¥çæéæºæ°ï¼æ¯å¦ session idãè jvm é»è®¤ä½¿ç¨é»å¡å¼çµæºï¼/dev/randomï¼ï¼ å¨æäºæåµä¸å°±ä¼å¯¼è´ tomcat å¯å¨åæ¢ãå½é»å¡æ¶é´è¾é¿æ¶ï¼ ä½ ä¼çå°è¿æ ·ä¸æ¡è­¦åæ¥å¿ï¼\n\n<date> org.apache.catalina.util.sessionidgenerator createsecurerandom\ninfo: creation of securerandom instance for session id generation using [sha1prng] took [8152] milliseconds.\n\n\nè§£å³æ¹æ¡æ¯éè¿è®¾ç½®ï¼è®© jvm ä½¿ç¨éé»å¡å¼ççµæºã\n\næä»¬å¯ä»¥è®¾ç½® jvm çåæ°ï¼\n\n-djava.security.egd=file:/dev/./urandom\n\n\næèæ¯è®¾ç½® java.security æä»¶ï¼ä½äº $java_home/jre/lib/security ç®å½ä¹ä¸ï¼ securerandom.source=file:/dev/./urandom\n\nè¿éè¯·ä½ æ³¨æï¼/dev/./urandom ä¸­é´æä¸ª ./ çåå æ¯ oracle jre ä¸­ç bugï¼java 8 éé¢ç securerandom ç±»å·²ç»ä¿®æ­£è¿ä¸ª bugã é»å¡å¼ççµæºï¼/dev/randomï¼å®å¨æ§è¾é«ï¼ éé»å¡å¼ççµæºï¼/dev/./urandomï¼å®å¨æ§ä¼ä½ä¸äºï¼å ä¸ºå¦æä½ å¯¹éæºæ°çè¦æ±æ¯è¾é«ï¼ å¯ä»¥èèä½¿ç¨ç¡¬ä»¶æ¹å¼çæçµæºã\n\n\n# å¹¶è¡å¯å¨å¤ä¸ª web åºç¨\n\ntomcat å¯å¨çæ¶åï¼é»è®¤æåµä¸ web åºç¨é½æ¯ä¸ä¸ªä¸ä¸ªå¯å¨çï¼ç­ææ web åºç¨å¨é¨å¯å¨å®æï¼tomcat æç®å¯å¨å®æ¯ãå¦æå¨ä¸ä¸ª tomcat ä¸æå¤ä¸ª web åºç¨ï¼ä¸ºäºä¼åå¯å¨éåº¦ï¼ä½ å¯ä»¥éç½®å¤ä¸ªåºç¨ç¨åºå¹¶è¡å¯å¨ï¼å¯ä»¥éè¿ä¿®æ¹ server.xml ä¸­ host åç´ ç startstopthreads å±æ§æ¥å®æãstartstopthreads çå¼è¡¨ç¤ºä½ æ³ç¨å¤å°ä¸ªçº¿ç¨æ¥å¯å¨ä½ ç web åºç¨ï¼å¦æè®¾æ 0 è¡¨ç¤ºä½ è¦å¹¶è¡å¯å¨ web åºç¨ï¼åä¸é¢è¿æ ·çéç½®ã\n\n<engine startstopthreads="0">\n    ...\n    <host startstopthreads="0">\n        ...\n    </host>\n    ...\n</engine>\n\n\néè¦æ³¨æçæ¯ï¼engine åç´ éä¹éç½®äºè¿ä¸ªåæ°ï¼è¿æå³çå¦æä½ ç tomcat éç½®äºå¤ä¸ª hostï¼èæä¸»æºï¼ï¼tomcat ä¼ä»¥å¹¶è¡çæ¹å¼å¯å¨å¤ä¸ª hostã\n\n\n# åèèµæ\n\n * å®æ¹\n   * tomcat å®æ¹ç½ç«\n   * tomcat wiki\n   * tomee å®æ¹ç½ç«\n * æç¨\n   * æ·±å¥æè§£ tomcat & jetty',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Tomcat å Jetty",frontmatter:{title:"Tomcat å Jetty",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Tomcat","Jetty"],abbrlink:"a6fd024b",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/f1bba6/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/01.Tomcat/05.Tomcat%E5%92%8CJetty.html",relativePath:"02.JavaEE/02.æå¡å¨/01.Tomcat/05.TomcatåJetty.md",key:"v-34fe61e4",path:"/pages/f1bba6/",headers:[{level:2,title:"Tomcat å Jetty",slug:"tomcat-å-jetty",normalizedTitle:"tomcat å jetty",charIndex:2},{level:2,title:"Web å®¹å¨",slug:"web-å®¹å¨",normalizedTitle:"web å®¹å¨",charIndex:18}],headersStr:"Tomcat å Jetty Web å®¹å¨",content:"# Tomcat å Jetty\n\nWeb å®¹å¨ Tomcat æ Jettyï¼ä½ä¸ºéè¦çç³»ç»ä¸­é´ä»¶ï¼è¿æ¥çæµè§å¨åä½ ç Web åºç¨ï¼å¹¶ä¸æ¯æç Web ç¨åºçè¿è¡ï¼å¯ä»¥è¯´ï¼å¼æäº Tomcat å Jetty çåçï¼Java Web å¼åå¯¹ä½ æ¥è¯´å°±æ¯«æ ç§å¯å¯è¨ã\n\n\n# Web å®¹å¨\n\næ©æç Web åºç¨ä¸»è¦ç¨äºæµè§æ°é»ç­éæé¡µé¢ï¼HTTP æå¡å¨ï¼æ¯å¦ ApacheãNginxï¼åæµè§å¨è¿åéæ HTMLï¼æµè§å¨è´è´£è§£æ HTMLï¼å°ç»æåç°ç»ç¨æ·ã\n\néçäºèç½çåå±ï¼æä»¬å·²ç»ä¸æ»¡è¶³äºä»ä»æµè§éæé¡µé¢ï¼è¿å¸æéè¿ä¸äºäº¤äºæä½ï¼æ¥è·åå¨æç»æï¼å æ­¤ä¹å°±éè¦ä¸äºæ©å±æºå¶è½å¤è®© HTTP æå¡å¨è°ç¨æå¡ç«¯ç¨åºã\n\näºæ¯ Sun å¬å¸æ¨åºäº Servlet ææ¯ãä½ å¯ä»¥æ Servlet ç®åçè§£ä¸ºè¿è¡å¨æå¡ç«¯ç Java å°ç¨åºï¼ä½æ¯ Servlet æ²¡æ main æ¹æ³ï¼ä¸è½ç¬ç«è¿è¡ï¼å æ­¤å¿é¡»æå®é¨ç½²å° Servlet å®¹å¨ä¸­ï¼ç±å®¹å¨æ¥å®ä¾åå¹¶è°ç¨ Servletã\n\nè Tomcat å Jetty å°±æ¯ä¸ä¸ª Servlet å®¹å¨ãä¸ºäºæ¹ä¾¿ä½¿ç¨ï¼å®ä»¬ä¹å·æ HTTP æå¡å¨çåè½ï¼å æ­¤Tomcat æè Jetty å°±æ¯ä¸ä¸ªâHTTP æå¡å¨ + Servlet å®¹å¨âï¼æä»¬ä¹å«å®ä»¬ Web å®¹å¨ã\n\nå¶ä»åºç¨æå¡å¨æ¯å¦ JBoss å WebLogicï¼å®ä»¬ä¸ä»ä»æ Servlet å®¹å¨çåè½ï¼ä¹åå« EJB å®¹å¨ï¼æ¯å®æ´ç Java EE åºç¨æå¡å¨ãä»è¿ä¸ªè§åº¦çï¼Tomcat å Jetty ç®æ¯ä¸ä¸ªè½»éçº§çåºç¨æå¡å¨ã\n\nå¨å¾®æå¡æ¶ææ¥æ¸æµè¡çä»å¤©ï¼å¼åäººåæ´åæ¬¢ç¨³å®çãè½»éçº§çåºç¨æå¡å¨ï¼å¹¶ä¸åºç¨ç¨åºç¨ååµçæ¹å¼æ¥è¿è¡ Servlet å®¹å¨ä¹éæ¸æµè¡èµ·æ¥ãä¹æä»¥éæ©è½»éçº§ï¼æ¯å ä¸ºå¨å¾®æå¡æ¶æä¸ï¼æä»¬æä¸ä¸ªå¤§èå¨çåä½åºç¨ï¼æåæä¸ä¸ªä¸ªåè½åä¸çå¾®æå¡ï¼å¨è¿ä¸ªè¿ç¨ä¸­ï¼æå¡çæ°éå¿ç¶è¦å¢å ï¼ä½ä¸ºäºåå°èµæºçæ¶èï¼å¹¶ä¸éä½é¨ç½²çææ¬ï¼æä»¬å¸æè¿è¡æå¡ç Web å®¹å¨ä¹æ¯è½»éçº§çï¼Web å®¹å¨æ¬èº«åºè¯¥æ¶èè¾å°çåå­å CPU èµæºï¼å¹¶ä¸ç±åºç¨æ¬èº«æ¥å¯å¨ä¸ä¸ªåµå¥å¼ç Web å®¹å¨ï¼èä¸æ¯éè¿ Web å®¹å¨æ¥é¨ç½²åå¯å¨åºç¨ï¼è¿æ ·å¯ä»¥éä½åºç¨é¨ç½²çå¤æåº¦ã",normalizedContent:"# tomcat å jetty\n\nweb å®¹å¨ tomcat æ jettyï¼ä½ä¸ºéè¦çç³»ç»ä¸­é´ä»¶ï¼è¿æ¥çæµè§å¨åä½ ç web åºç¨ï¼å¹¶ä¸æ¯æç web ç¨åºçè¿è¡ï¼å¯ä»¥è¯´ï¼å¼æäº tomcat å jetty çåçï¼java web å¼åå¯¹ä½ æ¥è¯´å°±æ¯«æ ç§å¯å¯è¨ã\n\n\n# web å®¹å¨\n\næ©æç web åºç¨ä¸»è¦ç¨äºæµè§æ°é»ç­éæé¡µé¢ï¼http æå¡å¨ï¼æ¯å¦ apacheãnginxï¼åæµè§å¨è¿åéæ htmlï¼æµè§å¨è´è´£è§£æ htmlï¼å°ç»æåç°ç»ç¨æ·ã\n\néçäºèç½çåå±ï¼æä»¬å·²ç»ä¸æ»¡è¶³äºä»ä»æµè§éæé¡µé¢ï¼è¿å¸æéè¿ä¸äºäº¤äºæä½ï¼æ¥è·åå¨æç»æï¼å æ­¤ä¹å°±éè¦ä¸äºæ©å±æºå¶è½å¤è®© http æå¡å¨è°ç¨æå¡ç«¯ç¨åºã\n\näºæ¯ sun å¬å¸æ¨åºäº servlet ææ¯ãä½ å¯ä»¥æ servlet ç®åçè§£ä¸ºè¿è¡å¨æå¡ç«¯ç java å°ç¨åºï¼ä½æ¯ servlet æ²¡æ main æ¹æ³ï¼ä¸è½ç¬ç«è¿è¡ï¼å æ­¤å¿é¡»æå®é¨ç½²å° servlet å®¹å¨ä¸­ï¼ç±å®¹å¨æ¥å®ä¾åå¹¶è°ç¨ servletã\n\nè tomcat å jetty å°±æ¯ä¸ä¸ª servlet å®¹å¨ãä¸ºäºæ¹ä¾¿ä½¿ç¨ï¼å®ä»¬ä¹å·æ http æå¡å¨çåè½ï¼å æ­¤tomcat æè jetty å°±æ¯ä¸ä¸ªâhttp æå¡å¨ + servlet å®¹å¨âï¼æä»¬ä¹å«å®ä»¬ web å®¹å¨ã\n\nå¶ä»åºç¨æå¡å¨æ¯å¦ jboss å weblogicï¼å®ä»¬ä¸ä»ä»æ servlet å®¹å¨çåè½ï¼ä¹åå« ejb å®¹å¨ï¼æ¯å®æ´ç java ee åºç¨æå¡å¨ãä»è¿ä¸ªè§åº¦çï¼tomcat å jetty ç®æ¯ä¸ä¸ªè½»éçº§çåºç¨æå¡å¨ã\n\nå¨å¾®æå¡æ¶ææ¥æ¸æµè¡çä»å¤©ï¼å¼åäººåæ´åæ¬¢ç¨³å®çãè½»éçº§çåºç¨æå¡å¨ï¼å¹¶ä¸åºç¨ç¨åºç¨ååµçæ¹å¼æ¥è¿è¡ servlet å®¹å¨ä¹éæ¸æµè¡èµ·æ¥ãä¹æä»¥éæ©è½»éçº§ï¼æ¯å ä¸ºå¨å¾®æå¡æ¶æä¸ï¼æä»¬æä¸ä¸ªå¤§èå¨çåä½åºç¨ï¼æåæä¸ä¸ªä¸ªåè½åä¸çå¾®æå¡ï¼å¨è¿ä¸ªè¿ç¨ä¸­ï¼æå¡çæ°éå¿ç¶è¦å¢å ï¼ä½ä¸ºäºåå°èµæºçæ¶èï¼å¹¶ä¸éä½é¨ç½²çææ¬ï¼æä»¬å¸æè¿è¡æå¡ç web å®¹å¨ä¹æ¯è½»éçº§çï¼web å®¹å¨æ¬èº«åºè¯¥æ¶èè¾å°çåå­å cpu èµæºï¼å¹¶ä¸ç±åºç¨æ¬èº«æ¥å¯å¨ä¸ä¸ªåµå¥å¼ç web å®¹å¨ï¼èä¸æ¯éè¿ web å®¹å¨æ¥é¨ç½²åå¯å¨åºç¨ï¼è¿æ ·å¯ä»¥éä½åºç¨é¨ç½²çå¤æåº¦ã",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Tomcat æç¨",frontmatter:{title:"Tomcat æç¨",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Tomcat"],hidden:!0,abbrlink:"3804ebfc",date:"2022-02-18T08:53:11.000Z",permalink:"/pages/86288e/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/01.Tomcat/",relativePath:"02.JavaEE/02.æå¡å¨/01.Tomcat/README.md",key:"v-00b2ebc6",path:"/pages/86288e/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:16},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:100},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:147}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# Tomcat æç¨\n\n\n# ð åå®¹\n\n * Tomcat å¿«éå¥é¨\n * Tomcat è¿æ¥å¨\n * Tomcat å®¹å¨\n * Tomcat ä¼å\n * Tomcat å Jetty\n\n\n# ð èµæ\n\n * Tomcat å®ç½\n * æ·±å¥æè§£ Tomcat & Jetty\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# tomcat æç¨\n\n\n# ð åå®¹\n\n * tomcat å¿«éå¥é¨\n * tomcat è¿æ¥å¨\n * tomcat å®¹å¨\n * tomcat ä¼å\n * tomcat å jetty\n\n\n# ð èµæ\n\n * tomcat å®ç½\n * æ·±å¥æè§£ tomcat & jetty\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Jetty å¿«éå¥é¨",frontmatter:{title:"Jetty å¿«éå¥é¨",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨","Jetty"],abbrlink:"9709eee9",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/9ecdc1/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/02.Jetty.html",relativePath:"02.JavaEE/02.æå¡å¨/02.Jetty.md",key:"v-612590a5",path:"/pages/9ecdc1/",headers:[{level:2,title:"Jetty ç®ä»",slug:"jetty-ç®ä»",normalizedTitle:"jetty ç®ä»",charIndex:17},{level:2,title:"Jetty çä½¿ç¨",slug:"jetty-çä½¿ç¨",normalizedTitle:"jetty çä½¿ç¨",charIndex:437},{level:3,title:"API æ¹å¼",slug:"api-æ¹å¼",normalizedTitle:"api æ¹å¼",charIndex:514},{level:3,title:"Maven æä»¶æ¹å¼",slug:"maven-æä»¶æ¹å¼",normalizedTitle:"maven æä»¶æ¹å¼",charIndex:2878},{level:2,title:"Jetty çæ¶æ",slug:"jetty-çæ¶æ",normalizedTitle:"jetty çæ¶æ",charIndex:5677},{level:3,title:"Jetty æ¶æç®ä»",slug:"jetty-æ¶æç®ä»",normalizedTitle:"jetty æ¶æç®ä»",charIndex:5691},{level:3,title:"Jetty å Tomcat æ¶æåºå«",slug:"jetty-å-tomcat-æ¶æåºå«",normalizedTitle:"jetty å tomcat æ¶æåºå«",charIndex:6242},{level:3,title:"Connector ç»ä»¶",slug:"connector-ç»ä»¶",normalizedTitle:"connector ç»ä»¶",charIndex:5824},{level:4,title:"Acceptor",slug:"acceptor",normalizedTitle:"acceptor",charIndex:6803},{level:3,title:"Handler ç»ä»¶",slug:"handler-ç»ä»¶",normalizedTitle:"handler ç»ä»¶",charIndex:5838},{level:4,title:"Handler ç»§æ¿å³ç³»",slug:"handler-ç»§æ¿å³ç³»",normalizedTitle:"handler ç»§æ¿å³ç³»",charIndex:11406},{level:4,title:"å®ç° Servlet è§è",slug:"å®ç°-servlet-è§è",normalizedTitle:"å®ç° servlet è§è",charIndex:12865},{level:2,title:"Jetty ççº¿ç¨ç­ç¥",slug:"jetty-ççº¿ç¨ç­ç¥",normalizedTitle:"jetty ççº¿ç¨ç­ç¥",charIndex:13927},{level:3,title:"ä¼ ç» Selector ç¼ç¨æ¨¡å",slug:"ä¼ ç»-selector-ç¼ç¨æ¨¡å",normalizedTitle:"ä¼ ç» selector ç¼ç¨æ¨¡å",charIndex:13943},{level:3,title:"Jetty ç Selector ç¼ç¨æ¨¡å",slug:"jetty-ç-selector-ç¼ç¨æ¨¡å",normalizedTitle:"jetty ç selector ç¼ç¨æ¨¡å",charIndex:14210},{level:4,title:"ManagedSelector",slug:"managedselector",normalizedTitle:"managedselector",charIndex:8042},{level:4,title:"SelectorUpdate æ¥å£",slug:"selectorupdate-æ¥å£",normalizedTitle:"selectorupdate æ¥å£",charIndex:15533},{level:4,title:"Selectable æ¥å£",slug:"selectable-æ¥å£",normalizedTitle:"selectable æ¥å£",charIndex:16671},{level:4,title:"ExecutionStrategy",slug:"executionstrategy",normalizedTitle:"executionstrategy",charIndex:15206},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:20913}],headersStr:"Jetty ç®ä» Jetty çä½¿ç¨ API æ¹å¼ Maven æä»¶æ¹å¼ Jetty çæ¶æ Jetty æ¶æç®ä» Jetty å Tomcat æ¶æåºå« Connector ç»ä»¶ Acceptor Handler ç»ä»¶ Handler ç»§æ¿å³ç³» å®ç° Servlet è§è Jetty ççº¿ç¨ç­ç¥ ä¼ ç» Selector ç¼ç¨æ¨¡å Jetty ç Selector ç¼ç¨æ¨¡å ManagedSelector SelectorUpdate æ¥å£ Selectable æ¥å£ ExecutionStrategy åèèµæ",content:'# Jetty å¿«éå¥é¨\n\n\n# Jetty ç®ä»\n\njetty æ¯ä»ä¹ï¼\n\njetty æ¯è½»éçº§ç web æå¡å¨å servlet å¼æã\n\nå®çæå¤§ç¹ç¹æ¯ï¼å¯ä»¥å¾æ¹ä¾¿çä½ä¸ºåµå¥å¼æå¡å¨ã\n\nå®æ¯ eclipse çä¸ä¸ªå¼æºé¡¹ç®ãä¸ç¨æçï¼å°±æ¯ä½ å¸¸ç¨çé£ä¸ª eclipseã\n\nå®æ¯ä½¿ç¨ Java å¼åçï¼æä»¥å¤©ç¶å¯¹ Java æ¯æè¯å¥½ã\n\nå®æ¹ç½å\n\ngithub æºç å°å\n\nä»ä¹æ¯åµå¥å¼æå¡å¨ï¼\n\nä»¥ jetty æ¥è¯´æï¼å°±æ¯åªè¦å¼å¥ jetty ç jar åï¼å¯ä»¥éè¿ç´æ¥è°ç¨å¶ API çæ¹å¼æ¥å¯å¨ web æå¡ã\n\nç¨è¿ TomcatãResin ç­æå¡å¨çæåæ³å¿ä¸ä¼éçé£ä¸å¥å®è£ãéç½®ãé¨ç½²çæµç¨å§ï¼è¿æ¯æºç¹ççãä½¿ç¨ jettyï¼å°±ä¸éè¦è¿äºè¿ç¨äºã\n\njetty éå¸¸éç¨äºé¡¹ç®çå¼åãæµè¯ï¼å ä¸ºéå¸¸å¿«æ·ãå¦ææ³ç¨äºçäº§ç¯å¢ï¼åéè¦è°¨æèèï¼å®ä¸ä¸å®è½åæçç TomcatãResin ç­æå¡å¨ä¸æ ·æ¯æä¼ä¸çº§ Java EE çéè¦ã\n\n\n# Jetty çä½¿ç¨\n\næè§å¾åµå¥å¼å¯å¨æ¹å¼çä¸ä¸ªå¥½å¤å¨äºï¼å¯ä»¥ç´æ¥è¿è¡é¡¹ç®ï¼æ éæ¯æ¬¡é¨ç½²é½å¾åéç½®æå¡å¨ã\n\njetty çåµå¥å¼å¯å¨ä½¿ç¨æä¸¤ç§æ¹å¼ï¼\n\nAPI æ¹å¼\n\nmaven æä»¶æ¹å¼\n\n\n# API æ¹å¼\n\næ·»å  maven ä¾èµ\n\n<dependency>\n  <groupId>org.eclipse.jetty</groupId>\n  <artifactId>jetty-webapp</artifactId>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n<dependency>\n  <groupId>org.eclipse.jetty</groupId>\n  <artifactId>jetty-annotations</artifactId>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n<dependency>\n  <groupId>org.eclipse.jetty</groupId>\n  <artifactId>apache-jsp</artifactId>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n<dependency>\n  <groupId>org.eclipse.jetty</groupId>\n  <artifactId>apache-jstl</artifactId>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n\n\nå®æ¹çå¯å¨ä»£ç \n\npublic class SplitFileServer\n{\n    public static void main( String[] args ) throws Exception\n    {\n        // åå»ºServerå¯¹è±¡ï¼å¹¶ç»å®ç«¯å£\n        Server server = new Server();\n        ServerConnector connector = new ServerConnector(server);\n        connector.setPort(8090);\n        server.setConnectors(new Connector[] { connector });\n\n        // åå»ºä¸ä¸æå¥æï¼ç»å®ä¸ä¸æè·¯å¾ãè¿æ ·å¯å¨åçurlå°±ä¼æ¯:http://host:port/context\n        ResourceHandler rh0 = new ResourceHandler();\n        ContextHandler context0 = new ContextHandler();\n        context0.setContextPath("/");\n\n        // ç»å®æµè¯èµæºç®å½ï¼å¨æ¬ä¾çéç½®ç®å½dir0çè·¯å¾æ¯src/test/resources/dir0ï¼\n        File dir0 = MavenTestingUtils.getTestResourceDir("dir0");\n        context0.setBaseResource(Resource.newResource(dir0));\n        context0.setHandler(rh0);\n\n        // åä¸é¢çä¾å­ä¸æ ·\n        ResourceHandler rh1 = new ResourceHandler();\n        ContextHandler context1 = new ContextHandler();\n        context1.setContextPath("/");\n        File dir1 = MavenTestingUtils.getTestResourceDir("dir1");\n        context1.setBaseResource(Resource.newResource(dir1));\n        context1.setHandler(rh1);\n\n        // ç»å®ä¸¤ä¸ªèµæºå¥æ\n        ContextHandlerCollection contexts = new ContextHandlerCollection();\n        contexts.setHandlers(new Handler[] { context0, context1 });\n        server.setHandler(contexts);\n\n        // å¯å¨\n        server.start();\n\n        // æå°dumpæ¶çä¿¡æ¯\n        System.out.println(server.dump());\n\n        // joinå½åçº¿ç¨\n        server.join();\n    }\n}\n\n\nç´æ¥è¿è¡ Main æ¹æ³ï¼å°±å¯ä»¥å¯å¨ web æå¡ã\n\næ³¨ï¼ä»¥ä¸ä»£ç å¨ eclipse ä¸­è¿è¡æ²¡æé®é¢ï¼å¦ææ³å¨ Intellij ä¸­è¿è¡è¿éè¦ä¸ºå®æå®éç½®æä»¶ã\n\nå¦ææ³äºè§£å¨ Eclipse å Intellij é½è½è¿è¡çéç¨æ¹æ³å¯ä»¥åèæç github ä»£ç ç¤ºä¾ã\n\næçå®ç°ä¹æ¯åè springside çæ¹å¼ã\n\nä»£ç è¡æ°æç¹å¤ï¼ä¸å¨è¿éè´´ä»£ç äºã\n\nå®æ´åèä»£ç \n\n\n# Maven æä»¶æ¹å¼\n\nå¦æä½ çæ mavenï¼é£ä¹å®å¨å¤ªç®åäº\n\næ³¨ï¼ Maven çæ¬å¿é¡»å¨ 3.3 åä»¥ä¸çæ¬ã\n\n(1) æ·»å  maven æä»¶\n\n<plugin>\n  <groupId>org.eclipse.jetty</groupId>\n  <artifactId>jetty-maven-plugin</artifactId>\n  <version>9.3.12.v20160915</version>\n</plugin>\n\n\n(2) æ§è¡ maven å½ä»¤ï¼\n\nmvn jetty:run\n\n\nè®²çï¼å°±æ¯è¿ä¹ç®åãjetty é»è®¤ä¼ä¸ºä½ åå»ºä¸ä¸ª web æå¡ï¼å°åä¸º 127.0.0.1:8080ã\n\nå½ç¶ï¼ä½ ä¹å¯ä»¥å¨æä»¶ä¸­éç½®ä½ ç webapp ç¯å¢\n\n<plugin>\n  <groupId>org.eclipse.jetty</groupId>\n  <artifactId>jetty-maven-plugin</artifactId>\n  <version>9.3.12.v20160915</version>\n\n  <configuration>\n <webAppSourceDirectory>${project.basedir}/src/staticfiles</webAppSourceDirectory>\n\n    \x3c!-- éç½®webapp --\x3e\n <webApp>\n   <contextPath>/</contextPath>\n   <descriptor>${project.basedir}/src/over/here/web.xml</descriptor>\n   <jettyEnvXml>${project.basedir}/src/over/here/jetty-env.xml</jettyEnvXml>\n </webApp>\n\n    \x3c!-- éç½®classes --\x3e\n <classesDirectory>${project.basedir}/somewhere/else</classesDirectory>\n <scanClassesPattern>\n   <excludes>\n  <exclude>**/Foo.class</exclude>\n   </excludes>\n </scanClassesPattern>\n <scanTargets>\n   <scanTarget>src/mydir</scanTarget>\n   <scanTarget>src/myfile.txt</scanTarget>\n </scanTargets>\n\n    \x3c!-- æ«ætargetç®å½ä¸çèµæºæä»¶ --\x3e\n <scanTargetPatterns>\n   <scanTargetPattern>\n <directory>src/other-resources</directory>\n <includes>\n   <include>**/*.xml</include>\n   <include>**/*.properties</include>\n </includes>\n <excludes>\n   <exclude>**/myspecial.xml</exclude>\n   <exclude>**/myspecial.properties</exclude>\n </excludes>\n   </scanTargetPattern>\n </scanTargetPatterns>\n  </configuration>\n</plugin>\n\n\nå®æ¹ç»ç jetty-env.xml èä¾\n\n <?xml version="1.0"?>\n <!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd">\n\n <Configure class="org.eclipse.jetty.webapp.WebAppContext">\n\n   \x3c!-- Add an EnvEntry only valid for this webapp               --\x3e\n   <New id="gargle"  class="org.eclipse.jetty.plus.jndi.EnvEntry">\n     <Arg>gargle</Arg>\n     <Arg type="java.lang.Double">100</Arg>\n     <Arg type="boolean">true</Arg>\n   </New>\n\n  \x3c!-- Add an override for a global EnvEntry                           --\x3e\n   <New id="wiggle"  class="org.eclipse.jetty.plus.jndi.EnvEntry">\n     <Arg>wiggle</Arg>\n     <Arg type="java.lang.Double">55.0</Arg>\n     <Arg type="boolean">true</Arg>\n   </New>\n\n   \x3c!-- an XADataSource                                                --\x3e\n   <New id="mydatasource99" class="org.eclipse.jetty.plus.jndi.Resource">\n     <Arg>jdbc/mydatasource99</Arg>\n     <Arg>\n       <New class="com.atomikos.jdbc.SimpleDataSourceBean">\n         <Set name="xaDataSourceClassName">org.apache.derby.jdbc.EmbeddedXADataSource</Set>\n         <Set name="xaDataSourceProperties">databaseName=testdb99;createDatabase=create</Set>\n         <Set name="UniqueResourceName">mydatasource99</Set>\n       </New>\n     </Arg>\n   </New>\n\n </Configure>\n\n\n\n# Jetty çæ¶æ\n\n\n# Jetty æ¶æç®ä»\n\n\n\nJetty Server å°±æ¯ç±å¤ä¸ª Connectorï¼è¿æ¥å¨ï¼ãå¤ä¸ª Handlerï¼å¤çå¨ï¼ï¼ä»¥åä¸ä¸ªçº¿ç¨æ± ç»æã\n\nè· Tomcat ä¸æ ·ï¼Jetty ä¹æ HTTP æå¡å¨å Servlet å®¹å¨çåè½ï¼å æ­¤ Jetty ä¸­ç Connector ç»ä»¶å Handler ç»ä»¶åå«æ¥å®ç°è¿ä¸¤ä¸ªåè½ï¼èè¿ä¸¤ä¸ªç»ä»¶å·¥ä½æ¶æéè¦ççº¿ç¨èµæºé½ç´æ¥ä»ä¸ä¸ªå¨å±çº¿ç¨æ±  ThreadPool ä¸­è·åã\n\nJetty Server å¯ä»¥æå¤ä¸ª Connector å¨ä¸åçç«¯å£ä¸çå¬å®¢æ·è¯·æ±ï¼èå¯¹äºè¯·æ±å¤çç Handler ç»ä»¶ï¼ä¹å¯ä»¥æ ¹æ®å·ä½åºæ¯ä½¿ç¨ä¸åç Handlerãè¿æ ·çè®¾è®¡æé«äº Jetty ççµæ´»æ§ï¼éè¦æ¯æ Servletï¼åå¯ä»¥ä½¿ç¨ ServletHandlerï¼éè¦æ¯æ Sessionï¼ååå¢å ä¸ä¸ª SessionHandlerãä¹å°±æ¯è¯´æä»¬å¯ä»¥ä¸ä½¿ç¨ Servlet æè Sessionï¼åªè¦ä¸éç½®è¿ä¸ª Handler å°±è¡äºã\n\nä¸ºäºå¯å¨ååè°ä¸é¢çæ ¸å¿ç»ä»¶å·¥ä½ï¼Jetty æä¾äºä¸ä¸ª Server ç±»æ¥åè¿ä¸ªäºæï¼å®è´è´£åå»ºå¹¶åå§å ConnectorãHandlerãThreadPool ç»ä»¶ï¼ç¶åè°ç¨ start æ¹æ³å¯å¨å®ä»¬ã\n\n\n# Jetty å Tomcat æ¶æåºå«\n\nå¯¹æ¯ä¸ä¸ Tomcat çæ´ä½æ¶æå¾ï¼ä½ ä¼åç° Tomcat å¨æ´ä½ä¸è· Jetty å¾ç¸ä¼¼ï¼å®ä»¬çç¬¬ä¸ä¸ªåºå«æ¯ Jetty ä¸­æ²¡æ Service çæ¦å¿µï¼Tomcat ä¸­ç Service åè£äºå¤ä¸ªè¿æ¥å¨åä¸ä¸ªå®¹å¨ç»ä»¶ï¼ä¸ä¸ª Tomcat å®ä¾å¯ä»¥éç½®å¤ä¸ª Serviceï¼ä¸åç Service éè¿ä¸åçè¿æ¥å¨çå¬ä¸åçç«¯å£ï¼è Jetty ä¸­ Connector æ¯è¢«ææ Handler å±äº«çã\n\nç¬¬äºä¸ªåºå«æ¯ï¼å¨ Tomcat ä¸­æ¯ä¸ªè¿æ¥å¨é½æèªå·±ççº¿ç¨æ± ï¼èå¨ Jetty ä¸­ææç Connector å±äº«ä¸ä¸ªå¨å±ççº¿ç¨æ± ã\n\n\n# Connector ç»ä»¶\n\nè· Tomcat ä¸æ ·ï¼Connector çä¸»è¦åè½æ¯å¯¹ I/O æ¨¡åååºç¨å±åè®®çå°è£ãI/O æ¨¡åæ¹é¢ï¼ææ°ç Jetty 9 çæ¬åªæ¯æ NIOï¼å æ­¤ Jetty ç Connector è®¾è®¡æææ¾ç Java NIO éä¿¡æ¨¡åççè¿¹ãè³äºåºç¨å±åè®®æ¹é¢ï¼è· Tomcat ç Processor ä¸æ ·ï¼Jetty æ½è±¡åºäº Connection ç»ä»¶æ¥å°è£åºç¨å±åè®®çå·®å¼ã\n\næå¡ç«¯å¨ NIO éä¿¡ä¸ä¸»è¦å®æäºä¸ä»¶äºæï¼çå¬è¿æ¥ãI/O äºä»¶æ¥è¯¢ä»¥åæ°æ®è¯»åãå æ­¤ Jetty è®¾è®¡äºAcceptorãSelectorManager å Connection æ¥åå«åè¿ä¸ä»¶äºæ\n\n# Acceptor\n\nAcceptor ç¨äºæ¥åè¯·æ±ãè· Tomcat ä¸æ ·ï¼Jetty ä¹æç¬ç«ç Acceptor çº¿ç¨ç»ç¨äºå¤çè¿æ¥è¯·æ±ãå¨ Connector çå®ç°ç±» ServerConnector ä¸­ï¼æä¸ä¸ª _acceptors çæ°ç»ï¼å¨ Connector å¯å¨çæ¶å, ä¼æ ¹æ® _acceptors æ°ç»çé¿åº¦åå»ºå¯¹åºæ°éç Acceptorï¼è Acceptor çä¸ªæ°å¯ä»¥éç½®ã\n\nfor (int i = 0; i < _acceptors.length; i++)\n{\n  Acceptor a = new Acceptor(i);\n  getExecutor().execute(a);\n}\n\n\nAcceptor æ¯ ServerConnector ä¸­çä¸ä¸ªåé¨ç±»ï¼åæ¶ä¹æ¯ä¸ä¸ª Runnableï¼Acceptor çº¿ç¨æ¯éè¿ getExecutor() å¾å°ççº¿ç¨æ± æ¥æ§è¡çï¼åé¢æå°è¿æ¯ä¸ä¸ªå¨å±ççº¿ç¨æ± ã\n\nAcceptor éè¿é»å¡çæ¹å¼æ¥æ¥åè¿æ¥ï¼è¿ä¸ç¹è· Tomcat ä¹æ¯ä¸æ ·çã\n\npublic void accept(int acceptorID) throws IOException\n{\n  ServerSocketChannel serverChannel = _acceptChannel;\n  if (serverChannel != null && serverChannel.isOpen())\n  {\n    // è¿éæ¯é»å¡ç\n    SocketChannel channel = serverChannel.accept();\n    // æ§è¡å°è¿éæ¶è¯´ææè¯·æ±è¿æ¥äº\n    accepted(channel);\n  }\n}\n\n\næ¥åè¿æ¥æååä¼è°ç¨ accepted() å½æ°ï¼accepted() å½æ°ä¸­ä¼å° SocketChannel è®¾ç½®ä¸ºéé»å¡æ¨¡å¼ï¼ç¶åäº¤ç» Selector å»å¤çï¼å æ­¤è¿ä¹å°±å°äº Selector çå°çäºã\n\nprivate void accepted(SocketChannel channel) throws IOException\n{\n    channel.configureBlocking(false);\n    Socket socket = channel.socket();\n    configure(socket);\n    // _manager æ¯ SelectorManager å®ä¾ï¼éé¢ç®¡çäºææç Selector å®ä¾\n    _manager.accept(channel);\n}\n\n\nSelectorManager\n\nJetty ç Selector ç± SelectorManager ç±»ç®¡çï¼èè¢«ç®¡çç Selector å«ä½ ManagedSelectorãSelectorManager åé¨æä¸ä¸ª ManagedSelector æ°ç»ï¼çæ­£å¹²æ´»çæ¯ ManagedSelectorãå±ä»¬æ¥çä¸é¢åæï¼ççå¨ SelectorManager å¨ accept æ¹æ³éåäºä»ä¹ã\n\npublic void accept(SelectableChannel channel, Object attachment)\n{\n  // éæ©ä¸ä¸ª ManagedSelector æ¥å¤ç Channel\n  final ManagedSelector selector = chooseSelector();\n  // æäº¤ä¸ä¸ªä»»å¡ Accept ç» ManagedSelector\n  selector.submit(selector.new Accept(channel, attachment));\n}\n\n\nSelectorManager ä»æ¬èº«ç Selector æ°ç»ä¸­éæ©ä¸ä¸ª Selector æ¥å¤çè¿ä¸ª Channelï¼å¹¶åå»ºä¸ä¸ªä»»å¡ Accept äº¤ç» ManagedSelectorï¼ManagedSelector å¨å¤çè¿ä¸ªä»»å¡ä¸»è¦åäºä¸¤æ­¥ï¼\n\nç¬¬ä¸æ­¥ï¼è°ç¨ Selector ç register æ¹æ³æ Channel æ³¨åå° Selector ä¸ï¼æ¿å°ä¸ä¸ª SelectionKeyã\n\n _key = _channel.register(selector, SelectionKey.OP_ACCEPT, this);\n\n\nç¬¬äºæ­¥ï¼åå»ºä¸ä¸ª EndPoint å Connectionï¼å¹¶è·è¿ä¸ª SelectionKeyï¼Channelï¼ç»å¨ä¸èµ·ï¼\n\nprivate void createEndPoint(SelectableChannel channel, SelectionKey selectionKey) throws IOException\n{\n    //1. åå»º Endpoint\n    EndPoint endPoint = _selectorManager.newEndPoint(channel, this, selectionKey);\n\n    //2. åå»º Connection\n    Connection connection = _selectorManager.newConnection(channel, endPoint, selectionKey.attachment());\n\n    //3. æ EndpointãConnection å SelectionKey ç»å¨ä¸èµ·\n    endPoint.setConnection(connection);\n    selectionKey.attach(endPoint);\n\n}\n\n\nè¿ééè¦ä½ ç¹å«æ³¨æçæ¯ï¼ManagedSelector å¹¶æ²¡æç´æ¥è°ç¨ EndPoint çæ¹æ³å»å¤çæ°æ®ï¼èæ¯éè¿è°ç¨ EndPoint çæ¹æ³è¿åä¸ä¸ª Runnableï¼ç¶åæè¿ä¸ª Runnable æç»çº¿ç¨æ± æ§è¡ï¼æä»¥ä½ è½çå°ï¼è¿ä¸ª Runnable æä¼å»çæ­£è¯»æ°æ®åå¤çè¯·æ±ã\n\nConnection\n\nè¿ä¸ª Runnable æ¯ EndPoint çä¸ä¸ªåé¨ç±»ï¼å®ä¼è°ç¨ Connection çåè°æ¹æ³æ¥å¤çè¯·æ±ãJetty ç Connection ç»ä»¶ç±»æ¯å°±æ¯ Tomcat ç Processorï¼è´è´£å·ä½åè®®çè§£æï¼å¾å° Request å¯¹è±¡ï¼å¹¶è°ç¨ Handler å®¹å¨è¿è¡å¤çãä¸é¢æç®åä»ç»ä¸ä¸å®çå·ä½å®ç°ç±» HttpConnection å¯¹è¯·æ±åååºçå¤çè¿ç¨ã\n\nè¯·æ±å¤çï¼HttpConnection å¹¶ä¸ä¼ä¸»å¨å EndPoint è¯»åæ°æ®ï¼èæ¯åå¨ EndPoint ä¸­æ³¨åä¸å åè°æ¹æ³ï¼\n\ngetEndPoint().fillInterested(_readCallback);\n\n\nè¿æ®µä»£ç å°±æ¯åè¯ EndPointï¼æ°æ®å°äºä½ å°±è°æè¿äºåè°æ¹æ³ _readCallback å§ï¼æç¹å¼æ­¥ I/O çæè§ï¼ä¹å°±æ¯è¯´ Jetty å¨åºç¨å±é¢æ¨¡æäºå¼æ­¥ I/O æ¨¡åã\n\nèå¨åè°æ¹æ³ _readCallback éï¼ä¼è°ç¨ EndPoint çæ¥å£å»è¯»æ°æ®ï¼è¯»å®åè®© HTTP è§£æå¨å»è§£æå­èæµï¼HTTP è§£æå¨ä¼å°è§£æåçæ°æ®ï¼åæ¬è¯·æ±è¡ãè¯·æ±å¤´ç¸å³ä¿¡æ¯å­å° Request å¯¹è±¡éã\n\nååºå¤çï¼Connection è°ç¨ Handler è¿è¡ä¸å¡å¤çï¼Handler ä¼éè¿ Response å¯¹è±¡æ¥æä½ååºæµï¼åæµéé¢åå¥æ°æ®ï¼HttpConnection åéè¿ EndPoint ææ°æ®åå° Channelï¼è¿æ ·ä¸æ¬¡ååºå°±å®æäºã\n\nå°æ­¤ä½ åºè¯¥äºè§£äº Connector çå·¥ä½åçï¼ä¸é¢æç»å¼ å¾åæ¥åé¡¾ä¸ä¸ Connector çå·¥ä½æµç¨ã\n\n\n\n 1. Acceptor çå¬è¿æ¥è¯·æ±ï¼å½æè¿æ¥è¯·æ±å°è¾¾æ¶å°±æ¥åè¿æ¥ï¼ä¸ä¸ªè¿æ¥å¯¹åºä¸ä¸ª Channelï¼Acceptor å° Channel äº¤ç» ManagedSelector æ¥å¤çã\n\n 2. ManagedSelector æ Channel æ³¨åå° Selector ä¸ï¼å¹¶åå»ºä¸ä¸ª EndPoint å Connection è·è¿ä¸ª Channel ç»å®ï¼æ¥çå°±ä¸æ­å°æ£æµ I/O äºä»¶ã\n\n 3. I/O äºä»¶å°äºå°±è°ç¨ EndPoint çæ¹æ³æ¿å°ä¸ä¸ª Runnableï¼å¹¶æç»çº¿ç¨æ± æ§è¡ã\n\n 4. çº¿ç¨æ± ä¸­è°åº¦æä¸ªçº¿ç¨æ§è¡ Runnableã\n\n 5. Runnable æ§è¡æ¶ï¼è°ç¨åè°å½æ°ï¼è¿ä¸ªåè°å½æ°æ¯ Connection æ³¨åå° EndPoint ä¸­çã\n\n 6. åè°å½æ°åé¨å®ç°ï¼å¶å®å°±æ¯è°ç¨ EndPoint çæ¥å£æ¹æ³æ¥è¯»æ°æ®ã\n\n 7. Connection è§£æè¯»å°çæ°æ®ï¼çæè¯·æ±å¯¹è±¡å¹¶äº¤ç» Handler ç»ä»¶å»å¤çã\n\n\n# Handler ç»ä»¶\n\nJetty ç Handler è®¾è®¡æ¯å®çä¸å¤§ç¹è²ï¼Jetty æ¬è´¨å°±æ¯ä¸ä¸ª Handler ç®¡çå¨ï¼Jetty æ¬èº«å°±æä¾äºä¸äºé»è®¤ Handler æ¥å®ç° Servlet å®¹å¨çåè½ï¼ä½ ä¹å¯ä»¥å®ä¹èªå·±ç Handler æ¥æ·»å å° Jetty ä¸­ï¼è¿ä½ç°äºâå¾®åæ ¸ + æä»¶âçè®¾è®¡ææ³ã\n\nHandler å°±æ¯ä¸ä¸ªæ¥å£ï¼å®æä¸å å®ç°ç±»ï¼Jetty ç Connector ç»ä»¶è°ç¨è¿äºæ¥å£æ¥å¤ç Servlet è¯·æ±ã\n\npublic interface Handler extends LifeCycle, Destroyable\n{\n    // å¤çè¯·æ±çæ¹æ³\n    public void handle(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response)\n        throws IOException, ServletException;\n\n    // æ¯ä¸ª Handler é½å³èä¸ä¸ª Server ç»ä»¶ï¼è¢« Server ç®¡ç\n    public void setServer(Server server);\n    public Server getServer();\n\n    // éæ¯æ¹æ³ç¸å³çèµæº\n    public void destroy();\n}\n\n\næ¹æ³è¯´æï¼\n\n * Handler ç handle æ¹æ³è· Tomcat å®¹å¨ç»ä»¶ç service æ¹æ³ä¸æ ·ï¼å®æ ServletRequest å ServeletResponse ä¸¤ä¸ªåæ°ã\n * å ä¸ºä»»ä½ä¸ä¸ª Handler é½éè¦å³èä¸ä¸ª Server ç»ä»¶ï¼Handler éè¦è¢« Server ç»ä»¶æ¥ç®¡çãHandler éè¿ setServer å getServer æ¹æ³ç»å® Serverã\n * Handler ä¼å è½½ä¸äºèµæºå°åå­ï¼å æ­¤éè¿è®¾ç½® destroy æ¹æ³æ¥éæ¯ã\n\n# Handler ç»§æ¿å³ç³»\n\nHandler åªæ¯ä¸ä¸ªæ¥å£ï¼å®æå·ä½åè½çè¿æ¯å®çå­ç±»ãé£ä¹ Handler æåªäºå­ç±»å¢ï¼å®ä»¬çç»§æ¿å³ç³»åæ¯ææ ·çï¼è¿äºå­ç±»æ¯å¦ä½å®ç° Servlet å®¹å¨åè½çå¢ï¼\n\n\n\nå¨ AbstractHandler ä¹ä¸æ AbstractHandlerContainerï¼ä¸ºä»ä¹éè¦è¿ä¸ªç±»å¢ï¼è¿å¶å®æ¯ä¸ªè¿æ¸¡ï¼ä¸ºäºå®ç°é¾å¼è°ç¨ï¼ä¸ä¸ª Handler åé¨å¿ç¶è¦æå¶ä» Handler çå¼ç¨ï¼æä»¥è¿ä¸ªç±»çåå­éææ Containerï¼ææå°±æ¯è¿æ ·ç Handler éåå«äºå¶ä» Handler çå¼ç¨ã\n\nHandlerWrapper å HandlerCollection é½æ¯ Handlerï¼ä½æ¯è¿äº Handler éè¿åæ¬å¶ä» Handler çå¼ç¨ãä¸åçæ¯ï¼HandlerWrapper åªåå«ä¸ä¸ªå¶ä» Handler çå¼ç¨ï¼è HandlerCollection ä¸­æä¸ä¸ª Handler æ°ç»çå¼ç¨ã\n\nHandlerWrapper æä¸¤ä¸ªå­ç±»ï¼Server å ScopedHandlerã\n\n * Server æ¯è¾å¥½çè§£ï¼å®æ¬èº«æ¯ Handler æ¨¡åçå¥å£ï¼å¿ç¶è¦å°è¯·æ±ä¼ éç»å¶ä» Handler æ¥å¤çï¼ä¸ºäºè§¦åå¶ä» Handler çè°ç¨ï¼æä»¥å®æ¯ä¸ä¸ª HandlerWrapperã\n * ScopedHandler ä¹æ¯ä¸ä¸ªæ¯è¾éè¦ç Handlerï¼å®ç°äºâå·æä¸ä¸æä¿¡æ¯âçè´£ä»»é¾è°ç¨ãä¸ºä»ä¹æè¦å¼ºè°âå·æä¸ä¸æä¿¡æ¯âå¢ï¼é£æ¯å ä¸º Servlet è§èè§å® Servlet å¨æ§è¡è¿ç¨ä¸­æ¯æä¸ä¸æçãé£ä¹è¿äº Handler å¨æ§è¡è¿ç¨ä¸­å¦ä½è®¿é®è¿ä¸ªä¸ä¸æå¢ï¼è¿ä¸ªä¸ä¸æåå­å¨ä»ä¹å°æ¹å¢ï¼ç­æ¡å°±æ¯éè¿ ScopedHandler æ¥å®ç°çã\n\nHandlerCollection å¶å®ç»´æ¤äºä¸ä¸ª Handler æ°ç»ãè¿æ¯ä¸ºäºåæ¶æ¯æå¤ä¸ª Web åºç¨ï¼å¦ææ¯ä¸ª Web åºç¨æä¸ä¸ª Handler å¥å£ï¼é£ä¹å¤ä¸ª Web åºç¨ç Handler å°±æäºä¸ä¸ªæ°ç»ï¼æ¯å¦ Server ä¸­å°±æä¸ä¸ª HandlerCollectionï¼Server ä¼æ ¹æ®ç¨æ·è¯·æ±ç URL ä»æ°ç»ä¸­éåç¸åºç Handler æ¥å¤çï¼å°±æ¯éæ©ç¹å®ç Web åºç¨æ¥å¤çè¯·æ±ã\n\nHandler å¯ä»¥åæä¸ç§ç±»åï¼\n\n * ç¬¬ä¸ç§æ¯åè° Handlerï¼è¿ç§ Handler è´è´£å°è¯·æ±è·¯ç±å°ä¸ç» Handler ä¸­å»ï¼æ¯å¦ HandlerCollectionï¼å®åé¨ææä¸ä¸ª Handler æ°ç»ï¼å½è¯·æ±å°æ¥æ¶ï¼å®è´è´£å°è¯·æ±è½¬åå°æ°ç»ä¸­çæä¸ä¸ª Handlerã\n * ç¬¬äºç§æ¯è¿æ»¤å¨ Handlerï¼è¿ç§ Handler èªå·±ä¼å¤çè¯·æ±ï¼å¤çå®äºååæè¯·æ±è½¬åå°ä¸ä¸ä¸ª Handlerï¼æ¯å¦å¾ä¸ç HandlerWrapperï¼å®åé¨ææä¸ä¸ä¸ª Handler çå¼ç¨ãéè¦æ³¨æçæ¯ï¼ææç»§æ¿äº HandlerWrapper ç Handler é½å·æäºè¿æ»¤å¨ Handler çç¹å¾ï¼æ¯å¦ ContextHandlerãSessionHandler å WebAppContext ç­ã\n * ç¬¬ä¸ç§æ¯åå®¹ Handlerï¼è¯´ç½äºå°±æ¯è¿äº Handler ä¼çæ­£è°ç¨ Servlet æ¥å¤çè¯·æ±ï¼çæååºçåå®¹ï¼æ¯å¦ ServletHandlerãå¦ææµè§å¨è¯·æ±çæ¯ä¸ä¸ªéæèµæºï¼ä¹æç¸åºç ResourceHandler æ¥å¤çè¿ä¸ªè¯·æ±ï¼è¿åéæé¡µé¢ã\n\n# å®ç° Servlet è§è\n\nServletHandlerãContextHandler ä»¥å WebAppContext ç­ï¼å®ä»¬å®ç°äº Servlet è§èã\n\nServlet è§èä¸­æ ContextãServletãFilterãListener å Session ç­ï¼Jetty è¦æ¯æ Servlet è§èï¼å°±éè¦æç¸åºç Handler æ¥åå«å®ç°è¿äºåè½ãå æ­¤ï¼Jetty è®¾è®¡äº 3 ä¸ªç»ä»¶ï¼ContextHandlerãServletHandler å SessionHandler æ¥å®ç° Servle è§èä¸­è§å®çåè½ï¼èWebAppContext æ¬èº«å°±æ¯ä¸ä¸ª ContextHandlerï¼å¦å¤å®è¿è´è´£ç®¡ç ServletHandler å SessionHandlerã\n\nContextHandler ä¼åå»ºå¹¶åå§å Servlet è§èéç ServletContext å¯¹è±¡ï¼åæ¶ ContextHandler è¿åå«äºä¸ç»è½å¤è®©ä½ ç Web åºç¨è¿è¡èµ·æ¥ç Handlerï¼å¯ä»¥è¿æ ·çè§£ï¼Context æ¬èº«ä¹æ¯ä¸ç§ Handlerï¼å®éé¢åå«äºå¶ä»ç Handlerï¼è¿äº Handler è½å¤çæä¸ªç¹å® URL ä¸çè¯·æ±ãæ¯å¦ï¼ContextHandler åå«äºä¸ä¸ªæèå¤ä¸ª ServletHandlerã\n\nServletHandler å®ç°äº Servlet è§èä¸­ç ServletãFilter å Listener çåè½ãServletHandler ä¾èµ FilterHolderãServletHolderãServletMappingãFilterMapping è¿åå¤§ç»ä»¶ãFilterHolder å ServletHolder åå«æ¯ Filter å Servlet çåè£ç±»ï¼æ¯ä¸ä¸ª Servlet ä¸è·¯å¾çæ å°ä¼è¢«å°è£æ ServletMappingï¼è Filter ä¸æ¦æª URL çæ å°ä¼è¢«å°è£æ FilterMappingã\n\nSessionHandler ç¨æ¥ç®¡ç Sessionãé¤æ­¤ä¹å¤ WebAppContext è¿æä¸äºéç¨åè½ç Handlerï¼æ¯å¦ SecurityHandler å GzipHandlerï¼åæ ·ä»åå­å¯ä»¥ç¥éè¿äº Handler çåè½åå«æ¯å®å¨æ§å¶ååç¼© / è§£åç¼©ã\n\nWebAppContext ä¼å°è¿äº Handler æå»ºæä¸ä¸ªæ§è¡é¾ï¼éè¿è¿ä¸ªé¾ä¼æç»è°ç¨å°æä»¬çä¸å¡ Servletã\n\n\n# Jetty ççº¿ç¨ç­ç¥\n\n\n# ä¼ ç» Selector ç¼ç¨æ¨¡å\n\nå¸¸è§ç NIO ç¼ç¨æè·¯æ¯ï¼å° I/O äºä»¶çä¾¦æµåè¯·æ±çå¤çåå«ç¨ä¸åççº¿ç¨å¤çãå·ä½è¿ç¨æ¯ï¼\n\nå¯å¨ä¸ä¸ªçº¿ç¨ï¼å¨ä¸ä¸ªæ­»å¾ªç¯éä¸æ­å°è°ç¨ select æ¹æ³ï¼æ£æµ Channel ç I/O ç¶æï¼ä¸æ¦ I/O äºä»¶è¾¾å°ï¼æ¯å¦æ°æ®å°±ç»ªï¼å°±æè¯¥ I/O äºä»¶ä»¥åä¸äºæ°æ®åè£æä¸ä¸ª Runnableï¼å° Runnable æ¾å°æ°çº¿ç¨ä¸­å»å¤çã\n\nå¨è¿ä¸ªè¿ç¨ä¸­æç§èè´£ååï¼æä¸¤ä¸ªçº¿ç¨å¨å¹²æ´»ï¼ä¸ä¸ªæ¯ I/O äºä»¶æ£æµçº¿ç¨ï¼å¦ä¸ä¸ªæ¯ I/O äºä»¶å¤ççº¿ç¨ãè¿æ ·çå¥½å¤æ¯å®ä»¬äºä¸å¹²æ°åé»å¡å¯¹æ¹ã\n\n\n# Jetty ç Selector ç¼ç¨æ¨¡å\n\nå° I/O äºä»¶æ£æµåä¸å¡å¤çè¿ä¸¤ç§å·¥ä½åå¼çæè·¯ä¹æç¼ºç¹ï¼å½ Selector æ£æµè¯»å°±ç»ªäºä»¶æ¶ï¼æ°æ®å·²ç»è¢«æ·è´å°åæ ¸ä¸­çç¼å­äºï¼åæ¶ CPU çç¼å­ä¸­ä¹æè¿äºæ°æ®äºï¼æä»¬ç¥é CPU æ¬èº«çç¼å­æ¯åå­å¿«å¤äºï¼è¿æ¶å½åºç¨ç¨åºå»è¯»åè¿äºæ°æ®æ¶ï¼å¦æç¨å¦ä¸ä¸ªçº¿ç¨å»è¯»ï¼å¾æå¯è½è¿ä¸ªè¯»çº¿ç¨ä½¿ç¨å¦ä¸ä¸ª CPU æ ¸ï¼èä¸æ¯ä¹åé£ä¸ªæ£æµæ°æ®å°±ç»ªç CPU æ ¸ï¼è¿æ · CPU ç¼å­ä¸­çæ°æ®å°±ç¨ä¸ä¸äºï¼å¹¶ä¸çº¿ç¨åæ¢ä¹éè¦å¼éã\n\nå æ­¤ Jetty ç Connector åäºä¸ä¸ªå¤§èå°è¯ï¼é£å°±æ¯æ I/O äºä»¶ççäº§åæ¶è´¹æ¾å°åä¸ä¸ªçº¿ç¨æ¥å¤çï¼å¦æè¿ä¸¤ä¸ªä»»å¡ç±åä¸ä¸ªçº¿ç¨æ¥æ§è¡ï¼å¦ææ§è¡è¿ç¨ä¸­çº¿ç¨ä¸é»å¡ï¼æä½ç³»ç»ä¼ç¨åä¸ä¸ª CPU æ ¸æ¥æ§è¡è¿ä¸¤ä¸ªä»»å¡ï¼è¿æ ·å°±è½å©ç¨ CPU ç¼å­äºã\n\n# ManagedSelector\n\nManagedSelector çæ¬è´¨å°±æ¯ä¸ä¸ª Selectorï¼è´è´£ I/O äºä»¶çæ£æµåååãä¸ºäºæ¹ä¾¿ä½¿ç¨ï¼Jetty å¨ Java åçç Selector ä¸åäºä¸äºæ©å±ï¼å°±åæäº ManagedSelectorï¼æä»¬åæ¥ççå®æåªäºæååéï¼\n\npublic class ManagedSelector extends ContainerLifeCycle implements Dumpable\n{\n    // åå­åéï¼è¡¨æå½åç ManagedSelector æ¯å¦å·²ç»å¯å¨\n    private final AtomicBoolean _started = new AtomicBoolean(false);\n\n    // è¡¨ææ¯å¦é»å¡å¨ select è°ç¨ä¸\n    private boolean _selecting = false;\n\n    // ç®¡çå¨çå¼ç¨ï¼SelectorManager ç®¡çè¥å¹² ManagedSelector ççå½å¨æ\n    private final SelectorManager _selectorManager;\n\n    //ManagedSelector ä¸æ­¢ä¸ä¸ªï¼ä¸ºå®ä»¬æ¯äººåéä¸ä¸ª id\n    private final int _id;\n\n    // å³é®çæ§è¡ç­ç¥ï¼çäº§èåæ¶è´¹èæ¯å¦å¨åä¸ä¸ªçº¿ç¨å¤çç±å®å³å®\n    private final ExecutionStrategy _strategy;\n\n    //Java åçç Selector\n    private Selector _selector;\n\n    //"Selector æ´æ°ä»»å¡ " éå\n    private Deque<SelectorUpdate> _updates = new ArrayDeque<>();\n    private Deque<SelectorUpdate> _updateable = new ArrayDeque<>();\n\n    ...\n}\n\n\nè¿äºæååéä¸­å¶ä»çé½å¥½çè§£ï¼å°±æ¯âSelector æ´æ°ä»»å¡âéå_updatesåæ§è¡ç­ç¥_strategyå¯è½ä¸æ¯å¾ç´è§ã\n\n# SelectorUpdate æ¥å£\n\nä¸ºä»ä¹éè¦ä¸ä¸ªâSelector æ´æ°ä»»å¡âéåå¢ï¼å¯¹äº Selector çç¨æ·æ¥è¯´ï¼æä»¬å¯¹ Selector çæä½æ éæ¯å° Channel æ³¨åå° Selector æèåè¯ Selector æå¯¹ä»ä¹ I/O äºä»¶æå´è¶£ï¼é£ä¹è¿äºæä½å¶å®å°±æ¯å¯¹ Selector ç¶æçæ´æ°ï¼Jetty æè¿äºæä½æ½è±¡æ SelectorUpdate æ¥å£ã\n\n/**\n * A selector update to be done when the selector has been woken.\n */\npublic interface SelectorUpdate\n{\n    void update(Selector selector);\n}\n\n\nè¿æå³çå¦æä½ ä¸è½ç´æ¥æä½ ManageSelector ä¸­ç Selectorï¼èæ¯éè¦å ManagedSelector æäº¤ä¸ä¸ªä»»å¡ç±»ï¼è¿ä¸ªç±»éè¦å®ç° SelectorUpdate æ¥å£ update æ¹æ³ï¼å¨ update æ¹æ³éå®ä¹ä½ æ³è¦å¯¹ ManagedSelector åçæä½ã\n\næ¯å¦ Connector ä¸­ Endpoint ç»ä»¶å¯¹è¯»å°±ç»ªäºä»¶æå´è¶£ï¼å®å°±å ManagedSelector æäº¤äºä¸ä¸ªåé¨ä»»å¡ç±» ManagedSelector.SelectorUpdateï¼\n\n_selector.submit(_updateKeyAction);\n\n\nè¿ä¸ª_updateKeyActionå°±æ¯ä¸ä¸ª SelectorUpdate å®ä¾ï¼å®ç update æ¹æ³å®ç°å¦ä¸ï¼\n\nprivate final ManagedSelector.SelectorUpdate _updateKeyAction = new ManagedSelector.SelectorUpdate()\n{\n    @Override\n    public void update(Selector selector)\n    {\n        // è¿éç updateKey å¶å®å°±æ¯è°ç¨äº SelectionKey.interestOps(OP_READ);\n        updateKey();\n    }\n};\n\n\næä»¬çå°å¨ update æ¹æ³éï¼è°ç¨äº SelectionKey ç±»ç interestOps æ¹æ³ï¼ä¼ å¥çåæ°æ¯OP_READï¼æææ¯ç°å¨æå¯¹è¿ä¸ª Channel ä¸çè¯»å°±ç»ªäºä»¶æå´è¶£äºã\n\né£è°æ¥è´è´£æ§è¡è¿äº update æ¹æ³å¢ï¼ç­æ¡æ¯ ManagedSelector èªå·±ï¼å®å¨ä¸ä¸ªæ­»å¾ªç¯éæåè¿äº SelectorUpdate ä»»å¡ç±»éä¸ªæ§è¡ã\n\n# Selectable æ¥å£\n\né£ I/O äºä»¶å°è¾¾æ¶ï¼ManagedSelector æä¹ç¥éåºè¯¥è°åªä¸ªå½æ°æ¥å¤çå¢ï¼å¶å®ä¹æ¯éè¿ä¸ä¸ªä»»å¡ç±»æ¥å£ï¼è¿ä¸ªæ¥å£å°±æ¯ Selectableï¼å®è¿åä¸ä¸ª Runnableï¼è¿ä¸ª Runnable å¶å®å°±æ¯ I/O äºä»¶å°±ç»ªæ¶ç¸åºçå¤çé»è¾ã\n\npublic interface Selectable\n{\n    // å½æä¸ä¸ª Channel ç I/O äºä»¶å°±ç»ªåï¼ManagedSelector ä¼è°ç¨çåè°å½æ°\n    Runnable onSelected();\n\n    // å½ææäºä»¶å¤çå®äºä¹å ManagedSelector ä¼è°çåè°å½æ°ï¼æä»¬åå¿½ç¥ã\n    void updateKey();\n}\n\n\nManagedSelector å¨æ£æµå°æä¸ª Channel ä¸ç I/O äºä»¶å°±ç»ªæ¶ï¼ä¹å°±æ¯è¯´è¿ä¸ª Channel è¢«éä¸­äºï¼ManagedSelector è°ç¨è¿ä¸ª Channel æç»å®çéä»¶ç±»ç onSelected æ¹æ³æ¥æ¿å°ä¸ä¸ª Runnableã\n\nè¿å¥è¯æç¹ç»ï¼å¶å®å°±æ¯ ManagedSelector çä½¿ç¨èï¼æ¯å¦ Endpoint ç»ä»¶å¨å ManagedSelector æ³¨åè¯»å°±ç»ªäºä»¶æ¶ï¼åæ¶ä¹è¦åè¯ ManagedSelector å¨äºä»¶å°±ç»ªæ¶æ§è¡ä»ä¹ä»»å¡ï¼å·ä½æ¥è¯´å°±æ¯ä¼ å¥ä¸ä¸ªéä»¶ç±»ï¼è¿ä¸ªéä»¶ç±»éè¦å®ç° Selectable æ¥å£ãManagedSelector éè¿è°ç¨è¿ä¸ª onSelected æ¿å°ä¸ä¸ª Runnableï¼ç¶åæ Runnable æç»çº¿ç¨æ± å»æ§è¡ã\n\né£ Endpoint ç onSelected æ¯å¦ä½å®ç°çå¢ï¼\n\n@Override\npublic Runnable onSelected()\n{\n    int readyOps = _key.readyOps();\n\n    boolean fillable = (readyOps & SelectionKey.OP_READ) != 0;\n    boolean flushable = (readyOps & SelectionKey.OP_WRITE) != 0;\n\n    // return task to complete the job\n    Runnable task= fillable\n            ? (flushable\n                    ? _runCompleteWriteFillable\n                    : _runFillable)\n            : (flushable\n                    ? _runCompleteWrite\n                    : null);\n\n    return task;\n}\n\n\nä¸é¢çä»£ç é»è¾å¾ç®åï¼å°±æ¯è¯»äºä»¶å°äºå°±è¯»ï¼åäºä»¶å°äºå°±åã\n\n# ExecutionStrategy\n\néºå«äºè¿ä¹å¤ï¼ç»äºè¦ä¸ä¸»èäºãåé¢æä¸»è¦ä»ç»äº ManagedSelector çä½¿ç¨èå¦ä½è· ManagedSelector äº¤äºï¼ä¹å°±æ¯å¦ä½æ³¨å Channel ä»¥å I/O äºä»¶ï¼æä¾ä»ä¹æ ·çå¤çç±»æ¥å¤ç I/O äºä»¶ï¼æ¥ä¸æ¥æä»¬æ¥çç ManagedSelector æ¯å¦ä½ç»ä¸ç®¡çåç»´æ¤ç¨æ·æ³¨åç Channel éåãååå°ä»å¤©å¼å§çè®¨è®ºï¼ManagedSelector å° I/O äºä»¶ççäº§åæ¶è´¹çä½æ¯çäº§èæ¶è´¹èæ¨¡å¼ï¼ä¸ºäºååå©ç¨ CPU ç¼å­ï¼çäº§åæ¶è´¹å°½éæ¾å°åä¸ä¸ªçº¿ç¨å¤çï¼é£è¿æ¯å¦ä½å®ç°çå¢ï¼Jetty å®ä¹äº ExecutionStrategy æ¥å£ï¼\n\npublic interface ExecutionStrategy\n{\n    // åªå¨ HTTP2 ä¸­ç¨å°ï¼ç®åèµ·è§ï¼æä»¬åå¿½ç¥è¿ä¸ªæ¹æ³ã\n    public void dispatch();\n\n    // å®ç°å·ä½æ§è¡ç­ç¥ï¼ä»»å¡çäº§åºæ¥åå¯è½ç±å½åçº¿ç¨æ§è¡ï¼ä¹å¯è½ç±æ°çº¿ç¨æ¥æ§è¡\n    public void produce();\n\n    // ä»»å¡ççäº§å§æç» Producer åé¨æ¥å£ï¼\n    public interface Producer\n    {\n        // çäº§ä¸ä¸ª Runnable(ä»»å¡)\n        Runnable produce();\n    }\n}\n\n\næä»¬çå° ExecutionStrategy æ¥å£æ¯è¾ç®åï¼å®å°å·ä½ä»»å¡ççäº§å§æåé¨æ¥å£ Producerï¼èå¨èªå·±ç produce æ¹æ³éæ¥å®ç°å·ä½æ§è¡é»è¾ï¼ä¹å°±æ¯çäº§åºæ¥çä»»å¡è¦ä¹ç±å½åçº¿ç¨æ§è¡ï¼è¦ä¹æ¾å°æ°çº¿ç¨ä¸­æ§è¡ãJetty æä¾äºä¸äºå·ä½ç­ç¥å®ç°ç±»ï¼ProduceConsumeãProduceExecuteConsumeãExecuteProduceConsume å EatWhatYouKillãå®ä»¬çåºå«æ¯ï¼\n\n * ProduceConsumeï¼ä»»å¡çäº§èèªå·±ä¾æ¬¡çäº§åæ§è¡ä»»å¡ï¼å¯¹åºå° NIO éä¿¡æ¨¡åå°±æ¯ç¨ä¸ä¸ªçº¿ç¨æ¥ä¾¦æµåå¤çä¸ä¸ª ManagedSelector ä¸ææç I/O äºä»¶ï¼åé¢ç I/O äºä»¶è¦ç­å¾åé¢ç I/O äºä»¶å¤çå®ï¼æçææ¾ä¸é«ãéè¿å¾æ¥çè§£ï¼å¾ä¸­ç»¿è²è¡¨ç¤ºçäº§ä¸ä¸ªä»»å¡ï¼èè²è¡¨ç¤ºæ§è¡è¿ä¸ªä»»å¡ã\n\n\n\n * ProduceExecuteConsumeï¼ä»»å¡çäº§èå¼å¯æ°çº¿ç¨æ¥è¿è¡ä»»å¡ï¼è¿æ¯å¸åç I/O äºä»¶ä¾¦æµåå¤çç¨ä¸åççº¿ç¨æ¥å¤çï¼ç¼ºç¹æ¯ä¸è½å©ç¨ CPU ç¼å­ï¼å¹¶ä¸çº¿ç¨åæ¢ææ¬é«ãåæ ·æä»¬éè¿ä¸å¼ å¾æ¥çè§£ï¼å¾ä¸­çæ£è²è¡¨ç¤ºçº¿ç¨åæ¢ã\n\n\n\n * ExecuteProduceConsumeï¼ä»»å¡çäº§èèªå·±è¿è¡ä»»å¡ï¼ä½æ¯è¯¥ç­ç¥å¯è½ä¼æ°å»ºä¸ä¸ªæ°çº¿ç¨ä»¥ç»§ç»­çäº§åæ§è¡ä»»å¡ãè¿ç§ç­ç¥ä¹è¢«ç§°ä¸ºâåæä½ æççç©âï¼å®æ¥èªç©çä¼¦çï¼è®¤ä¸ºä¸ä¸ªäººä¸åºè¯¥ææ­»ä»ä¸åæçä¸è¥¿ï¼å¯¹åºçº¿ç¨æ¥è¯´ï¼ä¸åºè¯¥çæèªå·±ä¸æç®è¿è¡çä»»å¡ãå®çä¼ç¹æ¯è½å©ç¨ CPU ç¼å­ï¼ä½æ¯æ½å¨çé®é¢æ¯å¦æå¤ç I/O äºä»¶çä¸å¡ä»£ç æ§è¡æ¶é´è¿é¿ï¼ä¼å¯¼è´çº¿ç¨å¤§éé»å¡åçº¿ç¨é¥¥é¥¿ã\n\n\n\n * EatWhatYouKillï¼è¿æ¯ Jetty å¯¹ ExecuteProduceConsume ç­ç¥çæ¹è¯ï¼å¨çº¿ç¨æ± çº¿ç¨åè¶³çæåµä¸ç­åäº ExecuteProduceConsumeï¼å½ç³»ç»æ¯è¾å¿çº¿ç¨ä¸å¤æ¶ï¼åæ¢æ ProduceExecuteConsume ç­ç¥ãä¸ºä»ä¹è¦è¿ä¹åå¢ï¼åå æ¯ ExecuteProduceConsume æ¯å¨åä¸çº¿ç¨æ§è¡ I/O äºä»¶ççäº§åæ¶è´¹ï¼å®ä½¿ç¨ççº¿ç¨æ¥èª Jetty å¨å±ççº¿ç¨æ± ï¼è¿äºçº¿ç¨æå¯è½è¢«ä¸å¡ä»£ç é»å¡ï¼å¦æé»å¡å¾å¤äºï¼å¨å±çº¿ç¨æ± ä¸­ççº¿ç¨èªç¶å°±ä¸å¤ç¨äºï¼æåçæåµæ¯è¿ I/O äºä»¶çä¾¦æµé½æ²¡æçº¿ç¨å¯ç¨äºï¼ä¼å¯¼è´ Connector æç»æµè§å¨è¯·æ±ãäºæ¯ Jetty åäºä¸ä¸ªä¼åï¼å¨ä½çº¿ç¨æåµä¸ï¼å°±æ§è¡ ProduceExecuteConsume ç­ç¥ï¼I/O ä¾¦æµç¨ä¸é¨ççº¿ç¨å¤çï¼I/O äºä»¶çå¤çæç»çº¿ç¨æ± å¤çï¼å¶å®å°±æ¯æ¾å°çº¿ç¨æ± çéåéæ¢æ¢å¤çã\n\nåæäºè¿å ç§çº¿ç¨ç­ç¥ï¼æä»¬åæ¥çç Jetty æ¯å¦ä½å®ç° ExecutionStrategy æ¥å£çãç­æ¡å¶å®å°±æ¯å®ç° produce æ¥å£çäº§ä»»å¡ï¼ä¸æ¦ä»»å¡çäº§åºæ¥ï¼ExecutionStrategy ä¼è´è´£æ§è¡è¿ä¸ªä»»å¡ã\n\nprivate class SelectorProducer implements ExecutionStrategy.Producer\n{\n    private Set<SelectionKey> _keys = Collections.emptySet();\n    private Iterator<SelectionKey> _cursor = Collections.emptyIterator();\n\n    @Override\n    public Runnable produce()\n    {\n        while (true)\n        {\n            // å¦ä½ Channel éåä¸­æ I/O äºä»¶å°±ç»ªï¼è°ç¨åé¢æå°ç Selectable æ¥å£è·å Runnable, ç´æ¥è¿åç» ExecutionStrategy å»å¤ç\n            Runnable task = processSelected();\n            if (task != null)\n                return task;\n\n           // å¦ææ²¡æ I/O äºä»¶å°±ç»ªï¼å°±å¹²ç¹ææ´»ï¼ççææ²¡æå®¢æ·æäº¤äºæ´æ° Selector çä»»å¡ï¼å°±æ¯ä¸é¢æå°ç SelectorUpdate ä»»å¡ç±»ã\n            processUpdates();\n            updateKeys();\n\n           // ç»§ç»­æ§è¡ select æ¹æ³ï¼ä¾¦æµ I/O å°±ç»ªäºä»¶\n            if (!select())\n                return null;\n        }\n    }\n }\n\n\nSelectorProducer æ¯ ManagedSelector çåé¨ç±»ï¼SelectorProducer å®ç°äº ExecutionStrategy ä¸­ç Producer æ¥å£ä¸­ç produce æ¹æ³ï¼éè¦å ExecutionStrategy è¿åä¸ä¸ª Runnableãå¨è¿ä¸ªæ¹æ³é SelectorProducer ä¸»è¦å¹²äºä¸ä»¶äºæ\n\n 1. å¦æ Channel éåä¸­æ I/O äºä»¶å°±ç»ªï¼è°ç¨åé¢æå°ç Selectable æ¥å£è·å Runnableï¼ç´æ¥è¿åç» ExecutionStrategy å»å¤çã\n 2. å¦ææ²¡æ I/O äºä»¶å°±ç»ªï¼å°±å¹²ç¹ææ´»ï¼ççææ²¡æå®¢æ·æäº¤äºæ´æ° Selector ä¸äºä»¶æ³¨åçä»»å¡ï¼ä¹å°±æ¯ä¸é¢æå°ç SelectorUpdate ä»»å¡ç±»ã\n 3. å¹²å®ææ´»ç»§ç»­æ§è¡ select æ¹æ³ï¼ä¾¦æµ I/O å°±ç»ªäºä»¶ã\n\n\n# åèèµæ\n\n * Jetty å®æ¹ç½å\n * Jetty Github\n * Jetty wiki',normalizedContent:'# jetty å¿«éå¥é¨\n\n\n# jetty ç®ä»\n\njetty æ¯ä»ä¹ï¼\n\njetty æ¯è½»éçº§ç web æå¡å¨å servlet å¼æã\n\nå®çæå¤§ç¹ç¹æ¯ï¼å¯ä»¥å¾æ¹ä¾¿çä½ä¸ºåµå¥å¼æå¡å¨ã\n\nå®æ¯ eclipse çä¸ä¸ªå¼æºé¡¹ç®ãä¸ç¨æçï¼å°±æ¯ä½ å¸¸ç¨çé£ä¸ª eclipseã\n\nå®æ¯ä½¿ç¨ java å¼åçï¼æä»¥å¤©ç¶å¯¹ java æ¯æè¯å¥½ã\n\nå®æ¹ç½å\n\ngithub æºç å°å\n\nä»ä¹æ¯åµå¥å¼æå¡å¨ï¼\n\nä»¥ jetty æ¥è¯´æï¼å°±æ¯åªè¦å¼å¥ jetty ç jar åï¼å¯ä»¥éè¿ç´æ¥è°ç¨å¶ api çæ¹å¼æ¥å¯å¨ web æå¡ã\n\nç¨è¿ tomcatãresin ç­æå¡å¨çæåæ³å¿ä¸ä¼éçé£ä¸å¥å®è£ãéç½®ãé¨ç½²çæµç¨å§ï¼è¿æ¯æºç¹ççãä½¿ç¨ jettyï¼å°±ä¸éè¦è¿äºè¿ç¨äºã\n\njetty éå¸¸éç¨äºé¡¹ç®çå¼åãæµè¯ï¼å ä¸ºéå¸¸å¿«æ·ãå¦ææ³ç¨äºçäº§ç¯å¢ï¼åéè¦è°¨æèèï¼å®ä¸ä¸å®è½åæçç tomcatãresin ç­æå¡å¨ä¸æ ·æ¯æä¼ä¸çº§ java ee çéè¦ã\n\n\n# jetty çä½¿ç¨\n\næè§å¾åµå¥å¼å¯å¨æ¹å¼çä¸ä¸ªå¥½å¤å¨äºï¼å¯ä»¥ç´æ¥è¿è¡é¡¹ç®ï¼æ éæ¯æ¬¡é¨ç½²é½å¾åéç½®æå¡å¨ã\n\njetty çåµå¥å¼å¯å¨ä½¿ç¨æä¸¤ç§æ¹å¼ï¼\n\napi æ¹å¼\n\nmaven æä»¶æ¹å¼\n\n\n# api æ¹å¼\n\næ·»å  maven ä¾èµ\n\n<dependency>\n  <groupid>org.eclipse.jetty</groupid>\n  <artifactid>jetty-webapp</artifactid>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n<dependency>\n  <groupid>org.eclipse.jetty</groupid>\n  <artifactid>jetty-annotations</artifactid>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n<dependency>\n  <groupid>org.eclipse.jetty</groupid>\n  <artifactid>apache-jsp</artifactid>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n<dependency>\n  <groupid>org.eclipse.jetty</groupid>\n  <artifactid>apache-jstl</artifactid>\n  <version>9.3.2.v20150730</version>\n  <scope>test</scope>\n</dependency>\n\n\nå®æ¹çå¯å¨ä»£ç \n\npublic class splitfileserver\n{\n    public static void main( string[] args ) throws exception\n    {\n        // åå»ºserverå¯¹è±¡ï¼å¹¶ç»å®ç«¯å£\n        server server = new server();\n        serverconnector connector = new serverconnector(server);\n        connector.setport(8090);\n        server.setconnectors(new connector[] { connector });\n\n        // åå»ºä¸ä¸æå¥æï¼ç»å®ä¸ä¸æè·¯å¾ãè¿æ ·å¯å¨åçurlå°±ä¼æ¯:http://host:port/context\n        resourcehandler rh0 = new resourcehandler();\n        contexthandler context0 = new contexthandler();\n        context0.setcontextpath("/");\n\n        // ç»å®æµè¯èµæºç®å½ï¼å¨æ¬ä¾çéç½®ç®å½dir0çè·¯å¾æ¯src/test/resources/dir0ï¼\n        file dir0 = maventestingutils.gettestresourcedir("dir0");\n        context0.setbaseresource(resource.newresource(dir0));\n        context0.sethandler(rh0);\n\n        // åä¸é¢çä¾å­ä¸æ ·\n        resourcehandler rh1 = new resourcehandler();\n        contexthandler context1 = new contexthandler();\n        context1.setcontextpath("/");\n        file dir1 = maventestingutils.gettestresourcedir("dir1");\n        context1.setbaseresource(resource.newresource(dir1));\n        context1.sethandler(rh1);\n\n        // ç»å®ä¸¤ä¸ªèµæºå¥æ\n        contexthandlercollection contexts = new contexthandlercollection();\n        contexts.sethandlers(new handler[] { context0, context1 });\n        server.sethandler(contexts);\n\n        // å¯å¨\n        server.start();\n\n        // æå°dumpæ¶çä¿¡æ¯\n        system.out.println(server.dump());\n\n        // joinå½åçº¿ç¨\n        server.join();\n    }\n}\n\n\nç´æ¥è¿è¡ main æ¹æ³ï¼å°±å¯ä»¥å¯å¨ web æå¡ã\n\næ³¨ï¼ä»¥ä¸ä»£ç å¨ eclipse ä¸­è¿è¡æ²¡æé®é¢ï¼å¦ææ³å¨ intellij ä¸­è¿è¡è¿éè¦ä¸ºå®æå®éç½®æä»¶ã\n\nå¦ææ³äºè§£å¨ eclipse å intellij é½è½è¿è¡çéç¨æ¹æ³å¯ä»¥åèæç github ä»£ç ç¤ºä¾ã\n\næçå®ç°ä¹æ¯åè springside çæ¹å¼ã\n\nä»£ç è¡æ°æç¹å¤ï¼ä¸å¨è¿éè´´ä»£ç äºã\n\nå®æ´åèä»£ç \n\n\n# maven æä»¶æ¹å¼\n\nå¦æä½ çæ mavenï¼é£ä¹å®å¨å¤ªç®åäº\n\næ³¨ï¼ maven çæ¬å¿é¡»å¨ 3.3 åä»¥ä¸çæ¬ã\n\n(1) æ·»å  maven æä»¶\n\n<plugin>\n  <groupid>org.eclipse.jetty</groupid>\n  <artifactid>jetty-maven-plugin</artifactid>\n  <version>9.3.12.v20160915</version>\n</plugin>\n\n\n(2) æ§è¡ maven å½ä»¤ï¼\n\nmvn jetty:run\n\n\nè®²çï¼å°±æ¯è¿ä¹ç®åãjetty é»è®¤ä¼ä¸ºä½ åå»ºä¸ä¸ª web æå¡ï¼å°åä¸º 127.0.0.1:8080ã\n\nå½ç¶ï¼ä½ ä¹å¯ä»¥å¨æä»¶ä¸­éç½®ä½ ç webapp ç¯å¢\n\n<plugin>\n  <groupid>org.eclipse.jetty</groupid>\n  <artifactid>jetty-maven-plugin</artifactid>\n  <version>9.3.12.v20160915</version>\n\n  <configuration>\n <webappsourcedirectory>${project.basedir}/src/staticfiles</webappsourcedirectory>\n\n    \x3c!-- éç½®webapp --\x3e\n <webapp>\n   <contextpath>/</contextpath>\n   <descriptor>${project.basedir}/src/over/here/web.xml</descriptor>\n   <jettyenvxml>${project.basedir}/src/over/here/jetty-env.xml</jettyenvxml>\n </webapp>\n\n    \x3c!-- éç½®classes --\x3e\n <classesdirectory>${project.basedir}/somewhere/else</classesdirectory>\n <scanclassespattern>\n   <excludes>\n  <exclude>**/foo.class</exclude>\n   </excludes>\n </scanclassespattern>\n <scantargets>\n   <scantarget>src/mydir</scantarget>\n   <scantarget>src/myfile.txt</scantarget>\n </scantargets>\n\n    \x3c!-- æ«ætargetç®å½ä¸çèµæºæä»¶ --\x3e\n <scantargetpatterns>\n   <scantargetpattern>\n <directory>src/other-resources</directory>\n <includes>\n   <include>**/*.xml</include>\n   <include>**/*.properties</include>\n </includes>\n <excludes>\n   <exclude>**/myspecial.xml</exclude>\n   <exclude>**/myspecial.properties</exclude>\n </excludes>\n   </scantargetpattern>\n </scantargetpatterns>\n  </configuration>\n</plugin>\n\n\nå®æ¹ç»ç jetty-env.xml èä¾\n\n <?xml version="1.0"?>\n <!doctype configure public "-//mort bay consulting//dtd configure//en" "http://jetty.mortbay.org/configure.dtd">\n\n <configure class="org.eclipse.jetty.webapp.webappcontext">\n\n   \x3c!-- add an enventry only valid for this webapp               --\x3e\n   <new id="gargle"  class="org.eclipse.jetty.plus.jndi.enventry">\n     <arg>gargle</arg>\n     <arg type="java.lang.double">100</arg>\n     <arg type="boolean">true</arg>\n   </new>\n\n  \x3c!-- add an override for a global enventry                           --\x3e\n   <new id="wiggle"  class="org.eclipse.jetty.plus.jndi.enventry">\n     <arg>wiggle</arg>\n     <arg type="java.lang.double">55.0</arg>\n     <arg type="boolean">true</arg>\n   </new>\n\n   \x3c!-- an xadatasource                                                --\x3e\n   <new id="mydatasource99" class="org.eclipse.jetty.plus.jndi.resource">\n     <arg>jdbc/mydatasource99</arg>\n     <arg>\n       <new class="com.atomikos.jdbc.simpledatasourcebean">\n         <set name="xadatasourceclassname">org.apache.derby.jdbc.embeddedxadatasource</set>\n         <set name="xadatasourceproperties">databasename=testdb99;createdatabase=create</set>\n         <set name="uniqueresourcename">mydatasource99</set>\n       </new>\n     </arg>\n   </new>\n\n </configure>\n\n\n\n# jetty çæ¶æ\n\n\n# jetty æ¶æç®ä»\n\n\n\njetty server å°±æ¯ç±å¤ä¸ª connectorï¼è¿æ¥å¨ï¼ãå¤ä¸ª handlerï¼å¤çå¨ï¼ï¼ä»¥åä¸ä¸ªçº¿ç¨æ± ç»æã\n\nè· tomcat ä¸æ ·ï¼jetty ä¹æ http æå¡å¨å servlet å®¹å¨çåè½ï¼å æ­¤ jetty ä¸­ç connector ç»ä»¶å handler ç»ä»¶åå«æ¥å®ç°è¿ä¸¤ä¸ªåè½ï¼èè¿ä¸¤ä¸ªç»ä»¶å·¥ä½æ¶æéè¦ççº¿ç¨èµæºé½ç´æ¥ä»ä¸ä¸ªå¨å±çº¿ç¨æ±  threadpool ä¸­è·åã\n\njetty server å¯ä»¥æå¤ä¸ª connector å¨ä¸åçç«¯å£ä¸çå¬å®¢æ·è¯·æ±ï¼èå¯¹äºè¯·æ±å¤çç handler ç»ä»¶ï¼ä¹å¯ä»¥æ ¹æ®å·ä½åºæ¯ä½¿ç¨ä¸åç handlerãè¿æ ·çè®¾è®¡æé«äº jetty ççµæ´»æ§ï¼éè¦æ¯æ servletï¼åå¯ä»¥ä½¿ç¨ servlethandlerï¼éè¦æ¯æ sessionï¼ååå¢å ä¸ä¸ª sessionhandlerãä¹å°±æ¯è¯´æä»¬å¯ä»¥ä¸ä½¿ç¨ servlet æè sessionï¼åªè¦ä¸éç½®è¿ä¸ª handler å°±è¡äºã\n\nä¸ºäºå¯å¨ååè°ä¸é¢çæ ¸å¿ç»ä»¶å·¥ä½ï¼jetty æä¾äºä¸ä¸ª server ç±»æ¥åè¿ä¸ªäºæï¼å®è´è´£åå»ºå¹¶åå§å connectorãhandlerãthreadpool ç»ä»¶ï¼ç¶åè°ç¨ start æ¹æ³å¯å¨å®ä»¬ã\n\n\n# jetty å tomcat æ¶æåºå«\n\nå¯¹æ¯ä¸ä¸ tomcat çæ´ä½æ¶æå¾ï¼ä½ ä¼åç° tomcat å¨æ´ä½ä¸è· jetty å¾ç¸ä¼¼ï¼å®ä»¬çç¬¬ä¸ä¸ªåºå«æ¯ jetty ä¸­æ²¡æ service çæ¦å¿µï¼tomcat ä¸­ç service åè£äºå¤ä¸ªè¿æ¥å¨åä¸ä¸ªå®¹å¨ç»ä»¶ï¼ä¸ä¸ª tomcat å®ä¾å¯ä»¥éç½®å¤ä¸ª serviceï¼ä¸åç service éè¿ä¸åçè¿æ¥å¨çå¬ä¸åçç«¯å£ï¼è jetty ä¸­ connector æ¯è¢«ææ handler å±äº«çã\n\nç¬¬äºä¸ªåºå«æ¯ï¼å¨ tomcat ä¸­æ¯ä¸ªè¿æ¥å¨é½æèªå·±ççº¿ç¨æ± ï¼èå¨ jetty ä¸­ææç connector å±äº«ä¸ä¸ªå¨å±ççº¿ç¨æ± ã\n\n\n# connector ç»ä»¶\n\nè· tomcat ä¸æ ·ï¼connector çä¸»è¦åè½æ¯å¯¹ i/o æ¨¡åååºç¨å±åè®®çå°è£ãi/o æ¨¡åæ¹é¢ï¼ææ°ç jetty 9 çæ¬åªæ¯æ nioï¼å æ­¤ jetty ç connector è®¾è®¡æææ¾ç java nio éä¿¡æ¨¡åççè¿¹ãè³äºåºç¨å±åè®®æ¹é¢ï¼è· tomcat ç processor ä¸æ ·ï¼jetty æ½è±¡åºäº connection ç»ä»¶æ¥å°è£åºç¨å±åè®®çå·®å¼ã\n\næå¡ç«¯å¨ nio éä¿¡ä¸ä¸»è¦å®æäºä¸ä»¶äºæï¼çå¬è¿æ¥ãi/o äºä»¶æ¥è¯¢ä»¥åæ°æ®è¯»åãå æ­¤ jetty è®¾è®¡äºacceptorãselectormanager å connection æ¥åå«åè¿ä¸ä»¶äºæ\n\n# acceptor\n\nacceptor ç¨äºæ¥åè¯·æ±ãè· tomcat ä¸æ ·ï¼jetty ä¹æç¬ç«ç acceptor çº¿ç¨ç»ç¨äºå¤çè¿æ¥è¯·æ±ãå¨ connector çå®ç°ç±» serverconnector ä¸­ï¼æä¸ä¸ª _acceptors çæ°ç»ï¼å¨ connector å¯å¨çæ¶å, ä¼æ ¹æ® _acceptors æ°ç»çé¿åº¦åå»ºå¯¹åºæ°éç acceptorï¼è acceptor çä¸ªæ°å¯ä»¥éç½®ã\n\nfor (int i = 0; i < _acceptors.length; i++)\n{\n  acceptor a = new acceptor(i);\n  getexecutor().execute(a);\n}\n\n\nacceptor æ¯ serverconnector ä¸­çä¸ä¸ªåé¨ç±»ï¼åæ¶ä¹æ¯ä¸ä¸ª runnableï¼acceptor çº¿ç¨æ¯éè¿ getexecutor() å¾å°ççº¿ç¨æ± æ¥æ§è¡çï¼åé¢æå°è¿æ¯ä¸ä¸ªå¨å±ççº¿ç¨æ± ã\n\nacceptor éè¿é»å¡çæ¹å¼æ¥æ¥åè¿æ¥ï¼è¿ä¸ç¹è· tomcat ä¹æ¯ä¸æ ·çã\n\npublic void accept(int acceptorid) throws ioexception\n{\n  serversocketchannel serverchannel = _acceptchannel;\n  if (serverchannel != null && serverchannel.isopen())\n  {\n    // è¿éæ¯é»å¡ç\n    socketchannel channel = serverchannel.accept();\n    // æ§è¡å°è¿éæ¶è¯´ææè¯·æ±è¿æ¥äº\n    accepted(channel);\n  }\n}\n\n\næ¥åè¿æ¥æååä¼è°ç¨ accepted() å½æ°ï¼accepted() å½æ°ä¸­ä¼å° socketchannel è®¾ç½®ä¸ºéé»å¡æ¨¡å¼ï¼ç¶åäº¤ç» selector å»å¤çï¼å æ­¤è¿ä¹å°±å°äº selector çå°çäºã\n\nprivate void accepted(socketchannel channel) throws ioexception\n{\n    channel.configureblocking(false);\n    socket socket = channel.socket();\n    configure(socket);\n    // _manager æ¯ selectormanager å®ä¾ï¼éé¢ç®¡çäºææç selector å®ä¾\n    _manager.accept(channel);\n}\n\n\nselectormanager\n\njetty ç selector ç± selectormanager ç±»ç®¡çï¼èè¢«ç®¡çç selector å«ä½ managedselectorãselectormanager åé¨æä¸ä¸ª managedselector æ°ç»ï¼çæ­£å¹²æ´»çæ¯ managedselectorãå±ä»¬æ¥çä¸é¢åæï¼ççå¨ selectormanager å¨ accept æ¹æ³éåäºä»ä¹ã\n\npublic void accept(selectablechannel channel, object attachment)\n{\n  // éæ©ä¸ä¸ª managedselector æ¥å¤ç channel\n  final managedselector selector = chooseselector();\n  // æäº¤ä¸ä¸ªä»»å¡ accept ç» managedselector\n  selector.submit(selector.new accept(channel, attachment));\n}\n\n\nselectormanager ä»æ¬èº«ç selector æ°ç»ä¸­éæ©ä¸ä¸ª selector æ¥å¤çè¿ä¸ª channelï¼å¹¶åå»ºä¸ä¸ªä»»å¡ accept äº¤ç» managedselectorï¼managedselector å¨å¤çè¿ä¸ªä»»å¡ä¸»è¦åäºä¸¤æ­¥ï¼\n\nç¬¬ä¸æ­¥ï¼è°ç¨ selector ç register æ¹æ³æ channel æ³¨åå° selector ä¸ï¼æ¿å°ä¸ä¸ª selectionkeyã\n\n _key = _channel.register(selector, selectionkey.op_accept, this);\n\n\nç¬¬äºæ­¥ï¼åå»ºä¸ä¸ª endpoint å connectionï¼å¹¶è·è¿ä¸ª selectionkeyï¼channelï¼ç»å¨ä¸èµ·ï¼\n\nprivate void createendpoint(selectablechannel channel, selectionkey selectionkey) throws ioexception\n{\n    //1. åå»º endpoint\n    endpoint endpoint = _selectormanager.newendpoint(channel, this, selectionkey);\n\n    //2. åå»º connection\n    connection connection = _selectormanager.newconnection(channel, endpoint, selectionkey.attachment());\n\n    //3. æ endpointãconnection å selectionkey ç»å¨ä¸èµ·\n    endpoint.setconnection(connection);\n    selectionkey.attach(endpoint);\n\n}\n\n\nè¿ééè¦ä½ ç¹å«æ³¨æçæ¯ï¼managedselector å¹¶æ²¡æç´æ¥è°ç¨ endpoint çæ¹æ³å»å¤çæ°æ®ï¼èæ¯éè¿è°ç¨ endpoint çæ¹æ³è¿åä¸ä¸ª runnableï¼ç¶åæè¿ä¸ª runnable æç»çº¿ç¨æ± æ§è¡ï¼æä»¥ä½ è½çå°ï¼è¿ä¸ª runnable æä¼å»çæ­£è¯»æ°æ®åå¤çè¯·æ±ã\n\nconnection\n\nè¿ä¸ª runnable æ¯ endpoint çä¸ä¸ªåé¨ç±»ï¼å®ä¼è°ç¨ connection çåè°æ¹æ³æ¥å¤çè¯·æ±ãjetty ç connection ç»ä»¶ç±»æ¯å°±æ¯ tomcat ç processorï¼è´è´£å·ä½åè®®çè§£æï¼å¾å° request å¯¹è±¡ï¼å¹¶è°ç¨ handler å®¹å¨è¿è¡å¤çãä¸é¢æç®åä»ç»ä¸ä¸å®çå·ä½å®ç°ç±» httpconnection å¯¹è¯·æ±åååºçå¤çè¿ç¨ã\n\nè¯·æ±å¤çï¼httpconnection å¹¶ä¸ä¼ä¸»å¨å endpoint è¯»åæ°æ®ï¼èæ¯åå¨ endpoint ä¸­æ³¨åä¸å åè°æ¹æ³ï¼\n\ngetendpoint().fillinterested(_readcallback);\n\n\nè¿æ®µä»£ç å°±æ¯åè¯ endpointï¼æ°æ®å°äºä½ å°±è°æè¿äºåè°æ¹æ³ _readcallback å§ï¼æç¹å¼æ­¥ i/o çæè§ï¼ä¹å°±æ¯è¯´ jetty å¨åºç¨å±é¢æ¨¡æäºå¼æ­¥ i/o æ¨¡åã\n\nèå¨åè°æ¹æ³ _readcallback éï¼ä¼è°ç¨ endpoint çæ¥å£å»è¯»æ°æ®ï¼è¯»å®åè®© http è§£æå¨å»è§£æå­èæµï¼http è§£æå¨ä¼å°è§£æåçæ°æ®ï¼åæ¬è¯·æ±è¡ãè¯·æ±å¤´ç¸å³ä¿¡æ¯å­å° request å¯¹è±¡éã\n\nååºå¤çï¼connection è°ç¨ handler è¿è¡ä¸å¡å¤çï¼handler ä¼éè¿ response å¯¹è±¡æ¥æä½ååºæµï¼åæµéé¢åå¥æ°æ®ï¼httpconnection åéè¿ endpoint ææ°æ®åå° channelï¼è¿æ ·ä¸æ¬¡ååºå°±å®æäºã\n\nå°æ­¤ä½ åºè¯¥äºè§£äº connector çå·¥ä½åçï¼ä¸é¢æç»å¼ å¾åæ¥åé¡¾ä¸ä¸ connector çå·¥ä½æµç¨ã\n\n\n\n 1. acceptor çå¬è¿æ¥è¯·æ±ï¼å½æè¿æ¥è¯·æ±å°è¾¾æ¶å°±æ¥åè¿æ¥ï¼ä¸ä¸ªè¿æ¥å¯¹åºä¸ä¸ª channelï¼acceptor å° channel äº¤ç» managedselector æ¥å¤çã\n\n 2. managedselector æ channel æ³¨åå° selector ä¸ï¼å¹¶åå»ºä¸ä¸ª endpoint å connection è·è¿ä¸ª channel ç»å®ï¼æ¥çå°±ä¸æ­å°æ£æµ i/o äºä»¶ã\n\n 3. i/o äºä»¶å°äºå°±è°ç¨ endpoint çæ¹æ³æ¿å°ä¸ä¸ª runnableï¼å¹¶æç»çº¿ç¨æ± æ§è¡ã\n\n 4. çº¿ç¨æ± ä¸­è°åº¦æä¸ªçº¿ç¨æ§è¡ runnableã\n\n 5. runnable æ§è¡æ¶ï¼è°ç¨åè°å½æ°ï¼è¿ä¸ªåè°å½æ°æ¯ connection æ³¨åå° endpoint ä¸­çã\n\n 6. åè°å½æ°åé¨å®ç°ï¼å¶å®å°±æ¯è°ç¨ endpoint çæ¥å£æ¹æ³æ¥è¯»æ°æ®ã\n\n 7. connection è§£æè¯»å°çæ°æ®ï¼çæè¯·æ±å¯¹è±¡å¹¶äº¤ç» handler ç»ä»¶å»å¤çã\n\n\n# handler ç»ä»¶\n\njetty ç handler è®¾è®¡æ¯å®çä¸å¤§ç¹è²ï¼jetty æ¬è´¨å°±æ¯ä¸ä¸ª handler ç®¡çå¨ï¼jetty æ¬èº«å°±æä¾äºä¸äºé»è®¤ handler æ¥å®ç° servlet å®¹å¨çåè½ï¼ä½ ä¹å¯ä»¥å®ä¹èªå·±ç handler æ¥æ·»å å° jetty ä¸­ï¼è¿ä½ç°äºâå¾®åæ ¸ + æä»¶âçè®¾è®¡ææ³ã\n\nhandler å°±æ¯ä¸ä¸ªæ¥å£ï¼å®æä¸å å®ç°ç±»ï¼jetty ç connector ç»ä»¶è°ç¨è¿äºæ¥å£æ¥å¤ç servlet è¯·æ±ã\n\npublic interface handler extends lifecycle, destroyable\n{\n    // å¤çè¯·æ±çæ¹æ³\n    public void handle(string target, request baserequest, httpservletrequest request, httpservletresponse response)\n        throws ioexception, servletexception;\n\n    // æ¯ä¸ª handler é½å³èä¸ä¸ª server ç»ä»¶ï¼è¢« server ç®¡ç\n    public void setserver(server server);\n    public server getserver();\n\n    // éæ¯æ¹æ³ç¸å³çèµæº\n    public void destroy();\n}\n\n\næ¹æ³è¯´æï¼\n\n * handler ç handle æ¹æ³è· tomcat å®¹å¨ç»ä»¶ç service æ¹æ³ä¸æ ·ï¼å®æ servletrequest å serveletresponse ä¸¤ä¸ªåæ°ã\n * å ä¸ºä»»ä½ä¸ä¸ª handler é½éè¦å³èä¸ä¸ª server ç»ä»¶ï¼handler éè¦è¢« server ç»ä»¶æ¥ç®¡çãhandler éè¿ setserver å getserver æ¹æ³ç»å® serverã\n * handler ä¼å è½½ä¸äºèµæºå°åå­ï¼å æ­¤éè¿è®¾ç½® destroy æ¹æ³æ¥éæ¯ã\n\n# handler ç»§æ¿å³ç³»\n\nhandler åªæ¯ä¸ä¸ªæ¥å£ï¼å®æå·ä½åè½çè¿æ¯å®çå­ç±»ãé£ä¹ handler æåªäºå­ç±»å¢ï¼å®ä»¬çç»§æ¿å³ç³»åæ¯ææ ·çï¼è¿äºå­ç±»æ¯å¦ä½å®ç° servlet å®¹å¨åè½çå¢ï¼\n\n\n\nå¨ abstracthandler ä¹ä¸æ abstracthandlercontainerï¼ä¸ºä»ä¹éè¦è¿ä¸ªç±»å¢ï¼è¿å¶å®æ¯ä¸ªè¿æ¸¡ï¼ä¸ºäºå®ç°é¾å¼è°ç¨ï¼ä¸ä¸ª handler åé¨å¿ç¶è¦æå¶ä» handler çå¼ç¨ï¼æä»¥è¿ä¸ªç±»çåå­éææ containerï¼ææå°±æ¯è¿æ ·ç handler éåå«äºå¶ä» handler çå¼ç¨ã\n\nhandlerwrapper å handlercollection é½æ¯ handlerï¼ä½æ¯è¿äº handler éè¿åæ¬å¶ä» handler çå¼ç¨ãä¸åçæ¯ï¼handlerwrapper åªåå«ä¸ä¸ªå¶ä» handler çå¼ç¨ï¼è handlercollection ä¸­æä¸ä¸ª handler æ°ç»çå¼ç¨ã\n\nhandlerwrapper æä¸¤ä¸ªå­ç±»ï¼server å scopedhandlerã\n\n * server æ¯è¾å¥½çè§£ï¼å®æ¬èº«æ¯ handler æ¨¡åçå¥å£ï¼å¿ç¶è¦å°è¯·æ±ä¼ éç»å¶ä» handler æ¥å¤çï¼ä¸ºäºè§¦åå¶ä» handler çè°ç¨ï¼æä»¥å®æ¯ä¸ä¸ª handlerwrapperã\n * scopedhandler ä¹æ¯ä¸ä¸ªæ¯è¾éè¦ç handlerï¼å®ç°äºâå·æä¸ä¸æä¿¡æ¯âçè´£ä»»é¾è°ç¨ãä¸ºä»ä¹æè¦å¼ºè°âå·æä¸ä¸æä¿¡æ¯âå¢ï¼é£æ¯å ä¸º servlet è§èè§å® servlet å¨æ§è¡è¿ç¨ä¸­æ¯æä¸ä¸æçãé£ä¹è¿äº handler å¨æ§è¡è¿ç¨ä¸­å¦ä½è®¿é®è¿ä¸ªä¸ä¸æå¢ï¼è¿ä¸ªä¸ä¸æåå­å¨ä»ä¹å°æ¹å¢ï¼ç­æ¡å°±æ¯éè¿ scopedhandler æ¥å®ç°çã\n\nhandlercollection å¶å®ç»´æ¤äºä¸ä¸ª handler æ°ç»ãè¿æ¯ä¸ºäºåæ¶æ¯æå¤ä¸ª web åºç¨ï¼å¦ææ¯ä¸ª web åºç¨æä¸ä¸ª handler å¥å£ï¼é£ä¹å¤ä¸ª web åºç¨ç handler å°±æäºä¸ä¸ªæ°ç»ï¼æ¯å¦ server ä¸­å°±æä¸ä¸ª handlercollectionï¼server ä¼æ ¹æ®ç¨æ·è¯·æ±ç url ä»æ°ç»ä¸­éåç¸åºç handler æ¥å¤çï¼å°±æ¯éæ©ç¹å®ç web åºç¨æ¥å¤çè¯·æ±ã\n\nhandler å¯ä»¥åæä¸ç§ç±»åï¼\n\n * ç¬¬ä¸ç§æ¯åè° handlerï¼è¿ç§ handler è´è´£å°è¯·æ±è·¯ç±å°ä¸ç» handler ä¸­å»ï¼æ¯å¦ handlercollectionï¼å®åé¨ææä¸ä¸ª handler æ°ç»ï¼å½è¯·æ±å°æ¥æ¶ï¼å®è´è´£å°è¯·æ±è½¬åå°æ°ç»ä¸­çæä¸ä¸ª handlerã\n * ç¬¬äºç§æ¯è¿æ»¤å¨ handlerï¼è¿ç§ handler èªå·±ä¼å¤çè¯·æ±ï¼å¤çå®äºååæè¯·æ±è½¬åå°ä¸ä¸ä¸ª handlerï¼æ¯å¦å¾ä¸ç handlerwrapperï¼å®åé¨ææä¸ä¸ä¸ª handler çå¼ç¨ãéè¦æ³¨æçæ¯ï¼ææç»§æ¿äº handlerwrapper ç handler é½å·æäºè¿æ»¤å¨ handler çç¹å¾ï¼æ¯å¦ contexthandlerãsessionhandler å webappcontext ç­ã\n * ç¬¬ä¸ç§æ¯åå®¹ handlerï¼è¯´ç½äºå°±æ¯è¿äº handler ä¼çæ­£è°ç¨ servlet æ¥å¤çè¯·æ±ï¼çæååºçåå®¹ï¼æ¯å¦ servlethandlerãå¦ææµè§å¨è¯·æ±çæ¯ä¸ä¸ªéæèµæºï¼ä¹æç¸åºç resourcehandler æ¥å¤çè¿ä¸ªè¯·æ±ï¼è¿åéæé¡µé¢ã\n\n# å®ç° servlet è§è\n\nservlethandlerãcontexthandler ä»¥å webappcontext ç­ï¼å®ä»¬å®ç°äº servlet è§èã\n\nservlet è§èä¸­æ contextãservletãfilterãlistener å session ç­ï¼jetty è¦æ¯æ servlet è§èï¼å°±éè¦æç¸åºç handler æ¥åå«å®ç°è¿äºåè½ãå æ­¤ï¼jetty è®¾è®¡äº 3 ä¸ªç»ä»¶ï¼contexthandlerãservlethandler å sessionhandler æ¥å®ç° servle è§èä¸­è§å®çåè½ï¼èwebappcontext æ¬èº«å°±æ¯ä¸ä¸ª contexthandlerï¼å¦å¤å®è¿è´è´£ç®¡ç servlethandler å sessionhandlerã\n\ncontexthandler ä¼åå»ºå¹¶åå§å servlet è§èéç servletcontext å¯¹è±¡ï¼åæ¶ contexthandler è¿åå«äºä¸ç»è½å¤è®©ä½ ç web åºç¨è¿è¡èµ·æ¥ç handlerï¼å¯ä»¥è¿æ ·çè§£ï¼context æ¬èº«ä¹æ¯ä¸ç§ handlerï¼å®éé¢åå«äºå¶ä»ç handlerï¼è¿äº handler è½å¤çæä¸ªç¹å® url ä¸çè¯·æ±ãæ¯å¦ï¼contexthandler åå«äºä¸ä¸ªæèå¤ä¸ª servlethandlerã\n\nservlethandler å®ç°äº servlet è§èä¸­ç servletãfilter å listener çåè½ãservlethandler ä¾èµ filterholderãservletholderãservletmappingãfiltermapping è¿åå¤§ç»ä»¶ãfilterholder å servletholder åå«æ¯ filter å servlet çåè£ç±»ï¼æ¯ä¸ä¸ª servlet ä¸è·¯å¾çæ å°ä¼è¢«å°è£æ servletmappingï¼è filter ä¸æ¦æª url çæ å°ä¼è¢«å°è£æ filtermappingã\n\nsessionhandler ç¨æ¥ç®¡ç sessionãé¤æ­¤ä¹å¤ webappcontext è¿æä¸äºéç¨åè½ç handlerï¼æ¯å¦ securityhandler å gziphandlerï¼åæ ·ä»åå­å¯ä»¥ç¥éè¿äº handler çåè½åå«æ¯å®å¨æ§å¶ååç¼© / è§£åç¼©ã\n\nwebappcontext ä¼å°è¿äº handler æå»ºæä¸ä¸ªæ§è¡é¾ï¼éè¿è¿ä¸ªé¾ä¼æç»è°ç¨å°æä»¬çä¸å¡ servletã\n\n\n# jetty ççº¿ç¨ç­ç¥\n\n\n# ä¼ ç» selector ç¼ç¨æ¨¡å\n\nå¸¸è§ç nio ç¼ç¨æè·¯æ¯ï¼å° i/o äºä»¶çä¾¦æµåè¯·æ±çå¤çåå«ç¨ä¸åççº¿ç¨å¤çãå·ä½è¿ç¨æ¯ï¼\n\nå¯å¨ä¸ä¸ªçº¿ç¨ï¼å¨ä¸ä¸ªæ­»å¾ªç¯éä¸æ­å°è°ç¨ select æ¹æ³ï¼æ£æµ channel ç i/o ç¶æï¼ä¸æ¦ i/o äºä»¶è¾¾å°ï¼æ¯å¦æ°æ®å°±ç»ªï¼å°±æè¯¥ i/o äºä»¶ä»¥åä¸äºæ°æ®åè£æä¸ä¸ª runnableï¼å° runnable æ¾å°æ°çº¿ç¨ä¸­å»å¤çã\n\nå¨è¿ä¸ªè¿ç¨ä¸­æç§èè´£ååï¼æä¸¤ä¸ªçº¿ç¨å¨å¹²æ´»ï¼ä¸ä¸ªæ¯ i/o äºä»¶æ£æµçº¿ç¨ï¼å¦ä¸ä¸ªæ¯ i/o äºä»¶å¤ççº¿ç¨ãè¿æ ·çå¥½å¤æ¯å®ä»¬äºä¸å¹²æ°åé»å¡å¯¹æ¹ã\n\n\n# jetty ç selector ç¼ç¨æ¨¡å\n\nå° i/o äºä»¶æ£æµåä¸å¡å¤çè¿ä¸¤ç§å·¥ä½åå¼çæè·¯ä¹æç¼ºç¹ï¼å½ selector æ£æµè¯»å°±ç»ªäºä»¶æ¶ï¼æ°æ®å·²ç»è¢«æ·è´å°åæ ¸ä¸­çç¼å­äºï¼åæ¶ cpu çç¼å­ä¸­ä¹æè¿äºæ°æ®äºï¼æä»¬ç¥é cpu æ¬èº«çç¼å­æ¯åå­å¿«å¤äºï¼è¿æ¶å½åºç¨ç¨åºå»è¯»åè¿äºæ°æ®æ¶ï¼å¦æç¨å¦ä¸ä¸ªçº¿ç¨å»è¯»ï¼å¾æå¯è½è¿ä¸ªè¯»çº¿ç¨ä½¿ç¨å¦ä¸ä¸ª cpu æ ¸ï¼èä¸æ¯ä¹åé£ä¸ªæ£æµæ°æ®å°±ç»ªç cpu æ ¸ï¼è¿æ · cpu ç¼å­ä¸­çæ°æ®å°±ç¨ä¸ä¸äºï¼å¹¶ä¸çº¿ç¨åæ¢ä¹éè¦å¼éã\n\nå æ­¤ jetty ç connector åäºä¸ä¸ªå¤§èå°è¯ï¼é£å°±æ¯æ i/o äºä»¶ççäº§åæ¶è´¹æ¾å°åä¸ä¸ªçº¿ç¨æ¥å¤çï¼å¦æè¿ä¸¤ä¸ªä»»å¡ç±åä¸ä¸ªçº¿ç¨æ¥æ§è¡ï¼å¦ææ§è¡è¿ç¨ä¸­çº¿ç¨ä¸é»å¡ï¼æä½ç³»ç»ä¼ç¨åä¸ä¸ª cpu æ ¸æ¥æ§è¡è¿ä¸¤ä¸ªä»»å¡ï¼è¿æ ·å°±è½å©ç¨ cpu ç¼å­äºã\n\n# managedselector\n\nmanagedselector çæ¬è´¨å°±æ¯ä¸ä¸ª selectorï¼è´è´£ i/o äºä»¶çæ£æµåååãä¸ºäºæ¹ä¾¿ä½¿ç¨ï¼jetty å¨ java åçç selector ä¸åäºä¸äºæ©å±ï¼å°±åæäº managedselectorï¼æä»¬åæ¥ççå®æåªäºæååéï¼\n\npublic class managedselector extends containerlifecycle implements dumpable\n{\n    // åå­åéï¼è¡¨æå½åç managedselector æ¯å¦å·²ç»å¯å¨\n    private final atomicboolean _started = new atomicboolean(false);\n\n    // è¡¨ææ¯å¦é»å¡å¨ select è°ç¨ä¸\n    private boolean _selecting = false;\n\n    // ç®¡çå¨çå¼ç¨ï¼selectormanager ç®¡çè¥å¹² managedselector ççå½å¨æ\n    private final selectormanager _selectormanager;\n\n    //managedselector ä¸æ­¢ä¸ä¸ªï¼ä¸ºå®ä»¬æ¯äººåéä¸ä¸ª id\n    private final int _id;\n\n    // å³é®çæ§è¡ç­ç¥ï¼çäº§èåæ¶è´¹èæ¯å¦å¨åä¸ä¸ªçº¿ç¨å¤çç±å®å³å®\n    private final executionstrategy _strategy;\n\n    //java åçç selector\n    private selector _selector;\n\n    //"selector æ´æ°ä»»å¡ " éå\n    private deque<selectorupdate> _updates = new arraydeque<>();\n    private deque<selectorupdate> _updateable = new arraydeque<>();\n\n    ...\n}\n\n\nè¿äºæååéä¸­å¶ä»çé½å¥½çè§£ï¼å°±æ¯âselector æ´æ°ä»»å¡âéå_updatesåæ§è¡ç­ç¥_strategyå¯è½ä¸æ¯å¾ç´è§ã\n\n# selectorupdate æ¥å£\n\nä¸ºä»ä¹éè¦ä¸ä¸ªâselector æ´æ°ä»»å¡âéåå¢ï¼å¯¹äº selector çç¨æ·æ¥è¯´ï¼æä»¬å¯¹ selector çæä½æ éæ¯å° channel æ³¨åå° selector æèåè¯ selector æå¯¹ä»ä¹ i/o äºä»¶æå´è¶£ï¼é£ä¹è¿äºæä½å¶å®å°±æ¯å¯¹ selector ç¶æçæ´æ°ï¼jetty æè¿äºæä½æ½è±¡æ selectorupdate æ¥å£ã\n\n/**\n * a selector update to be done when the selector has been woken.\n */\npublic interface selectorupdate\n{\n    void update(selector selector);\n}\n\n\nè¿æå³çå¦æä½ ä¸è½ç´æ¥æä½ manageselector ä¸­ç selectorï¼èæ¯éè¦å managedselector æäº¤ä¸ä¸ªä»»å¡ç±»ï¼è¿ä¸ªç±»éè¦å®ç° selectorupdate æ¥å£ update æ¹æ³ï¼å¨ update æ¹æ³éå®ä¹ä½ æ³è¦å¯¹ managedselector åçæä½ã\n\næ¯å¦ connector ä¸­ endpoint ç»ä»¶å¯¹è¯»å°±ç»ªäºä»¶æå´è¶£ï¼å®å°±å managedselector æäº¤äºä¸ä¸ªåé¨ä»»å¡ç±» managedselector.selectorupdateï¼\n\n_selector.submit(_updatekeyaction);\n\n\nè¿ä¸ª_updatekeyactionå°±æ¯ä¸ä¸ª selectorupdate å®ä¾ï¼å®ç update æ¹æ³å®ç°å¦ä¸ï¼\n\nprivate final managedselector.selectorupdate _updatekeyaction = new managedselector.selectorupdate()\n{\n    @override\n    public void update(selector selector)\n    {\n        // è¿éç updatekey å¶å®å°±æ¯è°ç¨äº selectionkey.interestops(op_read);\n        updatekey();\n    }\n};\n\n\næä»¬çå°å¨ update æ¹æ³éï¼è°ç¨äº selectionkey ç±»ç interestops æ¹æ³ï¼ä¼ å¥çåæ°æ¯op_readï¼æææ¯ç°å¨æå¯¹è¿ä¸ª channel ä¸çè¯»å°±ç»ªäºä»¶æå´è¶£äºã\n\né£è°æ¥è´è´£æ§è¡è¿äº update æ¹æ³å¢ï¼ç­æ¡æ¯ managedselector èªå·±ï¼å®å¨ä¸ä¸ªæ­»å¾ªç¯éæåè¿äº selectorupdate ä»»å¡ç±»éä¸ªæ§è¡ã\n\n# selectable æ¥å£\n\né£ i/o äºä»¶å°è¾¾æ¶ï¼managedselector æä¹ç¥éåºè¯¥è°åªä¸ªå½æ°æ¥å¤çå¢ï¼å¶å®ä¹æ¯éè¿ä¸ä¸ªä»»å¡ç±»æ¥å£ï¼è¿ä¸ªæ¥å£å°±æ¯ selectableï¼å®è¿åä¸ä¸ª runnableï¼è¿ä¸ª runnable å¶å®å°±æ¯ i/o äºä»¶å°±ç»ªæ¶ç¸åºçå¤çé»è¾ã\n\npublic interface selectable\n{\n    // å½æä¸ä¸ª channel ç i/o äºä»¶å°±ç»ªåï¼managedselector ä¼è°ç¨çåè°å½æ°\n    runnable onselected();\n\n    // å½ææäºä»¶å¤çå®äºä¹å managedselector ä¼è°çåè°å½æ°ï¼æä»¬åå¿½ç¥ã\n    void updatekey();\n}\n\n\nmanagedselector å¨æ£æµå°æä¸ª channel ä¸ç i/o äºä»¶å°±ç»ªæ¶ï¼ä¹å°±æ¯è¯´è¿ä¸ª channel è¢«éä¸­äºï¼managedselector è°ç¨è¿ä¸ª channel æç»å®çéä»¶ç±»ç onselected æ¹æ³æ¥æ¿å°ä¸ä¸ª runnableã\n\nè¿å¥è¯æç¹ç»ï¼å¶å®å°±æ¯ managedselector çä½¿ç¨èï¼æ¯å¦ endpoint ç»ä»¶å¨å managedselector æ³¨åè¯»å°±ç»ªäºä»¶æ¶ï¼åæ¶ä¹è¦åè¯ managedselector å¨äºä»¶å°±ç»ªæ¶æ§è¡ä»ä¹ä»»å¡ï¼å·ä½æ¥è¯´å°±æ¯ä¼ å¥ä¸ä¸ªéä»¶ç±»ï¼è¿ä¸ªéä»¶ç±»éè¦å®ç° selectable æ¥å£ãmanagedselector éè¿è°ç¨è¿ä¸ª onselected æ¿å°ä¸ä¸ª runnableï¼ç¶åæ runnable æç»çº¿ç¨æ± å»æ§è¡ã\n\né£ endpoint ç onselected æ¯å¦ä½å®ç°çå¢ï¼\n\n@override\npublic runnable onselected()\n{\n    int readyops = _key.readyops();\n\n    boolean fillable = (readyops & selectionkey.op_read) != 0;\n    boolean flushable = (readyops & selectionkey.op_write) != 0;\n\n    // return task to complete the job\n    runnable task= fillable\n            ? (flushable\n                    ? _runcompletewritefillable\n                    : _runfillable)\n            : (flushable\n                    ? _runcompletewrite\n                    : null);\n\n    return task;\n}\n\n\nä¸é¢çä»£ç é»è¾å¾ç®åï¼å°±æ¯è¯»äºä»¶å°äºå°±è¯»ï¼åäºä»¶å°äºå°±åã\n\n# executionstrategy\n\néºå«äºè¿ä¹å¤ï¼ç»äºè¦ä¸ä¸»èäºãåé¢æä¸»è¦ä»ç»äº managedselector çä½¿ç¨èå¦ä½è· managedselector äº¤äºï¼ä¹å°±æ¯å¦ä½æ³¨å channel ä»¥å i/o äºä»¶ï¼æä¾ä»ä¹æ ·çå¤çç±»æ¥å¤ç i/o äºä»¶ï¼æ¥ä¸æ¥æä»¬æ¥çç managedselector æ¯å¦ä½ç»ä¸ç®¡çåç»´æ¤ç¨æ·æ³¨åç channel éåãååå°ä»å¤©å¼å§çè®¨è®ºï¼managedselector å° i/o äºä»¶ççäº§åæ¶è´¹çä½æ¯çäº§èæ¶è´¹èæ¨¡å¼ï¼ä¸ºäºååå©ç¨ cpu ç¼å­ï¼çäº§åæ¶è´¹å°½éæ¾å°åä¸ä¸ªçº¿ç¨å¤çï¼é£è¿æ¯å¦ä½å®ç°çå¢ï¼jetty å®ä¹äº executionstrategy æ¥å£ï¼\n\npublic interface executionstrategy\n{\n    // åªå¨ http2 ä¸­ç¨å°ï¼ç®åèµ·è§ï¼æä»¬åå¿½ç¥è¿ä¸ªæ¹æ³ã\n    public void dispatch();\n\n    // å®ç°å·ä½æ§è¡ç­ç¥ï¼ä»»å¡çäº§åºæ¥åå¯è½ç±å½åçº¿ç¨æ§è¡ï¼ä¹å¯è½ç±æ°çº¿ç¨æ¥æ§è¡\n    public void produce();\n\n    // ä»»å¡ççäº§å§æç» producer åé¨æ¥å£ï¼\n    public interface producer\n    {\n        // çäº§ä¸ä¸ª runnable(ä»»å¡)\n        runnable produce();\n    }\n}\n\n\næä»¬çå° executionstrategy æ¥å£æ¯è¾ç®åï¼å®å°å·ä½ä»»å¡ççäº§å§æåé¨æ¥å£ producerï¼èå¨èªå·±ç produce æ¹æ³éæ¥å®ç°å·ä½æ§è¡é»è¾ï¼ä¹å°±æ¯çäº§åºæ¥çä»»å¡è¦ä¹ç±å½åçº¿ç¨æ§è¡ï¼è¦ä¹æ¾å°æ°çº¿ç¨ä¸­æ§è¡ãjetty æä¾äºä¸äºå·ä½ç­ç¥å®ç°ç±»ï¼produceconsumeãproduceexecuteconsumeãexecuteproduceconsume å eatwhatyoukillãå®ä»¬çåºå«æ¯ï¼\n\n * produceconsumeï¼ä»»å¡çäº§èèªå·±ä¾æ¬¡çäº§åæ§è¡ä»»å¡ï¼å¯¹åºå° nio éä¿¡æ¨¡åå°±æ¯ç¨ä¸ä¸ªçº¿ç¨æ¥ä¾¦æµåå¤çä¸ä¸ª managedselector ä¸ææç i/o äºä»¶ï¼åé¢ç i/o äºä»¶è¦ç­å¾åé¢ç i/o äºä»¶å¤çå®ï¼æçææ¾ä¸é«ãéè¿å¾æ¥çè§£ï¼å¾ä¸­ç»¿è²è¡¨ç¤ºçäº§ä¸ä¸ªä»»å¡ï¼èè²è¡¨ç¤ºæ§è¡è¿ä¸ªä»»å¡ã\n\n\n\n * produceexecuteconsumeï¼ä»»å¡çäº§èå¼å¯æ°çº¿ç¨æ¥è¿è¡ä»»å¡ï¼è¿æ¯å¸åç i/o äºä»¶ä¾¦æµåå¤çç¨ä¸åççº¿ç¨æ¥å¤çï¼ç¼ºç¹æ¯ä¸è½å©ç¨ cpu ç¼å­ï¼å¹¶ä¸çº¿ç¨åæ¢ææ¬é«ãåæ ·æä»¬éè¿ä¸å¼ å¾æ¥çè§£ï¼å¾ä¸­çæ£è²è¡¨ç¤ºçº¿ç¨åæ¢ã\n\n\n\n * executeproduceconsumeï¼ä»»å¡çäº§èèªå·±è¿è¡ä»»å¡ï¼ä½æ¯è¯¥ç­ç¥å¯è½ä¼æ°å»ºä¸ä¸ªæ°çº¿ç¨ä»¥ç»§ç»­çäº§åæ§è¡ä»»å¡ãè¿ç§ç­ç¥ä¹è¢«ç§°ä¸ºâåæä½ æççç©âï¼å®æ¥èªç©çä¼¦çï¼è®¤ä¸ºä¸ä¸ªäººä¸åºè¯¥ææ­»ä»ä¸åæçä¸è¥¿ï¼å¯¹åºçº¿ç¨æ¥è¯´ï¼ä¸åºè¯¥çæèªå·±ä¸æç®è¿è¡çä»»å¡ãå®çä¼ç¹æ¯è½å©ç¨ cpu ç¼å­ï¼ä½æ¯æ½å¨çé®é¢æ¯å¦æå¤ç i/o äºä»¶çä¸å¡ä»£ç æ§è¡æ¶é´è¿é¿ï¼ä¼å¯¼è´çº¿ç¨å¤§éé»å¡åçº¿ç¨é¥¥é¥¿ã\n\n\n\n * eatwhatyoukillï¼è¿æ¯ jetty å¯¹ executeproduceconsume ç­ç¥çæ¹è¯ï¼å¨çº¿ç¨æ± çº¿ç¨åè¶³çæåµä¸ç­åäº executeproduceconsumeï¼å½ç³»ç»æ¯è¾å¿çº¿ç¨ä¸å¤æ¶ï¼åæ¢æ produceexecuteconsume ç­ç¥ãä¸ºä»ä¹è¦è¿ä¹åå¢ï¼åå æ¯ executeproduceconsume æ¯å¨åä¸çº¿ç¨æ§è¡ i/o äºä»¶ççäº§åæ¶è´¹ï¼å®ä½¿ç¨ççº¿ç¨æ¥èª jetty å¨å±ççº¿ç¨æ± ï¼è¿äºçº¿ç¨æå¯è½è¢«ä¸å¡ä»£ç é»å¡ï¼å¦æé»å¡å¾å¤äºï¼å¨å±çº¿ç¨æ± ä¸­ççº¿ç¨èªç¶å°±ä¸å¤ç¨äºï¼æåçæåµæ¯è¿ i/o äºä»¶çä¾¦æµé½æ²¡æçº¿ç¨å¯ç¨äºï¼ä¼å¯¼è´ connector æç»æµè§å¨è¯·æ±ãäºæ¯ jetty åäºä¸ä¸ªä¼åï¼å¨ä½çº¿ç¨æåµä¸ï¼å°±æ§è¡ produceexecuteconsume ç­ç¥ï¼i/o ä¾¦æµç¨ä¸é¨ççº¿ç¨å¤çï¼i/o äºä»¶çå¤çæç»çº¿ç¨æ± å¤çï¼å¶å®å°±æ¯æ¾å°çº¿ç¨æ± çéåéæ¢æ¢å¤çã\n\nåæäºè¿å ç§çº¿ç¨ç­ç¥ï¼æä»¬åæ¥çç jetty æ¯å¦ä½å®ç° executionstrategy æ¥å£çãç­æ¡å¶å®å°±æ¯å®ç° produce æ¥å£çäº§ä»»å¡ï¼ä¸æ¦ä»»å¡çäº§åºæ¥ï¼executionstrategy ä¼è´è´£æ§è¡è¿ä¸ªä»»å¡ã\n\nprivate class selectorproducer implements executionstrategy.producer\n{\n    private set<selectionkey> _keys = collections.emptyset();\n    private iterator<selectionkey> _cursor = collections.emptyiterator();\n\n    @override\n    public runnable produce()\n    {\n        while (true)\n        {\n            // å¦ä½ channel éåä¸­æ i/o äºä»¶å°±ç»ªï¼è°ç¨åé¢æå°ç selectable æ¥å£è·å runnable, ç´æ¥è¿åç» executionstrategy å»å¤ç\n            runnable task = processselected();\n            if (task != null)\n                return task;\n\n           // å¦ææ²¡æ i/o äºä»¶å°±ç»ªï¼å°±å¹²ç¹ææ´»ï¼ççææ²¡æå®¢æ·æäº¤äºæ´æ° selector çä»»å¡ï¼å°±æ¯ä¸é¢æå°ç selectorupdate ä»»å¡ç±»ã\n            processupdates();\n            updatekeys();\n\n           // ç»§ç»­æ§è¡ select æ¹æ³ï¼ä¾¦æµ i/o å°±ç»ªäºä»¶\n            if (!select())\n                return null;\n        }\n    }\n }\n\n\nselectorproducer æ¯ managedselector çåé¨ç±»ï¼selectorproducer å®ç°äº executionstrategy ä¸­ç producer æ¥å£ä¸­ç produce æ¹æ³ï¼éè¦å executionstrategy è¿åä¸ä¸ª runnableãå¨è¿ä¸ªæ¹æ³é selectorproducer ä¸»è¦å¹²äºä¸ä»¶äºæ\n\n 1. å¦æ channel éåä¸­æ i/o äºä»¶å°±ç»ªï¼è°ç¨åé¢æå°ç selectable æ¥å£è·å runnableï¼ç´æ¥è¿åç» executionstrategy å»å¤çã\n 2. å¦ææ²¡æ i/o äºä»¶å°±ç»ªï¼å°±å¹²ç¹ææ´»ï¼ççææ²¡æå®¢æ·æäº¤äºæ´æ° selector ä¸äºä»¶æ³¨åçä»»å¡ï¼ä¹å°±æ¯ä¸é¢æå°ç selectorupdate ä»»å¡ç±»ã\n 3. å¹²å®ææ´»ç»§ç»­æ§è¡ select æ¹æ³ï¼ä¾¦æµ i/o å°±ç»ªäºä»¶ã\n\n\n# åèèµæ\n\n * jetty å®æ¹ç½å\n * jetty github\n * jetty wiki',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java æå¡å¨",frontmatter:{title:"Java æå¡å¨",categories:["ç¼ç¨","Java","æå¡å¨"],tags:["Java","JavaWeb","æå¡å¨"],hidden:!0,abbrlink:"c34dbf07",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/9d17ce/"},regularPath:"/02.JavaEE/02.%E6%9C%8D%E5%8A%A1%E5%99%A8/",relativePath:"02.JavaEE/02.æå¡å¨/README.md",key:"v-b09ed4f4",path:"/pages/9d17ce/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:15},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:108},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:210}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# Java æå¡å¨\n\n\n# ð åå®¹\n\n * Tomcat å¿«éå¥é¨\n * Tomcat è¿æ¥å¨\n * Tomcat å®¹å¨\n * Tomcat ä¼å\n * Tomcat å Jetty\n * Jetty\n\n\n# ð èµæ\n\n * Tomcat å®ç½\n * Jetty å®ç½\n * Jetty Github\n * Nginx å®ç½\n * Nginx çä¸­æç»´åº\n * æ·±å¥æè§£ Tomcat & Jetty\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java æå¡å¨\n\n\n# ð åå®¹\n\n * tomcat å¿«éå¥é¨\n * tomcat è¿æ¥å¨\n * tomcat å®¹å¨\n * tomcat ä¼å\n * tomcat å jetty\n * jetty\n\n\n# ð èµæ\n\n * tomcat å®ç½\n * jetty å®ç½\n * jetty github\n * nginx å®ç½\n * nginx çä¸­æç»´åº\n * æ·±å¥æè§£ tomcat & jetty\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaEE",frontmatter:{title:"JavaEE",categories:["ç¼ç¨","Java","JavaEE"],tags:["Java","JavaEE"],hidden:!0,abbrlink:"37aa865c",date:"2022-02-18T08:53:11.000Z",permalink:"/pages/ca58e7/"},regularPath:"/02.JavaEE/",relativePath:"02.JavaEE/README.md",key:"v-08c5e54c",path:"/pages/ca58e7/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:13},{level:3,title:"JavaWeb",slug:"javaweb",normalizedTitle:"javaweb",charIndex:23},{level:3,title:"Java æå¡å¨",slug:"java-æå¡å¨",normalizedTitle:"java æå¡å¨",charIndex:155},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:326},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:619}],headersStr:"ð åå®¹ JavaWeb Java æå¡å¨ ð èµæ ðª ä¼ é",content:"# JavaEE\n\n\n# ð åå®¹\n\n\n# JavaWeb\n\n * JavaWeb é¢ç»\n * JavaWeb ä¹ Servlet æå\n * JavaWeb ä¹ Jsp æå\n * JavaWeb ä¹ Filter å Listener\n * JavaWeb ä¹ Cookie å Session\n\n\n# Java æå¡å¨\n\n> Tomcat å Jetty é½æ¯ Java æ¯è¾æµè¡çè½»éçº§æå¡å¨ã\n> \n> Nginx æ¯ç®åææµè¡çååä»£çæå¡å¨ï¼ä¹å¸¸ç¨äºè´è½½åè¡¡ã\n\n * Tomcat å¿«éå¥é¨\n * Tomcat è¿æ¥å¨\n * Tomcat å®¹å¨\n * Tomcat ä¼å\n * Tomcat å Jetty\n * Jetty\n\n\n# ð èµæ\n\n * JavaWeb\n   * ä¹¦ç±\n     * Java Web æ´åå¼åçèå½æ¥\n     * Head First Servlets & JSP\n   * æç¨\n     * æ·±å¥æè§£ Tomcat & Jetty\n     * Servlet æç¨\n     * åå®¢å­å­¤å²èç¼ JavaWeb å­¦ä¹ æ»ç»\n     * JSP æç¨\n * æå¡å¨\n   * Tomcat å®ç½\n   * Jetty å®ç½\n   * Jetty Github\n   * Nginx å®ç½\n   * Nginx çä¸­æç»´åº\n   * æ·±å¥æè§£ Tomcat & Jetty\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# javaee\n\n\n# ð åå®¹\n\n\n# javaweb\n\n * javaweb é¢ç»\n * javaweb ä¹ servlet æå\n * javaweb ä¹ jsp æå\n * javaweb ä¹ filter å listener\n * javaweb ä¹ cookie å session\n\n\n# java æå¡å¨\n\n> tomcat å jetty é½æ¯ java æ¯è¾æµè¡çè½»éçº§æå¡å¨ã\n> \n> nginx æ¯ç®åææµè¡çååä»£çæå¡å¨ï¼ä¹å¸¸ç¨äºè´è½½åè¡¡ã\n\n * tomcat å¿«éå¥é¨\n * tomcat è¿æ¥å¨\n * tomcat å®¹å¨\n * tomcat ä¼å\n * tomcat å jetty\n * jetty\n\n\n# ð èµæ\n\n * javaweb\n   * ä¹¦ç±\n     * java web æ´åå¼åçèå½æ¥\n     * head first servlets & jsp\n   * æç¨\n     * æ·±å¥æè§£ tomcat & jetty\n     * servlet æç¨\n     * åå®¢å­å­¤å²èç¼ javaweb å­¦ä¹ æ»ç»\n     * jsp æç¨\n * æå¡å¨\n   * tomcat å®ç½\n   * jetty å®ç½\n   * jetty github\n   * nginx å®ç½\n   * nginx çä¸­æç»´åº\n   * æ·±å¥æè§£ tomcat & jetty\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven å¿«éå¥é¨",frontmatter:{title:"Maven å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],abbrlink:"ad26e4b1",date:"2020-02-07T23:04:47.000Z",permalink:"/pages/6b8149/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/01.Maven%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/01.Mavenå¿«éå¥é¨.md",key:"v-8b222c70",path:"/pages/6b8149/",headers:[{level:2,title:"Maven ç®ä»",slug:"maven-ç®ä»",normalizedTitle:"maven ç®ä»",charIndex:17},{level:3,title:"Maven æ¯ä»ä¹",slug:"maven-æ¯ä»ä¹",normalizedTitle:"maven æ¯ä»ä¹",charIndex:30},{level:3,title:"Maven ççå½å¨æ",slug:"maven-ççå½å¨æ",normalizedTitle:"maven ççå½å¨æ",charIndex:448},{level:3,title:"Maven çæ åå·¥ç¨ç»æ",slug:"maven-çæ åå·¥ç¨ç»æ",normalizedTitle:"maven çæ åå·¥ç¨ç»æ",charIndex:704},{level:3,title:'Maven ç"çº¦å®ä¼äºéç½®"',slug:"maven-ç-çº¦å®ä¼äºéç½®",normalizedTitle:"maven ç&quot;çº¦å®ä¼äºéç½®&quot;",charIndex:null},{level:3,title:"Maven ççæ¬è§è",slug:"maven-ççæ¬è§è",normalizedTitle:"maven ççæ¬è§è",charIndex:1212},{level:2,title:"Maven å®è£",slug:"maven-å®è£",normalizedTitle:"maven å®è£",charIndex:2183},{level:3,title:"ç¯å¢åå¤",slug:"ç¯å¢åå¤",normalizedTitle:"ç¯å¢åå¤",charIndex:2304},{level:3,title:"ä¸è½½è§£å",slug:"ä¸è½½è§£å",normalizedTitle:"ä¸è½½è§£å",charIndex:2542},{level:3,title:"ç¯å¢åé",slug:"ç¯å¢åé",normalizedTitle:"ç¯å¢åé",charIndex:2686},{level:4,title:"éç½® Unix ç³»ç»ç¯å¢åé",slug:"éç½®-unix-ç³»ç»ç¯å¢åé",normalizedTitle:"éç½® unix ç³»ç»ç¯å¢åé",charIndex:2729},{level:4,title:"éç½® Windows ç³»ç»ç¯å¢åé",slug:"éç½®-windows-ç³»ç»ç¯å¢åé",normalizedTitle:"éç½® windows ç³»ç»ç¯å¢åé",charIndex:2906},{level:3,title:"æ£æµå®è£æå",slug:"æ£æµå®è£æå",normalizedTitle:"æ£æµå®è£æå",charIndex:2994},{level:3,title:"Maven éç½®æä»¶",slug:"maven-éç½®æä»¶",normalizedTitle:"maven éç½®æä»¶",charIndex:3419},{level:2,title:"å¿«éå¥é¨",slug:"å¿«éå¥é¨",normalizedTitle:"å¿«éå¥é¨",charIndex:8},{level:3,title:"åå»º Maven å·¥ç¨",slug:"åå»º-maven-å·¥ç¨",normalizedTitle:"åå»º maven å·¥ç¨",charIndex:3925},{level:4,title:"åå§åå·¥ç¨",slug:"åå§åå·¥ç¨",normalizedTitle:"åå§åå·¥ç¨",charIndex:3940},{level:4,title:"POM éç½®",slug:"pom-éç½®",normalizedTitle:"pom éç½®",charIndex:4580},{level:4,title:"æå»ºé¡¹ç®",slug:"æå»ºé¡¹ç®",normalizedTitle:"æå»ºé¡¹ç®",charIndex:5361},{level:3,title:"å¨ Intellij ä¸­åå»º Maven å·¥ç¨",slug:"å¨-intellij-ä¸­åå»º-maven-å·¥ç¨",normalizedTitle:"å¨ intellij ä¸­åå»º maven å·¥ç¨",charIndex:5940},{level:3,title:"å¨ Eclipse ä¸­åå»º Maven å·¥ç¨",slug:"å¨-eclipse-ä¸­åå»º-maven-å·¥ç¨",normalizedTitle:"å¨ eclipse ä¸­åå»º maven å·¥ç¨",charIndex:6117},{level:2,title:"ä½¿ç¨è¯´æ",slug:"ä½¿ç¨è¯´æ",normalizedTitle:"ä½¿ç¨è¯´æ",charIndex:6884},{level:3,title:"å¦ä½æ·»å ä¾èµ",slug:"å¦ä½æ·»å ä¾èµ",normalizedTitle:"å¦ä½æ·»å ä¾èµ",charIndex:6893},{level:3,title:"å¦ä½å¯»æ¾ jar å",slug:"å¦ä½å¯»æ¾-jar-å",normalizedTitle:"å¦ä½å¯»æ¾ jar å",charIndex:8222},{level:3,title:"å¦ä½ä½¿ç¨ Maven æä»¶(Plugin)",slug:"å¦ä½ä½¿ç¨-maven-æä»¶-plugin",normalizedTitle:"å¦ä½ä½¿ç¨ maven æä»¶(plugin)",charIndex:8350},{level:3,title:"å¦ä½ä¸æ¬¡ç¼è¯å¤ä¸ªå·¥ç¨",slug:"å¦ä½ä¸æ¬¡ç¼è¯å¤ä¸ªå·¥ç¨",normalizedTitle:"å¦ä½ä¸æ¬¡ç¼è¯å¤ä¸ªå·¥ç¨",charIndex:8761},{level:3,title:"å¸¸ç¨ Maven æä»¶",slug:"å¸¸ç¨-maven-æä»¶",normalizedTitle:"å¸¸ç¨ maven æä»¶",charIndex:9542},{level:4,title:"maven-antrun-plugin",slug:"maven-antrun-plugin",normalizedTitle:"maven-antrun-plugin",charIndex:9602},{level:4,title:"maven-archetype-plugin",slug:"maven-archetype-plugin",normalizedTitle:"maven-archetype-plugin",charIndex:9854},{level:4,title:"maven-assembly-plugin",slug:"maven-assembly-plugin",normalizedTitle:"maven-assembly-plugin",charIndex:10211},{level:4,title:"maven-dependency-plugin",slug:"maven-dependency-plugin",normalizedTitle:"maven-dependency-plugin",charIndex:10531},{level:4,title:"maven-enforcer-plugin",slug:"maven-enforcer-plugin",normalizedTitle:"maven-enforcer-plugin",charIndex:10822},{level:4,title:"maven-help-plugin",slug:"maven-help-plugin",normalizedTitle:"maven-help-plugin",charIndex:11211},{level:4,title:"maven-release-plugin",slug:"maven-release-plugin",normalizedTitle:"maven-release-plugin",charIndex:11643},{level:4,title:"maven-resources-plugin",slug:"maven-resources-plugin",normalizedTitle:"maven-resources-plugin",charIndex:12020},{level:4,title:"maven-surefire-plugin",slug:"maven-surefire-plugin",normalizedTitle:"maven-surefire-plugin",charIndex:12391},{level:4,title:"build-helper-maven-plugin",slug:"build-helper-maven-plugin",normalizedTitle:"build-helper-maven-plugin",charIndex:12747},{level:4,title:"exec-maven-plugin",slug:"exec-maven-plugin",normalizedTitle:"exec-maven-plugin",charIndex:13167},{level:4,title:"jetty-maven-plugin",slug:"jetty-maven-plugin",normalizedTitle:"jetty-maven-plugin",charIndex:13532},{level:4,title:"versions-maven-plugin",slug:"versions-maven-plugin",normalizedTitle:"versions-maven-plugin",charIndex:14047},{level:3,title:"Maven å½ä»¤",slug:"maven-å½ä»¤",normalizedTitle:"maven å½ä»¤",charIndex:6810},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:16004}],headersStr:'Maven ç®ä» Maven æ¯ä»ä¹ Maven ççå½å¨æ Maven çæ åå·¥ç¨ç»æ Maven ç"çº¦å®ä¼äºéç½®" Maven ççæ¬è§è Maven å®è£ ç¯å¢åå¤ ä¸è½½è§£å ç¯å¢åé éç½® Unix ç³»ç»ç¯å¢åé éç½® Windows ç³»ç»ç¯å¢åé æ£æµå®è£æå Maven éç½®æä»¶ å¿«éå¥é¨ åå»º Maven å·¥ç¨ åå§åå·¥ç¨ POM éç½® æå»ºé¡¹ç® å¨ Intellij ä¸­åå»º Maven å·¥ç¨ å¨ Eclipse ä¸­åå»º Maven å·¥ç¨ ä½¿ç¨è¯´æ å¦ä½æ·»å ä¾èµ å¦ä½å¯»æ¾ jar å å¦ä½ä½¿ç¨ Maven æä»¶(Plugin) å¦ä½ä¸æ¬¡ç¼è¯å¤ä¸ªå·¥ç¨ å¸¸ç¨ Maven æä»¶ maven-antrun-plugin maven-archetype-plugin maven-assembly-plugin maven-dependency-plugin maven-enforcer-plugin maven-help-plugin maven-release-plugin maven-resources-plugin maven-surefire-plugin build-helper-maven-plugin exec-maven-plugin jetty-maven-plugin versions-maven-plugin Maven å½ä»¤ åèèµæ',content:'# Maven å¿«éå¥é¨\n\n\n# Maven ç®ä»\n\n\n# Maven æ¯ä»ä¹\n\nMaven æ¯ä¸ä¸ªé¡¹ç®ç®¡çå·¥å·ãå®è´è´£ç®¡çé¡¹ç®å¼åè¿ç¨ä¸­çå ä¹ææçä¸è¥¿ã\n\n * çæ¬ - maven æèªå·±ççæ¬å®ä¹åè§åã\n * æå»º - maven æ¯æè®¸å¤ç§çåºç¨ç¨åºç±»åï¼å¯¹äºæ¯ä¸ç§æ¯æçåºç¨ç¨åºç±»åé½å®ä¹å¥½äºä¸ç»æå»ºè§ååå·¥å·éã\n * è¾åºç©ç®¡ç - maven å¯ä»¥ç®¡çé¡¹ç®æå»ºçäº§ç©ï¼å¹¶å°å¶å å¥å°ç¨æ·åºä¸­ãè¿ä¸ªåè½å¯ä»¥ç¨äºé¡¹ç®ç»åå¶ä»é¨é¨ä¹é´çäº¤ä»è¡ä¸ºã\n * ä¾èµå³ç³» - maven å¯¹ä¾èµå³ç³»çç¹æ§è¿è¡ç»è´çåæåååï¼é¿åå¼åè¿ç¨ä¸­çä¾èµæ··ä¹±åç¸äºæ±¡æè¡ä¸º\n * ææ¡£åæå»ºç»æ - maven ç site å½ä»¤æ¯æåç§ææ¡£ä¿¡æ¯çåå¸ï¼åæ¬æå»ºè¿ç¨çåç§è¾åºï¼javadocï¼äº§åææ¡£ç­ã\n * é¡¹ç®å³ç³» - ä¸ä¸ªå¤§åçé¡¹ç®éå¸¸æå ä¸ªå°é¡¹ç®æèæ¨¡åç»æï¼ç¨ maven å¯ä»¥å¾æ¹ä¾¿å°ç®¡çã\n * ç§»æ¤æ§ç®¡ç - maven å¯ä»¥éå¯¹ä¸åçå¼ååºæ¯ï¼è¾åºä¸åç§ç±»çè¾åºç»æã\n\n\n# Maven ççå½å¨æ\n\nmaven æé¡¹ç®çæå»ºååä¸ºä¸åççå½å¨æ(lifecycle)ãç²ç¥ä¸ç¹çè¯ï¼å®è¿ä¸ªè¿ç¨(phase)åæ¬ï¼ç¼è¯ãæµè¯ãæåãéææµè¯ãéªè¯ãé¨ç½²ãmaven ä¸­ææçæ§è¡å¨ä½(goal)é½éè¦ææèªå·±å¨è¿ä¸ªè¿ç¨ä¸­çæ§è¡ä½ç½®ï¼ç¶å maven æ§è¡çæ¶åï¼å°±ä¾ç§è¿ç¨çåå±ä¾æ¬¡è°ç¨è¿äº goal è¿è¡åç§å¤çã\n\nè¿ä¸ªä¹æ¯ maven çä¸ä¸ªåºæ¬è°åº¦æºå¶ãä¸è¬æ¥è¯´ï¼ä½ç½®ç¨åçè¿ç¨é½ä¼ä¾èµäºä¹åçè¿ç¨ãå½ç¶ï¼maven åæ ·æä¾äºéç½®æä»¶ï¼å¯ä»¥ä¾ç§ç¨æ·è¦æ±ï¼è·³è¿æäºé¶æ®µã\n\n\n# Maven çæ åå·¥ç¨ç»æ\n\nMaven çæ åå·¥ç¨ç»æå¦ä¸ï¼\n\n|-- pom.xml(mavençæ ¸å¿éç½®æä»¶)\n|-- src\n|-- main\n  |-- java(javaæºä»£ç ç®å½)\n  |-- resources(èµæºæä»¶ç®å½)\n|-- test\n    |-- java(ååæµè¯ä»£ç ç®å½)\n|-- target(è¾åºç®å½ï¼ææçè¾åºç©é½å­æ¾å¨è¿ä¸ªç®å½ä¸)\n    |-- classes(ç¼è¯åçclassæä»¶å­æ¾å¤)\n\n\n\n# Maven ç"çº¦å®ä¼äºéç½®"\n\næè°ç"çº¦å®ä¼äºéç½®"ï¼å¨ maven ä¸­å¹¶ä¸æ¯å®å¨ä¸å¯ä»¥ä¿®æ¹çï¼ä»ä»¬åªæ¯ä¸äºéç½®çé»è®¤å¼èå·²ãä½æ¯é¤éå¿è¦ï¼å¹¶ä¸éè¦å»ä¿®æ¹é£äºçº¦å®åå®¹ãmaven é»è®¤çæä»¶å­æ¾ç»æå¦ä¸ï¼\n\næ¯ä¸ä¸ªé¶æ®µçä»»å¡é½ç¥éæä¹æ­£ç¡®å®æèªå·±çå·¥ä½ï¼æ¯å¦ compile ä»»å¡å°±ç¥éä» src/main/java ä¸ç¼è¯ææç java æä»¶ï¼å¹¶æå®çè¾åº class æä»¶å­æ¾å° target/classes ä¸­ã\n\nå¯¹ maven æ¥è¯´ï¼éç¨"çº¦å®ä¼äºéç½®"çç­ç¥å¯ä»¥åå°ä¿®æ¹éç½®çå·¥ä½éï¼ä¹å¯ä»¥éä½å­¦ä¹ ææ¬ï¼æ´éè¦çæ¯ï¼ç»é¡¹ç®å¼å¥äºç»ä¸çè§èã\n\n\n# Maven ççæ¬è§è\n\nmaven ä½¿ç¨å¦ä¸å ä¸ªè¦ç´ æ¥å¯ä¸å®ä½æä¸ä¸ªè¾åºç©ï¼\n\n * groupId - å¢ä½ãç»ç»çæ è¯ç¬¦ãå¢ä½æ è¯ççº¦å®æ¯ï¼å®ä»¥åå»ºè¿ä¸ªé¡¹ç®çç»ç»åç§°çéååå(reverse domain name)å¼å¤´ãä¸è¬å¯¹åºç JAVA çåçç»æãä¾å¦ org.apache\n * artifactId - åç¬é¡¹ç®çå¯ä¸æ è¯ç¬¦ãæ¯å¦æä»¬ç tomcat, commons ç­ãä¸è¦å¨ artifactId ä¸­åå«ç¹å·(.)ã\n * version - ä¸ä¸ªé¡¹ç®çç¹å®çæ¬ã\n * packaging - é¡¹ç®çç±»åï¼é»è®¤æ¯ jarï¼æè¿°äºé¡¹ç®æååçè¾åºãç±»åä¸º jar çé¡¹ç®äº§çä¸ä¸ª JAR æä»¶ï¼ç±»åä¸º war çé¡¹ç®äº§çä¸ä¸ª web åºç¨ã\n\nä¾å¦ï¼æ³å¨ maven å·¥ç¨ä¸­å¼å¥ 4.12 çæ¬ç junit åï¼æ·»å å¦ä¸ä¾èµå³å¯ã\n\n<dependency>\n  <groupId>junit</groupId>\n  <artifactId>junit</artifactId>\n  <version>4.12</version>\n  <scope>compile</scope>\n</dependency>\n\n\nmaven æèªå·±ççæ¬è§èï¼ä¸è¬æ¯å¦ä¸å®ä¹ <major version>ã<minor version>ã<incremental version>-<qualifier> ï¼æ¯å¦ 1.2.3-beta-01ãè¦è¯´æçæ¯ï¼maven èªå·±å¤æ­çæ¬çç®æ³æ¯ major,minor,incremental é¨åç¨æ°å­æ¯ è¾ï¼qualifier é¨åç¨å­ç¬¦ä¸²æ¯è¾ï¼æä»¥è¦å°å¿ alpha-2 å alpha-15 çæ¯è¾å³ç³»ï¼æå¥½ç¨ alpha-02 çæ ¼å¼ã\n\nmaven å¨çæ¬ç®¡çæ¶åå¯ä»¥ä½¿ç¨å ä¸ªç¹æ®çå­ç¬¦ä¸² SNAPSHOTï¼LATESTï¼RELEASEãæ¯å¦"1.0-SNAPSHOT"ãåä¸ªé¨åçå«ä¹åå¤çé»è¾å¦ä¸è¯´æï¼\n\n * SNAPSHOT - è¿ä¸ªçæ¬ä¸è¬ç¨äºå¼åè¿ç¨ä¸­ï¼è¡¨ç¤ºä¸ç¨³å®ççæ¬ã\n * LATEST - ææä¸ªç¹å®æä»¶çææ°åå¸ï¼è¿ä¸ªåå¸å¯è½æ¯ä¸ä¸ªåå¸çï¼ä¹å¯è½æ¯ä¸ä¸ª snapshot çï¼å·ä½çåªä¸ªæ¶é´æåã\n * RELEASE - ææåä¸ä¸ªåå¸çã\n\n\n# Maven å®è£\n\n> Linux ç¯å¢å®è£å¯ä»¥ä½¿ç¨æåä¸é®å®è£èæ¬ï¼https://github.com/dunwu/linux-tutorial/tree/master/codes/linux/ops/service/maven\n\n\n# ç¯å¢åå¤\n\nMaven ä¾èµäº Javaï¼æä»¥æ¬å°å¿é¡»å®è£ JDKã\n\næå¼æ§å¶å°ï¼æ§è¡ java -version ç¡®è®¤æ¬å°å·²å®è£ JDKã\n\n$ java -version\njava version "1.8.0_191"\nJava(TM) SE Runtime Environment (build 1.8.0_191-b12)\nJava HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)\n\n\n\n# ä¸è½½è§£å\n\nè¿å¥ å®ç½ä¸è½½å°åï¼éæ©åéçæ¬ï¼ä¸è½½å¹¶è§£åå°æ¬å°ãè§£åå½ä»¤å¦ä¸ï¼\n\n# ä»¥ä¸è§£åå½ä»¤åå«éå¯¹ zip åå tar å\nunzip apache-maven-3.6.3-bin.zip\ntar xzvf apache-maven-3.6.3-bin.tar.gz\n\n\n\n# ç¯å¢åé\n\næ·»å ç¯å¢åé MAVEN_HOMEï¼å¼ä¸º Maven çå®è£è·¯å¾ã\n\n# éç½® Unix ç³»ç»ç¯å¢åé\n\nè¾å¥ vi /etc/profile ï¼æ·»å ç¯å¢åéå¦ä¸ï¼\n\n# MAVEN çæ ¹è·¯å¾\nexport MAVEN_HOME=/opt/maven/apache-maven-3.5.2\nexport PATH=$MAVEN_HOME/bin:$PATH\n\n\næ§è¡ source /etc/profile ï¼ç«å³çæã\n\n# éç½® Windows ç³»ç»ç¯å¢åé\n\nå³é® "è®¡ç®æº"ï¼éæ© "å±æ§"ï¼ä¹åç¹å» "é«çº§ç³»ç»è®¾ç½®"ï¼ç¹å»"ç¯å¢åé"ï¼æ¥è®¾ç½®ç¯å¢åéï¼æä»¥ä¸ç³»ç»åééè¦éç½®ï¼\n\n\n\n\n\n\n# æ£æµå®è£æå\n\næ£éªæ¯å¦å®è£æåï¼æ§è¡ mvn -v å½ä»¤ï¼å¦æè¾åºç±»ä¼¼ä¸é¢ç maven çæ¬ä¿¡æ¯ï¼è¯´æéç½®æåã\n\n$ mvn -v\nApache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-18T02:33:14+08:00)\nMaven home: /opt/maven/apache-maven-3.5.4\nJava version: 1.8.0_191, vendor: Oracle Corporation, runtime: /mnt/disk1/jdk1.8.0_191/jre\nDefault locale: zh_CN, platform encoding: UTF-8\nOS name: "linux", version: "3.10.0-327.el7.x86_64", arch: "amd64", family: "unix"\n\n\n\n# Maven éç½®æä»¶\n\nsetting.xml æä»¶æ¯ Maven çé»è®¤éç½®æä»¶ï¼å¶é»è®¤è·¯å¾ä¸ºï¼<Maven å®è£ç®å½>/conf/settings.xmlã\n\nå¦æéè¦ä¿®æ¹ Maven éç½®ï¼ç´æ¥ä¿®æ¹ setting.xml å¹¶ä¿æå³å¯ã\n\nä¾å¦ï¼æ³è¦ä¿®æ¹æ¬å°ä»åºä½ç½®å¯ä»¥æå¦ä¸éç½®ï¼è¿æ ·ï¼ææéè¿ Maven ä¸è½½æåç jar åé½ä¼å­å¨å¨ D:\\maven\\repo è·¯å¾ä¸ã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.1.0 http://maven.apache.org/xsd/settings-1.1.0.xsd">\n  <localRepository>D:\\maven\\repo<localRepository/>\n  \x3c!-- ç¥ --\x3e\n</settings>\n\n\n\n# å¿«éå¥é¨\n\n\n# åå»º Maven å·¥ç¨\n\n# åå§åå·¥ç¨\n\næ§è¡æä»¤ï¼\n\nmvn archetype:generate -DgroupId=com.mycompany.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DarchetypeVersion=1.4 -DinteractiveMode=false\n\n\nä¼å¨å½åè·¯å¾æ°å»ºä¸ä¸ªåä¸º my-app ç Maven å·¥ç¨ï¼å¶ç®å½ç»æå¦ä¸ï¼\n\nmy-app\n|-- pom.xml\n`-- src\n    |-- main\n    |   `-- java\n    |       `-- com\n    |           `-- mycompany\n    |               `-- app\n    |                   `-- App.java\n    `-- test\n        `-- java\n            `-- com\n                `-- mycompany\n                    `-- app\n                        `-- AppTest.java\n\n\nå¶ä¸­ï¼ src/main/java ç®å½åå« java æºç ï¼ src/test/java ç®å½åå« java æµè¯æºç ï¼è pom.xml æä»¶æ¯ maven å·¥ç¨çéç½®æä»¶ã\n\n# POM éç½®\n\npom.xml æ¯ maven å·¥ç¨çéç½®æä»¶ï¼å®æè¿°äº maven å·¥ç¨çæå»ºæ¹å¼ï¼å¶éç½®ä¿¡æ¯æ¯å¾å¤æçï¼è¿éç»ä¸ä¸ªæç®åçéç½®ç¤ºä¾ï¼\n\nproject xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelVersion>4.0.0</modelVersion>\n\n  <groupId>com.mycompany.app</groupId>\n  <artifactId>my-app</artifactId>\n  <version>1.0-SNAPSHOT</version>\n\n  <properties>\n    <maven.compiler.source>1.7</maven.compiler.source>\n    <maven.compiler.target>1.7</maven.compiler.target>\n  </properties>\n\n  <dependencies>\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>4.12</version>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n</project>\n\n\n# æå»ºé¡¹ç®\n\næ§è¡ä»¥ä¸å½ä»¤ï¼å³å¯æå»ºé¡¹ç®ï¼\n\nmvn clean package -Dmaven.test.skip=true -B -U\n\n\næå»ºæååï¼ä¼è¾åºç±»ä¼¼ä¸é¢çä¿¡æ¯ï¼\n\n...\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  2.953 s\n[INFO] Finished at: 2019-11-24T13:05:10+01:00\n[INFO] ------------------------------------------------------------------------\n\n\nè¿æ¶ï¼å¨å½åè·¯å¾ä¸ä¼äº§çä¸ä¸ª target ç®å½ï¼å¶ä¸­åå«äºæå»ºçè¾åºç©ï¼å¦ï¼jar åãclass æä»¶ç­ã\n\nè¿æ¶ï¼æä»¬å¯ä»¥æ§è¡ä»¥ä¸å½ä»¤å¯å¨ jar åï¼\n\njava -cp target/my-app-1.0-SNAPSHOT.jar com.mycompany.app.App\n\n\n\n# å¨ Intellij ä¸­åå»º Maven å·¥ç¨\n\nï¼1ï¼åå»º Maven å·¥ç¨\n\nä¾æ¬¡ç¹å» File -> New -> Project æå¼åå»ºå·¥ç¨å¯¹è¯æ¡ï¼éæ© Maven å·¥ç¨ã\n\n\n\nï¼2ï¼è¾å¥é¡¹ç®ä¿¡æ¯\n\n\n\nï¼3ï¼ç¹å» Intellij ä¾§è¾¹æ ä¸­ç Maven å·¥å·çé¢ï¼æå ä¸ªå¯ä»¥ç´æ¥ä½¿ç¨ç maven å½ä»¤ï¼å¯ä»¥å¸®å©ä½ è¿è¡æå»ºã\n\n\n\n\n# å¨ Eclipse ä¸­åå»º Maven å·¥ç¨\n\nï¼1ï¼Maven æä»¶\n\nå¨ Eclipse ä¸­åå»º Maven å·¥ç¨ï¼éè¦å®è£ Maven æä»¶ã\n\nä¸è¬è¾æ°çæ¬ç Eclipse é½ä¼å¸¦æ Maven æä»¶ï¼å¦æä½ ç Eclipse ä¸­å·²ç»æ Maven æä»¶ï¼å¯ä»¥è·³è¿è¿ä¸æ­¥éª¤ã\n\nç¹å» Help -> Eclipse Marketplaceï¼æç´¢ maven å³é®å­ï¼éæ©å®è£çº¢æ¡å¯¹åºç Maven æä»¶ã\n\n\n\nï¼2ï¼Maven ç¯å¢éç½®\n\nç¹å» Window -> Preferences\n\nå¦ä¸å¾æç¤ºï¼éç½® settings.xml æä»¶çä½ç½®\n\n\n\nï¼3ï¼åå»º Maven å·¥ç¨\n\nFile -> New -> Maven Project -> Nextï¼å¨æ¥ä¸æ¥ççªå£ä¸­ä¼çå°ä¸å¤§å çé¡¹ç®æ¨¡æ¿ï¼éæ©åéçæ¨¡æ¿ã\n\næ¥ä¸æ¥è®¾ç½®é¡¹ç®çåæ°ï¼å¦ä¸ï¼\n\n\n\ngroupIdæ¯é¡¹ç®ç»ç»å¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åº JAVA çåçç»æï¼æ¯ main ç®å½é java çç®å½ç»æã\n\nartifactIdå°±æ¯é¡¹ç®çå¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åºé¡¹ç®çåç§°ï¼å°±æ¯é¡¹ç®æ ¹ç®å½çåç§°ã\n\nç¹å» Finishï¼Eclipse ä¼åå»ºä¸ä¸ª Maven å·¥ç¨ã\n\nï¼4ï¼ä½¿ç¨ Maven è¿è¡æå»º\n\nEclipse ä¸­æå»ºæ¹å¼ï¼\n\nå¨ Elipse é¡¹ç®ä¸å³å» -> Run As å°±è½çå°å¾å¤ Maven æä½ãè¿äºæä½å maven å½ä»¤æ¯ç­æçãä¾å¦ Maven cleanï¼ç­åäº mvn clean å½ä»¤ã\n\n\n\nä½ ä¹å¯ä»¥ç¹å» Maven buildï¼è¾å¥ç»åå½ä»¤ï¼å¹¶ä¿å­ä¸æ¥ãå¦ä¸å¾ï¼\n\n\n\nMaven å½ä»¤æå»ºæ¹å¼ï¼\n\nå½ç¶ï¼ä½ ä¹å¯ä»¥ç´æ¥ä½¿ç¨ maven å½ä»¤è¿è¡æå»ºã\n\nè¿å¥å·¥ç¨æå¨ç®å½ï¼è¾å¥ maven å½ä»¤å°±å¯ä»¥äºã\n\n\n\n\n# ä½¿ç¨è¯´æ\n\n\n# å¦ä½æ·»å ä¾èµ\n\nå¨ Maven å·¥ç¨ä¸­æ·»å ä¾èµ jar åï¼å¾ç®åï¼åªè¦å¨ POM æä»¶ä¸­å¼å¥å¯¹åºç<dependency>æ ç­¾å³å¯ã\n\nåèä¸ä¾ï¼\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>com.zp.maven</groupId>\n  <artifactId>MavenDemo</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <packaging>jar</packaging>\n  <name>MavenDemo</name>\n  <url>http://maven.apache.org</url>\n\n  <properties>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n    <junit.version>3.8.1</junit.version>\n  </properties>\n\n  <dependencies>\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>${junit.version}</version>\n      <scope>test</scope>\n    </dependency>\n\n    <dependency>\n      <groupId>log4j</groupId>\n      <artifactId>log4j</artifactId>\n      <version>1.2.12</version>\n      <scope>compile</scope>\n    </dependency>\n  </dependencies>\n</project>\n\n\n<dependency> æ ç­¾æå¸¸ç¨çåä¸ªå±æ§æ ç­¾ï¼\n\n * <groupId> - é¡¹ç®ç»ç»å¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åº JAVA çåçç»æã\n * <artifactId> - é¡¹ç®å¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åºé¡¹ç®çåç§°ï¼å°±æ¯é¡¹ç®æ ¹ç®å½çåç§°ã\n * <version> - jar åççæ¬å·ãå¯ä»¥ç´æ¥å¡«çæ¬æ°å­ï¼ä¹å¯ä»¥å¨ properties æ ç­¾ä¸­è®¾ç½®å±æ§å¼ã\n * <scope> - jar åçä½ç¨èå´ãå¯ä»¥å¡«å compileãruntimeãtestãsystem å providedãç¨æ¥å¨ç¼è¯ãæµè¯ç­åºæ¯ä¸éæ©å¯¹åºç classpathã\n\n\n# å¦ä½å¯»æ¾ jar å\n\nå¯ä»¥å¨ http://mvnrepository.com/ ç«ç¹æå¯»ä½ æ³è¦ç jar åçæ¬\n\nä¾å¦ï¼æ³è¦ä½¿ç¨ log4jï¼å¯ä»¥æ¾å°éè¦ççæ¬å·ï¼ç¶åæ·è´å¯¹åºç maven æ ç­¾ä¿¡æ¯ï¼å°å¶æ·»å å° pom .xml æä»¶ä¸­ã\n\n\n# å¦ä½ä½¿ç¨ Maven æä»¶(Plugin)\n\nè¦æ·»å  Maven æä»¶ï¼å¯ä»¥å¨ pom.xml æä»¶ä¸­æ·»å  <plugin> æ ç­¾ã\n\n<build>\n  <plugins>\n    <plugin>\n      <groupId>org.apache.maven.plugins</groupId>\n      <artifactId>maven-compiler-plugin</artifactId>\n      <version>3.3</version>\n      <configuration>\n        <source>1.7</source>\n        <target>1.7</target>\n      </configuration>\n    </plugin>\n  </plugins>\n</build>\n\n\n<configuration> æ ç­¾ç¨æ¥éç½®æä»¶çä¸äºä½¿ç¨åæ°ã\n\n\n# å¦ä½ä¸æ¬¡ç¼è¯å¤ä¸ªå·¥ç¨\n\nåè®¾è¦åå»ºä¸ä¸ªç¶ maven å·¥ç¨ï¼å®æä¸¤ä¸ªå­å·¥ç¨ï¼my-app å my-webappï¼\n\n+- pom.xml\n+- my-app\n| +- pom.xml\n| +- src\n|   +- main\n|     +- java\n+- my-webapp\n| +- pom.xml\n| +- src\n|   +- main\n|     +- webapp\n\n\napp å·¥ç¨ç pom.xml å¦ä¸ï¼éç¹å¨äºå¨ modules ä¸­å¼å¥ä¸¤ä¸ªå­ moduleï¼\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelVersion>4.0.0</modelVersion>\n\n  <groupId>com.mycompany.app</groupId>\n  <artifactId>app</artifactId>\n  <version>1.0-SNAPSHOT</version>\n  <packaging>pom</packaging>\n\n  <modules>\n    <module>my-app</module>\n    <module>my-webapp</module>\n  </modules>\n</project>\n\n\néæ©ç¼è¯ XXX æ¶ï¼ä¼ä¾æ¬¡å¯¹å®çææ Module æ§è¡ç¸åæä½ã\n\n\n# å¸¸ç¨ Maven æä»¶\n\n> æ´å¤è¯¦æè¯·åèï¼https://maven.apache.org/plugins/\n\n# maven-antrun-plugin\n\nmaven-antrun-plugin è½è®©ç¨æ·å¨ Maven é¡¹ç®ä¸­è¿è¡ Ant ä»»å¡ãç¨æ·å¯ä»¥ç´æ¥å¨è¯¥æä»¶çéç½®ä»¥ Ant çæ¹å¼ç¼å Targetï¼ ç¶åäº¤ç»è¯¥æä»¶ç run ç®æ å»æ§è¡ãå¨ä¸äºç± Ant å¾ Maven è¿ç§»çé¡¹ç®ä¸­ï¼è¯¥æä»¶å°¤å¶æç¨ãæ­¤å¤å½ä½ åç°éè¦ç¼åä¸äºèªå®ä¹ç¨åº¦å¾é«çä»»å¡ï¼åæ¶åè§ å¾ Maven ä¸å¤çµæ´»æ¶ï¼ä¹å¯ä»¥ä»¥ Ant çæ¹å¼å®ç°ä¹ãmaven-antrun-plugin ç run ç®æ éå¸¸ä¸çå½å¨æç»å®è¿è¡ã\n\n# maven-archetype-plugin\n\nArchtype æé¡¹ç®çéª¨æ¶ï¼Maven åå­¦èæå¼å§æ§è¡ç Maven å½ä»¤å¯è½å°±æ¯mvn archetype:generateï¼è¿å®éä¸å°±æ¯è®© maven-archetype-plugin çæä¸ä¸ªå¾ç®åçé¡¹ç®éª¨æ¶ï¼å¸®å©å¼åèå¿«éä¸æãå¯è½ä¹æäººçå°ä¸äºææ¡£åäºmvn archetype:createï¼ ä½å®éä¸ create ç®æ å·²ç»è¢«å¼ç¨äºï¼åèä»£ä¹çæ¯ generate ç®æ ï¼è¯¥ç®æ ä½¿ç¨äº¤äºå¼çæ¹å¼æç¤ºç¨æ·è¾å¥å¿è¦çä¿¡æ¯ä»¥åå»ºé¡¹ç®ï¼ä½éªæ´å¥½ã maven-archetype-plugin è¿æä¸äºå¶ä»ç®æ å¸®å©ç¨æ·èªå·±å®ä¹é¡¹ç®ååï¼ä¾å¦ä½ ç±ä¸ä¸ªäº§åéè¦äº¤ä»ç»å¾å¤å®¢æ·è¿è¡äºæ¬¡å¼åï¼ä½ å°±å¯ä»¥ä¸º ä»ä»¬æä¾ä¸ä¸ª Archtypeï¼å¸®å©ä»ä»¬å¿«éä¸æã\n\n# maven-assembly-plugin\n\nmaven-assembly-plugin çç¨éæ¯å°é¡¹ç®æåï¼è¯¥åå¯è½åå«äºé¡¹ç®çå¯æ§è¡æä»¶ãæºä»£ç ãreadmeãå¹³å°èæ¬ç­ç­ã maven-assembly-plugin æ¯æåç§ä¸»æµçæ ¼å¼å¦ zipãtar.gzãjar å war ç­ï¼å·ä½æååªäºæä»¶æ¯é«åº¦å¯æ§çï¼ä¾å¦ç¨æ·å¯ä»¥ ææä»¶çº§å«çç²åº¦ãæä»¶éçº§å«çç²åº¦ãæ¨¡åçº§å«çç²åº¦ãä»¥åä¾èµçº§å«çç²åº¦æ§å¶æåï¼æ­¤å¤ï¼åå«åæé¤éç½®ä¹æ¯æ¯æçãmaven-assembly- plugin è¦æ±ç¨æ·ä½¿ç¨ä¸ä¸ªåä¸ºassembly.xmlçåæ°æ®æä»¶æ¥è¡¨è¿°æåï¼å®ç single ç®æ å¯ä»¥ç´æ¥å¨å½ä»¤è¡è°ç¨ï¼ä¹å¯ä»¥è¢«ç»å®è³çå½å¨æã\n\n# maven-dependency-plugin\n\nmaven-dependency-plugin æå¤§çç¨éæ¯å¸®å©åæé¡¹ç®ä¾èµï¼dependency:listè½å¤ååºé¡¹ç®æç»è§£æå°çä¾èµåè¡¨ï¼dependency:treeè½è¿ä¸æ­¥çæç»é¡¹ç®ä¾èµæ ï¼dependency:analyzeå¯ä»¥åè¯ä½ é¡¹ç®ä¾èµæ½å¨çé®é¢ï¼å¦æä½ æç´æ¥ä½¿ç¨å°çå´æªå£°æçä¾èµï¼è¯¥ç®æ å°±ä¼ååºè­¦åãmaven-dependency-plugin è¿æå¾å¤ç®æ å¸®å©ä½ æä½ä¾èµæä»¶ï¼ä¾å¦dependency:copy-dependenciesè½å°é¡¹ç®ä¾èµä»æ¬å° Maven ä»åºå¤å¶å°æä¸ªç¹å®çæä»¶å¤¹ä¸é¢ã\n\n# maven-enforcer-plugin\n\nå¨ä¸ä¸ªç¨å¤§ä¸ç¹çç»ç»æå¢éä¸­ï¼ä½ æ æ³ä¿è¯æææåé½çæ Mavenï¼é£ä»ä»¬åä¸äºæ¯è¾æè ¢çäºæå°±ä¼åå¾å¾æ­£å¸¸ï¼ä¾å¦ç»é¡¹ç®å¼å¥äºå¤é¨ç SNAPSHOT ä¾èµèå¯¼è´æå»ºä¸ç¨³å®ï¼ä½¿ç¨äºä¸ä¸ªä¸å¤§å®¶ä¸ä¸è´ç Maven çæ¬èç»å¸¸æ±æ¨æå»ºåºç°è¯¡å¼é®é¢ãmaven-enforcer- plugin è½å¤å¸®å©ä½ é¿åä¹ç±»é®é¢ï¼å®åè®¸ä½ åå»ºä¸ç³»åè§åå¼ºå¶å¤§å®¶éµå®ï¼åæ¬è®¾å® Java çæ¬ãè®¾å® Maven çæ¬ãç¦æ­¢æäºä¾èµãç¦æ­¢ SNAPSHOT ä¾èµãåªè¦å¨ä¸ä¸ªç¶ POM éç½®è§åï¼ç¶åè®©å¤§å®¶ç»§æ¿ï¼å½è§åé­å°ç ´åçæ¶åï¼Maven å°±ä¼æ¥éãé¤äºæ åçè§åä¹å¤ï¼ä½ è¿å¯ä»¥æ©å±è¯¥æ ä»¶ï¼ç¼åèªå·±çè§åãmaven-enforcer-plugin ç enforce ç®æ è´è´£æ£æ¥è§åï¼å®é»è®¤ç»å®å°çå½å¨æç validate é¶æ®µã\n\n# maven-help-plugin\n\nmaven-help-plugin æ¯ä¸ä¸ªå°å·§çè¾å©å·¥å·ï¼æç®åçhelp:systemå¯ä»¥æå°ææå¯ç¨çç¯å¢åéå Java ç³»ç»å±æ§ãhelp:effective-pomåhelp:effective-settingsæ ä¸ºæç¨ï¼å®ä»¬åå«æå°é¡¹ç®çææ POM åææ settingsï¼ææ POM æ¯æåå¹¶äºææç¶ POMï¼åæ¬ Super POMï¼åç XMLï¼å½ä½ ä¸ç¡®å® POM çæäºä¿¡æ¯ä»ä½èæ¥æ¶ï¼å°±å¯ä»¥æ¥çææ POMãææ settings åçï¼ç¹å«æ¯å½ä½ åç°èªå·±éç½®ç settings.xml æ²¡æçææ¶ï¼å°±å¯ä»¥ç¨help:effective-settingsæ¥éªè¯ãæ­¤å¤ï¼maven-help-plugin ç describe ç®æ å¯ä»¥å¸®å©ä½ æè¿°ä»»ä½ä¸ä¸ª Maven æä»¶çä¿¡æ¯ï¼è¿æ all-profiles ç®æ å active-profiles ç®æ å¸®å©æ¥çé¡¹ç®ç Profileã\n\n# maven-release-plugin\n\nmaven-release-plugin çç¨éæ¯å¸®å©èªå¨åé¡¹ç®çæ¬åå¸ï¼å®ä¾èµäº POM ä¸­ç SCM ä¿¡æ¯ãrelease:prepareç¨æ¥åå¤çæ¬åå¸ï¼å·ä½çå·¥ä½åæ¬æ£æ¥æ¯å¦ææªæäº¤ä»£ç ãæ£æ¥æ¯å¦æ SNAPSHOT ä¾èµãåçº§é¡¹ç®ç SNAPSHOT çæ¬è³ RELEASE çæ¬ãä¸ºé¡¹ç®ææ ç­¾ç­ç­ãrelease:performå æ¯ç­¾åºæ ç­¾ä¸­ç RELEASE æºç ï¼æå»ºå¹¶åå¸ãçæ¬åå¸æ¯éå¸¸çç¢çå·¥ä½ï¼å®æ¶åäºåç§æ£æ¥ï¼èä¸ç±äºè¯¥å·¥ä½ä»ä»æ¯å¶å°éè¦ï¼å æ­¤æå¨æä½å¾å®¹æéæ¼ä¸ äºç»èï¼maven-release-plugin è®©è¯¥å·¥ä½åå¾éå¸¸å¿«éç®ä¾¿ï¼ä¸æåºéãmaven-release-plugin çåç§ç®æ éå¸¸ç´æ¥å¨ å½ä»¤è¡è°ç¨ï¼å ä¸ºçæ¬åå¸æ¾ç¶ä¸æ¯æ¥å¸¸æå»ºçå½å¨æçä¸é¨åã\n\n# maven-resources-plugin\n\nä¸ºäºä½¿é¡¹ç®ç»ææ´ä¸ºæ¸æ°ï¼Maven åºå«å¯¹å¾ Java ä»£ç æä»¶åèµæºæä»¶ï¼maven-compiler-plugin ç¨æ¥ç¼è¯ Java ä»£ç ï¼maven-resources-plugin åç¨æ¥å¤çèµæºæä»¶ãé»è®¤çä¸»èµæºæä»¶ç®å½æ¯src/main/resourcesï¼å¾å¤ç¨æ·ä¼éè¦æ·»å é¢å¤çèµæºæä»¶ç®å½ï¼è¿ä¸ªæ¶åå°±å¯ä»¥éè¿éç½® maven-resources-plugin æ¥å®ç°ãæ­¤å¤ï¼èµæºæä»¶è¿æ»¤ä¹æ¯ Maven çä¸å¤§ç¹æ§ï¼ä½ å¯ä»¥å¨èµæºæä»¶ä¸­ä½¿ç¨*${propertyName}*å½¢å¼ç Maven å±æ§ï¼ç¶åéç½® maven-resources-plugin å¼å¯å¯¹èµæºæä»¶çè¿æ»¤ï¼ä¹åå°±å¯ä»¥éå¯¹ä¸åç¯å¢éè¿å½ä»¤è¡æè Profile ä¼ å¥å±æ§çå¼ï¼ä»¥å®ç°æ´ä¸ºçµæ´»çæå»ºã\n\n# maven-surefire-plugin\n\nå¯è½æ¯ç±äºåå²çåå ï¼Maven 2.3 ä¸­ç¨äºæ§è¡æµè¯çæä»¶ä¸æ¯ maven-test-pluginï¼èæ¯ maven-surefire-pluginãå¶å®å¤§é¨åæ¶é´åï¼åªè¦ä½ çæµè¯ ç±»éµå¾ªéç¨çå½ä»¤çº¦å®ï¼ä»¥ Test ç»å°¾ãä»¥ TestCase ç»å°¾ãæèä»¥ Test å¼å¤´ï¼ï¼å°±å ä¹ä¸ç¨ç¥æè¯¥æä»¶çå­å¨ãç¶èå¨å½ä½ æ³è¦è·³è¿æµè¯ãæé¤æäº æµè¯ç±»ãæèä½¿ç¨ä¸äº TestNG ç¹æ§çæ¶åï¼äºè§£ maven-surefire-plugin çä¸äºéç½®éé¡¹å°±å¾æç¨äºãä¾å¦ mvn test -Dtest=FooTest è¿æ ·ä¸æ¡å½ä»¤çæææ¯ä»è¿è¡ FooTest æµè¯ç±»ï¼è¿æ¯éè¿æ§å¶ maven-surefire-plugin ç test åæ°å®ç°çã\n\n# build-helper-maven-plugin\n\nMaven é»è®¤åªåè®¸æå®ä¸ä¸ªä¸» Java ä»£ç ç®å½åä¸ä¸ªæµè¯ Java ä»£ç ç®å½ï¼è½ç¶è¿å¶å®æ¯ä¸ªåºå½å°½ééµå®ççº¦å®ï¼ä½å¶å°ä½ è¿æ¯ä¼å¸æè½å¤æå®å¤ä¸ª æºç ç®å½ï¼ä¾å¦ä¸ºäºåºå¯¹éçé¡¹ç®ï¼ï¼build-helper-maven-plugin ç add-source ç®æ å°±æ¯æå¡äºè¿ä¸ªç®çï¼éå¸¸å®è¢«ç»å®å° é»è®¤çå½å¨æç generate-sources é¶æ®µä»¥æ·»å é¢å¤çæºç ç®å½ãéè¦å¼ºè°çæ¯ï¼è¿ç§åæ³è¿æ¯ä¸æ¨èçï¼å ä¸ºå®ç ´åäº Maven ççº¦å®ï¼èä¸å¯è½ä¼éå°å¶ä»ä¸¥æ ¼éµå®çº¦å®çæä»¶å·¥å·æ æ³æ­£ç¡®è¯å«é¢å¤çæºç ç®å½ã\n\nbuild-helper-maven-plugin çå¦ä¸ä¸ªéå¸¸æç¨çç®æ æ¯ attach-artifactï¼ä½¿ç¨è¯¥ç®æ ä½ å¯ä»¥ä»¥ classifier çå½¢å¼éåé¨åé¡¹ç®æä»¶çæéå±æä»¶ï¼å¹¶åæ¶ install å°æ¬å°ä»åºï¼ä¹å¯ä»¥ deploy å°è¿ç¨ä»åºã\n\n# exec-maven-plugin\n\nexec-maven-plugin å¾å¥½çè§£ï¼é¡¾åæä¹ï¼å®è½è®©ä½ è¿è¡ä»»ä½æ¬å°çç³»ç»ç¨åºï¼å¨æäºç¹å®æåµä¸ï¼è¿è¡ä¸ä¸ª Maven å¤é¨çç¨åºå¯è½å°±æ¯æç®åçé®é¢è§£å³æ¹æ¡ï¼è¿å°±æ¯exec:execç ç¨éï¼å½ç¶ï¼è¯¥æä»¶è¿åè®¸ä½ éç½®ç¸å³çç¨åºè¿è¡åæ°ãé¤äº exec ç®æ ä¹å¤ï¼exec-maven-plugin è¿æä¾äºä¸ä¸ª java ç®æ ï¼è¯¥ç®æ è¦æ±ä½  æä¾ä¸ä¸ª mainClass åæ°ï¼ç¶åå®è½å¤å©ç¨å½åé¡¹ç®çä¾èµä½ä¸º classpathï¼å¨åä¸ä¸ª JVM ä¸­è¿è¡è¯¥ mainClassãææ¶åï¼ä¸ºäºç®åç æ¼ç¤ºä¸ä¸ªå½ä»¤è¡ Java ç¨åºï¼ä½ å¯ä»¥å¨ POM ä¸­éç½®å¥½ exec-maven-plugin çç¸å³è¿è¡åæ°ï¼ç¶åç´æ¥å¨å½ä»¤è¿è¡mvn exec:java ä»¥æ¥çè¿è¡ææã\n\n# jetty-maven-plugin\n\nå¨è¿è¡ Web å¼åçæ¶åï¼æå¼æµè§å¨å¯¹åºç¨è¿è¡æå¨çæµè¯å ä¹æ¯æ æ³é¿åçï¼è¿ç§æµè¯æ¹æ³éå¸¸å°±æ¯å°é¡¹ç®æåæ war æä»¶ï¼ç¶åé¨ç½²å° Web å®¹å¨ ä¸­ï¼åå¯å¨å®¹å¨è¿è¡éªè¯ï¼è¿æ¾ç¶ååèæ¶ãä¸ºäºå¸®å©å¼åèèçæ¶é´ï¼jetty-maven-plugin åºè¿èçï¼å®å®å¨å¼å®¹ Maven é¡¹ç®çç®å½ç»æï¼è½å¤å¨ææ§å°æ£æ¥æºæä»¶ï¼ä¸æ¦åç°åæ´åèªå¨æ´æ°å°åç½®ç Jetty Web å®¹å¨ä¸­ãåä¸äºåºæ¬éç½®åï¼ä¾å¦ Web åºç¨ç contextPath åèªå¨æ«æåæ´çæ¶é´é´éï¼ï¼ä½ åªè¦æ§è¡ mvn jetty:run ï¼ç¶åå¨ IDE ä¸­ä¿®æ¹ä»£ç ï¼ä»£ç ç» IDE èªå¨ç¼è¯åäº§çåæ´ï¼åç± jetty-maven-plugin ä¾¦æµå°åæ´æ°è³ Jetty å®¹å¨ï¼è¿æ¶ä½ å°±å¯ä»¥ç´æ¥ æµè¯ Web é¡µé¢äºãéè¦æ³¨æçæ¯ï¼jetty-maven-plugin å¹¶ä¸æ¯å®¿ä¸»äº Apache æ Codehaus çå®æ¹æä»¶ï¼å æ­¤ä½¿ç¨çæ¶åéè¦é¢å¤ çéç½®settings.xmlç pluginGroups åç´ ï¼å° org.mortbay.jetty è¿ä¸ª pluginGroup å å¥ã\n\n# versions-maven-plugin\n\nå¾å¤ Maven ç¨æ·éå°è¿è¿æ ·ä¸ä¸ªé®é¢ï¼å½é¡¹ç®åå«å¤§éæ¨¡åçæ¶åï¼ä¸ºä»ä»¬éä½æ´æ°çæ¬å°±åæä¸ä»¶ç¦äººçäºæï¼å°åºææ²¡æèªå¨åå·¥å·è½å¸®å©å®æè¿ä»¶ äºæå¢ï¼ï¼å½ç¶ä½ å¯ä»¥ä½¿ç¨ sed ä¹ç±»çææ¬æä½å·¥å·ï¼ä¸è¿ä¸å¨æ¬æè®¨è®ºèå´ï¼ç­æ¡æ¯è¯å®çï¼versions-maven- plugin æä¾äºå¾å¤ç®æ å¸®å©ä½ ç®¡ç Maven é¡¹ç®çåç§çæ¬ä¿¡æ¯ãä¾å¦æå¸¸ç¨çï¼å½ä»¤ mvn versions:set -DnewVersion=1.1-SNAPSHOT å°±è½å¸®å©ä½ ææææ¨¡åççæ¬æ´æ°å° 1.1-SNAPSHOTãè¯¥æä»¶è¿æä¾äºå¶ä»ä¸äºå¾æç¨çç®æ ï¼display-dependency- updates è½åè¯ä½ é¡¹ç®ä¾èµæåªäºå¯ç¨çæ´æ°ï¼ç±»ä¼¼ç display-plugin-updates è½åè¯ä½ å¯ç¨çæä»¶æ´æ°ï¼ç¶å use- latest-versions è½èªå¨å¸®ä½ å°ææä¾èµåçº§å°ææ°çæ¬ãæåï¼å¦æä½ å¯¹æåçæ´æ¹æ»¡æï¼åå¯ä»¥ä½¿ç¨ mvn versions:commit æäº¤ï¼ä¸æ»¡æçè¯ä¹å¯ä»¥ä½¿ç¨ mvn versions:revert è¿è¡æ¤éã\n\n\n# Maven å½ä»¤\n\nå¸¸ç¨ maven å½ä»¤æ¸åï¼\n\nçå½å¨æ                          é¶æ®µæè¿°\nmvn validate                  éªè¯é¡¹ç®æ¯å¦æ­£ç¡®ï¼ä»¥åææä¸ºäºå®æ´æå»ºå¿è¦çä¿¡æ¯æ¯å¦å¯ç¨\nmvn generate-sources          çæææéè¦åå«å¨ç¼è¯è¿ç¨ä¸­çæºä»£ç \nmvn process-sources           å¤çæºä»£ç ï¼æ¯å¦è¿æ»¤ä¸äºå¼\nmvn generate-resources        çæææéè¦åå«å¨æåè¿ç¨ä¸­çèµæºæä»¶\nmvn process-resources         å¤å¶å¹¶å¤çèµæºæä»¶è³ç®æ ç®å½ï¼åå¤æå\nmvn compile                   ç¼è¯é¡¹ç®çæºä»£ç \nmvn process-classes           åå¤çç¼è¯çæçæä»¶ï¼ä¾å¦å¯¹ Java ç±»è¿è¡å­èç å¢å¼ºï¼bytecode enhancementï¼\nmvn generate-test-sources     çæææåå«å¨æµè¯ç¼è¯è¿ç¨ä¸­çæµè¯æºç \nmvn process-test-sources      å¤çæµè¯æºç ï¼æ¯å¦è¿æ»¤ä¸äºå¼\nmvn generate-test-resources   çææµè¯éè¦çèµæºæä»¶\nmvn process-test-resources    å¤å¶å¹¶å¤çæµè¯èµæºæä»¶è³æµè¯ç®æ ç®å½\nmvn test-compile              ç¼è¯æµè¯æºç è³æµè¯ç®æ ç®å½\nmvn test                      ä½¿ç¨åéçååæµè¯æ¡æ¶è¿è¡æµè¯ãè¿äºæµè¯åºè¯¥ä¸éè¦ä»£ç è¢«æåæåå¸\nmvn prepare-package           å¨çæ­£çæåä¹åï¼æ§è¡ä¸äºåå¤æåå¿è¦çæä½ãè¿éå¸¸ä¼äº§çä¸ä¸ªåçå±å¼çå¤çè¿ççæ¬ï¼å°ä¼å¨ Maven\n                              2.1+ä¸­å®ç°ï¼\nmvn package                   å°ç¼è¯å¥½çä»£ç æåæå¯ååçæ ¼å¼ï¼å¦ JARï¼WARï¼æè EAR\nmvn pre-integration-test      æ§è¡ä¸äºå¨éææµè¯è¿è¡ä¹åéè¦çå¨ä½ãå¦å»ºç«éææµè¯éè¦çç¯å¢\nmvn integration-test          å¦ææå¿è¦çè¯ï¼å¤çåå¹¶åå¸è³éææµè¯å¯ä»¥è¿è¡çç¯å¢\nmvn post-integration-test     æ§è¡ä¸äºå¨éææµè¯è¿è¡ä¹åéè¦çå¨ä½ãå¦æ¸çéææµè¯ç¯å¢ã\nmvn verify                    æ§è¡æææ£æ¥ï¼éªè¯åæ¯ææçï¼ç¬¦åè´¨éè§è\nmvn install                   å®è£åè³æ¬å°ä»åºï¼ä»¥å¤æ¬å°çå¶å®é¡¹ç®ä½ä¸ºä¾èµä½¿ç¨\nmvn deploy                    å¤å¶æç»çåè³è¿ç¨ä»åºï¼å±äº«ç»å¶å®å¼åäººååé¡¹ç®ï¼éå¸¸åä¸æ¬¡æ­£å¼çåå¸ç¸å³ï¼\n\nç¤ºä¾ï¼æå¸¸ç¨ç maven æå»ºå½ä»¤\n\nmvn clean install -Dmaven.test.skip=true -B -U\n\n\næ¸çæ¬å°è¾åºç©ï¼å¹¶æå»º maven é¡¹ç®ï¼æåå°è¾åºç©å½æ¡£å¨æ¬å°ä»åºã\n\n> ð¡ æ³äºè§£æ´å¤ maven å½ä»¤è¡ç»èå¯ä»¥åèå®æ¹ææ¡£ï¼\n> \n>  * Maven æå»ºçå½å¨æè¯´æ\n>  * Maven å½ä»¤è¡åæ°è¯´æ\n\n\n# åèèµæ\n\n * Maven Github\n * Maven å®æ¹ææ¡£\n * Maven in 5 Minutes\n * Maven Getting Started Guide\n * maven å¸¸è§é®é¢é®ç­\n * å¸¸ç¨ Maven æä»¶ä»ç»',normalizedContent:'# maven å¿«éå¥é¨\n\n\n# maven ç®ä»\n\n\n# maven æ¯ä»ä¹\n\nmaven æ¯ä¸ä¸ªé¡¹ç®ç®¡çå·¥å·ãå®è´è´£ç®¡çé¡¹ç®å¼åè¿ç¨ä¸­çå ä¹ææçä¸è¥¿ã\n\n * çæ¬ - maven æèªå·±ççæ¬å®ä¹åè§åã\n * æå»º - maven æ¯æè®¸å¤ç§çåºç¨ç¨åºç±»åï¼å¯¹äºæ¯ä¸ç§æ¯æçåºç¨ç¨åºç±»åé½å®ä¹å¥½äºä¸ç»æå»ºè§ååå·¥å·éã\n * è¾åºç©ç®¡ç - maven å¯ä»¥ç®¡çé¡¹ç®æå»ºçäº§ç©ï¼å¹¶å°å¶å å¥å°ç¨æ·åºä¸­ãè¿ä¸ªåè½å¯ä»¥ç¨äºé¡¹ç®ç»åå¶ä»é¨é¨ä¹é´çäº¤ä»è¡ä¸ºã\n * ä¾èµå³ç³» - maven å¯¹ä¾èµå³ç³»çç¹æ§è¿è¡ç»è´çåæåååï¼é¿åå¼åè¿ç¨ä¸­çä¾èµæ··ä¹±åç¸äºæ±¡æè¡ä¸º\n * ææ¡£åæå»ºç»æ - maven ç site å½ä»¤æ¯æåç§ææ¡£ä¿¡æ¯çåå¸ï¼åæ¬æå»ºè¿ç¨çåç§è¾åºï¼javadocï¼äº§åææ¡£ç­ã\n * é¡¹ç®å³ç³» - ä¸ä¸ªå¤§åçé¡¹ç®éå¸¸æå ä¸ªå°é¡¹ç®æèæ¨¡åç»æï¼ç¨ maven å¯ä»¥å¾æ¹ä¾¿å°ç®¡çã\n * ç§»æ¤æ§ç®¡ç - maven å¯ä»¥éå¯¹ä¸åçå¼ååºæ¯ï¼è¾åºä¸åç§ç±»çè¾åºç»æã\n\n\n# maven ççå½å¨æ\n\nmaven æé¡¹ç®çæå»ºååä¸ºä¸åççå½å¨æ(lifecycle)ãç²ç¥ä¸ç¹çè¯ï¼å®è¿ä¸ªè¿ç¨(phase)åæ¬ï¼ç¼è¯ãæµè¯ãæåãéææµè¯ãéªè¯ãé¨ç½²ãmaven ä¸­ææçæ§è¡å¨ä½(goal)é½éè¦ææèªå·±å¨è¿ä¸ªè¿ç¨ä¸­çæ§è¡ä½ç½®ï¼ç¶å maven æ§è¡çæ¶åï¼å°±ä¾ç§è¿ç¨çåå±ä¾æ¬¡è°ç¨è¿äº goal è¿è¡åç§å¤çã\n\nè¿ä¸ªä¹æ¯ maven çä¸ä¸ªåºæ¬è°åº¦æºå¶ãä¸è¬æ¥è¯´ï¼ä½ç½®ç¨åçè¿ç¨é½ä¼ä¾èµäºä¹åçè¿ç¨ãå½ç¶ï¼maven åæ ·æä¾äºéç½®æä»¶ï¼å¯ä»¥ä¾ç§ç¨æ·è¦æ±ï¼è·³è¿æäºé¶æ®µã\n\n\n# maven çæ åå·¥ç¨ç»æ\n\nmaven çæ åå·¥ç¨ç»æå¦ä¸ï¼\n\n|-- pom.xml(mavençæ ¸å¿éç½®æä»¶)\n|-- src\n|-- main\n  |-- java(javaæºä»£ç ç®å½)\n  |-- resources(èµæºæä»¶ç®å½)\n|-- test\n    |-- java(ååæµè¯ä»£ç ç®å½)\n|-- target(è¾åºç®å½ï¼ææçè¾åºç©é½å­æ¾å¨è¿ä¸ªç®å½ä¸)\n    |-- classes(ç¼è¯åçclassæä»¶å­æ¾å¤)\n\n\n\n# maven ç"çº¦å®ä¼äºéç½®"\n\næè°ç"çº¦å®ä¼äºéç½®"ï¼å¨ maven ä¸­å¹¶ä¸æ¯å®å¨ä¸å¯ä»¥ä¿®æ¹çï¼ä»ä»¬åªæ¯ä¸äºéç½®çé»è®¤å¼èå·²ãä½æ¯é¤éå¿è¦ï¼å¹¶ä¸éè¦å»ä¿®æ¹é£äºçº¦å®åå®¹ãmaven é»è®¤çæä»¶å­æ¾ç»æå¦ä¸ï¼\n\næ¯ä¸ä¸ªé¶æ®µçä»»å¡é½ç¥éæä¹æ­£ç¡®å®æèªå·±çå·¥ä½ï¼æ¯å¦ compile ä»»å¡å°±ç¥éä» src/main/java ä¸ç¼è¯ææç java æä»¶ï¼å¹¶æå®çè¾åº class æä»¶å­æ¾å° target/classes ä¸­ã\n\nå¯¹ maven æ¥è¯´ï¼éç¨"çº¦å®ä¼äºéç½®"çç­ç¥å¯ä»¥åå°ä¿®æ¹éç½®çå·¥ä½éï¼ä¹å¯ä»¥éä½å­¦ä¹ ææ¬ï¼æ´éè¦çæ¯ï¼ç»é¡¹ç®å¼å¥äºç»ä¸çè§èã\n\n\n# maven ççæ¬è§è\n\nmaven ä½¿ç¨å¦ä¸å ä¸ªè¦ç´ æ¥å¯ä¸å®ä½æä¸ä¸ªè¾åºç©ï¼\n\n * groupid - å¢ä½ãç»ç»çæ è¯ç¬¦ãå¢ä½æ è¯ççº¦å®æ¯ï¼å®ä»¥åå»ºè¿ä¸ªé¡¹ç®çç»ç»åç§°çéååå(reverse domain name)å¼å¤´ãä¸è¬å¯¹åºç java çåçç»æãä¾å¦ org.apache\n * artifactid - åç¬é¡¹ç®çå¯ä¸æ è¯ç¬¦ãæ¯å¦æä»¬ç tomcat, commons ç­ãä¸è¦å¨ artifactid ä¸­åå«ç¹å·(.)ã\n * version - ä¸ä¸ªé¡¹ç®çç¹å®çæ¬ã\n * packaging - é¡¹ç®çç±»åï¼é»è®¤æ¯ jarï¼æè¿°äºé¡¹ç®æååçè¾åºãç±»åä¸º jar çé¡¹ç®äº§çä¸ä¸ª jar æä»¶ï¼ç±»åä¸º war çé¡¹ç®äº§çä¸ä¸ª web åºç¨ã\n\nä¾å¦ï¼æ³å¨ maven å·¥ç¨ä¸­å¼å¥ 4.12 çæ¬ç junit åï¼æ·»å å¦ä¸ä¾èµå³å¯ã\n\n<dependency>\n  <groupid>junit</groupid>\n  <artifactid>junit</artifactid>\n  <version>4.12</version>\n  <scope>compile</scope>\n</dependency>\n\n\nmaven æèªå·±ççæ¬è§èï¼ä¸è¬æ¯å¦ä¸å®ä¹ <major version>ã<minor version>ã<incremental version>-<qualifier> ï¼æ¯å¦ 1.2.3-beta-01ãè¦è¯´æçæ¯ï¼maven èªå·±å¤æ­çæ¬çç®æ³æ¯ major,minor,incremental é¨åç¨æ°å­æ¯ è¾ï¼qualifier é¨åç¨å­ç¬¦ä¸²æ¯è¾ï¼æä»¥è¦å°å¿ alpha-2 å alpha-15 çæ¯è¾å³ç³»ï¼æå¥½ç¨ alpha-02 çæ ¼å¼ã\n\nmaven å¨çæ¬ç®¡çæ¶åå¯ä»¥ä½¿ç¨å ä¸ªç¹æ®çå­ç¬¦ä¸² snapshotï¼latestï¼releaseãæ¯å¦"1.0-snapshot"ãåä¸ªé¨åçå«ä¹åå¤çé»è¾å¦ä¸è¯´æï¼\n\n * snapshot - è¿ä¸ªçæ¬ä¸è¬ç¨äºå¼åè¿ç¨ä¸­ï¼è¡¨ç¤ºä¸ç¨³å®ççæ¬ã\n * latest - ææä¸ªç¹å®æä»¶çææ°åå¸ï¼è¿ä¸ªåå¸å¯è½æ¯ä¸ä¸ªåå¸çï¼ä¹å¯è½æ¯ä¸ä¸ª snapshot çï¼å·ä½çåªä¸ªæ¶é´æåã\n * release - ææåä¸ä¸ªåå¸çã\n\n\n# maven å®è£\n\n> linux ç¯å¢å®è£å¯ä»¥ä½¿ç¨æåä¸é®å®è£èæ¬ï¼https://github.com/dunwu/linux-tutorial/tree/master/codes/linux/ops/service/maven\n\n\n# ç¯å¢åå¤\n\nmaven ä¾èµäº javaï¼æä»¥æ¬å°å¿é¡»å®è£ jdkã\n\næå¼æ§å¶å°ï¼æ§è¡ java -version ç¡®è®¤æ¬å°å·²å®è£ jdkã\n\n$ java -version\njava version "1.8.0_191"\njava(tm) se runtime environment (build 1.8.0_191-b12)\njava hotspot(tm) 64-bit server vm (build 25.191-b12, mixed mode)\n\n\n\n# ä¸è½½è§£å\n\nè¿å¥ å®ç½ä¸è½½å°åï¼éæ©åéçæ¬ï¼ä¸è½½å¹¶è§£åå°æ¬å°ãè§£åå½ä»¤å¦ä¸ï¼\n\n# ä»¥ä¸è§£åå½ä»¤åå«éå¯¹ zip åå tar å\nunzip apache-maven-3.6.3-bin.zip\ntar xzvf apache-maven-3.6.3-bin.tar.gz\n\n\n\n# ç¯å¢åé\n\næ·»å ç¯å¢åé maven_homeï¼å¼ä¸º maven çå®è£è·¯å¾ã\n\n# éç½® unix ç³»ç»ç¯å¢åé\n\nè¾å¥ vi /etc/profile ï¼æ·»å ç¯å¢åéå¦ä¸ï¼\n\n# maven çæ ¹è·¯å¾\nexport maven_home=/opt/maven/apache-maven-3.5.2\nexport path=$maven_home/bin:$path\n\n\næ§è¡ source /etc/profile ï¼ç«å³çæã\n\n# éç½® windows ç³»ç»ç¯å¢åé\n\nå³é® "è®¡ç®æº"ï¼éæ© "å±æ§"ï¼ä¹åç¹å» "é«çº§ç³»ç»è®¾ç½®"ï¼ç¹å»"ç¯å¢åé"ï¼æ¥è®¾ç½®ç¯å¢åéï¼æä»¥ä¸ç³»ç»åééè¦éç½®ï¼\n\n\n\n\n\n\n# æ£æµå®è£æå\n\næ£éªæ¯å¦å®è£æåï¼æ§è¡ mvn -v å½ä»¤ï¼å¦æè¾åºç±»ä¼¼ä¸é¢ç maven çæ¬ä¿¡æ¯ï¼è¯´æéç½®æåã\n\n$ mvn -v\napache maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-18t02:33:14+08:00)\nmaven home: /opt/maven/apache-maven-3.5.4\njava version: 1.8.0_191, vendor: oracle corporation, runtime: /mnt/disk1/jdk1.8.0_191/jre\ndefault locale: zh_cn, platform encoding: utf-8\nos name: "linux", version: "3.10.0-327.el7.x86_64", arch: "amd64", family: "unix"\n\n\n\n# maven éç½®æä»¶\n\nsetting.xml æä»¶æ¯ maven çé»è®¤éç½®æä»¶ï¼å¶é»è®¤è·¯å¾ä¸ºï¼<maven å®è£ç®å½>/conf/settings.xmlã\n\nå¦æéè¦ä¿®æ¹ maven éç½®ï¼ç´æ¥ä¿®æ¹ setting.xml å¹¶ä¿æå³å¯ã\n\nä¾å¦ï¼æ³è¦ä¿®æ¹æ¬å°ä»åºä½ç½®å¯ä»¥æå¦ä¸éç½®ï¼è¿æ ·ï¼ææéè¿ maven ä¸è½½æåç jar åé½ä¼å­å¨å¨ d:\\maven\\repo è·¯å¾ä¸ã\n\n<settings xmlns="http://maven.apache.org/settings/1.1.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.1.0 http://maven.apache.org/xsd/settings-1.1.0.xsd">\n  <localrepository>d:\\maven\\repo<localrepository/>\n  \x3c!-- ç¥ --\x3e\n</settings>\n\n\n\n# å¿«éå¥é¨\n\n\n# åå»º maven å·¥ç¨\n\n# åå§åå·¥ç¨\n\næ§è¡æä»¤ï¼\n\nmvn archetype:generate -dgroupid=com.mycompany.app -dartifactid=my-app -darchetypeartifactid=maven-archetype-quickstart -darchetypeversion=1.4 -dinteractivemode=false\n\n\nä¼å¨å½åè·¯å¾æ°å»ºä¸ä¸ªåä¸º my-app ç maven å·¥ç¨ï¼å¶ç®å½ç»æå¦ä¸ï¼\n\nmy-app\n|-- pom.xml\n`-- src\n    |-- main\n    |   `-- java\n    |       `-- com\n    |           `-- mycompany\n    |               `-- app\n    |                   `-- app.java\n    `-- test\n        `-- java\n            `-- com\n                `-- mycompany\n                    `-- app\n                        `-- apptest.java\n\n\nå¶ä¸­ï¼ src/main/java ç®å½åå« java æºç ï¼ src/test/java ç®å½åå« java æµè¯æºç ï¼è pom.xml æä»¶æ¯ maven å·¥ç¨çéç½®æä»¶ã\n\n# pom éç½®\n\npom.xml æ¯ maven å·¥ç¨çéç½®æä»¶ï¼å®æè¿°äº maven å·¥ç¨çæå»ºæ¹å¼ï¼å¶éç½®ä¿¡æ¯æ¯å¾å¤æçï¼è¿éç»ä¸ä¸ªæç®åçéç½®ç¤ºä¾ï¼\n\nproject xmlns="http://maven.apache.org/pom/4.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelversion>4.0.0</modelversion>\n\n  <groupid>com.mycompany.app</groupid>\n  <artifactid>my-app</artifactid>\n  <version>1.0-snapshot</version>\n\n  <properties>\n    <maven.compiler.source>1.7</maven.compiler.source>\n    <maven.compiler.target>1.7</maven.compiler.target>\n  </properties>\n\n  <dependencies>\n    <dependency>\n      <groupid>junit</groupid>\n      <artifactid>junit</artifactid>\n      <version>4.12</version>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n</project>\n\n\n# æå»ºé¡¹ç®\n\næ§è¡ä»¥ä¸å½ä»¤ï¼å³å¯æå»ºé¡¹ç®ï¼\n\nmvn clean package -dmaven.test.skip=true -b -u\n\n\næå»ºæååï¼ä¼è¾åºç±»ä¼¼ä¸é¢çä¿¡æ¯ï¼\n\n...\n[info] ------------------------------------------------------------------------\n[info] build success\n[info] ------------------------------------------------------------------------\n[info] total time:  2.953 s\n[info] finished at: 2019-11-24t13:05:10+01:00\n[info] ------------------------------------------------------------------------\n\n\nè¿æ¶ï¼å¨å½åè·¯å¾ä¸ä¼äº§çä¸ä¸ª target ç®å½ï¼å¶ä¸­åå«äºæå»ºçè¾åºç©ï¼å¦ï¼jar åãclass æä»¶ç­ã\n\nè¿æ¶ï¼æä»¬å¯ä»¥æ§è¡ä»¥ä¸å½ä»¤å¯å¨ jar åï¼\n\njava -cp target/my-app-1.0-snapshot.jar com.mycompany.app.app\n\n\n\n# å¨ intellij ä¸­åå»º maven å·¥ç¨\n\nï¼1ï¼åå»º maven å·¥ç¨\n\nä¾æ¬¡ç¹å» file -> new -> project æå¼åå»ºå·¥ç¨å¯¹è¯æ¡ï¼éæ© maven å·¥ç¨ã\n\n\n\nï¼2ï¼è¾å¥é¡¹ç®ä¿¡æ¯\n\n\n\nï¼3ï¼ç¹å» intellij ä¾§è¾¹æ ä¸­ç maven å·¥å·çé¢ï¼æå ä¸ªå¯ä»¥ç´æ¥ä½¿ç¨ç maven å½ä»¤ï¼å¯ä»¥å¸®å©ä½ è¿è¡æå»ºã\n\n\n\n\n# å¨ eclipse ä¸­åå»º maven å·¥ç¨\n\nï¼1ï¼maven æä»¶\n\nå¨ eclipse ä¸­åå»º maven å·¥ç¨ï¼éè¦å®è£ maven æä»¶ã\n\nä¸è¬è¾æ°çæ¬ç eclipse é½ä¼å¸¦æ maven æä»¶ï¼å¦æä½ ç eclipse ä¸­å·²ç»æ maven æä»¶ï¼å¯ä»¥è·³è¿è¿ä¸æ­¥éª¤ã\n\nç¹å» help -> eclipse marketplaceï¼æç´¢ maven å³é®å­ï¼éæ©å®è£çº¢æ¡å¯¹åºç maven æä»¶ã\n\n\n\nï¼2ï¼maven ç¯å¢éç½®\n\nç¹å» window -> preferences\n\nå¦ä¸å¾æç¤ºï¼éç½® settings.xml æä»¶çä½ç½®\n\n\n\nï¼3ï¼åå»º maven å·¥ç¨\n\nfile -> new -> maven project -> nextï¼å¨æ¥ä¸æ¥ççªå£ä¸­ä¼çå°ä¸å¤§å çé¡¹ç®æ¨¡æ¿ï¼éæ©åéçæ¨¡æ¿ã\n\næ¥ä¸æ¥è®¾ç½®é¡¹ç®çåæ°ï¼å¦ä¸ï¼\n\n\n\ngroupidæ¯é¡¹ç®ç»ç»å¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åº java çåçç»æï¼æ¯ main ç®å½é java çç®å½ç»æã\n\nartifactidå°±æ¯é¡¹ç®çå¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åºé¡¹ç®çåç§°ï¼å°±æ¯é¡¹ç®æ ¹ç®å½çåç§°ã\n\nç¹å» finishï¼eclipse ä¼åå»ºä¸ä¸ª maven å·¥ç¨ã\n\nï¼4ï¼ä½¿ç¨ maven è¿è¡æå»º\n\neclipse ä¸­æå»ºæ¹å¼ï¼\n\nå¨ elipse é¡¹ç®ä¸å³å» -> run as å°±è½çå°å¾å¤ maven æä½ãè¿äºæä½å maven å½ä»¤æ¯ç­æçãä¾å¦ maven cleanï¼ç­åäº mvn clean å½ä»¤ã\n\n\n\nä½ ä¹å¯ä»¥ç¹å» maven buildï¼è¾å¥ç»åå½ä»¤ï¼å¹¶ä¿å­ä¸æ¥ãå¦ä¸å¾ï¼\n\n\n\nmaven å½ä»¤æå»ºæ¹å¼ï¼\n\nå½ç¶ï¼ä½ ä¹å¯ä»¥ç´æ¥ä½¿ç¨ maven å½ä»¤è¿è¡æå»ºã\n\nè¿å¥å·¥ç¨æå¨ç®å½ï¼è¾å¥ maven å½ä»¤å°±å¯ä»¥äºã\n\n\n\n\n# ä½¿ç¨è¯´æ\n\n\n# å¦ä½æ·»å ä¾èµ\n\nå¨ maven å·¥ç¨ä¸­æ·»å ä¾èµ jar åï¼å¾ç®åï¼åªè¦å¨ pom æä»¶ä¸­å¼å¥å¯¹åºç<dependency>æ ç­¾å³å¯ã\n\nåèä¸ä¾ï¼\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n\n  <modelversion>4.0.0</modelversion>\n  <groupid>com.zp.maven</groupid>\n  <artifactid>mavendemo</artifactid>\n  <version>0.0.1-snapshot</version>\n  <packaging>jar</packaging>\n  <name>mavendemo</name>\n  <url>http://maven.apache.org</url>\n\n  <properties>\n    <project.build.sourceencoding>utf-8</project.build.sourceencoding>\n    <junit.version>3.8.1</junit.version>\n  </properties>\n\n  <dependencies>\n    <dependency>\n      <groupid>junit</groupid>\n      <artifactid>junit</artifactid>\n      <version>${junit.version}</version>\n      <scope>test</scope>\n    </dependency>\n\n    <dependency>\n      <groupid>log4j</groupid>\n      <artifactid>log4j</artifactid>\n      <version>1.2.12</version>\n      <scope>compile</scope>\n    </dependency>\n  </dependencies>\n</project>\n\n\n<dependency> æ ç­¾æå¸¸ç¨çåä¸ªå±æ§æ ç­¾ï¼\n\n * <groupid> - é¡¹ç®ç»ç»å¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åº java çåçç»æã\n * <artifactid> - é¡¹ç®å¯ä¸çæ è¯ç¬¦ï¼å®éå¯¹åºé¡¹ç®çåç§°ï¼å°±æ¯é¡¹ç®æ ¹ç®å½çåç§°ã\n * <version> - jar åççæ¬å·ãå¯ä»¥ç´æ¥å¡«çæ¬æ°å­ï¼ä¹å¯ä»¥å¨ properties æ ç­¾ä¸­è®¾ç½®å±æ§å¼ã\n * <scope> - jar åçä½ç¨èå´ãå¯ä»¥å¡«å compileãruntimeãtestãsystem å providedãç¨æ¥å¨ç¼è¯ãæµè¯ç­åºæ¯ä¸éæ©å¯¹åºç classpathã\n\n\n# å¦ä½å¯»æ¾ jar å\n\nå¯ä»¥å¨ http://mvnrepository.com/ ç«ç¹æå¯»ä½ æ³è¦ç jar åçæ¬\n\nä¾å¦ï¼æ³è¦ä½¿ç¨ log4jï¼å¯ä»¥æ¾å°éè¦ççæ¬å·ï¼ç¶åæ·è´å¯¹åºç maven æ ç­¾ä¿¡æ¯ï¼å°å¶æ·»å å° pom .xml æä»¶ä¸­ã\n\n\n# å¦ä½ä½¿ç¨ maven æä»¶(plugin)\n\nè¦æ·»å  maven æä»¶ï¼å¯ä»¥å¨ pom.xml æä»¶ä¸­æ·»å  <plugin> æ ç­¾ã\n\n<build>\n  <plugins>\n    <plugin>\n      <groupid>org.apache.maven.plugins</groupid>\n      <artifactid>maven-compiler-plugin</artifactid>\n      <version>3.3</version>\n      <configuration>\n        <source>1.7</source>\n        <target>1.7</target>\n      </configuration>\n    </plugin>\n  </plugins>\n</build>\n\n\n<configuration> æ ç­¾ç¨æ¥éç½®æä»¶çä¸äºä½¿ç¨åæ°ã\n\n\n# å¦ä½ä¸æ¬¡ç¼è¯å¤ä¸ªå·¥ç¨\n\nåè®¾è¦åå»ºä¸ä¸ªç¶ maven å·¥ç¨ï¼å®æä¸¤ä¸ªå­å·¥ç¨ï¼my-app å my-webappï¼\n\n+- pom.xml\n+- my-app\n| +- pom.xml\n| +- src\n|   +- main\n|     +- java\n+- my-webapp\n| +- pom.xml\n| +- src\n|   +- main\n|     +- webapp\n\n\napp å·¥ç¨ç pom.xml å¦ä¸ï¼éç¹å¨äºå¨ modules ä¸­å¼å¥ä¸¤ä¸ªå­ moduleï¼\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelversion>4.0.0</modelversion>\n\n  <groupid>com.mycompany.app</groupid>\n  <artifactid>app</artifactid>\n  <version>1.0-snapshot</version>\n  <packaging>pom</packaging>\n\n  <modules>\n    <module>my-app</module>\n    <module>my-webapp</module>\n  </modules>\n</project>\n\n\néæ©ç¼è¯ xxx æ¶ï¼ä¼ä¾æ¬¡å¯¹å®çææ module æ§è¡ç¸åæä½ã\n\n\n# å¸¸ç¨ maven æä»¶\n\n> æ´å¤è¯¦æè¯·åèï¼https://maven.apache.org/plugins/\n\n# maven-antrun-plugin\n\nmaven-antrun-plugin è½è®©ç¨æ·å¨ maven é¡¹ç®ä¸­è¿è¡ ant ä»»å¡ãç¨æ·å¯ä»¥ç´æ¥å¨è¯¥æä»¶çéç½®ä»¥ ant çæ¹å¼ç¼å targetï¼ ç¶åäº¤ç»è¯¥æä»¶ç run ç®æ å»æ§è¡ãå¨ä¸äºç± ant å¾ maven è¿ç§»çé¡¹ç®ä¸­ï¼è¯¥æä»¶å°¤å¶æç¨ãæ­¤å¤å½ä½ åç°éè¦ç¼åä¸äºèªå®ä¹ç¨åº¦å¾é«çä»»å¡ï¼åæ¶åè§ å¾ maven ä¸å¤çµæ´»æ¶ï¼ä¹å¯ä»¥ä»¥ ant çæ¹å¼å®ç°ä¹ãmaven-antrun-plugin ç run ç®æ éå¸¸ä¸çå½å¨æç»å®è¿è¡ã\n\n# maven-archetype-plugin\n\narchtype æé¡¹ç®çéª¨æ¶ï¼maven åå­¦èæå¼å§æ§è¡ç maven å½ä»¤å¯è½å°±æ¯mvn archetype:generateï¼è¿å®éä¸å°±æ¯è®© maven-archetype-plugin çæä¸ä¸ªå¾ç®åçé¡¹ç®éª¨æ¶ï¼å¸®å©å¼åèå¿«éä¸æãå¯è½ä¹æäººçå°ä¸äºææ¡£åäºmvn archetype:createï¼ ä½å®éä¸ create ç®æ å·²ç»è¢«å¼ç¨äºï¼åèä»£ä¹çæ¯ generate ç®æ ï¼è¯¥ç®æ ä½¿ç¨äº¤äºå¼çæ¹å¼æç¤ºç¨æ·è¾å¥å¿è¦çä¿¡æ¯ä»¥åå»ºé¡¹ç®ï¼ä½éªæ´å¥½ã maven-archetype-plugin è¿æä¸äºå¶ä»ç®æ å¸®å©ç¨æ·èªå·±å®ä¹é¡¹ç®ååï¼ä¾å¦ä½ ç±ä¸ä¸ªäº§åéè¦äº¤ä»ç»å¾å¤å®¢æ·è¿è¡äºæ¬¡å¼åï¼ä½ å°±å¯ä»¥ä¸º ä»ä»¬æä¾ä¸ä¸ª archtypeï¼å¸®å©ä»ä»¬å¿«éä¸æã\n\n# maven-assembly-plugin\n\nmaven-assembly-plugin çç¨éæ¯å°é¡¹ç®æåï¼è¯¥åå¯è½åå«äºé¡¹ç®çå¯æ§è¡æä»¶ãæºä»£ç ãreadmeãå¹³å°èæ¬ç­ç­ã maven-assembly-plugin æ¯æåç§ä¸»æµçæ ¼å¼å¦ zipãtar.gzãjar å war ç­ï¼å·ä½æååªäºæä»¶æ¯é«åº¦å¯æ§çï¼ä¾å¦ç¨æ·å¯ä»¥ ææä»¶çº§å«çç²åº¦ãæä»¶éçº§å«çç²åº¦ãæ¨¡åçº§å«çç²åº¦ãä»¥åä¾èµçº§å«çç²åº¦æ§å¶æåï¼æ­¤å¤ï¼åå«åæé¤éç½®ä¹æ¯æ¯æçãmaven-assembly- plugin è¦æ±ç¨æ·ä½¿ç¨ä¸ä¸ªåä¸ºassembly.xmlçåæ°æ®æä»¶æ¥è¡¨è¿°æåï¼å®ç single ç®æ å¯ä»¥ç´æ¥å¨å½ä»¤è¡è°ç¨ï¼ä¹å¯ä»¥è¢«ç»å®è³çå½å¨æã\n\n# maven-dependency-plugin\n\nmaven-dependency-plugin æå¤§çç¨éæ¯å¸®å©åæé¡¹ç®ä¾èµï¼dependency:listè½å¤ååºé¡¹ç®æç»è§£æå°çä¾èµåè¡¨ï¼dependency:treeè½è¿ä¸æ­¥çæç»é¡¹ç®ä¾èµæ ï¼dependency:analyzeå¯ä»¥åè¯ä½ é¡¹ç®ä¾èµæ½å¨çé®é¢ï¼å¦æä½ æç´æ¥ä½¿ç¨å°çå´æªå£°æçä¾èµï¼è¯¥ç®æ å°±ä¼ååºè­¦åãmaven-dependency-plugin è¿æå¾å¤ç®æ å¸®å©ä½ æä½ä¾èµæä»¶ï¼ä¾å¦dependency:copy-dependenciesè½å°é¡¹ç®ä¾èµä»æ¬å° maven ä»åºå¤å¶å°æä¸ªç¹å®çæä»¶å¤¹ä¸é¢ã\n\n# maven-enforcer-plugin\n\nå¨ä¸ä¸ªç¨å¤§ä¸ç¹çç»ç»æå¢éä¸­ï¼ä½ æ æ³ä¿è¯æææåé½çæ mavenï¼é£ä»ä»¬åä¸äºæ¯è¾æè ¢çäºæå°±ä¼åå¾å¾æ­£å¸¸ï¼ä¾å¦ç»é¡¹ç®å¼å¥äºå¤é¨ç snapshot ä¾èµèå¯¼è´æå»ºä¸ç¨³å®ï¼ä½¿ç¨äºä¸ä¸ªä¸å¤§å®¶ä¸ä¸è´ç maven çæ¬èç»å¸¸æ±æ¨æå»ºåºç°è¯¡å¼é®é¢ãmaven-enforcer- plugin è½å¤å¸®å©ä½ é¿åä¹ç±»é®é¢ï¼å®åè®¸ä½ åå»ºä¸ç³»åè§åå¼ºå¶å¤§å®¶éµå®ï¼åæ¬è®¾å® java çæ¬ãè®¾å® maven çæ¬ãç¦æ­¢æäºä¾èµãç¦æ­¢ snapshot ä¾èµãåªè¦å¨ä¸ä¸ªç¶ pom éç½®è§åï¼ç¶åè®©å¤§å®¶ç»§æ¿ï¼å½è§åé­å°ç ´åçæ¶åï¼maven å°±ä¼æ¥éãé¤äºæ åçè§åä¹å¤ï¼ä½ è¿å¯ä»¥æ©å±è¯¥æ ä»¶ï¼ç¼åèªå·±çè§åãmaven-enforcer-plugin ç enforce ç®æ è´è´£æ£æ¥è§åï¼å®é»è®¤ç»å®å°çå½å¨æç validate é¶æ®µã\n\n# maven-help-plugin\n\nmaven-help-plugin æ¯ä¸ä¸ªå°å·§çè¾å©å·¥å·ï¼æç®åçhelp:systemå¯ä»¥æå°ææå¯ç¨çç¯å¢åéå java ç³»ç»å±æ§ãhelp:effective-pomåhelp:effective-settingsæ ä¸ºæç¨ï¼å®ä»¬åå«æå°é¡¹ç®çææ pom åææ settingsï¼ææ pom æ¯æåå¹¶äºææç¶ pomï¼åæ¬ super pomï¼åç xmlï¼å½ä½ ä¸ç¡®å® pom çæäºä¿¡æ¯ä»ä½èæ¥æ¶ï¼å°±å¯ä»¥æ¥çææ pomãææ settings åçï¼ç¹å«æ¯å½ä½ åç°èªå·±éç½®ç settings.xml æ²¡æçææ¶ï¼å°±å¯ä»¥ç¨help:effective-settingsæ¥éªè¯ãæ­¤å¤ï¼maven-help-plugin ç describe ç®æ å¯ä»¥å¸®å©ä½ æè¿°ä»»ä½ä¸ä¸ª maven æä»¶çä¿¡æ¯ï¼è¿æ all-profiles ç®æ å active-profiles ç®æ å¸®å©æ¥çé¡¹ç®ç profileã\n\n# maven-release-plugin\n\nmaven-release-plugin çç¨éæ¯å¸®å©èªå¨åé¡¹ç®çæ¬åå¸ï¼å®ä¾èµäº pom ä¸­ç scm ä¿¡æ¯ãrelease:prepareç¨æ¥åå¤çæ¬åå¸ï¼å·ä½çå·¥ä½åæ¬æ£æ¥æ¯å¦ææªæäº¤ä»£ç ãæ£æ¥æ¯å¦æ snapshot ä¾èµãåçº§é¡¹ç®ç snapshot çæ¬è³ release çæ¬ãä¸ºé¡¹ç®ææ ç­¾ç­ç­ãrelease:performå æ¯ç­¾åºæ ç­¾ä¸­ç release æºç ï¼æå»ºå¹¶åå¸ãçæ¬åå¸æ¯éå¸¸çç¢çå·¥ä½ï¼å®æ¶åäºåç§æ£æ¥ï¼èä¸ç±äºè¯¥å·¥ä½ä»ä»æ¯å¶å°éè¦ï¼å æ­¤æå¨æä½å¾å®¹æéæ¼ä¸ äºç»èï¼maven-release-plugin è®©è¯¥å·¥ä½åå¾éå¸¸å¿«éç®ä¾¿ï¼ä¸æåºéãmaven-release-plugin çåç§ç®æ éå¸¸ç´æ¥å¨ å½ä»¤è¡è°ç¨ï¼å ä¸ºçæ¬åå¸æ¾ç¶ä¸æ¯æ¥å¸¸æå»ºçå½å¨æçä¸é¨åã\n\n# maven-resources-plugin\n\nä¸ºäºä½¿é¡¹ç®ç»ææ´ä¸ºæ¸æ°ï¼maven åºå«å¯¹å¾ java ä»£ç æä»¶åèµæºæä»¶ï¼maven-compiler-plugin ç¨æ¥ç¼è¯ java ä»£ç ï¼maven-resources-plugin åç¨æ¥å¤çèµæºæä»¶ãé»è®¤çä¸»èµæºæä»¶ç®å½æ¯src/main/resourcesï¼å¾å¤ç¨æ·ä¼éè¦æ·»å é¢å¤çèµæºæä»¶ç®å½ï¼è¿ä¸ªæ¶åå°±å¯ä»¥éè¿éç½® maven-resources-plugin æ¥å®ç°ãæ­¤å¤ï¼èµæºæä»¶è¿æ»¤ä¹æ¯ maven çä¸å¤§ç¹æ§ï¼ä½ å¯ä»¥å¨èµæºæä»¶ä¸­ä½¿ç¨*${propertyname}*å½¢å¼ç maven å±æ§ï¼ç¶åéç½® maven-resources-plugin å¼å¯å¯¹èµæºæä»¶çè¿æ»¤ï¼ä¹åå°±å¯ä»¥éå¯¹ä¸åç¯å¢éè¿å½ä»¤è¡æè profile ä¼ å¥å±æ§çå¼ï¼ä»¥å®ç°æ´ä¸ºçµæ´»çæå»ºã\n\n# maven-surefire-plugin\n\nå¯è½æ¯ç±äºåå²çåå ï¼maven 2.3 ä¸­ç¨äºæ§è¡æµè¯çæä»¶ä¸æ¯ maven-test-pluginï¼èæ¯ maven-surefire-pluginãå¶å®å¤§é¨åæ¶é´åï¼åªè¦ä½ çæµè¯ ç±»éµå¾ªéç¨çå½ä»¤çº¦å®ï¼ä»¥ test ç»å°¾ãä»¥ testcase ç»å°¾ãæèä»¥ test å¼å¤´ï¼ï¼å°±å ä¹ä¸ç¨ç¥æè¯¥æä»¶çå­å¨ãç¶èå¨å½ä½ æ³è¦è·³è¿æµè¯ãæé¤æäº æµè¯ç±»ãæèä½¿ç¨ä¸äº testng ç¹æ§çæ¶åï¼äºè§£ maven-surefire-plugin çä¸äºéç½®éé¡¹å°±å¾æç¨äºãä¾å¦ mvn test -dtest=footest è¿æ ·ä¸æ¡å½ä»¤çæææ¯ä»è¿è¡ footest æµè¯ç±»ï¼è¿æ¯éè¿æ§å¶ maven-surefire-plugin ç test åæ°å®ç°çã\n\n# build-helper-maven-plugin\n\nmaven é»è®¤åªåè®¸æå®ä¸ä¸ªä¸» java ä»£ç ç®å½åä¸ä¸ªæµè¯ java ä»£ç ç®å½ï¼è½ç¶è¿å¶å®æ¯ä¸ªåºå½å°½ééµå®ççº¦å®ï¼ä½å¶å°ä½ è¿æ¯ä¼å¸æè½å¤æå®å¤ä¸ª æºç ç®å½ï¼ä¾å¦ä¸ºäºåºå¯¹éçé¡¹ç®ï¼ï¼build-helper-maven-plugin ç add-source ç®æ å°±æ¯æå¡äºè¿ä¸ªç®çï¼éå¸¸å®è¢«ç»å®å° é»è®¤çå½å¨æç generate-sources é¶æ®µä»¥æ·»å é¢å¤çæºç ç®å½ãéè¦å¼ºè°çæ¯ï¼è¿ç§åæ³è¿æ¯ä¸æ¨èçï¼å ä¸ºå®ç ´åäº maven ççº¦å®ï¼èä¸å¯è½ä¼éå°å¶ä»ä¸¥æ ¼éµå®çº¦å®çæä»¶å·¥å·æ æ³æ­£ç¡®è¯å«é¢å¤çæºç ç®å½ã\n\nbuild-helper-maven-plugin çå¦ä¸ä¸ªéå¸¸æç¨çç®æ æ¯ attach-artifactï¼ä½¿ç¨è¯¥ç®æ ä½ å¯ä»¥ä»¥ classifier çå½¢å¼éåé¨åé¡¹ç®æä»¶çæéå±æä»¶ï¼å¹¶åæ¶ install å°æ¬å°ä»åºï¼ä¹å¯ä»¥ deploy å°è¿ç¨ä»åºã\n\n# exec-maven-plugin\n\nexec-maven-plugin å¾å¥½çè§£ï¼é¡¾åæä¹ï¼å®è½è®©ä½ è¿è¡ä»»ä½æ¬å°çç³»ç»ç¨åºï¼å¨æäºç¹å®æåµä¸ï¼è¿è¡ä¸ä¸ª maven å¤é¨çç¨åºå¯è½å°±æ¯æç®åçé®é¢è§£å³æ¹æ¡ï¼è¿å°±æ¯exec:execç ç¨éï¼å½ç¶ï¼è¯¥æä»¶è¿åè®¸ä½ éç½®ç¸å³çç¨åºè¿è¡åæ°ãé¤äº exec ç®æ ä¹å¤ï¼exec-maven-plugin è¿æä¾äºä¸ä¸ª java ç®æ ï¼è¯¥ç®æ è¦æ±ä½  æä¾ä¸ä¸ª mainclass åæ°ï¼ç¶åå®è½å¤å©ç¨å½åé¡¹ç®çä¾èµä½ä¸º classpathï¼å¨åä¸ä¸ª jvm ä¸­è¿è¡è¯¥ mainclassãææ¶åï¼ä¸ºäºç®åç æ¼ç¤ºä¸ä¸ªå½ä»¤è¡ java ç¨åºï¼ä½ å¯ä»¥å¨ pom ä¸­éç½®å¥½ exec-maven-plugin çç¸å³è¿è¡åæ°ï¼ç¶åç´æ¥å¨å½ä»¤è¿è¡mvn exec:java ä»¥æ¥çè¿è¡ææã\n\n# jetty-maven-plugin\n\nå¨è¿è¡ web å¼åçæ¶åï¼æå¼æµè§å¨å¯¹åºç¨è¿è¡æå¨çæµè¯å ä¹æ¯æ æ³é¿åçï¼è¿ç§æµè¯æ¹æ³éå¸¸å°±æ¯å°é¡¹ç®æåæ war æä»¶ï¼ç¶åé¨ç½²å° web å®¹å¨ ä¸­ï¼åå¯å¨å®¹å¨è¿è¡éªè¯ï¼è¿æ¾ç¶ååèæ¶ãä¸ºäºå¸®å©å¼åèèçæ¶é´ï¼jetty-maven-plugin åºè¿èçï¼å®å®å¨å¼å®¹ maven é¡¹ç®çç®å½ç»æï¼è½å¤å¨ææ§å°æ£æ¥æºæä»¶ï¼ä¸æ¦åç°åæ´åèªå¨æ´æ°å°åç½®ç jetty web å®¹å¨ä¸­ãåä¸äºåºæ¬éç½®åï¼ä¾å¦ web åºç¨ç contextpath åèªå¨æ«æåæ´çæ¶é´é´éï¼ï¼ä½ åªè¦æ§è¡ mvn jetty:run ï¼ç¶åå¨ ide ä¸­ä¿®æ¹ä»£ç ï¼ä»£ç ç» ide èªå¨ç¼è¯åäº§çåæ´ï¼åç± jetty-maven-plugin ä¾¦æµå°åæ´æ°è³ jetty å®¹å¨ï¼è¿æ¶ä½ å°±å¯ä»¥ç´æ¥ æµè¯ web é¡µé¢äºãéè¦æ³¨æçæ¯ï¼jetty-maven-plugin å¹¶ä¸æ¯å®¿ä¸»äº apache æ codehaus çå®æ¹æä»¶ï¼å æ­¤ä½¿ç¨çæ¶åéè¦é¢å¤ çéç½®settings.xmlç plugingroups åç´ ï¼å° org.mortbay.jetty è¿ä¸ª plugingroup å å¥ã\n\n# versions-maven-plugin\n\nå¾å¤ maven ç¨æ·éå°è¿è¿æ ·ä¸ä¸ªé®é¢ï¼å½é¡¹ç®åå«å¤§éæ¨¡åçæ¶åï¼ä¸ºä»ä»¬éä½æ´æ°çæ¬å°±åæä¸ä»¶ç¦äººçäºæï¼å°åºææ²¡æèªå¨åå·¥å·è½å¸®å©å®æè¿ä»¶ äºæå¢ï¼ï¼å½ç¶ä½ å¯ä»¥ä½¿ç¨ sed ä¹ç±»çææ¬æä½å·¥å·ï¼ä¸è¿ä¸å¨æ¬æè®¨è®ºèå´ï¼ç­æ¡æ¯è¯å®çï¼versions-maven- plugin æä¾äºå¾å¤ç®æ å¸®å©ä½ ç®¡ç maven é¡¹ç®çåç§çæ¬ä¿¡æ¯ãä¾å¦æå¸¸ç¨çï¼å½ä»¤ mvn versions:set -dnewversion=1.1-snapshot å°±è½å¸®å©ä½ ææææ¨¡åççæ¬æ´æ°å° 1.1-snapshotãè¯¥æä»¶è¿æä¾äºå¶ä»ä¸äºå¾æç¨çç®æ ï¼display-dependency- updates è½åè¯ä½ é¡¹ç®ä¾èµæåªäºå¯ç¨çæ´æ°ï¼ç±»ä¼¼ç display-plugin-updates è½åè¯ä½ å¯ç¨çæä»¶æ´æ°ï¼ç¶å use- latest-versions è½èªå¨å¸®ä½ å°ææä¾èµåçº§å°ææ°çæ¬ãæåï¼å¦æä½ å¯¹æåçæ´æ¹æ»¡æï¼åå¯ä»¥ä½¿ç¨ mvn versions:commit æäº¤ï¼ä¸æ»¡æçè¯ä¹å¯ä»¥ä½¿ç¨ mvn versions:revert è¿è¡æ¤éã\n\n\n# maven å½ä»¤\n\nå¸¸ç¨ maven å½ä»¤æ¸åï¼\n\nçå½å¨æ                          é¶æ®µæè¿°\nmvn validate                  éªè¯é¡¹ç®æ¯å¦æ­£ç¡®ï¼ä»¥åææä¸ºäºå®æ´æå»ºå¿è¦çä¿¡æ¯æ¯å¦å¯ç¨\nmvn generate-sources          çæææéè¦åå«å¨ç¼è¯è¿ç¨ä¸­çæºä»£ç \nmvn process-sources           å¤çæºä»£ç ï¼æ¯å¦è¿æ»¤ä¸äºå¼\nmvn generate-resources        çæææéè¦åå«å¨æåè¿ç¨ä¸­çèµæºæä»¶\nmvn process-resources         å¤å¶å¹¶å¤çèµæºæä»¶è³ç®æ ç®å½ï¼åå¤æå\nmvn compile                   ç¼è¯é¡¹ç®çæºä»£ç \nmvn process-classes           åå¤çç¼è¯çæçæä»¶ï¼ä¾å¦å¯¹ java ç±»è¿è¡å­èç å¢å¼ºï¼bytecode enhancementï¼\nmvn generate-test-sources     çæææåå«å¨æµè¯ç¼è¯è¿ç¨ä¸­çæµè¯æºç \nmvn process-test-sources      å¤çæµè¯æºç ï¼æ¯å¦è¿æ»¤ä¸äºå¼\nmvn generate-test-resources   çææµè¯éè¦çèµæºæä»¶\nmvn process-test-resources    å¤å¶å¹¶å¤çæµè¯èµæºæä»¶è³æµè¯ç®æ ç®å½\nmvn test-compile              ç¼è¯æµè¯æºç è³æµè¯ç®æ ç®å½\nmvn test                      ä½¿ç¨åéçååæµè¯æ¡æ¶è¿è¡æµè¯ãè¿äºæµè¯åºè¯¥ä¸éè¦ä»£ç è¢«æåæåå¸\nmvn prepare-package           å¨çæ­£çæåä¹åï¼æ§è¡ä¸äºåå¤æåå¿è¦çæä½ãè¿éå¸¸ä¼äº§çä¸ä¸ªåçå±å¼çå¤çè¿ççæ¬ï¼å°ä¼å¨ maven\n                              2.1+ä¸­å®ç°ï¼\nmvn package                   å°ç¼è¯å¥½çä»£ç æåæå¯ååçæ ¼å¼ï¼å¦ jarï¼warï¼æè ear\nmvn pre-integration-test      æ§è¡ä¸äºå¨éææµè¯è¿è¡ä¹åéè¦çå¨ä½ãå¦å»ºç«éææµè¯éè¦çç¯å¢\nmvn integration-test          å¦ææå¿è¦çè¯ï¼å¤çåå¹¶åå¸è³éææµè¯å¯ä»¥è¿è¡çç¯å¢\nmvn post-integration-test     æ§è¡ä¸äºå¨éææµè¯è¿è¡ä¹åéè¦çå¨ä½ãå¦æ¸çéææµè¯ç¯å¢ã\nmvn verify                    æ§è¡æææ£æ¥ï¼éªè¯åæ¯ææçï¼ç¬¦åè´¨éè§è\nmvn install                   å®è£åè³æ¬å°ä»åºï¼ä»¥å¤æ¬å°çå¶å®é¡¹ç®ä½ä¸ºä¾èµä½¿ç¨\nmvn deploy                    å¤å¶æç»çåè³è¿ç¨ä»åºï¼å±äº«ç»å¶å®å¼åäººååé¡¹ç®ï¼éå¸¸åä¸æ¬¡æ­£å¼çåå¸ç¸å³ï¼\n\nç¤ºä¾ï¼æå¸¸ç¨ç maven æå»ºå½ä»¤\n\nmvn clean install -dmaven.test.skip=true -b -u\n\n\næ¸çæ¬å°è¾åºç©ï¼å¹¶æå»º maven é¡¹ç®ï¼æåå°è¾åºç©å½æ¡£å¨æ¬å°ä»åºã\n\n> ð¡ æ³äºè§£æ´å¤ maven å½ä»¤è¡ç»èå¯ä»¥åèå®æ¹ææ¡£ï¼\n> \n>  * maven æå»ºçå½å¨æè¯´æ\n>  * maven å½ä»¤è¡åæ°è¯´æ\n\n\n# åèèµæ\n\n * maven github\n * maven å®æ¹ææ¡£\n * maven in 5 minutes\n * maven getting started guide\n * maven å¸¸è§é®é¢é®ç­\n * å¸¸ç¨ maven æä»¶ä»ç»',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven æç¨ä¹ pom.xml è¯¦è§£",frontmatter:{title:"Maven æç¨ä¹ pom.xml è¯¦è§£",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],abbrlink:"15944f49",date:"2019-05-14T14:57:33.000Z",permalink:"/pages/f594fa/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/02.Maven%E6%95%99%E7%A8%8B%E4%B9%8Bpom.xml%E8%AF%A6%E8%A7%A3.html",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/02.Mavenæç¨ä¹pom.xmlè¯¦è§£.md",key:"v-101ee2a2",path:"/pages/f594fa/",headers:[{level:2,title:"pom.xml ç®ä»",slug:"pom-xml-ç®ä»",normalizedTitle:"pom.xml ç®ä»",charIndex:27},{level:3,title:"ä»ä¹æ¯ pom",slug:"ä»ä¹æ¯-pom",normalizedTitle:"ä»ä¹æ¯ pom",charIndex:42},{level:3,title:"pom éç½®ä¸è§",slug:"pom-éç½®ä¸è§",normalizedTitle:"pom éç½®ä¸è§",charIndex:132},{level:2,title:"åºæ¬éç½®",slug:"åºæ¬éç½®",normalizedTitle:"åºæ¬éç½®",charIndex:1434},{level:3,title:"maven åæ ",slug:"maven-åæ ",normalizedTitle:"maven åæ ",charIndex:2019},{level:2,title:"ä¾èµéç½®",slug:"ä¾èµéç½®",normalizedTitle:"ä¾èµéç½®",charIndex:2864},{level:3,title:"dependencies",slug:"dependencies",normalizedTitle:"dependencies",charIndex:546},{level:3,title:"parent",slug:"parent",normalizedTitle:"parent",charIndex:581},{level:3,title:"dependencyManagement",slug:"dependencymanagement",normalizedTitle:"dependencymanagement",charIndex:604},{level:3,title:"modules",slug:"modules",normalizedTitle:"modules",charIndex:655},{level:3,title:"properties",slug:"properties",normalizedTitle:"properties",charIndex:680},{level:2,title:"æå»ºéç½®",slug:"æå»ºéç½®",normalizedTitle:"æå»ºéç½®",charIndex:6541},{level:3,title:"build",slug:"build",normalizedTitle:"build",charIndex:738},{level:4,title:"resources",slug:"resources",normalizedTitle:"resources",charIndex:7639},{level:4,title:"plugins",slug:"plugins",normalizedTitle:"plugins",charIndex:5540},{level:4,title:"pluginManagement",slug:"pluginmanagement",normalizedTitle:"pluginmanagement",charIndex:5548},{level:4,title:"directories",slug:"directories",normalizedTitle:"directories",charIndex:11477},{level:4,title:"extensions",slug:"extensions",normalizedTitle:"extensions",charIndex:9500},{level:3,title:"reporting",slug:"reporting",normalizedTitle:"reporting",charIndex:759},{level:2,title:"é¡¹ç®ä¿¡æ¯",slug:"é¡¹ç®ä¿¡æ¯",normalizedTitle:"é¡¹ç®ä¿¡æ¯",charIndex:14128},{level:2,title:"ç¯å¢éç½®",slug:"ç¯å¢éç½®",normalizedTitle:"ç¯å¢éç½®",charIndex:15966},{level:3,title:"issueManagement",slug:"issuemanagement",normalizedTitle:"issuemanagement",charIndex:1092},{level:3,title:"ciManagement",slug:"cimanagement",normalizedTitle:"cimanagement",charIndex:1133},{level:3,title:"mailingLists",slug:"mailinglists",normalizedTitle:"mailinglists",charIndex:1168},{level:3,title:"scm",slug:"scm",normalizedTitle:"scm",charIndex:1203},{level:3,title:"prerequisites",slug:"prerequisites",normalizedTitle:"prerequisites",charIndex:1220},{level:3,title:"repositories",slug:"repositories",normalizedTitle:"repositories",charIndex:1257},{level:3,title:"pluginRepositories",slug:"pluginrepositories",normalizedTitle:"pluginrepositories",charIndex:1292},{level:3,title:"distributionManagement",slug:"distributionmanagement",normalizedTitle:"distributionmanagement",charIndex:1339},{level:3,title:"profiles",slug:"profiles",normalizedTitle:"profiles",charIndex:1394},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:21784}],headersStr:"pom.xml ç®ä» ä»ä¹æ¯ pom pom éç½®ä¸è§ åºæ¬éç½® maven åæ  ä¾èµéç½® dependencies parent dependencyManagement modules properties æå»ºéç½® build resources plugins pluginManagement directories extensions reporting é¡¹ç®ä¿¡æ¯ ç¯å¢éç½® issueManagement ciManagement mailingLists scm prerequisites repositories pluginRepositories distributionManagement profiles åèèµæ",content:'# Maven æç¨ä¹ pom.xml è¯¦è§£\n\n\n# pom.xml ç®ä»\n\n\n# ä»ä¹æ¯ pom\n\nPOM æ¯ Project Object Model çç¼©åï¼å³é¡¹ç®å¯¹è±¡æ¨¡åã\n\npom.xml å°±æ¯ maven çéç½®æä»¶ï¼ç¨ä»¥æè¿°é¡¹ç®çåç§ä¿¡æ¯ã\n\n\n# pom éç½®ä¸è§\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelVersion>4.0.0</modelVersion>\n\n  \x3c!-- The Basics --\x3e\n  <groupId>...</groupId>\n  <artifactId>...</artifactId>\n  <version>...</version>\n  <packaging>...</packaging>\n  <dependencies>...</dependencies>\n  <parent>...</parent>\n  <dependencyManagement>...</dependencyManagement>\n  <modules>...</modules>\n  <properties>...</properties>\n\n  \x3c!-- Build Settings --\x3e\n  <build>...</build>\n  <reporting>...</reporting>\n\n  \x3c!-- More Project Information --\x3e\n  <name>...</name>\n  <description>...</description>\n  <url>...</url>\n  <inceptionYear>...</inceptionYear>\n  <licenses>...</licenses>\n  <organization>...</organization>\n  <developers>...</developers>\n  <contributors>...</contributors>\n\n  \x3c!-- Environment Settings --\x3e\n  <issueManagement>...</issueManagement>\n  <ciManagement>...</ciManagement>\n  <mailingLists>...</mailingLists>\n  <scm>...</scm>\n  <prerequisites>...</prerequisites>\n  <repositories>...</repositories>\n  <pluginRepositories>...</pluginRepositories>\n  <distributionManagement>...</distributionManagement>\n  <profiles>...</profiles>\n</project>\n\n\n\n# åºæ¬éç½®\n\n * project - project æ¯ pom.xml ä¸­æè¿°ç¬¦çæ ¹ã\n * modelVersion - modelVersion æå® pom.xml ç¬¦ååªä¸ªçæ¬çæè¿°ç¬¦ãmaven 2 å 3 åªè½ä¸º 4.0.0ã\n\nä¸è¬ jar åè¢«è¯å«ä¸ºï¼ groupId:artifactId:version çå½¢å¼ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelVersion>4.0.0</modelVersion>\n\n  <groupId>org.codehaus.mojo</groupId>\n  <artifactId>my-project</artifactId>\n  <version>1.0</version>\n  <packaging>war</packaging>\n</project>\n\n\n\n# maven åæ \n\nå¨ maven ä¸­ï¼æ ¹æ® groupIdãartifactIdãversion ç»åæ groupId:artifactId:version æ¥å¯ä¸è¯å«ä¸ä¸ª jar åã\n\n * groupId - å¢ä½ãç»ç»çæ è¯ç¬¦ãå¢ä½æ è¯ççº¦å®æ¯ï¼å®ä»¥åå»ºè¿ä¸ªé¡¹ç®çç»ç»åç§°çéååå(reverse domain name)å¼å¤´ãä¸è¬å¯¹åºç java çåç»æã\n * artifactId - åç¬é¡¹ç®çå¯ä¸æ è¯ç¬¦ãæ¯å¦æä»¬ç tomcatãcommons ç­ãä¸è¦å¨ artifactId ä¸­åå«ç¹å·(.)ã\n * version - ä¸ä¸ªé¡¹ç®çç¹å®çæ¬ã\n   * maven æèªå·±ççæ¬è§èï¼ä¸è¬æ¯å¦ä¸å®ä¹ major versionãminor versionãincremental version-qualifier ï¼æ¯å¦ 1.2.3-beta-01ãè¦è¯´æçæ¯ï¼maven èªå·±å¤æ­çæ¬çç®æ³æ¯ majorãminorãincremental é¨åç¨æ°å­æ¯è¾ï¼qualifier é¨åç¨å­ç¬¦ä¸²æ¯è¾ï¼æä»¥è¦å°å¿ alpha-2 å alpha-15 çæ¯è¾å³ç³»ï¼æå¥½ç¨ alpha-02 çæ ¼å¼ã\n   * maven å¨çæ¬ç®¡çæ¶åå¯ä»¥ä½¿ç¨å ä¸ªç¹æ®çå­ç¬¦ä¸² SNAPSHOTãLATESTãRELEASEãæ¯å¦ 1.0-SNAPSHOTãåä¸ªé¨åçå«ä¹åå¤çé»è¾å¦ä¸è¯´æï¼\n     * SNAPSHOT - è¿ä¸ªçæ¬ä¸è¬ç¨äºå¼åè¿ç¨ä¸­ï¼è¡¨ç¤ºä¸ç¨³å®ççæ¬ã\n     * LATEST - ææä¸ªç¹å®æä»¶çææ°åå¸ï¼è¿ä¸ªåå¸å¯è½æ¯ä¸ä¸ªåå¸çï¼ä¹å¯è½æ¯ä¸ä¸ª snapshot çï¼å·ä½çåªä¸ªæ¶é´æåã\n     * RELEASE ï¼ææåä¸ä¸ªåå¸çã\n * packaging - é¡¹ç®çç±»åï¼æè¿°äºé¡¹ç®æååçè¾åºï¼é»è®¤æ¯ jarãå¸¸è§çè¾åºç±»åä¸ºï¼pom, jar, maven-plugin, ejb, war, ear, rar, parã\n\n\n# ä¾èµéç½®\n\n\n# dependencies\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <dependencies>\n    <dependency>\n     <groupId>org.apache.maven</groupId>\n      <artifactId>maven-embedder</artifactId>\n      <version>2.0</version>\n      <type>jar</type>\n      <scope>test</scope>\n      <optional>true</optional>\n      <exclusions>\n        <exclusion>\n          <groupId>org.apache.maven</groupId>\n          <artifactId>maven-core</artifactId>\n        </exclusion>\n      </exclusions>\n    </dependency>\n    ...\n  </dependencies>\n  ...\n</project>\n\n\n * groupId, artifactId, version - ååºæ¬éç½®ä¸­ç groupIdãartifactIdãversion æä¹ç¸åã\n * type - å¯¹åº packaging çç±»åï¼å¦æä¸ä½¿ç¨ type æ ç­¾ï¼maven é»è®¤ä¸º jarã\n * scope - æ­¤åç´ æçæ¯ä»»å¡çç±»è·¯å¾ï¼ç¼è¯åè¿è¡æ¶ï¼æµè¯ç­ï¼ä»¥åå¦ä½éå¶ä¾èµå³ç³»çä¼ éæ§ãæ 5 ç§å¯ç¨çéå®èå´ï¼\n   * compile - å¦ææ²¡ææå® scope æ ç­¾ï¼maven é»è®¤ä¸ºè¿ä¸ªèå´ãç¼è¯ä¾èµå³ç³»å¨ææ classpath ä¸­é½å¯ç¨ãæ­¤å¤ï¼è¿äºä¾èµå³ç³»è¢«ä¼ æ­å°ä¾èµé¡¹ç®ã\n   * provided - ä¸ compile ç±»ä¼¼ï¼ä½æ¯è¡¨ç¤ºæ¨å¸æ jdk æå®¹å¨å¨è¿è¡æ¶æä¾å®ãå®åªéç¨äºç¼è¯åæµè¯ classpathï¼ä¸å¯ä¼ éã\n   * runtime - æ­¤èå´è¡¨ç¤ºç¼è¯ä¸éè¦ä¾èµå³ç³»ï¼èæ¯ç¨äºæ§è¡ãå®æ¯å¨è¿è¡æ¶åæµè¯ classpathï¼ä½ä¸æ¯ç¼è¯ classpathã\n   * test - æ­¤èå´è¡¨ç¤ºæ­£å¸¸ä½¿ç¨åºç¨ç¨åºä¸éè¦ä¾èµå³ç³»ï¼ä»éç¨äºæµè¯ç¼è¯åæ§è¡é¶æ®µãå®ä¸æ¯ä¼ éçã\n   * system - æ­¤èå´ä¸ provided ç±»ä¼¼ï¼é¤äºæ¨å¿é¡»æä¾æç¡®åå«å®ç jarãè¯¥ artifact å§ç»å¯ç¨ï¼å¹¶ä¸ä¸æ¯å¨ä»åºä¸­æ¥æ¾ã\n * systemPath - ä»å½ä¾èµèå´æ¯ç³»ç»æ¶æä½¿ç¨ãå¦åï¼å¦æè®¾ç½®æ­¤åç´ ï¼æå»ºå°å¤±è´¥ãè¯¥è·¯å¾å¿é¡»æ¯ç»å¯¹è·¯å¾ï¼å æ­¤å»ºè®®ä½¿ç¨ propertie æ¥æå®ç¹å®çè·¯å¾ï¼å¦$ {java.home} / libãç±äºåå®ååå®è£äºç³»ç»èå´ä¾èµå³ç³»ï¼maven å°ä¸ä¼æ£æ¥é¡¹ç®çä»åºï¼èæ¯æ£æ¥åºæä»¶æ¯å¦å­å¨ãå¦ææ²¡æï¼maven å°ä¼å¤±è´¥ï¼å¹¶å»ºè®®æ¨æå¨ä¸è½½å®è£ã\n * optional - optional è®©å¶ä»é¡¹ç®ç¥éï¼å½æ¨ä½¿ç¨æ­¤é¡¹ç®æ¶ï¼æ¨ä¸éè¦è¿ç§ä¾èµæ§æè½æ­£å¸¸å·¥ä½ã\n * exclusions - åå«ä¸ä¸ªæå¤ä¸ªæé¤åç´ ï¼æ¯ä¸ªæé¤åç´ é½åå«ä¸ä¸ªè¡¨ç¤ºè¦æé¤çä¾èµå³ç³»ç groupId å artifactIdãä¸å¯éé¡¹ä¸åï¼å¯è½æå¯è½ä¸ä¼å®è£åä½¿ç¨ï¼æé¤ä¸»å¨ä»ä¾èµå³ç³»æ ä¸­å é¤èªå·±ã\n\n\n# parent\n\nmaven æ¯æç»§æ¿åè½ãå­ POM å¯ä»¥ä½¿ç¨ parent æå®ç¶ POM ï¼ç¶åç»§æ¿å¶éç½®ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelVersion>4.0.0</modelVersion>\n\n  <parent>\n    <groupId>org.codehaus.mojo</groupId>\n    <artifactId>my-parent</artifactId>\n    <version>2.0</version>\n    <relativePath>../my-parent</relativePath>\n  </parent>\n\n  <artifactId>my-project</artifactId>\n</project>\n\n\n * relativePath - æ³¨æ relativePath åç´ ãå¨æç´¢æ¬å°åè¿ç¨å­å¨åºä¹åï¼å®ä¸æ¯å¿éçï¼ä½å¯ä»¥ç¨ä½ maven çæç¤ºç¬¦ï¼ä»¥é¦åæç´¢ç»å®è¯¥é¡¹ç®ç¶çº§çè·¯å¾ã\n\n\n# dependencyManagement\n\ndependencyManagement æ¯è¡¨ç¤ºä¾èµ jar åçå£°æãå³ä½ å¨é¡¹ç®ä¸­ç dependencyManagement ä¸å£°æäºä¾èµï¼maven ä¸ä¼å è½½è¯¥ä¾èµï¼dependencyManagement å£°æå¯ä»¥è¢«å­ POM ç»§æ¿ã\n\ndependencyManagement çä¸ä¸ªä½¿ç¨æ¡ä¾æ¯å½æç¶å­é¡¹ç®çæ¶åï¼ç¶é¡¹ç®ä¸­å¯ä»¥å©ç¨ dependencyManagement å£°æå­é¡¹ç®ä¸­éè¦ç¨å°çä¾èµ jar åï¼ä¹åï¼å½æä¸ªæèæå ä¸ªå­é¡¹ç®éè¦å è½½è¯¥ä¾èµçæ¶åï¼å°±å¯ä»¥å¨å­é¡¹ç®ä¸­ dependencies èç¹åªéç½® groupId å artifactId å°±å¯ä»¥å®æä¾èµçå¼ç¨ã\n\ndependencyManagement ä¸»è¦æ¯ä¸ºäºç»ä¸ç®¡çä¾èµåççæ¬ï¼ç¡®ä¿ææå­é¡¹ç®ä½¿ç¨ççæ¬ä¸è´ï¼ç±»ä¼¼çè¿æpluginsåpluginManagementã\n\n\n# modules\n\nå­æ¨¡ååè¡¨ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelVersion>4.0.0</modelVersion>\n\n  <groupId>org.codehaus.mojo</groupId>\n  <artifactId>my-parent</artifactId>\n  <version>2.0</version>\n  <packaging>pom</packaging>\n\n  <modules>\n    <module>my-project</module>\n    <module>another-project</module>\n    <module>third-project/pom-example.xml</module>\n  </modules>\n</project>\n\n\n\n# properties\n\nå±æ§åè¡¨ãå®ä¹çå±æ§å¯ä»¥å¨ pom.xml æä»¶ä¸­ä»»æå¤ä½¿ç¨ãä½¿ç¨æ¹å¼ä¸º ${propertie} ã\n\n<project>\n  ...\n  <properties>\n    <maven.compiler.source>1.7<maven.compiler.source>\n    <maven.compiler.target>1.7<maven.compiler.target>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n  </properties>\n  ...\n</project>\n\n\n\n# æå»ºéç½®\n\n\n# build\n\nbuild å¯ä»¥åä¸º "project build" å "profile build"ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  \x3c!-- "Project Build" contains more elements than just the BaseBuild set --\x3e\n  <build>...</build>\n\n  <profiles>\n    <profile>\n      \x3c!-- "Profile Build" contains a subset of "Project Build"s elements --\x3e\n      <build>...</build>\n    </profile>\n  </profiles>\n</project>\n\n\nåºæ¬æå»ºéç½®ï¼\n\n<build>\n  <defaultGoal>install</defaultGoal>\n  <directory>${basedir}/target</directory>\n  <finalName>${artifactId}-${version}</finalName>\n  <filters>\n    <filter>filters/filter1.properties</filter>\n  </filters>\n  ...\n</build>\n\n\ndefaultGoal : é»è®¤æ§è¡ç®æ æé¶æ®µãå¦æç»åºäºä¸ä¸ªç®æ ï¼å®åºè¯¥è¢«å®ä¹ä¸ºå®å¨å½ä»¤è¡ä¸­ï¼å¦ jarï¼jarï¼ãå¦æå®ä¹äºä¸ä¸ªé¶æ®µï¼å¦å®è£ï¼ï¼ä¹æ¯å¦æ­¤ã\n\ndirectory ï¼æå»ºæ¶çè¾åºè·¯å¾ãé»è®¤ä¸ºï¼${basedir}/target ã\n\nfinalName ï¼è¿æ¯é¡¹ç®çæç»æå»ºåç§°ï¼ä¸åæ¬æä»¶æ©å±åï¼ä¾å¦ï¼my-project-1.0.jarï¼\n\nfilter ï¼å®ä¹ * .properties æä»¶ï¼å¶ä¸­åå«éç¨äºæ¥åå¶è®¾ç½®çèµæºçå±æ§åè¡¨ï¼å¦ä¸æè¿°ï¼ãæ¢å¥è¯è¯´ï¼è¿æ»¤å¨æä»¶ä¸­å®ä¹çâname = valueâå¯¹å¨ä»£ç ä¸­æ¿æ¢$ {name}å­ç¬¦ä¸²ã\n\n# resources\n\nèµæºçéç½®ãèµæºæä»¶éå¸¸ä¸æ¯ä»£ç ï¼ä¸éè¦ç¼è¯ï¼èæ¯å¨é¡¹ç®éè¦æç»ä½¿ç¨çåå®¹ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <build>\n    ...\n    <resources>\n      <resource>\n        <targetPath>META-INF/plexus</targetPath>\n        <filtering>false</filtering>\n        <directory>${basedir}/src/main/plexus</directory>\n        <includes>\n          <include>configuration.xml</include>\n        </includes>\n        <excludes>\n          <exclude>**/*.properties</exclude>\n        </excludes>\n      </resource>\n    </resources>\n    <testResources>\n      ...\n    </testResources>\n    ...\n  </build>\n</project>\n\n\n * resources: èµæºåç´ çåè¡¨ï¼æ¯ä¸ªèµæºåç´ æè¿°ä¸æ­¤é¡¹ç®å³èçæä»¶åä½å¤åå«æä»¶ã\n * targetPath: æå®ä»æå»ºä¸­æ¾ç½®èµæºéçç®å½ç»æãç®æ è·¯å¾é»è®¤ä¸ºåºæ¬ç®å½ãå°è¦åè£å¨ jar ä¸­çèµæºçéå¸¸æå®çç®æ è·¯å¾æ¯ META-INFã\n * filtering: å¼ä¸º true æ falseãè¡¨ç¤ºæ¯å¦è¦ä¸ºæ­¤èµæºå¯ç¨è¿æ»¤ãè¯·æ³¨æï¼è¯¥è¿æ»¤å¨ * .properties æä»¶ä¸å¿å®ä¹ä¸ºè¿è¡è¿æ»¤ - èµæºè¿å¯ä»¥ä½¿ç¨é»è®¤æåµä¸å¨ POM ä¸­å®ä¹çå±æ§ï¼ä¾å¦$ {project.version}ï¼ï¼å¹¶å°å¶ä¼ éå°å½ä»¤è¡ä¸­â-Dâæ å¿ï¼ä¾å¦ï¼â-Dname = valueâï¼æç± properties åç´ æ¾å¼å®ä¹ãè¿æ»¤æä»¶è¦çä¸é¢ã\n * directory: å¼å®ä¹äºèµæºçè·¯å¾ãæå»ºçé»è®¤ç®å½æ¯${basedir}/src/main/resourcesã\n * includes: ä¸ç»æä»¶å¹éæ¨¡å¼ï¼æå®ç®å½ä¸­è¦åæ¬çæä»¶ï¼ä½¿ç¨*ä½ä¸ºééç¬¦ã\n * excludes: ä¸ includes ç±»ä¼¼ï¼æå®ç®å½ä¸­è¦æé¤çæä»¶ï¼ä½¿ç¨*ä½ä¸ºééç¬¦ãæ³¨æï¼å¦æ include å exclude åçå²çªï¼maven ä¼ä»¥ exclude ä½ä¸ºææé¡¹ã\n * testResources: testResources ä¸ resources åè½ç±»ä¼¼ï¼åºå«ä»å¨äºï¼testResources æå®çèµæºä»ç¨äº test é¶æ®µï¼å¹¶ä¸å¶é»è®¤èµæºç®å½ä¸ºï¼${basedir}/src/test/resources ã\n\n# plugins\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <build>\n    ...\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-jar-plugin</artifactId>\n        <version>2.6</version>\n        <extensions>false</extensions>\n        <inherited>true</inherited>\n        <configuration>\n          <classifier>test</classifier>\n        </configuration>\n        <dependencies>...</dependencies>\n        <executions>...</executions>\n      </plugin>\n    </plugins>\n  </build>\n</project>\n\n\n * groupId, artifactId, version ï¼ååºæ¬éç½®ä¸­ç groupIdãartifactIdãversion æä¹ç¸åã\n\n * extensions ï¼å¼ä¸º true æ falseãæ¯å¦å è½½æ­¤æä»¶çæ©å±åãé»è®¤ä¸º falseã\n\n * inherited ï¼å¼ä¸º true æ falseãè¿ä¸ªæä»¶éç½®æ¯å¦åºè¯¥éç¨äºç»§æ¿èªè¿ä¸ªæä»¶ç POMãé»è®¤å¼ä¸º trueã\n\n * configuration - è¿æ¯éå¯¹ä¸ªäººæä»¶çéç½®ï¼è¿éä¸æ©æ£è®²è§£ã\n\n * dependencies ï¼è¿éç dependencies æ¯æä»¶æ¬èº«æéè¦çä¾èµã\n\n * executions ï¼éè¦è®°ä½çæ¯ï¼æä»¶å¯è½æå¤ä¸ªç®æ ãæ¯ä¸ªç®æ å¯è½æä¸ä¸ªåç¬çéç½®ï¼çè³å¯è½å°æä»¶çç®æ å®å¨ç»å®å°ä¸åçé¶æ®µãæ§è¡éç½®æä»¶çç®æ çæ§è¡ã\n   \n   * id: æ§è¡ç®æ çæ è¯ã\n   * goals: åææå¤ååç POM åç´ ä¸æ ·ï¼å®åå«åä¸ªåç´ çåè¡¨ãå¨è¿ç§æåµä¸ï¼è¿ä¸ªæ§è¡åæå®çæä»¶ç®æ åè¡¨ã\n   * phase: è¿æ¯æ§è¡ç®æ åè¡¨çé¶æ®µãè¿æ¯ä¸ä¸ªéå¸¸å¼ºå¤§çéé¡¹ï¼åè®¸å°ä»»ä½ç®æ ç»å®å°æå»ºçå½å¨æä¸­çä»»ä½é¶æ®µï¼ä»èæ¹å maven çé»è®¤è¡ä¸ºã\n   * inherited: åä¸é¢çç»§æ¿åç´ ä¸æ ·ï¼è®¾ç½®è¿ä¸ª false ä¼é»æ­¢ maven å°è¿ä¸ªæ§è¡ä¼ éç»å®çå­ä»£ãæ­¤åç´ ä»å¯¹ç¶ POM ææä¹ã\n   * configuration: ä¸ä¸è¿°ç¸åï¼ä½å°éç½®éå¶å¨æ­¤ç¹å®ç®æ åè¡¨ä¸­ï¼èä¸æ¯æä»¶ä¸çææç®æ ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <build>\n    <plugins>\n      <plugin>\n        <artifactId>maven-antrun-plugin</artifactId>\n        <version>1.1</version>\n        <executions>\n          <execution>\n            <id>echodir</id>\n            <goals>\n              <goal>run</goal>\n            </goals>\n            <phase>verify</phase>\n            <inherited>false</inherited>\n            <configuration>\n              <tasks>\n                <echo>Build Dir: ${project.build.directory}</echo>\n              </tasks>\n            </configuration>\n          </execution>\n        </executions>\n\n      </plugin>\n    </plugins>\n  </build>\n</project>\n\n\n# pluginManagement\n\nä¸ dependencyManagement å¾ç¸ä¼¼ï¼å¨å½å POM ä¸­ä»å£°ææä»¶ï¼èä¸æ¯å®éå¼å¥æä»¶ãå­ POM ä¸­åªéç½® groupId å artifactId å°±å¯ä»¥å®ææä»¶çå¼ç¨ï¼ä¸å­ POM ææéå pluginManagement å®ä¹ã\n\nå®çç®çå¨äºç»ä¸ææå­ POM çæä»¶çæ¬ã\n\n# directories\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <build>\n    <sourceDirectory>${basedir}/src/main/java</sourceDirectory>\n    <scriptSourceDirectory>${basedir}/src/main/scripts</scriptSourceDirectory>\n    <testSourceDirectory>${basedir}/src/test/java</testSourceDirectory>\n    <outputDirectory>${basedir}/target/classes</outputDirectory>\n    <testOutputDirectory>${basedir}/target/test-classes</testOutputDirectory>\n    ...\n  </build>\n</project>\n\n\nç®å½åç´ éåå­å¨äº build åç´ ä¸­ï¼å®ä¸ºæ´ä¸ª POM è®¾ç½®äºåç§ç®å½ç»æãç±äºå®ä»¬å¨éç½®æä»¶æå»ºä¸­ä¸å­å¨ï¼æä»¥è¿äºä¸è½ç±éç½®æä»¶æ´æ¹ã\n\nå¦æä¸è¿°ç®å½åç´ çå¼è®¾ç½®ä¸ºç»å¯¹è·¯å¾ï¼æ©å±å±æ§æ¶ï¼ï¼åä½¿ç¨è¯¥ç®å½ãå¦åï¼å®æ¯ç¸å¯¹äºåºç¡æå»ºç®å½ï¼${basedir}ã\n\n# extensions\n\næ©å±æ¯å¨æ­¤æå»ºä¸­ä½¿ç¨ç artifacts çåè¡¨ãå®ä»¬å°è¢«åå«å¨è¿è¡æå»ºç classpath ä¸­ãå®ä»¬å¯ä»¥å¯ç¨å¯¹æå»ºè¿ç¨çæ©å±ï¼ä¾å¦ä¸º Wagon ä¼ è¾æºå¶æ·»å ä¸ä¸ª ftp æä¾ç¨åºï¼ï¼å¹¶ä½¿æ´»å¨çæä»¶è½å¤å¯¹æå»ºçå½å¨æè¿è¡æ´æ¹ãç®èè¨ä¹ï¼æ©å±æ¯å¨æå»ºæé´æ¿æ´»ç artifactsãæ©å±ä¸éè¦å®éæ§è¡ä»»ä½æä½ï¼ä¹ä¸åå« Mojoãå æ­¤ï¼æ©å±å¯¹äºæå®æ®éæä»¶æ¥å£çå¤ä¸ªå®ç°ä¸­çä¸ä¸ªæ¯éå¸¸å¥½çã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <build>\n    ...\n    <extensions>\n      <extension>\n        <groupId>org.apache.maven.wagon</groupId>\n        <artifactId>wagon-ftp</artifactId>\n        <version>1.0-alpha-3</version>\n      </extension>\n    </extensions>\n    ...\n  </build>\n</project>\n\n\n\n# reporting\n\næ¥ååå«ç¹å®éå¯¹ site çæé¶æ®µçåç´ ãæäº maven æä»¶å¯ä»¥çæ reporting åç´ ä¸éç½®çæ¥åï¼ä¾å¦ï¼çæ javadoc æ¥åãreporting ä¸ build åç´ éç½®æä»¶çè½åç¸ä¼¼ãææ¾çåºå«å¨äºï¼å¨æ§è¡åä¸­æä»¶ç®æ çæ§å¶ä¸æ¯ç»ç²åº¦çï¼æ¥è¡¨éè¿éç½® reportSet åç´ æ¥ç²¾ç»æ§å¶ãèå¾®å¦çåºå«å¨äº reporting åç´ ä¸ç configuration åç´ å¯ä»¥ç¨ä½ build ä¸ç configuration ï¼å°½ç®¡ç¸åçæåµå¹¶éå¦æ­¤ï¼ build ä¸ç configuration ä¸å½±å reporting åç´ ä¸ç configuration ï¼ã\n\nå¦ä¸ä¸ªåºå«å°±æ¯ plugin ä¸ç outputDirectory åç´ ãå¨æ¥åçæåµä¸ï¼é»è®¤è¾åºç®å½ä¸º ${basedir}/target/siteã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <reporting>\n    <plugins>\n      <plugin>\n        ...\n        <reportSets>\n          <reportSet>\n            <id>sunlink</id>\n            <reports>\n              <report>javadoc</report>\n            </reports>\n            <inherited>true</inherited>\n            <configuration>\n              <links>\n                <link>http://java.sun.com/j2se/1.5.0/docs/api/</link>\n              </links>\n            </configuration>\n          </reportSet>\n        </reportSets>\n      </plugin>\n    </plugins>\n  </reporting>\n  ...\n</project>\n\n\n\n# é¡¹ç®ä¿¡æ¯\n\né¡¹ç®ä¿¡æ¯ç¸å³çè¿é¨åæ ç­¾é½ä¸æ¯å¿è¦çï¼ä¹å°±æ¯è¯´å®å¨å¯ä»¥ä¸å¡«åã\n\nå®çä½ç¨ä»éäºæè¿°é¡¹ç®çè¯¦ç»ä¿¡æ¯ã\n\nä¸é¢çç¤ºä¾æ¯é¡¹ç®ä¿¡æ¯ç¸å³æ ç­¾çæ¸åï¼\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n\n  \x3c!-- é¡¹ç®ä¿¡æ¯ begin --\x3e\n\n  \x3c!--é¡¹ç®å--\x3e\n  <name>maven-notes</name>\n\n  \x3c!--é¡¹ç®æè¿°--\x3e\n  <description>maven å­¦ä¹ ç¬è®°</description>\n\n  \x3c!--é¡¹ç®url--\x3e\n  <url>https://github.com/dunwu/maven-notes</url>\n\n  \x3c!--é¡¹ç®å¼åå¹´ä»½--\x3e\n  <inceptionYear>2017</inceptionYear>\n\n  \x3c!--å¼æºåè®®--\x3e\n  <licenses>\n    <license>\n      <name>Apache License, Version 2.0</name>\n      <url>https://www.apache.org/licenses/LICENSE-2.0.txt</url>\n      <distribution>repo</distribution>\n      <comments>A business-friendly OSS license</comments>\n    </license>\n  </licenses>\n\n  \x3c!--ç»ç»ä¿¡æ¯(å¦å¬å¸ãå¼æºç»ç»ç­)--\x3e\n  <organization>\n    <name>...</name>\n    <url>...</url>\n  </organization>\n\n  \x3c!--å¼åèåè¡¨--\x3e\n  <developers>\n    <developer>\n      <id>victor</id>\n      <name>Zhang Peng</name>\n      <email>forbreak at 163.com</email>\n      <url>https://github.com/dunwu</url>\n      <organization>...</organization>\n      <organizationUrl>...</organizationUrl>\n      <roles>\n        <role>architect</role>\n        <role>developer</role>\n      </roles>\n      <timezone>+8</timezone>\n      <properties>...</properties>\n    </developer>\n  </developers>\n\n  \x3c!--ä»£ç è´¡ç®èåè¡¨--\x3e\n   <contributors>\n    <contributor>\n      \x3c!--æ ç­¾åå®¹å<developer>ç¸å--\x3e\n    </contributor>\n  </contributors>\n\n  \x3c!-- é¡¹ç®ä¿¡æ¯ end --\x3e\n\n  ...\n</project>\n\n\nè¿é¨åæ ç­¾é½éå¸¸ç®åï¼åºæ¬é½è½åå°é¡¾åæä¹ï¼ä¸é½å±äºå¯æå¯æ çæ ç­¾ï¼æä»¥è¿éä»ç®åä»ç»ä¸ä¸ï¼\n\n * name - é¡¹ç®å®æ´åç§°\n\n * description - é¡¹ç®æè¿°\n\n * url - ä¸è¬ä¸ºé¡¹ç®ä»åºç host\n\n * inceptionYear - å¼åå¹´ä»½\n\n * licenses - å¼æºåè®®\n\n * organization - é¡¹ç®æå±ç»ç»ä¿¡æ¯\n\n * developers - é¡¹ç®å¼åèåè¡¨\n\n * contributors - é¡¹ç®è´¡ç®èåè¡¨ï¼<contributor> çå­æ ç­¾å <developer> çå®å¨ç¸åã\n\n\n# ç¯å¢éç½®\n\n\n# issueManagement\n\nè¿å®ä¹äºæä½¿ç¨çç¼ºé·è·è¸ªç³»ç»ï¼Bugzillaï¼TestTrackï¼ClearQuest ç­ï¼ãè½ç¶æ²¡æä»ä¹å¯ä»¥é»æ­¢æä»¶ä½¿ç¨è¿äºä¿¡æ¯çä¸è¥¿ï¼ä½å®ä¸»è¦ç¨äºçæé¡¹ç®ææ¡£ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <issueManagement>\n    <system>Bugzilla</system>\n    <url>http://127.0.0.1/bugzilla/</url>\n  </issueManagement>\n  ...\n</project>\n\n\n\n# ciManagement\n\nCI æå»ºç³»ç»éç½®ï¼ä¸»è¦æ¯æå®éç¥æºå¶ä»¥åè¢«éç¥çé®ç®±ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <ciManagement>\n    <system>continuum</system>\n    <url>http://127.0.0.1:8080/continuum</url>\n    <notifiers>\n      <notifier>\n        <type>mail</type>\n        <sendOnError>true</sendOnError>\n        <sendOnFailure>true</sendOnFailure>\n        <sendOnSuccess>false</sendOnSuccess>\n        <sendOnWarning>false</sendOnWarning>\n        <configuration><address>continuum@127.0.0.1</address></configuration>\n      </notifier>\n    </notifiers>\n  </ciManagement>\n  ...\n</project>\n\n\n\n# mailingLists\n\né®ä»¶åè¡¨\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <mailingLists>\n    <mailingList>\n      <name>User List</name>\n      <subscribe>user-subscribe@127.0.0.1</subscribe>\n      <unsubscribe>user-unsubscribe@127.0.0.1</unsubscribe>\n      <post>user@127.0.0.1</post>\n      <archive>http://127.0.0.1/user/</archive>\n      <otherArchives>\n        <otherArchive>http://base.google.com/base/1/127.0.0.1</otherArchive>\n      </otherArchives>\n    </mailingList>\n  </mailingLists>\n  ...\n</project>\n\n\n\n# scm\n\nSCMï¼è½¯ä»¶éç½®ç®¡çï¼ä¹ç§°ä¸ºæºä»£ç /æ§å¶ç®¡çæç®æ´ççæ¬æ§å¶ï¼ãå¸¸è§ç scm æ svn å git ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <scm>\n    <connection>scm:svn:http://127.0.0.1/svn/my-project</connection>\n    <developerConnection>scm:svn:https://127.0.0.1/svn/my-project</developerConnection>\n    <tag>HEAD</tag>\n    <url>http://127.0.0.1/websvn/my-project</url>\n  </scm>\n  ...\n</project>\n\n\n\n# prerequisites\n\nPOM æ§è¡çé¢è®¾æ¡ä»¶ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <prerequisites>\n    <maven>2.0.6</maven>\n  </prerequisites>\n  ...\n</project>\n\n\n\n# repositories\n\nrepositories æ¯éµå¾ª Maven å­å¨åºç®å½å¸å±ç artifacts éåãé»è®¤ç Maven ä¸­å¤®å­å¨åºä½äºhttps://repo.maven.apache.org/maven2/ä¸ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <repositories>\n    <repository>\n      <releases>\n        <enabled>false</enabled>\n        <updatePolicy>always</updatePolicy>\n        <checksumPolicy>warn</checksumPolicy>\n      </releases>\n      <snapshots>\n        <enabled>true</enabled>\n        <updatePolicy>never</updatePolicy>\n        <checksumPolicy>fail</checksumPolicy>\n      </snapshots>\n      <id>codehausSnapshots</id>\n      <name>Codehaus Snapshots</name>\n      <url>http://snapshots.maven.codehaus.org/maven2</url>\n      <layout>default</layout>\n    </repository>\n  </repositories>\n  <pluginRepositories>\n    ...\n  </pluginRepositories>\n  ...\n</project>\n\n\n\n# pluginRepositories\n\nä¸ repositories å·®ä¸å¤ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <distributionManagement>\n    ...\n    <downloadUrl>http://mojo.codehaus.org/my-project</downloadUrl>\n    <status>deployed</status>\n  </distributionManagement>\n  ...\n</project>\n\n\n\n# distributionManagement\n\nå®ç®¡çå¨æ´ä¸ªæå»ºè¿ç¨ä¸­çæç artifact åæ¯ææä»¶çåå¸ãä»æåçåç´ å¼å§ï¼\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <distributionManagement>\n    ...\n    <downloadUrl>http://mojo.codehaus.org/my-project</downloadUrl>\n    <status>deployed</status>\n  </distributionManagement>\n  ...\n</project>\n\n\n * repository - ä¸ repositories ç¸ä¼¼\n\n * site - ç«ç¹ä¿¡æ¯\n\n * relocation - é¡¹ç®è¿ç§»ä½ç½®\n\n\n# profiles\n\nactivation æ¯ä¸ä¸ª profile çå³é®ãéç½®æä»¶çåè½æ¥èªäºå¨æäºæåµä¸ä»ä¿®æ¹åºæ¬ POM çåè½ãè¿äºæåµéè¿ activation åç´ æå®ã\n\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <profiles>\n    <profile>\n      <id>test</id>\n      <activation>\n        <activeByDefault>false</activeByDefault>\n        <jdk>1.5</jdk>\n        <os>\n          <name>Windows XP</name>\n          <family>Windows</family>\n          <arch>x86</arch>\n          <version>5.1.2600</version>\n        </os>\n        <property>\n          <name>sparrow-type</name>\n          <value>African</value>\n        </property>\n        <file>\n          <exists>${basedir}/file2.properties</exists>\n          <missing>${basedir}/file1.properties</missing>\n        </file>\n      </activation>\n      ...\n    </profile>\n  </profiles>\n</project>\n\n\n\n# åèèµæ\n\n * maven å®æ¹ææ¡£ä¹ pom',normalizedContent:'# maven æç¨ä¹ pom.xml è¯¦è§£\n\n\n# pom.xml ç®ä»\n\n\n# ä»ä¹æ¯ pom\n\npom æ¯ project object model çç¼©åï¼å³é¡¹ç®å¯¹è±¡æ¨¡åã\n\npom.xml å°±æ¯ maven çéç½®æä»¶ï¼ç¨ä»¥æè¿°é¡¹ç®çåç§ä¿¡æ¯ã\n\n\n# pom éç½®ä¸è§\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelversion>4.0.0</modelversion>\n\n  \x3c!-- the basics --\x3e\n  <groupid>...</groupid>\n  <artifactid>...</artifactid>\n  <version>...</version>\n  <packaging>...</packaging>\n  <dependencies>...</dependencies>\n  <parent>...</parent>\n  <dependencymanagement>...</dependencymanagement>\n  <modules>...</modules>\n  <properties>...</properties>\n\n  \x3c!-- build settings --\x3e\n  <build>...</build>\n  <reporting>...</reporting>\n\n  \x3c!-- more project information --\x3e\n  <name>...</name>\n  <description>...</description>\n  <url>...</url>\n  <inceptionyear>...</inceptionyear>\n  <licenses>...</licenses>\n  <organization>...</organization>\n  <developers>...</developers>\n  <contributors>...</contributors>\n\n  \x3c!-- environment settings --\x3e\n  <issuemanagement>...</issuemanagement>\n  <cimanagement>...</cimanagement>\n  <mailinglists>...</mailinglists>\n  <scm>...</scm>\n  <prerequisites>...</prerequisites>\n  <repositories>...</repositories>\n  <pluginrepositories>...</pluginrepositories>\n  <distributionmanagement>...</distributionmanagement>\n  <profiles>...</profiles>\n</project>\n\n\n\n# åºæ¬éç½®\n\n * project - project æ¯ pom.xml ä¸­æè¿°ç¬¦çæ ¹ã\n * modelversion - modelversion æå® pom.xml ç¬¦ååªä¸ªçæ¬çæè¿°ç¬¦ãmaven 2 å 3 åªè½ä¸º 4.0.0ã\n\nä¸è¬ jar åè¢«è¯å«ä¸ºï¼ groupid:artifactid:version çå½¢å¼ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelversion>4.0.0</modelversion>\n\n  <groupid>org.codehaus.mojo</groupid>\n  <artifactid>my-project</artifactid>\n  <version>1.0</version>\n  <packaging>war</packaging>\n</project>\n\n\n\n# maven åæ \n\nå¨ maven ä¸­ï¼æ ¹æ® groupidãartifactidãversion ç»åæ groupid:artifactid:version æ¥å¯ä¸è¯å«ä¸ä¸ª jar åã\n\n * groupid - å¢ä½ãç»ç»çæ è¯ç¬¦ãå¢ä½æ è¯ççº¦å®æ¯ï¼å®ä»¥åå»ºè¿ä¸ªé¡¹ç®çç»ç»åç§°çéååå(reverse domain name)å¼å¤´ãä¸è¬å¯¹åºç java çåç»æã\n * artifactid - åç¬é¡¹ç®çå¯ä¸æ è¯ç¬¦ãæ¯å¦æä»¬ç tomcatãcommons ç­ãä¸è¦å¨ artifactid ä¸­åå«ç¹å·(.)ã\n * version - ä¸ä¸ªé¡¹ç®çç¹å®çæ¬ã\n   * maven æèªå·±ççæ¬è§èï¼ä¸è¬æ¯å¦ä¸å®ä¹ major versionãminor versionãincremental version-qualifier ï¼æ¯å¦ 1.2.3-beta-01ãè¦è¯´æçæ¯ï¼maven èªå·±å¤æ­çæ¬çç®æ³æ¯ majorãminorãincremental é¨åç¨æ°å­æ¯è¾ï¼qualifier é¨åç¨å­ç¬¦ä¸²æ¯è¾ï¼æä»¥è¦å°å¿ alpha-2 å alpha-15 çæ¯è¾å³ç³»ï¼æå¥½ç¨ alpha-02 çæ ¼å¼ã\n   * maven å¨çæ¬ç®¡çæ¶åå¯ä»¥ä½¿ç¨å ä¸ªç¹æ®çå­ç¬¦ä¸² snapshotãlatestãreleaseãæ¯å¦ 1.0-snapshotãåä¸ªé¨åçå«ä¹åå¤çé»è¾å¦ä¸è¯´æï¼\n     * snapshot - è¿ä¸ªçæ¬ä¸è¬ç¨äºå¼åè¿ç¨ä¸­ï¼è¡¨ç¤ºä¸ç¨³å®ççæ¬ã\n     * latest - ææä¸ªç¹å®æä»¶çææ°åå¸ï¼è¿ä¸ªåå¸å¯è½æ¯ä¸ä¸ªåå¸çï¼ä¹å¯è½æ¯ä¸ä¸ª snapshot çï¼å·ä½çåªä¸ªæ¶é´æåã\n     * release ï¼ææåä¸ä¸ªåå¸çã\n * packaging - é¡¹ç®çç±»åï¼æè¿°äºé¡¹ç®æååçè¾åºï¼é»è®¤æ¯ jarãå¸¸è§çè¾åºç±»åä¸ºï¼pom, jar, maven-plugin, ejb, war, ear, rar, parã\n\n\n# ä¾èµéç½®\n\n\n# dependencies\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <dependencies>\n    <dependency>\n     <groupid>org.apache.maven</groupid>\n      <artifactid>maven-embedder</artifactid>\n      <version>2.0</version>\n      <type>jar</type>\n      <scope>test</scope>\n      <optional>true</optional>\n      <exclusions>\n        <exclusion>\n          <groupid>org.apache.maven</groupid>\n          <artifactid>maven-core</artifactid>\n        </exclusion>\n      </exclusions>\n    </dependency>\n    ...\n  </dependencies>\n  ...\n</project>\n\n\n * groupid, artifactid, version - ååºæ¬éç½®ä¸­ç groupidãartifactidãversion æä¹ç¸åã\n * type - å¯¹åº packaging çç±»åï¼å¦æä¸ä½¿ç¨ type æ ç­¾ï¼maven é»è®¤ä¸º jarã\n * scope - æ­¤åç´ æçæ¯ä»»å¡çç±»è·¯å¾ï¼ç¼è¯åè¿è¡æ¶ï¼æµè¯ç­ï¼ä»¥åå¦ä½éå¶ä¾èµå³ç³»çä¼ éæ§ãæ 5 ç§å¯ç¨çéå®èå´ï¼\n   * compile - å¦ææ²¡ææå® scope æ ç­¾ï¼maven é»è®¤ä¸ºè¿ä¸ªèå´ãç¼è¯ä¾èµå³ç³»å¨ææ classpath ä¸­é½å¯ç¨ãæ­¤å¤ï¼è¿äºä¾èµå³ç³»è¢«ä¼ æ­å°ä¾èµé¡¹ç®ã\n   * provided - ä¸ compile ç±»ä¼¼ï¼ä½æ¯è¡¨ç¤ºæ¨å¸æ jdk æå®¹å¨å¨è¿è¡æ¶æä¾å®ãå®åªéç¨äºç¼è¯åæµè¯ classpathï¼ä¸å¯ä¼ éã\n   * runtime - æ­¤èå´è¡¨ç¤ºç¼è¯ä¸éè¦ä¾èµå³ç³»ï¼èæ¯ç¨äºæ§è¡ãå®æ¯å¨è¿è¡æ¶åæµè¯ classpathï¼ä½ä¸æ¯ç¼è¯ classpathã\n   * test - æ­¤èå´è¡¨ç¤ºæ­£å¸¸ä½¿ç¨åºç¨ç¨åºä¸éè¦ä¾èµå³ç³»ï¼ä»éç¨äºæµè¯ç¼è¯åæ§è¡é¶æ®µãå®ä¸æ¯ä¼ éçã\n   * system - æ­¤èå´ä¸ provided ç±»ä¼¼ï¼é¤äºæ¨å¿é¡»æä¾æç¡®åå«å®ç jarãè¯¥ artifact å§ç»å¯ç¨ï¼å¹¶ä¸ä¸æ¯å¨ä»åºä¸­æ¥æ¾ã\n * systempath - ä»å½ä¾èµèå´æ¯ç³»ç»æ¶æä½¿ç¨ãå¦åï¼å¦æè®¾ç½®æ­¤åç´ ï¼æå»ºå°å¤±è´¥ãè¯¥è·¯å¾å¿é¡»æ¯ç»å¯¹è·¯å¾ï¼å æ­¤å»ºè®®ä½¿ç¨ propertie æ¥æå®ç¹å®çè·¯å¾ï¼å¦$ {java.home} / libãç±äºåå®ååå®è£äºç³»ç»èå´ä¾èµå³ç³»ï¼maven å°ä¸ä¼æ£æ¥é¡¹ç®çä»åºï¼èæ¯æ£æ¥åºæä»¶æ¯å¦å­å¨ãå¦ææ²¡æï¼maven å°ä¼å¤±è´¥ï¼å¹¶å»ºè®®æ¨æå¨ä¸è½½å®è£ã\n * optional - optional è®©å¶ä»é¡¹ç®ç¥éï¼å½æ¨ä½¿ç¨æ­¤é¡¹ç®æ¶ï¼æ¨ä¸éè¦è¿ç§ä¾èµæ§æè½æ­£å¸¸å·¥ä½ã\n * exclusions - åå«ä¸ä¸ªæå¤ä¸ªæé¤åç´ ï¼æ¯ä¸ªæé¤åç´ é½åå«ä¸ä¸ªè¡¨ç¤ºè¦æé¤çä¾èµå³ç³»ç groupid å artifactidãä¸å¯éé¡¹ä¸åï¼å¯è½æå¯è½ä¸ä¼å®è£åä½¿ç¨ï¼æé¤ä¸»å¨ä»ä¾èµå³ç³»æ ä¸­å é¤èªå·±ã\n\n\n# parent\n\nmaven æ¯æç»§æ¿åè½ãå­ pom å¯ä»¥ä½¿ç¨ parent æå®ç¶ pom ï¼ç¶åç»§æ¿å¶éç½®ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelversion>4.0.0</modelversion>\n\n  <parent>\n    <groupid>org.codehaus.mojo</groupid>\n    <artifactid>my-parent</artifactid>\n    <version>2.0</version>\n    <relativepath>../my-parent</relativepath>\n  </parent>\n\n  <artifactid>my-project</artifactid>\n</project>\n\n\n * relativepath - æ³¨æ relativepath åç´ ãå¨æç´¢æ¬å°åè¿ç¨å­å¨åºä¹åï¼å®ä¸æ¯å¿éçï¼ä½å¯ä»¥ç¨ä½ maven çæç¤ºç¬¦ï¼ä»¥é¦åæç´¢ç»å®è¯¥é¡¹ç®ç¶çº§çè·¯å¾ã\n\n\n# dependencymanagement\n\ndependencymanagement æ¯è¡¨ç¤ºä¾èµ jar åçå£°æãå³ä½ å¨é¡¹ç®ä¸­ç dependencymanagement ä¸å£°æäºä¾èµï¼maven ä¸ä¼å è½½è¯¥ä¾èµï¼dependencymanagement å£°æå¯ä»¥è¢«å­ pom ç»§æ¿ã\n\ndependencymanagement çä¸ä¸ªä½¿ç¨æ¡ä¾æ¯å½æç¶å­é¡¹ç®çæ¶åï¼ç¶é¡¹ç®ä¸­å¯ä»¥å©ç¨ dependencymanagement å£°æå­é¡¹ç®ä¸­éè¦ç¨å°çä¾èµ jar åï¼ä¹åï¼å½æä¸ªæèæå ä¸ªå­é¡¹ç®éè¦å è½½è¯¥ä¾èµçæ¶åï¼å°±å¯ä»¥å¨å­é¡¹ç®ä¸­ dependencies èç¹åªéç½® groupid å artifactid å°±å¯ä»¥å®æä¾èµçå¼ç¨ã\n\ndependencymanagement ä¸»è¦æ¯ä¸ºäºç»ä¸ç®¡çä¾èµåççæ¬ï¼ç¡®ä¿ææå­é¡¹ç®ä½¿ç¨ççæ¬ä¸è´ï¼ç±»ä¼¼çè¿æpluginsåpluginmanagementã\n\n\n# modules\n\nå­æ¨¡ååè¡¨ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <modelversion>4.0.0</modelversion>\n\n  <groupid>org.codehaus.mojo</groupid>\n  <artifactid>my-parent</artifactid>\n  <version>2.0</version>\n  <packaging>pom</packaging>\n\n  <modules>\n    <module>my-project</module>\n    <module>another-project</module>\n    <module>third-project/pom-example.xml</module>\n  </modules>\n</project>\n\n\n\n# properties\n\nå±æ§åè¡¨ãå®ä¹çå±æ§å¯ä»¥å¨ pom.xml æä»¶ä¸­ä»»æå¤ä½¿ç¨ãä½¿ç¨æ¹å¼ä¸º ${propertie} ã\n\n<project>\n  ...\n  <properties>\n    <maven.compiler.source>1.7<maven.compiler.source>\n    <maven.compiler.target>1.7<maven.compiler.target>\n    <project.build.sourceencoding>utf-8</project.build.sourceencoding>\n    <project.reporting.outputencoding>utf-8</project.reporting.outputencoding>\n  </properties>\n  ...\n</project>\n\n\n\n# æå»ºéç½®\n\n\n# build\n\nbuild å¯ä»¥åä¸º "project build" å "profile build"ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  \x3c!-- "project build" contains more elements than just the basebuild set --\x3e\n  <build>...</build>\n\n  <profiles>\n    <profile>\n      \x3c!-- "profile build" contains a subset of "project build"s elements --\x3e\n      <build>...</build>\n    </profile>\n  </profiles>\n</project>\n\n\nåºæ¬æå»ºéç½®ï¼\n\n<build>\n  <defaultgoal>install</defaultgoal>\n  <directory>${basedir}/target</directory>\n  <finalname>${artifactid}-${version}</finalname>\n  <filters>\n    <filter>filters/filter1.properties</filter>\n  </filters>\n  ...\n</build>\n\n\ndefaultgoal : é»è®¤æ§è¡ç®æ æé¶æ®µãå¦æç»åºäºä¸ä¸ªç®æ ï¼å®åºè¯¥è¢«å®ä¹ä¸ºå®å¨å½ä»¤è¡ä¸­ï¼å¦ jarï¼jarï¼ãå¦æå®ä¹äºä¸ä¸ªé¶æ®µï¼å¦å®è£ï¼ï¼ä¹æ¯å¦æ­¤ã\n\ndirectory ï¼æå»ºæ¶çè¾åºè·¯å¾ãé»è®¤ä¸ºï¼${basedir}/target ã\n\nfinalname ï¼è¿æ¯é¡¹ç®çæç»æå»ºåç§°ï¼ä¸åæ¬æä»¶æ©å±åï¼ä¾å¦ï¼my-project-1.0.jarï¼\n\nfilter ï¼å®ä¹ * .properties æä»¶ï¼å¶ä¸­åå«éç¨äºæ¥åå¶è®¾ç½®çèµæºçå±æ§åè¡¨ï¼å¦ä¸æè¿°ï¼ãæ¢å¥è¯è¯´ï¼è¿æ»¤å¨æä»¶ä¸­å®ä¹çâname = valueâå¯¹å¨ä»£ç ä¸­æ¿æ¢$ {name}å­ç¬¦ä¸²ã\n\n# resources\n\nèµæºçéç½®ãèµæºæä»¶éå¸¸ä¸æ¯ä»£ç ï¼ä¸éè¦ç¼è¯ï¼èæ¯å¨é¡¹ç®éè¦æç»ä½¿ç¨çåå®¹ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <build>\n    ...\n    <resources>\n      <resource>\n        <targetpath>meta-inf/plexus</targetpath>\n        <filtering>false</filtering>\n        <directory>${basedir}/src/main/plexus</directory>\n        <includes>\n          <include>configuration.xml</include>\n        </includes>\n        <excludes>\n          <exclude>**/*.properties</exclude>\n        </excludes>\n      </resource>\n    </resources>\n    <testresources>\n      ...\n    </testresources>\n    ...\n  </build>\n</project>\n\n\n * resources: èµæºåç´ çåè¡¨ï¼æ¯ä¸ªèµæºåç´ æè¿°ä¸æ­¤é¡¹ç®å³èçæä»¶åä½å¤åå«æä»¶ã\n * targetpath: æå®ä»æå»ºä¸­æ¾ç½®èµæºéçç®å½ç»æãç®æ è·¯å¾é»è®¤ä¸ºåºæ¬ç®å½ãå°è¦åè£å¨ jar ä¸­çèµæºçéå¸¸æå®çç®æ è·¯å¾æ¯ meta-infã\n * filtering: å¼ä¸º true æ falseãè¡¨ç¤ºæ¯å¦è¦ä¸ºæ­¤èµæºå¯ç¨è¿æ»¤ãè¯·æ³¨æï¼è¯¥è¿æ»¤å¨ * .properties æä»¶ä¸å¿å®ä¹ä¸ºè¿è¡è¿æ»¤ - èµæºè¿å¯ä»¥ä½¿ç¨é»è®¤æåµä¸å¨ pom ä¸­å®ä¹çå±æ§ï¼ä¾å¦$ {project.version}ï¼ï¼å¹¶å°å¶ä¼ éå°å½ä»¤è¡ä¸­â-dâæ å¿ï¼ä¾å¦ï¼â-dname = valueâï¼æç± properties åç´ æ¾å¼å®ä¹ãè¿æ»¤æä»¶è¦çä¸é¢ã\n * directory: å¼å®ä¹äºèµæºçè·¯å¾ãæå»ºçé»è®¤ç®å½æ¯${basedir}/src/main/resourcesã\n * includes: ä¸ç»æä»¶å¹éæ¨¡å¼ï¼æå®ç®å½ä¸­è¦åæ¬çæä»¶ï¼ä½¿ç¨*ä½ä¸ºééç¬¦ã\n * excludes: ä¸ includes ç±»ä¼¼ï¼æå®ç®å½ä¸­è¦æé¤çæä»¶ï¼ä½¿ç¨*ä½ä¸ºééç¬¦ãæ³¨æï¼å¦æ include å exclude åçå²çªï¼maven ä¼ä»¥ exclude ä½ä¸ºææé¡¹ã\n * testresources: testresources ä¸ resources åè½ç±»ä¼¼ï¼åºå«ä»å¨äºï¼testresources æå®çèµæºä»ç¨äº test é¶æ®µï¼å¹¶ä¸å¶é»è®¤èµæºç®å½ä¸ºï¼${basedir}/src/test/resources ã\n\n# plugins\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  <build>\n    ...\n    <plugins>\n      <plugin>\n        <groupid>org.apache.maven.plugins</groupid>\n        <artifactid>maven-jar-plugin</artifactid>\n        <version>2.6</version>\n        <extensions>false</extensions>\n        <inherited>true</inherited>\n        <configuration>\n          <classifier>test</classifier>\n        </configuration>\n        <dependencies>...</dependencies>\n        <executions>...</executions>\n      </plugin>\n    </plugins>\n  </build>\n</project>\n\n\n * groupid, artifactid, version ï¼ååºæ¬éç½®ä¸­ç groupidãartifactidãversion æä¹ç¸åã\n\n * extensions ï¼å¼ä¸º true æ falseãæ¯å¦å è½½æ­¤æä»¶çæ©å±åãé»è®¤ä¸º falseã\n\n * inherited ï¼å¼ä¸º true æ falseãè¿ä¸ªæä»¶éç½®æ¯å¦åºè¯¥éç¨äºç»§æ¿èªè¿ä¸ªæä»¶ç pomãé»è®¤å¼ä¸º trueã\n\n * configuration - è¿æ¯éå¯¹ä¸ªäººæä»¶çéç½®ï¼è¿éä¸æ©æ£è®²è§£ã\n\n * dependencies ï¼è¿éç dependencies æ¯æä»¶æ¬èº«æéè¦çä¾èµã\n\n * executions ï¼éè¦è®°ä½çæ¯ï¼æä»¶å¯è½æå¤ä¸ªç®æ ãæ¯ä¸ªç®æ å¯è½æä¸ä¸ªåç¬çéç½®ï¼çè³å¯è½å°æä»¶çç®æ å®å¨ç»å®å°ä¸åçé¶æ®µãæ§è¡éç½®æä»¶çç®æ çæ§è¡ã\n   \n   * id: æ§è¡ç®æ çæ è¯ã\n   * goals: åææå¤ååç pom åç´ ä¸æ ·ï¼å®åå«åä¸ªåç´ çåè¡¨ãå¨è¿ç§æåµä¸ï¼è¿ä¸ªæ§è¡åæå®çæä»¶ç®æ åè¡¨ã\n   * phase: è¿æ¯æ§è¡ç®æ åè¡¨çé¶æ®µãè¿æ¯ä¸ä¸ªéå¸¸å¼ºå¤§çéé¡¹ï¼åè®¸å°ä»»ä½ç®æ ç»å®å°æå»ºçå½å¨æä¸­çä»»ä½é¶æ®µï¼ä»èæ¹å maven çé»è®¤è¡ä¸ºã\n   * inherited: åä¸é¢çç»§æ¿åç´ ä¸æ ·ï¼è®¾ç½®è¿ä¸ª false ä¼é»æ­¢ maven å°è¿ä¸ªæ§è¡ä¼ éç»å®çå­ä»£ãæ­¤åç´ ä»å¯¹ç¶ pom ææä¹ã\n   * configuration: ä¸ä¸è¿°ç¸åï¼ä½å°éç½®éå¶å¨æ­¤ç¹å®ç®æ åè¡¨ä¸­ï¼èä¸æ¯æä»¶ä¸çææç®æ ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <build>\n    <plugins>\n      <plugin>\n        <artifactid>maven-antrun-plugin</artifactid>\n        <version>1.1</version>\n        <executions>\n          <execution>\n            <id>echodir</id>\n            <goals>\n              <goal>run</goal>\n            </goals>\n            <phase>verify</phase>\n            <inherited>false</inherited>\n            <configuration>\n              <tasks>\n                <echo>build dir: ${project.build.directory}</echo>\n              </tasks>\n            </configuration>\n          </execution>\n        </executions>\n\n      </plugin>\n    </plugins>\n  </build>\n</project>\n\n\n# pluginmanagement\n\nä¸ dependencymanagement å¾ç¸ä¼¼ï¼å¨å½å pom ä¸­ä»å£°ææä»¶ï¼èä¸æ¯å®éå¼å¥æä»¶ãå­ pom ä¸­åªéç½® groupid å artifactid å°±å¯ä»¥å®ææä»¶çå¼ç¨ï¼ä¸å­ pom ææéå pluginmanagement å®ä¹ã\n\nå®çç®çå¨äºç»ä¸ææå­ pom çæä»¶çæ¬ã\n\n# directories\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <build>\n    <sourcedirectory>${basedir}/src/main/java</sourcedirectory>\n    <scriptsourcedirectory>${basedir}/src/main/scripts</scriptsourcedirectory>\n    <testsourcedirectory>${basedir}/src/test/java</testsourcedirectory>\n    <outputdirectory>${basedir}/target/classes</outputdirectory>\n    <testoutputdirectory>${basedir}/target/test-classes</testoutputdirectory>\n    ...\n  </build>\n</project>\n\n\nç®å½åç´ éåå­å¨äº build åç´ ä¸­ï¼å®ä¸ºæ´ä¸ª pom è®¾ç½®äºåç§ç®å½ç»æãç±äºå®ä»¬å¨éç½®æä»¶æå»ºä¸­ä¸å­å¨ï¼æä»¥è¿äºä¸è½ç±éç½®æä»¶æ´æ¹ã\n\nå¦æä¸è¿°ç®å½åç´ çå¼è®¾ç½®ä¸ºç»å¯¹è·¯å¾ï¼æ©å±å±æ§æ¶ï¼ï¼åä½¿ç¨è¯¥ç®å½ãå¦åï¼å®æ¯ç¸å¯¹äºåºç¡æå»ºç®å½ï¼${basedir}ã\n\n# extensions\n\næ©å±æ¯å¨æ­¤æå»ºä¸­ä½¿ç¨ç artifacts çåè¡¨ãå®ä»¬å°è¢«åå«å¨è¿è¡æå»ºç classpath ä¸­ãå®ä»¬å¯ä»¥å¯ç¨å¯¹æå»ºè¿ç¨çæ©å±ï¼ä¾å¦ä¸º wagon ä¼ è¾æºå¶æ·»å ä¸ä¸ª ftp æä¾ç¨åºï¼ï¼å¹¶ä½¿æ´»å¨çæä»¶è½å¤å¯¹æå»ºçå½å¨æè¿è¡æ´æ¹ãç®èè¨ä¹ï¼æ©å±æ¯å¨æå»ºæé´æ¿æ´»ç artifactsãæ©å±ä¸éè¦å®éæ§è¡ä»»ä½æä½ï¼ä¹ä¸åå« mojoãå æ­¤ï¼æ©å±å¯¹äºæå®æ®éæä»¶æ¥å£çå¤ä¸ªå®ç°ä¸­çä¸ä¸ªæ¯éå¸¸å¥½çã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <build>\n    ...\n    <extensions>\n      <extension>\n        <groupid>org.apache.maven.wagon</groupid>\n        <artifactid>wagon-ftp</artifactid>\n        <version>1.0-alpha-3</version>\n      </extension>\n    </extensions>\n    ...\n  </build>\n</project>\n\n\n\n# reporting\n\næ¥ååå«ç¹å®éå¯¹ site çæé¶æ®µçåç´ ãæäº maven æä»¶å¯ä»¥çæ reporting åç´ ä¸éç½®çæ¥åï¼ä¾å¦ï¼çæ javadoc æ¥åãreporting ä¸ build åç´ éç½®æä»¶çè½åç¸ä¼¼ãææ¾çåºå«å¨äºï¼å¨æ§è¡åä¸­æä»¶ç®æ çæ§å¶ä¸æ¯ç»ç²åº¦çï¼æ¥è¡¨éè¿éç½® reportset åç´ æ¥ç²¾ç»æ§å¶ãèå¾®å¦çåºå«å¨äº reporting åç´ ä¸ç configuration åç´ å¯ä»¥ç¨ä½ build ä¸ç configuration ï¼å°½ç®¡ç¸åçæåµå¹¶éå¦æ­¤ï¼ build ä¸ç configuration ä¸å½±å reporting åç´ ä¸ç configuration ï¼ã\n\nå¦ä¸ä¸ªåºå«å°±æ¯ plugin ä¸ç outputdirectory åç´ ãå¨æ¥åçæåµä¸ï¼é»è®¤è¾åºç®å½ä¸º ${basedir}/target/siteã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <reporting>\n    <plugins>\n      <plugin>\n        ...\n        <reportsets>\n          <reportset>\n            <id>sunlink</id>\n            <reports>\n              <report>javadoc</report>\n            </reports>\n            <inherited>true</inherited>\n            <configuration>\n              <links>\n                <link>http://java.sun.com/j2se/1.5.0/docs/api/</link>\n              </links>\n            </configuration>\n          </reportset>\n        </reportsets>\n      </plugin>\n    </plugins>\n  </reporting>\n  ...\n</project>\n\n\n\n# é¡¹ç®ä¿¡æ¯\n\né¡¹ç®ä¿¡æ¯ç¸å³çè¿é¨åæ ç­¾é½ä¸æ¯å¿è¦çï¼ä¹å°±æ¯è¯´å®å¨å¯ä»¥ä¸å¡«åã\n\nå®çä½ç¨ä»éäºæè¿°é¡¹ç®çè¯¦ç»ä¿¡æ¯ã\n\nä¸é¢çç¤ºä¾æ¯é¡¹ç®ä¿¡æ¯ç¸å³æ ç­¾çæ¸åï¼\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n\n  \x3c!-- é¡¹ç®ä¿¡æ¯ begin --\x3e\n\n  \x3c!--é¡¹ç®å--\x3e\n  <name>maven-notes</name>\n\n  \x3c!--é¡¹ç®æè¿°--\x3e\n  <description>maven å­¦ä¹ ç¬è®°</description>\n\n  \x3c!--é¡¹ç®url--\x3e\n  <url>https://github.com/dunwu/maven-notes</url>\n\n  \x3c!--é¡¹ç®å¼åå¹´ä»½--\x3e\n  <inceptionyear>2017</inceptionyear>\n\n  \x3c!--å¼æºåè®®--\x3e\n  <licenses>\n    <license>\n      <name>apache license, version 2.0</name>\n      <url>https://www.apache.org/licenses/license-2.0.txt</url>\n      <distribution>repo</distribution>\n      <comments>a business-friendly oss license</comments>\n    </license>\n  </licenses>\n\n  \x3c!--ç»ç»ä¿¡æ¯(å¦å¬å¸ãå¼æºç»ç»ç­)--\x3e\n  <organization>\n    <name>...</name>\n    <url>...</url>\n  </organization>\n\n  \x3c!--å¼åèåè¡¨--\x3e\n  <developers>\n    <developer>\n      <id>victor</id>\n      <name>zhang peng</name>\n      <email>forbreak at 163.com</email>\n      <url>https://github.com/dunwu</url>\n      <organization>...</organization>\n      <organizationurl>...</organizationurl>\n      <roles>\n        <role>architect</role>\n        <role>developer</role>\n      </roles>\n      <timezone>+8</timezone>\n      <properties>...</properties>\n    </developer>\n  </developers>\n\n  \x3c!--ä»£ç è´¡ç®èåè¡¨--\x3e\n   <contributors>\n    <contributor>\n      \x3c!--æ ç­¾åå®¹å<developer>ç¸å--\x3e\n    </contributor>\n  </contributors>\n\n  \x3c!-- é¡¹ç®ä¿¡æ¯ end --\x3e\n\n  ...\n</project>\n\n\nè¿é¨åæ ç­¾é½éå¸¸ç®åï¼åºæ¬é½è½åå°é¡¾åæä¹ï¼ä¸é½å±äºå¯æå¯æ çæ ç­¾ï¼æä»¥è¿éä»ç®åä»ç»ä¸ä¸ï¼\n\n * name - é¡¹ç®å®æ´åç§°\n\n * description - é¡¹ç®æè¿°\n\n * url - ä¸è¬ä¸ºé¡¹ç®ä»åºç host\n\n * inceptionyear - å¼åå¹´ä»½\n\n * licenses - å¼æºåè®®\n\n * organization - é¡¹ç®æå±ç»ç»ä¿¡æ¯\n\n * developers - é¡¹ç®å¼åèåè¡¨\n\n * contributors - é¡¹ç®è´¡ç®èåè¡¨ï¼<contributor> çå­æ ç­¾å <developer> çå®å¨ç¸åã\n\n\n# ç¯å¢éç½®\n\n\n# issuemanagement\n\nè¿å®ä¹äºæä½¿ç¨çç¼ºé·è·è¸ªç³»ç»ï¼bugzillaï¼testtrackï¼clearquest ç­ï¼ãè½ç¶æ²¡æä»ä¹å¯ä»¥é»æ­¢æä»¶ä½¿ç¨è¿äºä¿¡æ¯çä¸è¥¿ï¼ä½å®ä¸»è¦ç¨äºçæé¡¹ç®ææ¡£ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <issuemanagement>\n    <system>bugzilla</system>\n    <url>http://127.0.0.1/bugzilla/</url>\n  </issuemanagement>\n  ...\n</project>\n\n\n\n# cimanagement\n\nci æå»ºç³»ç»éç½®ï¼ä¸»è¦æ¯æå®éç¥æºå¶ä»¥åè¢«éç¥çé®ç®±ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <cimanagement>\n    <system>continuum</system>\n    <url>http://127.0.0.1:8080/continuum</url>\n    <notifiers>\n      <notifier>\n        <type>mail</type>\n        <sendonerror>true</sendonerror>\n        <sendonfailure>true</sendonfailure>\n        <sendonsuccess>false</sendonsuccess>\n        <sendonwarning>false</sendonwarning>\n        <configuration><address>continuum@127.0.0.1</address></configuration>\n      </notifier>\n    </notifiers>\n  </cimanagement>\n  ...\n</project>\n\n\n\n# mailinglists\n\né®ä»¶åè¡¨\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <mailinglists>\n    <mailinglist>\n      <name>user list</name>\n      <subscribe>user-subscribe@127.0.0.1</subscribe>\n      <unsubscribe>user-unsubscribe@127.0.0.1</unsubscribe>\n      <post>user@127.0.0.1</post>\n      <archive>http://127.0.0.1/user/</archive>\n      <otherarchives>\n        <otherarchive>http://base.google.com/base/1/127.0.0.1</otherarchive>\n      </otherarchives>\n    </mailinglist>\n  </mailinglists>\n  ...\n</project>\n\n\n\n# scm\n\nscmï¼è½¯ä»¶éç½®ç®¡çï¼ä¹ç§°ä¸ºæºä»£ç /æ§å¶ç®¡çæç®æ´ççæ¬æ§å¶ï¼ãå¸¸è§ç scm æ svn å git ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <scm>\n    <connection>scm:svn:http://127.0.0.1/svn/my-project</connection>\n    <developerconnection>scm:svn:https://127.0.0.1/svn/my-project</developerconnection>\n    <tag>head</tag>\n    <url>http://127.0.0.1/websvn/my-project</url>\n  </scm>\n  ...\n</project>\n\n\n\n# prerequisites\n\npom æ§è¡çé¢è®¾æ¡ä»¶ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <prerequisites>\n    <maven>2.0.6</maven>\n  </prerequisites>\n  ...\n</project>\n\n\n\n# repositories\n\nrepositories æ¯éµå¾ª maven å­å¨åºç®å½å¸å±ç artifacts éåãé»è®¤ç maven ä¸­å¤®å­å¨åºä½äºhttps://repo.maven.apache.org/maven2/ä¸ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <repositories>\n    <repository>\n      <releases>\n        <enabled>false</enabled>\n        <updatepolicy>always</updatepolicy>\n        <checksumpolicy>warn</checksumpolicy>\n      </releases>\n      <snapshots>\n        <enabled>true</enabled>\n        <updatepolicy>never</updatepolicy>\n        <checksumpolicy>fail</checksumpolicy>\n      </snapshots>\n      <id>codehaussnapshots</id>\n      <name>codehaus snapshots</name>\n      <url>http://snapshots.maven.codehaus.org/maven2</url>\n      <layout>default</layout>\n    </repository>\n  </repositories>\n  <pluginrepositories>\n    ...\n  </pluginrepositories>\n  ...\n</project>\n\n\n\n# pluginrepositories\n\nä¸ repositories å·®ä¸å¤ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <distributionmanagement>\n    ...\n    <downloadurl>http://mojo.codehaus.org/my-project</downloadurl>\n    <status>deployed</status>\n  </distributionmanagement>\n  ...\n</project>\n\n\n\n# distributionmanagement\n\nå®ç®¡çå¨æ´ä¸ªæå»ºè¿ç¨ä¸­çæç artifact åæ¯ææä»¶çåå¸ãä»æåçåç´ å¼å§ï¼\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <distributionmanagement>\n    ...\n    <downloadurl>http://mojo.codehaus.org/my-project</downloadurl>\n    <status>deployed</status>\n  </distributionmanagement>\n  ...\n</project>\n\n\n * repository - ä¸ repositories ç¸ä¼¼\n\n * site - ç«ç¹ä¿¡æ¯\n\n * relocation - é¡¹ç®è¿ç§»ä½ç½®\n\n\n# profiles\n\nactivation æ¯ä¸ä¸ª profile çå³é®ãéç½®æä»¶çåè½æ¥èªäºå¨æäºæåµä¸ä»ä¿®æ¹åºæ¬ pom çåè½ãè¿äºæåµéè¿ activation åç´ æå®ã\n\n<project xmlns="http://maven.apache.org/pom/4.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/pom/4.0.0\n                      https://maven.apache.org/xsd/maven-4.0.0.xsd">\n  ...\n  <profiles>\n    <profile>\n      <id>test</id>\n      <activation>\n        <activebydefault>false</activebydefault>\n        <jdk>1.5</jdk>\n        <os>\n          <name>windows xp</name>\n          <family>windows</family>\n          <arch>x86</arch>\n          <version>5.1.2600</version>\n        </os>\n        <property>\n          <name>sparrow-type</name>\n          <value>african</value>\n        </property>\n        <file>\n          <exists>${basedir}/file2.properties</exists>\n          <missing>${basedir}/file1.properties</missing>\n        </file>\n      </activation>\n      ...\n    </profile>\n  </profiles>\n</project>\n\n\n\n# åèèµæ\n\n * maven å®æ¹ææ¡£ä¹ pom',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven æç¨ä¹ settings.xml è¯¦è§£",frontmatter:{title:"Maven æç¨ä¹ settings.xml è¯¦è§£",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],abbrlink:"e9105404",date:"2019-05-14T14:57:33.000Z",permalink:"/pages/d05c38/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/03.Maven%E6%95%99%E7%A8%8B%E4%B9%8Bsettings.xml%E8%AF%A6%E8%A7%A3.html",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/03.Mavenæç¨ä¹settings.xmlè¯¦è§£.md",key:"v-6441b580",path:"/pages/d05c38/",headers:[{level:2,title:"settings.xml ç®ä»",slug:"settings-xml-ç®ä»",normalizedTitle:"settings.xml ç®ä»",charIndex:32},{level:3,title:"settings.xml æä»ä¹ç¨",slug:"settings-xml-æä»ä¹ç¨",normalizedTitle:"settings.xml æä»ä¹ç¨",charIndex:52},{level:3,title:"settings.xml æä»¶ä½ç½®",slug:"settings-xml-æä»¶ä½ç½®",normalizedTitle:"settings.xml æä»¶ä½ç½®",charIndex:223},{level:3,title:"éç½®ä¼åçº§",slug:"éç½®ä¼åçº§",normalizedTitle:"éç½®ä¼åçº§",charIndex:442},{level:2,title:"settings.xml åç´ è¯¦è§£",slug:"settings-xml-åç´ è¯¦è§£",normalizedTitle:"settings.xml åç´ è¯¦è§£",charIndex:578},{level:3,title:"é¡¶çº§åç´ æ¦è§",slug:"é¡¶çº§åç´ æ¦è§",normalizedTitle:"é¡¶çº§åç´ æ¦è§",charIndex:600},{level:3,title:"LocalRepository",slug:"localrepository",normalizedTitle:"localrepository",charIndex:1077},{level:3,title:"InteractiveMode",slug:"interactivemode",normalizedTitle:"interactivemode",charIndex:1207},{level:3,title:"UsePluginRegistry",slug:"usepluginregistry",normalizedTitle:"usepluginregistry",charIndex:1353},{level:3,title:"Offline",slug:"offline",normalizedTitle:"offline",charIndex:1541},{level:3,title:"PluginGroups",slug:"plugingroups",normalizedTitle:"plugingroups",charIndex:1688},{level:3,title:"Servers",slug:"servers",normalizedTitle:"servers",charIndex:2311},{level:3,title:"Mirrors",slug:"mirrors",normalizedTitle:"mirrors",charIndex:3754},{level:3,title:"Proxies",slug:"proxies",normalizedTitle:"proxies",charIndex:4554},{level:3,title:"Profiles",slug:"profiles",normalizedTitle:"profiles",charIndex:1049},{level:4,title:"Activation",slug:"activation",normalizedTitle:"activation",charIndex:6504},{level:4,title:"properties",slug:"properties",normalizedTitle:"properties",charIndex:5766},{level:4,title:"Repositories",slug:"repositories",normalizedTitle:"repositories",charIndex:5751},{level:4,title:"pluginRepositories",slug:"pluginrepositories",normalizedTitle:"pluginrepositories",charIndex:5745},{level:3,title:"ActiveProfiles",slug:"activeprofiles",normalizedTitle:"activeprofiles",charIndex:10568},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:11334}],headersStr:"settings.xml ç®ä» settings.xml æä»ä¹ç¨ settings.xml æä»¶ä½ç½® éç½®ä¼åçº§ settings.xml åç´ è¯¦è§£ é¡¶çº§åç´ æ¦è§ LocalRepository InteractiveMode UsePluginRegistry Offline PluginGroups Servers Mirrors Proxies Profiles Activation properties Repositories pluginRepositories ActiveProfiles åèèµæ",content:'# Maven æç¨ä¹ settings.xml è¯¦è§£\n\n\n# settings.xml ç®ä»\n\n\n# settings.xml æä»ä¹ç¨\n\nä» settings.xml çæä»¶åå°±å¯ä»¥çåºï¼å®æ¯ç¨æ¥è®¾ç½® maven åæ°çéç½®æä»¶ãsettings.xml ä¸­åå«ç±»ä¼¼æ¬å°ä»å¨ä½ç½®ãä¿®æ¹è¿ç¨ä»å¨æå¡å¨ãè®¤è¯ä¿¡æ¯ç­éç½®ã\n\n * settings.xml æ¯ maven çå¨å±éç½®æä»¶ã\n * pom.xml æä»¶æ¯æ¬å°é¡¹ç®éç½®æä»¶ã\n\n\n# settings.xml æä»¶ä½ç½®\n\nsettings.xml æä»¶ä¸è¬å­å¨äºä¸¤ä¸ªä½ç½®ï¼\n\n * å¨å±éç½® - ${maven.home}/conf/settings.xml\n * ç¨æ·éç½® - ${user.home}/.m2/settings.xml\n\n> ð æ³¨æï¼ç¨æ·éç½®ä¼åäºå¨å±éç½®ã${user.home} ååææå¶ä»ç³»ç»å±æ§åªè½å¨ 3.0+çæ¬ä¸ä½¿ç¨ãè¯·æ³¨æ windows å Linux ä½¿ç¨åéçåºå«ã\n\n\n# éç½®ä¼åçº§\n\n> éè¦ï¼å±é¨éç½®ä¼åäºå¨å±éç½®ã\n\néç½®ä¼åçº§ä»é«å°ä½ï¼pom.xml > user settings > global settings\n\nå¦æè¿äºæä»¶åæ¶å­å¨ï¼å¨åºç¨éç½®æ¶ï¼ä¼åå¹¶å®ä»¬çåå®¹ï¼å¦ææéå¤çéç½®ï¼ä¼åçº§é«çéç½®ä¼è¦çä¼åçº§ä½çã\n\n\n# settings.xml åç´ è¯¦è§£\n\n\n# é¡¶çº§åç´ æ¦è§\n\nä¸é¢åä¸¾äºsettings.xmlä¸­çé¡¶çº§åç´ \n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"\n      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n      xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                          https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  <localRepository/>\n  <interactiveMode/>\n  <usePluginRegistry/>\n  <offline/>\n  <pluginGroups/>\n  <servers/>\n  <mirrors/>\n  <proxies/>\n  <profiles/>\n  <activeProfiles/>\n</settings>\n\n\n\n# LocalRepository\n\nä½ç¨ï¼è¯¥å¼è¡¨ç¤ºæå»ºç³»ç»æ¬å°ä»åºçè·¯å¾ã\n\nå¶é»è®¤å¼ï¼~/.m2/repositoryã\n\n<localRepository>${user.home}/.m2/repository</localRepository>\n\n\n\n# InteractiveMode\n\nä½ç¨ï¼è¡¨ç¤º maven æ¯å¦éè¦åç¨æ·äº¤äºä»¥è·å¾è¾å¥ã\n\nå¦æ maven éè¦åç¨æ·äº¤äºä»¥è·å¾è¾å¥ï¼åè®¾ç½®æ trueï¼åä¹ååºä¸º falseãé»è®¤ä¸º trueã\n\n<interactiveMode>true</interactiveMode>\n\n\n\n# UsePluginRegistry\n\nä½ç¨ï¼maven æ¯å¦éè¦ä½¿ç¨ plugin-registry.xml æä»¶æ¥ç®¡çæä»¶çæ¬ã\n\nå¦æéè¦è®© maven ä½¿ç¨æä»¶~/.m2/plugin-registry.xml æ¥ç®¡çæä»¶çæ¬ï¼åè®¾ä¸º trueãé»è®¤ä¸º falseã\n\n<usePluginRegistry>false</usePluginRegistry>\n\n\n\n# Offline\n\nä½ç¨ï¼è¡¨ç¤º maven æ¯å¦éè¦å¨ç¦»çº¿æ¨¡å¼ä¸è¿è¡ã\n\nå¦ææå»ºç³»ç»éè¦å¨ç¦»çº¿æ¨¡å¼ä¸è¿è¡ï¼åä¸º trueï¼é»è®¤ä¸º falseã\n\nå½ç±äºç½ç»è®¾ç½®åå æèå®å¨å ç´ ï¼æå»ºæå¡å¨ä¸è½è¿æ¥è¿ç¨ä»åºçæ¶åï¼è¯¥éç½®å°±ååæç¨ã\n\n<offline>false</offline>\n\n\n\n# PluginGroups\n\nä½ç¨ï¼å½æä»¶çç»ç» idï¼groupIdï¼æ²¡ææ¾å¼æä¾æ¶ï¼ä¾æå¯»æä»¶ç»ç» Idï¼groupIdï¼çåè¡¨ã\n\nè¯¥åç´ åå«ä¸ä¸ª pluginGroup åç´ åè¡¨ï¼æ¯ä¸ªå­åç´ åå«äºä¸ä¸ªç»ç» Idï¼groupIdï¼ã\n\nå½æä»¬ä½¿ç¨æä¸ªæä»¶ï¼å¹¶ä¸æ²¡æå¨å½ä»¤è¡ä¸ºå¶æä¾ç»ç» Idï¼groupIdï¼çæ¶åï¼Maven å°±ä¼ä½¿ç¨è¯¥åè¡¨ãé»è®¤æåµä¸è¯¥åè¡¨åå«äº org.apache.maven.plugins å org.codehaus.mojoã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <pluginGroups>\n    \x3c!--pluginçç»ç»Idï¼groupIdï¼ --\x3e\n    <pluginGroup>org.codehaus.mojo</pluginGroup>\n  </pluginGroups>\n  ...\n</settings>\n\n\n\n# Servers\n\nä½ç¨ï¼ä¸è¬ï¼ä»åºçä¸è½½åé¨ç½²æ¯å¨ pom.xml æä»¶ä¸­ç repositories å distributionManagement åç´ ä¸­å®ä¹çãç¶èï¼ä¸è¬ç±»ä¼¼ç¨æ·åãå¯ç ï¼æäºä»åºè®¿é®æ¯éè¦å®å¨è®¤è¯çï¼ç­ä¿¡æ¯ä¸åºè¯¥å¨ pom.xml æä»¶ä¸­éç½®ï¼è¿äºä¿¡æ¯å¯ä»¥éç½®å¨ settings.xml ä¸­ã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  \x3c!--éç½®æå¡ç«¯çä¸äºè®¾ç½®ãä¸äºè®¾ç½®å¦å®å¨è¯ä¹¦ä¸åºè¯¥åpom.xmlä¸èµ·ååãè¿ç§ç±»åçä¿¡æ¯åºè¯¥å­å¨äºæå»ºæå¡å¨ä¸çsettings.xmlæä»¶ä¸­ã --\x3e\n  <servers>\n    \x3c!--æå¡å¨åç´ åå«éç½®æå¡å¨æ¶éè¦çä¿¡æ¯ --\x3e\n    <server>\n      \x3c!--è¿æ¯serverçidï¼æ³¨æä¸æ¯ç¨æ·ç»éçidï¼ï¼è¯¥idä¸distributionManagementä¸­repositoryåç´ çidç¸å¹éã --\x3e\n      <id>server001</id>\n      \x3c!--é´æç¨æ·åãé´æç¨æ·ååé´æå¯ç è¡¨ç¤ºæå¡å¨è®¤è¯æéè¦çç»å½ååå¯ç ã --\x3e\n      <username>my_login</username>\n      \x3c!--é´æå¯ç  ãé´æç¨æ·ååé´æå¯ç è¡¨ç¤ºæå¡å¨è®¤è¯æéè¦çç»å½ååå¯ç ãå¯ç å å¯åè½å·²è¢«æ·»å å°2.1.0 +ãè¯¦æè¯·è®¿é®å¯ç å å¯é¡µé¢ --\x3e\n      <password>my_password</password>\n      \x3c!--é´ææ¶ä½¿ç¨çç§é¥ä½ç½®ãååä¸¤ä¸ªåç´ ç±»ä¼¼ï¼ç§é¥ä½ç½®åç§é¥å¯ç æå®äºä¸ä¸ªç§é¥çè·¯å¾ï¼é»è®¤æ¯${user.home}/.ssh/id_dsaï¼ä»¥åå¦æéè¦çè¯ï¼ä¸ä¸ªå¯è¯­ãå°æ¥passphraseåpasswordåç´ å¯è½ä¼è¢«æåå°å¤é¨ï¼ä½ç®åå®ä»¬å¿é¡»å¨settings.xmlæä»¶ä»¥çº¯ææ¬çå½¢å¼å£°æã --\x3e\n      <privateKey>${usr.home}/.ssh/id_dsa</privateKey>\n      \x3c!--é´ææ¶ä½¿ç¨çç§é¥å¯ç ã --\x3e\n      <passphrase>some_passphrase</passphrase>\n      \x3c!--æä»¶è¢«åå»ºæ¶çæéãå¦æå¨é¨ç½²çæ¶åä¼åå»ºä¸ä¸ªä»åºæä»¶æèç®å½ï¼è¿æ¶åå°±å¯ä»¥ä½¿ç¨æéï¼permissionï¼ãè¿ä¸¤ä¸ªåç´ åæ³çå¼æ¯ä¸ä¸ªä¸ä½æ°å­ï¼å¶å¯¹åºäºunixæä»¶ç³»ç»çæéï¼å¦664ï¼æè775ã --\x3e\n      <filePermissions>664</filePermissions>\n      \x3c!--ç®å½è¢«åå»ºæ¶çæéã --\x3e\n      <directoryPermissions>775</directoryPermissions>\n    </server>\n  </servers>\n  ...\n</settings>\n\n\n\n# Mirrors\n\nä½ç¨ï¼ä¸ºä»åºåè¡¨éç½®çä¸è½½éååè¡¨ã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <mirrors>\n    \x3c!-- ç»å®ä»åºçä¸è½½éåã --\x3e\n    <mirror>\n      \x3c!-- è¯¥éåçå¯ä¸æ è¯ç¬¦ãidç¨æ¥åºåä¸åçmirroråç´ ã --\x3e\n      <id>planetmirror.com</id>\n      \x3c!-- éååç§° --\x3e\n      <name>PlanetMirror Australia</name>\n      \x3c!-- è¯¥éåçURLãæå»ºç³»ç»ä¼ä¼åèèä½¿ç¨è¯¥URLï¼èéä½¿ç¨é»è®¤çæå¡å¨URLã --\x3e\n      <url>http://downloads.planetmirror.com/pub/maven2</url>\n      \x3c!-- è¢«éåçæå¡å¨çidãä¾å¦ï¼å¦ææä»¬è¦è®¾ç½®äºä¸ä¸ªMavenä¸­å¤®ä»åºï¼http://repo.maven.apache.org/maven2/ï¼çéåï¼å°±éè¦å°è¯¥åç´ è®¾ç½®æcentralãè¿å¿é¡»åä¸­å¤®ä»åºçid centralå®å¨ä¸è´ã --\x3e\n      <mirrorOf>central</mirrorOf>\n    </mirror>\n  </mirrors>\n  ...\n</settings>\n\n\n\n# Proxies\n\nä½ç¨ï¼ç¨æ¥éç½®ä¸åçä»£çã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <proxies>\n    \x3c!--ä»£çåç´ åå«éç½®ä»£çæ¶éè¦çä¿¡æ¯ --\x3e\n    <proxy>\n      \x3c!--ä»£ççå¯ä¸å®ä¹ç¬¦ï¼ç¨æ¥åºåä¸åçä»£çåç´ ã --\x3e\n      <id>myproxy</id>\n      \x3c!--è¯¥ä»£çæ¯å¦æ¯æ¿æ´»çé£ä¸ªãtrueåæ¿æ´»ä»£çãå½æä»¬å£°æäºä¸ç»ä»£çï¼èæä¸ªæ¶ååªéè¦æ¿æ´»ä¸ä¸ªä»£ççæ¶åï¼è¯¥åç´ å°±å¯ä»¥æ´¾ä¸ç¨å¤ã --\x3e\n      <active>true</active>\n      \x3c!--ä»£ççåè®®ã åè®®://ä¸»æºå:ç«¯å£ï¼åéæç¦»æ£çåç´ ä»¥æ¹ä¾¿éç½®ã --\x3e\n      <protocol>http</protocol>\n      \x3c!--ä»£ççä¸»æºåãåè®®://ä¸»æºå:ç«¯å£ï¼åéæç¦»æ£çåç´ ä»¥æ¹ä¾¿éç½®ã --\x3e\n      <host>proxy.somewhere.com</host>\n      \x3c!--ä»£ççç«¯å£ãåè®®://ä¸»æºå:ç«¯å£ï¼åéæç¦»æ£çåç´ ä»¥æ¹ä¾¿éç½®ã --\x3e\n      <port>8080</port>\n      \x3c!--ä»£ççç¨æ·åï¼ç¨æ·ååå¯ç è¡¨ç¤ºä»£çæå¡å¨è®¤è¯çç»å½ååå¯ç ã --\x3e\n      <username>proxyuser</username>\n      \x3c!--ä»£ççå¯ç ï¼ç¨æ·ååå¯ç è¡¨ç¤ºä»£çæå¡å¨è®¤è¯çç»å½ååå¯ç ã --\x3e\n      <password>somepassword</password>\n      \x3c!--ä¸è¯¥è¢«ä»£ççä¸»æºååè¡¨ãè¯¥åè¡¨çåéç¬¦ç±ä»£çæå¡å¨æå®ï¼ä¾å­ä¸­ä½¿ç¨äºç«çº¿åéç¬¦ï¼ä½¿ç¨éå·åéä¹å¾å¸¸è§ã --\x3e\n      <nonProxyHosts>*.google.com|ibiblio.org</nonProxyHosts>\n    </proxy>\n  </proxies>\n  ...\n</settings>\n\n\n\n# Profiles\n\nä½ç¨ï¼æ ¹æ®ç¯å¢åæ°æ¥è°æ´æå»ºéç½®çåè¡¨ã\n\nsettings.xml ä¸­ç profile åç´ æ¯ pom.xml ä¸­ profile åç´ çè£åªçæ¬ã\n\nå®åå«äºidãactivationãrepositoriesãpluginRepositories å properties åç´ ãè¿éç profile åç´ åªåå«è¿äºä¸ªå­åç´ æ¯å ä¸ºè¿éåªå³å¿æå»ºç³»ç»è¿ä¸ªæ´ä½ï¼è¿æ­£æ¯ settings.xml æä»¶çè§è²å®ä½ï¼ï¼èéåç¬çé¡¹ç®å¯¹è±¡æ¨¡åè®¾ç½®ãå¦æä¸ä¸ª settings.xml ä¸­ç profile è¢«æ¿æ´»ï¼å®çå¼ä¼è¦çä»»ä½å¶å®å®ä¹å¨ pom.xml ä¸­å¸¦æç¸å id ç profileã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <profiles>\n    <profile>\n      \x3c!-- profileçå¯ä¸æ è¯ --\x3e\n      <id>test</id>\n      \x3c!-- èªå¨è§¦åprofileçæ¡ä»¶é»è¾ --\x3e\n      <activation />\n      \x3c!-- æ©å±å±æ§åè¡¨ --\x3e\n      <properties />\n      \x3c!-- è¿ç¨ä»åºåè¡¨ --\x3e\n      <repositories />\n      \x3c!-- æä»¶ä»åºåè¡¨ --\x3e\n      <pluginRepositories />\n    </profile>\n  </profiles>\n  ...\n</settings>\n\n\n# Activation\n\nä½ç¨ï¼èªå¨è§¦å profile çæ¡ä»¶é»è¾ã\n\nå¦ pom.xml ä¸­ç profile ä¸æ ·ï¼profile çä½ç¨å¨äºå®è½å¤å¨æäºç¹å®çç¯å¢ä¸­èªå¨ä½¿ç¨æäºç¹å®çå¼ï¼è¿äºç¯å¢éè¿ activation åç´ æå®ã activation åç´ å¹¶ä¸æ¯æ¿æ´» profile çå¯ä¸æ¹å¼ãsettings.xml æä»¶ä¸­ç activeProfile åç´ å¯ä»¥åå« profile ç idãprofile ä¹å¯ä»¥éè¿å¨å½ä»¤è¡ï¼ä½¿ç¨ -P æ è®°åéå·åéçåè¡¨æ¥æ¾å¼çæ¿æ´»ï¼å¦ï¼-P testï¼ã\n\n<activation>\n  \x3c!--profileé»è®¤æ¯å¦æ¿æ´»çæ è¯ --\x3e\n  <activeByDefault>false</activeByDefault>\n  \x3c!--å½å¹éçjdkè¢«æ£æµå°ï¼profileè¢«æ¿æ´»ãä¾å¦ï¼1.4æ¿æ´»JDK1.4ï¼1.4.0_2ï¼è!1.4æ¿æ´»ææçæ¬ä¸æ¯ä»¥1.4å¼å¤´çJDKã --\x3e\n  <jdk>1.5</jdk>\n  \x3c!--å½å¹éçæä½ç³»ç»å±æ§è¢«æ£æµå°ï¼profileè¢«æ¿æ´»ãosåç´ å¯ä»¥å®ä¹ä¸äºæä½ç³»ç»ç¸å³çå±æ§ã --\x3e\n  <os>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»çåå­ --\x3e\n    <name>Windows XP</name>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»æå±å®¶æ(å¦ \'windows\') --\x3e\n    <family>Windows</family>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»ä½ç³»ç»æ --\x3e\n    <arch>x86</arch>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»çæ¬ --\x3e\n    <version>5.1.2600</version>\n  </os>\n  \x3c!--å¦æMavenæ£æµå°æä¸ä¸ªå±æ§ï¼å¶å¼å¯ä»¥å¨POMä¸­éè¿${name}å¼ç¨ï¼ï¼å¶æ¥æå¯¹åºçname = å¼ï¼Profileå°±ä¼è¢«æ¿æ´»ãå¦æå¼å­æ®µæ¯ç©ºçï¼é£ä¹å­å¨å±æ§åç§°å­æ®µå°±ä¼æ¿æ´»profileï¼å¦åæåºåå¤§å°åæ¹å¼å¹éå±æ§å¼å­æ®µ --\x3e\n  <property>\n    \x3c!--æ¿æ´»profileçå±æ§çåç§° --\x3e\n    <name>mavenVersion</name>\n    \x3c!--æ¿æ´»profileçå±æ§çå¼ --\x3e\n    <value>2.0.3</value>\n  </property>\n  \x3c!--æä¾ä¸ä¸ªæä»¶åï¼éè¿æ£æµè¯¥æä»¶çå­å¨æä¸å­å¨æ¥æ¿æ´»profileãmissingæ£æ¥æä»¶æ¯å¦å­å¨ï¼å¦æä¸å­å¨åæ¿æ´»profileãå¦ä¸æ¹é¢ï¼existsåä¼æ£æ¥æä»¶æ¯å¦å­å¨ï¼å¦æå­å¨åæ¿æ´»profileã --\x3e\n  <file>\n    \x3c!--å¦ææå®çæä»¶å­å¨ï¼åæ¿æ´»profileã --\x3e\n    <exists>${basedir}/file2.properties</exists>\n    \x3c!--å¦ææå®çæä»¶ä¸å­å¨ï¼åæ¿æ´»profileã --\x3e\n    <missing>${basedir}/file1.properties</missing>\n  </file>\n</activation>\n\n\n> æ³¨ï¼å¨ maven å·¥ç¨ç pom.xml æå¨ç®å½ä¸æ§è¡ mvn help:active-profiles å½ä»¤å¯ä»¥æ¥çä¸­å¤®ä»å¨ç profile æ¯å¦å¨å·¥ç¨ä¸­çæã\n\n# properties\n\nä½ç¨ï¼å¯¹åºprofileçæ©å±å±æ§åè¡¨ã\n\nmaven å±æ§å ant ä¸­çå±æ§ä¸æ ·ï¼å¯ä»¥ç¨æ¥å­æ¾ä¸äºå¼ãè¿äºå¼å¯ä»¥å¨ pom.xml ä¸­çä»»ä½å°æ¹ä½¿ç¨æ è®°${X}æ¥ä½¿ç¨ï¼è¿é X æ¯æå±æ§çåç§°ãå±æ§æäºç§ä¸åçå½¢å¼ï¼å¹¶ä¸é½è½å¨ settings.xml æä»¶ä¸­è®¿é®ã\n\n\x3c!--\n  1. env.X: å¨ä¸ä¸ªåéåå ä¸"env."çåç¼ï¼ä¼è¿åä¸ä¸ªshellç¯å¢åéãä¾å¦,"env.PATH"æä»£äº$pathç¯å¢åéï¼å¨Windowsä¸æ¯%PATH%ï¼ã\n  2. project.xï¼æä»£äºPOMä¸­å¯¹åºçåç´ å¼ãä¾å¦: <project><version>1.0</version></project>éè¿${project.version}è·å¾versionçå¼ã\n  3. settings.x: æä»£äºsettings.xmlä¸­å¯¹åºåç´ çå¼ãä¾å¦ï¼<settings><offline>false</offline></settings>éè¿ ${settings.offline}è·å¾offlineçå¼ã\n  4. Java System Properties: ææå¯éè¿java.lang.System.getProperties()è®¿é®çå±æ§é½è½å¨POMä¸­ä½¿ç¨è¯¥å½¢å¼è®¿é®ï¼ä¾å¦ ${java.home}ã\n  5. x: å¨<properties/>åç´ ä¸­ï¼æèå¤é¨æä»¶ä¸­è®¾ç½®ï¼ä»¥${someVar}çå½¢å¼ä½¿ç¨ã\n --\x3e\n<properties>\n  <user.install>${user.home}/our-project</user.install>\n</properties>\n\n\n> æ³¨ï¼å¦æè¯¥ profile è¢«æ¿æ´»ï¼åå¯ä»¥å¨pom.xmlä¸­ä½¿ç¨${user.install}ã\n\n# Repositories\n\nä½ç¨ï¼è¿ç¨ä»åºåè¡¨ï¼å®æ¯ maven ç¨æ¥å¡«åæå»ºç³»ç»æ¬å°ä»åºæä½¿ç¨çä¸ç»è¿ç¨ä»åºã\n\n<repositories>\n  \x3c!--åå«éè¦è¿æ¥å°è¿ç¨ä»åºçä¿¡æ¯ --\x3e\n  <repository>\n    \x3c!--è¿ç¨ä»åºå¯ä¸æ è¯ --\x3e\n    <id>codehausSnapshots</id>\n    \x3c!--è¿ç¨ä»åºåç§° --\x3e\n    <name>Codehaus Snapshots</name>\n    \x3c!--å¦ä½å¤çè¿ç¨ä»åºéåå¸çæ¬çä¸è½½ --\x3e\n    <releases>\n      \x3c!--trueæèfalseè¡¨ç¤ºè¯¥ä»åºæ¯å¦ä¸ºä¸è½½æç§ç±»åæä»¶ï¼åå¸çï¼å¿«ç§çï¼å¼å¯ã --\x3e\n      <enabled>false</enabled>\n      \x3c!--è¯¥åç´ æå®æ´æ°åççé¢çãMavenä¼æ¯è¾æ¬å°POMåè¿ç¨POMçæ¶é´æ³ãè¿éçéé¡¹æ¯ï¼alwaysï¼ä¸ç´ï¼ï¼dailyï¼é»è®¤ï¼æ¯æ¥ï¼ï¼intervalï¼Xï¼è¿éXæ¯ä»¥åéä¸ºåä½çæ¶é´é´éï¼ï¼æèneverï¼ä»ä¸ï¼ã --\x3e\n      <updatePolicy>always</updatePolicy>\n      \x3c!--å½Mavenéªè¯æä»¶æ ¡éªæä»¶å¤±è´¥æ¶è¯¥æä¹å-ignoreï¼å¿½ç¥ï¼ï¼failï¼å¤±è´¥ï¼ï¼æèwarnï¼è­¦åï¼ã --\x3e\n      <checksumPolicy>warn</checksumPolicy>\n    </releases>\n    \x3c!--å¦ä½å¤çè¿ç¨ä»åºéå¿«ç§çæ¬çä¸è½½ãæäºreleasesåsnapshotsè¿ä¸¤ç»éç½®ï¼POMå°±å¯ä»¥å¨æ¯ä¸ªåç¬çä»åºä¸­ï¼ä¸ºæ¯ç§ç±»åçæä»¶éåä¸åçç­ç¥ãä¾å¦ï¼å¯è½æäººä¼å³å®åªä¸ºå¼åç®çå¼å¯å¯¹å¿«ç§çæ¬ä¸è½½çæ¯æãåè§repositories/repository/releasesåç´  --\x3e\n    <snapshots>\n      <enabled />\n      <updatePolicy />\n      <checksumPolicy />\n    </snapshots>\n    \x3c!--è¿ç¨ä»åºURLï¼æprotocol://hostname/pathå½¢å¼ --\x3e\n    <url>http://snapshots.maven.codehaus.org/maven2</url>\n    \x3c!--ç¨äºå®ä½åæåºæä»¶çä»åºå¸å±ç±»å-å¯ä»¥æ¯defaultï¼é»è®¤ï¼æèlegacyï¼éçï¼ãMaven 2ä¸ºå¶ä»åºæä¾äºä¸ä¸ªé»è®¤çå¸å±ï¼ç¶èï¼Maven 1.xæä¸ç§ä¸åçå¸å±ãæä»¬å¯ä»¥ä½¿ç¨è¯¥åç´ æå®å¸å±æ¯defaultï¼é»è®¤ï¼è¿æ¯legacyï¼éçï¼ã --\x3e\n    <layout>default</layout>\n  </repository>\n</repositories>\n\n\n# pluginRepositories\n\nä½ç¨ï¼åç°æä»¶çè¿ç¨ä»åºåè¡¨ã\n\nå repository ç±»ä¼¼ï¼åªæ¯ repository æ¯ç®¡ç jar åä¾èµçä»åºï¼pluginRepositories åæ¯ç®¡çæä»¶çä»åºã maven æä»¶æ¯ä¸ç§ç¹æ®ç±»åçæä»¶ãç±äºè¿ä¸ªåå ï¼æä»¶ä»åºç¬ç«äºå¶å®ä»åºãpluginRepositories åç´ çç»æå repositories åç´ çç»æç±»ä¼¼ãæ¯ä¸ª pluginRepository åç´ æå®ä¸ä¸ª Maven å¯ä»¥ç¨æ¥å¯»æ¾æ°æä»¶çè¿ç¨å°åã\n\n<pluginRepositories>\n  \x3c!-- åå«éè¦è¿æ¥å°è¿ç¨æä»¶ä»åºçä¿¡æ¯.åè§profiles/profile/repositories/repositoryåç´ çè¯´æ --\x3e\n  <pluginRepository>\n    <releases>\n      <enabled />\n      <updatePolicy />\n      <checksumPolicy />\n    </releases>\n    <snapshots>\n      <enabled />\n      <updatePolicy />\n      <checksumPolicy />\n    </snapshots>\n    <id />\n    <name />\n    <url />\n    <layout />\n  </pluginRepository>\n</pluginRepositories>\n\n\n\n# ActiveProfiles\n\nä½ç¨ï¼æå¨æ¿æ´» profiles çåè¡¨ï¼æç§profileè¢«åºç¨çé¡ºåºå®ä¹activeProfileã\n\nè¯¥åç´ åå«äºä¸ç» activeProfile åç´ ï¼æ¯ä¸ª activeProfile é½å«æä¸ä¸ª profile idãä»»ä½å¨ activeProfile ä¸­å®ä¹ç profile idï¼ä¸è®ºç¯å¢è®¾ç½®å¦ä½ï¼å¶å¯¹åºç profile é½ä¼è¢«æ¿æ´»ãå¦ææ²¡æå¹éç profileï¼åä»ä¹é½ä¸ä¼åçã\n\nä¾å¦ï¼env-test æ¯ä¸ä¸ª activeProfileï¼åå¨ pom.xmlï¼æè profile.xmlï¼ä¸­å¯¹åº id ç profile ä¼è¢«æ¿æ´»ãå¦æè¿è¡è¿ç¨ä¸­æ¾ä¸å°è¿æ ·ä¸ä¸ª profileï¼Maven åä¼åå¾å¸¸ä¸æ ·è¿è¡ã\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <activeProfiles>\n    \x3c!-- è¦æ¿æ´»çprofile id --\x3e\n    <activeProfile>env-test</activeProfile>\n  </activeProfiles>\n  ...\n</settings>\n\n\nè³æ­¤ï¼maven settings.xml ä¸­çæ ç­¾é½è®²è§£å®æ¯ï¼å¸æå¯¹å¤§å®¶ææå¸®å©ã\n\n\n# åèèµæ\n\n * maven å®æ¹ææ¡£ä¹ settings',normalizedContent:'# maven æç¨ä¹ settings.xml è¯¦è§£\n\n\n# settings.xml ç®ä»\n\n\n# settings.xml æä»ä¹ç¨\n\nä» settings.xml çæä»¶åå°±å¯ä»¥çåºï¼å®æ¯ç¨æ¥è®¾ç½® maven åæ°çéç½®æä»¶ãsettings.xml ä¸­åå«ç±»ä¼¼æ¬å°ä»å¨ä½ç½®ãä¿®æ¹è¿ç¨ä»å¨æå¡å¨ãè®¤è¯ä¿¡æ¯ç­éç½®ã\n\n * settings.xml æ¯ maven çå¨å±éç½®æä»¶ã\n * pom.xml æä»¶æ¯æ¬å°é¡¹ç®éç½®æä»¶ã\n\n\n# settings.xml æä»¶ä½ç½®\n\nsettings.xml æä»¶ä¸è¬å­å¨äºä¸¤ä¸ªä½ç½®ï¼\n\n * å¨å±éç½® - ${maven.home}/conf/settings.xml\n * ç¨æ·éç½® - ${user.home}/.m2/settings.xml\n\n> ð æ³¨æï¼ç¨æ·éç½®ä¼åäºå¨å±éç½®ã${user.home} ååææå¶ä»ç³»ç»å±æ§åªè½å¨ 3.0+çæ¬ä¸ä½¿ç¨ãè¯·æ³¨æ windows å linux ä½¿ç¨åéçåºå«ã\n\n\n# éç½®ä¼åçº§\n\n> éè¦ï¼å±é¨éç½®ä¼åäºå¨å±éç½®ã\n\néç½®ä¼åçº§ä»é«å°ä½ï¼pom.xml > user settings > global settings\n\nå¦æè¿äºæä»¶åæ¶å­å¨ï¼å¨åºç¨éç½®æ¶ï¼ä¼åå¹¶å®ä»¬çåå®¹ï¼å¦ææéå¤çéç½®ï¼ä¼åçº§é«çéç½®ä¼è¦çä¼åçº§ä½çã\n\n\n# settings.xml åç´ è¯¦è§£\n\n\n# é¡¶çº§åç´ æ¦è§\n\nä¸é¢åä¸¾äºsettings.xmlä¸­çé¡¶çº§åç´ \n\n<settings xmlns="http://maven.apache.org/settings/1.0.0"\n      xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n      xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                          https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  <localrepository/>\n  <interactivemode/>\n  <usepluginregistry/>\n  <offline/>\n  <plugingroups/>\n  <servers/>\n  <mirrors/>\n  <proxies/>\n  <profiles/>\n  <activeprofiles/>\n</settings>\n\n\n\n# localrepository\n\nä½ç¨ï¼è¯¥å¼è¡¨ç¤ºæå»ºç³»ç»æ¬å°ä»åºçè·¯å¾ã\n\nå¶é»è®¤å¼ï¼~/.m2/repositoryã\n\n<localrepository>${user.home}/.m2/repository</localrepository>\n\n\n\n# interactivemode\n\nä½ç¨ï¼è¡¨ç¤º maven æ¯å¦éè¦åç¨æ·äº¤äºä»¥è·å¾è¾å¥ã\n\nå¦æ maven éè¦åç¨æ·äº¤äºä»¥è·å¾è¾å¥ï¼åè®¾ç½®æ trueï¼åä¹ååºä¸º falseãé»è®¤ä¸º trueã\n\n<interactivemode>true</interactivemode>\n\n\n\n# usepluginregistry\n\nä½ç¨ï¼maven æ¯å¦éè¦ä½¿ç¨ plugin-registry.xml æä»¶æ¥ç®¡çæä»¶çæ¬ã\n\nå¦æéè¦è®© maven ä½¿ç¨æä»¶~/.m2/plugin-registry.xml æ¥ç®¡çæä»¶çæ¬ï¼åè®¾ä¸º trueãé»è®¤ä¸º falseã\n\n<usepluginregistry>false</usepluginregistry>\n\n\n\n# offline\n\nä½ç¨ï¼è¡¨ç¤º maven æ¯å¦éè¦å¨ç¦»çº¿æ¨¡å¼ä¸è¿è¡ã\n\nå¦ææå»ºç³»ç»éè¦å¨ç¦»çº¿æ¨¡å¼ä¸è¿è¡ï¼åä¸º trueï¼é»è®¤ä¸º falseã\n\nå½ç±äºç½ç»è®¾ç½®åå æèå®å¨å ç´ ï¼æå»ºæå¡å¨ä¸è½è¿æ¥è¿ç¨ä»åºçæ¶åï¼è¯¥éç½®å°±ååæç¨ã\n\n<offline>false</offline>\n\n\n\n# plugingroups\n\nä½ç¨ï¼å½æä»¶çç»ç» idï¼groupidï¼æ²¡ææ¾å¼æä¾æ¶ï¼ä¾æå¯»æä»¶ç»ç» idï¼groupidï¼çåè¡¨ã\n\nè¯¥åç´ åå«ä¸ä¸ª plugingroup åç´ åè¡¨ï¼æ¯ä¸ªå­åç´ åå«äºä¸ä¸ªç»ç» idï¼groupidï¼ã\n\nå½æä»¬ä½¿ç¨æä¸ªæä»¶ï¼å¹¶ä¸æ²¡æå¨å½ä»¤è¡ä¸ºå¶æä¾ç»ç» idï¼groupidï¼çæ¶åï¼maven å°±ä¼ä½¿ç¨è¯¥åè¡¨ãé»è®¤æåµä¸è¯¥åè¡¨åå«äº org.apache.maven.plugins å org.codehaus.mojoã\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <plugingroups>\n    \x3c!--pluginçç»ç»idï¼groupidï¼ --\x3e\n    <plugingroup>org.codehaus.mojo</plugingroup>\n  </plugingroups>\n  ...\n</settings>\n\n\n\n# servers\n\nä½ç¨ï¼ä¸è¬ï¼ä»åºçä¸è½½åé¨ç½²æ¯å¨ pom.xml æä»¶ä¸­ç repositories å distributionmanagement åç´ ä¸­å®ä¹çãç¶èï¼ä¸è¬ç±»ä¼¼ç¨æ·åãå¯ç ï¼æäºä»åºè®¿é®æ¯éè¦å®å¨è®¤è¯çï¼ç­ä¿¡æ¯ä¸åºè¯¥å¨ pom.xml æä»¶ä¸­éç½®ï¼è¿äºä¿¡æ¯å¯ä»¥éç½®å¨ settings.xml ä¸­ã\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  \x3c!--éç½®æå¡ç«¯çä¸äºè®¾ç½®ãä¸äºè®¾ç½®å¦å®å¨è¯ä¹¦ä¸åºè¯¥åpom.xmlä¸èµ·ååãè¿ç§ç±»åçä¿¡æ¯åºè¯¥å­å¨äºæå»ºæå¡å¨ä¸çsettings.xmlæä»¶ä¸­ã --\x3e\n  <servers>\n    \x3c!--æå¡å¨åç´ åå«éç½®æå¡å¨æ¶éè¦çä¿¡æ¯ --\x3e\n    <server>\n      \x3c!--è¿æ¯serverçidï¼æ³¨æä¸æ¯ç¨æ·ç»éçidï¼ï¼è¯¥idä¸distributionmanagementä¸­repositoryåç´ çidç¸å¹éã --\x3e\n      <id>server001</id>\n      \x3c!--é´æç¨æ·åãé´æç¨æ·ååé´æå¯ç è¡¨ç¤ºæå¡å¨è®¤è¯æéè¦çç»å½ååå¯ç ã --\x3e\n      <username>my_login</username>\n      \x3c!--é´æå¯ç  ãé´æç¨æ·ååé´æå¯ç è¡¨ç¤ºæå¡å¨è®¤è¯æéè¦çç»å½ååå¯ç ãå¯ç å å¯åè½å·²è¢«æ·»å å°2.1.0 +ãè¯¦æè¯·è®¿é®å¯ç å å¯é¡µé¢ --\x3e\n      <password>my_password</password>\n      \x3c!--é´ææ¶ä½¿ç¨çç§é¥ä½ç½®ãååä¸¤ä¸ªåç´ ç±»ä¼¼ï¼ç§é¥ä½ç½®åç§é¥å¯ç æå®äºä¸ä¸ªç§é¥çè·¯å¾ï¼é»è®¤æ¯${user.home}/.ssh/id_dsaï¼ä»¥åå¦æéè¦çè¯ï¼ä¸ä¸ªå¯è¯­ãå°æ¥passphraseåpasswordåç´ å¯è½ä¼è¢«æåå°å¤é¨ï¼ä½ç®åå®ä»¬å¿é¡»å¨settings.xmlæä»¶ä»¥çº¯ææ¬çå½¢å¼å£°æã --\x3e\n      <privatekey>${usr.home}/.ssh/id_dsa</privatekey>\n      \x3c!--é´ææ¶ä½¿ç¨çç§é¥å¯ç ã --\x3e\n      <passphrase>some_passphrase</passphrase>\n      \x3c!--æä»¶è¢«åå»ºæ¶çæéãå¦æå¨é¨ç½²çæ¶åä¼åå»ºä¸ä¸ªä»åºæä»¶æèç®å½ï¼è¿æ¶åå°±å¯ä»¥ä½¿ç¨æéï¼permissionï¼ãè¿ä¸¤ä¸ªåç´ åæ³çå¼æ¯ä¸ä¸ªä¸ä½æ°å­ï¼å¶å¯¹åºäºunixæä»¶ç³»ç»çæéï¼å¦664ï¼æè775ã --\x3e\n      <filepermissions>664</filepermissions>\n      \x3c!--ç®å½è¢«åå»ºæ¶çæéã --\x3e\n      <directorypermissions>775</directorypermissions>\n    </server>\n  </servers>\n  ...\n</settings>\n\n\n\n# mirrors\n\nä½ç¨ï¼ä¸ºä»åºåè¡¨éç½®çä¸è½½éååè¡¨ã\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <mirrors>\n    \x3c!-- ç»å®ä»åºçä¸è½½éåã --\x3e\n    <mirror>\n      \x3c!-- è¯¥éåçå¯ä¸æ è¯ç¬¦ãidç¨æ¥åºåä¸åçmirroråç´ ã --\x3e\n      <id>planetmirror.com</id>\n      \x3c!-- éååç§° --\x3e\n      <name>planetmirror australia</name>\n      \x3c!-- è¯¥éåçurlãæå»ºç³»ç»ä¼ä¼åèèä½¿ç¨è¯¥urlï¼èéä½¿ç¨é»è®¤çæå¡å¨urlã --\x3e\n      <url>http://downloads.planetmirror.com/pub/maven2</url>\n      \x3c!-- è¢«éåçæå¡å¨çidãä¾å¦ï¼å¦ææä»¬è¦è®¾ç½®äºä¸ä¸ªmavenä¸­å¤®ä»åºï¼http://repo.maven.apache.org/maven2/ï¼çéåï¼å°±éè¦å°è¯¥åç´ è®¾ç½®æcentralãè¿å¿é¡»åä¸­å¤®ä»åºçid centralå®å¨ä¸è´ã --\x3e\n      <mirrorof>central</mirrorof>\n    </mirror>\n  </mirrors>\n  ...\n</settings>\n\n\n\n# proxies\n\nä½ç¨ï¼ç¨æ¥éç½®ä¸åçä»£çã\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <proxies>\n    \x3c!--ä»£çåç´ åå«éç½®ä»£çæ¶éè¦çä¿¡æ¯ --\x3e\n    <proxy>\n      \x3c!--ä»£ççå¯ä¸å®ä¹ç¬¦ï¼ç¨æ¥åºåä¸åçä»£çåç´ ã --\x3e\n      <id>myproxy</id>\n      \x3c!--è¯¥ä»£çæ¯å¦æ¯æ¿æ´»çé£ä¸ªãtrueåæ¿æ´»ä»£çãå½æä»¬å£°æäºä¸ç»ä»£çï¼èæä¸ªæ¶ååªéè¦æ¿æ´»ä¸ä¸ªä»£ççæ¶åï¼è¯¥åç´ å°±å¯ä»¥æ´¾ä¸ç¨å¤ã --\x3e\n      <active>true</active>\n      \x3c!--ä»£ççåè®®ã åè®®://ä¸»æºå:ç«¯å£ï¼åéæç¦»æ£çåç´ ä»¥æ¹ä¾¿éç½®ã --\x3e\n      <protocol>http</protocol>\n      \x3c!--ä»£ççä¸»æºåãåè®®://ä¸»æºå:ç«¯å£ï¼åéæç¦»æ£çåç´ ä»¥æ¹ä¾¿éç½®ã --\x3e\n      <host>proxy.somewhere.com</host>\n      \x3c!--ä»£ççç«¯å£ãåè®®://ä¸»æºå:ç«¯å£ï¼åéæç¦»æ£çåç´ ä»¥æ¹ä¾¿éç½®ã --\x3e\n      <port>8080</port>\n      \x3c!--ä»£ççç¨æ·åï¼ç¨æ·ååå¯ç è¡¨ç¤ºä»£çæå¡å¨è®¤è¯çç»å½ååå¯ç ã --\x3e\n      <username>proxyuser</username>\n      \x3c!--ä»£ççå¯ç ï¼ç¨æ·ååå¯ç è¡¨ç¤ºä»£çæå¡å¨è®¤è¯çç»å½ååå¯ç ã --\x3e\n      <password>somepassword</password>\n      \x3c!--ä¸è¯¥è¢«ä»£ççä¸»æºååè¡¨ãè¯¥åè¡¨çåéç¬¦ç±ä»£çæå¡å¨æå®ï¼ä¾å­ä¸­ä½¿ç¨äºç«çº¿åéç¬¦ï¼ä½¿ç¨éå·åéä¹å¾å¸¸è§ã --\x3e\n      <nonproxyhosts>*.google.com|ibiblio.org</nonproxyhosts>\n    </proxy>\n  </proxies>\n  ...\n</settings>\n\n\n\n# profiles\n\nä½ç¨ï¼æ ¹æ®ç¯å¢åæ°æ¥è°æ´æå»ºéç½®çåè¡¨ã\n\nsettings.xml ä¸­ç profile åç´ æ¯ pom.xml ä¸­ profile åç´ çè£åªçæ¬ã\n\nå®åå«äºidãactivationãrepositoriesãpluginrepositories å properties åç´ ãè¿éç profile åç´ åªåå«è¿äºä¸ªå­åç´ æ¯å ä¸ºè¿éåªå³å¿æå»ºç³»ç»è¿ä¸ªæ´ä½ï¼è¿æ­£æ¯ settings.xml æä»¶çè§è²å®ä½ï¼ï¼èéåç¬çé¡¹ç®å¯¹è±¡æ¨¡åè®¾ç½®ãå¦æä¸ä¸ª settings.xml ä¸­ç profile è¢«æ¿æ´»ï¼å®çå¼ä¼è¦çä»»ä½å¶å®å®ä¹å¨ pom.xml ä¸­å¸¦æç¸å id ç profileã\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <profiles>\n    <profile>\n      \x3c!-- profileçå¯ä¸æ è¯ --\x3e\n      <id>test</id>\n      \x3c!-- èªå¨è§¦åprofileçæ¡ä»¶é»è¾ --\x3e\n      <activation />\n      \x3c!-- æ©å±å±æ§åè¡¨ --\x3e\n      <properties />\n      \x3c!-- è¿ç¨ä»åºåè¡¨ --\x3e\n      <repositories />\n      \x3c!-- æä»¶ä»åºåè¡¨ --\x3e\n      <pluginrepositories />\n    </profile>\n  </profiles>\n  ...\n</settings>\n\n\n# activation\n\nä½ç¨ï¼èªå¨è§¦å profile çæ¡ä»¶é»è¾ã\n\nå¦ pom.xml ä¸­ç profile ä¸æ ·ï¼profile çä½ç¨å¨äºå®è½å¤å¨æäºç¹å®çç¯å¢ä¸­èªå¨ä½¿ç¨æäºç¹å®çå¼ï¼è¿äºç¯å¢éè¿ activation åç´ æå®ã activation åç´ å¹¶ä¸æ¯æ¿æ´» profile çå¯ä¸æ¹å¼ãsettings.xml æä»¶ä¸­ç activeprofile åç´ å¯ä»¥åå« profile ç idãprofile ä¹å¯ä»¥éè¿å¨å½ä»¤è¡ï¼ä½¿ç¨ -p æ è®°åéå·åéçåè¡¨æ¥æ¾å¼çæ¿æ´»ï¼å¦ï¼-p testï¼ã\n\n<activation>\n  \x3c!--profileé»è®¤æ¯å¦æ¿æ´»çæ è¯ --\x3e\n  <activebydefault>false</activebydefault>\n  \x3c!--å½å¹éçjdkè¢«æ£æµå°ï¼profileè¢«æ¿æ´»ãä¾å¦ï¼1.4æ¿æ´»jdk1.4ï¼1.4.0_2ï¼è!1.4æ¿æ´»ææçæ¬ä¸æ¯ä»¥1.4å¼å¤´çjdkã --\x3e\n  <jdk>1.5</jdk>\n  \x3c!--å½å¹éçæä½ç³»ç»å±æ§è¢«æ£æµå°ï¼profileè¢«æ¿æ´»ãosåç´ å¯ä»¥å®ä¹ä¸äºæä½ç³»ç»ç¸å³çå±æ§ã --\x3e\n  <os>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»çåå­ --\x3e\n    <name>windows xp</name>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»æå±å®¶æ(å¦ \'windows\') --\x3e\n    <family>windows</family>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»ä½ç³»ç»æ --\x3e\n    <arch>x86</arch>\n    \x3c!--æ¿æ´»profileçæä½ç³»ç»çæ¬ --\x3e\n    <version>5.1.2600</version>\n  </os>\n  \x3c!--å¦æmavenæ£æµå°æä¸ä¸ªå±æ§ï¼å¶å¼å¯ä»¥å¨pomä¸­éè¿${name}å¼ç¨ï¼ï¼å¶æ¥æå¯¹åºçname = å¼ï¼profileå°±ä¼è¢«æ¿æ´»ãå¦æå¼å­æ®µæ¯ç©ºçï¼é£ä¹å­å¨å±æ§åç§°å­æ®µå°±ä¼æ¿æ´»profileï¼å¦åæåºåå¤§å°åæ¹å¼å¹éå±æ§å¼å­æ®µ --\x3e\n  <property>\n    \x3c!--æ¿æ´»profileçå±æ§çåç§° --\x3e\n    <name>mavenversion</name>\n    \x3c!--æ¿æ´»profileçå±æ§çå¼ --\x3e\n    <value>2.0.3</value>\n  </property>\n  \x3c!--æä¾ä¸ä¸ªæä»¶åï¼éè¿æ£æµè¯¥æä»¶çå­å¨æä¸å­å¨æ¥æ¿æ´»profileãmissingæ£æ¥æä»¶æ¯å¦å­å¨ï¼å¦æä¸å­å¨åæ¿æ´»profileãå¦ä¸æ¹é¢ï¼existsåä¼æ£æ¥æä»¶æ¯å¦å­å¨ï¼å¦æå­å¨åæ¿æ´»profileã --\x3e\n  <file>\n    \x3c!--å¦ææå®çæä»¶å­å¨ï¼åæ¿æ´»profileã --\x3e\n    <exists>${basedir}/file2.properties</exists>\n    \x3c!--å¦ææå®çæä»¶ä¸å­å¨ï¼åæ¿æ´»profileã --\x3e\n    <missing>${basedir}/file1.properties</missing>\n  </file>\n</activation>\n\n\n> æ³¨ï¼å¨ maven å·¥ç¨ç pom.xml æå¨ç®å½ä¸æ§è¡ mvn help:active-profiles å½ä»¤å¯ä»¥æ¥çä¸­å¤®ä»å¨ç profile æ¯å¦å¨å·¥ç¨ä¸­çæã\n\n# properties\n\nä½ç¨ï¼å¯¹åºprofileçæ©å±å±æ§åè¡¨ã\n\nmaven å±æ§å ant ä¸­çå±æ§ä¸æ ·ï¼å¯ä»¥ç¨æ¥å­æ¾ä¸äºå¼ãè¿äºå¼å¯ä»¥å¨ pom.xml ä¸­çä»»ä½å°æ¹ä½¿ç¨æ è®°${x}æ¥ä½¿ç¨ï¼è¿é x æ¯æå±æ§çåç§°ãå±æ§æäºç§ä¸åçå½¢å¼ï¼å¹¶ä¸é½è½å¨ settings.xml æä»¶ä¸­è®¿é®ã\n\n\x3c!--\n  1. env.x: å¨ä¸ä¸ªåéåå ä¸"env."çåç¼ï¼ä¼è¿åä¸ä¸ªshellç¯å¢åéãä¾å¦,"env.path"æä»£äº$pathç¯å¢åéï¼å¨windowsä¸æ¯%path%ï¼ã\n  2. project.xï¼æä»£äºpomä¸­å¯¹åºçåç´ å¼ãä¾å¦: <project><version>1.0</version></project>éè¿${project.version}è·å¾versionçå¼ã\n  3. settings.x: æä»£äºsettings.xmlä¸­å¯¹åºåç´ çå¼ãä¾å¦ï¼<settings><offline>false</offline></settings>éè¿ ${settings.offline}è·å¾offlineçå¼ã\n  4. java system properties: ææå¯éè¿java.lang.system.getproperties()è®¿é®çå±æ§é½è½å¨pomä¸­ä½¿ç¨è¯¥å½¢å¼è®¿é®ï¼ä¾å¦ ${java.home}ã\n  5. x: å¨<properties/>åç´ ä¸­ï¼æèå¤é¨æä»¶ä¸­è®¾ç½®ï¼ä»¥${somevar}çå½¢å¼ä½¿ç¨ã\n --\x3e\n<properties>\n  <user.install>${user.home}/our-project</user.install>\n</properties>\n\n\n> æ³¨ï¼å¦æè¯¥ profile è¢«æ¿æ´»ï¼åå¯ä»¥å¨pom.xmlä¸­ä½¿ç¨${user.install}ã\n\n# repositories\n\nä½ç¨ï¼è¿ç¨ä»åºåè¡¨ï¼å®æ¯ maven ç¨æ¥å¡«åæå»ºç³»ç»æ¬å°ä»åºæä½¿ç¨çä¸ç»è¿ç¨ä»åºã\n\n<repositories>\n  \x3c!--åå«éè¦è¿æ¥å°è¿ç¨ä»åºçä¿¡æ¯ --\x3e\n  <repository>\n    \x3c!--è¿ç¨ä»åºå¯ä¸æ è¯ --\x3e\n    <id>codehaussnapshots</id>\n    \x3c!--è¿ç¨ä»åºåç§° --\x3e\n    <name>codehaus snapshots</name>\n    \x3c!--å¦ä½å¤çè¿ç¨ä»åºéåå¸çæ¬çä¸è½½ --\x3e\n    <releases>\n      \x3c!--trueæèfalseè¡¨ç¤ºè¯¥ä»åºæ¯å¦ä¸ºä¸è½½æç§ç±»åæä»¶ï¼åå¸çï¼å¿«ç§çï¼å¼å¯ã --\x3e\n      <enabled>false</enabled>\n      \x3c!--è¯¥åç´ æå®æ´æ°åççé¢çãmavenä¼æ¯è¾æ¬å°pomåè¿ç¨pomçæ¶é´æ³ãè¿éçéé¡¹æ¯ï¼alwaysï¼ä¸ç´ï¼ï¼dailyï¼é»è®¤ï¼æ¯æ¥ï¼ï¼intervalï¼xï¼è¿éxæ¯ä»¥åéä¸ºåä½çæ¶é´é´éï¼ï¼æèneverï¼ä»ä¸ï¼ã --\x3e\n      <updatepolicy>always</updatepolicy>\n      \x3c!--å½mavenéªè¯æä»¶æ ¡éªæä»¶å¤±è´¥æ¶è¯¥æä¹å-ignoreï¼å¿½ç¥ï¼ï¼failï¼å¤±è´¥ï¼ï¼æèwarnï¼è­¦åï¼ã --\x3e\n      <checksumpolicy>warn</checksumpolicy>\n    </releases>\n    \x3c!--å¦ä½å¤çè¿ç¨ä»åºéå¿«ç§çæ¬çä¸è½½ãæäºreleasesåsnapshotsè¿ä¸¤ç»éç½®ï¼pomå°±å¯ä»¥å¨æ¯ä¸ªåç¬çä»åºä¸­ï¼ä¸ºæ¯ç§ç±»åçæä»¶éåä¸åçç­ç¥ãä¾å¦ï¼å¯è½æäººä¼å³å®åªä¸ºå¼åç®çå¼å¯å¯¹å¿«ç§çæ¬ä¸è½½çæ¯æãåè§repositories/repository/releasesåç´  --\x3e\n    <snapshots>\n      <enabled />\n      <updatepolicy />\n      <checksumpolicy />\n    </snapshots>\n    \x3c!--è¿ç¨ä»åºurlï¼æprotocol://hostname/pathå½¢å¼ --\x3e\n    <url>http://snapshots.maven.codehaus.org/maven2</url>\n    \x3c!--ç¨äºå®ä½åæåºæä»¶çä»åºå¸å±ç±»å-å¯ä»¥æ¯defaultï¼é»è®¤ï¼æèlegacyï¼éçï¼ãmaven 2ä¸ºå¶ä»åºæä¾äºä¸ä¸ªé»è®¤çå¸å±ï¼ç¶èï¼maven 1.xæä¸ç§ä¸åçå¸å±ãæä»¬å¯ä»¥ä½¿ç¨è¯¥åç´ æå®å¸å±æ¯defaultï¼é»è®¤ï¼è¿æ¯legacyï¼éçï¼ã --\x3e\n    <layout>default</layout>\n  </repository>\n</repositories>\n\n\n# pluginrepositories\n\nä½ç¨ï¼åç°æä»¶çè¿ç¨ä»åºåè¡¨ã\n\nå repository ç±»ä¼¼ï¼åªæ¯ repository æ¯ç®¡ç jar åä¾èµçä»åºï¼pluginrepositories åæ¯ç®¡çæä»¶çä»åºã maven æä»¶æ¯ä¸ç§ç¹æ®ç±»åçæä»¶ãç±äºè¿ä¸ªåå ï¼æä»¶ä»åºç¬ç«äºå¶å®ä»åºãpluginrepositories åç´ çç»æå repositories åç´ çç»æç±»ä¼¼ãæ¯ä¸ª pluginrepository åç´ æå®ä¸ä¸ª maven å¯ä»¥ç¨æ¥å¯»æ¾æ°æä»¶çè¿ç¨å°åã\n\n<pluginrepositories>\n  \x3c!-- åå«éè¦è¿æ¥å°è¿ç¨æä»¶ä»åºçä¿¡æ¯.åè§profiles/profile/repositories/repositoryåç´ çè¯´æ --\x3e\n  <pluginrepository>\n    <releases>\n      <enabled />\n      <updatepolicy />\n      <checksumpolicy />\n    </releases>\n    <snapshots>\n      <enabled />\n      <updatepolicy />\n      <checksumpolicy />\n    </snapshots>\n    <id />\n    <name />\n    <url />\n    <layout />\n  </pluginrepository>\n</pluginrepositories>\n\n\n\n# activeprofiles\n\nä½ç¨ï¼æå¨æ¿æ´» profiles çåè¡¨ï¼æç§profileè¢«åºç¨çé¡ºåºå®ä¹activeprofileã\n\nè¯¥åç´ åå«äºä¸ç» activeprofile åç´ ï¼æ¯ä¸ª activeprofile é½å«æä¸ä¸ª profile idãä»»ä½å¨ activeprofile ä¸­å®ä¹ç profile idï¼ä¸è®ºç¯å¢è®¾ç½®å¦ä½ï¼å¶å¯¹åºç profile é½ä¼è¢«æ¿æ´»ãå¦ææ²¡æå¹éç profileï¼åä»ä¹é½ä¸ä¼åçã\n\nä¾å¦ï¼env-test æ¯ä¸ä¸ª activeprofileï¼åå¨ pom.xmlï¼æè profile.xmlï¼ä¸­å¯¹åº id ç profile ä¼è¢«æ¿æ´»ãå¦æè¿è¡è¿ç¨ä¸­æ¾ä¸å°è¿æ ·ä¸ä¸ª profileï¼maven åä¼åå¾å¸¸ä¸æ ·è¿è¡ã\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n  xsi:schemalocation="http://maven.apache.org/settings/1.0.0\n                      https://maven.apache.org/xsd/settings-1.0.0.xsd">\n  ...\n  <activeprofiles>\n    \x3c!-- è¦æ¿æ´»çprofile id --\x3e\n    <activeprofile>env-test</activeprofile>\n  </activeprofiles>\n  ...\n</settings>\n\n\nè³æ­¤ï¼maven settings.xml ä¸­çæ ç­¾é½è®²è§£å®æ¯ï¼å¸æå¯¹å¤§å®¶ææå¸®å©ã\n\n\n# åèèµæ\n\n * maven å®æ¹ææ¡£ä¹ settings',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven å®æé®é¢åæä½³å®è·µ",frontmatter:{title:"Maven å®æé®é¢åæä½³å®è·µ",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],abbrlink:"684ab4a9",date:"2018-11-28T09:29:22.000Z",permalink:"/pages/7908f2/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/04.Maven%E5%AE%9E%E6%88%98%E9%97%AE%E9%A2%98%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/04.Mavenå®æé®é¢åæä½³å®è·µ.md",key:"v-7d156502",path:"/pages/7908f2/",headers:[{level:2,title:"Maven å¸¸è§é®é¢",slug:"maven-å¸¸è§é®é¢",normalizedTitle:"maven å¸¸è§é®é¢",charIndex:22},{level:3,title:"dependencies å dependencyManagementï¼plugins å pluginManagement æä»ä¹åºå«",slug:"dependencies-å-dependencymanagement-plugins-å-pluginmanagement-æä»ä¹åºå«",normalizedTitle:"dependencies å dependencymanagementï¼plugins å pluginmanagement æä»ä¹åºå«",charIndex:37},{level:3,title:"IDEA ä¿®æ¹ JDK çæ¬åç¼è¯æ¥é",slug:"idea-ä¿®æ¹-jdk-çæ¬åç¼è¯æ¥é",normalizedTitle:"idea ä¿®æ¹ jdk çæ¬åç¼è¯æ¥é",charIndex:490},{level:3,title:"éå¤å¼å¥ä¾èµ",slug:"éå¤å¼å¥ä¾èµ",normalizedTitle:"éå¤å¼å¥ä¾èµ",charIndex:975},{level:3,title:"å¦ä½æåä¸ä¸ªå¯ä»¥ç´æ¥è¿è¡ç Spring Boot jar å",slug:"å¦ä½æåä¸ä¸ªå¯ä»¥ç´æ¥è¿è¡ç-spring-boot-jar-å",normalizedTitle:"å¦ä½æåä¸ä¸ªå¯ä»¥ç´æ¥è¿è¡ç spring boot jar å",charIndex:1067},{level:3,title:"å»åªå¿æ¾ maven dependency",slug:"å»åªå¿æ¾-maven-dependency",normalizedTitle:"å»åªå¿æ¾ maven dependency",charIndex:2213},{level:3,title:"å¦ä½æå®ç¼ç ",slug:"å¦ä½æå®ç¼ç ",normalizedTitle:"å¦ä½æå®ç¼ç ",charIndex:2401},{level:3,title:"å¦ä½æå® JDK çæ¬",slug:"å¦ä½æå®-jdk-çæ¬",normalizedTitle:"å¦ä½æå® jdk çæ¬",charIndex:2619},{level:3,title:"å¦ä½é¿åå° dependency æåå°æä»¶ä¸­",slug:"å¦ä½é¿åå°-dependency-æåå°æä»¶ä¸­",normalizedTitle:"å¦ä½é¿åå° dependency æåå°æä»¶ä¸­",charIndex:3234},{level:3,title:"å¦ä½è·³è¿ååæµè¯",slug:"å¦ä½è·³è¿ååæµè¯",normalizedTitle:"å¦ä½è·³è¿ååæµè¯",charIndex:3381},{level:3,title:"å¦ä½å¼å¥æ¬å° jar",slug:"å¦ä½å¼å¥æ¬å°-jar",normalizedTitle:"å¦ä½å¼å¥æ¬å° jar",charIndex:3534},{level:3,title:"å¦ä½æé¤ä¾èµ",slug:"å¦ä½æé¤ä¾èµ",normalizedTitle:"å¦ä½æé¤ä¾èµ",charIndex:3991},{level:2,title:"Maven æä½³å®è·µ",slug:"maven-æä½³å®è·µ",normalizedTitle:"maven æä½³å®è·µ",charIndex:4462},{level:3,title:"éè¿ bom ç»ä¸ç®¡ççæ¬",slug:"éè¿-bom-ç»ä¸ç®¡ççæ¬",normalizedTitle:"éè¿ bom ç»ä¸ç®¡ççæ¬",charIndex:4477}],headersStr:"Maven å¸¸è§é®é¢ dependencies å dependencyManagementï¼plugins å pluginManagement æä»ä¹åºå« IDEA ä¿®æ¹ JDK çæ¬åç¼è¯æ¥é éå¤å¼å¥ä¾èµ å¦ä½æåä¸ä¸ªå¯ä»¥ç´æ¥è¿è¡ç Spring Boot jar å å»åªå¿æ¾ maven dependency å¦ä½æå®ç¼ç  å¦ä½æå® JDK çæ¬ å¦ä½é¿åå° dependency æåå°æä»¶ä¸­ å¦ä½è·³è¿ååæµè¯ å¦ä½å¼å¥æ¬å° jar å¦ä½æé¤ä¾èµ Maven æä½³å®è·µ éè¿ bom ç»ä¸ç®¡ççæ¬",content:'# Maven å®æé®é¢åæä½³å®è·µ\n\n\n# Maven å¸¸è§é®é¢\n\n\n# dependencies å dependencyManagementï¼plugins å pluginManagement æä»ä¹åºå«\n\ndependencyManagement æ¯è¡¨ç¤ºä¾èµ jar åçå£°æï¼å³ä½ å¨é¡¹ç®ä¸­ç dependencyManagement ä¸å£°æäºä¾èµï¼maven ä¸ä¼å è½½è¯¥ä¾èµï¼dependencyManagement å£°æå¯ä»¥è¢«ç»§æ¿ã\n\ndependencyManagement çä¸ä¸ªä½¿ç¨æ¡ä¾æ¯å½æç¶å­é¡¹ç®çæ¶åï¼ç¶é¡¹ç®ä¸­å¯ä»¥å©ç¨ dependencyManagement å£°æå­é¡¹ç®ä¸­éè¦ç¨å°çä¾èµ jar åï¼ä¹åï¼å½æä¸ªæèæå ä¸ªå­é¡¹ç®éè¦å è½½è¯¥æä»¶çæ¶åï¼å°±å¯ä»¥å¨å­é¡¹ç®ä¸­ dependencies èç¹åªéç½® groupId å artifactId å°±å¯ä»¥å®ææä»¶çå¼ç¨ã\n\ndependencyManagement ä¸»è¦æ¯ä¸ºäºç»ä¸ç®¡çæä»¶ï¼ç¡®ä¿ææå­é¡¹ç®ä½¿ç¨çæä»¶çæ¬ä¿æä¸è´ï¼ç±»ä¼¼çè¿æ plugins å pluginManagementã\n\n\n# IDEA ä¿®æ¹ JDK çæ¬åç¼è¯æ¥é\n\néè¯¯ç°è±¡ï¼\n\nä¿®æ¹ JDK çæ¬ï¼æå® maven-compiler-plugin ç source å target ä¸º 1.8 ã\n\nç¶åï¼å¨ Intellij IDEA ä¸­æ§è¡ maven æä»¤ï¼æ¥éï¼\n\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.0:compile (default-compile) on project apollo-common: Fatal error compiling: æ æçç®æ çæ¬ï¼ 1.8 -> [Help 1]\n\n\néè¯¯åå ï¼\n\nmaven ç JDK æºä¸æå®ç JDK ç¼è¯çæ¬ä¸ç¬¦ã\n\næéææ®µï¼\n\n * æ¥ç Project Settings\n\nProject SDK æ¯å¦æ­£ç¡®\n\n\n\nSDK è·¯å¾æ¯å¦æ­£ç¡®\n\n\n\n * æ¥ç Settings > Maven çéç½®\n\nJDK for importer æ¯å¦æ­£ç¡®\n\n\n\nRunner æ¯å¦æ­£ç¡®\n\n\n\n\n# éå¤å¼å¥ä¾èµ\n\nå¨ Idea ä¸­ï¼éä¸­ Moduleï¼ä½¿ç¨ Ctrl+Alt+Shift+Uï¼æå¼ä¾èµå¾ï¼æ£ç´¢æ¯å¦å­å¨éå¤å¼ç¨çæåµãå¦æå­å¨éå¤å¼ç¨ï¼å¯ä»¥å°å¤ä½çå¼ç¨å é¤ã\n\n\n# å¦ä½æåä¸ä¸ªå¯ä»¥ç´æ¥è¿è¡ç Spring Boot jar å\n\nå¯ä»¥ä½¿ç¨ spring-boot-maven-plugin æä»¶\n\n<build>\n  <plugins>\n    <plugin>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-maven-plugin</artifactId>\n      <executions>\n        <execution>\n          <goals>\n            <goal>repackage</goal>\n          </goals>\n        </execution>\n      </executions>\n    </plugin>\n  </plugins>\n</build>\n\n\nå¦æå¼å¥äºç¬¬ä¸æ¹ jar åï¼å¦ä½æåï¼\n\né¦åï¼è¦æ·»å ä¾èµ\n\n<dependency>\n  <groupId>io.github.dunwu</groupId>\n  <artifactId>dunwu-common</artifactId>\n  <version>1.0.0</version>\n  <scope>system</scope>\n  <systemPath>${project.basedir}/src/main/resources/lib/dunwu-common-1.0.0.jar</systemPath>\n</dependency>\n\n\næ¥çï¼éè¦éç½® spring-boot-maven-plugin æä»¶ï¼\n\n<build>\n  <plugins>\n    <plugin>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-maven-plugin</artifactId>\n      <executions>\n        <execution>\n          <goals>\n            <goal>repackage</goal>\n          </goals>\n        </execution>\n      </executions>\n      <configuration>\n        <includeSystemScope>true</includeSystemScope>\n      </configuration>\n    </plugin>\n  </plugins>\n</build>\n\n\n\n# å»åªå¿æ¾ maven dependency\n\né®ï¼åæ¥è§¦ maven çæ°æï¼å¾å¾ä¼æè¿æ ·ççé®ï¼æè¯¥å»åªå¿æ¾ jarï¼\n\nç­ï¼å®æ¹æ¨èçæç´¢ maven dependency ç½åï¼\n\n * https://search.maven.org\n * https://repository.apache.org\n * https://mvnrepository.com\n\n\n# å¦ä½æå®ç¼ç \n\né®ï¼ä¼æå¨ç¥ï¼ä¸åç¼ç æ ¼å¼å¸¸å¸¸ä¼äº§çææ³ä¸å°çè¯¡å¼é®é¢ï¼é£ä¹ maven æå»ºæ¶å¦ä½æå® maven æå»ºæ¶çç¼ç ï¼\n\nç­ï¼å¨ properties ä¸­æå® project.build.sourceEncoding\n\n<properties>\n  <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n</properties>\n\n\n\n# å¦ä½æå® JDK çæ¬\n\né®ï¼å¦ä½æå® maven æå»ºæ¶ç JDK çæ¬\n\nç­ï¼æä¸¤ç§æ¹æ³ï¼\n\nï¼1ï¼properties æ¹å¼\n\n<project>\n  ...\n  <properties>\n    <maven.compiler.source>1.7</maven.compiler.source>\n    <maven.compiler.target>1.7</maven.compiler.target>\n  </properties>\n  ...\n</project>\n\n\nï¼2ï¼ä½¿ç¨ maven-compiler-plugin æä»¶ï¼å¹¶æå® source å target çæ¬\n\n<build>\n...\n  <plugins>\n    <plugin>\n      <groupId>org.apache.maven.plugins</groupId>\n      <artifactId>maven-compiler-plugin</artifactId>\n      <version>3.3</version>\n      <configuration>\n        <source>1.7</source>\n        <target>1.7</target>\n      </configuration>\n    </plugin>\n  </plugins>\n...\n</build>\n\n\n\n# å¦ä½é¿åå° dependency æåå°æä»¶ä¸­\n\nç­ï¼æå® maven dependency ç scope ä¸º providedï¼è¿æå³çï¼ä¾èµå³ç³»å°å¨è¿è¡æ¶ç±å¶å®¹å¨æ JDK æä¾ã å·ææ­¤èå´çä¾èµå³ç³»ä¸ä¼ä¼ éï¼ä¹ä¸ä¼æç»å¨è¯¸å¦ WAR ä¹ç±»çåä¸­ï¼ä¹ä¸ä¼åå«å¨è¿è¡æ¶ç±»è·¯å¾ä¸­ã\n\n\n# å¦ä½è·³è¿ååæµè¯\n\né®ï¼æ§è¡ mvn package æ mvn install æ¶ï¼ä¼èªå¨ç¼è¯ææååæµè¯(src/test/java ç®å½ä¸çä»£ç )ï¼å¦ä½è·³è¿è¿ä¸æ­¥ï¼\n\nç­ï¼å¨æ§è¡å½ä»¤çåé¢ï¼æ·»å å½ä»¤è¡åæ° -Dmaven.test.skip=true æè -DskipTests=true\n\n\n# å¦ä½å¼å¥æ¬å° jar\n\né®ï¼ææ¶åï¼éè¦å¼å¥å¨ä¸­å¤®ä»åºæ¾ä¸å°ç jarï¼ä½åæ³éè¿ maven è¿è¡ç®¡çï¼é£ä¹åºè¯¥å¦ä½åå°å¢ï¼ ç­ï¼å¯ä»¥éè¿è®¾ç½® dependency ç scope ä¸º system æ¥å¼å¥æ¬å° jarã ä¾ï¼\n\n * å°ç§æ jar æ¾ç½®å¨ resouces/lib ä¸ï¼ç¶åä»¥å¦ä¸æ¹å¼æ·»å ä¾èµï¼\n * groupId å artifactId å¯ä»¥æç§ jar åä¸­ç package è®¾ç½®ï¼åªè¦åå¶ä» jar ä¸å²çªå³å¯ã\n\n<dependency>\n    <groupId>xxx</groupId>\n    <artifactId>xxx</artifactId>\n    <version>1.0.0</version>\n    <scope>system</scope>\n    <systemPath>${project.basedir}/src/main/resources/lib/xxx-6.0.0.jar</systemPath>\n</dependency>\n\n\n\n# å¦ä½æé¤ä¾èµ\n\né®ï¼å¦ä½æé¤ä¾èµä¸ä¸ªä¾èµå³ç³»ï¼æ¯æ¹é¡¹ç®ä¸­ä½¿ç¨ç libA ä¾èµæä¸ªåºç 1.0 çãlibB ä»¥æ¥æä¸ªåºç 2.0 çï¼å¦ä»æ³ç»ä¸ä½¿ç¨ 2.0 çï¼ææ ·å»æ 1.0 ççä¾èµï¼\n\nç­ï¼éè¿ exclusion æé¤æå®ä¾èµå³å¯ã\n\nä¾ï¼\n\n<dependency>\n    <groupId>org.apache.zookeeper</groupId>\n    <artifactId>zookeeper</artifactId>\n    <version>3.4.12</version>\n    <optional>true</optional>\n    <exclusions>\n        <exclusion>\n            <groupId>org.slf4j</groupId>\n            <artifactId>slf4j-log4j12</artifactId>\n        </exclusion>\n    </exclusions>\n</dependency>\n\n\n\n# Maven æä½³å®è·µ\n\n\n# éè¿ bom ç»ä¸ç®¡ççæ¬\n\néç¨ç±»ä¼¼ spring-boot-dependencies çæ¹å¼ç»ä¸ç®¡çä¾èµçæ¬ã\n\nspring-boot-dependencies ç pom.xml å½¢å¼ï¼\n\n<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n<modelVersion>4.0.0</modelVersion>\n<groupId>org.springframework.boot</groupId>\n<artifactId>spring-boot-dependencies</artifactId>\n<version>2.1.9.RELEASE</version>\n<packaging>pom</packaging>\n\n\x3c!-- çç¥ --\x3e\n\n\x3c!-- ä¾èµåçæ¬ç®¡ç --\x3e\n<dependencyManagement>\n    <dependencies>\n    \x3c!-- çç¥ --\x3e\n    </dependencies>\n</dependencyManagement>\n\n<build>\n\x3c!-- æä»¶çæ¬ç®¡ç --\x3e\n<pluginManagement>\n    <plugins>\n    \x3c!-- çç¥ --\x3e\n    </plugins>\n</pluginManagement>\n</build>\n</project>\n\n\nå¶ä»é¡¹ç®å¼å¥ spring-boot-dependencies æ¥ç®¡çä¾èµçæ¬çæ¹å¼ï¼\n\n <dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-dependencies</artifactId>\n            <version>${spring-boot.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n',normalizedContent:'# maven å®æé®é¢åæä½³å®è·µ\n\n\n# maven å¸¸è§é®é¢\n\n\n# dependencies å dependencymanagementï¼plugins å pluginmanagement æä»ä¹åºå«\n\ndependencymanagement æ¯è¡¨ç¤ºä¾èµ jar åçå£°æï¼å³ä½ å¨é¡¹ç®ä¸­ç dependencymanagement ä¸å£°æäºä¾èµï¼maven ä¸ä¼å è½½è¯¥ä¾èµï¼dependencymanagement å£°æå¯ä»¥è¢«ç»§æ¿ã\n\ndependencymanagement çä¸ä¸ªä½¿ç¨æ¡ä¾æ¯å½æç¶å­é¡¹ç®çæ¶åï¼ç¶é¡¹ç®ä¸­å¯ä»¥å©ç¨ dependencymanagement å£°æå­é¡¹ç®ä¸­éè¦ç¨å°çä¾èµ jar åï¼ä¹åï¼å½æä¸ªæèæå ä¸ªå­é¡¹ç®éè¦å è½½è¯¥æä»¶çæ¶åï¼å°±å¯ä»¥å¨å­é¡¹ç®ä¸­ dependencies èç¹åªéç½® groupid å artifactid å°±å¯ä»¥å®ææä»¶çå¼ç¨ã\n\ndependencymanagement ä¸»è¦æ¯ä¸ºäºç»ä¸ç®¡çæä»¶ï¼ç¡®ä¿ææå­é¡¹ç®ä½¿ç¨çæä»¶çæ¬ä¿æä¸è´ï¼ç±»ä¼¼çè¿æ plugins å pluginmanagementã\n\n\n# idea ä¿®æ¹ jdk çæ¬åç¼è¯æ¥é\n\néè¯¯ç°è±¡ï¼\n\nä¿®æ¹ jdk çæ¬ï¼æå® maven-compiler-plugin ç source å target ä¸º 1.8 ã\n\nç¶åï¼å¨ intellij idea ä¸­æ§è¡ maven æä»¤ï¼æ¥éï¼\n\n[error] failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.0:compile (default-compile) on project apollo-common: fatal error compiling: æ æçç®æ çæ¬ï¼ 1.8 -> [help 1]\n\n\néè¯¯åå ï¼\n\nmaven ç jdk æºä¸æå®ç jdk ç¼è¯çæ¬ä¸ç¬¦ã\n\næéææ®µï¼\n\n * æ¥ç project settings\n\nproject sdk æ¯å¦æ­£ç¡®\n\n\n\nsdk è·¯å¾æ¯å¦æ­£ç¡®\n\n\n\n * æ¥ç settings > maven çéç½®\n\njdk for importer æ¯å¦æ­£ç¡®\n\n\n\nrunner æ¯å¦æ­£ç¡®\n\n\n\n\n# éå¤å¼å¥ä¾èµ\n\nå¨ idea ä¸­ï¼éä¸­ moduleï¼ä½¿ç¨ ctrl+alt+shift+uï¼æå¼ä¾èµå¾ï¼æ£ç´¢æ¯å¦å­å¨éå¤å¼ç¨çæåµãå¦æå­å¨éå¤å¼ç¨ï¼å¯ä»¥å°å¤ä½çå¼ç¨å é¤ã\n\n\n# å¦ä½æåä¸ä¸ªå¯ä»¥ç´æ¥è¿è¡ç spring boot jar å\n\nå¯ä»¥ä½¿ç¨ spring-boot-maven-plugin æä»¶\n\n<build>\n  <plugins>\n    <plugin>\n      <groupid>org.springframework.boot</groupid>\n      <artifactid>spring-boot-maven-plugin</artifactid>\n      <executions>\n        <execution>\n          <goals>\n            <goal>repackage</goal>\n          </goals>\n        </execution>\n      </executions>\n    </plugin>\n  </plugins>\n</build>\n\n\nå¦æå¼å¥äºç¬¬ä¸æ¹ jar åï¼å¦ä½æåï¼\n\né¦åï¼è¦æ·»å ä¾èµ\n\n<dependency>\n  <groupid>io.github.dunwu</groupid>\n  <artifactid>dunwu-common</artifactid>\n  <version>1.0.0</version>\n  <scope>system</scope>\n  <systempath>${project.basedir}/src/main/resources/lib/dunwu-common-1.0.0.jar</systempath>\n</dependency>\n\n\næ¥çï¼éè¦éç½® spring-boot-maven-plugin æä»¶ï¼\n\n<build>\n  <plugins>\n    <plugin>\n      <groupid>org.springframework.boot</groupid>\n      <artifactid>spring-boot-maven-plugin</artifactid>\n      <executions>\n        <execution>\n          <goals>\n            <goal>repackage</goal>\n          </goals>\n        </execution>\n      </executions>\n      <configuration>\n        <includesystemscope>true</includesystemscope>\n      </configuration>\n    </plugin>\n  </plugins>\n</build>\n\n\n\n# å»åªå¿æ¾ maven dependency\n\né®ï¼åæ¥è§¦ maven çæ°æï¼å¾å¾ä¼æè¿æ ·ççé®ï¼æè¯¥å»åªå¿æ¾ jarï¼\n\nç­ï¼å®æ¹æ¨èçæç´¢ maven dependency ç½åï¼\n\n * https://search.maven.org\n * https://repository.apache.org\n * https://mvnrepository.com\n\n\n# å¦ä½æå®ç¼ç \n\né®ï¼ä¼æå¨ç¥ï¼ä¸åç¼ç æ ¼å¼å¸¸å¸¸ä¼äº§çææ³ä¸å°çè¯¡å¼é®é¢ï¼é£ä¹ maven æå»ºæ¶å¦ä½æå® maven æå»ºæ¶çç¼ç ï¼\n\nç­ï¼å¨ properties ä¸­æå® project.build.sourceencoding\n\n<properties>\n  <project.build.sourceencoding>utf-8</project.build.sourceencoding>\n</properties>\n\n\n\n# å¦ä½æå® jdk çæ¬\n\né®ï¼å¦ä½æå® maven æå»ºæ¶ç jdk çæ¬\n\nç­ï¼æä¸¤ç§æ¹æ³ï¼\n\nï¼1ï¼properties æ¹å¼\n\n<project>\n  ...\n  <properties>\n    <maven.compiler.source>1.7</maven.compiler.source>\n    <maven.compiler.target>1.7</maven.compiler.target>\n  </properties>\n  ...\n</project>\n\n\nï¼2ï¼ä½¿ç¨ maven-compiler-plugin æä»¶ï¼å¹¶æå® source å target çæ¬\n\n<build>\n...\n  <plugins>\n    <plugin>\n      <groupid>org.apache.maven.plugins</groupid>\n      <artifactid>maven-compiler-plugin</artifactid>\n      <version>3.3</version>\n      <configuration>\n        <source>1.7</source>\n        <target>1.7</target>\n      </configuration>\n    </plugin>\n  </plugins>\n...\n</build>\n\n\n\n# å¦ä½é¿åå° dependency æåå°æä»¶ä¸­\n\nç­ï¼æå® maven dependency ç scope ä¸º providedï¼è¿æå³çï¼ä¾èµå³ç³»å°å¨è¿è¡æ¶ç±å¶å®¹å¨æ jdk æä¾ã å·ææ­¤èå´çä¾èµå³ç³»ä¸ä¼ä¼ éï¼ä¹ä¸ä¼æç»å¨è¯¸å¦ war ä¹ç±»çåä¸­ï¼ä¹ä¸ä¼åå«å¨è¿è¡æ¶ç±»è·¯å¾ä¸­ã\n\n\n# å¦ä½è·³è¿ååæµè¯\n\né®ï¼æ§è¡ mvn package æ mvn install æ¶ï¼ä¼èªå¨ç¼è¯ææååæµè¯(src/test/java ç®å½ä¸çä»£ç )ï¼å¦ä½è·³è¿è¿ä¸æ­¥ï¼\n\nç­ï¼å¨æ§è¡å½ä»¤çåé¢ï¼æ·»å å½ä»¤è¡åæ° -dmaven.test.skip=true æè -dskiptests=true\n\n\n# å¦ä½å¼å¥æ¬å° jar\n\né®ï¼ææ¶åï¼éè¦å¼å¥å¨ä¸­å¤®ä»åºæ¾ä¸å°ç jarï¼ä½åæ³éè¿ maven è¿è¡ç®¡çï¼é£ä¹åºè¯¥å¦ä½åå°å¢ï¼ ç­ï¼å¯ä»¥éè¿è®¾ç½® dependency ç scope ä¸º system æ¥å¼å¥æ¬å° jarã ä¾ï¼\n\n * å°ç§æ jar æ¾ç½®å¨ resouces/lib ä¸ï¼ç¶åä»¥å¦ä¸æ¹å¼æ·»å ä¾èµï¼\n * groupid å artifactid å¯ä»¥æç§ jar åä¸­ç package è®¾ç½®ï¼åªè¦åå¶ä» jar ä¸å²çªå³å¯ã\n\n<dependency>\n    <groupid>xxx</groupid>\n    <artifactid>xxx</artifactid>\n    <version>1.0.0</version>\n    <scope>system</scope>\n    <systempath>${project.basedir}/src/main/resources/lib/xxx-6.0.0.jar</systempath>\n</dependency>\n\n\n\n# å¦ä½æé¤ä¾èµ\n\né®ï¼å¦ä½æé¤ä¾èµä¸ä¸ªä¾èµå³ç³»ï¼æ¯æ¹é¡¹ç®ä¸­ä½¿ç¨ç liba ä¾èµæä¸ªåºç 1.0 çãlibb ä»¥æ¥æä¸ªåºç 2.0 çï¼å¦ä»æ³ç»ä¸ä½¿ç¨ 2.0 çï¼ææ ·å»æ 1.0 ççä¾èµï¼\n\nç­ï¼éè¿ exclusion æé¤æå®ä¾èµå³å¯ã\n\nä¾ï¼\n\n<dependency>\n    <groupid>org.apache.zookeeper</groupid>\n    <artifactid>zookeeper</artifactid>\n    <version>3.4.12</version>\n    <optional>true</optional>\n    <exclusions>\n        <exclusion>\n            <groupid>org.slf4j</groupid>\n            <artifactid>slf4j-log4j12</artifactid>\n        </exclusion>\n    </exclusions>\n</dependency>\n\n\n\n# maven æä½³å®è·µ\n\n\n# éè¿ bom ç»ä¸ç®¡ççæ¬\n\néç¨ç±»ä¼¼ spring-boot-dependencies çæ¹å¼ç»ä¸ç®¡çä¾èµçæ¬ã\n\nspring-boot-dependencies ç pom.xml å½¢å¼ï¼\n\n<?xml version="1.0" encoding="utf-8"?>\n<project xmlns="http://maven.apache.org/pom/4.0.0" xsi:schemalocation="http://maven.apache.org/pom/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance">\n<modelversion>4.0.0</modelversion>\n<groupid>org.springframework.boot</groupid>\n<artifactid>spring-boot-dependencies</artifactid>\n<version>2.1.9.release</version>\n<packaging>pom</packaging>\n\n\x3c!-- çç¥ --\x3e\n\n\x3c!-- ä¾èµåçæ¬ç®¡ç --\x3e\n<dependencymanagement>\n    <dependencies>\n    \x3c!-- çç¥ --\x3e\n    </dependencies>\n</dependencymanagement>\n\n<build>\n\x3c!-- æä»¶çæ¬ç®¡ç --\x3e\n<pluginmanagement>\n    <plugins>\n    \x3c!-- çç¥ --\x3e\n    </plugins>\n</pluginmanagement>\n</build>\n</project>\n\n\nå¶ä»é¡¹ç®å¼å¥ spring-boot-dependencies æ¥ç®¡çä¾èµçæ¬çæ¹å¼ï¼\n\n <dependencymanagement>\n    <dependencies>\n        <dependency>\n            <groupid>org.springframework.boot</groupid>\n            <artifactid>spring-boot-dependencies</artifactid>\n            <version>${spring-boot.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencymanagement>\n',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº",frontmatter:{title:"Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],abbrlink:"b88f29ef",date:"2019-05-14T14:57:33.000Z",permalink:"/pages/2ddf04/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/05.Maven%E6%95%99%E7%A8%8B%E4%B9%8B%E5%8F%91%E5%B8%83jar%E5%88%B0%E7%A7%81%E6%9C%8D%E6%88%96%E4%B8%AD%E5%A4%AE%E4%BB%93%E5%BA%93.html",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/05.Mavenæç¨ä¹åå¸jarå°ç§ææä¸­å¤®ä»åº.md",key:"v-ae223d88",path:"/pages/2ddf04/",headers:[{level:2,title:"åå¸ jar åå°ä¸­å¤®ä»åº",slug:"åå¸-jar-åå°ä¸­å¤®ä»åº",normalizedTitle:"åå¸ jar åå°ä¸­å¤®ä»åº",charIndex:31},{level:3,title:"å¨ Sonatype åå»º Issue",slug:"å¨-sonatype-åå»º-issue",normalizedTitle:"å¨ sonatype åå»º issue",charIndex:140},{level:3,title:"ä½¿ç¨ GPG çæå¬ç§é¥å¯¹",slug:"ä½¿ç¨-gpg-çæå¬ç§é¥å¯¹",normalizedTitle:"ä½¿ç¨ gpg çæå¬ç§é¥å¯¹",charIndex:605},{level:3,title:"Maven éç½®",slug:"maven-éç½®",normalizedTitle:"maven éç½®",charIndex:3332},{level:4,title:"settings.xml éç½®",slug:"settings-xml-éç½®",normalizedTitle:"settings.xml éç½®",charIndex:3401},{level:4,title:"pom.xml éç½®",slug:"pom-xml-éç½®",normalizedTitle:"pom.xml éç½®",charIndex:4723},{level:3,title:"é¨ç½²ååå¸",slug:"é¨ç½²ååå¸",normalizedTitle:"é¨ç½²ååå¸",charIndex:7380},{level:2,title:"é¨ç½² maven ç§æ",slug:"é¨ç½²-maven-ç§æ",normalizedTitle:"é¨ç½² maven ç§æ",charIndex:7542},{level:3,title:"ä¸è½½å®è£ Nexus",slug:"ä¸è½½å®è£-nexus",normalizedTitle:"ä¸è½½å®è£ nexus",charIndex:7672},{level:3,title:"å¯å¨åæ­¢ Nexus",slug:"å¯å¨åæ­¢-nexus",normalizedTitle:"å¯å¨åæ­¢ nexus",charIndex:8084},{level:3,title:"ä½¿ç¨ Nexus",slug:"ä½¿ç¨-nexus",normalizedTitle:"ä½¿ç¨ nexus",charIndex:8738},{level:4,title:"éç½® settings.xml",slug:"éç½®-settings-xml",normalizedTitle:"éç½® settings.xml",charIndex:8713},{level:4,title:"éç½® pom.xml",slug:"éç½®-pom-xml",normalizedTitle:"éç½® pom.xml",charIndex:10530},{level:4,title:"æ§è¡ maven æå»º",slug:"æ§è¡-maven-æå»º",normalizedTitle:"æ§è¡ maven æå»º",charIndex:11092},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:11310}],headersStr:"åå¸ jar åå°ä¸­å¤®ä»åº å¨ Sonatype åå»º Issue ä½¿ç¨ GPG çæå¬ç§é¥å¯¹ Maven éç½® settings.xml éç½® pom.xml éç½® é¨ç½²ååå¸ é¨ç½² maven ç§æ ä¸è½½å®è£ Nexus å¯å¨åæ­¢ Nexus ä½¿ç¨ Nexus éç½® settings.xml éç½® pom.xml æ§è¡ maven æå»º åèèµæ",content:'# Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n\n\n# åå¸ jar åå°ä¸­å¤®ä»åº\n\n> ä¸ºäºé¿åéå¤é è½®å­ï¼ç¸ä¿¡æ¯ä¸ª Java ç¨åºåé½æ³æé èªå·±çèææ¶æå·¥å·åï¼èªå·±å®å¶çå¾å¾ææ¯æéåèªå·±çï¼ãé£ä¹å¦ä½å°èªå·±çèææ¶åå¸å°ä¸­å¤®ä»åºå¢ï¼ä¸é¢æä»¬å°ä¸æ­¥æ­¥æ¥å®ç°ã\n\n\n# å¨ Sonatype åå»º Issue\n\nï¼1ï¼æ³¨å Sonatype è´¦å·\n\nåå¸ Java åå° Maven ä¸­å¤®ä»åºï¼é¦åéè¦å¨ Sonatype ç½ç«åå»ºä¸ä¸ªå·¥å(Issues)ã\n\nç¬¬ä¸æ¬¡ä½¿ç¨è¿ä¸ªç½ç«çæ¶åéè¦æ³¨åèªå·±çå¸å·ï¼è¿ä¸ªå¸å·åå¯ç éè¦è®°ä½ï¼åé¢ä¼ç¨å°ï¼ã\n\nï¼2ï¼åå»º Issue\n\næ³¨åè´¦å·æååï¼æ ¹æ®ä½  Java åçåè½åå«åä¸SummaryãDescriptionãGroup IdãSCM urlä»¥åProject URLç­å¿è¦ä¿¡æ¯ï¼å¯ä»¥åè§æä¹ååå»ºç Issueï¼OSSRH-36187ã\n\n\n\nåå»ºå®ä¹åéè¦ç­å¾ Sonatype çå·¥ä½äººåå®¡æ ¸å¤çï¼å®¡æ ¸æ¶é´è¿æ¯å¾å¿«çï¼æçå®¡æ ¸å·®ä¸å¤ç­å¾äºä¸¤å°æ¶ãå½ Issue ç Status åä¸ºRESOLVEDåï¼å°±å¯ä»¥è¿è¡ä¸ä¸æ­¥æä½äºã\n\n> è¯´æï¼å¦æä½ ç Group Id å¡«åçæ¯èªå·±çç½ç«ï¼æçå°±æ¯è¿ç§æåµï¼ï¼Sonatype çå·¥ä½äººåä¼è¯¢é®ä½ é£ä¸ª Group Id æ¯ä¸æ¯ä½ çååï¼ä½ åªéè¦å¨ä¸é¢åç­æ¯å°±è¡ï¼ç¶åå°±ä¼éè¿å®¡æ ¸ã\n\n\n# ä½¿ç¨ GPG çæå¬ç§é¥å¯¹\n\nï¼1ï¼å®è£ Gpg4win\n\nWindows ç³»ç»ï¼å¯ä»¥ä¸è½½ Gpg4win è½¯ä»¶æ¥çæå¯é¥å¯¹ã\n\nGpg4win ä¸è½½å°å\n\nå®è£åï¼æ§è¡å½ä»¤ gpg --version æ£æ¥æ¯å¦å®è£æåã\n\nC:\\Program Files (x86)\\GnuPG\\bin>gpg --version\ngpg (GnuPG) 2.2.10\nlibgcrypt 1.8.3\nCopyright (C) 2018 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the exdunwu permitted by law.\n\nHome: C:/Users/Administrator/AppData/Roaming/gnupg\nSupported algorithms:\nPubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA\nCipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,\n        CAMELLIA128, CAMELLIA192, CAMELLIA256\nHash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224\nCompression: Uncompressed, ZIP, ZLIB, BZIP2\n\n\nï¼2ï¼çæå¯é¥å¯¹\n\næ§è¡å½ä»¤ gpg --gen-key\n\nC:\\Program Files (x86)\\GnuPG\\bin>gpg --gen-key\ngpg (GnuPG) 2.2.10; Copyright (C) 2018 Free Software Foundation, Inc.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the exdunwu permitted by law.\n\nNote: Use "gpg --full-generate-key" for a full featured key generation dialog.\n\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: Zhang Peng\nEmail address: forbreak@163.com\nYou selected this USER-ID:\n    "Zhang Peng <forbreak@163.com>"\n\nChange (N)ame, (E)mail, or (O)kay/(Q)uit? O\n\n\nè¯´æï¼æç§æç¤ºï¼ä¾æ¬¡è¾å¥ç¨æ·åãé®ç®±ã\n\nï¼3ï¼æ¥çå¬é¥\n\nC:\\Program Files (x86)\\GnuPG\\bin>gpg --list-keys\n\ngpg: checking the trustdb\ngpg: marginals needed: 3  completes needed: 1  trust model: pgp\ngpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u\ngpg: next trustdb check due at 2020-11-05\nC:/Users/Administrator/AppData/Roaming/gnupg/pubring.kbx\n--------------------------------------------------------\npub   rsa2048 2018-11-06 [SC] [expires: 2020-11-06]\n      E4CE537A3803D49C35332221A306519BAFF57F60\nuid           [ultimate] forbreak <forbreak@163.com>\nsub   rsa2048 2018-11-06 [E] [expires: 2020-11-06]\n\n\n> è¯´æï¼å¶ä¸­ï¼E4CE537A3803D49C35332221A306519BAFF57F60 å°±æ¯å¬é¥\n\nï¼4ï¼å°å¬é¥åå¸å° PGP å¯é¥æå¡å¨\n\næ§è¡ gpg --keyserver hkp://pool.sks-keyservers.net --send-keys åå¸å¬é¥ï¼\n\nC:\\Program Files (x86)\\GnuPG\\bin>gpg --keyserver hkp://pool.sks-keyservers.net --send-keys E4CE537A3803D49C35332221A306519BAFF57F60\ngpg: sending key A306519BAFF57F60 to hkp://pool.sks-keyservers.net\n\n\n> ð æ³¨æï¼æå¯è½åºç° gpg: keyserver receive failed: No dat éè¯¯ï¼ç­å¤§çº¦ 30 åéååæ§è¡å°±ä¸ä¼æ¥éäºã\n\nï¼5ï¼æ¥çå¬é¥æ¯å¦åå¸æå\n\næ§è¡ gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys æ¥çå¬é¥æ¯å¦åå¸æåã\n\nC:\\Program Files (x86)\\GnuPG\\bin>gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys E4CE537A3803D49C35332221A306519BAFF57F60\ngpg: key A306519BAFF57F60: "forbreak <forbreak@163.com>" not changed\ngpg: Total number processed: 1\ngpg:              unchanged: 1\n\n\n\n# Maven éç½®\n\nå®æäºåä¸¤ä¸ªç« èçåå¤å·¥ä½ï¼å°±å¯ä»¥å° jar åä¸ä¼ å°ä¸­å¤®ä»åºäºãå½ç¶äºï¼æä»¬è¿è¦å¯¹ maven åä¸äºéç½®ã\n\n# settings.xml éç½®\n\nä¸ä»½å®æ´ç settings.xml éç½®ç¤ºä¾å¦ä¸ï¼\n\n<?xml version="1.0" encoding="UTF-8"?>\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">\n\n  <pluginGroups>\n    <pluginGroup>org.sonatype.plugins</pluginGroup>\n  </pluginGroups>\n\n  \x3c!-- ç¨æ·åãå¯ç å°±æ¯ Sonatype è´¦å·ãå¯ç  --\x3e\n  <servers>\n    <server>\n      <id>sonatype-snapshots</id>\n      <username>xxxxxx</username>\n      <password>xxxxxx</password>\n    </server>\n    <server>\n      <id>sonatype-staging</id>\n      <username>xxxxxx</username>\n      <password>xxxxxx</password>\n    </server>\n  </servers>\n\n  \x3c!-- ä½¿ç¨ aliyun maven ä»åºå éä¸è½½ --\x3e\n  <mirrors>\n    <mirror>\n      <id>nexus-aliyun</id>\n      <mirrorOf>*</mirrorOf>\n      <name>Aliyun</name>\n      <url>http://maven.aliyun.com/nexus/groups/public</url>\n    </mirror>\n  </mirrors>\n\n  \x3c!-- gpg çå¯ç ï¼æ³¨æï¼è¿éä¸æ¯æå¬é¥ --\x3e\n  <profiles>\n    <profile>\n      <id>sonatype</id>\n      <properties>\n        <gpg.executable>C:/Program Files (x86)/GnuPG/bin/gpg.exe</gpg.executable>\n        <gpg.passphrase>xxxxxx</gpg.passphrase>\n      </properties>\n    </profile>\n  </profiles>\n\n  <activeProfiles>\n    <activeProfile>sonatype</activeProfile>\n  </activeProfiles>\n</settings>\n\n\n# pom.xml éç½®\n\nï¼1ï¼æ·»å  licensesãscmãdevelopers éç½®ï¼\n\n<licenses>\n  <license>\n    <name>The Apache Software License, Version 2.0</name>\n    <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>\n    <distribution>repo</distribution>\n  </license>\n</licenses>\n\n<developers>\n  <developer>\n    <name>xxxxxx</name>\n    <email>forbreak@163.com</email>\n    <url>https://github.com/dunwu</url>\n  </developer>\n</developers>\n\n<scm>\n  <url>https://github.com/dunwu/dunwu</url>\n  <connection>git@github.com:dunwu/dunwu.git</connection>\n  <developerConnection>https://github.com/dunwu</developerConnection>\n</scm>\n\n\nï¼2ï¼æ·»å  distributionManagement éç½®\n\n<distributionManagement>\n  <snapshotRepository>\n    <id>sonatype-snapshots</id>\n    <url>https://oss.sonatype.org/content/repositories/snapshots</url>\n  </snapshotRepository>\n  <repository>\n    <id>sonatype-staging</id>\n    <url>https://oss.sonatype.org/service/local/staging/deploy/maven2</url>\n  </repository>\n</distributionManagement>\n\n\n> è¯´æï¼<snapshotRepository> æå®çæ¯ snapshot ä»åºå°åï¼<repository> æå®çæ¯ staging ï¼æ­£å¼çï¼ä»åºå°åãéè¦çæçæ¯ï¼è¿éç id éè¦å settings.xml ä¸­ç <server> ç id ä¿æä¸è´ã\n\nï¼3ï¼æ·»å  profiles éç½®\n\n <profiles>\n  <profile>\n    <id>sonatype</id>\n    <build>\n      <plugins>\n        <plugin>\n          <groupId>org.sonatype.plugins</groupId>\n          <artifactId>nexus-staging-maven-plugin</artifactId>\n          <version>1.6.7</version>\n          <extensions>true</extensions>\n          <configuration>\n            <serverId>sonatype-snapshots</serverId>\n            <nexusUrl>https://oss.sonatype.org/</nexusUrl>\n            <autoReleaseAfterClose>true</autoReleaseAfterClose>\n          </configuration>\n        </plugin>\n        <plugin>\n          <groupId>org.apache.maven.plugins</groupId>\n          <artifactId>maven-javadoc-plugin</artifactId>\n          <version>3.0.1</version>\n          <configuration>\n            <failOnError>false</failOnError>\n            <quiet>true</quiet>\n          </configuration>\n          <executions>\n            <execution>\n              <id>attach-javadocs</id>\n              <goals>\n                <goal>jar</goal>\n              </goals>\n            </execution>\n          </executions>\n        </plugin>\n\n        <plugin>\n          <groupId>org.apache.maven.plugins</groupId>\n          <artifactId>maven-gpg-plugin</artifactId>\n          <version>1.6</version>\n          <executions>\n            <execution>\n              <id>sign-artifacts</id>\n              <phase>verify</phase>\n              <goals>\n                <goal>sign</goal>\n              </goals>\n            </execution>\n          </executions>\n        </plugin>\n      </plugins>\n    </build>\n  </profile>\n</profiles>\n\n\n\n# é¨ç½²ååå¸\n\næç§ä¸é¢çæ­¥éª¤éç½®å®åï¼ä¸åé½å·²ç» OKã\n\næ­¤æ¶ï¼ä½¿ç¨ mvn clean deploy -P sonatype å½ä»¤å°±å¯ä»¥åå¸ jar åå°ä¸­å¤®ä»åºäºï¼\n\n> è¯´æï¼-P åæ°åé¢ç sonatype éè¦å pom.xml ä¸­ <profile> ç id ä¿æä¸è´ï¼æè½æ¿æ´» profileã\n\n\n# é¨ç½² maven ç§æ\n\n> å·¥ä½ä¸­ï¼Java ç¨åºåå¼åçåç¨ Java é¡¹ç®ï¼ä¸è¬ä¸æ³åå¸å°ä¸­å¤®ä»åºï¼ä½¿å¾äººäººå°½ç¥ãè¿æ¶ï¼æä»¬å°±éè¦æ­å»ºç§æï¼å° maven æå¡å¨é¨ç½²å¨å¬å¸åé¨ç½ç»ï¼ä»èé¿å jar åæµä¼ åºå»ãæä¹åå¢ï¼è®©æä»¬æ¥ä¸æ­¥æ­¥å­¦ä¹ å§ã\n\n\n# ä¸è½½å®è£ Nexus\n\nè¿å¥å®æ¹ä¸è½½å°åï¼éæ©åéçæ¬ä¸è½½ã\n\n\n\næ¬äººå¸æå° Nexus é¨ç½²å¨ Linux æºå¨ï¼æä»¥éç¨çæ¯ Unix çæ¬ã\n\nè¿éï¼å¦ææ³éè¿å½ä»¤æ¹å¼ç´æ¥ä¸è½½ï¼æ¯å¦ç¨èæ¬å®è£ï¼ï¼å¯ä»¥å¨å®æ¹åå²åå¸çæ¬é¡µé¢ä¸­æ¾å°åéçæ¬ï¼ç¶åæ§è¡ä»¥ä¸å½ä»¤ï¼\n\nwget -O /opt/maven/nexus-unix.tar.gz http://download.sonatype.com/nexus/3/nexus-3.13.0-01-unix.tar.gz\ntar -zxf nexus-unix.tar.gz\n\n\nè§£ååï¼æä¸¤ä¸ªç®å½ï¼\n\n * nexus-3.13.0-01 - åå«äº Nexus è¿è¡æéè¦çæä»¶ãæ¯ Nexus è¿è¡å¿é¡»çã\n * sonatype-work - åå«äº Nexus çæçéç½®æä»¶ãæ¥å¿æä»¶ãä»åºæä»¶ç­ãå½æä»¬éè¦å¤ä»½ Nexus çæ¶åé»è®¤å¤ä»½æ­¤ç®å½å³å¯ã\n\n\n# å¯å¨åæ­¢ Nexus\n\nè¿å¥ nexus-3.13.0-01/bin ç®å½ï¼æä¸ä¸ªå¯æ§è¡èæ¬ nexusã\n\næ§è¡ ./nexusï¼å¯ä»¥æ¥çåè®¸æ§è¡çåæ°ï¼å¦ä¸æç¤ºï¼å«ä¹å¯è°ä¸ç®äºç¶ï¼\n\n$ ./nexus\nUsage: ./nexus {start|stop|run|run-redirect|status|restart|force-reload}\n\n\n * å¯å¨ nexus - ./nexus start\n * åæ­¢ nexus -\n\nå¯å¨æååï¼å¨æµè§å¨ä¸­è®¿é® http://<ip>:8081ï¼æ¬¢è¿é¡µé¢å¦ä¸å¾æç¤ºï¼\n\n\n\nç¹å»å³ä¸è§ Sign in ç»å½ï¼é»è®¤ç¨æ·å/å¯ç ä¸ºï¼admin/admin123ã\n\næå¿è¦æä¸ä¸çæ¯ï¼å¨ Nexus ç Repositories ç®¡çé¡µé¢ï¼å±ç¤ºäºå¯ç¨ç maven ä»åºï¼å¦ä¸å¾æç¤ºï¼\n\n\n\n> è¯´æï¼\n> \n>  * maven-central - maven ä¸­å¤®åºï¼å¦ææ²¡æéç½® mirrorï¼é»è®¤å°±ä»è¿éä¸è½½ jar åï¼ï¼ä» https://repo1.maven.org/maven2/ è·åèµæº\n>  * maven-releases - å­å¨ç§æä»åºçåè¡ç jar å\n>  * maven-snapshots - å­å¨ç§æä»åºçå¿«ç§çï¼è°è¯çæ¬ï¼ jar å\n>  * maven-public - ç§æä»åºçå¬å±ç©ºé´ï¼æä¸é¢ä¸ä¸ªä»åºç»åå¨ä¸èµ·å¯¹å¤æä¾æå¡ï¼å¨æ¬å° maven åºç¡éç½® settings.xml ä¸­ä½¿ç¨ã\n\n\n# ä½¿ç¨ Nexus\n\nå¦æè¦ä½¿ç¨ Nexusï¼è¿å¿é¡»å¨ settings.xml å pom.xml ä¸­éç½®è®¤è¯ä¿¡æ¯ã\n\n# éç½® settings.xml\n\nä¸ä»½å®æ´ç settings.xmlï¼\n\n<?xml version="1.0" encoding="UTF-8"?>\n\n<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">\n  <pluginGroups>\n    <pluginGroup>org.sonatype.plugins</pluginGroup>\n  </pluginGroups>\n\n  \x3c!-- Maven ç§æè´¦å·ä¿¡æ¯ --\x3e\n  <servers>\n    <server>\n      <id>releases</id>\n      <username>admin</username>\n      <password>admin123</password>\n    </server>\n    <server>\n      <id>snapshots</id>\n      <username>admin</username>\n      <password>admin123</password>\n    </server>\n  </servers>\n\n  \x3c!-- jar åä¸è½½å°å --\x3e\n  <mirrors>\n    <mirror>\n      <id>public</id>\n      <mirrorOf>*</mirrorOf>\n      <url>http://10.255.255.224:8081/repository/maven-public/</url>\n    </mirror>\n  </mirrors>\n\n  <profiles>\n    <profile>\n      <id>zp</id>\n      <repositories>\n        <repository>\n          <id>central</id>\n          <url>http://central</url>\n          <releases>\n            <enabled>true</enabled>\n          </releases>\n          <snapshots>\n            <enabled>true</enabled>\n          </snapshots>\n        </repository>\n      </repositories>\n      <pluginRepositories>\n        <pluginRepository>\n          <id>central</id>\n          <url>http://central</url>\n          <releases>\n            <enabled>true</enabled>\n          </releases>\n          <snapshots>\n            <enabled>true</enabled>\n            <updatePolicy>always</updatePolicy>\n          </snapshots>\n        </pluginRepository>\n      </pluginRepositories>\n    </profile>\n  </profiles>\n\n  <activeProfiles>\n    <activeProfile>zp</activeProfile>\n  </activeProfiles>\n</settings>\n\n\n# éç½® pom.xml\n\nå¨ pom.xml ä¸­æ·»å å¦ä¸éç½®ï¼\n\n  <distributionManagement>\n    <repository>\n      <id>releases</id>\n      <name>Releases</name>\n      <url>http://10.255.255.224:8081/repository/maven-releases</url>\n    </repository>\n    <snapshotRepository>\n      <id>snapshots</id>\n      <name>Snapshot</name>\n      <url>http://10.255.255.224:8081/repository/maven-snapshots</url>\n    </snapshotRepository>\n  </distributionManagement>\n\n\n> ð æ³¨æï¼\n> \n>  * <repository> å <snapshotRepository> ç id å¿é¡»å settings.xml éç½®æä»¶ä¸­ç <server> æ ç­¾ä¸­ç id å¹éã\n>  * <url> æ ç­¾çå°åéè¦å maven ç§æçå°åå¹éã\n\n# æ§è¡ maven æå»º\n\nå¦æè¦ä½¿ç¨ settings.xml ä¸­çç§æéç½®ï¼å¿é¡»éè¿æå® -P zp æ¥æ¿æ´» profileã\n\nç¤ºä¾ï¼\n\n## ç¼è¯å¹¶æå maven é¡¹ç®\n$ mvn clean package -Dmaven.skip.test=true -P zp\n\n## ç¼è¯å¹¶ä¸ä¼  maven äº¤ä»ä»¶ï¼jar åï¼\n$ mvn clean deploy -Dmaven.skip.test=true -P zp\n\n\n\n# åèèµæ\n\n * https://www.jianshu.com/p/8c3d7fb09bce\n * http://www.ruanyifeng.com/blog/2013/07/gpg.html\n * https://www.cnblogs.com/hoobey/p/6102382.html\n * https://blog.csdn.net/wzygis/article/details/49276779\n * https://blog.csdn.net/clj198606061111/article/details/52200928',normalizedContent:'# maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n\n\n# åå¸ jar åå°ä¸­å¤®ä»åº\n\n> ä¸ºäºé¿åéå¤é è½®å­ï¼ç¸ä¿¡æ¯ä¸ª java ç¨åºåé½æ³æé èªå·±çèææ¶æå·¥å·åï¼èªå·±å®å¶çå¾å¾ææ¯æéåèªå·±çï¼ãé£ä¹å¦ä½å°èªå·±çèææ¶åå¸å°ä¸­å¤®ä»åºå¢ï¼ä¸é¢æä»¬å°ä¸æ­¥æ­¥æ¥å®ç°ã\n\n\n# å¨ sonatype åå»º issue\n\nï¼1ï¼æ³¨å sonatype è´¦å·\n\nåå¸ java åå° maven ä¸­å¤®ä»åºï¼é¦åéè¦å¨ sonatype ç½ç«åå»ºä¸ä¸ªå·¥å(issues)ã\n\nç¬¬ä¸æ¬¡ä½¿ç¨è¿ä¸ªç½ç«çæ¶åéè¦æ³¨åèªå·±çå¸å·ï¼è¿ä¸ªå¸å·åå¯ç éè¦è®°ä½ï¼åé¢ä¼ç¨å°ï¼ã\n\nï¼2ï¼åå»º issue\n\næ³¨åè´¦å·æååï¼æ ¹æ®ä½  java åçåè½åå«åä¸summaryãdescriptionãgroup idãscm urlä»¥åproject urlç­å¿è¦ä¿¡æ¯ï¼å¯ä»¥åè§æä¹ååå»ºç issueï¼ossrh-36187ã\n\n\n\nåå»ºå®ä¹åéè¦ç­å¾ sonatype çå·¥ä½äººåå®¡æ ¸å¤çï¼å®¡æ ¸æ¶é´è¿æ¯å¾å¿«çï¼æçå®¡æ ¸å·®ä¸å¤ç­å¾äºä¸¤å°æ¶ãå½ issue ç status åä¸ºresolvedåï¼å°±å¯ä»¥è¿è¡ä¸ä¸æ­¥æä½äºã\n\n> è¯´æï¼å¦æä½ ç group id å¡«åçæ¯èªå·±çç½ç«ï¼æçå°±æ¯è¿ç§æåµï¼ï¼sonatype çå·¥ä½äººåä¼è¯¢é®ä½ é£ä¸ª group id æ¯ä¸æ¯ä½ çååï¼ä½ åªéè¦å¨ä¸é¢åç­æ¯å°±è¡ï¼ç¶åå°±ä¼éè¿å®¡æ ¸ã\n\n\n# ä½¿ç¨ gpg çæå¬ç§é¥å¯¹\n\nï¼1ï¼å®è£ gpg4win\n\nwindows ç³»ç»ï¼å¯ä»¥ä¸è½½ gpg4win è½¯ä»¶æ¥çæå¯é¥å¯¹ã\n\ngpg4win ä¸è½½å°å\n\nå®è£åï¼æ§è¡å½ä»¤ gpg --version æ£æ¥æ¯å¦å®è£æåã\n\nc:\\program files (x86)\\gnupg\\bin>gpg --version\ngpg (gnupg) 2.2.10\nlibgcrypt 1.8.3\ncopyright (c) 2018 free software foundation, inc.\nlicense gplv3+: gnu gpl version 3 or later <https://gnu.org/licenses/gpl.html>\nthis is free software: you are free to change and redistribute it.\nthere is no warranty, to the exdunwu permitted by law.\n\nhome: c:/users/administrator/appdata/roaming/gnupg\nsupported algorithms:\npubkey: rsa, elg, dsa, ecdh, ecdsa, eddsa\ncipher: idea, 3des, cast5, blowfish, aes, aes192, aes256, twofish,\n        camellia128, camellia192, camellia256\nhash: sha1, ripemd160, sha256, sha384, sha512, sha224\ncompression: uncompressed, zip, zlib, bzip2\n\n\nï¼2ï¼çæå¯é¥å¯¹\n\næ§è¡å½ä»¤ gpg --gen-key\n\nc:\\program files (x86)\\gnupg\\bin>gpg --gen-key\ngpg (gnupg) 2.2.10; copyright (c) 2018 free software foundation, inc.\nthis is free software: you are free to change and redistribute it.\nthere is no warranty, to the exdunwu permitted by law.\n\nnote: use "gpg --full-generate-key" for a full featured key generation dialog.\n\ngnupg needs to construct a user id to identify your key.\n\nreal name: zhang peng\nemail address: forbreak@163.com\nyou selected this user-id:\n    "zhang peng <forbreak@163.com>"\n\nchange (n)ame, (e)mail, or (o)kay/(q)uit? o\n\n\nè¯´æï¼æç§æç¤ºï¼ä¾æ¬¡è¾å¥ç¨æ·åãé®ç®±ã\n\nï¼3ï¼æ¥çå¬é¥\n\nc:\\program files (x86)\\gnupg\\bin>gpg --list-keys\n\ngpg: checking the trustdb\ngpg: marginals needed: 3  completes needed: 1  trust model: pgp\ngpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u\ngpg: next trustdb check due at 2020-11-05\nc:/users/administrator/appdata/roaming/gnupg/pubring.kbx\n--------------------------------------------------------\npub   rsa2048 2018-11-06 [sc] [expires: 2020-11-06]\n      e4ce537a3803d49c35332221a306519baff57f60\nuid           [ultimate] forbreak <forbreak@163.com>\nsub   rsa2048 2018-11-06 [e] [expires: 2020-11-06]\n\n\n> è¯´æï¼å¶ä¸­ï¼e4ce537a3803d49c35332221a306519baff57f60 å°±æ¯å¬é¥\n\nï¼4ï¼å°å¬é¥åå¸å° pgp å¯é¥æå¡å¨\n\næ§è¡ gpg --keyserver hkp://pool.sks-keyservers.net --send-keys åå¸å¬é¥ï¼\n\nc:\\program files (x86)\\gnupg\\bin>gpg --keyserver hkp://pool.sks-keyservers.net --send-keys e4ce537a3803d49c35332221a306519baff57f60\ngpg: sending key a306519baff57f60 to hkp://pool.sks-keyservers.net\n\n\n> ð æ³¨æï¼æå¯è½åºç° gpg: keyserver receive failed: no dat éè¯¯ï¼ç­å¤§çº¦ 30 åéååæ§è¡å°±ä¸ä¼æ¥éäºã\n\nï¼5ï¼æ¥çå¬é¥æ¯å¦åå¸æå\n\næ§è¡ gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys æ¥çå¬é¥æ¯å¦åå¸æåã\n\nc:\\program files (x86)\\gnupg\\bin>gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys e4ce537a3803d49c35332221a306519baff57f60\ngpg: key a306519baff57f60: "forbreak <forbreak@163.com>" not changed\ngpg: total number processed: 1\ngpg:              unchanged: 1\n\n\n\n# maven éç½®\n\nå®æäºåä¸¤ä¸ªç« èçåå¤å·¥ä½ï¼å°±å¯ä»¥å° jar åä¸ä¼ å°ä¸­å¤®ä»åºäºãå½ç¶äºï¼æä»¬è¿è¦å¯¹ maven åä¸äºéç½®ã\n\n# settings.xml éç½®\n\nä¸ä»½å®æ´ç settings.xml éç½®ç¤ºä¾å¦ä¸ï¼\n\n<?xml version="1.0" encoding="utf-8"?>\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance" xsi:schemalocation="http://maven.apache.org/settings/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">\n\n  <plugingroups>\n    <plugingroup>org.sonatype.plugins</plugingroup>\n  </plugingroups>\n\n  \x3c!-- ç¨æ·åãå¯ç å°±æ¯ sonatype è´¦å·ãå¯ç  --\x3e\n  <servers>\n    <server>\n      <id>sonatype-snapshots</id>\n      <username>xxxxxx</username>\n      <password>xxxxxx</password>\n    </server>\n    <server>\n      <id>sonatype-staging</id>\n      <username>xxxxxx</username>\n      <password>xxxxxx</password>\n    </server>\n  </servers>\n\n  \x3c!-- ä½¿ç¨ aliyun maven ä»åºå éä¸è½½ --\x3e\n  <mirrors>\n    <mirror>\n      <id>nexus-aliyun</id>\n      <mirrorof>*</mirrorof>\n      <name>aliyun</name>\n      <url>http://maven.aliyun.com/nexus/groups/public</url>\n    </mirror>\n  </mirrors>\n\n  \x3c!-- gpg çå¯ç ï¼æ³¨æï¼è¿éä¸æ¯æå¬é¥ --\x3e\n  <profiles>\n    <profile>\n      <id>sonatype</id>\n      <properties>\n        <gpg.executable>c:/program files (x86)/gnupg/bin/gpg.exe</gpg.executable>\n        <gpg.passphrase>xxxxxx</gpg.passphrase>\n      </properties>\n    </profile>\n  </profiles>\n\n  <activeprofiles>\n    <activeprofile>sonatype</activeprofile>\n  </activeprofiles>\n</settings>\n\n\n# pom.xml éç½®\n\nï¼1ï¼æ·»å  licensesãscmãdevelopers éç½®ï¼\n\n<licenses>\n  <license>\n    <name>the apache software license, version 2.0</name>\n    <url>http://www.apache.org/licenses/license-2.0.txt</url>\n    <distribution>repo</distribution>\n  </license>\n</licenses>\n\n<developers>\n  <developer>\n    <name>xxxxxx</name>\n    <email>forbreak@163.com</email>\n    <url>https://github.com/dunwu</url>\n  </developer>\n</developers>\n\n<scm>\n  <url>https://github.com/dunwu/dunwu</url>\n  <connection>git@github.com:dunwu/dunwu.git</connection>\n  <developerconnection>https://github.com/dunwu</developerconnection>\n</scm>\n\n\nï¼2ï¼æ·»å  distributionmanagement éç½®\n\n<distributionmanagement>\n  <snapshotrepository>\n    <id>sonatype-snapshots</id>\n    <url>https://oss.sonatype.org/content/repositories/snapshots</url>\n  </snapshotrepository>\n  <repository>\n    <id>sonatype-staging</id>\n    <url>https://oss.sonatype.org/service/local/staging/deploy/maven2</url>\n  </repository>\n</distributionmanagement>\n\n\n> è¯´æï¼<snapshotrepository> æå®çæ¯ snapshot ä»åºå°åï¼<repository> æå®çæ¯ staging ï¼æ­£å¼çï¼ä»åºå°åãéè¦çæçæ¯ï¼è¿éç id éè¦å settings.xml ä¸­ç <server> ç id ä¿æä¸è´ã\n\nï¼3ï¼æ·»å  profiles éç½®\n\n <profiles>\n  <profile>\n    <id>sonatype</id>\n    <build>\n      <plugins>\n        <plugin>\n          <groupid>org.sonatype.plugins</groupid>\n          <artifactid>nexus-staging-maven-plugin</artifactid>\n          <version>1.6.7</version>\n          <extensions>true</extensions>\n          <configuration>\n            <serverid>sonatype-snapshots</serverid>\n            <nexusurl>https://oss.sonatype.org/</nexusurl>\n            <autoreleaseafterclose>true</autoreleaseafterclose>\n          </configuration>\n        </plugin>\n        <plugin>\n          <groupid>org.apache.maven.plugins</groupid>\n          <artifactid>maven-javadoc-plugin</artifactid>\n          <version>3.0.1</version>\n          <configuration>\n            <failonerror>false</failonerror>\n            <quiet>true</quiet>\n          </configuration>\n          <executions>\n            <execution>\n              <id>attach-javadocs</id>\n              <goals>\n                <goal>jar</goal>\n              </goals>\n            </execution>\n          </executions>\n        </plugin>\n\n        <plugin>\n          <groupid>org.apache.maven.plugins</groupid>\n          <artifactid>maven-gpg-plugin</artifactid>\n          <version>1.6</version>\n          <executions>\n            <execution>\n              <id>sign-artifacts</id>\n              <phase>verify</phase>\n              <goals>\n                <goal>sign</goal>\n              </goals>\n            </execution>\n          </executions>\n        </plugin>\n      </plugins>\n    </build>\n  </profile>\n</profiles>\n\n\n\n# é¨ç½²ååå¸\n\næç§ä¸é¢çæ­¥éª¤éç½®å®åï¼ä¸åé½å·²ç» okã\n\næ­¤æ¶ï¼ä½¿ç¨ mvn clean deploy -p sonatype å½ä»¤å°±å¯ä»¥åå¸ jar åå°ä¸­å¤®ä»åºäºï¼\n\n> è¯´æï¼-p åæ°åé¢ç sonatype éè¦å pom.xml ä¸­ <profile> ç id ä¿æä¸è´ï¼æè½æ¿æ´» profileã\n\n\n# é¨ç½² maven ç§æ\n\n> å·¥ä½ä¸­ï¼java ç¨åºåå¼åçåç¨ java é¡¹ç®ï¼ä¸è¬ä¸æ³åå¸å°ä¸­å¤®ä»åºï¼ä½¿å¾äººäººå°½ç¥ãè¿æ¶ï¼æä»¬å°±éè¦æ­å»ºç§æï¼å° maven æå¡å¨é¨ç½²å¨å¬å¸åé¨ç½ç»ï¼ä»èé¿å jar åæµä¼ åºå»ãæä¹åå¢ï¼è®©æä»¬æ¥ä¸æ­¥æ­¥å­¦ä¹ å§ã\n\n\n# ä¸è½½å®è£ nexus\n\nè¿å¥å®æ¹ä¸è½½å°åï¼éæ©åéçæ¬ä¸è½½ã\n\n\n\næ¬äººå¸æå° nexus é¨ç½²å¨ linux æºå¨ï¼æä»¥éç¨çæ¯ unix çæ¬ã\n\nè¿éï¼å¦ææ³éè¿å½ä»¤æ¹å¼ç´æ¥ä¸è½½ï¼æ¯å¦ç¨èæ¬å®è£ï¼ï¼å¯ä»¥å¨å®æ¹åå²åå¸çæ¬é¡µé¢ä¸­æ¾å°åéçæ¬ï¼ç¶åæ§è¡ä»¥ä¸å½ä»¤ï¼\n\nwget -o /opt/maven/nexus-unix.tar.gz http://download.sonatype.com/nexus/3/nexus-3.13.0-01-unix.tar.gz\ntar -zxf nexus-unix.tar.gz\n\n\nè§£ååï¼æä¸¤ä¸ªç®å½ï¼\n\n * nexus-3.13.0-01 - åå«äº nexus è¿è¡æéè¦çæä»¶ãæ¯ nexus è¿è¡å¿é¡»çã\n * sonatype-work - åå«äº nexus çæçéç½®æä»¶ãæ¥å¿æä»¶ãä»åºæä»¶ç­ãå½æä»¬éè¦å¤ä»½ nexus çæ¶åé»è®¤å¤ä»½æ­¤ç®å½å³å¯ã\n\n\n# å¯å¨åæ­¢ nexus\n\nè¿å¥ nexus-3.13.0-01/bin ç®å½ï¼æä¸ä¸ªå¯æ§è¡èæ¬ nexusã\n\næ§è¡ ./nexusï¼å¯ä»¥æ¥çåè®¸æ§è¡çåæ°ï¼å¦ä¸æç¤ºï¼å«ä¹å¯è°ä¸ç®äºç¶ï¼\n\n$ ./nexus\nusage: ./nexus {start|stop|run|run-redirect|status|restart|force-reload}\n\n\n * å¯å¨ nexus - ./nexus start\n * åæ­¢ nexus -\n\nå¯å¨æååï¼å¨æµè§å¨ä¸­è®¿é® http://<ip>:8081ï¼æ¬¢è¿é¡µé¢å¦ä¸å¾æç¤ºï¼\n\n\n\nç¹å»å³ä¸è§ sign in ç»å½ï¼é»è®¤ç¨æ·å/å¯ç ä¸ºï¼admin/admin123ã\n\næå¿è¦æä¸ä¸çæ¯ï¼å¨ nexus ç repositories ç®¡çé¡µé¢ï¼å±ç¤ºäºå¯ç¨ç maven ä»åºï¼å¦ä¸å¾æç¤ºï¼\n\n\n\n> è¯´æï¼\n> \n>  * maven-central - maven ä¸­å¤®åºï¼å¦ææ²¡æéç½® mirrorï¼é»è®¤å°±ä»è¿éä¸è½½ jar åï¼ï¼ä» https://repo1.maven.org/maven2/ è·åèµæº\n>  * maven-releases - å­å¨ç§æä»åºçåè¡ç jar å\n>  * maven-snapshots - å­å¨ç§æä»åºçå¿«ç§çï¼è°è¯çæ¬ï¼ jar å\n>  * maven-public - ç§æä»åºçå¬å±ç©ºé´ï¼æä¸é¢ä¸ä¸ªä»åºç»åå¨ä¸èµ·å¯¹å¤æä¾æå¡ï¼å¨æ¬å° maven åºç¡éç½® settings.xml ä¸­ä½¿ç¨ã\n\n\n# ä½¿ç¨ nexus\n\nå¦æè¦ä½¿ç¨ nexusï¼è¿å¿é¡»å¨ settings.xml å pom.xml ä¸­éç½®è®¤è¯ä¿¡æ¯ã\n\n# éç½® settings.xml\n\nä¸ä»½å®æ´ç settings.xmlï¼\n\n<?xml version="1.0" encoding="utf-8"?>\n\n<settings xmlns="http://maven.apache.org/settings/1.0.0"\n  xmlns:xsi="http://www.w3.org/2001/xmlschema-instance" xsi:schemalocation="http://maven.apache.org/settings/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">\n  <plugingroups>\n    <plugingroup>org.sonatype.plugins</plugingroup>\n  </plugingroups>\n\n  \x3c!-- maven ç§æè´¦å·ä¿¡æ¯ --\x3e\n  <servers>\n    <server>\n      <id>releases</id>\n      <username>admin</username>\n      <password>admin123</password>\n    </server>\n    <server>\n      <id>snapshots</id>\n      <username>admin</username>\n      <password>admin123</password>\n    </server>\n  </servers>\n\n  \x3c!-- jar åä¸è½½å°å --\x3e\n  <mirrors>\n    <mirror>\n      <id>public</id>\n      <mirrorof>*</mirrorof>\n      <url>http://10.255.255.224:8081/repository/maven-public/</url>\n    </mirror>\n  </mirrors>\n\n  <profiles>\n    <profile>\n      <id>zp</id>\n      <repositories>\n        <repository>\n          <id>central</id>\n          <url>http://central</url>\n          <releases>\n            <enabled>true</enabled>\n          </releases>\n          <snapshots>\n            <enabled>true</enabled>\n          </snapshots>\n        </repository>\n      </repositories>\n      <pluginrepositories>\n        <pluginrepository>\n          <id>central</id>\n          <url>http://central</url>\n          <releases>\n            <enabled>true</enabled>\n          </releases>\n          <snapshots>\n            <enabled>true</enabled>\n            <updatepolicy>always</updatepolicy>\n          </snapshots>\n        </pluginrepository>\n      </pluginrepositories>\n    </profile>\n  </profiles>\n\n  <activeprofiles>\n    <activeprofile>zp</activeprofile>\n  </activeprofiles>\n</settings>\n\n\n# éç½® pom.xml\n\nå¨ pom.xml ä¸­æ·»å å¦ä¸éç½®ï¼\n\n  <distributionmanagement>\n    <repository>\n      <id>releases</id>\n      <name>releases</name>\n      <url>http://10.255.255.224:8081/repository/maven-releases</url>\n    </repository>\n    <snapshotrepository>\n      <id>snapshots</id>\n      <name>snapshot</name>\n      <url>http://10.255.255.224:8081/repository/maven-snapshots</url>\n    </snapshotrepository>\n  </distributionmanagement>\n\n\n> ð æ³¨æï¼\n> \n>  * <repository> å <snapshotrepository> ç id å¿é¡»å settings.xml éç½®æä»¶ä¸­ç <server> æ ç­¾ä¸­ç id å¹éã\n>  * <url> æ ç­¾çå°åéè¦å maven ç§æçå°åå¹éã\n\n# æ§è¡ maven æå»º\n\nå¦æè¦ä½¿ç¨ settings.xml ä¸­çç§æéç½®ï¼å¿é¡»éè¿æå® -p zp æ¥æ¿æ´» profileã\n\nç¤ºä¾ï¼\n\n## ç¼è¯å¹¶æå maven é¡¹ç®\n$ mvn clean package -dmaven.skip.test=true -p zp\n\n## ç¼è¯å¹¶ä¸ä¼  maven äº¤ä»ä»¶ï¼jar åï¼\n$ mvn clean deploy -dmaven.skip.test=true -p zp\n\n\n\n# åèèµæ\n\n * https://www.jianshu.com/p/8c3d7fb09bce\n * http://www.ruanyifeng.com/blog/2013/07/gpg.html\n * https://www.cnblogs.com/hoobey/p/6102382.html\n * https://blog.csdn.net/wzygis/article/details/49276779\n * https://blog.csdn.net/clj198606061111/article/details/52200928',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven æä»¶ä¹ä»£ç æ£æ¥",frontmatter:{title:"Maven æä»¶ä¹ä»£ç æ£æ¥",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],abbrlink:"7b76d24a",date:"2019-12-16T17:09:26.000Z",permalink:"/pages/149013/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/06.Maven%E6%8F%92%E4%BB%B6%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5.html",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/06.Mavenæä»¶ä¹ä»£ç æ£æ¥.md",key:"v-d649585e",path:"/pages/149013/",headers:[{level:2,title:"maven-checkstyle-plugin",slug:"maven-checkstyle-plugin",normalizedTitle:"maven-checkstyle-plugin",charIndex:20},{level:3,title:"å®ä¹ checkstyle.xml",slug:"å®ä¹-checkstyle-xml",normalizedTitle:"å®ä¹ checkstyle.xml",charIndex:92},{level:2,title:"maven-pmd-plugin",slug:"maven-pmd-plugin",normalizedTitle:"maven-pmd-plugin",charIndex:13707},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:15422}],headersStr:"maven-checkstyle-plugin å®ä¹ checkstyle.xml maven-pmd-plugin åèèµæ",content:'# Maven æä»¶ä¹ä»£ç æ£æ¥\n\n\n# maven-checkstyle-plugin\n\n> maven-checkstyle-pluginï¼ç¨äºæ£æµä»£ç ä¸­ä¸ç¬¦åè§èçå°æ¹ã\n\n\n# å®ä¹ checkstyle.xml\n\n<!DOCTYPE module PUBLIC\n  "-//Checkstyle//DTD Checkstyle Configuration 1.3//EN"\n  "https://checkstyle.org/dtds/configuration_1_3.dtd">\n\n\x3c!-- Generated by RHY @will_awoke --\x3e\n\n<module name="Checker">\n\n  <property name="charset" value="UTF-8"/>\n  <property name="severity" value="warning"/>\n\n  \x3c!-- Checks for Size Violations.  --\x3e\n  \x3c!-- æ£æ¥æä»¶çé¿åº¦ï¼è¡ï¼ default max=2000 --\x3e\n  <module name="FileLength">\n    <property name="max" value="2500"/>\n  </module>\n\n  \x3c!-- Checks that property files contain the same keys. --\x3e\n  \x3c!-- æ£æ¥**.propertieséç½®æä»¶ æ¯å¦æç¸åçkey\n  <module name="Translation">\n  </module>\n  --\x3e\n\n  <module name="TreeWalker">\n\n    \x3c!-- Checks for imports    --\x3e\n    \x3c!-- å¿é¡»å¯¼å¥ç±»çå®æ´è·¯å¾ï¼å³ä¸è½ä½¿ç¨*å¯¼å¥æéçç±» --\x3e\n    <module name="AvoidStarImport"/>\n\n    \x3c!-- æ£æ¥æ¯å¦ä»éæ³çåä¸­å¯¼å¥äºç±» illegalPkgs: å®ä¹éæ³çååç§°--\x3e\n    <module name="IllegalImport"/> \x3c!-- defaults to sun.* packages --\x3e\n\n    \x3c!-- æ£æ¥æ¯å¦å¯¼å¥äºä¸å¿æ¾ç¤ºå¯¼å¥çç±»--\x3e\n    <module name="RedundantImport"/>\n\n    \x3c!-- æ£æ¥æ¯å¦å¯¼å¥çåæ²¡æä½¿ç¨--\x3e\n    <module name="UnusedImports"/>\n\n    \x3c!-- Checks for whitespace\n    <module name="EmptyForIteratorPad"/>\n    <module name="MethodParamPad"/>\n    <module name="NoWhitespaceAfter"/>\n    <module name="NoWhitespaceBefore"/>\n    <module name="OperatorWrap"/>\n    <module name="ParenPad"/>\n    <module name="TypecastParenPad"/>\n    <module name="WhitespaceAfter"/>\n    <module name="WhitespaceAround"/>\n    --\x3e\n\n    \x3c!-- æ£æ¥ç±»åæ¥å£çjavadoc é»è®¤ä¸æ£æ¥author åversion tags\n      authorFormat: æ£æ¥authoræ ç­¾çæ ¼å¼\n            versionFormat: æ£æ¥versionæ ç­¾çæ ¼å¼\n            scope: å¯ä»¥æ£æ¥çç±»çèå´ï¼ä¾å¦ï¼publicåªè½æ£æ¥publicä¿®é¥°çç±»ï¼privateå¯ä»¥æ£æ¥ææçç±»\n            excludeScope: ä¸è½æ£æ¥çç±»çèå´ï¼ä¾å¦ï¼publicï¼publicçç±»å°ä¸è¢«æ£æ¥ï¼ä½è®¿é®æéå°äºpublicçç±»ä»ç¶ä¼æ£æ¥ï¼å¶ä»çæéä»¥æ­¤ç±»æ¨\n            tokens: è¯¥å±æ§éç¨çç±»åï¼ä¾å¦ï¼CLASS_DEF,INTERFACE_DEF --\x3e\n    <module name="JavadocType">\n      <property name="authorFormat" value="\\S"/>\n      <property name="scope" value="protected"/>\n      <property name="tokens" value="CLASS_DEF,INTERFACE_DEF"/>\n    </module>\n\n    \x3c!-- æ£æ¥æ¹æ³çjavadocçæ³¨é\n            scope: å¯ä»¥æ£æ¥çæ¹æ³çèå´ï¼ä¾å¦ï¼publicåªè½æ£æ¥publicä¿®é¥°çæ¹æ³ï¼privateå¯ä»¥æ£æ¥ææçæ¹æ³\n            allowMissingParamTags: æ¯å¦å¿½ç¥å¯¹åæ°æ³¨éçæ£æ¥\n            allowMissingThrowsTags: æ¯å¦å¿½ç¥å¯¹throwsæ³¨éçæ£æ¥\n            allowMissingReturnTag: æ¯å¦å¿½ç¥å¯¹returnæ³¨éçæ£æ¥ --\x3e\n    <module name="JavadocMethod">\n      <property name="scope" value="private"/>\n      <property name="allowMissingParamTags" value="false"/>\n      <property name="allowMissingThrowsTags" value="false"/>\n      <property name="allowMissingReturnTag" value="false"/>\n      <property name="tokens" value="METHOD_DEF"/>\n      <property name="allowUndeclaredRTE" value="true"/>\n      <property name="allowThrowsTagsForSubclasses" value="true"/>\n      \x3c!--åè®¸get set æ¹æ³æ²¡ææ³¨é--\x3e\n      <property name="allowMissingPropertyJavadoc" value="true"/>\n    </module>\n\n    \x3c!-- æ£æ¥ç±»åéçæ³¨é\n            scope: æ£æ¥åéçèå´ï¼ä¾å¦ï¼publicåªè½æ£æ¥publicä¿®é¥°çåéï¼privateå¯ä»¥æ£æ¥ææçåé --\x3e\n    <module name="JavadocVariable">\n      <property name="scope" value="private"/>\n    </module>\n\n    \x3c!--option: å®ä¹å·¦å¤§æ¬å·\'{\'æ¾ç¤ºä½ç½®ï¼eolå¨åä¸è¡æ¾ç¤ºï¼nlå¨ä¸ä¸è¡æ¾ç¤º\n      maxLineLength: å¤§æ¬å·\'{\'æå¨è¡è¡æå¤å®¹çº³çå­ç¬¦æ°\n      tokens: è¯¥å±æ§éç¨çç±»åï¼ä¾ï¼CLASS_DEF,INTERFACE_DEF,METHOD_DEF,CTOR_DEF --\x3e\n    <module name="LeftCurly">\n      <property name="option" value="nl"/>\n    </module>\n\n    \x3c!-- NeedBraces æ£æ¥æ¯å¦åºè¯¥ä½¿ç¨æ¬å·çå°æ¹æ²¡æå æ¬å·\n      tokens: å®ä¹æ£æ¥çç±»å --\x3e\n    <module name="NeedBraces"/>\n\n    \x3c!-- Checks the placement of right curly braces (\'}\') for  else, try, and catch tokens. The policy to verify is specified using property  option.\n      option: å³å¤§æ¬å·æ¯å¦åç¬ä¸è¡æ¾ç¤º\n      tokens: å®ä¹æ£æ¥çç±»å  --\x3e\n    <module name="RightCurly">\n      <property name="option" value="alone"/>\n    </module>\n\n    \x3c!-- æ£æ¥å¨éåäºequalsæ¹æ³åæ¯å¦éåäºhashCodeæ¹æ³ --\x3e\n    <module name="EqualsHashCode"/>\n\n    \x3c!--  Checks for illegal instantiations where a factory method is preferred.\n      Rationale: Depending on the project, for some classes it might be preferable to create instances through factory methods rather than calling the constructor.\n      A simple example is the java.lang.Boolean class. In order to save memory and CPU cycles, it is preferable to use the predefined constants TRUE and FALSE. Constructor invocations should be replaced by calls to Boolean.valueOf().\n      Some extremely performance sensitive projects may require the use of factory methods for other classes as well, to enforce the usage of number caches or object pools. --\x3e\n    <module name="IllegalInstantiation">\n      <property name="classes" value="java.lang.Boolean"/>\n    </module>\n\n    \x3c!-- Checks for Naming Conventions.   å½åè§è   --\x3e\n    \x3c!-- local, final variables, including catch parameters --\x3e\n    <module name="LocalFinalVariableName"/>\n\n    \x3c!-- local, non-final variables, including catch parameters--\x3e\n    <module name="LocalVariableName"/>\n\n    \x3c!-- static, non-final fields --\x3e\n    <module name="StaticVariableName">\n      <property name="format" value="(^[A-Z0-9_]{0,19}$)"/>\n    </module>\n\n    \x3c!-- packages --\x3e\n    <module name="PackageName">\n      <property name="format" value="^[a-z]+(\\.[a-z][a-z0-9]*)*$"/>\n    </module>\n\n    \x3c!-- classes and interfaces --\x3e\n    <module name="TypeName">\n      <property name="format" value="(^[A-Z][a-zA-Z0-9]{0,19}$)"/>\n    </module>\n\n    \x3c!-- methods --\x3e\n    <module name="MethodName">\n      <property name="format" value="(^[a-z][a-zA-Z0-9]{0,19}$)"/>\n    </module>\n\n    \x3c!-- non-static fields --\x3e\n    <module name="MemberName">\n      <property name="format" value="(^[a-z][a-z0-9][a-zA-Z0-9]{0,19}$)"/>\n    </module>\n\n    \x3c!-- parameters --\x3e\n    <module name="ParameterName">\n      <property name="format" value="(^[a-z][a-zA-Z0-9_]{0,19}$)"/>\n    </module>\n\n    \x3c!-- constants (static,  final fields) --\x3e\n    <module name="ConstantName">\n      <property name="format" value="(^[A-Z0-9_]{0,19}$)"/>\n    </module>\n\n    \x3c!-- ä»£ç ç¼©è¿   --\x3e\n    <module name="Indentation">\n    </module>\n\n    \x3c!-- Checks for redundant exceptions declared in throws clause such as duplicates, unchecked exceptions or subclasses of another declared exception.\n      æ£æ¥æ¯å¦æåºäºå¤ä½çå¼å¸¸\n    <module name="RedundantThrows">\n        <property name="logLoadErrors" value="true"/>\n        <property name="suppressLoadErrors" value="true"/>\n    </module>\n    --\x3e\n\n    \x3c!--  Checks for overly complicated boolean expressions. Currently finds code like  if (b == true), b || true, !false, etc.\n      æ£æ¥booleanå¼æ¯å¦åä½çå°æ¹\n      Rationale: Complex boolean logic makes code hard to understand and maintain. --\x3e\n    <module name="SimplifyBooleanExpression"/>\n\n    \x3c!--  Checks for overly complicated boolean return statements. For example the following code\n       æ£æ¥æ¯å¦å­å¨è¿åº¦å¤æçbooleanè¿åå¼\n       if (valid())\n          return false;\n       else\n          return true;\n       could be written as\n          return !valid();\n       The Idea for this Check has been shamelessly stolen from the equivalent PMD rule. --\x3e\n    <module name="SimplifyBooleanReturn"/>\n\n    \x3c!-- Checks that a class which has only private constructors is declared as final.åªæç§ææé å¨çç±»å¿é¡»å£°æä¸ºfinal--\x3e\n    <module name="FinalClass"/>\n\n    \x3c!--  Make sure that utility classes (classes that contain only static methods or fields in their API) do not have a public constructor.\n      ç¡®ä¿Utilsç±»ï¼åªæä¾staticæ¹æ³åå±æ§çç±»ï¼æ²¡æpublicæé å¨ã\n      Rationale: Instantiating utility classes does not make sense. Hence the constructors should either be private or (if you want to allow subclassing) protected. A common mistake is forgetting to hide the default constructor.\n      If you make the constructor protected you may want to consider the following constructor implementation technique to disallow instantiating subclasses:\n      public class StringUtils // not final to allow subclassing\n      {\n          protected StringUtils() {\n              throw new UnsupportedOperationException(); // prevents calls from subclass\n          }\n          public static int count(char c, String s) {\n              // ...\n          }\n      }\n   <module name="HideUtilityClassConstructor"/>\n   --\x3e\n\n    \x3c!--  Checks visibility of class members. Only static final members may be public; other class members must be private unless property protectedAllowed or packageAllowed is set.\n      æ£æ¥classæåå±æ§å¯è§æ§ãåªæstatic final ä¿®é¥°çæåæ¯å¯ä»¥publicçãå¶ä»çæåå±æ§å¿éæ¯privateçï¼é¤éå±æ§protectedAllowedæèpackageAllowedè®¾ç½®äºtrue.\n       Public members are not flagged if the name matches the public member regular expression (contains "^serialVersionUID$" by default). Note: Checkstyle 2 used to include "^f[A-Z][a-zA-Z0-9]*$" in the default pattern to allow CMP for EJB 1.1 with the default settings. With EJB 2.0 it is not longer necessary to have public access for persistent fields, hence the default has been changed.\n       Rationale: Enforce encapsulation. å¼ºå¶å°è£ --\x3e\n    <module name="VisibilityModifier"/>\n\n    \x3c!-- æ¯ä¸è¡åªè½å®ä¹ä¸ä¸ªåé --\x3e\n    <module name="MultipleVariableDeclarations">\n    </module>\n\n    \x3c!-- Checks the style of array type definitions. Some like Java-style: public static void main(String[] args) and some like C-style: public static void main(String args[])\n      æ£æ¥åå®ä¹æ°ç»æ¶ï¼éç¨javaé£æ ¼è¿æ¯cé£æ ¼ï¼ä¾å¦ï¼int[] numæ¯javaé£æ ¼ï¼int num[]æ¯cé£æ ¼ãé»è®¤æ¯javaé£æ ¼--\x3e\n    <module name="ArrayTypeStyle">\n    </module>\n\n    \x3c!-- Checks that there are no "magic numbers", where a magic number is a numeric literal that is not defined as a constant. By default, -1, 0, 1, and 2 are not considered to be magic numbers.\n    <module name="MagicNumber">\n    </module>\n    --\x3e\n\n    \x3c!-- A check for TODO: comments. Actually it is a generic regular expression matcher on Java comments. To check for other patterns in Java comments, set property format.\n       æ£æ¥æ¯å¦å­å¨TODOï¼å¾å¤çï¼ TODOæ¯javaIDEèªå¨çæçãä¸è¬ä»£ç åå®åè¦å»æã\n     --\x3e\n    <module name="TodoComment"/>\n\n    \x3c!--  Checks that long constants are defined with an upper ell. That is \' L\' and not \'l\'. This is in accordance to the Java Language Specification,  Section 3.10.1.\n      æ£æ¥æ¯å¦å¨longç±»åæ¯å¦å®ä¹äºå¤§åçL.å­æ¯å°ålåæ°å­1ï¼ä¸ï¼å¾ç¸ä¼¼ã\n      looks a lot like 1. --\x3e\n    <module name="UpperEll"/>\n\n    \x3c!--  Checks that switch statement has "default" clause. æ£æ¥switchè¯­å¥æ¯å¦æâdefaultâä»å¥\n       Rationale: It\'s usually a good idea to introduce a default case in every switch statement.\n       Even if the developer is sure that all currently possible cases are covered, this should be expressed in the default branch,\n        e.g. by using an assertion. This way the code is protected aginst later changes, e.g. introduction of new types in an enumeration type. --\x3e\n    <module name="MissingSwitchDefault"/>\n\n    \x3c!--æ£æ¥switchä¸­caseåæ¯å¦å å¥äºè·³åºè¯­å¥ï¼ä¾å¦ï¼returnãbreakãthrowãcontinue --\x3e\n    <module name="FallThrough"/>\n\n    \x3c!-- Checks the number of parameters of a method or constructor. max default 7ä¸ª. --\x3e\n    <module name="ParameterNumber">\n      <property name="max" value="5"/>\n    </module>\n\n    \x3c!-- æ¯è¡å­ç¬¦æ° --\x3e\n    <module name="LineLength">\n      <property name="max" value="200"/>\n    </module>\n\n    \x3c!-- Checks for long methods and constructors. max default 150è¡. max=300 è®¾ç½®é¿åº¦300 --\x3e\n    <module name="MethodLength">\n      <property name="max" value="300"/>\n    </module>\n\n    \x3c!-- ModifierOrder æ£æ¥ä¿®é¥°ç¬¦çé¡ºåºï¼é»è®¤æ¯ public,protected,private,abstract,static,final,transient,volatile,synchronized,native --\x3e\n    <module name="ModifierOrder">\n    </module>\n\n    \x3c!-- æ£æ¥æ¯å¦æå¤ä½çä¿®é¥°ç¬¦ï¼ä¾å¦ï¼æ¥å£ä¸­çæ¹æ³ä¸å¿ä½¿ç¨publicãabstractä¿®é¥°  --\x3e\n    <module name="RedundantModifier">\n    </module>\n\n    \x3c!--- å­ç¬¦ä¸²æ¯è¾å¿é¡»ä½¿ç¨ equals() --\x3e\n    <module name="StringLiteralEquality">\n    </module>\n\n    \x3c!-- if-elseåµå¥è¯­å¥ä¸ªæ° æå¤4å± --\x3e\n    <module name="NestedIfDepth">\n      <property name="max" value="3"/>\n    </module>\n\n    \x3c!-- try-catch åµå¥è¯­å¥ä¸ªæ° æå¤2å± --\x3e\n    <module name="NestedTryDepth">\n      <property name="max" value="2"/>\n    </module>\n\n    \x3c!-- è¿åä¸ªæ° --\x3e\n    <module name="ReturnCount">\n      <property name="max" value="5"/>\n      <property name="format" value="^$"/>\n    </module>\n\n  </module>\n</module>\n\n\néç½® pom.xmlï¼\n\n\n<project>\n    ...\n    <properties>\n        <checkstyle.config.location>config/maven_checks.xml</checkstyle.config.location>\n    </properties>\n    ...\n    <reporting>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-checkstyle-plugin</artifactId>\n                <version>3.0</version>\n                <executions>\n                    <execution>\n                        \x3c!-- ç»å®pmd:pmdå°validateçå½å¨æï¼å¨validateæ¶ä¼èªå¨è¿è¡ä»£ç è§èæ£æ¥ --\x3e\n                        <id>validate</id>\n                        <phase>validate</phase>\n                        <configuration>\n                            \x3c!-- éç½®æä»¶çè·¯å¾ï¼å¨styleæä»¶å¤¹ä¸ --\x3e\n                            <configLocation>style/checkstyle.xml</configLocation>\n                            <encoding>UTF-8</encoding>\n                            <consoleOutput>true</consoleOutput>\n                            <failsOnError>true</failsOnError>\n                            <includeTestSourceDirectory>false</includeTestSourceDirectory>\n                        </configuration>\n                        <goals>\n                            <goal>check</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-jxr-plugin</artifactId>\n                <version>2.3</version>\n            </plugin>\n        </plugins>\n    </reporting>\n    ...\n</project>\n\n\nå¶ä¸­å¯ä»¥ä¿®æ¹ä½¿ç¨çæ£æ¥è§åæä»¶è·¯å¾ï¼æä»¶é»è®¤æä¾äºåä¸ªè§åæä»¶å¯ä»¥ç´æ¥ä½¿ç¨ï¼æ éæå¨ä¸è½½ï¼\n\n * config/sun_checks.xml - Sun Microsystems Definition (default).\n * config/maven_checks.xml - Maven Development Definitions.\n * config/turbine_checks.xml - Turbine Development Definitions.\n * config/avalon_checks.xml - Avalon Development Definitions.\n\néç½®å¥½åï¼å¯ä»¥æ§è¡ mvn clean checkstyle:check æ£æ¥ä»£ç ã\n\n\n# maven-pmd-plugin\n\n> maven-pmd-plugin æ¯é¿éç¼ç¨è§èæ£æ¥æä»¶ã\n\néç½® pom.xmlï¼\n\nåè https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml éç½®\n\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-pmd-plugin</artifactId>\n        <version>3.11.0</version>\n        <configuration>\n          <sourceEncoding>${project.build.sourceEncoding}</sourceEncoding>\n          <targetJdk>${maven.compiler.target}</targetJdk>\n          <printFailingErrors>true</printFailingErrors>\n          <rulesets>\n            <ruleset>rulesets/java/ali-comment.xml</ruleset>\n            <ruleset>rulesets/java/ali-concurrent.xml</ruleset>\n            <ruleset>rulesets/java/ali-constant.xml</ruleset>\n            <ruleset>rulesets/java/ali-exception.xml</ruleset>\n            <ruleset>rulesets/java/ali-flowcontrol.xml</ruleset>\n            <ruleset>rulesets/java/ali-naming.xml</ruleset>\n            <ruleset>rulesets/java/ali-oop.xml</ruleset>\n            <ruleset>rulesets/java/ali-orm.xml</ruleset>\n            <ruleset>rulesets/java/ali-other.xml</ruleset>\n            <ruleset>rulesets/java/ali-set.xml</ruleset>\n          </rulesets>\n          <printFailingErrors>true</printFailingErrors>\n        </configuration>\n        <executions>\n          <execution>\n            <phase>verify</phase>\n            <goals>\n              <goal>check</goal>\n            </goals>\n          </execution>\n        </executions>\n        <dependencies>\n          <dependency>\n            <groupId>com.alibaba.p3c</groupId>\n            <artifactId>p3c-pmd</artifactId>\n            <version>2.0.0</version>\n          </dependency>\n        </dependencies>\n      </plugin>\n    </plugins>\n\n\néç½®å¥½åï¼å¯ä»¥æ§è¡ mvn clean pmd:check æ£æ¥ä»£ç ã\n\n\n# åèèµæ\n\n * https://maven.apache.org/plugins/maven-checkstyle-plugin/\n * https://maven.apache.org/jxr/maven-jxr-plugin/\n * https://www.jianshu.com/p/557b975ae40d\n * é¿éå·´å·´ç¼ç¨è§è\n   * https://github.com/alibaba/p3c\n   * https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml',normalizedContent:'# maven æä»¶ä¹ä»£ç æ£æ¥\n\n\n# maven-checkstyle-plugin\n\n> maven-checkstyle-pluginï¼ç¨äºæ£æµä»£ç ä¸­ä¸ç¬¦åè§èçå°æ¹ã\n\n\n# å®ä¹ checkstyle.xml\n\n<!doctype module public\n  "-//checkstyle//dtd checkstyle configuration 1.3//en"\n  "https://checkstyle.org/dtds/configuration_1_3.dtd">\n\n\x3c!-- generated by rhy @will_awoke --\x3e\n\n<module name="checker">\n\n  <property name="charset" value="utf-8"/>\n  <property name="severity" value="warning"/>\n\n  \x3c!-- checks for size violations.  --\x3e\n  \x3c!-- æ£æ¥æä»¶çé¿åº¦ï¼è¡ï¼ default max=2000 --\x3e\n  <module name="filelength">\n    <property name="max" value="2500"/>\n  </module>\n\n  \x3c!-- checks that property files contain the same keys. --\x3e\n  \x3c!-- æ£æ¥**.propertieséç½®æä»¶ æ¯å¦æç¸åçkey\n  <module name="translation">\n  </module>\n  --\x3e\n\n  <module name="treewalker">\n\n    \x3c!-- checks for imports    --\x3e\n    \x3c!-- å¿é¡»å¯¼å¥ç±»çå®æ´è·¯å¾ï¼å³ä¸è½ä½¿ç¨*å¯¼å¥æéçç±» --\x3e\n    <module name="avoidstarimport"/>\n\n    \x3c!-- æ£æ¥æ¯å¦ä»éæ³çåä¸­å¯¼å¥äºç±» illegalpkgs: å®ä¹éæ³çååç§°--\x3e\n    <module name="illegalimport"/> \x3c!-- defaults to sun.* packages --\x3e\n\n    \x3c!-- æ£æ¥æ¯å¦å¯¼å¥äºä¸å¿æ¾ç¤ºå¯¼å¥çç±»--\x3e\n    <module name="redundantimport"/>\n\n    \x3c!-- æ£æ¥æ¯å¦å¯¼å¥çåæ²¡æä½¿ç¨--\x3e\n    <module name="unusedimports"/>\n\n    \x3c!-- checks for whitespace\n    <module name="emptyforiteratorpad"/>\n    <module name="methodparampad"/>\n    <module name="nowhitespaceafter"/>\n    <module name="nowhitespacebefore"/>\n    <module name="operatorwrap"/>\n    <module name="parenpad"/>\n    <module name="typecastparenpad"/>\n    <module name="whitespaceafter"/>\n    <module name="whitespacearound"/>\n    --\x3e\n\n    \x3c!-- æ£æ¥ç±»åæ¥å£çjavadoc é»è®¤ä¸æ£æ¥author åversion tags\n      authorformat: æ£æ¥authoræ ç­¾çæ ¼å¼\n            versionformat: æ£æ¥versionæ ç­¾çæ ¼å¼\n            scope: å¯ä»¥æ£æ¥çç±»çèå´ï¼ä¾å¦ï¼publicåªè½æ£æ¥publicä¿®é¥°çç±»ï¼privateå¯ä»¥æ£æ¥ææçç±»\n            excludescope: ä¸è½æ£æ¥çç±»çèå´ï¼ä¾å¦ï¼publicï¼publicçç±»å°ä¸è¢«æ£æ¥ï¼ä½è®¿é®æéå°äºpublicçç±»ä»ç¶ä¼æ£æ¥ï¼å¶ä»çæéä»¥æ­¤ç±»æ¨\n            tokens: è¯¥å±æ§éç¨çç±»åï¼ä¾å¦ï¼class_def,interface_def --\x3e\n    <module name="javadoctype">\n      <property name="authorformat" value="\\s"/>\n      <property name="scope" value="protected"/>\n      <property name="tokens" value="class_def,interface_def"/>\n    </module>\n\n    \x3c!-- æ£æ¥æ¹æ³çjavadocçæ³¨é\n            scope: å¯ä»¥æ£æ¥çæ¹æ³çèå´ï¼ä¾å¦ï¼publicåªè½æ£æ¥publicä¿®é¥°çæ¹æ³ï¼privateå¯ä»¥æ£æ¥ææçæ¹æ³\n            allowmissingparamtags: æ¯å¦å¿½ç¥å¯¹åæ°æ³¨éçæ£æ¥\n            allowmissingthrowstags: æ¯å¦å¿½ç¥å¯¹throwsæ³¨éçæ£æ¥\n            allowmissingreturntag: æ¯å¦å¿½ç¥å¯¹returnæ³¨éçæ£æ¥ --\x3e\n    <module name="javadocmethod">\n      <property name="scope" value="private"/>\n      <property name="allowmissingparamtags" value="false"/>\n      <property name="allowmissingthrowstags" value="false"/>\n      <property name="allowmissingreturntag" value="false"/>\n      <property name="tokens" value="method_def"/>\n      <property name="allowundeclaredrte" value="true"/>\n      <property name="allowthrowstagsforsubclasses" value="true"/>\n      \x3c!--åè®¸get set æ¹æ³æ²¡ææ³¨é--\x3e\n      <property name="allowmissingpropertyjavadoc" value="true"/>\n    </module>\n\n    \x3c!-- æ£æ¥ç±»åéçæ³¨é\n            scope: æ£æ¥åéçèå´ï¼ä¾å¦ï¼publicåªè½æ£æ¥publicä¿®é¥°çåéï¼privateå¯ä»¥æ£æ¥ææçåé --\x3e\n    <module name="javadocvariable">\n      <property name="scope" value="private"/>\n    </module>\n\n    \x3c!--option: å®ä¹å·¦å¤§æ¬å·\'{\'æ¾ç¤ºä½ç½®ï¼eolå¨åä¸è¡æ¾ç¤ºï¼nlå¨ä¸ä¸è¡æ¾ç¤º\n      maxlinelength: å¤§æ¬å·\'{\'æå¨è¡è¡æå¤å®¹çº³çå­ç¬¦æ°\n      tokens: è¯¥å±æ§éç¨çç±»åï¼ä¾ï¼class_def,interface_def,method_def,ctor_def --\x3e\n    <module name="leftcurly">\n      <property name="option" value="nl"/>\n    </module>\n\n    \x3c!-- needbraces æ£æ¥æ¯å¦åºè¯¥ä½¿ç¨æ¬å·çå°æ¹æ²¡æå æ¬å·\n      tokens: å®ä¹æ£æ¥çç±»å --\x3e\n    <module name="needbraces"/>\n\n    \x3c!-- checks the placement of right curly braces (\'}\') for  else, try, and catch tokens. the policy to verify is specified using property  option.\n      option: å³å¤§æ¬å·æ¯å¦åç¬ä¸è¡æ¾ç¤º\n      tokens: å®ä¹æ£æ¥çç±»å  --\x3e\n    <module name="rightcurly">\n      <property name="option" value="alone"/>\n    </module>\n\n    \x3c!-- æ£æ¥å¨éåäºequalsæ¹æ³åæ¯å¦éåäºhashcodeæ¹æ³ --\x3e\n    <module name="equalshashcode"/>\n\n    \x3c!--  checks for illegal instantiations where a factory method is preferred.\n      rationale: depending on the project, for some classes it might be preferable to create instances through factory methods rather than calling the constructor.\n      a simple example is the java.lang.boolean class. in order to save memory and cpu cycles, it is preferable to use the predefined constants true and false. constructor invocations should be replaced by calls to boolean.valueof().\n      some extremely performance sensitive projects may require the use of factory methods for other classes as well, to enforce the usage of number caches or object pools. --\x3e\n    <module name="illegalinstantiation">\n      <property name="classes" value="java.lang.boolean"/>\n    </module>\n\n    \x3c!-- checks for naming conventions.   å½åè§è   --\x3e\n    \x3c!-- local, final variables, including catch parameters --\x3e\n    <module name="localfinalvariablename"/>\n\n    \x3c!-- local, non-final variables, including catch parameters--\x3e\n    <module name="localvariablename"/>\n\n    \x3c!-- static, non-final fields --\x3e\n    <module name="staticvariablename">\n      <property name="format" value="(^[a-z0-9_]{0,19}$)"/>\n    </module>\n\n    \x3c!-- packages --\x3e\n    <module name="packagename">\n      <property name="format" value="^[a-z]+(\\.[a-z][a-z0-9]*)*$"/>\n    </module>\n\n    \x3c!-- classes and interfaces --\x3e\n    <module name="typename">\n      <property name="format" value="(^[a-z][a-za-z0-9]{0,19}$)"/>\n    </module>\n\n    \x3c!-- methods --\x3e\n    <module name="methodname">\n      <property name="format" value="(^[a-z][a-za-z0-9]{0,19}$)"/>\n    </module>\n\n    \x3c!-- non-static fields --\x3e\n    <module name="membername">\n      <property name="format" value="(^[a-z][a-z0-9][a-za-z0-9]{0,19}$)"/>\n    </module>\n\n    \x3c!-- parameters --\x3e\n    <module name="parametername">\n      <property name="format" value="(^[a-z][a-za-z0-9_]{0,19}$)"/>\n    </module>\n\n    \x3c!-- constants (static,  final fields) --\x3e\n    <module name="constantname">\n      <property name="format" value="(^[a-z0-9_]{0,19}$)"/>\n    </module>\n\n    \x3c!-- ä»£ç ç¼©è¿   --\x3e\n    <module name="indentation">\n    </module>\n\n    \x3c!-- checks for redundant exceptions declared in throws clause such as duplicates, unchecked exceptions or subclasses of another declared exception.\n      æ£æ¥æ¯å¦æåºäºå¤ä½çå¼å¸¸\n    <module name="redundantthrows">\n        <property name="logloaderrors" value="true"/>\n        <property name="suppressloaderrors" value="true"/>\n    </module>\n    --\x3e\n\n    \x3c!--  checks for overly complicated boolean expressions. currently finds code like  if (b == true), b || true, !false, etc.\n      æ£æ¥booleanå¼æ¯å¦åä½çå°æ¹\n      rationale: complex boolean logic makes code hard to understand and maintain. --\x3e\n    <module name="simplifybooleanexpression"/>\n\n    \x3c!--  checks for overly complicated boolean return statements. for example the following code\n       æ£æ¥æ¯å¦å­å¨è¿åº¦å¤æçbooleanè¿åå¼\n       if (valid())\n          return false;\n       else\n          return true;\n       could be written as\n          return !valid();\n       the idea for this check has been shamelessly stolen from the equivalent pmd rule. --\x3e\n    <module name="simplifybooleanreturn"/>\n\n    \x3c!-- checks that a class which has only private constructors is declared as final.åªæç§ææé å¨çç±»å¿é¡»å£°æä¸ºfinal--\x3e\n    <module name="finalclass"/>\n\n    \x3c!--  make sure that utility classes (classes that contain only static methods or fields in their api) do not have a public constructor.\n      ç¡®ä¿utilsç±»ï¼åªæä¾staticæ¹æ³åå±æ§çç±»ï¼æ²¡æpublicæé å¨ã\n      rationale: instantiating utility classes does not make sense. hence the constructors should either be private or (if you want to allow subclassing) protected. a common mistake is forgetting to hide the default constructor.\n      if you make the constructor protected you may want to consider the following constructor implementation technique to disallow instantiating subclasses:\n      public class stringutils // not final to allow subclassing\n      {\n          protected stringutils() {\n              throw new unsupportedoperationexception(); // prevents calls from subclass\n          }\n          public static int count(char c, string s) {\n              // ...\n          }\n      }\n   <module name="hideutilityclassconstructor"/>\n   --\x3e\n\n    \x3c!--  checks visibility of class members. only static final members may be public; other class members must be private unless property protectedallowed or packageallowed is set.\n      æ£æ¥classæåå±æ§å¯è§æ§ãåªæstatic final ä¿®é¥°çæåæ¯å¯ä»¥publicçãå¶ä»çæåå±æ§å¿éæ¯privateçï¼é¤éå±æ§protectedallowedæèpackageallowedè®¾ç½®äºtrue.\n       public members are not flagged if the name matches the public member regular expression (contains "^serialversionuid$" by default). note: checkstyle 2 used to include "^f[a-z][a-za-z0-9]*$" in the default pattern to allow cmp for ejb 1.1 with the default settings. with ejb 2.0 it is not longer necessary to have public access for persistent fields, hence the default has been changed.\n       rationale: enforce encapsulation. å¼ºå¶å°è£ --\x3e\n    <module name="visibilitymodifier"/>\n\n    \x3c!-- æ¯ä¸è¡åªè½å®ä¹ä¸ä¸ªåé --\x3e\n    <module name="multiplevariabledeclarations">\n    </module>\n\n    \x3c!-- checks the style of array type definitions. some like java-style: public static void main(string[] args) and some like c-style: public static void main(string args[])\n      æ£æ¥åå®ä¹æ°ç»æ¶ï¼éç¨javaé£æ ¼è¿æ¯cé£æ ¼ï¼ä¾å¦ï¼int[] numæ¯javaé£æ ¼ï¼int num[]æ¯cé£æ ¼ãé»è®¤æ¯javaé£æ ¼--\x3e\n    <module name="arraytypestyle">\n    </module>\n\n    \x3c!-- checks that there are no "magic numbers", where a magic number is a numeric literal that is not defined as a constant. by default, -1, 0, 1, and 2 are not considered to be magic numbers.\n    <module name="magicnumber">\n    </module>\n    --\x3e\n\n    \x3c!-- a check for todo: comments. actually it is a generic regular expression matcher on java comments. to check for other patterns in java comments, set property format.\n       æ£æ¥æ¯å¦å­å¨todoï¼å¾å¤çï¼ todoæ¯javaideèªå¨çæçãä¸è¬ä»£ç åå®åè¦å»æã\n     --\x3e\n    <module name="todocomment"/>\n\n    \x3c!--  checks that long constants are defined with an upper ell. that is \' l\' and not \'l\'. this is in accordance to the java language specification,  section 3.10.1.\n      æ£æ¥æ¯å¦å¨longç±»åæ¯å¦å®ä¹äºå¤§åçl.å­æ¯å°ålåæ°å­1ï¼ä¸ï¼å¾ç¸ä¼¼ã\n      looks a lot like 1. --\x3e\n    <module name="upperell"/>\n\n    \x3c!--  checks that switch statement has "default" clause. æ£æ¥switchè¯­å¥æ¯å¦æâdefaultâä»å¥\n       rationale: it\'s usually a good idea to introduce a default case in every switch statement.\n       even if the developer is sure that all currently possible cases are covered, this should be expressed in the default branch,\n        e.g. by using an assertion. this way the code is protected aginst later changes, e.g. introduction of new types in an enumeration type. --\x3e\n    <module name="missingswitchdefault"/>\n\n    \x3c!--æ£æ¥switchä¸­caseåæ¯å¦å å¥äºè·³åºè¯­å¥ï¼ä¾å¦ï¼returnãbreakãthrowãcontinue --\x3e\n    <module name="fallthrough"/>\n\n    \x3c!-- checks the number of parameters of a method or constructor. max default 7ä¸ª. --\x3e\n    <module name="parameternumber">\n      <property name="max" value="5"/>\n    </module>\n\n    \x3c!-- æ¯è¡å­ç¬¦æ° --\x3e\n    <module name="linelength">\n      <property name="max" value="200"/>\n    </module>\n\n    \x3c!-- checks for long methods and constructors. max default 150è¡. max=300 è®¾ç½®é¿åº¦300 --\x3e\n    <module name="methodlength">\n      <property name="max" value="300"/>\n    </module>\n\n    \x3c!-- modifierorder æ£æ¥ä¿®é¥°ç¬¦çé¡ºåºï¼é»è®¤æ¯ public,protected,private,abstract,static,final,transient,volatile,synchronized,native --\x3e\n    <module name="modifierorder">\n    </module>\n\n    \x3c!-- æ£æ¥æ¯å¦æå¤ä½çä¿®é¥°ç¬¦ï¼ä¾å¦ï¼æ¥å£ä¸­çæ¹æ³ä¸å¿ä½¿ç¨publicãabstractä¿®é¥°  --\x3e\n    <module name="redundantmodifier">\n    </module>\n\n    \x3c!--- å­ç¬¦ä¸²æ¯è¾å¿é¡»ä½¿ç¨ equals() --\x3e\n    <module name="stringliteralequality">\n    </module>\n\n    \x3c!-- if-elseåµå¥è¯­å¥ä¸ªæ° æå¤4å± --\x3e\n    <module name="nestedifdepth">\n      <property name="max" value="3"/>\n    </module>\n\n    \x3c!-- try-catch åµå¥è¯­å¥ä¸ªæ° æå¤2å± --\x3e\n    <module name="nestedtrydepth">\n      <property name="max" value="2"/>\n    </module>\n\n    \x3c!-- è¿åä¸ªæ° --\x3e\n    <module name="returncount">\n      <property name="max" value="5"/>\n      <property name="format" value="^$"/>\n    </module>\n\n  </module>\n</module>\n\n\néç½® pom.xmlï¼\n\n\n<project>\n    ...\n    <properties>\n        <checkstyle.config.location>config/maven_checks.xml</checkstyle.config.location>\n    </properties>\n    ...\n    <reporting>\n        <plugins>\n            <plugin>\n                <groupid>org.apache.maven.plugins</groupid>\n                <artifactid>maven-checkstyle-plugin</artifactid>\n                <version>3.0</version>\n                <executions>\n                    <execution>\n                        \x3c!-- ç»å®pmd:pmdå°validateçå½å¨æï¼å¨validateæ¶ä¼èªå¨è¿è¡ä»£ç è§èæ£æ¥ --\x3e\n                        <id>validate</id>\n                        <phase>validate</phase>\n                        <configuration>\n                            \x3c!-- éç½®æä»¶çè·¯å¾ï¼å¨styleæä»¶å¤¹ä¸ --\x3e\n                            <configlocation>style/checkstyle.xml</configlocation>\n                            <encoding>utf-8</encoding>\n                            <consoleoutput>true</consoleoutput>\n                            <failsonerror>true</failsonerror>\n                            <includetestsourcedirectory>false</includetestsourcedirectory>\n                        </configuration>\n                        <goals>\n                            <goal>check</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n\n            <plugin>\n                <groupid>org.apache.maven.plugins</groupid>\n                <artifactid>maven-jxr-plugin</artifactid>\n                <version>2.3</version>\n            </plugin>\n        </plugins>\n    </reporting>\n    ...\n</project>\n\n\nå¶ä¸­å¯ä»¥ä¿®æ¹ä½¿ç¨çæ£æ¥è§åæä»¶è·¯å¾ï¼æä»¶é»è®¤æä¾äºåä¸ªè§åæä»¶å¯ä»¥ç´æ¥ä½¿ç¨ï¼æ éæå¨ä¸è½½ï¼\n\n * config/sun_checks.xml - sun microsystems definition (default).\n * config/maven_checks.xml - maven development definitions.\n * config/turbine_checks.xml - turbine development definitions.\n * config/avalon_checks.xml - avalon development definitions.\n\néç½®å¥½åï¼å¯ä»¥æ§è¡ mvn clean checkstyle:check æ£æ¥ä»£ç ã\n\n\n# maven-pmd-plugin\n\n> maven-pmd-plugin æ¯é¿éç¼ç¨è§èæ£æ¥æä»¶ã\n\néç½® pom.xmlï¼\n\nåè https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml éç½®\n\n      <plugin>\n        <groupid>org.apache.maven.plugins</groupid>\n        <artifactid>maven-pmd-plugin</artifactid>\n        <version>3.11.0</version>\n        <configuration>\n          <sourceencoding>${project.build.sourceencoding}</sourceencoding>\n          <targetjdk>${maven.compiler.target}</targetjdk>\n          <printfailingerrors>true</printfailingerrors>\n          <rulesets>\n            <ruleset>rulesets/java/ali-comment.xml</ruleset>\n            <ruleset>rulesets/java/ali-concurrent.xml</ruleset>\n            <ruleset>rulesets/java/ali-constant.xml</ruleset>\n            <ruleset>rulesets/java/ali-exception.xml</ruleset>\n            <ruleset>rulesets/java/ali-flowcontrol.xml</ruleset>\n            <ruleset>rulesets/java/ali-naming.xml</ruleset>\n            <ruleset>rulesets/java/ali-oop.xml</ruleset>\n            <ruleset>rulesets/java/ali-orm.xml</ruleset>\n            <ruleset>rulesets/java/ali-other.xml</ruleset>\n            <ruleset>rulesets/java/ali-set.xml</ruleset>\n          </rulesets>\n          <printfailingerrors>true</printfailingerrors>\n        </configuration>\n        <executions>\n          <execution>\n            <phase>verify</phase>\n            <goals>\n              <goal>check</goal>\n            </goals>\n          </execution>\n        </executions>\n        <dependencies>\n          <dependency>\n            <groupid>com.alibaba.p3c</groupid>\n            <artifactid>p3c-pmd</artifactid>\n            <version>2.0.0</version>\n          </dependency>\n        </dependencies>\n      </plugin>\n    </plugins>\n\n\néç½®å¥½åï¼å¯ä»¥æ§è¡ mvn clean pmd:check æ£æ¥ä»£ç ã\n\n\n# åèèµæ\n\n * https://maven.apache.org/plugins/maven-checkstyle-plugin/\n * https://maven.apache.org/jxr/maven-jxr-plugin/\n * https://www.jianshu.com/p/557b975ae40d\n * é¿éå·´å·´ç¼ç¨è§è\n   * https://github.com/alibaba/p3c\n   * https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Maven æç¨",frontmatter:{title:"Maven æç¨",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Maven"],hidden:!0,abbrlink:"a96d715",date:"2020-08-04T15:20:54.000Z",permalink:"/pages/14735b/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/01.Maven/",relativePath:"11.è½¯ä»¶/01.æå»º/01.Maven/README.md",key:"v-6589cc90",path:"/pages/14735b/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:437},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:579},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:652}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# Maven æç¨\n\n> Maven æ¯ä¸ä¸ªé¡¹ç®ç®¡çå·¥å·ãå®è´è´£ç®¡çé¡¹ç®å¼åè¿ç¨ä¸­çå ä¹ææçä¸è¥¿ã\n> \n>  * çæ¬ - maven æèªå·±ççæ¬å®ä¹åè§åã\n>  * æå»º - maven æ¯æè®¸å¤ç§çåºç¨ç¨åºç±»åï¼å¯¹äºæ¯ä¸ç§æ¯æçåºç¨ç¨åºç±»åé½å®ä¹å¥½äºä¸ç»æå»ºè§ååå·¥å·éã\n>  * è¾åºç©ç®¡ç - maven å¯ä»¥ç®¡çé¡¹ç®æå»ºçäº§ç©ï¼å¹¶å°å¶å å¥å°ç¨æ·åºä¸­ãè¿ä¸ªåè½å¯ä»¥ç¨äºé¡¹ç®ç»åå¶ä»é¨é¨ä¹é´çäº¤ä»è¡ä¸ºã\n>  * ä¾èµå³ç³» - maven å¯¹ä¾èµå³ç³»çç¹æ§è¿è¡ç»è´çåæåååï¼é¿åå¼åè¿ç¨ä¸­çä¾èµæ··ä¹±åç¸äºæ±¡æè¡ä¸º\n>  * ææ¡£åæå»ºç»æ - maven ç site å½ä»¤æ¯æåç§ææ¡£ä¿¡æ¯çåå¸ï¼åæ¬æå»ºè¿ç¨çåç§è¾åºï¼javadocï¼äº§åææ¡£ç­ã\n>  * é¡¹ç®å³ç³» - ä¸ä¸ªå¤§åçé¡¹ç®éå¸¸æå ä¸ªå°é¡¹ç®æèæ¨¡åç»æï¼ç¨ maven å¯ä»¥å¾æ¹ä¾¿å°ç®¡çã\n>  * ç§»æ¤æ§ç®¡ç - maven å¯ä»¥éå¯¹ä¸åçå¼ååºæ¯ï¼è¾åºä¸åç§ç±»çè¾åºç»æã\n\n\n# ð åå®¹\n\n * Maven å¿«éå¥é¨\n * Maven æç¨ä¹ pom.xml è¯¦è§£\n * Maven æç¨ä¹ settings.xml è¯¦è§£\n * Maven å®æé®é¢åæä½³å®è·µ\n * Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n * Maven æä»¶ä¹ä»£ç æ£æ¥\n\n\n# ð èµæ\n\n * å®ç½\n   * Maven Github\n   * Maven å®æ¹ææ¡£\n * ä¹¦ç±\n   * ãMaven å®æã\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# maven æç¨\n\n> maven æ¯ä¸ä¸ªé¡¹ç®ç®¡çå·¥å·ãå®è´è´£ç®¡çé¡¹ç®å¼åè¿ç¨ä¸­çå ä¹ææçä¸è¥¿ã\n> \n>  * çæ¬ - maven æèªå·±ççæ¬å®ä¹åè§åã\n>  * æå»º - maven æ¯æè®¸å¤ç§çåºç¨ç¨åºç±»åï¼å¯¹äºæ¯ä¸ç§æ¯æçåºç¨ç¨åºç±»åé½å®ä¹å¥½äºä¸ç»æå»ºè§ååå·¥å·éã\n>  * è¾åºç©ç®¡ç - maven å¯ä»¥ç®¡çé¡¹ç®æå»ºçäº§ç©ï¼å¹¶å°å¶å å¥å°ç¨æ·åºä¸­ãè¿ä¸ªåè½å¯ä»¥ç¨äºé¡¹ç®ç»åå¶ä»é¨é¨ä¹é´çäº¤ä»è¡ä¸ºã\n>  * ä¾èµå³ç³» - maven å¯¹ä¾èµå³ç³»çç¹æ§è¿è¡ç»è´çåæåååï¼é¿åå¼åè¿ç¨ä¸­çä¾èµæ··ä¹±åç¸äºæ±¡æè¡ä¸º\n>  * ææ¡£åæå»ºç»æ - maven ç site å½ä»¤æ¯æåç§ææ¡£ä¿¡æ¯çåå¸ï¼åæ¬æå»ºè¿ç¨çåç§è¾åºï¼javadocï¼äº§åææ¡£ç­ã\n>  * é¡¹ç®å³ç³» - ä¸ä¸ªå¤§åçé¡¹ç®éå¸¸æå ä¸ªå°é¡¹ç®æèæ¨¡åç»æï¼ç¨ maven å¯ä»¥å¾æ¹ä¾¿å°ç®¡çã\n>  * ç§»æ¤æ§ç®¡ç - maven å¯ä»¥éå¯¹ä¸åçå¼ååºæ¯ï¼è¾åºä¸åç§ç±»çè¾åºç»æã\n\n\n# ð åå®¹\n\n * maven å¿«éå¥é¨\n * maven æç¨ä¹ pom.xml è¯¦è§£\n * maven æç¨ä¹ settings.xml è¯¦è§£\n * maven å®æé®é¢åæä½³å®è·µ\n * maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n * maven æä»¶ä¹ä»£ç æ£æ¥\n\n\n# ð èµæ\n\n * å®ç½\n   * maven github\n   * maven å®æ¹ææ¡£\n * ä¹¦ç±\n   * ãmaven å®æã\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Ant ç®ææç¨",frontmatter:{title:"Ant ç®ææç¨",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º","Ant"],abbrlink:"389d1b12",date:"2017-12-06T09:46:28.000Z",permalink:"/pages/e2af3a/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/02.Ant.html",relativePath:"11.è½¯ä»¶/01.æå»º/02.Ant.md",key:"v-cba3920e",path:"/pages/e2af3a/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:15},{level:2,title:"ä¸è½½åå®è£",slug:"ä¸è½½åå®è£",normalizedTitle:"ä¸è½½åå®è£",charIndex:139},{level:3,title:"ä¸è½½",slug:"ä¸è½½",normalizedTitle:"ä¸è½½",charIndex:139},{level:3,title:"éç½®ç¯å¢åé",slug:"éç½®ç¯å¢åé",normalizedTitle:"éç½®ç¯å¢åé",charIndex:261},{level:3,title:"éªè¯",slug:"éªè¯",normalizedTitle:"éªè¯",charIndex:429},{level:2,title:"ä¾å­",slug:"ä¾å­",normalizedTitle:"ä¾å­",charIndex:758},{level:2,title:"å³é®åç´ ",slug:"å³é®åç´ ",normalizedTitle:"å³é®åç´ ",charIndex:2625},{level:3,title:"Project åç´ ",slug:"project-åç´ ",normalizedTitle:"project åç´ ",charIndex:2716},{level:3,title:"Target åç´ ",slug:"target-åç´ ",normalizedTitle:"target åç´ ",charIndex:3109},{level:3,title:"Task åç´ ",slug:"task-åç´ ",normalizedTitle:"task åç´ ",charIndex:4413},{level:3,title:"Property åç´ ",slug:"property-åç´ ",normalizedTitle:"property åç´ ",charIndex:6322},{level:3,title:"extension-point åç´ ",slug:"extension-point-åç´ ",normalizedTitle:"extension-point åç´ ",charIndex:3776},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:6875}],headersStr:"ç®ä» ä¸è½½åå®è£ ä¸è½½ éç½®ç¯å¢åé éªè¯ ä¾å­ å³é®åç´  Project åç´  Target åç´  Task åç´  Property åç´  extension-point åç´  åèèµæ",content:'# Ant ç®ææç¨\n\n\n# ç®ä»\n\nApache Ant æ¯ä¸ä¸ªå°è½¯ä»¶ç¼è¯ãæµè¯ãé¨ç½²ç­æ­¥éª¤èç³»å¨ä¸èµ·å ä»¥èªå¨åçä¸ä¸ªå·¥å·ï¼å¤§å¤ç¨äº Java ç¯å¢ä¸­çè½¯ä»¶å¼åãç± Apache è½¯ä»¶åºéä¼ææä¾ã\n\nAnt æ¯çº¯ Java è¯­è¨ç¼åçï¼æä»¥å·æå¾å¥½çè·¨å¹³å°æ§ã\n\n\n\n\n# ä¸è½½åå®è£\n\n\n# ä¸è½½\n\nant çå®æ¹ä¸è½½å°åï¼http://ant.apache.org/bindownload.cgi\n\nè¿å¥é¡µé¢åï¼å¨ä¸å¾ççº¢è²æ¹æ¡ä¸­å¯ä»¥ä¸è½½ææ°çæ¬ãç¬èä¸è½½ççæ¬æ¯ apache-ant-1.9.4ã\n\n\n\n\n# éç½®ç¯å¢åé\n\néç½®ç¯å¢åéï¼æççµè -> å±æ§ -> é«çº§ -> ç¯å¢åéï¼ã\n\nè®¾ç½® ant ç¯å¢åéï¼\n\nANT_HOME C:/ apache-ant-1.9.4\n\n\n\n**path ** C:/ apache-ant-1.9.4/bin\n\n\n\nclasspath C:/apache-ant-1.9.4/lib\n\n\n\n\n# éªè¯\n\nç¹å» å¼å§ -> è¿è¡ -> è¾å¥ cmd\n\næ§è¡æå»ºæä»¶\n\nè¾å¥å¦ä¸å½ä»¤ï¼ant\n\nå¦æåºç°å¦ä¸åå®¹ï¼è¯´æå®è£æåï¼\n\n> Buildfile: build.xml does not exist! Build failed\n\næ³¨æï¼å ä¸º ant é»è®¤è¿è¡ build.xml æä»¶ï¼è¿ä¸ªæä»¶éè¦æä»¬åå»ºã\n\nå¦æä¸æ³å½åä¸º build.xmlï¼è¿è¡æ¶å¯ä»¥ä½¿ç¨ ant -buildfile test.xml å½ä»¤ææè¦è¿è¡çæå»ºæä»¶ã\n\næ¥ççæ¬ä¿¡æ¯\n\nè¾å¥ ant -versionï¼å¯ä»¥æ¥ççæ¬ä¿¡æ¯ã\n\n\n\nä½å¦æåºç° \'ant\' ä¸æ¯åé¨æå¤é¨å½ä»¤ï¼ä¹ä¸æ¯å¯è¿è¡çç¨åºææ¹å¤çæä»¶ï¼è¯´æå®è£å¤±è´¥ï¼ï¼å¯ä»¥éå¤åè¿°æ­¥éª¤ï¼ç´è³å®è£æåãï¼\n\n\n# ä¾å­\n\nå¨å®è£åéç½®æååï¼æä»¬å°±å¯ä»¥ä½¿ç¨ ant äºã\n\nä¸ºäºè®©è¯»èå¯¹ ant æä¸ä¸ªç´è§çè®¤è¯ï¼é¦åä»¥ Ant å®æ¹æåä¸çä¸ä¸ªç®åä¾å­åä¸ä¸ªè¯´æã\n\nä»¥ä¸æ¯ä¸ä¸ª build.xml æä»¶çåå®¹ï¼\n\n<project name="MyProject" default="dist" basedir=".">\n    <description>\n        simple example build file\n    </description>\n  \x3c!-- set global properties for this build --\x3e\n  <property name="src" location="src"/>\n  <property name="build" location="build"/>\n  <property name="dist"  location="dist"/>\n\n  <target name="init">\n    \x3c!-- Create the time stamp --\x3e\n    <tstamp/>\n    \x3c!-- Create the build directory structure used by compile --\x3e\n    <mkdir dir="${build}"/>\n  </target>\n\n  <target name="compile" depends="init"\n        description="compile the source " >\n    \x3c!-- Compile the java code from ${src} into ${build} --\x3e\n    <javac srcdir="${src}" destdir="${build}"/>\n  </target>\n\n  <target name="dist" depends="compile"\n        description="generate the distribution" >\n    \x3c!-- Create the distribution directory --\x3e\n    <mkdir dir="${dist}/lib"/>\n\n    \x3c!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file --\x3e\n    <jar jarfile="${dist}/lib/MyProject-${DSTAMP}.jar" basedir="${build}"/>\n  </target>\n\n  <target name="clean"\n        description="clean up" >\n    \x3c!-- Delete the ${build} and ${dist} directory trees --\x3e\n    <delete dir="${build}"/>\n    <delete dir="${dist}"/>\n  </target>\n</project>\n\n\nå¨è¿ä¸ª xml æä»¶ä¸­ï¼æå ä¸ª target æ ç­¾ï¼æ¯ä¸ª target å¯¹åºä¸ä¸ªæ§è¡ç®æ ã\n\næä»¬å°è¿ä¸ª build.xml æ¾å¨ D:\\Temp\\ant_test è·¯å¾ä¸ï¼ç¶åå¨ dos çé¢ä¸è¿è¡æµè¯ã\n\nant init\n\n\n\nå¨ D:\\Temp\\ant_test è·¯å¾ä¸åå»ºäºä¸ä¸ª build ç®å½ï¼æ§è¡æåã\n\nant compile\n\n\n\næç¤ºéè¯¯ï¼åæ¥æ¯å¨ build.xml çæå¨ç®å½ä¸æ¾ä¸å° src ç®å½ãå¥½çï¼æä»¬ç´æ¥åå»ºä¸ä¸ª src ç®å½ï¼ç¶ååæ¬¡å°è¯ãè¿æ¬¡ï¼æ§è¡æåã\n\n\n\n**ant dist **\n\n\n\nå¨ D:\\Temp\\ant_test è·¯å¾ä¸åå»ºäºä¸ä¸ª dist ç®å½ï¼æ§è¡æåã\n\nant clean\n\n\n\næ¸é¤åå»ºç build å dist ç®å½ï¼æ§è¡æåã\n\nä¸ä¸ªç»è\n\nç»å¿çè¯»èï¼æ³å¿å·²ç»åç°ä¸ä¸ªé®é¢ââå¨æ§è¡ ant compile å ant dist å½ä»¤çæ¶åæåé¢çå½ä»¤ä¹æ§è¡äºãè¿æ¯ä¸ºä»ä¹å¢ï¼\n\nè¯·çæä¸ä¸ build.xml ä¸­çåå®¹ãæé¨å target æ ç­¾ä¸­å«æ depends å³é®å­ã\n\n\n\nè¿è¡¨æï¼å½åç target å¨æ§è¡æ¶éè¦ä¾èµå¶ä»ç targetï¼å¿é¡»åæ§è¡ä¾èµç targetï¼ç¶ååæ§è¡ã\n\n\n# å³é®åç´ \n\nAnt çæä»¶æä»¶é½æ¯ XML æ ¼å¼çãæ¯ä¸ªæä»¶æä»¶åå«ä¸ä¸ª project åç´ åè³å°ä¸ä¸ª targetã\n\ntarget åç´ å¯ä»¥åå«å¤ä¸ª task åç´ ã\n\n\n# Project åç´ \n\nproject åç´ æ¯æå»ºæä»¶çæ ¹åç´ ã\n\nä¸ä¸ª project åç´ å¯ä»¥æå¤ä¸ª target åç´ ï¼ä¸ä¸ª target åç´ å¯ä»¥æå¤ä¸ª taskã\n\nå¨ä¸èçä¾å­ä¸­ï¼project æ ç­¾éæä¸ä¸ªå±æ§ã\n\n<project name="MyProject" default="dist" basedir=".">\n\n\nname å±æ§ï¼æç¤º project åç´ çåå­ãä¾å­ä¸­çåå­å°±æ¯ MyProjectã\n\ndefault å±æ§ï¼æç¤ºè¿ä¸ª project é»è®¤æ§è¡ç targetãå¨æ¬æçä¾å­ä¸­ï¼é»è®¤æ§è¡ç target ä¸º distã\n\nå¦ææä»¬è¾å¥å½ä»¤ ant æ¶ï¼ä¸æå® target åæ°ï¼é»è®¤ä¼æ§è¡ dist è¿ä¸ª targetã\n\nbasedir å±æ§ï¼æå®æ ¹è·¯å¾çä½ç½®ãè¯¥å±æ§æ²¡ææå®æ¶ï¼ä½¿ç¨ Ant çæä»¶æä»¶çæå¨ç®å½ä½ä¸ºæ ¹ç®å½ã\n\n\n# Target åç´ \n\ntarget åç´ æ¯ task çå®¹å¨ï¼ä¹å°±æ¯ Ant çä¸ä¸ªåºæ¬æ§è¡ååã\n\nä»¥ä¸èä¾å­ä¸­ç compile æ¥ä¸¾ä¾ã\n\n<target name="compile" depends="init" description="compile the source " >\n    \x3c!-- Compile the java code from ${src} into ${build} --\x3e\n    <javac srcdir="${src}" destdir="${build}"/>\n</target>\n\n\nè¿ä¸ª target ä¸­åºç°äºå ä¸ªå±æ§ã\n\nname å±æ§ï¼æç¤º target åç´ çåç§°ã\n\nè¿ä¸ªå±æ§å¨ä¸ä¸ª project åç´ ä¸­å¿é¡»æ¯å¯ä¸çãè¿å¾å¥½çè§£ï¼å¦æåºç°éå¤ï¼Ant å°±ä¸ç¥éå·ä½è¯¥æ§è¡åªä¸ª target äºã\n\ndepends å±æ§ï¼æç¤ºä¾èµç targetï¼å½åç target å¿é¡»å¨ä¾èµç target ä¹åæ§è¡ã\n\ndescription å±æ§ï¼æ¯å³äº target çç®ç­è¯´æã\n\næ­¤å¤ï¼è¿æå¶ä»å ä¸ªæªåºç°å¨æå»ºæä»¶ä¸­çå±æ§ã\n\nif å±æ§ï¼éªè¯æå®çå±æ§æ¯å¦å­å¨ï¼è¥ä¸å­å¨ï¼æå¨ target å°ä¸ä¼è¢«æ§è¡ã\n\nunless å±æ§ï¼æ­£å¥½å if å±æ§ç¸åï¼éªè¯æå®çå±æ§æ¯å¦å­å¨ï¼è¥å­å¨ï¼æå¨ target å°ä¸ä¼è¢«æ§è¡ã****\n\nextensionOf å±æ§ï¼æ·»å å½å target å° extension-point ä¾èµåè¡¨ãââAnt1.8.0 æ°ç¹æ§ã\n\n> extension-point åç´ å target åç´ ååç±»ä¼¼ï¼é½å¯ä»¥æå®ä¾èµç targetãä½æ¯ä¸åçæ¯ï¼extension-point ä¸­ä¸è½åå«ä»»ä½ taskã\n\nè¯·çä»¥ä¸å®ä¾ï¼\n\n<target name="create-directory-layout">\n   ...\n</target>\n<extension-point name="ready-to-compile" depends="create-directory-layout"/>\n<target name="compile" depends="ready-to-compile">\n   ...\n</target>\n\n\nè°ç¨ target é¡ºåº: create-directory-layout --\x3e \'empty slot\' --\x3e compile\n\n<target name="generate-sources" extensionOf="ready-to-compile">\n   ...\n</target>\n\n\nè°ç¨ target é¡ºåº: create-directory-layout --\x3e generate-sources --\x3e compile\n\nonMissingExtensionPoint å±æ§ï¼å½æ æ³æ¾å°ä¸ä¸ª extension-point æ¶ï¼target å°è¯å»åçå¨ä½("fail", "warn", "ignore")ãââAnt1.8.2 æ°ç¹æ§\n\n\n# Task åç´ \n\ntask æ¯ä¸æ®µå¯ä»¥è¢«æ§è¡çä»£ç ã\n\nä¸ä¸ª task å¯ä»¥æå¤ä¸ªå±æ§ï¼ ä¸ä¸ªå±æ§å¯ä»¥åå«å¯¹ä¸ä¸ª property çå¼ç¨ã\n\ntask çéå¸¸ç»æä¸º\n\n<name attribute1="value1" attribute2="value2" ... />\n\n\nå¶ä¸­ï¼name æ¯ task çåå­ï¼ attributeN æ¯å±æ§åï¼ valueN æ¯è¿ä¸ªå±æ§çå¼ã\n\nè¿æ¯ä»¥ compile åä¸ºä¾å­ï¼\n\n<target name="compile" depends="init" description="compile the source " >\n    \x3c!-- Compile the java code from srcintosrcinto{build} --\x3e\n    <javac srcdir="${src}" destdir="${build}"/>\n</target>\n\n\nå¨ compile è¿ä¸ª target æ ç­¾ä¸­åå«äºä¸ä¸ªä»»å¡ã\n\nè¿ä¸ªä»»å¡çå¨ä½æ¯ï¼æ§è¡ JAVA ç¼è¯ï¼ç¼è¯ src ä¸çä»£ç ï¼å¹¶æç¼è¯çæçæä»¶æ¾å¨ build ç®å½ä¸­ã\n\n**å¸¸ç¨ task **\n\njavacï¼ç¨äºç¼è¯ä¸ä¸ªæèå¤ä¸ª Java æºæä»¶ï¼éå¸¸éè¦ srcdir å destdir ä¸¤ä¸ªå±æ§ï¼ç¨äºæå® Java æºæä»¶çä½ç½®åç¼è¯å class æä»¶çä¿å­ä½ç½®ã\n\n<javac srcdir="${src}" destdir="${build}" classpath="abc.jar" debug="on" source="1.7" />\n\n\njavaï¼ç¨äºè¿è¡æä¸ª Java ç±»ï¼éå¸¸éè¦ classname å±æ§ï¼ç¨äºæå®éè¦è¿è¡åªä¸ªç±»ã\n\n<java classname="test.Main">\n    <arg value="-h" />\n    <classpath>\n        <pathelement location="dist/test.jar" />\n    </classpath>\n</java>\n\n\njarï¼ç¨äºçæ JAR åï¼éå¸¸éè¦æå® destfile å±æ§ï¼ç¨äºæå®æåå»º JAR åçæä»¶åãé¤æ­¤ä¹å¤ï¼éå¸¸è¿åºæå®ä¸ä¸ªæä»¶éï¼è¡¨æéè¦å°åªäºæä»¶æåå° JAR åéã\n\n<jar jarfile="dist/lib/MyProjectâdist/lib/MyProjectâ{DSTAMP}.jar" basedir="${build}"/>\n\n\nechoï¼è¾åºæä¸ªå­ç¬¦ä¸²ã\n\n<echo message="Building to ${builddir}"/>\n<echo>You are using version ${java.version} of Java! This message spans two lines.</echo>\n\n\ncopyï¼ç¨äºå¤å¶æä»¶æè·¯å¾ã\n\n<copy todir="${builddir}/srccopy">\n    <fileset dir="${srcdir}">\n        <include name="**/*.java"/>\n    </fileset>\n    <filterset>\n        <filter token="VERSION" value="${app.version}"/>\n    </filterset>\n</copy>\n\n\ndeleteï¼ç¨äºå é¤æä»¶æè·¯å¾ã\n\n<copy todir="${builddir}/srccopy">\n    <fileset dir="${srcdir}">\n        <include name="**/*.java"/>\n    </fileset>\n    <filterset>\n        <filter token="VERSION" value="${app.version}"/>\n    </filterset>\n</copy>\n\n\nmkdirï¼ç¨äºåå»ºæä»¶å¤¹ã\n\n<mkdir dir="${dist}/lib" />\n\n\nmoveï¼ç¨æ·ç§»å¨æä»¶åè·¯å¾ã\n\n<move todir="some/new/dir">\n    <fileset dir="my/src/dir">\n        <include name="**/*.jar" />\n        <exclude name="**/ant.jar" />\n    </fileset>\n</move>\n\n\n\n# Property åç´ \n\nProperty æ¯å¯¹åæ°çå®ä¹ã\n\nproject çå±æ§å¯ä»¥éè¿ property åç´ æ¥è®¾å®ï¼ä¹å¯å¨ Ant ä¹å¤è®¾å®ãè¥è¦å¨å¤é¨å¼å¥ææä»¶ï¼ä¾å¦ build.properties æä»¶ï¼å¯ä»¥éè¿å¦ä¸åå®¹å°å¶å¼å¥ï¼<property file=â build.propertiesâ/>ã\n\nproperty åç´ å¯ç¨ä½ task çå±æ§å¼ãå¨ task ä¸­æ¯éè¿å°å±æ§åæ¾å¨â${âåâ}âä¹é´ï¼å¹¶æ¾å¨ task å±æ§å¼çä½ç½®æ¥å®ç°çã\n\nä¾å¦ complile ä¾å­ä¸­ï¼ä½¿ç¨äºåé¢å®ä¹ç src ä½ä¸ºæºç®å½ã\n\n<javac srcdir="${src}" destdir="${build}"/>\n\n\nAnt æä¾äºä¸äºåç½®çå±æ§ï¼å®è½å¾å°çç³»ç»å±æ§çåè¡¨ä¸ Java ææ¡£ä¸­ System.getPropertis()æ¹æ³å¾å°çå±æ§ä¸è´ï¼è¿äºç³»ç»å±æ§å¯åè sun ç½ç«çè¯´æã\n\n\n# extension-point åç´ \n\nå target åç´ ååç±»ä¼¼ï¼é½å¯ä»¥æå®ä¾èµç targetãä½æ¯ä¸åçæ¯ï¼extension-point ä¸­ä¸è½åå«ä»»ä½ taskã\n\nââAnt1.8.0 æ°å¢ç¹æ§ã\n\nå¨ target åç´ ä¸­çä¾å­éå·²æå°è¿ï¼ä¸åèµè¿°ã\n\n\n# åèèµæ\n\n * ant å®æ¹æå\n * http://www.blogjava.net/amigoxie/archive/2007/11/09/159413.html',normalizedContent:'# ant ç®ææç¨\n\n\n# ç®ä»\n\napache ant æ¯ä¸ä¸ªå°è½¯ä»¶ç¼è¯ãæµè¯ãé¨ç½²ç­æ­¥éª¤èç³»å¨ä¸èµ·å ä»¥èªå¨åçä¸ä¸ªå·¥å·ï¼å¤§å¤ç¨äº java ç¯å¢ä¸­çè½¯ä»¶å¼åãç± apache è½¯ä»¶åºéä¼ææä¾ã\n\nant æ¯çº¯ java è¯­è¨ç¼åçï¼æä»¥å·æå¾å¥½çè·¨å¹³å°æ§ã\n\n\n\n\n# ä¸è½½åå®è£\n\n\n# ä¸è½½\n\nant çå®æ¹ä¸è½½å°åï¼http://ant.apache.org/bindownload.cgi\n\nè¿å¥é¡µé¢åï¼å¨ä¸å¾ççº¢è²æ¹æ¡ä¸­å¯ä»¥ä¸è½½ææ°çæ¬ãç¬èä¸è½½ççæ¬æ¯ apache-ant-1.9.4ã\n\n\n\n\n# éç½®ç¯å¢åé\n\néç½®ç¯å¢åéï¼æççµè -> å±æ§ -> é«çº§ -> ç¯å¢åéï¼ã\n\nè®¾ç½® ant ç¯å¢åéï¼\n\nant_home c:/ apache-ant-1.9.4\n\n\n\n**path ** c:/ apache-ant-1.9.4/bin\n\n\n\nclasspath c:/apache-ant-1.9.4/lib\n\n\n\n\n# éªè¯\n\nç¹å» å¼å§ -> è¿è¡ -> è¾å¥ cmd\n\næ§è¡æå»ºæä»¶\n\nè¾å¥å¦ä¸å½ä»¤ï¼ant\n\nå¦æåºç°å¦ä¸åå®¹ï¼è¯´æå®è£æåï¼\n\n> buildfile: build.xml does not exist! build failed\n\næ³¨æï¼å ä¸º ant é»è®¤è¿è¡ build.xml æä»¶ï¼è¿ä¸ªæä»¶éè¦æä»¬åå»ºã\n\nå¦æä¸æ³å½åä¸º build.xmlï¼è¿è¡æ¶å¯ä»¥ä½¿ç¨ ant -buildfile test.xml å½ä»¤ææè¦è¿è¡çæå»ºæä»¶ã\n\næ¥ççæ¬ä¿¡æ¯\n\nè¾å¥ ant -versionï¼å¯ä»¥æ¥ççæ¬ä¿¡æ¯ã\n\n\n\nä½å¦æåºç° \'ant\' ä¸æ¯åé¨æå¤é¨å½ä»¤ï¼ä¹ä¸æ¯å¯è¿è¡çç¨åºææ¹å¤çæä»¶ï¼è¯´æå®è£å¤±è´¥ï¼ï¼å¯ä»¥éå¤åè¿°æ­¥éª¤ï¼ç´è³å®è£æåãï¼\n\n\n# ä¾å­\n\nå¨å®è£åéç½®æååï¼æä»¬å°±å¯ä»¥ä½¿ç¨ ant äºã\n\nä¸ºäºè®©è¯»èå¯¹ ant æä¸ä¸ªç´è§çè®¤è¯ï¼é¦åä»¥ ant å®æ¹æåä¸çä¸ä¸ªç®åä¾å­åä¸ä¸ªè¯´æã\n\nä»¥ä¸æ¯ä¸ä¸ª build.xml æä»¶çåå®¹ï¼\n\n<project name="myproject" default="dist" basedir=".">\n    <description>\n        simple example build file\n    </description>\n  \x3c!-- set global properties for this build --\x3e\n  <property name="src" location="src"/>\n  <property name="build" location="build"/>\n  <property name="dist"  location="dist"/>\n\n  <target name="init">\n    \x3c!-- create the time stamp --\x3e\n    <tstamp/>\n    \x3c!-- create the build directory structure used by compile --\x3e\n    <mkdir dir="${build}"/>\n  </target>\n\n  <target name="compile" depends="init"\n        description="compile the source " >\n    \x3c!-- compile the java code from ${src} into ${build} --\x3e\n    <javac srcdir="${src}" destdir="${build}"/>\n  </target>\n\n  <target name="dist" depends="compile"\n        description="generate the distribution" >\n    \x3c!-- create the distribution directory --\x3e\n    <mkdir dir="${dist}/lib"/>\n\n    \x3c!-- put everything in ${build} into the myproject-${dstamp}.jar file --\x3e\n    <jar jarfile="${dist}/lib/myproject-${dstamp}.jar" basedir="${build}"/>\n  </target>\n\n  <target name="clean"\n        description="clean up" >\n    \x3c!-- delete the ${build} and ${dist} directory trees --\x3e\n    <delete dir="${build}"/>\n    <delete dir="${dist}"/>\n  </target>\n</project>\n\n\nå¨è¿ä¸ª xml æä»¶ä¸­ï¼æå ä¸ª target æ ç­¾ï¼æ¯ä¸ª target å¯¹åºä¸ä¸ªæ§è¡ç®æ ã\n\næä»¬å°è¿ä¸ª build.xml æ¾å¨ d:\\temp\\ant_test è·¯å¾ä¸ï¼ç¶åå¨ dos çé¢ä¸è¿è¡æµè¯ã\n\nant init\n\n\n\nå¨ d:\\temp\\ant_test è·¯å¾ä¸åå»ºäºä¸ä¸ª build ç®å½ï¼æ§è¡æåã\n\nant compile\n\n\n\næç¤ºéè¯¯ï¼åæ¥æ¯å¨ build.xml çæå¨ç®å½ä¸æ¾ä¸å° src ç®å½ãå¥½çï¼æä»¬ç´æ¥åå»ºä¸ä¸ª src ç®å½ï¼ç¶ååæ¬¡å°è¯ãè¿æ¬¡ï¼æ§è¡æåã\n\n\n\n**ant dist **\n\n\n\nå¨ d:\\temp\\ant_test è·¯å¾ä¸åå»ºäºä¸ä¸ª dist ç®å½ï¼æ§è¡æåã\n\nant clean\n\n\n\næ¸é¤åå»ºç build å dist ç®å½ï¼æ§è¡æåã\n\nä¸ä¸ªç»è\n\nç»å¿çè¯»èï¼æ³å¿å·²ç»åç°ä¸ä¸ªé®é¢ââå¨æ§è¡ ant compile å ant dist å½ä»¤çæ¶åæåé¢çå½ä»¤ä¹æ§è¡äºãè¿æ¯ä¸ºä»ä¹å¢ï¼\n\nè¯·çæä¸ä¸ build.xml ä¸­çåå®¹ãæé¨å target æ ç­¾ä¸­å«æ depends å³é®å­ã\n\n\n\nè¿è¡¨æï¼å½åç target å¨æ§è¡æ¶éè¦ä¾èµå¶ä»ç targetï¼å¿é¡»åæ§è¡ä¾èµç targetï¼ç¶ååæ§è¡ã\n\n\n# å³é®åç´ \n\nant çæä»¶æä»¶é½æ¯ xml æ ¼å¼çãæ¯ä¸ªæä»¶æä»¶åå«ä¸ä¸ª project åç´ åè³å°ä¸ä¸ª targetã\n\ntarget åç´ å¯ä»¥åå«å¤ä¸ª task åç´ ã\n\n\n# project åç´ \n\nproject åç´ æ¯æå»ºæä»¶çæ ¹åç´ ã\n\nä¸ä¸ª project åç´ å¯ä»¥æå¤ä¸ª target åç´ ï¼ä¸ä¸ª target åç´ å¯ä»¥æå¤ä¸ª taskã\n\nå¨ä¸èçä¾å­ä¸­ï¼project æ ç­¾éæä¸ä¸ªå±æ§ã\n\n<project name="myproject" default="dist" basedir=".">\n\n\nname å±æ§ï¼æç¤º project åç´ çåå­ãä¾å­ä¸­çåå­å°±æ¯ myprojectã\n\ndefault å±æ§ï¼æç¤ºè¿ä¸ª project é»è®¤æ§è¡ç targetãå¨æ¬æçä¾å­ä¸­ï¼é»è®¤æ§è¡ç target ä¸º distã\n\nå¦ææä»¬è¾å¥å½ä»¤ ant æ¶ï¼ä¸æå® target åæ°ï¼é»è®¤ä¼æ§è¡ dist è¿ä¸ª targetã\n\nbasedir å±æ§ï¼æå®æ ¹è·¯å¾çä½ç½®ãè¯¥å±æ§æ²¡ææå®æ¶ï¼ä½¿ç¨ ant çæä»¶æä»¶çæå¨ç®å½ä½ä¸ºæ ¹ç®å½ã\n\n\n# target åç´ \n\ntarget åç´ æ¯ task çå®¹å¨ï¼ä¹å°±æ¯ ant çä¸ä¸ªåºæ¬æ§è¡ååã\n\nä»¥ä¸èä¾å­ä¸­ç compile æ¥ä¸¾ä¾ã\n\n<target name="compile" depends="init" description="compile the source " >\n    \x3c!-- compile the java code from ${src} into ${build} --\x3e\n    <javac srcdir="${src}" destdir="${build}"/>\n</target>\n\n\nè¿ä¸ª target ä¸­åºç°äºå ä¸ªå±æ§ã\n\nname å±æ§ï¼æç¤º target åç´ çåç§°ã\n\nè¿ä¸ªå±æ§å¨ä¸ä¸ª project åç´ ä¸­å¿é¡»æ¯å¯ä¸çãè¿å¾å¥½çè§£ï¼å¦æåºç°éå¤ï¼ant å°±ä¸ç¥éå·ä½è¯¥æ§è¡åªä¸ª target äºã\n\ndepends å±æ§ï¼æç¤ºä¾èµç targetï¼å½åç target å¿é¡»å¨ä¾èµç target ä¹åæ§è¡ã\n\ndescription å±æ§ï¼æ¯å³äº target çç®ç­è¯´æã\n\næ­¤å¤ï¼è¿æå¶ä»å ä¸ªæªåºç°å¨æå»ºæä»¶ä¸­çå±æ§ã\n\nif å±æ§ï¼éªè¯æå®çå±æ§æ¯å¦å­å¨ï¼è¥ä¸å­å¨ï¼æå¨ target å°ä¸ä¼è¢«æ§è¡ã\n\nunless å±æ§ï¼æ­£å¥½å if å±æ§ç¸åï¼éªè¯æå®çå±æ§æ¯å¦å­å¨ï¼è¥å­å¨ï¼æå¨ target å°ä¸ä¼è¢«æ§è¡ã****\n\nextensionof å±æ§ï¼æ·»å å½å target å° extension-point ä¾èµåè¡¨ãââant1.8.0 æ°ç¹æ§ã\n\n> extension-point åç´ å target åç´ ååç±»ä¼¼ï¼é½å¯ä»¥æå®ä¾èµç targetãä½æ¯ä¸åçæ¯ï¼extension-point ä¸­ä¸è½åå«ä»»ä½ taskã\n\nè¯·çä»¥ä¸å®ä¾ï¼\n\n<target name="create-directory-layout">\n   ...\n</target>\n<extension-point name="ready-to-compile" depends="create-directory-layout"/>\n<target name="compile" depends="ready-to-compile">\n   ...\n</target>\n\n\nè°ç¨ target é¡ºåº: create-directory-layout --\x3e \'empty slot\' --\x3e compile\n\n<target name="generate-sources" extensionof="ready-to-compile">\n   ...\n</target>\n\n\nè°ç¨ target é¡ºåº: create-directory-layout --\x3e generate-sources --\x3e compile\n\nonmissingextensionpoint å±æ§ï¼å½æ æ³æ¾å°ä¸ä¸ª extension-point æ¶ï¼target å°è¯å»åçå¨ä½("fail", "warn", "ignore")ãââant1.8.2 æ°ç¹æ§\n\n\n# task åç´ \n\ntask æ¯ä¸æ®µå¯ä»¥è¢«æ§è¡çä»£ç ã\n\nä¸ä¸ª task å¯ä»¥æå¤ä¸ªå±æ§ï¼ ä¸ä¸ªå±æ§å¯ä»¥åå«å¯¹ä¸ä¸ª property çå¼ç¨ã\n\ntask çéå¸¸ç»æä¸º\n\n<name attribute1="value1" attribute2="value2" ... />\n\n\nå¶ä¸­ï¼name æ¯ task çåå­ï¼ attributen æ¯å±æ§åï¼ valuen æ¯è¿ä¸ªå±æ§çå¼ã\n\nè¿æ¯ä»¥ compile åä¸ºä¾å­ï¼\n\n<target name="compile" depends="init" description="compile the source " >\n    \x3c!-- compile the java code from srcintosrcinto{build} --\x3e\n    <javac srcdir="${src}" destdir="${build}"/>\n</target>\n\n\nå¨ compile è¿ä¸ª target æ ç­¾ä¸­åå«äºä¸ä¸ªä»»å¡ã\n\nè¿ä¸ªä»»å¡çå¨ä½æ¯ï¼æ§è¡ java ç¼è¯ï¼ç¼è¯ src ä¸çä»£ç ï¼å¹¶æç¼è¯çæçæä»¶æ¾å¨ build ç®å½ä¸­ã\n\n**å¸¸ç¨ task **\n\njavacï¼ç¨äºç¼è¯ä¸ä¸ªæèå¤ä¸ª java æºæä»¶ï¼éå¸¸éè¦ srcdir å destdir ä¸¤ä¸ªå±æ§ï¼ç¨äºæå® java æºæä»¶çä½ç½®åç¼è¯å class æä»¶çä¿å­ä½ç½®ã\n\n<javac srcdir="${src}" destdir="${build}" classpath="abc.jar" debug="on" source="1.7" />\n\n\njavaï¼ç¨äºè¿è¡æä¸ª java ç±»ï¼éå¸¸éè¦ classname å±æ§ï¼ç¨äºæå®éè¦è¿è¡åªä¸ªç±»ã\n\n<java classname="test.main">\n    <arg value="-h" />\n    <classpath>\n        <pathelement location="dist/test.jar" />\n    </classpath>\n</java>\n\n\njarï¼ç¨äºçæ jar åï¼éå¸¸éè¦æå® destfile å±æ§ï¼ç¨äºæå®æåå»º jar åçæä»¶åãé¤æ­¤ä¹å¤ï¼éå¸¸è¿åºæå®ä¸ä¸ªæä»¶éï¼è¡¨æéè¦å°åªäºæä»¶æåå° jar åéã\n\n<jar jarfile="dist/lib/myprojectâdist/lib/myprojectâ{dstamp}.jar" basedir="${build}"/>\n\n\nechoï¼è¾åºæä¸ªå­ç¬¦ä¸²ã\n\n<echo message="building to ${builddir}"/>\n<echo>you are using version ${java.version} of java! this message spans two lines.</echo>\n\n\ncopyï¼ç¨äºå¤å¶æä»¶æè·¯å¾ã\n\n<copy todir="${builddir}/srccopy">\n    <fileset dir="${srcdir}">\n        <include name="**/*.java"/>\n    </fileset>\n    <filterset>\n        <filter token="version" value="${app.version}"/>\n    </filterset>\n</copy>\n\n\ndeleteï¼ç¨äºå é¤æä»¶æè·¯å¾ã\n\n<copy todir="${builddir}/srccopy">\n    <fileset dir="${srcdir}">\n        <include name="**/*.java"/>\n    </fileset>\n    <filterset>\n        <filter token="version" value="${app.version}"/>\n    </filterset>\n</copy>\n\n\nmkdirï¼ç¨äºåå»ºæä»¶å¤¹ã\n\n<mkdir dir="${dist}/lib" />\n\n\nmoveï¼ç¨æ·ç§»å¨æä»¶åè·¯å¾ã\n\n<move todir="some/new/dir">\n    <fileset dir="my/src/dir">\n        <include name="**/*.jar" />\n        <exclude name="**/ant.jar" />\n    </fileset>\n</move>\n\n\n\n# property åç´ \n\nproperty æ¯å¯¹åæ°çå®ä¹ã\n\nproject çå±æ§å¯ä»¥éè¿ property åç´ æ¥è®¾å®ï¼ä¹å¯å¨ ant ä¹å¤è®¾å®ãè¥è¦å¨å¤é¨å¼å¥ææä»¶ï¼ä¾å¦ build.properties æä»¶ï¼å¯ä»¥éè¿å¦ä¸åå®¹å°å¶å¼å¥ï¼<property file=â build.propertiesâ/>ã\n\nproperty åç´ å¯ç¨ä½ task çå±æ§å¼ãå¨ task ä¸­æ¯éè¿å°å±æ§åæ¾å¨â${âåâ}âä¹é´ï¼å¹¶æ¾å¨ task å±æ§å¼çä½ç½®æ¥å®ç°çã\n\nä¾å¦ complile ä¾å­ä¸­ï¼ä½¿ç¨äºåé¢å®ä¹ç src ä½ä¸ºæºç®å½ã\n\n<javac srcdir="${src}" destdir="${build}"/>\n\n\nant æä¾äºä¸äºåç½®çå±æ§ï¼å®è½å¾å°çç³»ç»å±æ§çåè¡¨ä¸ java ææ¡£ä¸­ system.getpropertis()æ¹æ³å¾å°çå±æ§ä¸è´ï¼è¿äºç³»ç»å±æ§å¯åè sun ç½ç«çè¯´æã\n\n\n# extension-point åç´ \n\nå target åç´ ååç±»ä¼¼ï¼é½å¯ä»¥æå®ä¾èµç targetãä½æ¯ä¸åçæ¯ï¼extension-point ä¸­ä¸è½åå«ä»»ä½ taskã\n\nââant1.8.0 æ°å¢ç¹æ§ã\n\nå¨ target åç´ ä¸­çä¾å­éå·²æå°è¿ï¼ä¸åèµè¿°ã\n\n\n# åèèµæ\n\n * ant å®æ¹æå\n * http://www.blogjava.net/amigoxie/archive/2007/11/09/159413.html',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java æå»º",frontmatter:{title:"Java æå»º",categories:["ç¼ç¨","Java","è½¯ä»¶","æå»º"],tags:["Java","æå»º"],abbrlink:"7ebcc307",date:"2020-08-04T15:20:54.000Z",hidden:!0,permalink:"/pages/95388e/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/01.%E6%9E%84%E5%BB%BA/",relativePath:"11.è½¯ä»¶/01.æå»º/README.md",key:"v-d7044cd0",path:"/pages/95388e/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:245},{level:3,title:"Maven",slug:"maven",normalizedTitle:"maven",charIndex:85},{level:3,title:"Ant",slug:"ant",normalizedTitle:"ant",charIndex:177},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:418},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:505}],headersStr:"ð åå®¹ Maven Ant ð èµæ ðª ä¼ é",content:"# Java æå»º\n\n> Java é¡¹ç®éè¦éè¿ æå»ºå·¥å· æ¥ç®¡çé¡¹ç®ä¾èµï¼å®æç¼è¯ãæåãåå¸ãçæ JavaDoc ç­ä»»å¡ã\n> \n>  * ç®åæä¸»æµçæå»ºå·¥å·æ¯ Mavenï¼å®çåè½éå¸¸å¼ºå¤§ã\n>  * Gradle å·ç§°æ¯è¦æ¿ä»£ Maven ç­æä»¶å·¥å·ï¼å®ççæ¬ç®¡çç¡®å®ç®æ´ï¼ä½æ¯éè¦å­¦ä¹  Groovyï¼å­¦ä¹ ææ¬æ¯ Maven é«ã\n>  * Ant åè½æ¯ Maven å Gradle è¦å¼±ï¼ç°ä»£ Java é¡¹ç®åºæ¬ä¸ç¨äºï¼ä½ä¹æä¸äºä¼ ç»ç Java é¡¹ç®è¿å¨ä½¿ç¨ã\n\n\n# ð åå®¹\n\n\n# Maven\n\n * Maven å¿«éå¥é¨\n * Maven æç¨ä¹ pom.xml è¯¦è§£\n * Maven æç¨ä¹ settings.xml è¯¦è§£\n * Maven å®æé®é¢åæä½³å®è·µ\n * Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n * Maven æä»¶ä¹ä»£ç æ£æ¥\n\n\n# Ant\n\n * Ant ç®ææç¨\n\n\n# ð èµæ\n\n * å®ç½\n   * Maven Github\n   * Maven å®æ¹ææ¡£\n   * Ant å®æ¹æå\n * ä¹¦ç±\n   * ãMaven å®æã\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java æå»º\n\n> java é¡¹ç®éè¦éè¿ æå»ºå·¥å· æ¥ç®¡çé¡¹ç®ä¾èµï¼å®æç¼è¯ãæåãåå¸ãçæ javadoc ç­ä»»å¡ã\n> \n>  * ç®åæä¸»æµçæå»ºå·¥å·æ¯ mavenï¼å®çåè½éå¸¸å¼ºå¤§ã\n>  * gradle å·ç§°æ¯è¦æ¿ä»£ maven ç­æä»¶å·¥å·ï¼å®ççæ¬ç®¡çç¡®å®ç®æ´ï¼ä½æ¯éè¦å­¦ä¹  groovyï¼å­¦ä¹ ææ¬æ¯ maven é«ã\n>  * ant åè½æ¯ maven å gradle è¦å¼±ï¼ç°ä»£ java é¡¹ç®åºæ¬ä¸ç¨äºï¼ä½ä¹æä¸äºä¼ ç»ç java é¡¹ç®è¿å¨ä½¿ç¨ã\n\n\n# ð åå®¹\n\n\n# maven\n\n * maven å¿«éå¥é¨\n * maven æç¨ä¹ pom.xml è¯¦è§£\n * maven æç¨ä¹ settings.xml è¯¦è§£\n * maven å®æé®é¢åæä½³å®è·µ\n * maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n * maven æä»¶ä¹ä»£ç æ£æ¥\n\n\n# ant\n\n * ant ç®ææç¨\n\n\n# ð èµæ\n\n * å®ç½\n   * maven github\n   * maven å®æ¹ææ¡£\n   * ant å®æ¹æå\n * ä¹¦ç±\n   * ãmaven å®æã\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Intellij IDEA å¿«éå¥é¨",frontmatter:{title:"Intellij IDEA å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","IDE"],tags:["Java","IDE"],abbrlink:"a688dbc5",date:"2019-11-29T18:10:14.000Z",permalink:"/pages/ea83ee/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/02.IDE/01.Intellij.html",relativePath:"11.è½¯ä»¶/02.IDE/01.Intellij.md",key:"v-09c4ff2e",path:"/pages/ea83ee/",headers:[{level:2,title:"å¿«æ·é®",slug:"å¿«æ·é®",normalizedTitle:"å¿«æ·é®",charIndex:25},{level:3,title:"æ ¸å¿å¿«æ·é®",slug:"æ ¸å¿å¿«æ·é®",normalizedTitle:"æ ¸å¿å¿«æ·é®",charIndex:33},{level:3,title:"å¿«æ·é®åç±»",slug:"å¿«æ·é®åç±»",normalizedTitle:"å¿«æ·é®åç±»",charIndex:1634},{level:4,title:"Tradition",slug:"tradition",normalizedTitle:"tradition",charIndex:1643},{level:4,title:"Editing",slug:"editing",normalizedTitle:"editing",charIndex:1902},{level:4,title:"Search/Replace",slug:"search-replace",normalizedTitle:"search/replace",charIndex:3944},{level:4,title:"Usage Search",slug:"usage-search",normalizedTitle:"usage search",charIndex:4269},{level:4,title:"Compile and Run",slug:"compile-and-run",normalizedTitle:"compile and run",charIndex:4452},{level:4,title:"Debugging",slug:"debugging",normalizedTitle:"debugging",charIndex:4691},{level:4,title:"Navigation",slug:"navigation",normalizedTitle:"navigation",charIndex:5272},{level:4,title:"Refactoring",slug:"refactoring",normalizedTitle:"refactoring",charIndex:6830},{level:4,title:"VCS/Local History",slug:"vcs-local-history",normalizedTitle:"vcs/local history",charIndex:6951},{level:4,title:"Live Templates",slug:"live-templates",normalizedTitle:"live templates",charIndex:7187},{level:4,title:"General",slug:"general",normalizedTitle:"general",charIndex:7299},{level:3,title:"Intellij IDEA å®æ¹å¿«æ·é®è¡¨",slug:"intellij-idea-å®æ¹å¿«æ·é®è¡¨",normalizedTitle:"intellij idea å®æ¹å¿«æ·é®è¡¨",charIndex:7675},{level:2,title:"æä»¶",slug:"æä»¶",normalizedTitle:"æä»¶",charIndex:7702},{level:2,title:"ä¸ªæ§å",slug:"ä¸ªæ§å",normalizedTitle:"ä¸ªæ§å",charIndex:8137},{level:3,title:"é¢è²ä¸»é¢",slug:"é¢è²ä¸»é¢",normalizedTitle:"é¢è²ä¸»é¢",charIndex:8145},{level:2,title:"ç ´è§£",slug:"ç ´è§£",normalizedTitle:"ç ´è§£",charIndex:8202},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:8753}],headersStr:"å¿«æ·é® æ ¸å¿å¿«æ·é® å¿«æ·é®åç±» Tradition Editing Search/Replace Usage Search Compile and Run Debugging Navigation Refactoring VCS/Local History Live Templates General Intellij IDEA å®æ¹å¿«æ·é®è¡¨ æä»¶ ä¸ªæ§å é¢è²ä¸»é¢ ç ´è§£ åèèµæ",content:"# Intellij IDEA å¿«éå¥é¨\n\n\n# å¿«æ·é®\n\n\n# æ ¸å¿å¿«æ·é®\n\nIntelliJ IDEA ä½ä¸ºä¸ä¸ªä»¥å¿«æ·é®ä¸ºä¸­å¿ç IDEï¼ä¸ºå¤§å¤æ°æä½å»ºè®®äºé®çå¿«æ·é®ãå¨è¿ä¸ªä¸»é¢ä¸­ï¼æ¨å¯ä»¥æ¾å°æä¸å¯ç¼ºå°çåè¡¨ï¼ä½¿ IntelliJ IDEA è½»æ¾å®ç°ç¬¬ä¸æ­¥ã\n\næ ¸å¿å¿«æ·é®è¡¨ï¼\n\næä½                                                    å¿«æ·é®\næ ¹æ®åç§°æ¥æ¾æä½                                              Ctrl+Shift+A\næ¾ç¤ºå¯ç¨ æå¾æä½ åè¡¨                                          Alt+Enter\nåæ¢è§å¾ (Project,Structure, etc.).                       Alt+F1\nåæ¢å·¥å·çªå£åå¨ç¼è¾å¨ä¸­æå¼çæä»¶                                     Ctrl+Tab\næ¾ç¤º å¯¼èªæ .                                               Alt+Home\næå¥ä»£ç æ¨¡æ¿.                                               Ctrl+J\nå¨å¨å´æå¥ä»£ç æ¨¡æ¿.                                            Ctrl+Alt+J\nEdit an item from the Project or another tree view.   F4\næ³¨é                                                    Ctrl+/ Ctrl+Shift+/\næ ¹æ®åç§°æ¥æ¾ç±»ææä»¶.                                           Ctrl+N Ctrl+Shift+N\næ·è´å½åè¡ææå®çè¡.                                           Ctrl+D\nå¢å æåå°éä¸­çè¡¨è¾¾å¼.                                          Ctrl+W and Ctrl+Shift+W\nå¨å½åæä»¶æ¥æ¾ææ¿æ¢.                                           Ctrl+F Ctrl+R\nå¨é¡¹ç®ä¸­ææå®çç®å½ä¸­æ¥æ¾ææ¿æ¢                                      Ctrl+Shift+F Ctrl+Shift+R\nå¨å±æç´¢                                                  åå» Shift\nå¿«éæ¥çéä¸­å¯¹è±¡çå¼ç¨.                                          Ctrl+Shift+F7\nå±å¼ææå ç¼è¾å¨ä¸­çä»£ç å.                                        Ctrl+NumPad Plus Ctrl+NumPad -\nè°ç¨ä»£ç å®æ.                                               Ctrl+Space\næºè½å£°æå®æ.                                               Ctrl+Shift+Enter\næºè½è¡¥å¨ä»£ç                                                 Ctrl+Shift+Space\næ¾ç¤ºå¯ç¨çéææ¹æ³åè¡¨                                           Ctrl+Shift+Alt+T\n\n\n# å¿«æ·é®åç±»\n\n# Tradition\n\nå¿«æ·é®                ä»ç»\nCtrl + Z           æ¤é\nCtrl + Shift + Z   åæ¶æ¤é\nCtrl + X           åªå\nCtrl + C           å¤å¶\nCtrl + S           ä¿å­\nTab                ç¼©è¿\nShift + Tab        åæ¶ç¼©è¿\nShift + Home/End   éä¸­åæ å°å½åè¡å¤´ä½ç½®/è¡å°¾ä½ç½®\nCtrl + Home/End    è·³å°æä»¶å¤´/æä»¶å°¾\n\n# Editing\n\nå¿«æ·é®                      ä»ç»\nCtrl + Space             åºç¡ä»£ç è¡¥å¨ï¼é»è®¤å¨ Windows ç³»ç»ä¸è¢«è¾å¥æ³å ç¨ï¼éè¦è¿è¡ä¿®æ¹ï¼å»ºè®®ä¿®æ¹ä¸º Ctrl + éå·ï¼å¿å¤ï¼\nCtrl + Alt + Space       ç±»åèªå¨å®æ\nCtrl + Shift + Enter     èªå¨ç»æä»£ç ï¼è¡æ«èªå¨æ·»å åå·ï¼å¿å¤ï¼\nCtrl + P                 æ¹æ³åæ°æç¤ºæ¾ç¤º\nCtrl + Q                 åæ æå¨çåé/ç±»å/æ¹æ³åç­ä¸é¢ï¼ä¹å¯ä»¥å¨æç¤ºè¡¥åçæ¶åæï¼ï¼æ¾ç¤ºææ¡£åå®¹\nShift + F1               å¦ææå¤é¨ææ¡£å¯ä»¥è¿æ¥å¤é¨ææ¡£\nCtrl + F1                å¨åæ æå¨çéè¯¯ä»£ç å¤æ¾ç¤ºéè¯¯ä¿¡æ¯ï¼å¿å¤ï¼\nAlt + Insert             ä»£ç èªå¨çæï¼å¦çæå¯¹è±¡ç set/get æ¹æ³ï¼æé å½æ°ï¼toString() ç­ï¼å¿å¤ï¼\nCtrl + O                 éæ©å¯éåçæ¹æ³\nCtrl + I                 éæ©å¯ç»§æ¿çæ¹æ³\nCtrl + Alt + T           å¯¹éä¸­çä»£ç å¼¹åºç¯ç»éé¡¹å¼¹åºå±ï¼å¿å¤ï¼\nCtrl + /                 æ³¨éåæ æå¨è¡ä»£ç ï¼ä¼æ ¹æ®å½åä¸åæä»¶ç±»åä½¿ç¨ä¸åçæ³¨éç¬¦å·ï¼å¿å¤ï¼\nCtrl + Shift + /         ä»£ç åæ³¨éï¼å¿å¤ï¼\nCtrl + W                 éè¿å¼éæ©ä»£ç åãå¯éä¸­åæ æå¨çåè¯ææ®µè½ï¼è¿ç»­æä¼å¨åæéä¸­çåºç¡ä¸åæ©å±éä¸­èå´ï¼å¿å¤ï¼\nCtrl + Shift + W         éè¿å¼åæ¶éæ©ä»£ç åãå¯éä¸­åæ æå¨çåè¯ææ®µè½ï¼è¿ç»­æä¼å¨åæéä¸­çåºç¡ä¸åæ©å±åæ¶éä¸­èå´ï¼å¿å¤ï¼\nAlt + Q                  å¼¹åºä¸ä¸ªæç¤ºï¼æ¾ç¤ºå½åç±»çå£°æ/ä¸ä¸æä¿¡æ¯\nAlt + Enter              IntelliJ IDEA æ ¹æ®åæ æå¨é®é¢ï¼æä¾å¿«éä¿®å¤éæ©ï¼åæ æ¾å¨çä½ç½®ä¸åæç¤ºçç»æä¹ä¸åï¼å¿å¤ï¼\nCtrl + Alt + L           æ ¼å¼åä»£ç ï¼å¯ä»¥å¯¹å½åæä»¶åæ´ä¸ªåç®å½ä½¿ç¨ï¼å¿å¤ï¼\nCtrl + Alt + O           ä¼åå¯¼å¥çç±»ï¼å¯ä»¥å¯¹å½åæä»¶åæ´ä¸ªåç®å½ä½¿ç¨ï¼å¿å¤ï¼\nCtrl + Alt + I           åæ æå¨è¡ æ éä¸­é¨åè¿è¡èªå¨ä»£ç ç¼©è¿ï¼æç¹ç±»ä¼¼æ ¼å¼å\nCtrl + Shift + C         å¤å¶å½åæä»¶ç£çè·¯å¾å°åªè´´æ¿ï¼å¿å¤ï¼\nCtrl + Shift + V         å¼¹åºç¼å­çæè¿æ·è´çåå®¹ç®¡çå¨å¼¹åºå±\nCtrl + Alt + Shift + C   å¤å¶åèä¿¡æ¯\nCtrl + Alt + Shift + V   æ æ ¼å¼é»è´´ï¼å¿å¤ï¼\nCtrl + D                 å¤å¶åæ æå¨è¡ æ å¤å¶éæ©åå®¹ï¼å¹¶æå¤å¶åå®¹æå¥åæ ä½ç½®ä¸é¢ï¼å¿å¤ï¼\nCtrl + Y                 å é¤åæ æå¨è¡ æ å é¤éä¸­çè¡ï¼å¿å¤ï¼\nCtrl + Shift + J         èªå¨å°ä¸ä¸è¡åå¹¶å°å½åè¡æ«å°¾ï¼å¿å¤ï¼\nShift + Enter            å¼å§æ°ä¸è¡ãåæ æå¨è¡ä¸ç©ºåºä¸è¡ï¼åæ å®ä½å°æ°è¡ä½ç½®ï¼å¿å¤ï¼\nCtrl + Shift + U         å¯¹éä¸­çä»£ç è¿è¡å¤§/å°åè½®æµè½¬æ¢ï¼å¿å¤ï¼\nCtrl + Shift + ]/[       éä¸­ä»åæ æå¨ä½ç½®å°å®çåºé¨/é¡¶é¨çä¸­æ¬å·ä½ç½®ï¼å¿å¤ï¼\nCtrl + Delete            å é¤åæ åé¢çåè¯ææ¯ä¸­æå¥ï¼å¿å¤ï¼\nCtrl + BackSpace         å é¤åæ åé¢çåè¯ææ¯ä¸­æå¥ï¼å¿å¤ï¼\nCtrl + +/-               å±å¼/æå ä»£ç å\nCtrl + Shift + +/-       å±å¼/æå ææä»£ç ï¼å¿å¤ï¼\nCtrl + F4                å³é­å½åç¼è¾æä»¶\nCtrl + Shift + Up/Down   åæ æ¾å¨æ¹æ³åä¸ï¼å°æ¹æ³ç§»å¨å°ä¸ä¸ä¸ª/ä¸ä¸ä¸ªæ¹æ³åé¢ï¼è°æ´æ¹æ³æåºï¼å¿å¤ï¼\nAlt + Shift + Up/Down    ç§»å¨åæ æå¨è¡åä¸ç§»å¨/åä¸ç§»å¨ï¼å¿å¤ï¼\nCtrl + Shift + å·¦é®åå»      æåæ æ¾å¨æä¸ªç±»åéä¸ï¼ææ­¤å¿«æ·é®å¯ä»¥ç´æ¥å®ä½å°è¯¥ç±»ä¸­ï¼å¿å¤ï¼\nAlt + Shift + å·¦é®åå»       éæ©è¢«åå»çåè¯/ä¸­æå¥ï¼æä½ä¸æ¾ï¼å¯ä»¥åæ¶éæ©å¶ä»åè¯/ä¸­æå¥ï¼å¿å¤ï¼\nCtrl + Shift + T         å¯¹å½åç±»çæååæµè¯ç±»ï¼å¦æå·²ç»å­å¨çååæµè¯ç±»åå¯ä»¥è¿è¡éæ©ï¼å¿å¤ï¼\n\n# Search/Replace\n\nå¿«æ·é®                ä»ç»\nDouble Shift       å¼¹åº Search Everywhere å¼¹åºå±\nF3                 å¨æ¥æ¾æ¨¡å¼ä¸ï¼å®ä½å°ä¸ä¸ä¸ªå¹éå¤\nShift + F3         å¨æ¥æ¾æ¨¡å¼ä¸ï¼æ¥æ¾å¹éä¸ä¸ä¸ª\nCtrl + F           å¨å½åæä»¶è¿è¡ææ¬æ¥æ¾ï¼å¿å¤ï¼\nCtrl + R           å¨å½åæä»¶è¿è¡ææ¬æ¿æ¢ï¼å¿å¤ï¼\nCtrl + Shift + F   æ ¹æ®è¾å¥åå®¹æ¥æ¾æ´ä¸ªé¡¹ç® æ æå®ç®å½åæä»¶ï¼å¿å¤ï¼\nCtrl + Shift + R   æ ¹æ®è¾å¥åå®¹æ¿æ¢å¯¹åºåå®¹ï¼èå´ä¸ºæ´ä¸ªé¡¹ç® æ æå®ç®å½åæä»¶ï¼å¿å¤ï¼\n\n# Usage Search\n\nå¿«æ·é®                 ä»ç»\nAlt + F7            æ¥æ¾åæ æå¨çæ¹æ³/åé/ç±»è¢«è°ç¨çå°æ¹\nCtrl + Alt + F7     æ¾ç¤ºä½¿ç¨çå°æ¹ãå¯»æ¾è¢«è¯¥ç±»ææ¯åéè¢«è°ç¨çå°æ¹ï¼ç¨å¼¹åºæ¡çæ¹å¼æ¾åºæ¥\nCtrl + Shift + F7   é«äº®æ¾ç¤ºææè¯¥éä¸­ææ¬ï¼æ Esc é«äº®æ¶å¤±ï¼å¿å¤ï¼\n\n# Compile and Run\n\nå¿«æ·é®                 ä»ç»\nCtrl + F9           æ§è¡ Make Project æä½\nCtrl + Shift + F9   ç¼è¯éä¸­çæä»¶/å/Module\nShift + F9          Debug\nShift + F10         Run\nAlt + Shift + F9    å¼¹åº Debug çå¯éæ©èå\nAlt + Shift + F10   å¼¹åº Run çå¯éæ©èå\n\n# Debugging\n\nå¿«æ·é®                 ä»ç»\nF7                  å¨ Debug\n                    æ¨¡å¼ä¸ï¼è¿å¥ä¸ä¸æ­¥ï¼å¦æå½åè¡æ­ç¹æ¯ä¸ä¸ªæ¹æ³ï¼åè¿å¥å½åæ¹æ³ä½åï¼å¦æè¯¥æ¹æ³ä½è¿ææ¹æ³ï¼åä¸ä¼è¿å¥è¯¥ååµçæ¹æ³ä¸­\nF8                  å¨ Debug æ¨¡å¼ä¸ï¼è¿å¥ä¸ä¸æ­¥ï¼å¦æå½åè¡æ­ç¹æ¯ä¸ä¸ªæ¹æ³ï¼åä¸è¿å¥å½åæ¹æ³ä½å\nShift + F7          å¨ Debug æ¨¡å¼ä¸ï¼æºè½æ­¥å¥ãæ­ç¹æå¨è¡ä¸æå¤ä¸ªæ¹æ³è°ç¨ï¼ä¼å¼¹åºè¿å¥åªä¸ªæ¹æ³\nShift + F8          å¨ Debug æ¨¡å¼ä¸ï¼è·³åºï¼è¡¨ç°åºæ¥çææè· F9 ä¸æ ·\nAlt + F8            å¨ Debug æ¨¡å¼ä¸ï¼éä¸­å¯¹è±¡ï¼å¼¹åºå¯è¾å¥è®¡ç®è¡¨è¾¾å¼è°è¯æ¡ï¼æ¥çè¯¥è¾å¥åå®¹çè°è¯ç»æ\nAlt + F9            å¨ Debug æ¨¡å¼ä¸ï¼æ§è¡å°åæ å¤\nF9                  å¨ Debug æ¨¡å¼ä¸ï¼æ¢å¤ç¨åºè¿è¡ï¼ä½æ¯å¦æè¯¥æ­ç¹ä¸é¢ä»£ç è¿ææ­ç¹ååå¨ä¸ä¸ä¸ªæ­ç¹ä¸\nCtrl + F8           å¨ Debug æ¨¡å¼ä¸ï¼è®¾ç½®åæ å½åè¡ä¸ºæ­ç¹ï¼å¦æå½åå·²ç»æ¯æ­ç¹åå»ææ­ç¹\nCtrl + Shift + F8   å¨ Debug æ¨¡å¼ä¸ï¼æå®æ­ç¹è¿å¥æ¡ä»¶\n\n# Navigation\n\nå¿«æ·é®                        ä»ç»\nCtrl + N                   è·³è½¬å°ç±»ï¼å¿å¤ï¼\nCtrl + Shift + N           è·³è½¬å°æä»¶ï¼å¿å¤ï¼\nCtrl + Alt + Shift + N     è·³è½¬å°ç¬¦å·ï¼å¿å¤ï¼\nAlt + Left/Right           åæ¢å½åå·²æå¼ççªå£ä¸­çå­è§å¾ï¼æ¯å¦ Debug çªå£ä¸­æ OutputãDebugger\n                           ç­å­è§å¾ï¼ç¨æ­¤å¿«æ·é®å°±å¯ä»¥å¨å­è§å¾ä¸­åæ¢ï¼å¿å¤ï¼\nF12                        åå°åä¸ä¸ªå·¥å·çªå£ï¼å¿å¤ï¼\nESC                        ä»å·¥å·çªå£è¿å¥ä»£ç æä»¶çªå£ï¼å¿å¤ï¼\nShift + ESC                éèå½å æ æåä¸ä¸ªæ¿æ´»çå·¥å·çªå£\nCtrl + G                   è·³è½¬å°å½åæä»¶çæå®è¡å¤\nCtrl + E                   æ¾ç¤ºæè¿æå¼çæä»¶è®°å½åè¡¨ï¼å¿å¤ï¼\nCtrl + Shift + E           æ¾ç¤ºæè¿ç¼è¾çæä»¶è®°å½åè¡¨ï¼å¿å¤ï¼\nCtrl + Alt + Left/Right    è·³è½¬å°ä¸ä¸ä¸ª/ä¸ä¸ä¸ªæä½çå°æ¹ï¼å¿å¤ï¼\nCtrl + Shift + Backspace   éåå°ä¸æ¬¡ä¿®æ¹çå°æ¹ï¼å¿å¤ï¼\nAlt + F1                   æ¾ç¤ºå½åæä»¶éæ©ç®æ å¼¹åºå±ï¼å¼¹åºå±ä¸­æå¾å¤ç®æ å¯ä»¥è¿è¡éæ©ï¼å¿å¤ï¼\nCtrl + B/Ctrl + å·¦é®åå»       è·³è½¬å°å£°æå¤\nCtrl + Alt + B             å¨æä¸ªè°ç¨çæ¹æ³åä¸ä½¿ç¨ä¼è·³å°å·ä½çå®ç°å¤ï¼å¯ä»¥è·³è¿æ¥å£\nCtrl + Shift + B           è·³è½¬å°ç±»åå£°æå¤ï¼å¿å¤ï¼\nCtrl + Shift + I           å¿«éæ¥çåæ æå¨çæ¹æ³ æ ç±»çå®ä¹\nCtrl + U                   åå¾å½ååæ æå¨çæ¹æ³çç¶ç±»çæ¹æ³/æ¥å£å®ä¹ï¼å¿å¤ï¼\nAlt + Up/Down              è·³è½¬å°å½åæä»¶çåä¸ä¸ª/åä¸ä¸ªæ¹æ³ï¼å¿å¤ï¼\nCtrl + ]/[                 è·³è½¬å°å½åæå¨ä»£ç çè±æ¬å·ç»æä½ç½®/å¼å§ä½ç½®\nCtrl + F12                 å¼¹åºå½åæä»¶ç»æå±ï¼å¯ä»¥å¨å¼¹åºçå±ä¸ç´æ¥è¾å¥ï¼è¿è¡ç­é\nCtrl + H                   æ¾ç¤ºå½åç±»çå±æ¬¡ç»æ\nCtrl + Shift + H           æ¾ç¤ºæ¹æ³å±æ¬¡ç»æ\nCtrl + Alt + H             è°ç¨å±æ¬¡\nF2/Shift + F2              è·³è½¬å°ä¸ä¸ä¸ª/ä¸ä¸ä¸ªé«äº®éè¯¯ æ è­¦åä½ç½®ï¼å¿å¤ï¼\nF4                         ç¼è¾æºï¼å¿å¤ï¼\nAlt + Home                 å®ä½/æ¾ç¤ºå°å½åæä»¶ç Navigation Bar\nF11                        æ·»å ä¹¦ç­¾ï¼å¿å¤ï¼\nCtrl + F11                 éä¸­æä»¶/æä»¶å¤¹ï¼ä½¿ç¨å©è®°ç¬¦è®¾å®/åæ¶ä¹¦ç­¾ï¼å¿å¤ï¼\nShift + F11                å¼¹åºä¹¦ç­¾æ¾ç¤ºå±ï¼å¿å¤ï¼\nAlt + 1,2,3...9            æ¾ç¤ºå¯¹åºæ°å¼çéé¡¹å¡ï¼å¶ä¸­ 1 æ¯ Project ç¨å¾æå¤ï¼å¿å¤ï¼\nCtrl + 1,2,3...9           å®ä½å°å¯¹åºæ°å¼çä¹¦ç­¾ä½ç½®ï¼å¿å¤ï¼\n\n# Refactoring\n\nå¿«æ·é®                      ä»ç»\nShift + F6               å¯¹æä»¶/æä»¶å¤¹ éå½åï¼å¿å¤ï¼\nCtrl + Alt + Shift + T   æå¼éæèåï¼å¿å¤ï¼\n\n# VCS/Local History\n\nå¿«æ·é®               ä»ç»\nCtrl + K          çæ¬æ§å¶æäº¤é¡¹ç®ï¼éè¦æ­¤é¡¹ç®æå å¥å°çæ¬æ§å¶æå¯ç¨\nCtrl + T          çæ¬æ§å¶æ´æ°é¡¹ç®ï¼éè¦æ­¤é¡¹ç®æå å¥å°çæ¬æ§å¶æå¯ç¨\nAlt + |           æ¾ç¤ºçæ¬æ§å¶å¸¸ç¨æä½èåå¼¹åºå±ï¼å¿å¤ï¼\nAlt + Shift + C   æ¥çæè¿æä½é¡¹ç®çååæåµåè¡¨\nAlt + Shift + N   éæ©/æ·»å  taskï¼å¿å¤ï¼\n\n# Live Templates\n\nå¿«æ·é®              ä»ç»\nCtrl + J         æå¥èªå®ä¹å¨æä»£ç æ¨¡æ¿ï¼å¿å¤ï¼\nCtrl + Alt + J   å¼¹åºæ¨¡æ¿éæ©çªå£ï¼å°éå®çä»£ç å å¥å¨ææ¨¡æ¿ä¸­\n\n# General\n\nå¿«æ·é®                      ä»ç»\nCtrl + Tab               ç¼è¾çªå£åæ¢ï¼å¦æå¨åæ¢çè¿ç¨åå æä¸ deleteï¼åæ¯å³é­å¯¹åºéä¸­ççªå£\nCtrl + Alt + Y           åæ­¥ãå·æ°\nCtrl + Alt + S           æå¼ IntelliJ IDEA ç³»ç»è®¾ç½®ï¼å¿å¤ï¼\nCtrl + Alt + Shift + S   æå¼å½åé¡¹ç®è®¾ç½®ï¼å¿å¤ï¼\nCtrl + Shift + A         æ¥æ¾å¨ä½/è®¾ç½®ï¼å¿å¤ï¼\nCtrl + Shift + F12       ç¼è¾å¨æå¤§åï¼å¿å¤ï¼\nAlt + Shift + F          æ¾ç¤ºæ·»å å°æ¶èå¤¹å¼¹åºå±/æ·»å å°æ¶èå¤¹\nAlt + Shift + I          æ¥çé¡¹ç®å½åæä»¶\n\n\n# Intellij IDEA å®æ¹å¿«æ·é®è¡¨\n\n\n\n\n# æä»¶\n\næ¨èå ä¸ªæ¯è¾å¥½ç¨çæä»¶\n\n * Key promoter å¿«æ·é®æç¤º\n * CamelCase é©¼å³°å¼å½ååä¸åçº¿å½åäº¤æ¿åå\n * CheckStyle-IDEA ä»£ç è§èæ£æ¥\n * FindBugs-IDEAæ½å¨ Bug æ£æ¥\n * MetricsReloaded ä»£ç å¤æåº¦æ£æ¥\n * Statistic ä»£ç ç»è®¡\n * JRebel Plugin ç­é¨ç½²\n * GsonFormat æ JSON å­ç¬¦ä¸²ç´æ¥å®ä¾åæç±»\n * Eclipse Code Formatter å¦æä½ ä»¥åç¨çæ¯ IDEï¼å¹¶æèªå·±çä¸å¥ä»£ç é£æ ¼éç½®ï¼å¯ä»¥éè¿æ­¤æä»¶å¯¼å¥å° IDEA\n * Alibaba Java Coding Guidelines é¿é Java å¼åè§èçéææ£æ¥å·¥å·\n * IDE Features Trainer å®æ¹çæ°æè®­ç»æä»¶\n * Markdown Navigator Markdown æä»¶ï¼éç¨äºåæ¬¢ç¨ markdown åææ¡£çäºº\n\n\n# ä¸ªæ§å\n\n\n# é¢è²ä¸»é¢\n\nintellij-colors-solarized ä¸ªäººè§å¾è¿ç§è²å½©æ­éååä¼é\n\nä¸è½½å°å\n\n\n# ç ´è§£\n\nIntellij æ¯ä¸ä¸ªæ¶è´¹ç IDEï¼å¦ç½è¯´æç¹å°è´µï¼ä¹°ä¸èµ·ã\n\næä»¥ï¼å¾æ­æ§ï¼åªå¥½ç¨ä¸ç ´è§£æ¹æ³äºãç½ä¸æå¾å¤ä½¿ç¨æ³¨åç çç½æï¼ä½æ¯æ³¨åç ä¸ç¨³å®ï¼éæ¶å¯è½è¢«å°ãè¿æ¯èªè¡æ­å»ºä¸ä¸ªæ³¨åæå¡å¨æ¯è¾ç¨³å®ãæä½¿ç¨äº ilanyu åæ IntelliJ IDEA License Server æ¬å°æ­å»ºæç¨ çæ¹æ³ï¼äº²æµååææã\n\næçå¤ç¨å°åï¼ç¾åº¦äºç\n\nä¸è½½å¹¶è§£åæä¸­çåç¼©åå°æ¬å°ï¼éæ©éåæä½ç³»ç»ççæ¬è¿è¡ã\n\nå¦ææ¯å¨ Linux ä¸è¿è¡ï¼æ¨èåå»ºä¸ä¸ªèæ¬ï¼ä»£ç å¦ä¸ï¼\n\n# ä½¿ç¨ nohup åå»ºå®æ¤è¿ç¨ï¼è¿è¡ IntelliJIDEALicenseServer_linux_amd64\n# å¦æè¿è¡å¨å¶ä» Linux åè¡çæ¬ï¼æ¿æ¢æ§è¡çèæ¬å³å¯\nnohup sh IntelliJIDEALicenseServer_linux_amd64 2>&1\n\n\nè¿æ ·åæ¯å ä¸ºï¼å¤§é¨åäººä½¿ç¨ linux æ¯ä½¿ç¨ä»¿çå¨è¿æ¥èææºï¼å¦ææ­å¼è¿æ¥ï¼è¿ç¨ä¹ä¼è¢« killï¼æ¯æ¬¡å¯å¨è¿ä¸ªæ³¨åæå¡å¨å¾éº»ç¦ä¸æ¯åï¼èå¯å¨äºå®æ¤è¿ç¨ï¼åä¸ä¼åºç°è¿ç§æåµï¼åªæä½ ä¸»å¨ kill è¿ç¨æè½å°å¶å¹²æã\n\nWindows çæ¬æ¯ exe ç¨åºï¼å°å¶è®¾ä¸ºå¼æºèªå¨å¯å¨å³å¯ï¼å«åè¯æä½ ä¸ç¥éæä¹è®¾ç½®å¼æºèªå¨å¯å¨ã\n\n\n# åèèµæ\n\n * IntelliJ-IDEA-Tutorial\n * æå®¢å­¦é¢ - Intellij IDEA ä½¿ç¨æç¨",normalizedContent:"# intellij idea å¿«éå¥é¨\n\n\n# å¿«æ·é®\n\n\n# æ ¸å¿å¿«æ·é®\n\nintellij idea ä½ä¸ºä¸ä¸ªä»¥å¿«æ·é®ä¸ºä¸­å¿ç ideï¼ä¸ºå¤§å¤æ°æä½å»ºè®®äºé®çå¿«æ·é®ãå¨è¿ä¸ªä¸»é¢ä¸­ï¼æ¨å¯ä»¥æ¾å°æä¸å¯ç¼ºå°çåè¡¨ï¼ä½¿ intellij idea è½»æ¾å®ç°ç¬¬ä¸æ­¥ã\n\næ ¸å¿å¿«æ·é®è¡¨ï¼\n\næä½                                                    å¿«æ·é®\næ ¹æ®åç§°æ¥æ¾æä½                                              ctrl+shift+a\næ¾ç¤ºå¯ç¨ æå¾æä½ åè¡¨                                          alt+enter\nåæ¢è§å¾ (project,structure, etc.).                       alt+f1\nåæ¢å·¥å·çªå£åå¨ç¼è¾å¨ä¸­æå¼çæä»¶                                     ctrl+tab\næ¾ç¤º å¯¼èªæ .                                               alt+home\næå¥ä»£ç æ¨¡æ¿.                                               ctrl+j\nå¨å¨å´æå¥ä»£ç æ¨¡æ¿.                                            ctrl+alt+j\nedit an item from the project or another tree view.   f4\næ³¨é                                                    ctrl+/ ctrl+shift+/\næ ¹æ®åç§°æ¥æ¾ç±»ææä»¶.                                           ctrl+n ctrl+shift+n\næ·è´å½åè¡ææå®çè¡.                                           ctrl+d\nå¢å æåå°éä¸­çè¡¨è¾¾å¼.                                          ctrl+w and ctrl+shift+w\nå¨å½åæä»¶æ¥æ¾ææ¿æ¢.                                           ctrl+f ctrl+r\nå¨é¡¹ç®ä¸­ææå®çç®å½ä¸­æ¥æ¾ææ¿æ¢                                      ctrl+shift+f ctrl+shift+r\nå¨å±æç´¢                                                  åå» shift\nå¿«éæ¥çéä¸­å¯¹è±¡çå¼ç¨.                                          ctrl+shift+f7\nå±å¼ææå ç¼è¾å¨ä¸­çä»£ç å.                                        ctrl+numpad plus ctrl+numpad -\nè°ç¨ä»£ç å®æ.                                               ctrl+space\næºè½å£°æå®æ.                                               ctrl+shift+enter\næºè½è¡¥å¨ä»£ç                                                 ctrl+shift+space\næ¾ç¤ºå¯ç¨çéææ¹æ³åè¡¨                                           ctrl+shift+alt+t\n\n\n# å¿«æ·é®åç±»\n\n# tradition\n\nå¿«æ·é®                ä»ç»\nctrl + z           æ¤é\nctrl + shift + z   åæ¶æ¤é\nctrl + x           åªå\nctrl + c           å¤å¶\nctrl + s           ä¿å­\ntab                ç¼©è¿\nshift + tab        åæ¶ç¼©è¿\nshift + home/end   éä¸­åæ å°å½åè¡å¤´ä½ç½®/è¡å°¾ä½ç½®\nctrl + home/end    è·³å°æä»¶å¤´/æä»¶å°¾\n\n# editing\n\nå¿«æ·é®                      ä»ç»\nctrl + space             åºç¡ä»£ç è¡¥å¨ï¼é»è®¤å¨ windows ç³»ç»ä¸è¢«è¾å¥æ³å ç¨ï¼éè¦è¿è¡ä¿®æ¹ï¼å»ºè®®ä¿®æ¹ä¸º ctrl + éå·ï¼å¿å¤ï¼\nctrl + alt + space       ç±»åèªå¨å®æ\nctrl + shift + enter     èªå¨ç»æä»£ç ï¼è¡æ«èªå¨æ·»å åå·ï¼å¿å¤ï¼\nctrl + p                 æ¹æ³åæ°æç¤ºæ¾ç¤º\nctrl + q                 åæ æå¨çåé/ç±»å/æ¹æ³åç­ä¸é¢ï¼ä¹å¯ä»¥å¨æç¤ºè¡¥åçæ¶åæï¼ï¼æ¾ç¤ºææ¡£åå®¹\nshift + f1               å¦ææå¤é¨ææ¡£å¯ä»¥è¿æ¥å¤é¨ææ¡£\nctrl + f1                å¨åæ æå¨çéè¯¯ä»£ç å¤æ¾ç¤ºéè¯¯ä¿¡æ¯ï¼å¿å¤ï¼\nalt + insert             ä»£ç èªå¨çæï¼å¦çæå¯¹è±¡ç set/get æ¹æ³ï¼æé å½æ°ï¼tostring() ç­ï¼å¿å¤ï¼\nctrl + o                 éæ©å¯éåçæ¹æ³\nctrl + i                 éæ©å¯ç»§æ¿çæ¹æ³\nctrl + alt + t           å¯¹éä¸­çä»£ç å¼¹åºç¯ç»éé¡¹å¼¹åºå±ï¼å¿å¤ï¼\nctrl + /                 æ³¨éåæ æå¨è¡ä»£ç ï¼ä¼æ ¹æ®å½åä¸åæä»¶ç±»åä½¿ç¨ä¸åçæ³¨éç¬¦å·ï¼å¿å¤ï¼\nctrl + shift + /         ä»£ç åæ³¨éï¼å¿å¤ï¼\nctrl + w                 éè¿å¼éæ©ä»£ç åãå¯éä¸­åæ æå¨çåè¯ææ®µè½ï¼è¿ç»­æä¼å¨åæéä¸­çåºç¡ä¸åæ©å±éä¸­èå´ï¼å¿å¤ï¼\nctrl + shift + w         éè¿å¼åæ¶éæ©ä»£ç åãå¯éä¸­åæ æå¨çåè¯ææ®µè½ï¼è¿ç»­æä¼å¨åæéä¸­çåºç¡ä¸åæ©å±åæ¶éä¸­èå´ï¼å¿å¤ï¼\nalt + q                  å¼¹åºä¸ä¸ªæç¤ºï¼æ¾ç¤ºå½åç±»çå£°æ/ä¸ä¸æä¿¡æ¯\nalt + enter              intellij idea æ ¹æ®åæ æå¨é®é¢ï¼æä¾å¿«éä¿®å¤éæ©ï¼åæ æ¾å¨çä½ç½®ä¸åæç¤ºçç»æä¹ä¸åï¼å¿å¤ï¼\nctrl + alt + l           æ ¼å¼åä»£ç ï¼å¯ä»¥å¯¹å½åæä»¶åæ´ä¸ªåç®å½ä½¿ç¨ï¼å¿å¤ï¼\nctrl + alt + o           ä¼åå¯¼å¥çç±»ï¼å¯ä»¥å¯¹å½åæä»¶åæ´ä¸ªåç®å½ä½¿ç¨ï¼å¿å¤ï¼\nctrl + alt + i           åæ æå¨è¡ æ éä¸­é¨åè¿è¡èªå¨ä»£ç ç¼©è¿ï¼æç¹ç±»ä¼¼æ ¼å¼å\nctrl + shift + c         å¤å¶å½åæä»¶ç£çè·¯å¾å°åªè´´æ¿ï¼å¿å¤ï¼\nctrl + shift + v         å¼¹åºç¼å­çæè¿æ·è´çåå®¹ç®¡çå¨å¼¹åºå±\nctrl + alt + shift + c   å¤å¶åèä¿¡æ¯\nctrl + alt + shift + v   æ æ ¼å¼é»è´´ï¼å¿å¤ï¼\nctrl + d                 å¤å¶åæ æå¨è¡ æ å¤å¶éæ©åå®¹ï¼å¹¶æå¤å¶åå®¹æå¥åæ ä½ç½®ä¸é¢ï¼å¿å¤ï¼\nctrl + y                 å é¤åæ æå¨è¡ æ å é¤éä¸­çè¡ï¼å¿å¤ï¼\nctrl + shift + j         èªå¨å°ä¸ä¸è¡åå¹¶å°å½åè¡æ«å°¾ï¼å¿å¤ï¼\nshift + enter            å¼å§æ°ä¸è¡ãåæ æå¨è¡ä¸ç©ºåºä¸è¡ï¼åæ å®ä½å°æ°è¡ä½ç½®ï¼å¿å¤ï¼\nctrl + shift + u         å¯¹éä¸­çä»£ç è¿è¡å¤§/å°åè½®æµè½¬æ¢ï¼å¿å¤ï¼\nctrl + shift + ]/[       éä¸­ä»åæ æå¨ä½ç½®å°å®çåºé¨/é¡¶é¨çä¸­æ¬å·ä½ç½®ï¼å¿å¤ï¼\nctrl + delete            å é¤åæ åé¢çåè¯ææ¯ä¸­æå¥ï¼å¿å¤ï¼\nctrl + backspace         å é¤åæ åé¢çåè¯ææ¯ä¸­æå¥ï¼å¿å¤ï¼\nctrl + +/-               å±å¼/æå ä»£ç å\nctrl + shift + +/-       å±å¼/æå ææä»£ç ï¼å¿å¤ï¼\nctrl + f4                å³é­å½åç¼è¾æä»¶\nctrl + shift + up/down   åæ æ¾å¨æ¹æ³åä¸ï¼å°æ¹æ³ç§»å¨å°ä¸ä¸ä¸ª/ä¸ä¸ä¸ªæ¹æ³åé¢ï¼è°æ´æ¹æ³æåºï¼å¿å¤ï¼\nalt + shift + up/down    ç§»å¨åæ æå¨è¡åä¸ç§»å¨/åä¸ç§»å¨ï¼å¿å¤ï¼\nctrl + shift + å·¦é®åå»      æåæ æ¾å¨æä¸ªç±»åéä¸ï¼ææ­¤å¿«æ·é®å¯ä»¥ç´æ¥å®ä½å°è¯¥ç±»ä¸­ï¼å¿å¤ï¼\nalt + shift + å·¦é®åå»       éæ©è¢«åå»çåè¯/ä¸­æå¥ï¼æä½ä¸æ¾ï¼å¯ä»¥åæ¶éæ©å¶ä»åè¯/ä¸­æå¥ï¼å¿å¤ï¼\nctrl + shift + t         å¯¹å½åç±»çæååæµè¯ç±»ï¼å¦æå·²ç»å­å¨çååæµè¯ç±»åå¯ä»¥è¿è¡éæ©ï¼å¿å¤ï¼\n\n# search/replace\n\nå¿«æ·é®                ä»ç»\ndouble shift       å¼¹åº search everywhere å¼¹åºå±\nf3                 å¨æ¥æ¾æ¨¡å¼ä¸ï¼å®ä½å°ä¸ä¸ä¸ªå¹éå¤\nshift + f3         å¨æ¥æ¾æ¨¡å¼ä¸ï¼æ¥æ¾å¹éä¸ä¸ä¸ª\nctrl + f           å¨å½åæä»¶è¿è¡ææ¬æ¥æ¾ï¼å¿å¤ï¼\nctrl + r           å¨å½åæä»¶è¿è¡ææ¬æ¿æ¢ï¼å¿å¤ï¼\nctrl + shift + f   æ ¹æ®è¾å¥åå®¹æ¥æ¾æ´ä¸ªé¡¹ç® æ æå®ç®å½åæä»¶ï¼å¿å¤ï¼\nctrl + shift + r   æ ¹æ®è¾å¥åå®¹æ¿æ¢å¯¹åºåå®¹ï¼èå´ä¸ºæ´ä¸ªé¡¹ç® æ æå®ç®å½åæä»¶ï¼å¿å¤ï¼\n\n# usage search\n\nå¿«æ·é®                 ä»ç»\nalt + f7            æ¥æ¾åæ æå¨çæ¹æ³/åé/ç±»è¢«è°ç¨çå°æ¹\nctrl + alt + f7     æ¾ç¤ºä½¿ç¨çå°æ¹ãå¯»æ¾è¢«è¯¥ç±»ææ¯åéè¢«è°ç¨çå°æ¹ï¼ç¨å¼¹åºæ¡çæ¹å¼æ¾åºæ¥\nctrl + shift + f7   é«äº®æ¾ç¤ºææè¯¥éä¸­ææ¬ï¼æ esc é«äº®æ¶å¤±ï¼å¿å¤ï¼\n\n# compile and run\n\nå¿«æ·é®                 ä»ç»\nctrl + f9           æ§è¡ make project æä½\nctrl + shift + f9   ç¼è¯éä¸­çæä»¶/å/module\nshift + f9          debug\nshift + f10         run\nalt + shift + f9    å¼¹åº debug çå¯éæ©èå\nalt + shift + f10   å¼¹åº run çå¯éæ©èå\n\n# debugging\n\nå¿«æ·é®                 ä»ç»\nf7                  å¨ debug\n                    æ¨¡å¼ä¸ï¼è¿å¥ä¸ä¸æ­¥ï¼å¦æå½åè¡æ­ç¹æ¯ä¸ä¸ªæ¹æ³ï¼åè¿å¥å½åæ¹æ³ä½åï¼å¦æè¯¥æ¹æ³ä½è¿ææ¹æ³ï¼åä¸ä¼è¿å¥è¯¥ååµçæ¹æ³ä¸­\nf8                  å¨ debug æ¨¡å¼ä¸ï¼è¿å¥ä¸ä¸æ­¥ï¼å¦æå½åè¡æ­ç¹æ¯ä¸ä¸ªæ¹æ³ï¼åä¸è¿å¥å½åæ¹æ³ä½å\nshift + f7          å¨ debug æ¨¡å¼ä¸ï¼æºè½æ­¥å¥ãæ­ç¹æå¨è¡ä¸æå¤ä¸ªæ¹æ³è°ç¨ï¼ä¼å¼¹åºè¿å¥åªä¸ªæ¹æ³\nshift + f8          å¨ debug æ¨¡å¼ä¸ï¼è·³åºï¼è¡¨ç°åºæ¥çææè· f9 ä¸æ ·\nalt + f8            å¨ debug æ¨¡å¼ä¸ï¼éä¸­å¯¹è±¡ï¼å¼¹åºå¯è¾å¥è®¡ç®è¡¨è¾¾å¼è°è¯æ¡ï¼æ¥çè¯¥è¾å¥åå®¹çè°è¯ç»æ\nalt + f9            å¨ debug æ¨¡å¼ä¸ï¼æ§è¡å°åæ å¤\nf9                  å¨ debug æ¨¡å¼ä¸ï¼æ¢å¤ç¨åºè¿è¡ï¼ä½æ¯å¦æè¯¥æ­ç¹ä¸é¢ä»£ç è¿ææ­ç¹ååå¨ä¸ä¸ä¸ªæ­ç¹ä¸\nctrl + f8           å¨ debug æ¨¡å¼ä¸ï¼è®¾ç½®åæ å½åè¡ä¸ºæ­ç¹ï¼å¦æå½åå·²ç»æ¯æ­ç¹åå»ææ­ç¹\nctrl + shift + f8   å¨ debug æ¨¡å¼ä¸ï¼æå®æ­ç¹è¿å¥æ¡ä»¶\n\n# navigation\n\nå¿«æ·é®                        ä»ç»\nctrl + n                   è·³è½¬å°ç±»ï¼å¿å¤ï¼\nctrl + shift + n           è·³è½¬å°æä»¶ï¼å¿å¤ï¼\nctrl + alt + shift + n     è·³è½¬å°ç¬¦å·ï¼å¿å¤ï¼\nalt + left/right           åæ¢å½åå·²æå¼ççªå£ä¸­çå­è§å¾ï¼æ¯å¦ debug çªå£ä¸­æ outputãdebugger\n                           ç­å­è§å¾ï¼ç¨æ­¤å¿«æ·é®å°±å¯ä»¥å¨å­è§å¾ä¸­åæ¢ï¼å¿å¤ï¼\nf12                        åå°åä¸ä¸ªå·¥å·çªå£ï¼å¿å¤ï¼\nesc                        ä»å·¥å·çªå£è¿å¥ä»£ç æä»¶çªå£ï¼å¿å¤ï¼\nshift + esc                éèå½å æ æåä¸ä¸ªæ¿æ´»çå·¥å·çªå£\nctrl + g                   è·³è½¬å°å½åæä»¶çæå®è¡å¤\nctrl + e                   æ¾ç¤ºæè¿æå¼çæä»¶è®°å½åè¡¨ï¼å¿å¤ï¼\nctrl + shift + e           æ¾ç¤ºæè¿ç¼è¾çæä»¶è®°å½åè¡¨ï¼å¿å¤ï¼\nctrl + alt + left/right    è·³è½¬å°ä¸ä¸ä¸ª/ä¸ä¸ä¸ªæä½çå°æ¹ï¼å¿å¤ï¼\nctrl + shift + backspace   éåå°ä¸æ¬¡ä¿®æ¹çå°æ¹ï¼å¿å¤ï¼\nalt + f1                   æ¾ç¤ºå½åæä»¶éæ©ç®æ å¼¹åºå±ï¼å¼¹åºå±ä¸­æå¾å¤ç®æ å¯ä»¥è¿è¡éæ©ï¼å¿å¤ï¼\nctrl + b/ctrl + å·¦é®åå»       è·³è½¬å°å£°æå¤\nctrl + alt + b             å¨æä¸ªè°ç¨çæ¹æ³åä¸ä½¿ç¨ä¼è·³å°å·ä½çå®ç°å¤ï¼å¯ä»¥è·³è¿æ¥å£\nctrl + shift + b           è·³è½¬å°ç±»åå£°æå¤ï¼å¿å¤ï¼\nctrl + shift + i           å¿«éæ¥çåæ æå¨çæ¹æ³ æ ç±»çå®ä¹\nctrl + u                   åå¾å½ååæ æå¨çæ¹æ³çç¶ç±»çæ¹æ³/æ¥å£å®ä¹ï¼å¿å¤ï¼\nalt + up/down              è·³è½¬å°å½åæä»¶çåä¸ä¸ª/åä¸ä¸ªæ¹æ³ï¼å¿å¤ï¼\nctrl + ]/[                 è·³è½¬å°å½åæå¨ä»£ç çè±æ¬å·ç»æä½ç½®/å¼å§ä½ç½®\nctrl + f12                 å¼¹åºå½åæä»¶ç»æå±ï¼å¯ä»¥å¨å¼¹åºçå±ä¸ç´æ¥è¾å¥ï¼è¿è¡ç­é\nctrl + h                   æ¾ç¤ºå½åç±»çå±æ¬¡ç»æ\nctrl + shift + h           æ¾ç¤ºæ¹æ³å±æ¬¡ç»æ\nctrl + alt + h             è°ç¨å±æ¬¡\nf2/shift + f2              è·³è½¬å°ä¸ä¸ä¸ª/ä¸ä¸ä¸ªé«äº®éè¯¯ æ è­¦åä½ç½®ï¼å¿å¤ï¼\nf4                         ç¼è¾æºï¼å¿å¤ï¼\nalt + home                 å®ä½/æ¾ç¤ºå°å½åæä»¶ç navigation bar\nf11                        æ·»å ä¹¦ç­¾ï¼å¿å¤ï¼\nctrl + f11                 éä¸­æä»¶/æä»¶å¤¹ï¼ä½¿ç¨å©è®°ç¬¦è®¾å®/åæ¶ä¹¦ç­¾ï¼å¿å¤ï¼\nshift + f11                å¼¹åºä¹¦ç­¾æ¾ç¤ºå±ï¼å¿å¤ï¼\nalt + 1,2,3...9            æ¾ç¤ºå¯¹åºæ°å¼çéé¡¹å¡ï¼å¶ä¸­ 1 æ¯ project ç¨å¾æå¤ï¼å¿å¤ï¼\nctrl + 1,2,3...9           å®ä½å°å¯¹åºæ°å¼çä¹¦ç­¾ä½ç½®ï¼å¿å¤ï¼\n\n# refactoring\n\nå¿«æ·é®                      ä»ç»\nshift + f6               å¯¹æä»¶/æä»¶å¤¹ éå½åï¼å¿å¤ï¼\nctrl + alt + shift + t   æå¼éæèåï¼å¿å¤ï¼\n\n# vcs/local history\n\nå¿«æ·é®               ä»ç»\nctrl + k          çæ¬æ§å¶æäº¤é¡¹ç®ï¼éè¦æ­¤é¡¹ç®æå å¥å°çæ¬æ§å¶æå¯ç¨\nctrl + t          çæ¬æ§å¶æ´æ°é¡¹ç®ï¼éè¦æ­¤é¡¹ç®æå å¥å°çæ¬æ§å¶æå¯ç¨\nalt + |           æ¾ç¤ºçæ¬æ§å¶å¸¸ç¨æä½èåå¼¹åºå±ï¼å¿å¤ï¼\nalt + shift + c   æ¥çæè¿æä½é¡¹ç®çååæåµåè¡¨\nalt + shift + n   éæ©/æ·»å  taskï¼å¿å¤ï¼\n\n# live templates\n\nå¿«æ·é®              ä»ç»\nctrl + j         æå¥èªå®ä¹å¨æä»£ç æ¨¡æ¿ï¼å¿å¤ï¼\nctrl + alt + j   å¼¹åºæ¨¡æ¿éæ©çªå£ï¼å°éå®çä»£ç å å¥å¨ææ¨¡æ¿ä¸­\n\n# general\n\nå¿«æ·é®                      ä»ç»\nctrl + tab               ç¼è¾çªå£åæ¢ï¼å¦æå¨åæ¢çè¿ç¨åå æä¸ deleteï¼åæ¯å³é­å¯¹åºéä¸­ççªå£\nctrl + alt + y           åæ­¥ãå·æ°\nctrl + alt + s           æå¼ intellij idea ç³»ç»è®¾ç½®ï¼å¿å¤ï¼\nctrl + alt + shift + s   æå¼å½åé¡¹ç®è®¾ç½®ï¼å¿å¤ï¼\nctrl + shift + a         æ¥æ¾å¨ä½/è®¾ç½®ï¼å¿å¤ï¼\nctrl + shift + f12       ç¼è¾å¨æå¤§åï¼å¿å¤ï¼\nalt + shift + f          æ¾ç¤ºæ·»å å°æ¶èå¤¹å¼¹åºå±/æ·»å å°æ¶èå¤¹\nalt + shift + i          æ¥çé¡¹ç®å½åæä»¶\n\n\n# intellij idea å®æ¹å¿«æ·é®è¡¨\n\n\n\n\n# æä»¶\n\næ¨èå ä¸ªæ¯è¾å¥½ç¨çæä»¶\n\n * key promoter å¿«æ·é®æç¤º\n * camelcase é©¼å³°å¼å½ååä¸åçº¿å½åäº¤æ¿åå\n * checkstyle-idea ä»£ç è§èæ£æ¥\n * findbugs-ideaæ½å¨ bug æ£æ¥\n * metricsreloaded ä»£ç å¤æåº¦æ£æ¥\n * statistic ä»£ç ç»è®¡\n * jrebel plugin ç­é¨ç½²\n * gsonformat æ json å­ç¬¦ä¸²ç´æ¥å®ä¾åæç±»\n * eclipse code formatter å¦æä½ ä»¥åç¨çæ¯ ideï¼å¹¶æèªå·±çä¸å¥ä»£ç é£æ ¼éç½®ï¼å¯ä»¥éè¿æ­¤æä»¶å¯¼å¥å° idea\n * alibaba java coding guidelines é¿é java å¼åè§èçéææ£æ¥å·¥å·\n * ide features trainer å®æ¹çæ°æè®­ç»æä»¶\n * markdown navigator markdown æä»¶ï¼éç¨äºåæ¬¢ç¨ markdown åææ¡£çäºº\n\n\n# ä¸ªæ§å\n\n\n# é¢è²ä¸»é¢\n\nintellij-colors-solarized ä¸ªäººè§å¾è¿ç§è²å½©æ­éååä¼é\n\nä¸è½½å°å\n\n\n# ç ´è§£\n\nintellij æ¯ä¸ä¸ªæ¶è´¹ç ideï¼å¦ç½è¯´æç¹å°è´µï¼ä¹°ä¸èµ·ã\n\næä»¥ï¼å¾æ­æ§ï¼åªå¥½ç¨ä¸ç ´è§£æ¹æ³äºãç½ä¸æå¾å¤ä½¿ç¨æ³¨åç çç½æï¼ä½æ¯æ³¨åç ä¸ç¨³å®ï¼éæ¶å¯è½è¢«å°ãè¿æ¯èªè¡æ­å»ºä¸ä¸ªæ³¨åæå¡å¨æ¯è¾ç¨³å®ãæä½¿ç¨äº ilanyu åæ intellij idea license server æ¬å°æ­å»ºæç¨ çæ¹æ³ï¼äº²æµååææã\n\næçå¤ç¨å°åï¼ç¾åº¦äºç\n\nä¸è½½å¹¶è§£åæä¸­çåç¼©åå°æ¬å°ï¼éæ©éåæä½ç³»ç»ççæ¬è¿è¡ã\n\nå¦ææ¯å¨ linux ä¸è¿è¡ï¼æ¨èåå»ºä¸ä¸ªèæ¬ï¼ä»£ç å¦ä¸ï¼\n\n# ä½¿ç¨ nohup åå»ºå®æ¤è¿ç¨ï¼è¿è¡ intellijidealicenseserver_linux_amd64\n# å¦æè¿è¡å¨å¶ä» linux åè¡çæ¬ï¼æ¿æ¢æ§è¡çèæ¬å³å¯\nnohup sh intellijidealicenseserver_linux_amd64 2>&1\n\n\nè¿æ ·åæ¯å ä¸ºï¼å¤§é¨åäººä½¿ç¨ linux æ¯ä½¿ç¨ä»¿çå¨è¿æ¥èææºï¼å¦ææ­å¼è¿æ¥ï¼è¿ç¨ä¹ä¼è¢« killï¼æ¯æ¬¡å¯å¨è¿ä¸ªæ³¨åæå¡å¨å¾éº»ç¦ä¸æ¯åï¼èå¯å¨äºå®æ¤è¿ç¨ï¼åä¸ä¼åºç°è¿ç§æåµï¼åªæä½ ä¸»å¨ kill è¿ç¨æè½å°å¶å¹²æã\n\nwindows çæ¬æ¯ exe ç¨åºï¼å°å¶è®¾ä¸ºå¼æºèªå¨å¯å¨å³å¯ï¼å«åè¯æä½ ä¸ç¥éæä¹è®¾ç½®å¼æºèªå¨å¯å¨ã\n\n\n# åèèµæ\n\n * intellij-idea-tutorial\n * æå®¢å­¦é¢ - intellij idea ä½¿ç¨æç¨",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Eclipse å¿«éå¥é¨",frontmatter:{title:"Eclipse å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","IDE"],tags:["Java","IDE"],abbrlink:"bd5534bf",date:"2018-07-01T11:27:47.000Z",permalink:"/pages/a897a9/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/02.IDE/02.Eclipse.html",relativePath:"11.è½¯ä»¶/02.IDE/02.Eclipse.md",key:"v-2040598b",path:"/pages/a897a9/",headers:[{level:2,title:"ä»£ç æºè½æç¤º",slug:"ä»£ç æºè½æç¤º",normalizedTitle:"ä»£ç æºè½æç¤º",charIndex:19},{level:3,title:"Java æºè½æç¤º",slug:"java-æºè½æç¤º",normalizedTitle:"java æºè½æç¤º",charIndex:30},{level:3,title:"JavaScript æºè½æç¤º",slug:"javascript-æºè½æç¤º",normalizedTitle:"javascript æºè½æç¤º",charIndex:369},{level:3,title:"HTML æºè½æç¤º",slug:"html-æºè½æç¤º",normalizedTitle:"html æºè½æç¤º",charIndex:474},{level:2,title:"æä»¶å®è£",slug:"æä»¶å®è£",normalizedTitle:"æä»¶å®è£",charIndex:606},{level:2,title:"åºæ¬è®¾ç½®",slug:"åºæ¬è®¾ç½®",normalizedTitle:"åºæ¬è®¾ç½®",charIndex:1445},{level:2,title:"è®¾ç½®ææ¬æä»¶å JSP æä»¶ç¼ç ",slug:"è®¾ç½®ææ¬æä»¶å-jsp-æä»¶ç¼ç ",normalizedTitle:"è®¾ç½®ææ¬æä»¶å jsp æä»¶ç¼ç ",charIndex:1713},{level:2,title:"è®¾ç½® JDK æ¬å° JavaDOC API è·¯å¾åæºç è·¯å¾",slug:"è®¾ç½®-jdk-æ¬å°-javadoc-api-è·¯å¾åæºç è·¯å¾",normalizedTitle:"è®¾ç½® jdk æ¬å° javadoc api è·¯å¾åæºç è·¯å¾",charIndex:1817},{level:2,title:"è®¾ç½® Servlet æºç æå¶å® Jar åæºç ",slug:"è®¾ç½®-servlet-æºç æå¶å®-jar-åæºç ",normalizedTitle:"è®¾ç½® servlet æºç æå¶å® jar åæºç ",charIndex:2162},{level:2,title:"åç¼è¯æä»¶ JD-Eclipse",slug:"åç¼è¯æä»¶-jd-eclipse",normalizedTitle:"åç¼è¯æä»¶ jd-eclipse",charIndex:2632},{level:2,title:"Validate ä¼å",slug:"validate-ä¼å",normalizedTitle:"validate ä¼å",charIndex:3006},{level:2,title:"å¸¸ç¨å¿«æ·é®",slug:"å¸¸ç¨å¿«æ·é®",normalizedTitle:"å¸¸ç¨å¿«æ·é®",charIndex:3336}],headersStr:"ä»£ç æºè½æç¤º Java æºè½æç¤º JavaScript æºè½æç¤º HTML æºè½æç¤º æä»¶å®è£ åºæ¬è®¾ç½® è®¾ç½®ææ¬æä»¶å JSP æä»¶ç¼ç  è®¾ç½® JDK æ¬å° JavaDOC API è·¯å¾åæºç è·¯å¾ è®¾ç½® Servlet æºç æå¶å® Jar åæºç  åç¼è¯æä»¶ JD-Eclipse Validate ä¼å å¸¸ç¨å¿«æ·é®",content:'# Eclipse å¿«éå¥é¨\n\n\n# ä»£ç æºè½æç¤º\n\n\n# Java æºè½æç¤º\n\nWindow -> Preferences -> Java -> Editor -> Content Assist -> Auto Activation\n\n\n\ndelay æ¯èªå¨å¼¹åºæç¤ºæ¡çå»¶æ¶æ¶é´ï¼æä»¬å¯ä»¥ä¿®æ¹æ 100 æ¯«ç§ï¼triggers è¿éé»è®¤æ¯"."ï¼åªè¦å ä¸"abcdefghijklmnopqrstuvwxyz"æè"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"ï¼å¿å¿ï¼è¿ä¸å°±è½åå°å VS ä¸æ ·çè¾å¥æ¯ä¸ªå­æ¯é½è½æç¤ºå¦ï¼\n\n\n\nå¶å®ç±»åçæä»¶æ¯å¦ HTMLãJavaScriptãJSP å¦æä¹è½æä¾æç¤ºé£ä¸æ¯æ´ç½äºï¼æäºç¬¬äºç¹è®¾ç½®çåºç¡ï¼å¶å®è¿äºè®¾ç½®é½æ¯ä¸æ ·çã\n\n\n# JavaScript æºè½æç¤º\n\nWindow -> Preferences -> JavaScript-> Editor -> Content Assist -> Auto-Activation\n\n\n\n\n# HTML æºè½æç¤º\n\nWindow -> Preferences -> Web -> HTML Files -> Editor -> Content Assist -> Auto-Activation\n\n\n\nä¿å­åï¼æä»¬åæ¥è¾å¥ççï¼æè§çæ¯ä¸éåï¼\n\n\n\n\n# æä»¶å®è£\n\nå¾å¤æç§ä¹¦ä¸è¯´å° Eclipse çæä»¶å®è£é½æ¯éè¿ Help -> Install New SoftWare è¿ç§èªå¨æ£ç´¢çæ¹å¼ï¼æä½èµ·æ¥åºç¶æ¯æ¹ä¾¿ï¼ä¸è¿å½æä»¬ä¸éè¦æç§æä»¶æ¶ä¸å¤ªå®¹ææ¾å°è¦å é¤åªäºåå®¹ï¼èä¸ä»¥å Eclipse çæ¬åçº§çæ¶åï¼éè¿è¿ç§æ¹å¼å®è£è¿çæä»¶é½å¾åéæ°è£ä¸æ¬¡ãå¦å¤ä¸ç§éè¿ Link é¾æ¥æ¹å¼ï¼å°±å¯ä»¥è§£å³è¿äºé®é¢ã\n\næä»¬ä»¥ Eclipse çä¸­ææ±ååæä»¶ä¸ºä¾ï¼åå°å®æ¹æä¾çæ±ååå°åä¸è½½ä¸ä¸ªï¼http://www.eclipse.org/babel/downloads.phpï¼æ³¨æéå¥½èªå·±ç Eclipse çæ¬ï¼\n\n\n\næççæ¬æ¯ Keplerï¼ç¶åè¿å¥ä¸è½½é¡µé¢ï¼åå»çº¢æ¡æ¡ä¸­çé¾æ¥ï¼å³å¯ä¸è½½æ±ååäºï¼\n\n\n\nä¸è½½å®è§£åç¼©åï¼ä¼æä¸ªåå« features å plugin ç®å½ç eclipse æä»¶å¤¹ï¼æè¿ä¸ª eclipse æ¾å¨æä»¬ç Eclipse å®è£æ ¹ç®å½ï¼ä¹å°±æ¯å eclipse.exe åä¸çº§ç®å½ä¸ãç¶åä»ç¶å¨è¿ä¸çº§ç®å½ä¸ï¼æ°å»ºä¸ä¸ª links æä»¶å¤¹ï¼å¹¶å¨è¯¥æä»¶å¤¹åï¼å»ºä¸ä¸ª language.link çææ¬æä»¶ãè¯¥ææ¬æä»¶çåå­æ¯å¯ä»¥ä»»åçï¼åç¼åæ¯.linkï¼èä¸æ¯.txt åãå¥½äºï¼æåä¸æ­¥ï¼ç¼è¾è¯¥æä»¶ï¼å¨éé¢åå¥åææ¾å¥çè¯­è¨åçå°åï¼å¹¶ç¨â\\âè¡¨ç¤ºè·¯å¾ï¼ä¸å®è¦æ path= è¿ä¸ªåç¼ã\n\n\n\nä¿å­æä»¶åï¼éæ°æå¼ Eclipseï¼çæçä¸­æçé¢ç»äºçå°äºãè½ç¶æ±åä¸å®å¨ï¼ä¸è¿ä¹å¤ç¨äºä¸æ¯ä¹ãå¦æä»ç¶åºç°çæ¯è±æï¼è¯´ææ±åå¤±è´¥ï¼éæ°æ£æ¥ä¸ language.link æä»¶ä¸­éç½®çä¿¡æ¯æ¯å¦åæ±ååçç®å½ä¸è´ãããå¶å®çæä»¶å®è£æ¹æ³ä¹æ¯å¦æ­¤ï¼å½ä¸éè¦æä¸ªæä»¶æ¶ï¼åªéå é¤å­æ¾æä»¶çç®å½å links ç®å½ä¸ç¸åºç link æä»¶ï¼æèæ¹åä¸ link æä»¶éé¢çè·¯å¾åææ æè·¯å¾å³å¯ï¼å¯¹ Eclipse åé«çæ¬åçº§æ¶ï¼ä¹åªéæèçå­æ¾æä»¶çç®å½å links ç®å½å¤å¶è¿å»å°±è¡äºã\n\n\n# åºæ¬è®¾ç½®\n\nå¨ Preference çæç´¢é¡¹ä¸­æç´¢ Text Editorsã å¯ä»¥åèæçè®¾ç½®ï¼ Show line numbers Show print margin Insert spaces for tabs\n\nè®¾ç½®ä»£ç çå­ä½ç±»ååå¤§å°ï¼\n\nWindow -> Preferences -> General -> Appearance -> Content Assist -> Colors and Forntsï¼åªéä¿®æ¹ Basic éé¢ç Text Font å°±å¯ä»¥äºã\n\næ¨è Courier Newã\n\n\n\n\n\n\n# è®¾ç½®ææ¬æä»¶å JSP æä»¶ç¼ç \n\nWindow -> Preferences -> General -> Workspace -> Text file encoding -> Otherï¼\n\n\n\n\n\n\n# è®¾ç½® JDK æ¬å° JavaDOC API è·¯å¾åæºç è·¯å¾\n\n\n\n\n\nè¿é½çæçæ¯æ æä¹çåéåï¼è¿æ ·å¯è½ä¼å¯¹å«æç¸åç±»åçåéåæ°çè°ç¨é¡ºåºé æå¹²æ°ï¼\n\nè¿ç§é®é¢ï¼æä»¬æ JDK æèç¸åº Jar åçæºç å¯¼å¥è¿å»å°±è½é¿åäºï¼\n\nWindow -> Preferences -> Java -> Installed JREs -> Editï¼\n\n\n\néä¸­è®¾ç½®å¥½ç JRE ç®å½ï¼ç¼è¾ï¼ç¶åå¨é JRE system libraries ä¸çææ Jar åï¼ç¹å»å³è¾¹ç Source Attachmentï¼\n\n\n\nExternal location ä¸ï¼éä¸­ JDK å®è£ç®å½ä¸ç src.zip æä»¶ï¼ä¸è·¯ OK ä¸æ¥ã\n\n\n\nè®¾ç½®å®ï¼æä»¬åæ¥ççï¼å¹¸ç¦æ¥çå¥½çªç¶ææ¨æï¼\n\n\n\n\n# è®¾ç½® Servlet æºç æå¶å® Jar åæºç \n\n\n\nä¸ä¸æ­¥å·²ç»è®¾ç½®è¿äº JDK çæºç æ JavaDoc è·¯å¾ï¼ä¸ºå¥ç°å¨ååºæ¥äºå¢ï¼å¶å®è¿ä¸ªä¸é¾çè§£ï¼å ä¸ºæä»¬ä½¿ç¨å°çç±»çæºç å¹¶ä¸å¨ JDK çæºç åä¸­ã\n\nä»ç»çï¼æä»¬ä¼åç°è¿äº Jar åå¶å®é½å¨ Tomcat æ ¹ç®å½ä¸ç lib æä»¶å¤¹ä¸­ï¼ä½æ¯ç¿»éäº Tomcat ç®å½ä¹æ²¡æç¸åºç jar æ zip æä»¶åãæ¢ç¶æ¬å°æ²¡æï¼é£å°±å»å®ç½ä¸æ¾æ¾ï¼\n\nhttp://tomcat.apache.org/download-70.cgiè¿éæTomcatçå®è£ååæºç åï¼\n\n\n\nå¯ä»¥èªå®ä¹ä¸ä¸ªä¸é¨ç¨äºå­æ¾ JavaSource å JavaDoc çæä»¶å¤¹ï¼æä¸è½½æä»¶æ¾å°è¯¥ç®å½ä¸ï¼\n\nç¶åååæ¢å° Eclipse ä¸ï¼éä¸­æ²¡æä»£ç æç¤ºçç±»æèå½æ°ï¼ æä¸ F3ï¼ç¹å» Change Attached Sourceï¼\n\n\n\néæ©æä»¬åæä¸è½½å¥½ç tomcat æºç æä»¶ï¼ä¸è·¯ OKã\n\n\n\nç¶åååè¿å¤´ççæä»¬çä»£ç æç¤ºï¼åå¥½å¤äºï¼\n\n\n\nå¶å® Jar åæºç çè®¾ç½®æ¹å¼ä¹ä¸æ ·ã\n\n\n# åç¼è¯æä»¶ JD-Eclipse\n\næ è®ºæ¯å¼åè¿æ¯è°è¯ï¼åç¼è¯å¿ä¸å¯å°ï¼æ¯æ¬¡é½ç¨ jd-gui æå¼å»çï¼å¤éº»ç¦ï¼å¹²èéç½®ä¸ JD æä»¶ï¼èªå¨å³è.classï¼\n\nåä» http://jd.benow.ca/ ä¸ä¸è½½ç¦»çº¿å®è£å jdeclipse_update_site.zipï¼è§£åç¼©åæ featuresãplugins è¿ 2 ä¸ªæä»¶å¤¹å¤å¶å° æ°å»ºæä»¶å¤¹ jdeclipseï¼ç¶åæ jdeclipse æä»¶å¤¹æ´ä¸ªå¤å¶å° Eclipse æ ¹ç®å½ç dropins æä»¶å¤¹ä¸ï¼éå¯ Eclipse å³å¯ãè¿ç§æ¹å¼æ¯ä¸æ¯æ¯å»º link æä»¶æ´æ¹ä¾¿äºï¼\n\n\n\næå¼ Eclipseï¼Window -> Preferences -> General - > Editors ï¼æ .class æä»¶è®¾ç½®å³èæ jd æä»¶ç editor\n\n\n\n\n# Validate ä¼å\n\næä»¬å¨ eclipse éç»å¸¸çå°è¿ä¸ªè¿ç¨ï¼validating... éä¸ªçæ£æ¥æ¯ä¸ä¸ªæä»¶ãé£ä¹å¦ä½å³é­ä¸äº validate æä½å¢ï¼\n\n\n\næå¼ eclipseï¼ç¹å»ãwindowãèåï¼éæ©ãpreferencesãéé¡¹ã\n\n\n\nå¨å·¦ä¾§ç¹å»ãvalidationãéé¡¹ï¼å¨å³ä¾§å¯ä»¥çå° eclipse è¿è¡çèªå¨æ£æ¥é½æåªäºåå®¹ã\n\n\n\nå° Manualï¼æå¨ï¼ä¿æä¸å¨ï¼å° build éé¢åªçä¸ classpath dependency Validatorï¼å¶ä»çå¨é¨å»æã\n\n\n\næåç¹å»ãOKãæé®ï¼ä¿å­è®¾ç½®ã\n\n\n\nä»¥åå¦æéè¦å¯¹æä»¶è¿è¡æ ¡éªæ£æ¥çæ¶åï¼å¨æä»¶ä¸ç¹å»å³é®ï¼ç¹å»ãValidateãè¿è¡æ£æ¥ã\n\n\n# å¸¸ç¨å¿«æ·é®\n\nå¿«æ·é®                    æè¿°\nCtrl+1                 å¿«éä¿®å¤ï¼æç»å¸çå¿«æ·é®,å°±ä¸ç¨å¤è¯´äºï¼å¯ä»¥è§£å³å¾å¤é®é¢ï¼æ¯å¦ import ç±»ãtry catch åå´ç­ï¼\nCtrl+Shift+F           æ ¼å¼åå½åä»£ç \nCtrl+Shift+M           æ·»å ç±»ç import å¯¼å¥\nCtrl+Shift+O           ç»ç»ç±»ç import å¯¼å¥ï¼æ¢æ Ctrl+Shift+M çä½ç¨ï¼åå¯ä»¥å¸®ä½ å»é¤æ²¡ç¨çå¯¼å¥ï¼å¾æç¨ï¼\nCtrl+Y                 éåï¼ä¸æ¤é Ctrl+Z ç¸åï¼\nAlt+/                  åå®¹è¾å©ï¼å¸®ä½ çäºå¤å°æ¬¡é®çæ²æï¼å¤ªå¸¸ç¨äºï¼\nCtrl+D                 å é¤å½åè¡æèå¤è¡\nAlt+â                  å½åè¡åä¸é¢ä¸è¡äº¤äºä½ç½®ï¼ç¹å«å®ç¨,å¯ä»¥çå»ååªå,åç²è´´äºï¼\nAlt+â                  å½åè¡åä¸é¢ä¸è¡äº¤äºä½ç½®ï¼åä¸ï¼\nCtrl+Alt+â             å¤å¶å½åè¡å°ä¸ä¸è¡ï¼å¤å¶å¢å ï¼\nCtrl+Alt+â             å¤å¶å½åè¡å°ä¸ä¸è¡ï¼å¤å¶å¢å ï¼\nShift+Enter            å¨å½åè¡çä¸ä¸è¡æå¥ç©ºè¡ï¼è¿æ¶é¼ æ å¯ä»¥å¨å½åè¡çä»»ä¸ä½ç½®,ä¸ä¸å®æ¯æåï¼\nCtrl+/                 æ³¨éå½åè¡,åæååæ¶æ³¨é\nAlt+Shift+â            éæ©å°è£åç´ \nAlt+Shift+â            éæ©ä¸ä¸ä¸ªåç´ \nAlt+Shift+â            éæ©ä¸ä¸ä¸ªåç´ \nShift+â                ä»åæ å¤å¼å§å¾å·¦éæ©å­ç¬¦\nShift+â                ä»åæ å¤å¼å§å¾å³éæ©å­ç¬¦\nCtrl+Shift+â           éä¸­åæ å·¦è¾¹çåè¯\nCtrl+Shift+â           éä¸­åæ åè¾¹çåè¯\nCtrl+â                 åæ ç§»å°å·¦è¾¹åè¯çå¼å¤´ï¼ç¸å½äº vim ç b\nCtrl+â                 åæ ç§»å°å³è¾¹åè¯çæ«å°¾ï¼ç¸å½äº vim ç e\nCtrl+K                 åç§éä¸­ç Word å¿«éå®ä½å°ä¸ä¸ä¸ªï¼å¦ææ²¡æéä¸­ wordï¼åæç´¢ä¸ä¸æ¬¡ä½¿ç¨æç´¢ç wordï¼\nCtrl+Shift+K           åç§éä¸­ç Word å¿«éå®ä½å°ä¸ä¸ä¸ª\nCtrl+J                 æ­£åå¢éæ¥æ¾ï¼æä¸ Ctrl+J\n                       å,ä½ æè¾å¥çæ¯ä¸ªå­æ¯ç¼è¾å¨é½æä¾å¿«éå¹éå®ä½å°æä¸ªåè¯,å¦ææ²¡æ,åå¨ç¶ææ ä¸­æ¾ç¤ºæ²¡ææ¾å°äº,æ¥ä¸ä¸ªåè¯æ¶,ç¹å«å®ç¨,è¦éåºè¿ä¸ªæ¨¡å¼ï¼æ\n                       escape å»ºï¼\nCtrl+Shift+J           ååå¢éæ¥æ¾ï¼åä¸æ¡ç¸å,åªä¸è¿æ¯ä»åå¾åæ¥ï¼\nCtrl+Shift+U           ååºææåå«å­ç¬¦ä¸²çè¡\nCtrl+H                 æå¼æç´¢å¯¹è¯æ¡\nCtrl+G                 å·¥ä½åºä¸­çå£°æ\nCtrl+Shift+G           å·¥ä½åºä¸­çå¼ç¨\nCtrl+Shift+T           æç´¢ç±»ï¼åæ¬å·¥ç¨åå³èçç¬¬ä¸ jar åï¼\nCtrl+Shift+R           æç´¢å·¥ç¨ä¸­çæä»¶\nCtrl+E                 å¿«éæ¾ç¤ºå½å Editer çä¸æåè¡¨ï¼å¦æå½åé¡µé¢æ²¡ææ¾ç¤ºçç¨é»ä½è¡¨ç¤ºï¼\nF4                     æå¼ç±»åå±æ¬¡ç»æ\nF3                     è·³è½¬å°å£°æå¤\nAlt+â                  åä¸ä¸ªç¼è¾çé¡µé¢\nAlt+â                  ä¸ä¸ä¸ªç¼è¾çé¡µé¢ï¼å½ç¶æ¯éå¯¹ä¸é¢é£æ¡æ¥è¯´äºï¼\nCtrl+PageUp/PageDown   å¨ç¼è¾å¨ä¸­ï¼åæ¢å·²ç»æå¼çæä»¶\nF5                     åæ­¥è·³å¥\nF6                     åæ­¥è·³è¿\nF7                     åæ­¥è¿å\nF8                     ç»§ç»­\nCtrl+Shift+D           æ¾ç¤ºåéçå¼\nCtrl+Shift+B           å¨å½åè¡è®¾ç½®æèå»ææ­ç¹\nCtrl+R                 è¿è¡è³è¡(è¶å¥½ç¨ï¼å¯ä»¥èçå¥½å¤çæ­ç¹)\nAlt+Shift+R            éå½åæ¹æ³åãå±æ§æèåéå ï¼æ¯æèªå·±æç±ç¨çä¸ä¸ªäº,å°¤å¶æ¯åéåç±»ç Rename,æ¯æå·¥æ¹æ³è½èçå¾å¤å³å¨åï¼\nAlt+Shift+M            æä¸æ®µå½æ°åçä»£ç æ½åææ¹æ³ ï¼è¿æ¯éæéé¢æå¸¸ç¨çæ¹æ³ä¹ä¸äº,å°¤å¶æ¯å¯¹ä¸å¤§å æ³¥å¢ä»£ç æç¨ï¼\nAlt+Shift+C            ä¿®æ¹å½æ°ç»æï¼æ¯è¾å®ç¨,æ N ä¸ªå½æ°è°ç¨äºè¿ä¸ªæ¹æ³,ä¿®æ¹ä¸æ¬¡æå®ï¼\nAlt+Shift+L            æ½åæ¬å°åéï¼ å¯ä»¥ç´æ¥æä¸äºé­æ³æ°å­åå­ç¬¦ä¸²æ½åæä¸ä¸ªåé,å°¤å¶æ¯å¤å¤è°ç¨çæ¶åï¼\nAlt+Shift+F            æ Class ä¸­ç local åéåä¸º field åé ï¼æ¯è¾å®ç¨çåè½ï¼\nAlt+Shift+I            åå¹¶åéï¼å¯è½è¿æ ·è¯´æç¹ä¸å¦¥ Inlineï¼\nAlt+Shift+V            ç§»å¨å½æ°ååéï¼ä¸æä¹å¸¸ç¨ï¼\nAlt+Shift+Z            éæçåæè¯ï¼Undoï¼\nAlt+Enter              æ¾ç¤ºå½åéæ©èµæºçå±æ§ï¼windows ä¸çæ¥çæä»¶çå±æ§å°±æ¯è¿ä¸ªå¿«æ·é®ï¼éå¸¸ç¨æ¥æ¥çæä»¶å¨ windows\n                       ä¸­çå®éè·¯å¾\nCtrl+â                 ææ¬ç¼è¾å¨ ä¸æ»è¡\nCtrl+â                 ææ¬ç¼è¾å¨ ä¸æ»è¡\nCtrl+M                 æå¤§åå½åç Edit æ View ï¼åæååä¹ï¼\nCtrl+O                 å¿«éæ¾ç¤º OutLine\nCtrl+T                 å¿«éæ¾ç¤ºå½åç±»çç»§æ¿ç»æ\nCtrl+W                 å³é­å½å Editer\nCtrl+L                 ææ¬ç¼è¾å¨ è½¬è³è¡\nF2                     æ¾ç¤ºå·¥å·æç¤ºæè¿°',normalizedContent:'# eclipse å¿«éå¥é¨\n\n\n# ä»£ç æºè½æç¤º\n\n\n# java æºè½æç¤º\n\nwindow -> preferences -> java -> editor -> content assist -> auto activation\n\n\n\ndelay æ¯èªå¨å¼¹åºæç¤ºæ¡çå»¶æ¶æ¶é´ï¼æä»¬å¯ä»¥ä¿®æ¹æ 100 æ¯«ç§ï¼triggers è¿éé»è®¤æ¯"."ï¼åªè¦å ä¸"abcdefghijklmnopqrstuvwxyz"æè"abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz"ï¼å¿å¿ï¼è¿ä¸å°±è½åå°å vs ä¸æ ·çè¾å¥æ¯ä¸ªå­æ¯é½è½æç¤ºå¦ï¼\n\n\n\nå¶å®ç±»åçæä»¶æ¯å¦ htmlãjavascriptãjsp å¦æä¹è½æä¾æç¤ºé£ä¸æ¯æ´ç½äºï¼æäºç¬¬äºç¹è®¾ç½®çåºç¡ï¼å¶å®è¿äºè®¾ç½®é½æ¯ä¸æ ·çã\n\n\n# javascript æºè½æç¤º\n\nwindow -> preferences -> javascript-> editor -> content assist -> auto-activation\n\n\n\n\n# html æºè½æç¤º\n\nwindow -> preferences -> web -> html files -> editor -> content assist -> auto-activation\n\n\n\nä¿å­åï¼æä»¬åæ¥è¾å¥ççï¼æè§çæ¯ä¸éåï¼\n\n\n\n\n# æä»¶å®è£\n\nå¾å¤æç§ä¹¦ä¸è¯´å° eclipse çæä»¶å®è£é½æ¯éè¿ help -> install new software è¿ç§èªå¨æ£ç´¢çæ¹å¼ï¼æä½èµ·æ¥åºç¶æ¯æ¹ä¾¿ï¼ä¸è¿å½æä»¬ä¸éè¦æç§æä»¶æ¶ä¸å¤ªå®¹ææ¾å°è¦å é¤åªäºåå®¹ï¼èä¸ä»¥å eclipse çæ¬åçº§çæ¶åï¼éè¿è¿ç§æ¹å¼å®è£è¿çæä»¶é½å¾åéæ°è£ä¸æ¬¡ãå¦å¤ä¸ç§éè¿ link é¾æ¥æ¹å¼ï¼å°±å¯ä»¥è§£å³è¿äºé®é¢ã\n\næä»¬ä»¥ eclipse çä¸­ææ±ååæä»¶ä¸ºä¾ï¼åå°å®æ¹æä¾çæ±ååå°åä¸è½½ä¸ä¸ªï¼http://www.eclipse.org/babel/downloads.phpï¼æ³¨æéå¥½èªå·±ç eclipse çæ¬ï¼\n\n\n\næççæ¬æ¯ keplerï¼ç¶åè¿å¥ä¸è½½é¡µé¢ï¼åå»çº¢æ¡æ¡ä¸­çé¾æ¥ï¼å³å¯ä¸è½½æ±ååäºï¼\n\n\n\nä¸è½½å®è§£åç¼©åï¼ä¼æä¸ªåå« features å plugin ç®å½ç eclipse æä»¶å¤¹ï¼æè¿ä¸ª eclipse æ¾å¨æä»¬ç eclipse å®è£æ ¹ç®å½ï¼ä¹å°±æ¯å eclipse.exe åä¸çº§ç®å½ä¸ãç¶åä»ç¶å¨è¿ä¸çº§ç®å½ä¸ï¼æ°å»ºä¸ä¸ª links æä»¶å¤¹ï¼å¹¶å¨è¯¥æä»¶å¤¹åï¼å»ºä¸ä¸ª language.link çææ¬æä»¶ãè¯¥ææ¬æä»¶çåå­æ¯å¯ä»¥ä»»åçï¼åç¼åæ¯.linkï¼èä¸æ¯.txt åãå¥½äºï¼æåä¸æ­¥ï¼ç¼è¾è¯¥æä»¶ï¼å¨éé¢åå¥åææ¾å¥çè¯­è¨åçå°åï¼å¹¶ç¨â\\âè¡¨ç¤ºè·¯å¾ï¼ä¸å®è¦æ path= è¿ä¸ªåç¼ã\n\n\n\nä¿å­æä»¶åï¼éæ°æå¼ eclipseï¼çæçä¸­æçé¢ç»äºçå°äºãè½ç¶æ±åä¸å®å¨ï¼ä¸è¿ä¹å¤ç¨äºä¸æ¯ä¹ãå¦æä»ç¶åºç°çæ¯è±æï¼è¯´ææ±åå¤±è´¥ï¼éæ°æ£æ¥ä¸ language.link æä»¶ä¸­éç½®çä¿¡æ¯æ¯å¦åæ±ååçç®å½ä¸è´ãããå¶å®çæä»¶å®è£æ¹æ³ä¹æ¯å¦æ­¤ï¼å½ä¸éè¦æä¸ªæä»¶æ¶ï¼åªéå é¤å­æ¾æä»¶çç®å½å links ç®å½ä¸ç¸åºç link æä»¶ï¼æèæ¹åä¸ link æä»¶éé¢çè·¯å¾åææ æè·¯å¾å³å¯ï¼å¯¹ eclipse åé«çæ¬åçº§æ¶ï¼ä¹åªéæèçå­æ¾æä»¶çç®å½å links ç®å½å¤å¶è¿å»å°±è¡äºã\n\n\n# åºæ¬è®¾ç½®\n\nå¨ preference çæç´¢é¡¹ä¸­æç´¢ text editorsã å¯ä»¥åèæçè®¾ç½®ï¼ show line numbers show print margin insert spaces for tabs\n\nè®¾ç½®ä»£ç çå­ä½ç±»ååå¤§å°ï¼\n\nwindow -> preferences -> general -> appearance -> content assist -> colors and forntsï¼åªéä¿®æ¹ basic éé¢ç text font å°±å¯ä»¥äºã\n\næ¨è courier newã\n\n\n\n\n\n\n# è®¾ç½®ææ¬æä»¶å jsp æä»¶ç¼ç \n\nwindow -> preferences -> general -> workspace -> text file encoding -> otherï¼\n\n\n\n\n\n\n# è®¾ç½® jdk æ¬å° javadoc api è·¯å¾åæºç è·¯å¾\n\n\n\n\n\nè¿é½çæçæ¯æ æä¹çåéåï¼è¿æ ·å¯è½ä¼å¯¹å«æç¸åç±»åçåéåæ°çè°ç¨é¡ºåºé æå¹²æ°ï¼\n\nè¿ç§é®é¢ï¼æä»¬æ jdk æèç¸åº jar åçæºç å¯¼å¥è¿å»å°±è½é¿åäºï¼\n\nwindow -> preferences -> java -> installed jres -> editï¼\n\n\n\néä¸­è®¾ç½®å¥½ç jre ç®å½ï¼ç¼è¾ï¼ç¶åå¨é jre system libraries ä¸çææ jar åï¼ç¹å»å³è¾¹ç source attachmentï¼\n\n\n\nexternal location ä¸ï¼éä¸­ jdk å®è£ç®å½ä¸ç src.zip æä»¶ï¼ä¸è·¯ ok ä¸æ¥ã\n\n\n\nè®¾ç½®å®ï¼æä»¬åæ¥ççï¼å¹¸ç¦æ¥çå¥½çªç¶ææ¨æï¼\n\n\n\n\n# è®¾ç½® servlet æºç æå¶å® jar åæºç \n\n\n\nä¸ä¸æ­¥å·²ç»è®¾ç½®è¿äº jdk çæºç æ javadoc è·¯å¾ï¼ä¸ºå¥ç°å¨ååºæ¥äºå¢ï¼å¶å®è¿ä¸ªä¸é¾çè§£ï¼å ä¸ºæä»¬ä½¿ç¨å°çç±»çæºç å¹¶ä¸å¨ jdk çæºç åä¸­ã\n\nä»ç»çï¼æä»¬ä¼åç°è¿äº jar åå¶å®é½å¨ tomcat æ ¹ç®å½ä¸ç lib æä»¶å¤¹ä¸­ï¼ä½æ¯ç¿»éäº tomcat ç®å½ä¹æ²¡æç¸åºç jar æ zip æä»¶åãæ¢ç¶æ¬å°æ²¡æï¼é£å°±å»å®ç½ä¸æ¾æ¾ï¼\n\nhttp://tomcat.apache.org/download-70.cgiè¿éætomcatçå®è£ååæºç åï¼\n\n\n\nå¯ä»¥èªå®ä¹ä¸ä¸ªä¸é¨ç¨äºå­æ¾ javasource å javadoc çæä»¶å¤¹ï¼æä¸è½½æä»¶æ¾å°è¯¥ç®å½ä¸ï¼\n\nç¶åååæ¢å° eclipse ä¸ï¼éä¸­æ²¡æä»£ç æç¤ºçç±»æèå½æ°ï¼ æä¸ f3ï¼ç¹å» change attached sourceï¼\n\n\n\néæ©æä»¬åæä¸è½½å¥½ç tomcat æºç æä»¶ï¼ä¸è·¯ okã\n\n\n\nç¶åååè¿å¤´ççæä»¬çä»£ç æç¤ºï¼åå¥½å¤äºï¼\n\n\n\nå¶å® jar åæºç çè®¾ç½®æ¹å¼ä¹ä¸æ ·ã\n\n\n# åç¼è¯æä»¶ jd-eclipse\n\næ è®ºæ¯å¼åè¿æ¯è°è¯ï¼åç¼è¯å¿ä¸å¯å°ï¼æ¯æ¬¡é½ç¨ jd-gui æå¼å»çï¼å¤éº»ç¦ï¼å¹²èéç½®ä¸ jd æä»¶ï¼èªå¨å³è.classï¼\n\nåä» http://jd.benow.ca/ ä¸ä¸è½½ç¦»çº¿å®è£å jdeclipse_update_site.zipï¼è§£åç¼©åæ featuresãplugins è¿ 2 ä¸ªæä»¶å¤¹å¤å¶å° æ°å»ºæä»¶å¤¹ jdeclipseï¼ç¶åæ jdeclipse æä»¶å¤¹æ´ä¸ªå¤å¶å° eclipse æ ¹ç®å½ç dropins æä»¶å¤¹ä¸ï¼éå¯ eclipse å³å¯ãè¿ç§æ¹å¼æ¯ä¸æ¯æ¯å»º link æä»¶æ´æ¹ä¾¿äºï¼\n\n\n\næå¼ eclipseï¼window -> preferences -> general - > editors ï¼æ .class æä»¶è®¾ç½®å³èæ jd æä»¶ç editor\n\n\n\n\n# validate ä¼å\n\næä»¬å¨ eclipse éç»å¸¸çå°è¿ä¸ªè¿ç¨ï¼validating... éä¸ªçæ£æ¥æ¯ä¸ä¸ªæä»¶ãé£ä¹å¦ä½å³é­ä¸äº validate æä½å¢ï¼\n\n\n\næå¼ eclipseï¼ç¹å»ãwindowãèåï¼éæ©ãpreferencesãéé¡¹ã\n\n\n\nå¨å·¦ä¾§ç¹å»ãvalidationãéé¡¹ï¼å¨å³ä¾§å¯ä»¥çå° eclipse è¿è¡çèªå¨æ£æ¥é½æåªäºåå®¹ã\n\n\n\nå° manualï¼æå¨ï¼ä¿æä¸å¨ï¼å° build éé¢åªçä¸ classpath dependency validatorï¼å¶ä»çå¨é¨å»æã\n\n\n\næåç¹å»ãokãæé®ï¼ä¿å­è®¾ç½®ã\n\n\n\nä»¥åå¦æéè¦å¯¹æä»¶è¿è¡æ ¡éªæ£æ¥çæ¶åï¼å¨æä»¶ä¸ç¹å»å³é®ï¼ç¹å»ãvalidateãè¿è¡æ£æ¥ã\n\n\n# å¸¸ç¨å¿«æ·é®\n\nå¿«æ·é®                    æè¿°\nctrl+1                 å¿«éä¿®å¤ï¼æç»å¸çå¿«æ·é®,å°±ä¸ç¨å¤è¯´äºï¼å¯ä»¥è§£å³å¾å¤é®é¢ï¼æ¯å¦ import ç±»ãtry catch åå´ç­ï¼\nctrl+shift+f           æ ¼å¼åå½åä»£ç \nctrl+shift+m           æ·»å ç±»ç import å¯¼å¥\nctrl+shift+o           ç»ç»ç±»ç import å¯¼å¥ï¼æ¢æ ctrl+shift+m çä½ç¨ï¼åå¯ä»¥å¸®ä½ å»é¤æ²¡ç¨çå¯¼å¥ï¼å¾æç¨ï¼\nctrl+y                 éåï¼ä¸æ¤é ctrl+z ç¸åï¼\nalt+/                  åå®¹è¾å©ï¼å¸®ä½ çäºå¤å°æ¬¡é®çæ²æï¼å¤ªå¸¸ç¨äºï¼\nctrl+d                 å é¤å½åè¡æèå¤è¡\nalt+â                  å½åè¡åä¸é¢ä¸è¡äº¤äºä½ç½®ï¼ç¹å«å®ç¨,å¯ä»¥çå»ååªå,åç²è´´äºï¼\nalt+â                  å½åè¡åä¸é¢ä¸è¡äº¤äºä½ç½®ï¼åä¸ï¼\nctrl+alt+â             å¤å¶å½åè¡å°ä¸ä¸è¡ï¼å¤å¶å¢å ï¼\nctrl+alt+â             å¤å¶å½åè¡å°ä¸ä¸è¡ï¼å¤å¶å¢å ï¼\nshift+enter            å¨å½åè¡çä¸ä¸è¡æå¥ç©ºè¡ï¼è¿æ¶é¼ æ å¯ä»¥å¨å½åè¡çä»»ä¸ä½ç½®,ä¸ä¸å®æ¯æåï¼\nctrl+/                 æ³¨éå½åè¡,åæååæ¶æ³¨é\nalt+shift+â            éæ©å°è£åç´ \nalt+shift+â            éæ©ä¸ä¸ä¸ªåç´ \nalt+shift+â            éæ©ä¸ä¸ä¸ªåç´ \nshift+â                ä»åæ å¤å¼å§å¾å·¦éæ©å­ç¬¦\nshift+â                ä»åæ å¤å¼å§å¾å³éæ©å­ç¬¦\nctrl+shift+â           éä¸­åæ å·¦è¾¹çåè¯\nctrl+shift+â           éä¸­åæ åè¾¹çåè¯\nctrl+â                 åæ ç§»å°å·¦è¾¹åè¯çå¼å¤´ï¼ç¸å½äº vim ç b\nctrl+â                 åæ ç§»å°å³è¾¹åè¯çæ«å°¾ï¼ç¸å½äº vim ç e\nctrl+k                 åç§éä¸­ç word å¿«éå®ä½å°ä¸ä¸ä¸ªï¼å¦ææ²¡æéä¸­ wordï¼åæç´¢ä¸ä¸æ¬¡ä½¿ç¨æç´¢ç wordï¼\nctrl+shift+k           åç§éä¸­ç word å¿«éå®ä½å°ä¸ä¸ä¸ª\nctrl+j                 æ­£åå¢éæ¥æ¾ï¼æä¸ ctrl+j\n                       å,ä½ æè¾å¥çæ¯ä¸ªå­æ¯ç¼è¾å¨é½æä¾å¿«éå¹éå®ä½å°æä¸ªåè¯,å¦ææ²¡æ,åå¨ç¶ææ ä¸­æ¾ç¤ºæ²¡ææ¾å°äº,æ¥ä¸ä¸ªåè¯æ¶,ç¹å«å®ç¨,è¦éåºè¿ä¸ªæ¨¡å¼ï¼æ\n                       escape å»ºï¼\nctrl+shift+j           ååå¢éæ¥æ¾ï¼åä¸æ¡ç¸å,åªä¸è¿æ¯ä»åå¾åæ¥ï¼\nctrl+shift+u           ååºææåå«å­ç¬¦ä¸²çè¡\nctrl+h                 æå¼æç´¢å¯¹è¯æ¡\nctrl+g                 å·¥ä½åºä¸­çå£°æ\nctrl+shift+g           å·¥ä½åºä¸­çå¼ç¨\nctrl+shift+t           æç´¢ç±»ï¼åæ¬å·¥ç¨åå³èçç¬¬ä¸ jar åï¼\nctrl+shift+r           æç´¢å·¥ç¨ä¸­çæä»¶\nctrl+e                 å¿«éæ¾ç¤ºå½å editer çä¸æåè¡¨ï¼å¦æå½åé¡µé¢æ²¡ææ¾ç¤ºçç¨é»ä½è¡¨ç¤ºï¼\nf4                     æå¼ç±»åå±æ¬¡ç»æ\nf3                     è·³è½¬å°å£°æå¤\nalt+â                  åä¸ä¸ªç¼è¾çé¡µé¢\nalt+â                  ä¸ä¸ä¸ªç¼è¾çé¡µé¢ï¼å½ç¶æ¯éå¯¹ä¸é¢é£æ¡æ¥è¯´äºï¼\nctrl+pageup/pagedown   å¨ç¼è¾å¨ä¸­ï¼åæ¢å·²ç»æå¼çæä»¶\nf5                     åæ­¥è·³å¥\nf6                     åæ­¥è·³è¿\nf7                     åæ­¥è¿å\nf8                     ç»§ç»­\nctrl+shift+d           æ¾ç¤ºåéçå¼\nctrl+shift+b           å¨å½åè¡è®¾ç½®æèå»ææ­ç¹\nctrl+r                 è¿è¡è³è¡(è¶å¥½ç¨ï¼å¯ä»¥èçå¥½å¤çæ­ç¹)\nalt+shift+r            éå½åæ¹æ³åãå±æ§æèåéå ï¼æ¯æèªå·±æç±ç¨çä¸ä¸ªäº,å°¤å¶æ¯åéåç±»ç rename,æ¯æå·¥æ¹æ³è½èçå¾å¤å³å¨åï¼\nalt+shift+m            æä¸æ®µå½æ°åçä»£ç æ½åææ¹æ³ ï¼è¿æ¯éæéé¢æå¸¸ç¨çæ¹æ³ä¹ä¸äº,å°¤å¶æ¯å¯¹ä¸å¤§å æ³¥å¢ä»£ç æç¨ï¼\nalt+shift+c            ä¿®æ¹å½æ°ç»æï¼æ¯è¾å®ç¨,æ n ä¸ªå½æ°è°ç¨äºè¿ä¸ªæ¹æ³,ä¿®æ¹ä¸æ¬¡æå®ï¼\nalt+shift+l            æ½åæ¬å°åéï¼ å¯ä»¥ç´æ¥æä¸äºé­æ³æ°å­åå­ç¬¦ä¸²æ½åæä¸ä¸ªåé,å°¤å¶æ¯å¤å¤è°ç¨çæ¶åï¼\nalt+shift+f            æ class ä¸­ç local åéåä¸º field åé ï¼æ¯è¾å®ç¨çåè½ï¼\nalt+shift+i            åå¹¶åéï¼å¯è½è¿æ ·è¯´æç¹ä¸å¦¥ inlineï¼\nalt+shift+v            ç§»å¨å½æ°ååéï¼ä¸æä¹å¸¸ç¨ï¼\nalt+shift+z            éæçåæè¯ï¼undoï¼\nalt+enter              æ¾ç¤ºå½åéæ©èµæºçå±æ§ï¼windows ä¸çæ¥çæä»¶çå±æ§å°±æ¯è¿ä¸ªå¿«æ·é®ï¼éå¸¸ç¨æ¥æ¥çæä»¶å¨ windows\n                       ä¸­çå®éè·¯å¾\nctrl+â                 ææ¬ç¼è¾å¨ ä¸æ»è¡\nctrl+â                 ææ¬ç¼è¾å¨ ä¸æ»è¡\nctrl+m                 æå¤§åå½åç edit æ view ï¼åæååä¹ï¼\nctrl+o                 å¿«éæ¾ç¤º outline\nctrl+t                 å¿«éæ¾ç¤ºå½åç±»çç»§æ¿ç»æ\nctrl+w                 å³é­å½å editer\nctrl+l                 ææ¬ç¼è¾å¨ è½¬è³è¡\nf2                     æ¾ç¤ºå·¥å·æç¤ºæè¿°',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Vscode å¿«éå¥é¨",frontmatter:{title:"Vscode å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","IDE"],tags:["Java","IDE"],abbrlink:"849a3ae4",date:"2019-05-14T14:57:33.000Z",permalink:"/pages/a537c7/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/02.IDE/03.VsCode.html",relativePath:"11.è½¯ä»¶/02.IDE/03.VsCode.md",key:"v-69d50af2",path:"/pages/a537c7/",headers:[{level:2,title:"å¿«æ·é®",slug:"å¿«æ·é®",normalizedTitle:"å¿«æ·é®",charIndex:18},{level:3,title:"å½ä»¤é¢æ¿ï¼Command Paletteï¼",slug:"å½ä»¤é¢æ¿-command-palette",normalizedTitle:"å½ä»¤é¢æ¿ï¼command paletteï¼",charIndex:26},{level:3,title:"å¿«éæå¼æä»¶ï¼Quick Openï¼",slug:"å¿«éæå¼æä»¶-quick-open",normalizedTitle:"å¿«éæå¼æä»¶ï¼quick openï¼",charIndex:134},{level:3,title:"Status Bar",slug:"status-bar",normalizedTitle:"status bar",charIndex:195},{level:3,title:"æ¹åè¯­è¨æ¨¡å¼",slug:"æ¹åè¯­è¨æ¨¡å¼",normalizedTitle:"æ¹åè¯­è¨æ¨¡å¼",charIndex:260},{level:3,title:"è®¾ç½®",slug:"è®¾ç½®",normalizedTitle:"è®¾ç½®",charIndex:313},{level:2,title:"æä»¶",slug:"æä»¶",normalizedTitle:"æä»¶",charIndex:391},{level:2,title:"æ´å¤åå®¹",slug:"æ´å¤åå®¹",normalizedTitle:"æ´å¤åå®¹",charIndex:561}],headersStr:"å¿«æ·é® å½ä»¤é¢æ¿ï¼Command Paletteï¼ å¿«éæå¼æä»¶ï¼Quick Openï¼ Status Bar æ¹åè¯­è¨æ¨¡å¼ è®¾ç½® æä»¶ æ´å¤åå®¹",content:"# Vscode å¿«éå¥é¨\n\n\n# å¿«æ·é®\n\n\n# å½ä»¤é¢æ¿ï¼Command Paletteï¼\n\næ ¹æ®æ¨å½åçä¸ä¸æè®¿é®ææå¯ç¨å½ä»¤ã\n\n> Mac: cmd+shift+p or f1 Windows / Linux: ctrl+shift+p or f1\n\n\n# å¿«éæå¼æä»¶ï¼Quick Openï¼\n\n> Mac: cmd+p Windows / Linux: ctrl+p\n\n\n# Status Bar\n\n> Mac: shift+cmd+m Windows / Linux: ctrl+shift+m\n\n\n# æ¹åè¯­è¨æ¨¡å¼\n\n> Mac: cmd+k m Windows / Linux: ctrl+k m\n\n\n# è®¾ç½®\n\n> Mac: cmd+, Windows / Linux: File > Preferences > Settings or ctrl+,\n\n\n# æä»¶\n\n * Chinese (Simplified) Language Pack for Visual Studio Code\n * Prettier - Code formatter\n * IntelliJ IDEA Keybindings\n * EditorConfig for VS Code\n * Git History\n\n\n# æ´å¤åå®¹\n\n * å®æ¹\n   * https://github.com/Microsoft/vscode\n   * https://github.com/Microsoft/vscode-docs\n   * https://github.com/Microsoft/vscode-tips-and-tricks\n * æ´å¤èµæº\n   * https://github.com/viatsko/awesome-vscode",normalizedContent:"# vscode å¿«éå¥é¨\n\n\n# å¿«æ·é®\n\n\n# å½ä»¤é¢æ¿ï¼command paletteï¼\n\næ ¹æ®æ¨å½åçä¸ä¸æè®¿é®ææå¯ç¨å½ä»¤ã\n\n> mac: cmd+shift+p or f1 windows / linux: ctrl+shift+p or f1\n\n\n# å¿«éæå¼æä»¶ï¼quick openï¼\n\n> mac: cmd+p windows / linux: ctrl+p\n\n\n# status bar\n\n> mac: shift+cmd+m windows / linux: ctrl+shift+m\n\n\n# æ¹åè¯­è¨æ¨¡å¼\n\n> mac: cmd+k m windows / linux: ctrl+k m\n\n\n# è®¾ç½®\n\n> mac: cmd+, windows / linux: file > preferences > settings or ctrl+,\n\n\n# æä»¶\n\n * chinese (simplified) language pack for visual studio code\n * prettier - code formatter\n * intellij idea keybindings\n * editorconfig for vs code\n * git history\n\n\n# æ´å¤åå®¹\n\n * å®æ¹\n   * https://github.com/microsoft/vscode\n   * https://github.com/microsoft/vscode-docs\n   * https://github.com/microsoft/vscode-tips-and-tricks\n * æ´å¤èµæº\n   * https://github.com/viatsko/awesome-vscode",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java IDE",frontmatter:{title:"Java IDE",categories:["ç¼ç¨","Java","è½¯ä»¶","IDE"],tags:["Java","IDE"],abbrlink:"c44dd053",date:"2022-02-18T08:53:11.000Z",hidden:!0,permalink:"/pages/2df5ea/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/02.IDE/",relativePath:"11.è½¯ä»¶/02.IDE/README.md",key:"v-f12e4400",path:"/pages/2df5ea/",headersStr:null,content:"# Java IDE\n\n> èªä»æäº IDEï¼åä»£ç ä»æ­¤å°±åå«äºåèç«ç§çè®èæ¶ä»£ã\n> \n>  * Eclipse æ¯ä¹è´çåçå¼æº Java IDEï¼æçå­¦çæ¶ä»£ä¸ç´ä½¿ç¨å®å Javaã\n>  * æ¾ç»ææä»è½¬ Intellij Idea ï¼ä½åæ¥åç°çé¦ï¼ä¸å¾ä¸è¯´ï¼ç¡®å®æ¯ç®åæä¼ç§ç Java IDEã\n>  * ä½ å¯ä»¥å¨ vscode ä¸­ååç§è¯­è¨ï¼åªè¦å®è£ç¸åºæä»¶å³å¯ãå¦æä½ çé¡¹ç®ä¸­ä½¿ç¨äºå¾å¤ç§ç¼ç¨è¯­è¨ï¼åæå¾å¨å¤ä¸ª IDE ä¹é´åæ¢ï¼é£ä¹å°±ç¨ vscode æ¥ä¸ç½æå°½å§ã\n\n * Intellij IDEA å¿«éå¥é¨\n * Eclipse å¿«éå¥é¨\n * Vscode å¿«éå¥é¨",normalizedContent:"# java ide\n\n> èªä»æäº ideï¼åä»£ç ä»æ­¤å°±åå«äºåèç«ç§çè®èæ¶ä»£ã\n> \n>  * eclipse æ¯ä¹è´çåçå¼æº java ideï¼æçå­¦çæ¶ä»£ä¸ç´ä½¿ç¨å®å javaã\n>  * æ¾ç»ææä»è½¬ intellij idea ï¼ä½åæ¥åç°çé¦ï¼ä¸å¾ä¸è¯´ï¼ç¡®å®æ¯ç®åæä¼ç§ç java ideã\n>  * ä½ å¯ä»¥å¨ vscode ä¸­ååç§è¯­è¨ï¼åªè¦å®è£ç¸åºæä»¶å³å¯ãå¦æä½ çé¡¹ç®ä¸­ä½¿ç¨äºå¾å¤ç§ç¼ç¨è¯­è¨ï¼åæå¾å¨å¤ä¸ª ide ä¹é´åæ¢ï¼é£ä¹å°±ç¨ vscode æ¥ä¸ç½æå°½å§ã\n\n * intellij idea å¿«éå¥é¨\n * eclipse å¿«éå¥é¨\n * vscode å¿«éå¥é¨",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"çæ§å·¥å·å¯¹æ¯",frontmatter:{title:"çæ§å·¥å·å¯¹æ¯",categories:["ç¼ç¨","Java","è½¯ä»¶","çæ§è¯æ­"],tags:["Java","çæ§"],abbrlink:"7331d4e5",date:"2020-02-11T17:48:32.000Z",permalink:"/pages/c7c5ec/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/03.%E7%9B%91%E6%8E%A7%E8%AF%8A%E6%96%AD/01.%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94.html",relativePath:"11.è½¯ä»¶/03.çæ§è¯æ­/01.çæ§å·¥å·å¯¹æ¯.md",key:"v-5d502cb7",path:"/pages/c7c5ec/",headers:[{level:2,title:"çæ§å·¥å·åå±å²",slug:"çæ§å·¥å·åå±å²",normalizedTitle:"çæ§å·¥å·åå±å²",charIndex:13},{level:2,title:"çæ§å·¥å·æ¯å¯¹",slug:"çæ§å·¥å·æ¯å¯¹",normalizedTitle:"çæ§å·¥å·æ¯å¯¹",charIndex:27},{level:3,title:"ç¹æ§å¯¹æ¯",slug:"ç¹æ§å¯¹æ¯",normalizedTitle:"ç¹æ§å¯¹æ¯",charIndex:38},{level:3,title:"çæå¯¹æ¯",slug:"çæå¯¹æ¯",normalizedTitle:"çæå¯¹æ¯",charIndex:49},{level:2,title:"ææ¯éå",slug:"ææ¯éå",normalizedTitle:"ææ¯éå",charIndex:60},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:153}],headersStr:"çæ§å·¥å·åå±å² çæ§å·¥å·æ¯å¯¹ ç¹æ§å¯¹æ¯ çæå¯¹æ¯ ææ¯éå åèèµæ",content:"# çæ§å·¥å·å¯¹æ¯\n\n\n# çæ§å·¥å·åå±å²\n\n\n\n\n# çæ§å·¥å·æ¯å¯¹\n\n\n# ç¹æ§å¯¹æ¯\n\n\n\n\n# çæå¯¹æ¯\n\n\n\n\n# ææ¯éå\n\n * Zipkin æ¬ ç¼º APM æ¥è¡¨è½åï¼ä¸æ¨èã\n * ä¼ä¸çº§ï¼æ¨è CAT\n * å³æ³¨åè¯ç¹ SkyWalkingã\n\nç¨å¥½è°ç¨é¾çæ§ï¼éè¦è®¢å¶åãèªç è½åã\n\n\n# åèèµæ\n\nCATãZipkin å SkyWalking è¯¥å¦ä½éåï¼",normalizedContent:"# çæ§å·¥å·å¯¹æ¯\n\n\n# çæ§å·¥å·åå±å²\n\n\n\n\n# çæ§å·¥å·æ¯å¯¹\n\n\n# ç¹æ§å¯¹æ¯\n\n\n\n\n# çæå¯¹æ¯\n\n\n\n\n# ææ¯éå\n\n * zipkin æ¬ ç¼º apm æ¥è¡¨è½åï¼ä¸æ¨èã\n * ä¼ä¸çº§ï¼æ¨è cat\n * å³æ³¨åè¯ç¹ skywalkingã\n\nç¨å¥½è°ç¨é¾çæ§ï¼éè¦è®¢å¶åãèªç è½åã\n\n\n# åèèµæ\n\ncatãzipkin å skywalking è¯¥å¦ä½éåï¼",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"CAT å¿«éå¥é¨",frontmatter:{title:"CAT å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","çæ§è¯æ­"],tags:["Java","çæ§","CAT"],abbrlink:"9e5e43a8",date:"2020-02-11T17:48:32.000Z",permalink:"/pages/83e684/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/03.%E7%9B%91%E6%8E%A7%E8%AF%8A%E6%96%AD/02.CAT.html",relativePath:"11.è½¯ä»¶/03.çæ§è¯æ­/02.CAT.md",key:"v-1a600385",path:"/pages/83e684/",headers:[{level:2,title:"CAT ç®ä»",slug:"cat-ç®ä»",normalizedTitle:"cat ç®ä»",charIndex:15},{level:3,title:"CAT çä¼å¿",slug:"cat-çä¼å¿",normalizedTitle:"cat çä¼å¿",charIndex:244},{level:3,title:"æ¯æçæ¶æ¯ç±»å",slug:"æ¯æçæ¶æ¯ç±»å",normalizedTitle:"æ¯æçæ¶æ¯ç±»å",charIndex:494},{level:2,title:"CAT é¨ç½²",slug:"cat-é¨ç½²",normalizedTitle:"cat é¨ç½²",charIndex:895},{level:2,title:"CAT æ¥è¡¨",slug:"cat-æ¥è¡¨",normalizedTitle:"cat æ¥è¡¨",charIndex:945},{level:2,title:"CAT éç½®",slug:"cat-éç½®",normalizedTitle:"cat éç½®",charIndex:1256},{level:2,title:"CAT æ¶æ",slug:"cat-æ¶æ",normalizedTitle:"cat æ¶æ",charIndex:1390},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:1886}],headersStr:"CAT ç®ä» CAT çä¼å¿ æ¯æçæ¶æ¯ç±»å CAT é¨ç½² CAT æ¥è¡¨ CAT éç½® CAT æ¶æ åèèµæ",content:"# CAT å¿«éå¥é¨\n\n\n# CAT ç®ä»\n\nCATï¼Central Application Trackingï¼ï¼æ¯åºäº Java å¼åçåå¸å¼å®æ¶çæ§ç³»ç»ãCAT å¨åºç¡å­å¨ãé«æ§è½éä¿¡ãå¤§è§æ¨¡å¨çº¿è®¿é®ãæå¡æ²»çãå®æ¶çæ§ãå®¹å¨ååéç¾¤æºè½è°åº¦ç­é¢åæä¾ä¸çé¢åçãç»ä¸çè§£å³æ¹æ¡ãCAT ç®åå¨ç¾å¢çäº§åå®ä½æ¯åºç¨å±çç»ä¸çæ§ç»ä»¶ï¼åºæ¬æ¥å¥äºç¾å¢æææ ¸å¿åºç¨ï¼å¨ä¸­é´ä»¶ï¼RPCãæ°æ®åºãç¼å­ãMQ ç­ï¼æ¡æ¶ä¸­å¾å°å¹¿æ³åºç¨ï¼ä¸ºåä¸å¡çº¿æä¾ç³»ç»çæ§è½ææ ãå¥åº·ç¶åµãå®æ¶åè­¦ç­ã\n\n\n# CAT çä¼å¿\n\n * å®æ¶å¤çï¼ä¿¡æ¯çä»·å¼ä¼éæ¶é´éåï¼å°¤å¶æ¯äºæå¤çè¿ç¨ä¸­\n * å¨éæ°æ®ï¼æå¼å§çè®¾è®¡ç®æ å°±æ¯å¨éééï¼å¨éçå¥½å¤æå¾å¤\n * é«å¯ç¨ï¼ææåºç¨é½åä¸äºï¼éè¦çæ§è¿ç«çï¼å¹¶åè¯å·¥ç¨å¸åçäºä»ä¹ï¼åå°æéè¿ååé®é¢å®ä½\n * æéå®¹å¿ï¼CAT æ¬èº«æéä¸åºè¯¥å½±åä¸å¡æ­£å¸¸è¿è½¬ï¼CAT æäºï¼åºç¨ä¸è¯¥åå½±åï¼åªæ¯çæ§è½åææ¶åå¼±\n * é«ååï¼è¦æ³è¿åçç¸ï¼éè¦å¨æ¹ä½å°çæ§ååº¦éï¼å¿é¡»è¦æè¶å¼ºçå¤çååè½å\n * å¯æ©å±ï¼æ¯æåå¸å¼ãè·¨ IDC é¨ç½²ï¼æ¨ªåæ©å±ççæ§ç³»ç»\n\n\n# æ¯æçæ¶æ¯ç±»å\n\nCAT çæ§ç³»ç»å°æ¯æ¬¡ URLãService çè¯·æ±åé¨æ§è¡æåµé½å°è£ä¸ºä¸ä¸ªå®æ´çæ¶æ¯æ ãæ¶æ¯æ å¯è½åæ¬ TransactionãEventãHeartbeatãMetric ç­ä¿¡æ¯ã\n\n * Transaction éåè®°å½è·¨è¶ç³»ç»è¾¹ççç¨åºè®¿é®è¡ä¸º,æ¯å¦è¿ç¨è°ç¨ï¼æ°æ®åºè°ç¨ï¼ä¹éåæ§è¡æ¶é´è¾é¿çä¸å¡é»è¾çæ§ï¼Transaction ç¨æ¥è®°å½ä¸æ®µä»£ç çæ§è¡æ¶é´åæ¬¡æ°\n * Event ç¨æ¥è®°å½ä¸ä»¶äºåççæ¬¡æ°ï¼æ¯å¦è®°å½ç³»ç»å¼å¸¸ï¼å®å transaction ç¸æ¯ç¼ºå°äºæ¶é´çç»è®¡ï¼å¼éæ¯ transaction è¦å°\n * Heartbeat è¡¨ç¤ºç¨åºåå®æäº§ççç»è®¡ä¿¡æ¯, å¦ CPU å©ç¨ç, åå­å©ç¨ç, è¿æ¥æ± ç¶æ, ç³»ç»è´è½½ç­\n * Metric ç¨äºè®°å½ä¸å¡ææ ãææ å¯è½åå«å¯¹ä¸ä¸ªææ è®°å½æ¬¡æ°ãè®°å½å¹³åå¼ãè®°å½æ»åï¼ä¸å¡ææ æä½ç»è®¡ç²åº¦ä¸º 1 åé\n\n\n\n\n# CAT é¨ç½²\n\nCat é¨ç½²å¯ä»¥åè å®æ¹ Wiki - æå¡ç«¯é¨ç½² ï¼éå¸¸è¯¦ç»ï¼ä¸èµè¿°ã\n\n\n# CAT æ¥è¡¨\n\nä¸å¶ä»çæ§å·¥å·ï¼å¦ ZipkinãSkyWalkingï¼ç¸æ¯ï¼CAT çæ¥è¡¨åè½æä¸°å¯ãæ¯æä»¥ä¸æ¥è¡¨ç±»åï¼\n\n * Transaction æ¥è¡¨ - ä¸æ®µä»£ç è¿è¡æ¶é´ãæ¬¡æ°ï¼æ¯å¦ URLãCacheãSQL æ§è¡æ¬¡æ°åååºæ¶é´\n * Event æ¥è¡¨ - ä¸è¡ä»£ç è¿è¡æ¬¡æ°ï¼æ¯å¦åºç°ä¸ä¸ªå¼å¸¸\n * Problem æ¥è¡¨ - æ ¹æ® Transaction/Event æ°æ®åæåºæ¥ç³»ç»å¯è½åºç°çå¼å¸¸ï¼åæ¬è®¿é®è¾æ¢çç¨åºç­\n * Heartbeat æ¥è¡¨ - JVM åé¨ä¸äºç¶æä¿¡æ¯ï¼æ¯å¦ Memoryï¼Thread ç­\n * Business æ¥è¡¨ - ä¸å¡çæ§æ¥è¡¨ï¼æ¯å¦è®¢åææ ï¼æ¯ä»ç­ä¸å¡ææ \n\n\n# CAT éç½®\n\nCAT æä¾äºä»¥ä¸éç½®ï¼\n\n * é¡¹ç®éç½® åæ¬é¡¹ç®åºæ¬ä¿¡æ¯ãæºå¨åç»éç½®\n * åè­¦éç½® åæ¬åºæ¬åè­¦éç½®ãåè­¦è§åãä»¥åå·ä½åè­¦éç½®\n * å¨å±éç½® åæ¬æå¡ç«¯éç½®ãæ¶æ¯éæ ·éç½®ãå®¢æ·ç«¯è·¯ç±\n * ä¸å¡ææ  åæ¬ä¸å¡çæ§éç½®ãä¸å¡æ ç­¾éç½®\n\n\n# CAT æ¶æ\n\nCAT ä¸»è¦åä¸ºä¸ä¸ªæ¨¡åï¼\n\n * cat-client - æä¾ç»ä¸å¡ä»¥åä¸­é´å±åç¹çåºå± SDKã\n * cat-consumer - ç¨äºå®æ¶åæä»å®¢æ·ç«¯çæä¾çæ°æ®ã\n * cat-home - ä½ä¸ºç¨æ·æä¾ç»ç¨æ·çå±ç¤ºçæ§å¶ç«¯ã\n\nå¨å®éå¼ååé¨ç½²ä¸­ï¼cat-consumer å cat-home æ¯é¨ç½²å¨ä¸ä¸ª jvm åé¨ï¼æ¯ä¸ª CAT æå¡ç«¯é½å¯ä»¥ä½ä¸º consumer ä¹å¯ä»¥ä½ä¸º homeï¼è¿æ ·æ¢è½åå°æ´ä¸ª CAT å±çº§ç»æï¼ä¹å¯ä»¥å¢å æ´ä¸ªç³»ç»ç¨³å®æ§ã\n\n\n\nä¸å¾æ¯ CAT ç®åå¤æºæ¿çæ´ä½ç»æå¾ï¼\n\n * è·¯ç±ä¸­å¿æ¯æ ¹æ®åºç¨æå¨æºæ¿ä¿¡æ¯æ¥å³å®å®¢æ·ç«¯ä¸æ¥ç CAT æå¡ç«¯å°å\n * æ¯ä¸ªæºæ¿åé¨é½æçç¬ç«çåå§ä¿¡æ¯å­å¨éç¾¤ HDFS\n * cat-home å¯ä»¥é¨ç½²å¨ä¸ä¸ªæºæ¿ä¹å¯ä»¥é¨ç½²å¨å¤ä¸ªæºæ¿ï¼å¨åæ¥è¡¨å±ç¤ºçæ¶åï¼cat-home ä¼ä» cat-consumer ä¸­è¿è¡è·¨æºæ¿çè°ç¨ï¼å°ææçæ°æ®åå¹¶å±ç¤ºç»ç¨æ·\n * å®éè¿ç¨ä¸­ï¼cat-consumerãcat-home ä»¥åè·¯ç±ä¸­å¿é½æ¯é¨ç½²å¨ä¸èµ·ï¼æ¯ä¸ªæå¡ç«¯èç¹é½å¯ä»¥åå½ä»»ä½ä¸ä¸ªè§è²\n\n\n# åèèµæ\n\n * CAT Github",normalizedContent:"# cat å¿«éå¥é¨\n\n\n# cat ç®ä»\n\ncatï¼central application trackingï¼ï¼æ¯åºäº java å¼åçåå¸å¼å®æ¶çæ§ç³»ç»ãcat å¨åºç¡å­å¨ãé«æ§è½éä¿¡ãå¤§è§æ¨¡å¨çº¿è®¿é®ãæå¡æ²»çãå®æ¶çæ§ãå®¹å¨ååéç¾¤æºè½è°åº¦ç­é¢åæä¾ä¸çé¢åçãç»ä¸çè§£å³æ¹æ¡ãcat ç®åå¨ç¾å¢çäº§åå®ä½æ¯åºç¨å±çç»ä¸çæ§ç»ä»¶ï¼åºæ¬æ¥å¥äºç¾å¢æææ ¸å¿åºç¨ï¼å¨ä¸­é´ä»¶ï¼rpcãæ°æ®åºãç¼å­ãmq ç­ï¼æ¡æ¶ä¸­å¾å°å¹¿æ³åºç¨ï¼ä¸ºåä¸å¡çº¿æä¾ç³»ç»çæ§è½ææ ãå¥åº·ç¶åµãå®æ¶åè­¦ç­ã\n\n\n# cat çä¼å¿\n\n * å®æ¶å¤çï¼ä¿¡æ¯çä»·å¼ä¼éæ¶é´éåï¼å°¤å¶æ¯äºæå¤çè¿ç¨ä¸­\n * å¨éæ°æ®ï¼æå¼å§çè®¾è®¡ç®æ å°±æ¯å¨éééï¼å¨éçå¥½å¤æå¾å¤\n * é«å¯ç¨ï¼ææåºç¨é½åä¸äºï¼éè¦çæ§è¿ç«çï¼å¹¶åè¯å·¥ç¨å¸åçäºä»ä¹ï¼åå°æéè¿ååé®é¢å®ä½\n * æéå®¹å¿ï¼cat æ¬èº«æéä¸åºè¯¥å½±åä¸å¡æ­£å¸¸è¿è½¬ï¼cat æäºï¼åºç¨ä¸è¯¥åå½±åï¼åªæ¯çæ§è½åææ¶åå¼±\n * é«ååï¼è¦æ³è¿åçç¸ï¼éè¦å¨æ¹ä½å°çæ§ååº¦éï¼å¿é¡»è¦æè¶å¼ºçå¤çååè½å\n * å¯æ©å±ï¼æ¯æåå¸å¼ãè·¨ idc é¨ç½²ï¼æ¨ªåæ©å±ççæ§ç³»ç»\n\n\n# æ¯æçæ¶æ¯ç±»å\n\ncat çæ§ç³»ç»å°æ¯æ¬¡ urlãservice çè¯·æ±åé¨æ§è¡æåµé½å°è£ä¸ºä¸ä¸ªå®æ´çæ¶æ¯æ ãæ¶æ¯æ å¯è½åæ¬ transactionãeventãheartbeatãmetric ç­ä¿¡æ¯ã\n\n * transaction éåè®°å½è·¨è¶ç³»ç»è¾¹ççç¨åºè®¿é®è¡ä¸º,æ¯å¦è¿ç¨è°ç¨ï¼æ°æ®åºè°ç¨ï¼ä¹éåæ§è¡æ¶é´è¾é¿çä¸å¡é»è¾çæ§ï¼transaction ç¨æ¥è®°å½ä¸æ®µä»£ç çæ§è¡æ¶é´åæ¬¡æ°\n * event ç¨æ¥è®°å½ä¸ä»¶äºåççæ¬¡æ°ï¼æ¯å¦è®°å½ç³»ç»å¼å¸¸ï¼å®å transaction ç¸æ¯ç¼ºå°äºæ¶é´çç»è®¡ï¼å¼éæ¯ transaction è¦å°\n * heartbeat è¡¨ç¤ºç¨åºåå®æäº§ççç»è®¡ä¿¡æ¯, å¦ cpu å©ç¨ç, åå­å©ç¨ç, è¿æ¥æ± ç¶æ, ç³»ç»è´è½½ç­\n * metric ç¨äºè®°å½ä¸å¡ææ ãææ å¯è½åå«å¯¹ä¸ä¸ªææ è®°å½æ¬¡æ°ãè®°å½å¹³åå¼ãè®°å½æ»åï¼ä¸å¡ææ æä½ç»è®¡ç²åº¦ä¸º 1 åé\n\n\n\n\n# cat é¨ç½²\n\ncat é¨ç½²å¯ä»¥åè å®æ¹ wiki - æå¡ç«¯é¨ç½² ï¼éå¸¸è¯¦ç»ï¼ä¸èµè¿°ã\n\n\n# cat æ¥è¡¨\n\nä¸å¶ä»çæ§å·¥å·ï¼å¦ zipkinãskywalkingï¼ç¸æ¯ï¼cat çæ¥è¡¨åè½æä¸°å¯ãæ¯æä»¥ä¸æ¥è¡¨ç±»åï¼\n\n * transaction æ¥è¡¨ - ä¸æ®µä»£ç è¿è¡æ¶é´ãæ¬¡æ°ï¼æ¯å¦ urlãcacheãsql æ§è¡æ¬¡æ°åååºæ¶é´\n * event æ¥è¡¨ - ä¸è¡ä»£ç è¿è¡æ¬¡æ°ï¼æ¯å¦åºç°ä¸ä¸ªå¼å¸¸\n * problem æ¥è¡¨ - æ ¹æ® transaction/event æ°æ®åæåºæ¥ç³»ç»å¯è½åºç°çå¼å¸¸ï¼åæ¬è®¿é®è¾æ¢çç¨åºç­\n * heartbeat æ¥è¡¨ - jvm åé¨ä¸äºç¶æä¿¡æ¯ï¼æ¯å¦ memoryï¼thread ç­\n * business æ¥è¡¨ - ä¸å¡çæ§æ¥è¡¨ï¼æ¯å¦è®¢åææ ï¼æ¯ä»ç­ä¸å¡ææ \n\n\n# cat éç½®\n\ncat æä¾äºä»¥ä¸éç½®ï¼\n\n * é¡¹ç®éç½® åæ¬é¡¹ç®åºæ¬ä¿¡æ¯ãæºå¨åç»éç½®\n * åè­¦éç½® åæ¬åºæ¬åè­¦éç½®ãåè­¦è§åãä»¥åå·ä½åè­¦éç½®\n * å¨å±éç½® åæ¬æå¡ç«¯éç½®ãæ¶æ¯éæ ·éç½®ãå®¢æ·ç«¯è·¯ç±\n * ä¸å¡ææ  åæ¬ä¸å¡çæ§éç½®ãä¸å¡æ ç­¾éç½®\n\n\n# cat æ¶æ\n\ncat ä¸»è¦åä¸ºä¸ä¸ªæ¨¡åï¼\n\n * cat-client - æä¾ç»ä¸å¡ä»¥åä¸­é´å±åç¹çåºå± sdkã\n * cat-consumer - ç¨äºå®æ¶åæä»å®¢æ·ç«¯çæä¾çæ°æ®ã\n * cat-home - ä½ä¸ºç¨æ·æä¾ç»ç¨æ·çå±ç¤ºçæ§å¶ç«¯ã\n\nå¨å®éå¼ååé¨ç½²ä¸­ï¼cat-consumer å cat-home æ¯é¨ç½²å¨ä¸ä¸ª jvm åé¨ï¼æ¯ä¸ª cat æå¡ç«¯é½å¯ä»¥ä½ä¸º consumer ä¹å¯ä»¥ä½ä¸º homeï¼è¿æ ·æ¢è½åå°æ´ä¸ª cat å±çº§ç»æï¼ä¹å¯ä»¥å¢å æ´ä¸ªç³»ç»ç¨³å®æ§ã\n\n\n\nä¸å¾æ¯ cat ç®åå¤æºæ¿çæ´ä½ç»æå¾ï¼\n\n * è·¯ç±ä¸­å¿æ¯æ ¹æ®åºç¨æå¨æºæ¿ä¿¡æ¯æ¥å³å®å®¢æ·ç«¯ä¸æ¥ç cat æå¡ç«¯å°å\n * æ¯ä¸ªæºæ¿åé¨é½æçç¬ç«çåå§ä¿¡æ¯å­å¨éç¾¤ hdfs\n * cat-home å¯ä»¥é¨ç½²å¨ä¸ä¸ªæºæ¿ä¹å¯ä»¥é¨ç½²å¨å¤ä¸ªæºæ¿ï¼å¨åæ¥è¡¨å±ç¤ºçæ¶åï¼cat-home ä¼ä» cat-consumer ä¸­è¿è¡è·¨æºæ¿çè°ç¨ï¼å°ææçæ°æ®åå¹¶å±ç¤ºç»ç¨æ·\n * å®éè¿ç¨ä¸­ï¼cat-consumerãcat-home ä»¥åè·¯ç±ä¸­å¿é½æ¯é¨ç½²å¨ä¸èµ·ï¼æ¯ä¸ªæå¡ç«¯èç¹é½å¯ä»¥åå½ä»»ä½ä¸ä¸ªè§è²\n\n\n# åèèµæ\n\n * cat github",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Zipkin å¿«éå¥é¨",frontmatter:{title:"Zipkin å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","çæ§è¯æ­"],tags:["Java","çæ§","Zipkin"],abbrlink:"bed182d4",date:"2020-03-23T22:56:45.000Z",permalink:"/pages/82c168/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/03.%E7%9B%91%E6%8E%A7%E8%AF%8A%E6%96%AD/03.Zipkin.html",relativePath:"11.è½¯ä»¶/03.çæ§è¯æ­/03.Zipkin.md",key:"v-1a493fea",path:"/pages/82c168/",headers:[{level:2,title:"ä¸ãZipkin ç®ä»",slug:"ä¸ãzipkin-ç®ä»",normalizedTitle:"ä¸ãzipkin ç®ä»",charIndex:308},{level:3,title:"ç¹æ§",slug:"ç¹æ§",normalizedTitle:"ç¹æ§",charIndex:324},{level:3,title:"å¤å¹³å°",slug:"å¤å¹³å°",normalizedTitle:"å¤å¹³å°",charIndex:516},{level:3,title:"æ°æ®",slug:"æ°æ®",normalizedTitle:"æ°æ®",charIndex:46},{level:2,title:"äºãZipkin å®è£",slug:"äºãzipkin-å®è£",normalizedTitle:"äºãzipkin å®è£",charIndex:809},{level:3,title:"Docker",slug:"docker",normalizedTitle:"docker",charIndex:825},{level:3,title:"Java",slug:"java",normalizedTitle:"java",charIndex:28},{level:3,title:"ç¼è¯æ¹å¼",slug:"ç¼è¯æ¹å¼",normalizedTitle:"ç¼è¯æ¹å¼",charIndex:1014},{level:2,title:"ä¸ãZipkin æ¶æ",slug:"ä¸ãzipkin-æ¶æ",normalizedTitle:"ä¸ãzipkin æ¶æ",charIndex:1307},{level:3,title:"Zipkin Server",slug:"zipkin-server",normalizedTitle:"zipkin server",charIndex:1468},{level:3,title:"Zipkin Client",slug:"zipkin-client",normalizedTitle:"zipkin client",charIndex:2035},{level:2,title:"åãZipkin å®¢æ·ç«¯",slug:"åãzipkin-å®¢æ·ç«¯",normalizedTitle:"åãzipkin å®¢æ·ç«¯",charIndex:5139},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:5297}],headersStr:"ä¸ãZipkin ç®ä» ç¹æ§ å¤å¹³å° æ°æ® äºãZipkin å®è£ Docker Java ç¼è¯æ¹å¼ ä¸ãZipkin æ¶æ Zipkin Server Zipkin Client åãZipkin å®¢æ·ç«¯ åèèµæ",content:'# Zipkin å¿«éå¥é¨\n\nZipkin æ¯ä¸ä¸ªåºäº Java å¼åçãå¼æºçãåå¸å¼å®æ¶æ°æ®è·è¸ªç³»ç»ï¼Distributed Tracking Systemï¼ãå®ééæå©äºè§£å³æå¡æ¶æä¸­å»¶è¿é®é¢çå®æ¶æ°æ®ã\n\nZipkin ä¸»è¦åè½æ¯èéæ¥èªåä¸ªå¼æç³»ç»çå®æ¶çæ§æ°æ®ãåå¸å¼è·è¸ªç³»ç»è¿æå¶ä»æ¯è¾æççå®ç°ï¼ä¾å¦ï¼Naver ç PinpointãApache ç HTraceãé¿éçé¹°ç¼ Tracingãäº¬ä¸ç Hydraãæ°æµªç Watchmanï¼ç¾å¢ç¹è¯ç CATï¼skywalking ç­ã\n\nZipkin åºäº Google Dapper çè®ºæè®¾è®¡èæ¥ï¼ç± Twitter å¬å¸å¼åè´¡ç®ã\n\n\n# ä¸ãZipkin ç®ä»\n\n\n# ç¹æ§\n\nå¦ææ¥å¿æä»¶ä¸­æè·è¸ª IDï¼åå¯ä»¥ç´æ¥è·³è³è¯¥è·è¸ª IDã å¦åï¼æ¨å¯ä»¥åºäºå±æ§è¿è¡æ¥è¯¢ï¼ä¾å¦æå¡ï¼æä½åç§°ï¼æ ç­¾åæç»­æ¶é´ã å°ä¸ºæ¨æ»ç»ä¸äºæè¶£çæ°æ®ï¼ä¾å¦å¨æå¡ä¸­è±è´¹çæ¶é´ç¾åæ¯ä»¥åæä½æ¯å¦å¤±è´¥ã\n\nZipkin UI è¿æä¾äºä¸ä¸ªä¾èµå³ç³»å¾ï¼è¯¥å³ç³»å¾æ¾ç¤ºäºæ¯ä¸ªåºç¨ç¨åºä¸­è·è¸ªäºå¤å°ä¸ªè¯·æ±ãè¿å¯¹äºè¯å«èåè¡ä¸ºï¼åæ¬éè¯¯è·¯å¾æå¯¹ä¸èµæä½¿ç¨çæå¡çè°ç¨ï¼å¾æå¸®å©ã\n\n\n\n\n# å¤å¹³å°\n\nZipkin å®æ¹æ¯æ C#ãGoãJavaãJavaScriptãRubyãScalaãPHP è¯­è¨ã\n\né¤æ­¤ä»¥å¤ï¼ç¤¾åºè¿è´¡ç®äºå¤ç§å¶ä»è¯­è¨çæ¯æï¼è¯¦æå¯ä»¥åèå®æ¹ææ¡£ï¼Tracers and Instrumentation\n\n\n# æ°æ®\n\nZipkin æå¡å¨æç»äºç¨äºééåå­å¨æ°æ®çæ©å±ã\n\né»è®¤æåµä¸ï¼æ°æ®å¯ä»¥éè¿ Httpï¼Kafka ãRabbitMQ æ RPC ä¼ è¾ã\n\nå¹¶å­å¨å¨åå­ä¸­æ MySQLãCassandra æ Elasticsearch ä¸­ã\n\næ°æ®ä»¥ json å½¢å¼å­å¨ï¼å¯ä»¥åèï¼Zipkin å®æ¹ç Swagger API\n\n\n\n\n# äºãZipkin å®è£\n\n\n# Docker\n\nDocker å¯å¨æ¹å¼ï¼\n\ndocker run -d -p 9411:9411 openzipkin/zipkin\n\n\n\n# Java\n\n> æ³¨æï¼å¿é¡»è¿è¡å¨ JDK8+ ç¯å¢\n\nJava å¯å¨æ¹å¼ï¼\n\ncurl -sSL https://zipkin.io/quickstart.sh | bash -s\njava -jar zipkin.jar\n\n\n\n# ç¼è¯æ¹å¼\n\néç¨äºéè¦è®¢å¶åçåºæ¯ã\n\n# get the latest source\ngit clone https://github.com/openzipkin/zipkin\ncd zipkin\n# Build the server and also make its dependencies\n./mvnw -DskipTests --also-make -pl zipkin-server clean install\n# Run the server\njava -jar ./zipkin-server/target/zipkin-server-*exec.jar\n\n\n\n# ä¸ãZipkin æ¶æ\n\nZipKin å¯ä»¥åä¸ºä¸¤é¨åï¼\n\n * ä¸é¨åæ¯ Zipkin serverï¼ç¨æ¥ä½ä¸ºæ°æ®çééå­å¨ãæ°æ®åæä¸å±ç¤ºï¼\n * å¦ä¸é¨åæ¯ Zipkin client æ¯ Zipkin åºäºä¸åçè¯­è¨åæ¡æ¶å°è£çä¸äºåå®¢æ·ç«¯å·¥å·ï¼è¿äºå·¥å·å®æäºè¿½è¸ªæ°æ®ççæä¸ä¸æ¥åè½ã\n\næ¶æå¦ä¸ï¼\n\n\n\n\n# Zipkin Server\n\nZipkin Server ä¸»è¦åæ¬åä¸ªæ¨¡åï¼\n\n * Collector - è´è´£ééå®¢æ·ç«¯ä¼ è¾çæ°æ®ã\n * Storage - è´è´£å­å¨ééçæ°æ®ãå½åæ¯æ Memoryï¼MySQLï¼Cassandraï¼ElasticSearch ç­ï¼é»è®¤å­å¨å¨åå­ä¸­ã\n * APIï¼Queryï¼ - è´è´£æ¥è¯¢ Storage ä¸­å­å¨çæ°æ®ãæä¾ç®åç JSON API è·åæ°æ®ï¼ä¸»è¦æä¾ç» web UI ä½¿ç¨ã\n * UI - æä¾ç®åç web çé¢ã\n\nInstrumented Client å Instrumented Serverï¼æ¯æåå¸å¼æ¶æä¸­ä½¿ç¨äº Trace å·¥å·çä¸¤ä¸ªåºç¨ï¼Client ä¼è°ç¨ Server æä¾çæå¡ï¼ä¸¤èé½ä¼å Zipkin ä¸æ¥ Trace ç¸å³ä¿¡æ¯ãå¨ Client å Server éè¿ Transport ä¸æ¥ Trace ä¿¡æ¯åï¼ç± Zipkin ç Collector æ¨¡åæ¥æ¶ï¼å¹¶ç± Storage æ¨¡åå°æ°æ®å­å¨å¨å¯¹åºçå­å¨ä»è´¨ä¸­ï¼ç¶å Zipkin æä¾ API ä¾ UI çé¢æ¥è¯¢ Trace è·è¸ªä¿¡æ¯ãNon-Instrumented Serverï¼æçæ¯æªä½¿ç¨ Trace å·¥å·ç Serverï¼æ¾ç¶å®ä¸ä¼ä¸æ¥ Trace ä¿¡æ¯ã\n\n\n# Zipkin Client\n\n * Tracer - Tracer å­å¨äºä½ çåºç¨ä¸­ï¼å®è´è´£ééå³äºå·²åçæä½çå®æ¶åæ°æ®ãå®ä»¬éå¸¸ä¼æ£æµåºï¼å æ­¤å¯¹äºç¨æ·æ¯éæçãä¾å¦ï¼å·²æ£æµç Web æå¡å¨è®°å½å®ä½æ¶æ¥æ¶å°è¯·æ±ï¼ä»¥åä½æ¶åéååºãæ¶éçè·è¸ªæ°æ®ç§°ä¸ºè·¨åº¦ï¼Spanï¼ã\n * Instrumentation - Instrumentation ä¿è¯äºçäº§ç¯å¢çå®å¨æ§åå¾å°çå¼éãå æ­¤ï¼å®ä»¬ä»å¨åé¨ä¼ æ­ IDï¼ä»¥åç¥æ¥æ¶æ¹æ­£å¨è¿è¡è¿½è¸ªãå®æç Span å°éè¿å¤é¨éä¿¡åç¥ Zipkinï¼ç±»ä¼¼äºåºç¨ç¨åºå¼æ­¥æ¥åææ çæ¹å¼ãä¾å¦ï¼å½è·è¸ªæä¸ªæä½å¹¶ä¸éè¦ååº http è¯·æ±æ¶ï¼ä¼æ·»å ä¸äº header æ¥ä¼ æ­ IDãheader ä¸ç¨äºåéè¯¦ç»ä¿¡æ¯ï¼ä¾å¦æä½åç§°ã\n * Reporter - è½å¤å°æ°æ®åéå° Zipkin çæ£æµåºç¨ç¨åºä¸­çç»ä»¶ï¼è¢«ç§°ä¸º ReporterãReporter æå¤ç§ä¼ è¾æ¹å¼ï¼å¯ä»¥å°è·è¸ªæ°æ®åéå° Zipkin ééå¨ï¼åèå°è·è¸ªæ°æ®æä¹åä¿å­å°å­å¨ä¸­ãç¨åï¼API ä¼æ¥è¯¢å­å¨ä»¥å UI æä¾æ¸²ææ°æ®ã\n\nä»¥ä¸æ¯ Zipkin çä¸ä¸ªç¤ºä¾å·¥ä½æµï¼\n\nâââââââââââââââ âââââââââââââââââââââââââ  âââââââââââââââ  ââââââââââââââââââââ\nâ User Code   â â Trace Instrumentation â  â Http Client â  â Zipkin Collector â\nâââââââââââââââ âââââââââââââââââââââââââ  âââââââââââââââ  ââââââââââââââââââââ\n       â                 â                         â                 â\n           âââââââââââ\n       â âââ¤GET /foo âââ¶ â âââââ                   â                 â\n           âââââââââââ         â record tags\n       â                 â âââââ                   â                 â\n                           âââââ\n       â                 â     â add trace headers â                 â\n                           âââââ\n       â                 â âââââ                   â                 â\n                               â record timestamp\n       â                 â âââââ                   â                 â\n                             âââââââââââââââââââ\n       â                 â âââ¤GET /foo         âââ¶ â                 â\n                             âX-B3-TraceId: aa â     âââââ\n       â                 â   âX-B3-SpanId: 6b  â   â     â           â\n                             âââââââââââââââââââ         â invoke\n       â                 â                         â     â request   â\n                                                         â\n       â                 â                         â     â           â\n                                 ââââââââââ          âââââ\n       â                 â âââââââ¤200 OK  ââââââââ â                 â\n                           âââââ ââââââââââ\n       â                 â     â record duration   â                 â\n            ââââââââââ     âââââ\n       â ââââ¤200 OK  âââ â                         â                 â\n            ââââââââââ       ââââââââââââââââââââââââââââââââââ\n       â                 â âââ¤ asynchronously report span     ââââââ¶ â\n                             â                                â\n                             â{                               â\n                             â  "traceId": "aa",              â\n                             â  "id": "6b",                   â\n                             â  "name": "get",                â\n                             â  "timestamp": 1483945573944000,â\n                             â  "duration": 386000,           â\n                             â  "annotations": [              â\n                             â--snip--                        â\n                             ââââââââââââââââââââââââââââââââââ\n\n\nInstrumented client å server æ¯åå«ä½¿ç¨äº ZipKin Client çæå¡ï¼Zipkin Client ä¼æ ¹æ®éç½®å°è¿½è¸ªæ°æ®åéå° Zipkin Server ä¸­è¿è¡æ°æ®å­å¨ãåæåå±ç¤ºã\n\n\n# åãZipkin å®¢æ·ç«¯\n\nBrave æ¯ Java çç zipkin å®¢æ·ç«¯ã\n\nä¸è¬ä¸ä¼æå¨ç¼å Trace ç¸å³çä»£ç ï¼Brave æä¾å¯ä¸äºå¼ç®±å³ç¨çåºï¼å¸®å©æä»¬è¿½è¸ªä¸äºç¹å®çè¯·æ±ãæ¯å¦ï¼dubboãgrpcãservletãmysqlãhttpClientãkafkaãspringMVC ç­ã\n\n\n# åèèµæ\n\n * Zipkin å®ç½\n * Zipkin Github\n * brave',normalizedContent:'# zipkin å¿«éå¥é¨\n\nzipkin æ¯ä¸ä¸ªåºäº java å¼åçãå¼æºçãåå¸å¼å®æ¶æ°æ®è·è¸ªç³»ç»ï¼distributed tracking systemï¼ãå®ééæå©äºè§£å³æå¡æ¶æä¸­å»¶è¿é®é¢çå®æ¶æ°æ®ã\n\nzipkin ä¸»è¦åè½æ¯èéæ¥èªåä¸ªå¼æç³»ç»çå®æ¶çæ§æ°æ®ãåå¸å¼è·è¸ªç³»ç»è¿æå¶ä»æ¯è¾æççå®ç°ï¼ä¾å¦ï¼naver ç pinpointãapache ç htraceãé¿éçé¹°ç¼ tracingãäº¬ä¸ç hydraãæ°æµªç watchmanï¼ç¾å¢ç¹è¯ç catï¼skywalking ç­ã\n\nzipkin åºäº google dapper çè®ºæè®¾è®¡èæ¥ï¼ç± twitter å¬å¸å¼åè´¡ç®ã\n\n\n# ä¸ãzipkin ç®ä»\n\n\n# ç¹æ§\n\nå¦ææ¥å¿æä»¶ä¸­æè·è¸ª idï¼åå¯ä»¥ç´æ¥è·³è³è¯¥è·è¸ª idã å¦åï¼æ¨å¯ä»¥åºäºå±æ§è¿è¡æ¥è¯¢ï¼ä¾å¦æå¡ï¼æä½åç§°ï¼æ ç­¾åæç»­æ¶é´ã å°ä¸ºæ¨æ»ç»ä¸äºæè¶£çæ°æ®ï¼ä¾å¦å¨æå¡ä¸­è±è´¹çæ¶é´ç¾åæ¯ä»¥åæä½æ¯å¦å¤±è´¥ã\n\nzipkin ui è¿æä¾äºä¸ä¸ªä¾èµå³ç³»å¾ï¼è¯¥å³ç³»å¾æ¾ç¤ºäºæ¯ä¸ªåºç¨ç¨åºä¸­è·è¸ªäºå¤å°ä¸ªè¯·æ±ãè¿å¯¹äºè¯å«èåè¡ä¸ºï¼åæ¬éè¯¯è·¯å¾æå¯¹ä¸èµæä½¿ç¨çæå¡çè°ç¨ï¼å¾æå¸®å©ã\n\n\n\n\n# å¤å¹³å°\n\nzipkin å®æ¹æ¯æ c#ãgoãjavaãjavascriptãrubyãscalaãphp è¯­è¨ã\n\né¤æ­¤ä»¥å¤ï¼ç¤¾åºè¿è´¡ç®äºå¤ç§å¶ä»è¯­è¨çæ¯æï¼è¯¦æå¯ä»¥åèå®æ¹ææ¡£ï¼tracers and instrumentation\n\n\n# æ°æ®\n\nzipkin æå¡å¨æç»äºç¨äºééåå­å¨æ°æ®çæ©å±ã\n\né»è®¤æåµä¸ï¼æ°æ®å¯ä»¥éè¿ httpï¼kafka ãrabbitmq æ rpc ä¼ è¾ã\n\nå¹¶å­å¨å¨åå­ä¸­æ mysqlãcassandra æ elasticsearch ä¸­ã\n\næ°æ®ä»¥ json å½¢å¼å­å¨ï¼å¯ä»¥åèï¼zipkin å®æ¹ç swagger api\n\n\n\n\n# äºãzipkin å®è£\n\n\n# docker\n\ndocker å¯å¨æ¹å¼ï¼\n\ndocker run -d -p 9411:9411 openzipkin/zipkin\n\n\n\n# java\n\n> æ³¨æï¼å¿é¡»è¿è¡å¨ jdk8+ ç¯å¢\n\njava å¯å¨æ¹å¼ï¼\n\ncurl -ssl https://zipkin.io/quickstart.sh | bash -s\njava -jar zipkin.jar\n\n\n\n# ç¼è¯æ¹å¼\n\néç¨äºéè¦è®¢å¶åçåºæ¯ã\n\n# get the latest source\ngit clone https://github.com/openzipkin/zipkin\ncd zipkin\n# build the server and also make its dependencies\n./mvnw -dskiptests --also-make -pl zipkin-server clean install\n# run the server\njava -jar ./zipkin-server/target/zipkin-server-*exec.jar\n\n\n\n# ä¸ãzipkin æ¶æ\n\nzipkin å¯ä»¥åä¸ºä¸¤é¨åï¼\n\n * ä¸é¨åæ¯ zipkin serverï¼ç¨æ¥ä½ä¸ºæ°æ®çééå­å¨ãæ°æ®åæä¸å±ç¤ºï¼\n * å¦ä¸é¨åæ¯ zipkin client æ¯ zipkin åºäºä¸åçè¯­è¨åæ¡æ¶å°è£çä¸äºåå®¢æ·ç«¯å·¥å·ï¼è¿äºå·¥å·å®æäºè¿½è¸ªæ°æ®ççæä¸ä¸æ¥åè½ã\n\næ¶æå¦ä¸ï¼\n\n\n\n\n# zipkin server\n\nzipkin server ä¸»è¦åæ¬åä¸ªæ¨¡åï¼\n\n * collector - è´è´£ééå®¢æ·ç«¯ä¼ è¾çæ°æ®ã\n * storage - è´è´£å­å¨ééçæ°æ®ãå½åæ¯æ memoryï¼mysqlï¼cassandraï¼elasticsearch ç­ï¼é»è®¤å­å¨å¨åå­ä¸­ã\n * apiï¼queryï¼ - è´è´£æ¥è¯¢ storage ä¸­å­å¨çæ°æ®ãæä¾ç®åç json api è·åæ°æ®ï¼ä¸»è¦æä¾ç» web ui ä½¿ç¨ã\n * ui - æä¾ç®åç web çé¢ã\n\ninstrumented client å instrumented serverï¼æ¯æåå¸å¼æ¶æä¸­ä½¿ç¨äº trace å·¥å·çä¸¤ä¸ªåºç¨ï¼client ä¼è°ç¨ server æä¾çæå¡ï¼ä¸¤èé½ä¼å zipkin ä¸æ¥ trace ç¸å³ä¿¡æ¯ãå¨ client å server éè¿ transport ä¸æ¥ trace ä¿¡æ¯åï¼ç± zipkin ç collector æ¨¡åæ¥æ¶ï¼å¹¶ç± storage æ¨¡åå°æ°æ®å­å¨å¨å¯¹åºçå­å¨ä»è´¨ä¸­ï¼ç¶å zipkin æä¾ api ä¾ ui çé¢æ¥è¯¢ trace è·è¸ªä¿¡æ¯ãnon-instrumented serverï¼æçæ¯æªä½¿ç¨ trace å·¥å·ç serverï¼æ¾ç¶å®ä¸ä¼ä¸æ¥ trace ä¿¡æ¯ã\n\n\n# zipkin client\n\n * tracer - tracer å­å¨äºä½ çåºç¨ä¸­ï¼å®è´è´£ééå³äºå·²åçæä½çå®æ¶åæ°æ®ãå®ä»¬éå¸¸ä¼æ£æµåºï¼å æ­¤å¯¹äºç¨æ·æ¯éæçãä¾å¦ï¼å·²æ£æµç web æå¡å¨è®°å½å®ä½æ¶æ¥æ¶å°è¯·æ±ï¼ä»¥åä½æ¶åéååºãæ¶éçè·è¸ªæ°æ®ç§°ä¸ºè·¨åº¦ï¼spanï¼ã\n * instrumentation - instrumentation ä¿è¯äºçäº§ç¯å¢çå®å¨æ§åå¾å°çå¼éãå æ­¤ï¼å®ä»¬ä»å¨åé¨ä¼ æ­ idï¼ä»¥åç¥æ¥æ¶æ¹æ­£å¨è¿è¡è¿½è¸ªãå®æç span å°éè¿å¤é¨éä¿¡åç¥ zipkinï¼ç±»ä¼¼äºåºç¨ç¨åºå¼æ­¥æ¥åææ çæ¹å¼ãä¾å¦ï¼å½è·è¸ªæä¸ªæä½å¹¶ä¸éè¦ååº http è¯·æ±æ¶ï¼ä¼æ·»å ä¸äº header æ¥ä¼ æ­ idãheader ä¸ç¨äºåéè¯¦ç»ä¿¡æ¯ï¼ä¾å¦æä½åç§°ã\n * reporter - è½å¤å°æ°æ®åéå° zipkin çæ£æµåºç¨ç¨åºä¸­çç»ä»¶ï¼è¢«ç§°ä¸º reporterãreporter æå¤ç§ä¼ è¾æ¹å¼ï¼å¯ä»¥å°è·è¸ªæ°æ®åéå° zipkin ééå¨ï¼åèå°è·è¸ªæ°æ®æä¹åä¿å­å°å­å¨ä¸­ãç¨åï¼api ä¼æ¥è¯¢å­å¨ä»¥å ui æä¾æ¸²ææ°æ®ã\n\nä»¥ä¸æ¯ zipkin çä¸ä¸ªç¤ºä¾å·¥ä½æµï¼\n\nâââââââââââââââ âââââââââââââââââââââââââ  âââââââââââââââ  ââââââââââââââââââââ\nâ user code   â â trace instrumentation â  â http client â  â zipkin collector â\nâââââââââââââââ âââââââââââââââââââââââââ  âââââââââââââââ  ââââââââââââââââââââ\n       â                 â                         â                 â\n           âââââââââââ\n       â âââ¤get /foo âââ¶ â âââââ                   â                 â\n           âââââââââââ         â record tags\n       â                 â âââââ                   â                 â\n                           âââââ\n       â                 â     â add trace headers â                 â\n                           âââââ\n       â                 â âââââ                   â                 â\n                               â record timestamp\n       â                 â âââââ                   â                 â\n                             âââââââââââââââââââ\n       â                 â âââ¤get /foo         âââ¶ â                 â\n                             âx-b3-traceid: aa â     âââââ\n       â                 â   âx-b3-spanid: 6b  â   â     â           â\n                             âââââââââââââââââââ         â invoke\n       â                 â                         â     â request   â\n                                                         â\n       â                 â                         â     â           â\n                                 ââââââââââ          âââââ\n       â                 â âââââââ¤200 ok  ââââââââ â                 â\n                           âââââ ââââââââââ\n       â                 â     â record duration   â                 â\n            ââââââââââ     âââââ\n       â ââââ¤200 ok  âââ â                         â                 â\n            ââââââââââ       ââââââââââââââââââââââââââââââââââ\n       â                 â âââ¤ asynchronously report span     ââââââ¶ â\n                             â                                â\n                             â{                               â\n                             â  "traceid": "aa",              â\n                             â  "id": "6b",                   â\n                             â  "name": "get",                â\n                             â  "timestamp": 1483945573944000,â\n                             â  "duration": 386000,           â\n                             â  "annotations": [              â\n                             â--snip--                        â\n                             ââââââââââââââââââââââââââââââââââ\n\n\ninstrumented client å server æ¯åå«ä½¿ç¨äº zipkin client çæå¡ï¼zipkin client ä¼æ ¹æ®éç½®å°è¿½è¸ªæ°æ®åéå° zipkin server ä¸­è¿è¡æ°æ®å­å¨ãåæåå±ç¤ºã\n\n\n# åãzipkin å®¢æ·ç«¯\n\nbrave æ¯ java çç zipkin å®¢æ·ç«¯ã\n\nä¸è¬ä¸ä¼æå¨ç¼å trace ç¸å³çä»£ç ï¼brave æä¾å¯ä¸äºå¼ç®±å³ç¨çåºï¼å¸®å©æä»¬è¿½è¸ªä¸äºç¹å®çè¯·æ±ãæ¯å¦ï¼dubboãgrpcãservletãmysqlãhttpclientãkafkaãspringmvc ç­ã\n\n\n# åèèµæ\n\n * zipkin å®ç½\n * zipkin github\n * brave',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"SkyWalking å¿«éå¥é¨",frontmatter:{title:"SkyWalking å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","çæ§è¯æ­"],tags:["Java","çæ§","SkyWalking"],abbrlink:"a6f15946",date:"2020-02-07T23:04:47.000Z",permalink:"/pages/d82d3c/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/03.%E7%9B%91%E6%8E%A7%E8%AF%8A%E6%96%AD/04.Skywalking.html",relativePath:"11.è½¯ä»¶/03.çæ§è¯æ­/04.Skywalking.md",key:"v-19f95e8b",path:"/pages/d82d3c/",headers:[{level:2,title:"ä¸ãSkyWalking ç®ä»",slug:"ä¸ãskywalking-ç®ä»",normalizedTitle:"ä¸ãskywalking ç®ä»",charIndex:106},{level:3,title:"SkyWalking ç¹æ§",slug:"skywalking-ç¹æ§",normalizedTitle:"skywalking ç¹æ§",charIndex:194},{level:3,title:"SkyWalking æ ¸å¿æ¦å¿µ",slug:"skywalking-æ ¸å¿æ¦å¿µ",normalizedTitle:"skywalking æ ¸å¿æ¦å¿µ",charIndex:337},{level:2,title:"äºãSkyWalking æ¶æ",slug:"äºãskywalking-æ¶æ",normalizedTitle:"äºãskywalking æ¶æ",charIndex:569},{level:2,title:"ä¸ãSkyWalking å®è£",slug:"ä¸ãskywalking-å®è£",normalizedTitle:"ä¸ãskywalking å®è£",charIndex:1028},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:1177}],headersStr:"ä¸ãSkyWalking ç®ä» SkyWalking ç¹æ§ SkyWalking æ ¸å¿æ¦å¿µ äºãSkyWalking æ¶æ ä¸ãSkyWalking å®è£ åèèµæ",content:"# SkyWalking å¿«éå¥é¨\n\nSkyWalking æ¯ä¸ä¸ªåºäº Java å¼åçåå¸å¼ç³»ç»çåºç¨ç¨åºæ§è½çè§å·¥å·ï¼ä¸ä¸ºå¾®æå¡ãäºåçæ¶æååºäºå®¹å¨ï¼DockerãK8sãMesosï¼æ¶æèè®¾è®¡ã\n\n\n# ä¸ãSkyWalking ç®ä»\n\nSkyWalking æ¯è§å¯æ§åæå¹³å°ååºç¨æ§è½ç®¡çç³»ç»ã\n\næä¾åå¸å¼è¿½è¸ªãæå¡ç½æ ¼é¥æµåæãåº¦éèååå¯è§åä¸ä½åè§£å³æ¹æ¡ã\n\n\n\n\n# SkyWalking ç¹æ§\n\n * å¤ç§çæ§ææ®µï¼è¯­è¨æ¢éå service mesh\n * å¤è¯­è¨èªå¨æ¢éï¼Javaï¼.NET Core å Node.JS\n * è½»éé«æï¼ä¸éè¦å¤§æ°æ®\n * æ¨¡ååï¼UIãå­å¨ãéç¾¤ç®¡çå¤ç§æºå¶å¯é\n * æ¯æåè­¦\n * ä¼ç§çå¯è§åæ¹æ¡\n\n\n# SkyWalking æ ¸å¿æ¦å¿µ\n\n * Service - æå¡ãä»£è¡¨ä¸ç»ä¸ºä¼ å¥è¯·æ±æä¾ç¸åçè¡ä¸ºçå·¥ä½è´è½½ã ä½¿ç¨ä»£çæ SDK æ¶ï¼å¯ä»¥å®ä¹æå¡åç§°ã\n * Service Instance - æå¡å®ä¾ãæå¡ç»ä¸­çæ¯ä¸ªå·¥ä½è´è½½é½ç§°ä¸ºä¸ä¸ªå®ä¾ãå°±å Kubernetes ä¸­ç Pod ä¸æ ·ï¼å®å¨ OS ä¸­ä¸å¿æ¯åä¸ªè¿ç¨ã\n * Endpoint - ç«¯ç¹ãå®æ¯ç¹å®æå¡ä¸­ç¨äºä¼ å¥è¯·æ±çè·¯å¾ï¼ä¾å¦ HTTP URI è·¯å¾æ RPC æå¡ç±»+æ¹æ³ç­¾åã\n\n\n# äºãSkyWalking æ¶æ\n\nä»é»è¾ä¸è®²ï¼SkyWalking åä¸ºåä¸ªé¨åï¼æ¢éï¼Probesï¼ï¼å¹³å°åç«¯ï¼å­å¨å UIã\n\n\n\n * æ¢éï¼Probesï¼ - æ¢éæ¯æéæå°ç®æ ç³»ç»ä¸­çä»£çæ SDK åºãå®ä»¬è´è´£æ¶éæ°æ®ï¼åæ¬è·è¸ªæ°æ®åç»è®¡æ°æ®ï¼å¹¶å°å¶æç§ SkyWalking çè¦æ±éæ°æ ¼å¼åä¸ºã\n * å¹³å°åç«¯ - å¹³å°åç«¯æ¯ä¸ä¸ªæä¾åç«¯æå¡çéç¾¤ãå®ç¨äºèåãåæåé©±å¨ä»æ¢éå° UI çæµç¨ãå®è¿ä¸ºä¼ å¥æ ¼å¼ï¼å¦ Zipkin çæ ¼å¼ï¼ï¼å­å¨å®ç°ç¨åºåéç¾¤ç®¡çæä¾å¯æå¥åè½ã æ¨çè³å¯ä»¥ä½¿ç¨ Observability Analysis Language èªå®ä¹èåååæã\n * å­å¨ - æ¨å¯ä»¥éæ©ä¸ä¸ª SkyWalking å·²å®ç°çå­å¨ï¼å¦ç± Sharding-Sphere ç®¡çç ElasticSearchï¼H2 æ MySQL éç¾¤ï¼ä¹å¯ä»¥èªè¡å®ç°ä¸ä¸ªå­å¨ã\n * UI - ç¨æ·çé¢å¾é·ï¼å¯¹äº SkyWalking æç»ç¨æ·èè¨éå¸¸å¼ºå¤§ãå®ä¹å¯ä»¥èªå®ä¹ä»¥å¹éæ¨çèªå®ä¹åç«¯ã\n\n\n# ä¸ãSkyWalking å®è£\n\nè¿å¥ Apache SkyWalking å®æ¹ä¸è½½é¡µé¢ï¼éæ©å®è£çæ¬ï¼ä¸è½½è§£åå°æ¬å°ã\n\n\n\nå®è£åä¸ºä¸ä¸ªé¨åï¼\n\n * Backend setup document\n * UI setup document\n * CLI set up document\n\n\n# åèèµæ\n\n * SkyWalking Github",normalizedContent:"# skywalking å¿«éå¥é¨\n\nskywalking æ¯ä¸ä¸ªåºäº java å¼åçåå¸å¼ç³»ç»çåºç¨ç¨åºæ§è½çè§å·¥å·ï¼ä¸ä¸ºå¾®æå¡ãäºåçæ¶æååºäºå®¹å¨ï¼dockerãk8sãmesosï¼æ¶æèè®¾è®¡ã\n\n\n# ä¸ãskywalking ç®ä»\n\nskywalking æ¯è§å¯æ§åæå¹³å°ååºç¨æ§è½ç®¡çç³»ç»ã\n\næä¾åå¸å¼è¿½è¸ªãæå¡ç½æ ¼é¥æµåæãåº¦éèååå¯è§åä¸ä½åè§£å³æ¹æ¡ã\n\n\n\n\n# skywalking ç¹æ§\n\n * å¤ç§çæ§ææ®µï¼è¯­è¨æ¢éå service mesh\n * å¤è¯­è¨èªå¨æ¢éï¼javaï¼.net core å node.js\n * è½»éé«æï¼ä¸éè¦å¤§æ°æ®\n * æ¨¡ååï¼uiãå­å¨ãéç¾¤ç®¡çå¤ç§æºå¶å¯é\n * æ¯æåè­¦\n * ä¼ç§çå¯è§åæ¹æ¡\n\n\n# skywalking æ ¸å¿æ¦å¿µ\n\n * service - æå¡ãä»£è¡¨ä¸ç»ä¸ºä¼ å¥è¯·æ±æä¾ç¸åçè¡ä¸ºçå·¥ä½è´è½½ã ä½¿ç¨ä»£çæ sdk æ¶ï¼å¯ä»¥å®ä¹æå¡åç§°ã\n * service instance - æå¡å®ä¾ãæå¡ç»ä¸­çæ¯ä¸ªå·¥ä½è´è½½é½ç§°ä¸ºä¸ä¸ªå®ä¾ãå°±å kubernetes ä¸­ç pod ä¸æ ·ï¼å®å¨ os ä¸­ä¸å¿æ¯åä¸ªè¿ç¨ã\n * endpoint - ç«¯ç¹ãå®æ¯ç¹å®æå¡ä¸­ç¨äºä¼ å¥è¯·æ±çè·¯å¾ï¼ä¾å¦ http uri è·¯å¾æ rpc æå¡ç±»+æ¹æ³ç­¾åã\n\n\n# äºãskywalking æ¶æ\n\nä»é»è¾ä¸è®²ï¼skywalking åä¸ºåä¸ªé¨åï¼æ¢éï¼probesï¼ï¼å¹³å°åç«¯ï¼å­å¨å uiã\n\n\n\n * æ¢éï¼probesï¼ - æ¢éæ¯æéæå°ç®æ ç³»ç»ä¸­çä»£çæ sdk åºãå®ä»¬è´è´£æ¶éæ°æ®ï¼åæ¬è·è¸ªæ°æ®åç»è®¡æ°æ®ï¼å¹¶å°å¶æç§ skywalking çè¦æ±éæ°æ ¼å¼åä¸ºã\n * å¹³å°åç«¯ - å¹³å°åç«¯æ¯ä¸ä¸ªæä¾åç«¯æå¡çéç¾¤ãå®ç¨äºèåãåæåé©±å¨ä»æ¢éå° ui çæµç¨ãå®è¿ä¸ºä¼ å¥æ ¼å¼ï¼å¦ zipkin çæ ¼å¼ï¼ï¼å­å¨å®ç°ç¨åºåéç¾¤ç®¡çæä¾å¯æå¥åè½ã æ¨çè³å¯ä»¥ä½¿ç¨ observability analysis language èªå®ä¹èåååæã\n * å­å¨ - æ¨å¯ä»¥éæ©ä¸ä¸ª skywalking å·²å®ç°çå­å¨ï¼å¦ç± sharding-sphere ç®¡çç elasticsearchï¼h2 æ mysql éç¾¤ï¼ä¹å¯ä»¥èªè¡å®ç°ä¸ä¸ªå­å¨ã\n * ui - ç¨æ·çé¢å¾é·ï¼å¯¹äº skywalking æç»ç¨æ·èè¨éå¸¸å¼ºå¤§ãå®ä¹å¯ä»¥èªå®ä¹ä»¥å¹éæ¨çèªå®ä¹åç«¯ã\n\n\n# ä¸ãskywalking å®è£\n\nè¿å¥ apache skywalking å®æ¹ä¸è½½é¡µé¢ï¼éæ©å®è£çæ¬ï¼ä¸è½½è§£åå°æ¬å°ã\n\n\n\nå®è£åä¸ºä¸ä¸ªé¨åï¼\n\n * backend setup document\n * ui setup document\n * cli set up document\n\n\n# åèèµæ\n\n * skywalking github",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Arthas å¿«éå¥é¨",frontmatter:{title:"Arthas å¿«éå¥é¨",categories:["ç¼ç¨","Java","è½¯ä»¶","çæ§è¯æ­"],tags:["Java","è¯æ­","Arthas"],abbrlink:"e60b19c0",date:"2020-02-07T23:04:47.000Z",permalink:"/pages/b6a542/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/03.%E7%9B%91%E6%8E%A7%E8%AF%8A%E6%96%AD/05.Arthas.html",relativePath:"11.è½¯ä»¶/03.çæ§è¯æ­/05.Arthas.md",key:"v-46ed506a",path:"/pages/b6a542/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:54},{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:376},{level:3,title:"ä½¿ç¨arthas-bootï¼æ¨èï¼",slug:"ä½¿ç¨arthas-boot-æ¨è",normalizedTitle:"ä½¿ç¨arthas-bootï¼æ¨èï¼",charIndex:383},{level:3,title:"ä½¿ç¨as.sh",slug:"ä½¿ç¨as-sh",normalizedTitle:"ä½¿ç¨as.sh",charIndex:756},{level:3,title:"å¨éå®è£",slug:"å¨éå®è£",normalizedTitle:"å¨éå®è£",charIndex:1097},{level:2,title:"åºç¡ä½¿ç¨",slug:"åºç¡ä½¿ç¨",normalizedTitle:"åºç¡ä½¿ç¨",charIndex:1236},{level:3,title:"å¯å¨ Demo",slug:"å¯å¨-demo",normalizedTitle:"å¯å¨ demo",charIndex:1245},{level:3,title:"å¯å¨ arthas",slug:"å¯å¨-arthas",normalizedTitle:"å¯å¨ arthas",charIndex:1410},{level:3,title:"æ¥ç dashboard",slug:"æ¥ç-dashboard",normalizedTitle:"æ¥ç dashboard",charIndex:2510},{level:3,title:"éè¿ thread å½ä»¤æ¥è·åå°arthas-demoè¿ç¨ç Main Class",slug:"éè¿-thread-å½ä»¤æ¥è·åå°arthas-demoè¿ç¨ç-main-class",normalizedTitle:"éè¿ thread å½ä»¤æ¥è·åå°arthas-demoè¿ç¨ç main class",charIndex:4594},{level:3,title:"éè¿ jad æ¥åç¼è¯ Main Class",slug:"éè¿-jad-æ¥åç¼è¯-main-class",normalizedTitle:"éè¿ jad æ¥åç¼è¯ main class",charIndex:4751},{level:3,title:"watch",slug:"watch",normalizedTitle:"watch",charIndex:6952},{level:3,title:"éåº arthas",slug:"éåº-arthas",normalizedTitle:"éåº arthas",charIndex:7824},{level:2,title:"è¿é¶ä½¿ç¨",slug:"è¿é¶ä½¿ç¨",normalizedTitle:"è¿é¶ä½¿ç¨",charIndex:7814},{level:3,title:"åºç¡å½ä»¤",slug:"åºç¡å½ä»¤",normalizedTitle:"åºç¡å½ä»¤",charIndex:7959},{level:3,title:"jvm ç¸å³",slug:"jvm-ç¸å³",normalizedTitle:"jvm ç¸å³",charIndex:8332},{level:3,title:"class/classloader ç¸å³",slug:"class-classloader-ç¸å³",normalizedTitle:"class/classloader ç¸å³",charIndex:8653},{level:3,title:"monitor/watch/trace ç¸å³",slug:"monitor-watch-trace-ç¸å³",normalizedTitle:"monitor/watch/trace ç¸å³",charIndex:8931},{level:3,title:"options",slug:"options",normalizedTitle:"options",charIndex:9236},{level:3,title:"ç®¡é",slug:"ç®¡é",normalizedTitle:"ç®¡é",charIndex:9279},{level:3,title:"åå°å¼æ­¥ä»»å¡",slug:"åå°å¼æ­¥ä»»å¡",normalizedTitle:"åå°å¼æ­¥ä»»å¡",charIndex:9428},{level:3,title:"Web Console",slug:"web-console",normalizedTitle:"web console",charIndex:9646},{level:3,title:"ç¨æ·æ°æ®åæ¥",slug:"ç¨æ·æ°æ®åæ¥",normalizedTitle:"ç¨æ·æ°æ®åæ¥",charIndex:9703},{level:3,title:"å¶ä»ç¹æ§",slug:"å¶ä»ç¹æ§",normalizedTitle:"å¶ä»ç¹æ§",charIndex:9909},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:9967}],headersStr:"ç®ä» å®è£ ä½¿ç¨arthas-bootï¼æ¨èï¼ ä½¿ç¨as.sh å¨éå®è£ åºç¡ä½¿ç¨ å¯å¨ Demo å¯å¨ arthas æ¥ç dashboard éè¿ thread å½ä»¤æ¥è·åå°arthas-demoè¿ç¨ç Main Class éè¿ jad æ¥åç¼è¯ Main Class watch éåº arthas è¿é¶ä½¿ç¨ åºç¡å½ä»¤ jvm ç¸å³ class/classloader ç¸å³ monitor/watch/trace ç¸å³ options ç®¡é åå°å¼æ­¥ä»»å¡ Web Console ç¨æ·æ°æ®åæ¥ å¶ä»ç¹æ§ åèèµæ",content:"# Arthas å¿«éå¥é¨\n\n> Arthas æ¯ Alibaba å¼æºç Java è¯æ­å·¥å· ã\n\n\n# ç®ä»\n\nArthaså¯ä»¥è§£å³çé®é¢ï¼\n\n 1. è¿ä¸ªç±»ä»åªä¸ª jar åå è½½çï¼ä¸ºä»ä¹ä¼æ¥åç§ç±»ç¸å³ç Exceptionï¼\n 2. ææ¹çä»£ç ä¸ºä»ä¹æ²¡ææ§è¡å°ï¼é¾éæ¯ææ²¡ commitï¼åæ¯æéäºï¼\n 3. éå°é®é¢æ æ³å¨çº¿ä¸ debugï¼é¾éåªè½éè¿å æ¥å¿åéæ°åå¸åï¼\n 4. çº¿ä¸éå°æä¸ªç¨æ·çæ°æ®å¤çæé®é¢ï¼ä½çº¿ä¸åæ ·æ æ³ debugï¼çº¿ä¸æ æ³éç°ï¼\n 5. æ¯å¦æä¸ä¸ªå¨å±è§è§æ¥æ¥çç³»ç»çè¿è¡ç¶åµï¼\n 6. æä»ä¹åæ³å¯ä»¥çæ§å° JVM çå®æ¶è¿è¡ç¶æï¼\n\nArthasæ¯æ JDK 6+ï¼æ¯æ Linux/Mac/Windowsï¼éç¨å½ä»¤è¡äº¤äºæ¨¡å¼ï¼åæ¶æä¾ä¸°å¯ç Tab èªå¨è¡¥å¨åè½ï¼è¿ä¸æ­¥æ¹ä¾¿è¿è¡é®é¢çå®ä½åè¯æ­ã\n\n\n# å®è£\n\n\n# ä½¿ç¨arthas-bootï¼æ¨èï¼\n\nä¸è½½arthas-boot.jarï¼ç¶åç¨java -jarçæ¹å¼å¯å¨ï¼\n\nwget https://alibaba.github.io/arthas/arthas-boot.jar\njava -jar arthas-boot.jar\n\n\næå°å¸®å©ä¿¡æ¯ï¼\n\njava -jar arthas-boot.jar -h\n\n\n * å¦æä¸è½½éåº¦æ¯è¾æ¢ï¼å¯ä»¥ä½¿ç¨ aliyun çéåï¼\n   \n   java -jar arthas-boot.jar --repo-mirror aliyun --use-http\n   \n\n * å¦æä» github ä¸è½½æé®é¢ï¼å¯ä»¥ä½¿ç¨ gitee éå\n   \n   wget https://arthas.gitee.io/arthas-boot.jar\n   \n\n\n# ä½¿ç¨as.sh\n\nArthas æ¯æå¨ Linux/Unix/Mac ç­å¹³å°ä¸ä¸é®å®è£ï¼è¯·å¤å¶ä»¥ä¸åå®¹ï¼å¹¶ç²è´´å°å½ä»¤è¡ä¸­ï¼æ² åè½¦ æ§è¡å³å¯ï¼\n\ncurl -L https://alibaba.github.io/arthas/install.sh | sh\n\n\nä¸è¿°å½ä»¤ä¼ä¸è½½å¯å¨èæ¬æä»¶ as.sh å°å½åç®å½ï¼ä½ å¯ä»¥æ¾å¨ä»»ä½å°æ¹æå°å¶å å¥å° $PATH ä¸­ã\n\nç´æ¥å¨ shell ä¸é¢æ§è¡./as.shï¼å°±ä¼è¿å¥äº¤äºçé¢ã\n\nä¹å¯ä»¥æ§è¡./as.sh -hæ¥è·åæ´å¤åæ°ä¿¡æ¯ã\n\n * å¦æä» github ä¸è½½æé®é¢ï¼å¯ä»¥ä½¿ç¨ gitee éå\n   \n   curl -L https://arthas.gitee.io/install.sh | sh\n   \n\n\n# å¨éå®è£\n\nææ°çæ¬ï¼ç¹å»ä¸è½½ï¼ä¸è½½å°å\n\nè§£ååï¼å¨æä»¶å¤¹éæarthas-boot.jarï¼ç´æ¥ç¨java -jarçæ¹å¼å¯å¨ï¼\n\njava -jar arthas-boot.jar\n\n\næå°å¸®å©ä¿¡æ¯ï¼\n\njava -jar arthas-boot.jar -h\n\n\n\n# åºç¡ä½¿ç¨\n\n\n# å¯å¨ Demo\n\nwget https://alibaba.github.io/arthas/arthas-demo.jar\njava -jar arthas-demo.jar\n\n\narthas-demoæ¯ä¸ä¸ªç®åçç¨åºï¼æ¯éä¸ç§çæä¸ä¸ªéæºæ°ï¼åæ§è¡è´¨å å¼åè§£ï¼å¹¶æå°åºåè§£ç»æã\n\narthas-demoæºä»£ç ï¼æ¥ç\n\n\n# å¯å¨ arthas\n\nå¨å½ä»¤è¡ä¸é¢æ§è¡ï¼ä½¿ç¨åç®æ è¿ç¨ä¸è´çç¨æ·å¯å¨ï¼å¦åå¯è½ attach å¤±è´¥ï¼ï¼\n\nwget https://alibaba.github.io/arthas/arthas-boot.jar\njava -jar arthas-boot.jar\n\n\n * æ§è¡è¯¥ç¨åºçç¨æ·éè¦åç®æ è¿ç¨å·æç¸åçæéãæ¯å¦ä»¥adminç¨æ·æ¥æ§è¡ï¼sudo su admin && java -jar arthas-boot.jar æ sudo -u admin -EH java -jar arthas-boot.jarã\n * å¦æ attach ä¸ä¸ç®æ è¿ç¨ï¼å¯ä»¥æ¥ç~/logs/arthas/ ç®å½ä¸çæ¥å¿ã\n * å¦æä¸è½½éåº¦æ¯è¾æ¢ï¼å¯ä»¥ä½¿ç¨ aliyun çéåï¼java -jar arthas-boot.jar --repo-mirror aliyun --use-http\n * java -jar arthas-boot.jar -h æå°æ´å¤åæ°ä¿¡æ¯ã\n\néæ©åºç¨ java è¿ç¨ï¼\n\n$ $ java -jar arthas-boot.jar\n* [1]: 35542\n  [2]: 71560 arthas-demo.jar\n\n\nDemo è¿ç¨æ¯ç¬¬ 2 ä¸ªï¼åè¾å¥ 2ï¼åè¾å¥åè½¦/enterãArthas ä¼ attach å°ç®æ è¿ç¨ä¸ï¼å¹¶è¾åºæ¥å¿ï¼\n\n[INFO] Try to attach process 71560\n[INFO] Attach process 71560 success.\n[INFO] arthas-client connect 127.0.0.1 3658\n  ,---.  ,------. ,--------.,--.  ,--.  ,---.   ,---.\n /  O  \\ |  .--. ''--.  .--'|  '--'  | /  O  \\ '   .-'\n|  .-.  ||  '--'.'   |  |   |  .--.  ||  .-.  |`.  `-.\n|  | |  ||  |\\  \\    |  |   |  |  |  ||  | |  |.-'    |\n`--' `--'`--' '--'   `--'   `--'  `--'`--' `--'`-----'\n\nwiki: https://alibaba.github.io/arthas\nversion: 3.0.5.20181127201536\npid: 71560\ntime: 2018-11-28 19:16:24\n\n$\n\n\n\n# æ¥ç dashboard\n\nè¾å¥dashboardï¼æåè½¦/enterï¼ä¼å±ç¤ºå½åè¿ç¨çä¿¡æ¯ï¼æctrl+cå¯ä»¥ä¸­æ­æ§è¡ã\n\n$ dashboard\nID     NAME                   GROUP          PRIORI STATE  %CPU    TIME   INTERRU DAEMON\n17     pool-2-thread-1        system         5      WAITIN 67      0:0    false   false\n27     Timer-for-arthas-dashb system         10     RUNNAB 32      0:0    false   true\n11     AsyncAppender-Worker-a system         9      WAITIN 0       0:0    false   true\n9      Attach Listener        system         9      RUNNAB 0       0:0    false   true\n3      Finalizer              system         8      WAITIN 0       0:0    false   true\n2      Reference Handler      system         10     WAITIN 0       0:0    false   true\n4      Signal Dispatcher      system         9      RUNNAB 0       0:0    false   true\n26     as-command-execute-dae system         10     TIMED_ 0       0:0    false   true\n13     job-timeout            system         9      TIMED_ 0       0:0    false   true\n1      main                   main           5      TIMED_ 0       0:0    false   false\n14     nioEventLoopGroup-2-1  system         10     RUNNAB 0       0:0    false   false\n18     nioEventLoopGroup-2-2  system         10     RUNNAB 0       0:0    false   false\n23     nioEventLoopGroup-2-3  system         10     RUNNAB 0       0:0    false   false\n15     nioEventLoopGroup-3-1  system         10     RUNNAB 0       0:0    false   false\nMemory             used   total max    usage GC\nheap               32M    155M  1820M  1.77% gc.ps_scavenge.count  4\nps_eden_space      14M    65M   672M   2.21% gc.ps_scavenge.time(m 166\nps_survivor_space  4M     5M    5M           s)\nps_old_gen         12M    85M   1365M  0.91% gc.ps_marksweep.count 0\nnonheap            20M    23M   -1           gc.ps_marksweep.time( 0\ncode_cache         3M     5M    240M   1.32% ms)\nRuntime\nos.name                Mac OS X\nos.version             10.13.4\njava.version           1.8.0_162\njava.home              /Library/Java/JavaVir\n                       tualMachines/jdk1.8.0\n                       _162.jdk/Contents/Hom\n                       e/jre\n\n\n\n# éè¿ thread å½ä»¤æ¥è·åå°arthas-demoè¿ç¨ç Main Class\n\nthread 1ä¼æå°çº¿ç¨ ID 1 çæ ï¼éå¸¸æ¯ main å½æ°ççº¿ç¨ã\n\n$ thread 1 | grep 'main('\n    at demo.MathGame.main(MathGame.java:17)\n\n\n\n# éè¿ jad æ¥åç¼è¯ Main Class\n\n$ jad demo.MathGame\n\nClassLoader:\n+-sun.misc.Launcher$AppClassLoader@3d4eac69\n  +-sun.misc.Launcher$ExtClassLoader@66350f69\n\nLocation:\n/tmp/arthas-demo.jar\n\n/*\n * Decompiled with CFR 0_132.\n */\npackage demo;\n\nimport java.io.PrintStream;\nimport java.util.ArrayList;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Random;\nimport java.util.concurrent.TimeUnit;\n\npublic class MathGame {\n    private static Random random = new Random();\n    private int illegalArgumentCount = 0;\n\n    public static void main(String[] args) throws InterruptedException {\n        MathGame game = new MathGame();\n        do {\n            game.run();\n            TimeUnit.SECONDS.sleep(1L);\n        } while (true);\n    }\n\n    public void run() throws InterruptedException {\n        try {\n            int number = random.nextInt();\n            List<Integer> primeFactors = this.primeFactors(number);\n            MathGame.print(number, primeFactors);\n        }\n        catch (Exception e) {\n            System.out.println(String.format(\"illegalArgumentCount:%3d, \", this.illegalArgumentCount) + e.getMessage());\n        }\n    }\n\n    public static void print(int number, List<Integer> primeFactors) {\n        StringBuffer sb = new StringBuffer(\"\" + number + \"=\");\n        Iterator<Integer> iterator = primeFactors.iterator();\n        while (iterator.hasNext()) {\n            int factor = iterator.next();\n            sb.append(factor).append('*');\n        }\n        if (sb.charAt(sb.length() - 1) == '*') {\n            sb.deleteCharAt(sb.length() - 1);\n        }\n        System.out.println(sb);\n    }\n\n    public List<Integer> primeFactors(int number) {\n        if (number < 2) {\n            ++this.illegalArgumentCount;\n            throw new IllegalArgumentException(\"number is: \" + number + \", need >= 2\");\n        }\n        ArrayList<Integer> result = new ArrayList<Integer>();\n        int i = 2;\n        while (i <= number) {\n            if (number % i == 0) {\n                result.add(i);\n                number /= i;\n                i = 2;\n                continue;\n            }\n            ++i;\n        }\n        return result;\n    }\n}\n\nAffect(row-cnt:1) cost in 970 ms.\n\n\n\n# watch\n\néè¿watchå½ä»¤æ¥æ¥çdemo.MathGame#primeFactorså½æ°çè¿åå¼ï¼\n\n$ watch demo.MathGame primeFactors returnObj\nPress Ctrl+C to abort.\nAffect(class-cnt:1 , method-cnt:1) cost in 107 ms.\nts=2018-11-28 19:22:30; [cost=1.715367ms] result=null\nts=2018-11-28 19:22:31; [cost=0.185203ms] result=null\nts=2018-11-28 19:22:32; [cost=19.012416ms] result=@ArrayList[\n    @Integer[5],\n    @Integer[47],\n    @Integer[2675531],\n]\nts=2018-11-28 19:22:33; [cost=0.311395ms] result=@ArrayList[\n    @Integer[2],\n    @Integer[5],\n    @Integer[317],\n    @Integer[503],\n    @Integer[887],\n]\nts=2018-11-28 19:22:34; [cost=10.136007ms] result=@ArrayList[\n    @Integer[2],\n    @Integer[2],\n    @Integer[3],\n    @Integer[3],\n    @Integer[31],\n    @Integer[717593],\n]\nts=2018-11-28 19:22:35; [cost=29.969732ms] result=@ArrayList[\n    @Integer[5],\n    @Integer[29],\n    @Integer[7651739],\n]\n\n\næ´å¤çåè½å¯ä»¥æ¥çè¿é¶ä½¿ç¨ã\n\n\n# éåº arthas\n\nå¦æåªæ¯éåºå½åçè¿æ¥ï¼å¯ä»¥ç¨quitæèexitå½ä»¤ãAttach å°ç®æ è¿ç¨ä¸ç arthas è¿ä¼ç»§ç»­è¿è¡ï¼ç«¯å£ä¼ä¿æå¼æ¾ï¼ä¸æ¬¡è¿æ¥æ¶å¯ä»¥ç´æ¥è¿æ¥ä¸ã\n\nå¦ææ³å®å¨éåº arthasï¼å¯ä»¥æ§è¡shutdownå½ä»¤ã\n\n\n# è¿é¶ä½¿ç¨\n\n\n# åºç¡å½ä»¤\n\n * helpââæ¥çå½ä»¤å¸®å©ä¿¡æ¯\n * catââæå°æä»¶åå®¹ï¼å linux éç cat å½ä»¤ç±»ä¼¼\n * pwdââè¿åå½åçå·¥ä½ç®å½ï¼å linux å½ä»¤ç±»ä¼¼\n * clsââæ¸ç©ºå½åå±å¹åºå\n * sessionââæ¥çå½åä¼è¯çä¿¡æ¯\n * resetââéç½®å¢å¼ºç±»ï¼å°è¢« Arthas å¢å¼ºè¿çç±»å¨é¨è¿åï¼Arthas æå¡ç«¯å³é­æ¶ä¼éç½®ææå¢å¼ºè¿çç±»\n * versionââè¾åºå½åç®æ  Java è¿ç¨æå è½½ç Arthas çæ¬å·\n * historyââæå°å½ä»¤åå²\n * quitââéåºå½å Arthas å®¢æ·ç«¯ï¼å¶ä» Arthas å®¢æ·ç«¯ä¸åå½±å\n * shutdownââå³é­ Arthas æå¡ç«¯ï¼ææ Arthas å®¢æ·ç«¯å¨é¨éåº\n * keymapââArthas å¿«æ·é®åè¡¨åèªå®ä¹å¿«æ·é®\n\n\n# jvm ç¸å³\n\n * dashboardââå½åç³»ç»çå®æ¶æ°æ®é¢æ¿\n * threadââæ¥çå½å JVM ççº¿ç¨å æ ä¿¡æ¯\n * jvmââæ¥çå½å JVM çä¿¡æ¯\n * syspropââæ¥çåä¿®æ¹ JVM çç³»ç»å±æ§\n * sysenvââæ¥ç JVM çç¯å¢åé\n * vmoptionââæ¥çåä¿®æ¹ JVM éè¯æ­ç¸å³ç option\n * loggerââæ¥çåä¿®æ¹ logger\n * getstaticââæ¥çç±»çéæå±æ§\n * ognlââæ§è¡ ognl è¡¨è¾¾å¼\n * mbeanââæ¥ç Mbean çä¿¡æ¯\n * heapdumpââdump java heap, ç±»ä¼¼ jmap å½ä»¤ç heap dump åè½\n\n\n# class/classloader ç¸å³\n\n * scââæ¥ç JVM å·²å è½½çç±»ä¿¡æ¯\n * smââæ¥çå·²å è½½ç±»çæ¹æ³ä¿¡æ¯\n * jadââåç¼è¯æå®å·²å è½½ç±»çæºç \n * mcââåå­ç¼ç»å¨ï¼åå­ç¼ç».javaæä»¶ä¸º.classæä»¶\n * redefineââå è½½å¤é¨ç.classæä»¶ï¼redefine å° JVM é\n * dumpââdump å·²å è½½ç±»ç byte code å°ç¹å®ç®å½\n * classloaderââæ¥ç classloader çç»§æ¿æ ï¼urlsï¼ç±»å è½½ä¿¡æ¯ï¼ä½¿ç¨ classloader å» getResource\n\n\n# monitor/watch/trace ç¸å³\n\n> è¯·æ³¨æï¼è¿äºå½ä»¤ï¼é½éè¿å­èç å¢å¼ºææ¯æ¥å®ç°çï¼ä¼å¨æå®ç±»çæ¹æ³ä¸­æå¥ä¸äºåé¢æ¥å®ç°æ°æ®ç»è®¡åè§æµï¼å æ­¤å¨çº¿ä¸ãé¢åä½¿ç¨æ¶ï¼è¯·å°½éæç¡®éè¦è§æµçç±»ãæ¹æ³ä»¥åæ¡ä»¶ï¼è¯æ­ç»æè¦æ§è¡ shutdown æå°å¢å¼ºè¿çç±»æ§è¡ reset å½ä»¤ã\n\n * monitorââæ¹æ³æ§è¡çæ§\n * watchââæ¹æ³æ§è¡æ°æ®è§æµ\n * traceââæ¹æ³åé¨è°ç¨è·¯å¾ï¼å¹¶è¾åºæ¹æ³è·¯å¾ä¸çæ¯ä¸ªèç¹ä¸èæ¶\n * stackââè¾åºå½åæ¹æ³è¢«è°ç¨çè°ç¨è·¯å¾\n * ttââæ¹æ³æ§è¡æ°æ®çæ¶ç©ºé§éï¼è®°å½ä¸æå®æ¹æ³æ¯æ¬¡è°ç¨çå¥ååè¿åä¿¡æ¯ï¼å¹¶è½å¯¹è¿äºä¸åçæ¶é´ä¸è°ç¨è¿è¡è§æµ\n\n\n# options\n\n * optionsââæ¥çæè®¾ç½® Arthas å¨å±å¼å³\n\n\n# ç®¡é\n\nArthas æ¯æä½¿ç¨ç®¡éå¯¹ä¸è¿°å½ä»¤çç»æè¿è¡è¿ä¸æ­¥çå¤çï¼å¦sm java.lang.String * | grep 'index'\n\n * grepââæç´¢æ»¡è¶³æ¡ä»¶ç \b ç»æ\n * plaintextââå° \b å½ä»¤çç»æå»é¤ ANSI é¢è²\n * wcââæè¡ç»è®¡è¾åºç»æ\n\n\n# åå°å¼æ­¥ä»»å¡\n\nå½çº¿ä¸åºç°å¶åçé®é¢ï¼æ¯å¦éè¦ watch æä¸ªæ¡ä»¶ï¼èè¿ä¸ªæ¡ä»¶ä¸å¤©å¯è½æä¼åºç°ä¸æ¬¡æ¶ï¼å¼æ­¥åå°ä»»å¡å°±æ´¾ä¸ç¨åºäºï¼è¯¦æè¯·åèè¿é\n\n * ä½¿ç¨ > å°ç»æéååå°æ¥å¿æä»¶ï¼ä½¿ç¨ & æå®å½ä»¤æ¯åå°è¿è¡ï¼session æ­å¼ä¸å½±åä»»å¡æ§è¡ï¼çå½å¨æé»è®¤ä¸º 1 å¤©ï¼\n * jobsââååºææ job\n * killââå¼ºå¶ç»æ­¢ä»»å¡\n * fgââå°æåçä»»å¡æå°åå°æ§è¡\n * bgââå°æåçä»»å¡æ¾å°åå°æ§è¡\n\n\n# Web Console\n\néè¿ websocket è¿æ¥ Arthasã\n\n * Web Console\n\n\n# ç¨æ·æ°æ®åæ¥\n\nå¨3.1.4çæ¬åï¼å¢å äºç¨æ·æ°æ®åæ¥åè½ï¼æ¹ä¾¿ç»ä¸åå®å¨æèåå²æ°æ®ç»è®¡ã\n\nå¨å¯å¨æ¶ï¼æå®stat-urlï¼å°±ä¼åæ¥æ§è¡çæ¯ä¸è¡å½ä»¤ï¼æ¯å¦ï¼ ./as.sh --stat-url 'http://192.168.10.11:8080/api/stat'\n\nå¨ tunnel server éæä¸ä¸ªç¤ºä¾çåæ¥ä»£ç ï¼ç¨æ·å¯ä»¥èªå·±å¨æå¡å¨ä¸å®ç°ã\n\nStatController.java\n\n\n# å¶ä»ç¹æ§\n\n * å¼æ­¥å½ä»¤æ¯æ\n * æ§è¡ç»æå­æ¥å¿\n * æ¹å¤ççæ¯æ\n * ognl è¡¨è¾¾å¼çç¨æ³è¯´æ\n\n\n# åèèµæ\n\n * Arthas Github\n * Arthas ç¨æ·ææ¡£\n * arthas æºç åæ",normalizedContent:"# arthas å¿«éå¥é¨\n\n> arthas æ¯ alibaba å¼æºç java è¯æ­å·¥å· ã\n\n\n# ç®ä»\n\narthaså¯ä»¥è§£å³çé®é¢ï¼\n\n 1. è¿ä¸ªç±»ä»åªä¸ª jar åå è½½çï¼ä¸ºä»ä¹ä¼æ¥åç§ç±»ç¸å³ç exceptionï¼\n 2. ææ¹çä»£ç ä¸ºä»ä¹æ²¡ææ§è¡å°ï¼é¾éæ¯ææ²¡ commitï¼åæ¯æéäºï¼\n 3. éå°é®é¢æ æ³å¨çº¿ä¸ debugï¼é¾éåªè½éè¿å æ¥å¿åéæ°åå¸åï¼\n 4. çº¿ä¸éå°æä¸ªç¨æ·çæ°æ®å¤çæé®é¢ï¼ä½çº¿ä¸åæ ·æ æ³ debugï¼çº¿ä¸æ æ³éç°ï¼\n 5. æ¯å¦æä¸ä¸ªå¨å±è§è§æ¥æ¥çç³»ç»çè¿è¡ç¶åµï¼\n 6. æä»ä¹åæ³å¯ä»¥çæ§å° jvm çå®æ¶è¿è¡ç¶æï¼\n\narthasæ¯æ jdk 6+ï¼æ¯æ linux/mac/windowsï¼éç¨å½ä»¤è¡äº¤äºæ¨¡å¼ï¼åæ¶æä¾ä¸°å¯ç tab èªå¨è¡¥å¨åè½ï¼è¿ä¸æ­¥æ¹ä¾¿è¿è¡é®é¢çå®ä½åè¯æ­ã\n\n\n# å®è£\n\n\n# ä½¿ç¨arthas-bootï¼æ¨èï¼\n\nä¸è½½arthas-boot.jarï¼ç¶åç¨java -jarçæ¹å¼å¯å¨ï¼\n\nwget https://alibaba.github.io/arthas/arthas-boot.jar\njava -jar arthas-boot.jar\n\n\næå°å¸®å©ä¿¡æ¯ï¼\n\njava -jar arthas-boot.jar -h\n\n\n * å¦æä¸è½½éåº¦æ¯è¾æ¢ï¼å¯ä»¥ä½¿ç¨ aliyun çéåï¼\n   \n   java -jar arthas-boot.jar --repo-mirror aliyun --use-http\n   \n\n * å¦æä» github ä¸è½½æé®é¢ï¼å¯ä»¥ä½¿ç¨ gitee éå\n   \n   wget https://arthas.gitee.io/arthas-boot.jar\n   \n\n\n# ä½¿ç¨as.sh\n\narthas æ¯æå¨ linux/unix/mac ç­å¹³å°ä¸ä¸é®å®è£ï¼è¯·å¤å¶ä»¥ä¸åå®¹ï¼å¹¶ç²è´´å°å½ä»¤è¡ä¸­ï¼æ² åè½¦ æ§è¡å³å¯ï¼\n\ncurl -l https://alibaba.github.io/arthas/install.sh | sh\n\n\nä¸è¿°å½ä»¤ä¼ä¸è½½å¯å¨èæ¬æä»¶ as.sh å°å½åç®å½ï¼ä½ å¯ä»¥æ¾å¨ä»»ä½å°æ¹æå°å¶å å¥å° $path ä¸­ã\n\nç´æ¥å¨ shell ä¸é¢æ§è¡./as.shï¼å°±ä¼è¿å¥äº¤äºçé¢ã\n\nä¹å¯ä»¥æ§è¡./as.sh -hæ¥è·åæ´å¤åæ°ä¿¡æ¯ã\n\n * å¦æä» github ä¸è½½æé®é¢ï¼å¯ä»¥ä½¿ç¨ gitee éå\n   \n   curl -l https://arthas.gitee.io/install.sh | sh\n   \n\n\n# å¨éå®è£\n\nææ°çæ¬ï¼ç¹å»ä¸è½½ï¼ä¸è½½å°å\n\nè§£ååï¼å¨æä»¶å¤¹éæarthas-boot.jarï¼ç´æ¥ç¨java -jarçæ¹å¼å¯å¨ï¼\n\njava -jar arthas-boot.jar\n\n\næå°å¸®å©ä¿¡æ¯ï¼\n\njava -jar arthas-boot.jar -h\n\n\n\n# åºç¡ä½¿ç¨\n\n\n# å¯å¨ demo\n\nwget https://alibaba.github.io/arthas/arthas-demo.jar\njava -jar arthas-demo.jar\n\n\narthas-demoæ¯ä¸ä¸ªç®åçç¨åºï¼æ¯éä¸ç§çæä¸ä¸ªéæºæ°ï¼åæ§è¡è´¨å å¼åè§£ï¼å¹¶æå°åºåè§£ç»æã\n\narthas-demoæºä»£ç ï¼æ¥ç\n\n\n# å¯å¨ arthas\n\nå¨å½ä»¤è¡ä¸é¢æ§è¡ï¼ä½¿ç¨åç®æ è¿ç¨ä¸è´çç¨æ·å¯å¨ï¼å¦åå¯è½ attach å¤±è´¥ï¼ï¼\n\nwget https://alibaba.github.io/arthas/arthas-boot.jar\njava -jar arthas-boot.jar\n\n\n * æ§è¡è¯¥ç¨åºçç¨æ·éè¦åç®æ è¿ç¨å·æç¸åçæéãæ¯å¦ä»¥adminç¨æ·æ¥æ§è¡ï¼sudo su admin && java -jar arthas-boot.jar æ sudo -u admin -eh java -jar arthas-boot.jarã\n * å¦æ attach ä¸ä¸ç®æ è¿ç¨ï¼å¯ä»¥æ¥ç~/logs/arthas/ ç®å½ä¸çæ¥å¿ã\n * å¦æä¸è½½éåº¦æ¯è¾æ¢ï¼å¯ä»¥ä½¿ç¨ aliyun çéåï¼java -jar arthas-boot.jar --repo-mirror aliyun --use-http\n * java -jar arthas-boot.jar -h æå°æ´å¤åæ°ä¿¡æ¯ã\n\néæ©åºç¨ java è¿ç¨ï¼\n\n$ $ java -jar arthas-boot.jar\n* [1]: 35542\n  [2]: 71560 arthas-demo.jar\n\n\ndemo è¿ç¨æ¯ç¬¬ 2 ä¸ªï¼åè¾å¥ 2ï¼åè¾å¥åè½¦/enterãarthas ä¼ attach å°ç®æ è¿ç¨ä¸ï¼å¹¶è¾åºæ¥å¿ï¼\n\n[info] try to attach process 71560\n[info] attach process 71560 success.\n[info] arthas-client connect 127.0.0.1 3658\n  ,---.  ,------. ,--------.,--.  ,--.  ,---.   ,---.\n /  o  \\ |  .--. ''--.  .--'|  '--'  | /  o  \\ '   .-'\n|  .-.  ||  '--'.'   |  |   |  .--.  ||  .-.  |`.  `-.\n|  | |  ||  |\\  \\    |  |   |  |  |  ||  | |  |.-'    |\n`--' `--'`--' '--'   `--'   `--'  `--'`--' `--'`-----'\n\nwiki: https://alibaba.github.io/arthas\nversion: 3.0.5.20181127201536\npid: 71560\ntime: 2018-11-28 19:16:24\n\n$\n\n\n\n# æ¥ç dashboard\n\nè¾å¥dashboardï¼æåè½¦/enterï¼ä¼å±ç¤ºå½åè¿ç¨çä¿¡æ¯ï¼æctrl+cå¯ä»¥ä¸­æ­æ§è¡ã\n\n$ dashboard\nid     name                   group          priori state  %cpu    time   interru daemon\n17     pool-2-thread-1        system         5      waitin 67      0:0    false   false\n27     timer-for-arthas-dashb system         10     runnab 32      0:0    false   true\n11     asyncappender-worker-a system         9      waitin 0       0:0    false   true\n9      attach listener        system         9      runnab 0       0:0    false   true\n3      finalizer              system         8      waitin 0       0:0    false   true\n2      reference handler      system         10     waitin 0       0:0    false   true\n4      signal dispatcher      system         9      runnab 0       0:0    false   true\n26     as-command-execute-dae system         10     timed_ 0       0:0    false   true\n13     job-timeout            system         9      timed_ 0       0:0    false   true\n1      main                   main           5      timed_ 0       0:0    false   false\n14     nioeventloopgroup-2-1  system         10     runnab 0       0:0    false   false\n18     nioeventloopgroup-2-2  system         10     runnab 0       0:0    false   false\n23     nioeventloopgroup-2-3  system         10     runnab 0       0:0    false   false\n15     nioeventloopgroup-3-1  system         10     runnab 0       0:0    false   false\nmemory             used   total max    usage gc\nheap               32m    155m  1820m  1.77% gc.ps_scavenge.count  4\nps_eden_space      14m    65m   672m   2.21% gc.ps_scavenge.time(m 166\nps_survivor_space  4m     5m    5m           s)\nps_old_gen         12m    85m   1365m  0.91% gc.ps_marksweep.count 0\nnonheap            20m    23m   -1           gc.ps_marksweep.time( 0\ncode_cache         3m     5m    240m   1.32% ms)\nruntime\nos.name                mac os x\nos.version             10.13.4\njava.version           1.8.0_162\njava.home              /library/java/javavir\n                       tualmachines/jdk1.8.0\n                       _162.jdk/contents/hom\n                       e/jre\n\n\n\n# éè¿ thread å½ä»¤æ¥è·åå°arthas-demoè¿ç¨ç main class\n\nthread 1ä¼æå°çº¿ç¨ id 1 çæ ï¼éå¸¸æ¯ main å½æ°ççº¿ç¨ã\n\n$ thread 1 | grep 'main('\n    at demo.mathgame.main(mathgame.java:17)\n\n\n\n# éè¿ jad æ¥åç¼è¯ main class\n\n$ jad demo.mathgame\n\nclassloader:\n+-sun.misc.launcher$appclassloader@3d4eac69\n  +-sun.misc.launcher$extclassloader@66350f69\n\nlocation:\n/tmp/arthas-demo.jar\n\n/*\n * decompiled with cfr 0_132.\n */\npackage demo;\n\nimport java.io.printstream;\nimport java.util.arraylist;\nimport java.util.iterator;\nimport java.util.list;\nimport java.util.random;\nimport java.util.concurrent.timeunit;\n\npublic class mathgame {\n    private static random random = new random();\n    private int illegalargumentcount = 0;\n\n    public static void main(string[] args) throws interruptedexception {\n        mathgame game = new mathgame();\n        do {\n            game.run();\n            timeunit.seconds.sleep(1l);\n        } while (true);\n    }\n\n    public void run() throws interruptedexception {\n        try {\n            int number = random.nextint();\n            list<integer> primefactors = this.primefactors(number);\n            mathgame.print(number, primefactors);\n        }\n        catch (exception e) {\n            system.out.println(string.format(\"illegalargumentcount:%3d, \", this.illegalargumentcount) + e.getmessage());\n        }\n    }\n\n    public static void print(int number, list<integer> primefactors) {\n        stringbuffer sb = new stringbuffer(\"\" + number + \"=\");\n        iterator<integer> iterator = primefactors.iterator();\n        while (iterator.hasnext()) {\n            int factor = iterator.next();\n            sb.append(factor).append('*');\n        }\n        if (sb.charat(sb.length() - 1) == '*') {\n            sb.deletecharat(sb.length() - 1);\n        }\n        system.out.println(sb);\n    }\n\n    public list<integer> primefactors(int number) {\n        if (number < 2) {\n            ++this.illegalargumentcount;\n            throw new illegalargumentexception(\"number is: \" + number + \", need >= 2\");\n        }\n        arraylist<integer> result = new arraylist<integer>();\n        int i = 2;\n        while (i <= number) {\n            if (number % i == 0) {\n                result.add(i);\n                number /= i;\n                i = 2;\n                continue;\n            }\n            ++i;\n        }\n        return result;\n    }\n}\n\naffect(row-cnt:1) cost in 970 ms.\n\n\n\n# watch\n\néè¿watchå½ä»¤æ¥æ¥çdemo.mathgame#primefactorså½æ°çè¿åå¼ï¼\n\n$ watch demo.mathgame primefactors returnobj\npress ctrl+c to abort.\naffect(class-cnt:1 , method-cnt:1) cost in 107 ms.\nts=2018-11-28 19:22:30; [cost=1.715367ms] result=null\nts=2018-11-28 19:22:31; [cost=0.185203ms] result=null\nts=2018-11-28 19:22:32; [cost=19.012416ms] result=@arraylist[\n    @integer[5],\n    @integer[47],\n    @integer[2675531],\n]\nts=2018-11-28 19:22:33; [cost=0.311395ms] result=@arraylist[\n    @integer[2],\n    @integer[5],\n    @integer[317],\n    @integer[503],\n    @integer[887],\n]\nts=2018-11-28 19:22:34; [cost=10.136007ms] result=@arraylist[\n    @integer[2],\n    @integer[2],\n    @integer[3],\n    @integer[3],\n    @integer[31],\n    @integer[717593],\n]\nts=2018-11-28 19:22:35; [cost=29.969732ms] result=@arraylist[\n    @integer[5],\n    @integer[29],\n    @integer[7651739],\n]\n\n\næ´å¤çåè½å¯ä»¥æ¥çè¿é¶ä½¿ç¨ã\n\n\n# éåº arthas\n\nå¦æåªæ¯éåºå½åçè¿æ¥ï¼å¯ä»¥ç¨quitæèexitå½ä»¤ãattach å°ç®æ è¿ç¨ä¸ç arthas è¿ä¼ç»§ç»­è¿è¡ï¼ç«¯å£ä¼ä¿æå¼æ¾ï¼ä¸æ¬¡è¿æ¥æ¶å¯ä»¥ç´æ¥è¿æ¥ä¸ã\n\nå¦ææ³å®å¨éåº arthasï¼å¯ä»¥æ§è¡shutdownå½ä»¤ã\n\n\n# è¿é¶ä½¿ç¨\n\n\n# åºç¡å½ä»¤\n\n * helpââæ¥çå½ä»¤å¸®å©ä¿¡æ¯\n * catââæå°æä»¶åå®¹ï¼å linux éç cat å½ä»¤ç±»ä¼¼\n * pwdââè¿åå½åçå·¥ä½ç®å½ï¼å linux å½ä»¤ç±»ä¼¼\n * clsââæ¸ç©ºå½åå±å¹åºå\n * sessionââæ¥çå½åä¼è¯çä¿¡æ¯\n * resetââéç½®å¢å¼ºç±»ï¼å°è¢« arthas å¢å¼ºè¿çç±»å¨é¨è¿åï¼arthas æå¡ç«¯å³é­æ¶ä¼éç½®ææå¢å¼ºè¿çç±»\n * versionââè¾åºå½åç®æ  java è¿ç¨æå è½½ç arthas çæ¬å·\n * historyââæå°å½ä»¤åå²\n * quitââéåºå½å arthas å®¢æ·ç«¯ï¼å¶ä» arthas å®¢æ·ç«¯ä¸åå½±å\n * shutdownââå³é­ arthas æå¡ç«¯ï¼ææ arthas å®¢æ·ç«¯å¨é¨éåº\n * keymapââarthas å¿«æ·é®åè¡¨åèªå®ä¹å¿«æ·é®\n\n\n# jvm ç¸å³\n\n * dashboardââå½åç³»ç»çå®æ¶æ°æ®é¢æ¿\n * threadââæ¥çå½å jvm ççº¿ç¨å æ ä¿¡æ¯\n * jvmââæ¥çå½å jvm çä¿¡æ¯\n * syspropââæ¥çåä¿®æ¹ jvm çç³»ç»å±æ§\n * sysenvââæ¥ç jvm çç¯å¢åé\n * vmoptionââæ¥çåä¿®æ¹ jvm éè¯æ­ç¸å³ç option\n * loggerââæ¥çåä¿®æ¹ logger\n * getstaticââæ¥çç±»çéæå±æ§\n * ognlââæ§è¡ ognl è¡¨è¾¾å¼\n * mbeanââæ¥ç mbean çä¿¡æ¯\n * heapdumpââdump java heap, ç±»ä¼¼ jmap å½ä»¤ç heap dump åè½\n\n\n# class/classloader ç¸å³\n\n * scââæ¥ç jvm å·²å è½½çç±»ä¿¡æ¯\n * smââæ¥çå·²å è½½ç±»çæ¹æ³ä¿¡æ¯\n * jadââåç¼è¯æå®å·²å è½½ç±»çæºç \n * mcââåå­ç¼ç»å¨ï¼åå­ç¼ç».javaæä»¶ä¸º.classæä»¶\n * redefineââå è½½å¤é¨ç.classæä»¶ï¼redefine å° jvm é\n * dumpââdump å·²å è½½ç±»ç byte code å°ç¹å®ç®å½\n * classloaderââæ¥ç classloader çç»§æ¿æ ï¼urlsï¼ç±»å è½½ä¿¡æ¯ï¼ä½¿ç¨ classloader å» getresource\n\n\n# monitor/watch/trace ç¸å³\n\n> è¯·æ³¨æï¼è¿äºå½ä»¤ï¼é½éè¿å­èç å¢å¼ºææ¯æ¥å®ç°çï¼ä¼å¨æå®ç±»çæ¹æ³ä¸­æå¥ä¸äºåé¢æ¥å®ç°æ°æ®ç»è®¡åè§æµï¼å æ­¤å¨çº¿ä¸ãé¢åä½¿ç¨æ¶ï¼è¯·å°½éæç¡®éè¦è§æµçç±»ãæ¹æ³ä»¥åæ¡ä»¶ï¼è¯æ­ç»æè¦æ§è¡ shutdown æå°å¢å¼ºè¿çç±»æ§è¡ reset å½ä»¤ã\n\n * monitorââæ¹æ³æ§è¡çæ§\n * watchââæ¹æ³æ§è¡æ°æ®è§æµ\n * traceââæ¹æ³åé¨è°ç¨è·¯å¾ï¼å¹¶è¾åºæ¹æ³è·¯å¾ä¸çæ¯ä¸ªèç¹ä¸èæ¶\n * stackââè¾åºå½åæ¹æ³è¢«è°ç¨çè°ç¨è·¯å¾\n * ttââæ¹æ³æ§è¡æ°æ®çæ¶ç©ºé§éï¼è®°å½ä¸æå®æ¹æ³æ¯æ¬¡è°ç¨çå¥ååè¿åä¿¡æ¯ï¼å¹¶è½å¯¹è¿äºä¸åçæ¶é´ä¸è°ç¨è¿è¡è§æµ\n\n\n# options\n\n * optionsââæ¥çæè®¾ç½® arthas å¨å±å¼å³\n\n\n# ç®¡é\n\narthas æ¯æä½¿ç¨ç®¡éå¯¹ä¸è¿°å½ä»¤çç»æè¿è¡è¿ä¸æ­¥çå¤çï¼å¦sm java.lang.string * | grep 'index'\n\n * grepââæç´¢æ»¡è¶³æ¡ä»¶ç \b ç»æ\n * plaintextââå° \b å½ä»¤çç»æå»é¤ ansi é¢è²\n * wcââæè¡ç»è®¡è¾åºç»æ\n\n\n# åå°å¼æ­¥ä»»å¡\n\nå½çº¿ä¸åºç°å¶åçé®é¢ï¼æ¯å¦éè¦ watch æä¸ªæ¡ä»¶ï¼èè¿ä¸ªæ¡ä»¶ä¸å¤©å¯è½æä¼åºç°ä¸æ¬¡æ¶ï¼å¼æ­¥åå°ä»»å¡å°±æ´¾ä¸ç¨åºäºï¼è¯¦æè¯·åèè¿é\n\n * ä½¿ç¨ > å°ç»æéååå°æ¥å¿æä»¶ï¼ä½¿ç¨ & æå®å½ä»¤æ¯åå°è¿è¡ï¼session æ­å¼ä¸å½±åä»»å¡æ§è¡ï¼çå½å¨æé»è®¤ä¸º 1 å¤©ï¼\n * jobsââååºææ job\n * killââå¼ºå¶ç»æ­¢ä»»å¡\n * fgââå°æåçä»»å¡æå°åå°æ§è¡\n * bgââå°æåçä»»å¡æ¾å°åå°æ§è¡\n\n\n# web console\n\néè¿ websocket è¿æ¥ arthasã\n\n * web console\n\n\n# ç¨æ·æ°æ®åæ¥\n\nå¨3.1.4çæ¬åï¼å¢å äºç¨æ·æ°æ®åæ¥åè½ï¼æ¹ä¾¿ç»ä¸åå®å¨æèåå²æ°æ®ç»è®¡ã\n\nå¨å¯å¨æ¶ï¼æå®stat-urlï¼å°±ä¼åæ¥æ§è¡çæ¯ä¸è¡å½ä»¤ï¼æ¯å¦ï¼ ./as.sh --stat-url 'http://192.168.10.11:8080/api/stat'\n\nå¨ tunnel server éæä¸ä¸ªç¤ºä¾çåæ¥ä»£ç ï¼ç¨æ·å¯ä»¥èªå·±å¨æå¡å¨ä¸å®ç°ã\n\nstatcontroller.java\n\n\n# å¶ä»ç¹æ§\n\n * å¼æ­¥å½ä»¤æ¯æ\n * æ§è¡ç»æå­æ¥å¿\n * æ¹å¤ççæ¯æ\n * ognl è¡¨è¾¾å¼çç¨æ³è¯´æ\n\n\n# åèèµæ\n\n * arthas github\n * arthas ç¨æ·ææ¡£\n * arthas æºç åæ",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java çæ§è¯æ­",frontmatter:{title:"Java çæ§è¯æ­",categories:["ç¼ç¨","Java","è½¯ä»¶","çæ§è¯æ­"],tags:["Java","çæ§","è¯æ­"],abbrlink:"7af21817",date:"2020-02-11T17:48:32.000Z",permalink:"/pages/2853ec/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/03.%E7%9B%91%E6%8E%A7%E8%AF%8A%E6%96%AD/",relativePath:"11.è½¯ä»¶/03.çæ§è¯æ­/README.md",key:"v-1f33db24",path:"/pages/2853ec/",headers:[{level:2,title:"åå®¹",slug:"åå®¹",normalizedTitle:"åå®¹",charIndex:16},{level:2,title:"èµæ",slug:"èµæ",normalizedTitle:"èµæ",charIndex:75}],headersStr:"åå®¹ èµæ",content:"# Java çæ§è¯æ­\n\n\n# åå®¹\n\n * çæ§å·¥å·å¯¹æ¯\n * CAT\n * Zipkin\n * SkyWalking\n * Arthas\n\n\n# èµæ\n\n * CAT Github\n * Zipkin Github\n * SkyWalking Github\n * PinPoint Github\n * Arthas Github",normalizedContent:"# java çæ§è¯æ­\n\n\n# åå®¹\n\n * çæ§å·¥å·å¯¹æ¯\n * cat\n * zipkin\n * skywalking\n * arthas\n\n\n# èµæ\n\n * cat github\n * zipkin github\n * skywalking github\n * pinpoint github\n * arthas github",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java è½¯ä»¶",frontmatter:{title:"Java è½¯ä»¶",categories:["ç¼ç¨","Java","è½¯ä»¶","IDE"],tags:["Java"],abbrlink:"bd90f980",date:"2022-02-18T08:53:11.000Z",hidden:!0,permalink:"/pages/dab057/"},regularPath:"/11.%E8%BD%AF%E4%BB%B6/",relativePath:"11.è½¯ä»¶/README.md",key:"v-415dc8b8",path:"/pages/dab057/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:71},{level:3,title:"æå»º",slug:"æå»º",normalizedTitle:"æå»º",charIndex:46},{level:3,title:"IDE",slug:"ide",normalizedTitle:"ide",charIndex:51},{level:3,title:"çæ§è¯æ­",slug:"çæ§è¯æ­",normalizedTitle:"çæ§è¯æ­",charIndex:768},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:902},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:989}],headersStr:"ð åå®¹ æå»º IDE çæ§è¯æ­ ð èµæ ðª ä¼ é",content:"# Java è½¯ä»¶\n\n> æ¬é¨ååå®¹ä¸»è¦æ¯ Java å¼åé¢åä½¿ç¨çä¸äº Java è½¯ä»¶ï¼å¦æå»ºå·¥å·ãIDEãæå¡å¨ãæ¥å¿ä¸­å¿ç­ç­ã\n\n\n# ð åå®¹\n\n\n# æå»º\n\n> Java é¡¹ç®éè¦éè¿ æå»ºå·¥å· æ¥ç®¡çé¡¹ç®ä¾èµï¼å®æç¼è¯ãæåãåå¸ãçæ JavaDoc ç­ä»»å¡ã\n> \n>  * ç®åæä¸»æµçæå»ºå·¥å·æ¯ Mavenï¼å®çåè½éå¸¸å¼ºå¤§ã\n>  * Gradle å·ç§°æ¯è¦æ¿ä»£ Maven ç­æä»¶å·¥å·ï¼å®ççæ¬ç®¡çç¡®å®ç®æ´ï¼ä½æ¯éè¦å­¦ä¹  Groovyï¼å­¦ä¹ ææ¬æ¯ Maven é«ã\n>  * Ant åè½æ¯ Maven å Gradle è¦å¼±ï¼ç°ä»£ Java é¡¹ç®åºæ¬ä¸ç¨äºï¼ä½ä¹æä¸äºä¼ ç»ç Java é¡¹ç®è¿å¨ä½¿ç¨ã\n\n * Maven ð\n   * Maven å¿«éå¥é¨\n   * Maven æç¨ä¹ pom.xml è¯¦è§£\n   * Maven æç¨ä¹ settings.xml è¯¦è§£\n   * Maven å®æé®é¢åæä½³å®è·µ\n   * Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n   * Maven æä»¶ä¹ä»£ç æ£æ¥\n * Ant ç®ææç¨\n\n\n# IDE\n\n> èªä»æäº IDEï¼åä»£ç ä»æ­¤å°±åå«äºåèç«ç§çè®èæ¶ä»£ã\n> \n>  * Eclipse æ¯ä¹è´çåçå¼æº Java IDEï¼æçå­¦çæ¶ä»£ä¸ç´ä½¿ç¨å®å Javaã\n>  * æ¾ç»ææä»è½¬ Intellij Idea ï¼ä½åæ¥åç°çé¦ï¼ä¸å¾ä¸è¯´ï¼ç¡®å®æ¯ç®åæä¼ç§ç Java IDEã\n>  * ä½ å¯ä»¥å¨ vscode ä¸­ååç§è¯­è¨ï¼åªè¦å®è£ç¸åºæä»¶å³å¯ãå¦æä½ çé¡¹ç®ä¸­ä½¿ç¨äºå¾å¤ç§ç¼ç¨è¯­è¨ï¼åæå¾å¨å¤ä¸ª IDE ä¹é´åæ¢ï¼é£ä¹å°±ç¨ vscode æ¥ä¸ç½æå°½å§ã\n\n * Intellij Idea\n * Eclipse\n * vscode\n\n\n# çæ§è¯æ­\n\n> çæ§/è¯æ­ å·¥å·ä¸»è¦ç¨äº Java åºç¨çè¿ç»´ãéè¿ééãåæãå­å¨ãå¯è§ååºç¨çæææ°æ®ï¼å¸®å©å¼åèãä½¿ç¨èå¿«éå®ä½é®é¢ï¼æ¾å°æ§è½ç¶é¢ã\n\n * çæ§å·¥å·å¯¹æ¯\n * CAT\n * Zipkin\n * SkyWalking\n * Arthas\n\n\n# ð èµæ\n\n * å®ç½\n   * Maven Github\n   * Maven å®æ¹ææ¡£\n   * Ant å®æ¹æå\n * ä¹¦ç±\n   * ãMaven å®æã\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java è½¯ä»¶\n\n> æ¬é¨ååå®¹ä¸»è¦æ¯ java å¼åé¢åä½¿ç¨çä¸äº java è½¯ä»¶ï¼å¦æå»ºå·¥å·ãideãæå¡å¨ãæ¥å¿ä¸­å¿ç­ç­ã\n\n\n# ð åå®¹\n\n\n# æå»º\n\n> java é¡¹ç®éè¦éè¿ æå»ºå·¥å· æ¥ç®¡çé¡¹ç®ä¾èµï¼å®æç¼è¯ãæåãåå¸ãçæ javadoc ç­ä»»å¡ã\n> \n>  * ç®åæä¸»æµçæå»ºå·¥å·æ¯ mavenï¼å®çåè½éå¸¸å¼ºå¤§ã\n>  * gradle å·ç§°æ¯è¦æ¿ä»£ maven ç­æä»¶å·¥å·ï¼å®ççæ¬ç®¡çç¡®å®ç®æ´ï¼ä½æ¯éè¦å­¦ä¹  groovyï¼å­¦ä¹ ææ¬æ¯ maven é«ã\n>  * ant åè½æ¯ maven å gradle è¦å¼±ï¼ç°ä»£ java é¡¹ç®åºæ¬ä¸ç¨äºï¼ä½ä¹æä¸äºä¼ ç»ç java é¡¹ç®è¿å¨ä½¿ç¨ã\n\n * maven ð\n   * maven å¿«éå¥é¨\n   * maven æç¨ä¹ pom.xml è¯¦è§£\n   * maven æç¨ä¹ settings.xml è¯¦è§£\n   * maven å®æé®é¢åæä½³å®è·µ\n   * maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n   * maven æä»¶ä¹ä»£ç æ£æ¥\n * ant ç®ææç¨\n\n\n# ide\n\n> èªä»æäº ideï¼åä»£ç ä»æ­¤å°±åå«äºåèç«ç§çè®èæ¶ä»£ã\n> \n>  * eclipse æ¯ä¹è´çåçå¼æº java ideï¼æçå­¦çæ¶ä»£ä¸ç´ä½¿ç¨å®å javaã\n>  * æ¾ç»ææä»è½¬ intellij idea ï¼ä½åæ¥åç°çé¦ï¼ä¸å¾ä¸è¯´ï¼ç¡®å®æ¯ç®åæä¼ç§ç java ideã\n>  * ä½ å¯ä»¥å¨ vscode ä¸­ååç§è¯­è¨ï¼åªè¦å®è£ç¸åºæä»¶å³å¯ãå¦æä½ çé¡¹ç®ä¸­ä½¿ç¨äºå¾å¤ç§ç¼ç¨è¯­è¨ï¼åæå¾å¨å¤ä¸ª ide ä¹é´åæ¢ï¼é£ä¹å°±ç¨ vscode æ¥ä¸ç½æå°½å§ã\n\n * intellij idea\n * eclipse\n * vscode\n\n\n# çæ§è¯æ­\n\n> çæ§/è¯æ­ å·¥å·ä¸»è¦ç¨äº java åºç¨çè¿ç»´ãéè¿ééãåæãå­å¨ãå¯è§ååºç¨çæææ°æ®ï¼å¸®å©å¼åèãä½¿ç¨èå¿«éå®ä½é®é¢ï¼æ¾å°æ§è½ç¶é¢ã\n\n * çæ§å·¥å·å¯¹æ¯\n * cat\n * zipkin\n * skywalking\n * arthas\n\n\n# ð èµæ\n\n * å®ç½\n   * maven github\n   * maven å®æ¹ææ¡£\n   * ant å®æ¹æå\n * ä¹¦ç±\n   * ãmaven å®æã\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java å JSON åºåå",frontmatter:{title:"Java å JSON åºåå",categories:["ç¼ç¨","Java","å·¥å·","IO"],tags:["Java","IO","åºåå","JSON"],abbrlink:"37e168b9",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/a14952/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/01.IO/01.JSON%E5%BA%8F%E5%88%97%E5%8C%96.html",relativePath:"12.å·¥å·/01.IO/01.JSONåºåå.md",key:"v-4f0d9490",path:"/pages/a14952/",headers:[{level:2,title:"JSON ç®ä»",slug:"json-ç®ä»",normalizedTitle:"json ç®ä»",charIndex:184},{level:3,title:"JSON æ¯ä»ä¹",slug:"json-æ¯ä»ä¹",normalizedTitle:"json æ¯ä»ä¹",charIndex:196},{level:3,title:"JSON æ å",slug:"json-æ å",normalizedTitle:"json æ å",charIndex:426},{level:3,title:"JSON ä¼ç¼ºç¹",slug:"json-ä¼ç¼ºç¹",normalizedTitle:"json ä¼ç¼ºç¹",charIndex:979},{level:3,title:"JSON å·¥å·",slug:"json-å·¥å·",normalizedTitle:"json å·¥å·",charIndex:1571},{level:3,title:"Java JSON åº",slug:"java-json-åº",normalizedTitle:"java json åº",charIndex:1815},{level:3,title:"JSON ç¼ç æå",slug:"json-ç¼ç æå",normalizedTitle:"json ç¼ç æå",charIndex:2018},{level:2,title:"Fastjson åºç¨",slug:"fastjson-åºç¨",normalizedTitle:"fastjson åºç¨",charIndex:2713},{level:3,title:"æ·»å  maven ä¾èµ",slug:"æ·»å -maven-ä¾èµ",normalizedTitle:"æ·»å  maven ä¾èµ",charIndex:2729},{level:3,title:"Fastjson API",slug:"fastjson-api",normalizedTitle:"fastjson api",charIndex:2876},{level:4,title:"å®ä¹ Bean",slug:"å®ä¹-bean",normalizedTitle:"å®ä¹ bean",charIndex:2892},{level:4,title:"åºåå",slug:"åºåå",normalizedTitle:"åºåå",charIndex:14},{level:4,title:"ååºåå",slug:"ååºåå",normalizedTitle:"ååºåå",charIndex:3508},{level:3,title:"Fastjson æ³¨è§£",slug:"fastjson-æ³¨è§£",normalizedTitle:"fastjson æ³¨è§£",charIndex:3575},{level:4,title:"@JSONField",slug:"jsonfield",normalizedTitle:"@jsonfield",charIndex:3590},{level:4,title:"@JSONType",slug:"jsontype",normalizedTitle:"@jsontype",charIndex:4046},{level:2,title:"Jackson åºç¨",slug:"jackson-åºç¨",normalizedTitle:"jackson åºç¨",charIndex:4338},{level:3,title:"æ·»å  maven ä¾èµ",slug:"æ·»å -maven-ä¾èµ-2",normalizedTitle:"æ·»å  maven ä¾èµ",charIndex:2729},{level:3,title:"Jackson API",slug:"jackson-api",normalizedTitle:"jackson api",charIndex:4569},{level:4,title:"åºåå",slug:"åºåå-2",normalizedTitle:"åºåå",charIndex:14},{level:4,title:"ååºåå",slug:"ååºåå-2",normalizedTitle:"ååºåå",charIndex:3508},{level:4,title:"å®¹å¨çåºåååååºåå",slug:"å®¹å¨çåºåååååºåå",normalizedTitle:"å®¹å¨çåºåååååºåå",charIndex:5132},{level:3,title:"Jackson æ³¨è§£",slug:"jackson-æ³¨è§£",normalizedTitle:"jackson æ³¨è§£",charIndex:5550},{level:4,title:"@JsonProperty",slug:"jsonproperty",normalizedTitle:"@jsonproperty",charIndex:5610},{level:4,title:"@JsonIgnoreProperties å @JsonIgnore",slug:"jsonignoreproperties-å-jsonignore",normalizedTitle:"@jsonignoreproperties å @jsonignore",charIndex:5968},{level:4,title:"@JsonCreator",slug:"jsoncreator",normalizedTitle:"@jsoncreator",charIndex:6556},{level:4,title:"@JsonPropertyOrder",slug:"jsonpropertyorder",normalizedTitle:"@jsonpropertyorder",charIndex:6858},{level:2,title:"Gson åºç¨",slug:"gson-åºç¨",normalizedTitle:"gson åºç¨",charIndex:7008},{level:3,title:"æ·»å  maven ä¾èµ",slug:"æ·»å -maven-ä¾èµ-3",normalizedTitle:"æ·»å  maven ä¾èµ",charIndex:2729},{level:3,title:"Gson API",slug:"gson-api",normalizedTitle:"gson api",charIndex:7198},{level:4,title:"åºåå",slug:"åºåå-3",normalizedTitle:"åºåå",charIndex:14},{level:4,title:"ååºåå",slug:"ååºåå-3",normalizedTitle:"ååºåå",charIndex:3508},{level:4,title:"GsonBuilder",slug:"gsonbuilder",normalizedTitle:"gsonbuilder",charIndex:7719},{level:3,title:"Gson æ³¨è§£",slug:"gson-æ³¨è§£",normalizedTitle:"gson æ³¨è§£",charIndex:7977},{level:4,title:"@Since",slug:"since",normalizedTitle:"@since",charIndex:7988},{level:4,title:"@SerializedName",slug:"serializedname",normalizedTitle:"@serializedname",charIndex:8605},{level:2,title:"ç¤ºä¾æºç ",slug:"ç¤ºä¾æºç ",normalizedTitle:"ç¤ºä¾æºç ",charIndex:8904},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:8937}],headersStr:"JSON ç®ä» JSON æ¯ä»ä¹ JSON æ å JSON ä¼ç¼ºç¹ JSON å·¥å· Java JSON åº JSON ç¼ç æå Fastjson åºç¨ æ·»å  maven ä¾èµ Fastjson API å®ä¹ Bean åºåå ååºåå Fastjson æ³¨è§£ @JSONField @JSONType Jackson åºç¨ æ·»å  maven ä¾èµ Jackson API åºåå ååºåå å®¹å¨çåºåååååºåå Jackson æ³¨è§£ @JsonProperty @JsonIgnoreProperties å @JsonIgnore @JsonCreator @JsonPropertyOrder Gson åºç¨ æ·»å  maven ä¾èµ Gson API åºåå ååºåå GsonBuilder Gson æ³¨è§£ @Since @SerializedName ç¤ºä¾æºç  åèèµæ",content:'# Java å JSON åºåå\n\n> JSONï¼JavaScript Object Notationï¼æ¯ä¸ç§åºäºææ¬çæ°æ®äº¤æ¢æ ¼å¼ãå ä¹ææçç¼ç¨è¯­è¨é½æå¾å¥½çåºæç¬¬ä¸æ¹å·¥å·æ¥æä¾åºäº JSON ç API æ¯æï¼å æ­¤ä½ å¯ä»¥éå¸¸æ¹ä¾¿å°ä½¿ç¨ä»»ä½èªå·±åæ¬¢çç¼ç¨è¯­è¨æ¥å¤ç JSON æ°æ®ã\n> \n> æ¬æä¸»è¦ä» Java è¯­è¨çè§åº¦æ¥è®²è§£ JSON çåºç¨ã\n\n\n# JSON ç®ä»\n\n\n# JSON æ¯ä»ä¹\n\nJSON èµ·æºäº 1999 å¹´ç JS è¯­è¨è§è ECMA262 çä¸ä¸ªå­éï¼å³ 15.12 ç« èæè¿°äºæ ¼å¼ä¸è§£æï¼ï¼åæ¥ 2003 å¹´ä½ä¸ºä¸ä¸ªæ°æ®æ ¼å¼ECMA404ï¼å¾å§çåºå·æä¸æï¼ï¼åå¸ã 2006 å¹´ï¼ä½ä¸º rfc4627 åå¸ï¼è¿æ¶è§èå¢å å° 18 é¡µï¼å»ææ²¡ç¨çé¨åï¼åé¡µä¸å°ã\n\nJSON çåºç¨å¾å¹¿æ³ï¼è¿éæè¶è¿ 100 ç§è¯­è¨ä¸ç JSON åºï¼json.orgã\n\næ´å¤çå¯ä»¥åèè¿éï¼å³äº json çä¸åã\n\n\n# JSON æ å\n\nè¿ä¼°è®¡æ¯æç®åæ åè§èä¹ä¸ï¼\n\n * åªæä¸¤ç§ç»æï¼å¯¹è±¡åçé®å¼å¯¹éåç»æåæ°ç»ï¼å¯¹è±¡ç¨ {} è¡¨ç¤ºãåé¨æ¯ "key":"value"ï¼æ°ç»ç¨ [] è¡¨ç¤ºï¼ä¸åå¼ç¨éå·åå¼\n * åºæ¬æ°å¼æ 7 ä¸ªï¼ false / null / true / object / array / number / string\n * åå ä¸ç»æå¯ä»¥åµå¥ï¼è¿èå¯ä»¥ç¨æ¥è¡¨è¾¾å¤æçæ°æ®\n * ä¸ä¸ªç®åå®ä¾ï¼\n\n{\n  "Image": {\n    "Width": 800,\n    "Height": 600,\n    "Title": "View from 15th Floor",\n    "Thumbnail": {\n      "Url": "http://www.example.com/image/481989943",\n      "Height": 125,\n      "Width": "100"\n    },\n    "IDs": [116, 943, 234, 38793]\n  }\n}\n\n\n> æ©å±éè¯»ï¼\n> \n>  * http://www.json.org/json-zh.html - å¾æå¹¶èä»ç» json æ°æ®å½¢å¼\n> \n>  * json ç RFC ææ¡£\n\n\n# JSON ä¼ç¼ºç¹\n\nä¼ç¹ï¼\n\n * åºäºçº¯ææ¬ï¼æä»¥å¯¹äºäººç±»éè¯»æ¯å¾åå¥½çã\n * è§èç®åï¼æä»¥å®¹æå¤çï¼å¼ç®±å³ç¨ï¼ç¹å«æ¯ JS ç±»ç ECMA èæ¬éæ¯åå»ºæ¯æçï¼å¯ä»¥ç´æ¥ä½ä¸ºå¯¹è±¡ä½¿ç¨ã\n * å¹³å°æ å³æ§ï¼å ä¸ºç±»ååç»æé½æ¯å¹³å°æ å³çï¼èä¸å¥½å¤çï¼å®¹æå®ç°ä¸åè¯­è¨çå¤çç±»åºï¼å¯ä»¥ä½ä¸ºå¤ä¸ªä¸åå¼æç³»ç»ä¹é´çæ°æ®ä¼ è¾æ ¼å¼åè®®ï¼ç¹å«æ¯å¨ HTTP/REST ä¸çæ°æ®æ ¼å¼ã\n\nç¼ºç¹ï¼\n\n * æ§è½ä¸è¬ï¼ææ¬è¡¨ç¤ºçæ°æ®ä¸è¬æ¥è¯´æ¯äºè¿å¶å¤§å¾å¤ï¼å¨æ°æ®ä¼ è¾ä¸åè§£æå¤çä¸é½è¦æ´å½±åæ§è½ã\n * ç¼ºä¹ schemaï¼è·åæ¯ææ¬æ°æ®æ ¼å¼ç XML æ¯ï¼å¨ç±»åçä¸¥æ ¼æ§åä¸°å¯æ§ä¸è¦å·®å¾å¤ãXML å¯ä»¥åç± XSD æ DTD æ¥å®ä¹å¤æçæ ¼å¼ï¼å¹¶ç±æ­¤æ¥éªè¯ XML ææ¡£æ¯å¦ç¬¦åæ ¼å¼è¦æ±ï¼çè³è¿ä¸æ­¥çï¼å¯ä»¥åºäº XSD æ¥çæå·ä½è¯­è¨çæä½ä»£ç ï¼ä¾å¦ apache xmlbeansãå¹¶ä¸è¿äºå·¥å·ç»åå°ä¸èµ·ï¼å½¢æä¸å¥åºå¤§ççæï¼ä¾å¦åºäº XML å¯ä»¥å®ç° SOAP å WSDLï¼ä¸ç³»åç ws-*è§èãä½æ¯æä»¬ä¹å¯ä»¥çå° JSON å¨ç¼ºä¹è§èçæåµä¸ï¼å®éä¸ææ´å¤§ä¸äºççµæ´»æ§ï¼ç¹å«æ¯è¿å¹´æ¥ REST çå¿«éåå±ï¼å·²ç»æä¸äº schema ç¸å³çåå±(ä¾å¦çè§£ JSON Schemaï¼ä½¿ç¨ JSON Schemaï¼ å¨çº¿ schema æµè¯)ï¼ä¹æç±»ä¼¼äº WSDL çWADLåºç°ã\n\n\n# JSON å·¥å·\n\n * ä½¿ç¨ JSON å®ç° RPCï¼ç±»ä¼¼ XML-RPCï¼ï¼JSON-RPC\n\n * ä½¿ç¨ JSON å®ç° path æ¥è¯¢æä½ï¼ç±»ä¼¼ XML-PATHï¼ï¼JsonPATH\n\n * å¨çº¿æ¥è¯¢å·¥å·ï¼JsonPATH\n\n * æ ¼å¼åå·¥å·ï¼jsbeautifier\n\n * chrome æä»¶ï¼5 ä¸ª Json View æä»¶\n\n * å¨çº¿ Mock: å¨çº¿ mock\n\n * å¶ä» Mockï¼SoapUIå¯ä»¥æ¯æï¼SwaggerUI ä¹å¯ä»¥ï¼RestMockä¹å¯ä»¥ã\n\n\n# Java JSON åº\n\nJava ä¸­æ¯è¾æµè¡ç JSON åºæï¼\n\n * Fastjson - é¿éå·´å·´å¼åç JSON åºï¼æ§è½ååä¼ç§ã\n * Jackson - ç¤¾åºååæ´»è·ä¸æ´æ°éåº¦å¾å¿«ãSpring æ¡æ¶é»è®¤ JSON åºã\n * Gson - è°·æ­å¼åç JSON åºï¼ç®ååè½æå¨ç JSON åº ã\n\nä»æ§è½ä¸æ¥çï¼ä¸è¬æåµä¸ï¼Fastjson > Jackson > Gson\n\n\n# JSON ç¼ç æå\n\n> éµå¾ªå¥½çè®¾è®¡ä¸ç¼ç é£æ ¼ï¼è½æåè§£å³ 80%çé®é¢ï¼ä¸ªäººæ¨è Google JSON é£æ ¼æåã\n> \n>  * è±æçGoogle JSON Style Guideï¼https://google.github.io/styleguide/jsoncstyleguide.xml\n>  * ä¸­æçGoogle JSON é£æ ¼æåï¼https://github.com/darcyliu/google-styleguide/blob/master/JSONStyleGuide.md\n\nç®åæå½å¦ä¸ï¼\n\n * å±æ§ååå¼é½æ¯ç¨åå¼å·ï¼ä¸è¦ææ³¨éåå°å¯¹è±¡éé¢ï¼å¯¹è±¡æ°æ®è¦ç®æ´\n * ä¸è¦éæç»æååç»å¯¹è±¡ï¼æ¨èæ¯ç¨æå¹³åæ¹å¼ï¼å±æ¬¡ä¸è¦å¤ªå¤æ\n * å½åæ¹å¼è¦ææä¹ï¼æ¯å¦åå¤æ°è¡¨ç¤º\n * é©¼å³°å¼å½åï¼éµå¾ª Bean è§è\n * ä½¿ç¨çæ¬æ¥æ§å¶åæ´å²çª\n * å¯¹äºä¸äºå³é®å­ï¼ä¸è¦æ¿æ¥å key\n * å¦æä¸ä¸ªå±æ§æ¯å¯éçæèåå«ç©ºå¼æ null å¼ï¼èèä» JSON ä¸­å»æè¯¥å±æ§ï¼é¤éå®çå­å¨æå¾å¼ºçè¯­ä¹åå \n * åºååæä¸¾ç±»åæ¶ï¼ä½¿ç¨ name èä¸æ¯ value\n * æ¥æè¦ç¨æ åæ ¼å¼å¤ç\n * è®¾è®¡å¥½éç¨çåé¡µåæ°\n * è®¾è®¡å¥½å¼å¸¸å¤ç\n\nJSON APIä¸ Google JSON é£æ ¼æåæå¾å¤å¯ä»¥ç¸äºåç§ä¹å¤ã\n\nJSON APIæ¯æ°æ®äº¤äºè§èï¼ç¨ä»¥å®ä¹å®¢æ·ç«¯å¦ä½è·åä¸ä¿®æ¹èµæºï¼ä»¥åæå¡å¨å¦ä½ååºå¯¹åºè¯·æ±ã\n\nJSON API è®¾è®¡ç¨æ¥æå°åè¯·æ±çæ°éï¼ä»¥åå®¢æ·ç«¯ä¸æå¡å¨é´ä¼ è¾çæ°æ®éãå¨é«æå®ç°çåæ¶ï¼æ éçºç²å¯è¯»æ§ãçµæ´»æ§åå¯åç°æ§ã\n\n\n# Fastjson åºç¨\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>x.x.x</version>\n</dependency>\n\n\n\n# Fastjson API\n\n# å®ä¹ Bean\n\nGroup.java\n\npublic class Group {\n\n    private Long       id;\n    private String     name;\n    private List<User> users = new ArrayList<User>();\n}\n\n\nUser.java\n\npublic class User {\n\n    private Long   id;\n    private String name;\n}\n\n\nåå§å Bean\n\nGroup group = new Group();\ngroup.setId(0L);\ngroup.setName("admin");\n\nUser guestUser = new User();\nguestUser.setId(2L);\nguestUser.setName("guest");\n\nUser rootUser = new User();\nrootUser.setId(3L);\nrootUser.setName("root");\n\ngroup.addUser(guestUser);\ngroup.addUser(rootUser);\n\n\n# åºåå\n\nString jsonString = JSON.toJSONString(group);\nSystem.out.println(jsonString);\n\n\n# ååºåå\n\nGroup bean = JSON.parseObject(jsonString, Group.class);\n\n\n\n# Fastjson æ³¨è§£\n\n# @JSONField\n\n> æ©å±éè¯»ï¼æ´å¤ API ä½¿ç¨ç»èå¯ä»¥åèï¼JSONField ç¨æ³ï¼è¿éä»ç»åºæ¬ç¨æ³ã\n\nå¯ä»¥éç½®å¨å±æ§ï¼setterãgetterï¼åå­æ®µï¼å¿é¡»æ¯ public fieldï¼ä¸ã\n\n@JSONField(name="ID")\npublic int getId() {return id;}\n\n// éç½®dateåºåååååºåä½¿ç¨yyyyMMddæ¥ææ ¼å¼\n@JSONField(format="yyyyMMdd")\npublic Date date1;\n\n// ä¸åºåå\n@JSONField(serialize=false)\npublic Date date2;\n\n// ä¸ååºåå\n@JSONField(deserialize=false)\npublic Date date3;\n\n// æordinalæåº\n@JSONField(ordinal = 2)\nprivate int f1;\n\n@JSONField(ordinal = 1)\nprivate int f2;\n\n\n# @JSONType\n\n * èªå®ä¹åºååï¼ObjectSerializer\n * å­ç±»åå¤çï¼SeeAlso\n\nJSONType.alphabetic å±æ§: fastjson ç¼ºçæ¶ä¼ä½¿ç¨å­æ¯åºåºååï¼å¦æä½ æ¯å¸ææç§ java fields/getters çèªç¶é¡ºåºåºååï¼å¯ä»¥éç½® JSONType.alphabeticï¼ä½¿ç¨æ¹æ³å¦ä¸ï¼\n\n@JSONType(alphabetic = false)\npublic static class B {\n    public int f2;\n    public int f1;\n    public int f0;\n}\n\n\n\n# Jackson åºç¨\n\n> æ©å±éè¯»ï¼æ´å¤ API ä½¿ç¨ç»èå¯ä»¥åè jackson-databind å®æ¹è¯´æ\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupId>com.fasterxml.jackson.core</groupId>\n    <artifactId>jackson-databind</artifactId>\n    <version>2.9.8</version>\n</dependency>\n\n\n\n# Jackson API\n\n# åºåå\n\nObjectMapper mapper = new ObjectMapper();\n\nmapper.writeValue(new File("result.json"), myResultObject);\n// or:\nbyte[] jsonBytes = mapper.writeValueAsBytes(myResultObject);\n// or:\nString jsonString = mapper.writeValueAsString(myResultObject);\n\n\n# ååºåå\n\nObjectMapper mapper = new ObjectMapper();\n\nMyValue value = mapper.readValue(new File("data.json"), MyValue.class);\n// or:\nvalue = mapper.readValue(new URL("http://some.com/api/entry.json"), MyValue.class);\n// or:\nvalue = mapper.readValue("{\\"name\\":\\"Bob\\", \\"age\\":13}", MyValue.class);\n\n\n# å®¹å¨çåºåååååºåå\n\nPerson p = new Person("Tom", 20);\nPerson p2 = new Person("Jack", 22);\nPerson p3 = new Person("Mary", 18);\n\nList<Person> persons = new LinkedList<>();\npersons.add(p);\npersons.add(p2);\npersons.add(p3);\n\nMap<String, List> map = new HashMap<>();\nmap.put("persons", persons);\n\nString json = null;\ntry {\n json = mapper.writeValueAsString(map);\n} catch (JsonProcessingException e) {\n e.printStackTrace();\n}\n\n\n\n# Jackson æ³¨è§£\n\n> æ©å±éè¯»ï¼æ´å¤æ³¨è§£ä½¿ç¨ç»èå¯ä»¥åè jackson-annotations å®æ¹è¯´æ\n\n# @JsonProperty\n\npublic class MyBean {\n   private String _name;\n\n   // without annotation, we\'d get "theName", but we want "name":\n   @JsonProperty("name")\n   public String getTheName() { return _name; }\n\n   // note: it is enough to add annotation on just getter OR setter;\n   // so we can omit it here\n   public void setTheName(String n) { _name = n; }\n}\n\n\n# @JsonIgnoreProperties å @JsonIgnore\n\n// means that if we see "foo" or "bar" in JSON, they will be quietly skipped\n// regardless of whether POJO has such properties\n@JsonIgnoreProperties({ "foo", "bar" })\npublic class MyBean {\n   // will not be written as JSON; nor assigned from JSON:\n   @JsonIgnore\n   public String internal;\n\n   // no annotation, public field is read/written normally\n   public String external;\n\n   @JsonIgnore\n   public void setCode(int c) { _code = c; }\n\n   // note: will also be ignored because setter has annotation!\n   public int getCode() { return _code; }\n}\n\n\n# @JsonCreator\n\npublic class CtorBean {\n  public final String name;\n  public final int age;\n\n  @JsonCreator // constructor can be public, private, whatever\n  private CtorBean(@JsonProperty("name") String name,\n    @JsonProperty("age") int age)\n  {\n      this.name = name;\n      this.age = age;\n  }\n}\n\n\n# @JsonPropertyOrder\n\nalphabetic è®¾ä¸º true è¡¨ç¤ºï¼json å­æ®µæèªç¶é¡ºåºæåï¼é»è®¤ä¸º falseã\n\n@JsonPropertyOrder(alphabetic = true)\npublic class JacksonAnnotationBean {}\n\n\n\n# Gson åºç¨\n\n> è¯¦ç»åå®¹å¯ä»¥åèå®æ¹ææ¡£ï¼Gson ç¨æ·æå\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupId>com.google.code.gson</groupId>\n    <artifactId>gson</artifactId>\n    <version>2.8.6</version>\n</dependency>\n\n\n\n# Gson API\n\n# åºåå\n\nGson gson = new Gson();\ngson.toJson(1);            // ==> 1\ngson.toJson("abcd");       // ==> "abcd"\ngson.toJson(10L); // ==> 10\nint[] values = { 1 };\ngson.toJson(values);       // ==> [1]\n\n\n# ååºåå\n\nint i1 = gson.fromJson("1", int.class);\nInteger i2 = gson.fromJson("1", Integer.class);\nLong l1 = gson.fromJson("1", Long.class);\nBoolean b1 = gson.fromJson("false", Boolean.class);\nString str = gson.fromJson("\\"abc\\"", String.class);\nString[] anotherStr = gson.fromJson("[\\"abc\\"]", String[].class);\n\n\n# GsonBuilder\n\nGson å®ä¾å¯ä»¥éè¿ GsonBuilder æ¥å®å¶å®ä¾åï¼ä»¥æ§å¶å¶åºååãååºååè¡ä¸ºã\n\nGson gson = new GsonBuilder()\n  .setPrettyPrinting()\n  .setDateFormat("yyyy-MM-dd HH:mm:ss")\n  .excludeFieldsWithModifiers(Modifier.STATIC, Modifier.TRANSIENT, Modifier.VOLATILE)\n  .create();\n\n\n\n# Gson æ³¨è§£\n\n# @Since\n\n@Since ç¨äºæ§å¶å¯¹è±¡çåºååçæ¬ãç¤ºä¾ï¼\n\npublic class VersionedClass {\n  @Since(1.1) private final String newerField;\n  @Since(1.0) private final String newField;\n  private final String field;\n\n  public VersionedClass() {\n    this.newerField = "newer";\n    this.newField = "new";\n    this.field = "old";\n  }\n}\n\nVersionedClass versionedObject = new VersionedClass();\nGson gson = new GsonBuilder().setVersion(1.0).create();\nString jsonOutput = gson.toJson(versionedObject);\nSystem.out.println(jsonOutput);\nSystem.out.println();\n\ngson = new Gson();\njsonOutput = gson.toJson(versionedObject);\nSystem.out.println(jsonOutput);\n\n\n# @SerializedName\n\n@SerializedName ç¨äºå°ç±»æåæç§æå®åç§°åºååãååºååãç¤ºä¾ï¼\n\nprivate class SomeObject {\n  @SerializedName("custom_naming") private final String someField;\n  private final String someOtherField;\n\n  public SomeObject(String a, String b) {\n    this.someField = a;\n    this.someOtherField = b;\n  }\n}\n\n\n\n# ç¤ºä¾æºç \n\n> ç¤ºä¾æºç ï¼javalib-io-json\n\n\n# åèèµæ\n\n * å®æ¹\n   * Fastjson Github\n   * Gson Github\n   * jackson å®æ¹ææ¡£\n   * jackson-databind\n * æç« \n   * http://www.json.org/json-zh.html\n   * json ç RFC ææ¡£\n   * JSON æä½³å®è·µ\n   * ãç®ææç¨ãJSON',normalizedContent:'# java å json åºåå\n\n> jsonï¼javascript object notationï¼æ¯ä¸ç§åºäºææ¬çæ°æ®äº¤æ¢æ ¼å¼ãå ä¹ææçç¼ç¨è¯­è¨é½æå¾å¥½çåºæç¬¬ä¸æ¹å·¥å·æ¥æä¾åºäº json ç api æ¯æï¼å æ­¤ä½ å¯ä»¥éå¸¸æ¹ä¾¿å°ä½¿ç¨ä»»ä½èªå·±åæ¬¢çç¼ç¨è¯­è¨æ¥å¤ç json æ°æ®ã\n> \n> æ¬æä¸»è¦ä» java è¯­è¨çè§åº¦æ¥è®²è§£ json çåºç¨ã\n\n\n# json ç®ä»\n\n\n# json æ¯ä»ä¹\n\njson èµ·æºäº 1999 å¹´ç js è¯­è¨è§è ecma262 çä¸ä¸ªå­éï¼å³ 15.12 ç« èæè¿°äºæ ¼å¼ä¸è§£æï¼ï¼åæ¥ 2003 å¹´ä½ä¸ºä¸ä¸ªæ°æ®æ ¼å¼ecma404ï¼å¾å§çåºå·æä¸æï¼ï¼åå¸ã 2006 å¹´ï¼ä½ä¸º rfc4627 åå¸ï¼è¿æ¶è§èå¢å å° 18 é¡µï¼å»ææ²¡ç¨çé¨åï¼åé¡µä¸å°ã\n\njson çåºç¨å¾å¹¿æ³ï¼è¿éæè¶è¿ 100 ç§è¯­è¨ä¸ç json åºï¼json.orgã\n\næ´å¤çå¯ä»¥åèè¿éï¼å³äº json çä¸åã\n\n\n# json æ å\n\nè¿ä¼°è®¡æ¯æç®åæ åè§èä¹ä¸ï¼\n\n * åªæä¸¤ç§ç»æï¼å¯¹è±¡åçé®å¼å¯¹éåç»æåæ°ç»ï¼å¯¹è±¡ç¨ {} è¡¨ç¤ºãåé¨æ¯ "key":"value"ï¼æ°ç»ç¨ [] è¡¨ç¤ºï¼ä¸åå¼ç¨éå·åå¼\n * åºæ¬æ°å¼æ 7 ä¸ªï¼ false / null / true / object / array / number / string\n * åå ä¸ç»æå¯ä»¥åµå¥ï¼è¿èå¯ä»¥ç¨æ¥è¡¨è¾¾å¤æçæ°æ®\n * ä¸ä¸ªç®åå®ä¾ï¼\n\n{\n  "image": {\n    "width": 800,\n    "height": 600,\n    "title": "view from 15th floor",\n    "thumbnail": {\n      "url": "http://www.example.com/image/481989943",\n      "height": 125,\n      "width": "100"\n    },\n    "ids": [116, 943, 234, 38793]\n  }\n}\n\n\n> æ©å±éè¯»ï¼\n> \n>  * http://www.json.org/json-zh.html - å¾æå¹¶èä»ç» json æ°æ®å½¢å¼\n> \n>  * json ç rfc ææ¡£\n\n\n# json ä¼ç¼ºç¹\n\nä¼ç¹ï¼\n\n * åºäºçº¯ææ¬ï¼æä»¥å¯¹äºäººç±»éè¯»æ¯å¾åå¥½çã\n * è§èç®åï¼æä»¥å®¹æå¤çï¼å¼ç®±å³ç¨ï¼ç¹å«æ¯ js ç±»ç ecma èæ¬éæ¯åå»ºæ¯æçï¼å¯ä»¥ç´æ¥ä½ä¸ºå¯¹è±¡ä½¿ç¨ã\n * å¹³å°æ å³æ§ï¼å ä¸ºç±»ååç»æé½æ¯å¹³å°æ å³çï¼èä¸å¥½å¤çï¼å®¹æå®ç°ä¸åè¯­è¨çå¤çç±»åºï¼å¯ä»¥ä½ä¸ºå¤ä¸ªä¸åå¼æç³»ç»ä¹é´çæ°æ®ä¼ è¾æ ¼å¼åè®®ï¼ç¹å«æ¯å¨ http/rest ä¸çæ°æ®æ ¼å¼ã\n\nç¼ºç¹ï¼\n\n * æ§è½ä¸è¬ï¼ææ¬è¡¨ç¤ºçæ°æ®ä¸è¬æ¥è¯´æ¯äºè¿å¶å¤§å¾å¤ï¼å¨æ°æ®ä¼ è¾ä¸åè§£æå¤çä¸é½è¦æ´å½±åæ§è½ã\n * ç¼ºä¹ schemaï¼è·åæ¯ææ¬æ°æ®æ ¼å¼ç xml æ¯ï¼å¨ç±»åçä¸¥æ ¼æ§åä¸°å¯æ§ä¸è¦å·®å¾å¤ãxml å¯ä»¥åç± xsd æ dtd æ¥å®ä¹å¤æçæ ¼å¼ï¼å¹¶ç±æ­¤æ¥éªè¯ xml ææ¡£æ¯å¦ç¬¦åæ ¼å¼è¦æ±ï¼çè³è¿ä¸æ­¥çï¼å¯ä»¥åºäº xsd æ¥çæå·ä½è¯­è¨çæä½ä»£ç ï¼ä¾å¦ apache xmlbeansãå¹¶ä¸è¿äºå·¥å·ç»åå°ä¸èµ·ï¼å½¢æä¸å¥åºå¤§ççæï¼ä¾å¦åºäº xml å¯ä»¥å®ç° soap å wsdlï¼ä¸ç³»åç ws-*è§èãä½æ¯æä»¬ä¹å¯ä»¥çå° json å¨ç¼ºä¹è§èçæåµä¸ï¼å®éä¸ææ´å¤§ä¸äºççµæ´»æ§ï¼ç¹å«æ¯è¿å¹´æ¥ rest çå¿«éåå±ï¼å·²ç»æä¸äº schema ç¸å³çåå±(ä¾å¦çè§£ json schemaï¼ä½¿ç¨ json schemaï¼ å¨çº¿ schema æµè¯)ï¼ä¹æç±»ä¼¼äº wsdl çwadlåºç°ã\n\n\n# json å·¥å·\n\n * ä½¿ç¨ json å®ç° rpcï¼ç±»ä¼¼ xml-rpcï¼ï¼json-rpc\n\n * ä½¿ç¨ json å®ç° path æ¥è¯¢æä½ï¼ç±»ä¼¼ xml-pathï¼ï¼jsonpath\n\n * å¨çº¿æ¥è¯¢å·¥å·ï¼jsonpath\n\n * æ ¼å¼åå·¥å·ï¼jsbeautifier\n\n * chrome æä»¶ï¼5 ä¸ª json view æä»¶\n\n * å¨çº¿ mock: å¨çº¿ mock\n\n * å¶ä» mockï¼soapuiå¯ä»¥æ¯æï¼swaggerui ä¹å¯ä»¥ï¼restmockä¹å¯ä»¥ã\n\n\n# java json åº\n\njava ä¸­æ¯è¾æµè¡ç json åºæï¼\n\n * fastjson - é¿éå·´å·´å¼åç json åºï¼æ§è½ååä¼ç§ã\n * jackson - ç¤¾åºååæ´»è·ä¸æ´æ°éåº¦å¾å¿«ãspring æ¡æ¶é»è®¤ json åºã\n * gson - è°·æ­å¼åç json åºï¼ç®ååè½æå¨ç json åº ã\n\nä»æ§è½ä¸æ¥çï¼ä¸è¬æåµä¸ï¼fastjson > jackson > gson\n\n\n# json ç¼ç æå\n\n> éµå¾ªå¥½çè®¾è®¡ä¸ç¼ç é£æ ¼ï¼è½æåè§£å³ 80%çé®é¢ï¼ä¸ªäººæ¨è google json é£æ ¼æåã\n> \n>  * è±æçgoogle json style guideï¼https://google.github.io/styleguide/jsoncstyleguide.xml\n>  * ä¸­æçgoogle json é£æ ¼æåï¼https://github.com/darcyliu/google-styleguide/blob/master/jsonstyleguide.md\n\nç®åæå½å¦ä¸ï¼\n\n * å±æ§ååå¼é½æ¯ç¨åå¼å·ï¼ä¸è¦ææ³¨éåå°å¯¹è±¡éé¢ï¼å¯¹è±¡æ°æ®è¦ç®æ´\n * ä¸è¦éæç»æååç»å¯¹è±¡ï¼æ¨èæ¯ç¨æå¹³åæ¹å¼ï¼å±æ¬¡ä¸è¦å¤ªå¤æ\n * å½åæ¹å¼è¦ææä¹ï¼æ¯å¦åå¤æ°è¡¨ç¤º\n * é©¼å³°å¼å½åï¼éµå¾ª bean è§è\n * ä½¿ç¨çæ¬æ¥æ§å¶åæ´å²çª\n * å¯¹äºä¸äºå³é®å­ï¼ä¸è¦æ¿æ¥å key\n * å¦æä¸ä¸ªå±æ§æ¯å¯éçæèåå«ç©ºå¼æ null å¼ï¼èèä» json ä¸­å»æè¯¥å±æ§ï¼é¤éå®çå­å¨æå¾å¼ºçè¯­ä¹åå \n * åºååæä¸¾ç±»åæ¶ï¼ä½¿ç¨ name èä¸æ¯ value\n * æ¥æè¦ç¨æ åæ ¼å¼å¤ç\n * è®¾è®¡å¥½éç¨çåé¡µåæ°\n * è®¾è®¡å¥½å¼å¸¸å¤ç\n\njson apiä¸ google json é£æ ¼æåæå¾å¤å¯ä»¥ç¸äºåç§ä¹å¤ã\n\njson apiæ¯æ°æ®äº¤äºè§èï¼ç¨ä»¥å®ä¹å®¢æ·ç«¯å¦ä½è·åä¸ä¿®æ¹èµæºï¼ä»¥åæå¡å¨å¦ä½ååºå¯¹åºè¯·æ±ã\n\njson api è®¾è®¡ç¨æ¥æå°åè¯·æ±çæ°éï¼ä»¥åå®¢æ·ç«¯ä¸æå¡å¨é´ä¼ è¾çæ°æ®éãå¨é«æå®ç°çåæ¶ï¼æ éçºç²å¯è¯»æ§ãçµæ´»æ§åå¯åç°æ§ã\n\n\n# fastjson åºç¨\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupid>com.alibaba</groupid>\n    <artifactid>fastjson</artifactid>\n    <version>x.x.x</version>\n</dependency>\n\n\n\n# fastjson api\n\n# å®ä¹ bean\n\ngroup.java\n\npublic class group {\n\n    private long       id;\n    private string     name;\n    private list<user> users = new arraylist<user>();\n}\n\n\nuser.java\n\npublic class user {\n\n    private long   id;\n    private string name;\n}\n\n\nåå§å bean\n\ngroup group = new group();\ngroup.setid(0l);\ngroup.setname("admin");\n\nuser guestuser = new user();\nguestuser.setid(2l);\nguestuser.setname("guest");\n\nuser rootuser = new user();\nrootuser.setid(3l);\nrootuser.setname("root");\n\ngroup.adduser(guestuser);\ngroup.adduser(rootuser);\n\n\n# åºåå\n\nstring jsonstring = json.tojsonstring(group);\nsystem.out.println(jsonstring);\n\n\n# ååºåå\n\ngroup bean = json.parseobject(jsonstring, group.class);\n\n\n\n# fastjson æ³¨è§£\n\n# @jsonfield\n\n> æ©å±éè¯»ï¼æ´å¤ api ä½¿ç¨ç»èå¯ä»¥åèï¼jsonfield ç¨æ³ï¼è¿éä»ç»åºæ¬ç¨æ³ã\n\nå¯ä»¥éç½®å¨å±æ§ï¼setterãgetterï¼åå­æ®µï¼å¿é¡»æ¯ public fieldï¼ä¸ã\n\n@jsonfield(name="id")\npublic int getid() {return id;}\n\n// éç½®dateåºåååååºåä½¿ç¨yyyymmddæ¥ææ ¼å¼\n@jsonfield(format="yyyymmdd")\npublic date date1;\n\n// ä¸åºåå\n@jsonfield(serialize=false)\npublic date date2;\n\n// ä¸ååºåå\n@jsonfield(deserialize=false)\npublic date date3;\n\n// æordinalæåº\n@jsonfield(ordinal = 2)\nprivate int f1;\n\n@jsonfield(ordinal = 1)\nprivate int f2;\n\n\n# @jsontype\n\n * èªå®ä¹åºååï¼objectserializer\n * å­ç±»åå¤çï¼seealso\n\njsontype.alphabetic å±æ§: fastjson ç¼ºçæ¶ä¼ä½¿ç¨å­æ¯åºåºååï¼å¦æä½ æ¯å¸ææç§ java fields/getters çèªç¶é¡ºåºåºååï¼å¯ä»¥éç½® jsontype.alphabeticï¼ä½¿ç¨æ¹æ³å¦ä¸ï¼\n\n@jsontype(alphabetic = false)\npublic static class b {\n    public int f2;\n    public int f1;\n    public int f0;\n}\n\n\n\n# jackson åºç¨\n\n> æ©å±éè¯»ï¼æ´å¤ api ä½¿ç¨ç»èå¯ä»¥åè jackson-databind å®æ¹è¯´æ\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupid>com.fasterxml.jackson.core</groupid>\n    <artifactid>jackson-databind</artifactid>\n    <version>2.9.8</version>\n</dependency>\n\n\n\n# jackson api\n\n# åºåå\n\nobjectmapper mapper = new objectmapper();\n\nmapper.writevalue(new file("result.json"), myresultobject);\n// or:\nbyte[] jsonbytes = mapper.writevalueasbytes(myresultobject);\n// or:\nstring jsonstring = mapper.writevalueasstring(myresultobject);\n\n\n# ååºåå\n\nobjectmapper mapper = new objectmapper();\n\nmyvalue value = mapper.readvalue(new file("data.json"), myvalue.class);\n// or:\nvalue = mapper.readvalue(new url("http://some.com/api/entry.json"), myvalue.class);\n// or:\nvalue = mapper.readvalue("{\\"name\\":\\"bob\\", \\"age\\":13}", myvalue.class);\n\n\n# å®¹å¨çåºåååååºåå\n\nperson p = new person("tom", 20);\nperson p2 = new person("jack", 22);\nperson p3 = new person("mary", 18);\n\nlist<person> persons = new linkedlist<>();\npersons.add(p);\npersons.add(p2);\npersons.add(p3);\n\nmap<string, list> map = new hashmap<>();\nmap.put("persons", persons);\n\nstring json = null;\ntry {\n json = mapper.writevalueasstring(map);\n} catch (jsonprocessingexception e) {\n e.printstacktrace();\n}\n\n\n\n# jackson æ³¨è§£\n\n> æ©å±éè¯»ï¼æ´å¤æ³¨è§£ä½¿ç¨ç»èå¯ä»¥åè jackson-annotations å®æ¹è¯´æ\n\n# @jsonproperty\n\npublic class mybean {\n   private string _name;\n\n   // without annotation, we\'d get "thename", but we want "name":\n   @jsonproperty("name")\n   public string getthename() { return _name; }\n\n   // note: it is enough to add annotation on just getter or setter;\n   // so we can omit it here\n   public void setthename(string n) { _name = n; }\n}\n\n\n# @jsonignoreproperties å @jsonignore\n\n// means that if we see "foo" or "bar" in json, they will be quietly skipped\n// regardless of whether pojo has such properties\n@jsonignoreproperties({ "foo", "bar" })\npublic class mybean {\n   // will not be written as json; nor assigned from json:\n   @jsonignore\n   public string internal;\n\n   // no annotation, public field is read/written normally\n   public string external;\n\n   @jsonignore\n   public void setcode(int c) { _code = c; }\n\n   // note: will also be ignored because setter has annotation!\n   public int getcode() { return _code; }\n}\n\n\n# @jsoncreator\n\npublic class ctorbean {\n  public final string name;\n  public final int age;\n\n  @jsoncreator // constructor can be public, private, whatever\n  private ctorbean(@jsonproperty("name") string name,\n    @jsonproperty("age") int age)\n  {\n      this.name = name;\n      this.age = age;\n  }\n}\n\n\n# @jsonpropertyorder\n\nalphabetic è®¾ä¸º true è¡¨ç¤ºï¼json å­æ®µæèªç¶é¡ºåºæåï¼é»è®¤ä¸º falseã\n\n@jsonpropertyorder(alphabetic = true)\npublic class jacksonannotationbean {}\n\n\n\n# gson åºç¨\n\n> è¯¦ç»åå®¹å¯ä»¥åèå®æ¹ææ¡£ï¼gson ç¨æ·æå\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupid>com.google.code.gson</groupid>\n    <artifactid>gson</artifactid>\n    <version>2.8.6</version>\n</dependency>\n\n\n\n# gson api\n\n# åºåå\n\ngson gson = new gson();\ngson.tojson(1);            // ==> 1\ngson.tojson("abcd");       // ==> "abcd"\ngson.tojson(10l); // ==> 10\nint[] values = { 1 };\ngson.tojson(values);       // ==> [1]\n\n\n# ååºåå\n\nint i1 = gson.fromjson("1", int.class);\ninteger i2 = gson.fromjson("1", integer.class);\nlong l1 = gson.fromjson("1", long.class);\nboolean b1 = gson.fromjson("false", boolean.class);\nstring str = gson.fromjson("\\"abc\\"", string.class);\nstring[] anotherstr = gson.fromjson("[\\"abc\\"]", string[].class);\n\n\n# gsonbuilder\n\ngson å®ä¾å¯ä»¥éè¿ gsonbuilder æ¥å®å¶å®ä¾åï¼ä»¥æ§å¶å¶åºååãååºååè¡ä¸ºã\n\ngson gson = new gsonbuilder()\n  .setprettyprinting()\n  .setdateformat("yyyy-mm-dd hh:mm:ss")\n  .excludefieldswithmodifiers(modifier.static, modifier.transient, modifier.volatile)\n  .create();\n\n\n\n# gson æ³¨è§£\n\n# @since\n\n@since ç¨äºæ§å¶å¯¹è±¡çåºååçæ¬ãç¤ºä¾ï¼\n\npublic class versionedclass {\n  @since(1.1) private final string newerfield;\n  @since(1.0) private final string newfield;\n  private final string field;\n\n  public versionedclass() {\n    this.newerfield = "newer";\n    this.newfield = "new";\n    this.field = "old";\n  }\n}\n\nversionedclass versionedobject = new versionedclass();\ngson gson = new gsonbuilder().setversion(1.0).create();\nstring jsonoutput = gson.tojson(versionedobject);\nsystem.out.println(jsonoutput);\nsystem.out.println();\n\ngson = new gson();\njsonoutput = gson.tojson(versionedobject);\nsystem.out.println(jsonoutput);\n\n\n# @serializedname\n\n@serializedname ç¨äºå°ç±»æåæç§æå®åç§°åºååãååºååãç¤ºä¾ï¼\n\nprivate class someobject {\n  @serializedname("custom_naming") private final string somefield;\n  private final string someotherfield;\n\n  public someobject(string a, string b) {\n    this.somefield = a;\n    this.someotherfield = b;\n  }\n}\n\n\n\n# ç¤ºä¾æºç \n\n> ç¤ºä¾æºç ï¼javalib-io-json\n\n\n# åèèµæ\n\n * å®æ¹\n   * fastjson github\n   * gson github\n   * jackson å®æ¹ææ¡£\n   * jackson-databind\n * æç« \n   * http://www.json.org/json-zh.html\n   * json ç rfc ææ¡£\n   * json æä½³å®è·µ\n   * ãç®ææç¨ãjson',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java äºè¿å¶åºåå",frontmatter:{title:"Java äºè¿å¶åºåå",categories:["ç¼ç¨","Java","å·¥å·","IO"],tags:["Java","IO","åºåå","äºè¿å¶"],abbrlink:"7684267f",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/95f25b/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/01.IO/02.%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%BA%8F%E5%88%97%E5%8C%96.html",relativePath:"12.å·¥å·/01.IO/02.äºè¿å¶åºåå.md",key:"v-d23f2b76",path:"/pages/95f25b/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:18},{level:3,title:"ä¸ºä»ä¹éè¦äºè¿å¶åºåååº",slug:"ä¸ºä»ä¹éè¦äºè¿å¶åºåååº",normalizedTitle:"ä¸ºä»ä¹éè¦äºè¿å¶åºåååº",charIndex:25},{level:3,title:"ä¸»æµåºåååºç®ä»",slug:"ä¸»æµåºåååºç®ä»",normalizedTitle:"ä¸»æµåºåååºç®ä»",charIndex:379},{level:4,title:"Protobuf",slug:"protobuf",normalizedTitle:"protobuf",charIndex:391},{level:4,title:"Thrift",slug:"thrift",normalizedTitle:"thrift",charIndex:526},{level:4,title:"Hessian",slug:"hessian",normalizedTitle:"hessian",charIndex:761},{level:4,title:"Kryo",slug:"kryo",normalizedTitle:"kryo",charIndex:907},{level:4,title:"FST",slug:"fst",normalizedTitle:"fst",charIndex:1047},{level:4,title:"å°ç»",slug:"å°ç»",normalizedTitle:"å°ç»",charIndex:1205},{level:2,title:"FST åºç¨",slug:"fst-åºç¨",normalizedTitle:"fst åºç¨",charIndex:1583},{level:3,title:"å¼å¥ä¾èµ",slug:"å¼å¥ä¾èµ",normalizedTitle:"å¼å¥ä¾èµ",charIndex:1594},{level:3,title:"FST API",slug:"fst-api",normalizedTitle:"fst api",charIndex:1726},{level:2,title:"Kryo åºç¨",slug:"kryo-åºç¨",normalizedTitle:"kryo åºç¨",charIndex:3615},{level:3,title:"å¼å¥ä¾èµ",slug:"å¼å¥ä¾èµ-2",normalizedTitle:"å¼å¥ä¾èµ",charIndex:1594},{level:3,title:"Kryo API",slug:"kryo-api",normalizedTitle:"kryo api",charIndex:3770},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:6866}],headersStr:"ç®ä» ä¸ºä»ä¹éè¦äºè¿å¶åºåååº ä¸»æµåºåååºç®ä» Protobuf Thrift Hessian Kryo FST å°ç» FST åºç¨ å¼å¥ä¾èµ FST API Kryo åºç¨ å¼å¥ä¾èµ Kryo API åèèµæ",content:'# Java äºè¿å¶åºåå\n\n\n# ç®ä»\n\n\n# ä¸ºä»ä¹éè¦äºè¿å¶åºåååº\n\nåå å¾ç®åï¼å°±æ¯ Java é»è®¤çåºååæºå¶ï¼ObjectInputStream å ObjectOutputStreamï¼å·æå¾å¤ç¼ºç¹ã\n\n> ä¸äºè§£ Java é»è®¤çåºååæºå¶ï¼å¯ä»¥åèï¼Java åºåå\n\nJava èªèº«çåºååæ¹å¼å·æä»¥ä¸ç¼ºç¹ï¼\n\n * æ æ³è·¨è¯­è¨ä½¿ç¨ãè¿ç¹æä¸ºè´å½ï¼å¯¹äºå¾å¤éè¦è·¨è¯­è¨éä¿¡çå¼æç³»ç»æ¥è¯´ï¼ä¸è½è·¨è¯­è¨åºååï¼å³æå³çå®å¨æ æ³éä¿¡ï¼å½¼æ­¤æ°æ®ä¸è½è¯å«ï¼å½ç¶æ æ³äº¤äºäºï¼ã\n * åºååçæ§è½ä¸é«ãåºåååçæ°æ®ä½ç§¯è¾å¤§ï¼è¿å¤§å¤§å½±åå­å¨åä¼ è¾çæçã\n * åºååä¸å®éè¦å®ç° Serializable æ¥å£ã\n * éè¦å³æ³¨ serialVersionUIDã\n\nå¼å¥äºè¿å¶åºåååºå°±æ¯ä¸ºäºè§£å³è¿äºé®é¢ï¼è¿å¨ RPC åºç¨ä¸­å°¤ä¸ºå¸¸è§ã\n\n\n# ä¸»æµåºåååºç®ä»\n\n# Protobuf\n\nProtobuf æ¯ Google å¼åçç»æåºåååºã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * ç»æåæ°æ®å­å¨æ ¼å¼ï¼xml,json ç­ï¼\n * é«æ§è½ç¼è§£ç ææ¯\n * è¯­è¨åå¹³å°æ å³ï¼æ©å±æ§å¥½\n * æ¯æ Java, C++, Python ä¸ç§è¯­è¨\n\n# Thrift\n\n> Thrift æ¯ apache å¼æºé¡¹ç®ï¼æ¯ä¸ä¸ªç¹å¯¹ç¹ç RPC å®ç°ã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * æ¯æå¤ç§è¯­è¨ï¼ç®åæ¯æ 28 ç§è¯­è¨ï¼å¦ï¼C++ãgoãJavaãPhpãPythonãRuby ç­ç­ï¼ã\n * ä½¿ç¨äºç»å»ºå¤§åæ°æ®äº¤æ¢åå­å¨å·¥å·ï¼å¯¹äºå¤§åç³»ç»ä¸­çåé¨æ°æ®ä¼ è¾ï¼ç¸å¯¹äº Json å xml å¨æ§è½ä¸åä¼ è¾å¤§å°ä¸é½æææ¾çä¼å¿ã\n * æ¯æä¸ç§æ¯è¾å¸åçç¼ç æ¹å¼ï¼éç¨äºè¿å¶ç¼ç ï¼åç¼©äºè¿å¶ç¼ç ï¼ä¼åçå¯éå­æ®µåç¼©ç¼è§£ç ï¼ã\n\n# Hessian\n\n> Hessian æ¯ä¸ç§äºè¿å¶ä¼ è¾åè®®ã\n> \n> RPC æ¡æ¶ Dubbo å°±æ¯æ Thrift å Hessionã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * æ¯æå¤ç§è¯­è¨ãå¦ï¼JavaãPythonãC++ãC#ãPHPãRuby ç­ã\n * ç¸å¯¹å¶ä»äºè¿å¶åºåååºè¾æ¢ã\n\n# Kryo\n\n> Kryo æ¯ç¨äº Java çå¿«éé«æçäºè¿å¶å¯¹è±¡å¾åºååæ¡æ¶ãKryo è¿å¯ä»¥æ§è¡èªå¨çæ·±æ·è´åæµæ·è´ã è¿æ¯ä»å¯¹è±¡å°å¯¹è±¡çç´æ¥å¤å¶ï¼èä¸æ¯ä»å¯¹è±¡å°å­èçå¤å¶ã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * éåº¦å¿«ï¼åºååä½ç§¯å°\n * å®æ¹ä¸æ¯æ Java ä»¥å¤çå¶ä»è¯­è¨\n\n# FST\n\n> FST æ¯ä¸ä¸ª Java å®ç°äºè¿å¶åºåååºã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * è¿ä¹äº 100% å¼å®¹ JDK åºååï¼ä¸æ¯ JDK ååºååæ¹å¼å¿« 10 å\n * 2.17 å¼å§ä¸ Android å¼å®¹\n * ï¼å¯éï¼2.29 å¼å§æ¯æå°ä»»ä½å¯åºååçå¯¹è±¡å¾ç¼ç /è§£ç ä¸º JSONï¼åæ¬å±äº«å¼ç¨ï¼\n\n# å°ç»\n\näºè§£äºä»¥ä¸è¿äºå¸¸è§çäºè¿å¶åºåååºçç¹æ§ãå¨ææ¯éåæ¶ï¼æä»¬å°±å¯ä»¥åå°æçæ¾ç¢ã\n\nï¼1ï¼éååèä¾æ®\n\nå¯¹äºäºè¿å¶åºåååºï¼æä»¬çéåèéä¸è¬æä»¥ä¸å ç¹ï¼\n\n * æ¯å¦æ¯æè·¨è¯­è¨\n   * æ ¹æ®ä¸å¡å®ééæ±æ¥å³å®ãä¸è¬æ¥è¯´ï¼æ¯æè·¨è¯­è¨ï¼ä¸ºäºå¼å®¹ï¼ä½¿ç¨å¤æåº¦ä¸ä¸è¬ä¼æ´é«ä¸äºã\n * åºååãååºååçæ§è½\n * ç±»åºæ¯å¦è½»éåï¼API æ¯å¦ç®åææ\n\nï¼2ï¼éåå»ºè®®\n\n * å¦æéè¦è·¨è¯­è¨éä¿¡ï¼é£ä¹å¯ä»¥èèï¼ProtobufãThriftãHessionã\n   \n   * thriftãprotobuf - éç¨äºå¯¹æ§è½ææï¼å¯¹å¼åä½éªè¦æ±ä¸é«çåé¨ç³»ç»ã\n   * hessian - éç¨äºå¯¹å¼åä½éªææï¼æ§è½æè¦æ±çåå¤é¨ç³»ç»ã\n\n * å¦æä¸éè¦è·¨è¯­è¨éä¿¡ï¼å¯ä»¥èèï¼Kryo å FSTï¼æ§è½ä¸éï¼ä¸ API ååç®åã\n\n\n# FST åºç¨\n\n\n# å¼å¥ä¾èµ\n\n<dependency>\n <groupId>de.ruedigermoeller</groupId>\n <artifactId>fst</artifactId>\n <version>2.56</version>\n</dependency>\n\n\n\n# FST API\n\nç¤ºä¾ï¼\n\nimport org.nustaq.serialization.FSTConfiguration;\n\nimport java.io.IOException;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Base64;\n\npublic class FstDemo {\n\n private static FSTConfiguration DEFAULT_CONFIG = FSTConfiguration.createDefaultConfiguration();\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»\n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <T> å¯¹è±¡çç±»å\n  * @return åºåååç byte æ°ç»\n  */\n public static <T> byte[] writeToBytes(T obj) {\n  return DEFAULT_CONFIG.asByteArray(obj);\n }\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»åï¼åä½¿ç¨ Base64 ç¼ç \n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <T> å¯¹è±¡çç±»å\n  * @return åºåååçå­ç¬¦ä¸²\n  */\n public static <T> String writeToString(T obj) {\n  byte[] bytes = writeToBytes(obj);\n  return new String(Base64.getEncoder().encode(bytes), StandardCharsets.UTF_8);\n }\n\n /**\n  * å° byte æ°ç»ååºååä¸ºåå¯¹è±¡\n  *\n  * @param bytes {@link #writeToBytes} æ¹æ³åºåååç byte æ°ç»\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <T>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n public static <T> T readFromBytes(byte[] bytes, Class<T> clazz) throws IOException {\n  Object obj = DEFAULT_CONFIG.asObject(bytes);\n  if (clazz.isInstance(obj)) {\n   return (T) obj;\n  } else {\n   throw new IOException("derialize failed");\n  }\n }\n\n /**\n  * å°å­ç¬¦ä¸²ååºååä¸ºåå¯¹è±¡ï¼åä½¿ç¨ Base64 è§£ç \n  *\n  * @param str   {@link #writeToString} æ¹æ³åºåååçå­ç¬¦ä¸²\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <T>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n public static <T> T readFromString(String str, Class<T> clazz) throws IOException {\n  byte[] bytes = str.getBytes(StandardCharsets.UTF_8);\n  return readFromBytes(Base64.getDecoder().decode(bytes), clazz);\n }\n\n}\n\n\næµè¯ï¼\n\nlong begin = System.currentTimeMillis();\nfor (int i = 0; i < BATCH_SIZE; i++) {\n    TestBean oldBean = BeanUtils.initJdk8Bean();\n    byte[] bytes = FstDemo.writeToBytes(oldBean);\n    TestBean newBean = FstDemo.readFromBytes(bytes, TestBean.class);\n}\nlong end = System.currentTimeMillis();\nSystem.out.printf("FST åºåå/ååºååèæ¶ï¼%s", (end - begin));\n\n\n\n# Kryo åºç¨\n\n\n# å¼å¥ä¾èµ\n\n<dependency>\n  <groupId>com.esotericsoftware</groupId>\n  <artifactId>kryo</artifactId>\n  <version>5.0.0-RC4</version>\n</dependency>\n\n\n\n# Kryo API\n\nç¤ºä¾ï¼\n\nimport com.esotericsoftware.kryo.Kryo;\nimport com.esotericsoftware.kryo.io.Input;\nimport com.esotericsoftware.kryo.io.Output;\nimport com.esotericsoftware.kryo.util.DefaultInstantiatorStrategy;\nimport org.objenesis.strategy.StdInstantiatorStrategy;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.ByteArrayOutputStream;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Base64;\n\npublic class KryoDemo {\n\n // æ¯ä¸ªçº¿ç¨ç Kryo å®ä¾\n private static final ThreadLocal<Kryo> kryoLocal = ThreadLocal.withInitial(() -> {\n  Kryo kryo = new Kryo();\n\n  /**\n   * ä¸è¦è½»ææ¹åè¿éçéç½®ï¼æ´æ¹ä¹åï¼åºååçæ ¼å¼å°±ä¼åçååï¼\n   * ä¸çº¿çåæ¶å°±å¿é¡»æ¸é¤ Redis éçææç¼å­ï¼\n   * å¦åé£äºç¼å­ååæ¥ååºååçæ¶åï¼å°±ä¼æ¥é\n   */\n  //æ¯æå¯¹è±¡å¾ªç¯å¼ç¨ï¼å¦åä¼æ æº¢åºï¼\n  kryo.setReferences(true); //é»è®¤å¼å°±æ¯ trueï¼æ·»å æ­¤è¡çç®çæ¯ä¸ºäºæéç»´æ¤èï¼ä¸è¦æ¹åè¿ä¸ªéç½®\n\n  //ä¸å¼ºå¶è¦æ±æ³¨åç±»ï¼æ³¨åè¡ä¸ºæ æ³ä¿è¯å¤ä¸ª JVM ååä¸ä¸ªç±»çæ³¨åç¼å·ç¸åï¼èä¸ä¸å¡ç³»ç»ä¸­å¤§éç Class ä¹é¾ä»¥ä¸ä¸æ³¨åï¼\n  kryo.setRegistrationRequired(false); //é»è®¤å¼å°±æ¯ falseï¼æ·»å æ­¤è¡çç®çæ¯ä¸ºäºæéç»´æ¤èï¼ä¸è¦æ¹åè¿ä¸ªéç½®\n\n  //Fix the NPE bug when deserializing Collections.\n  ((DefaultInstantiatorStrategy) kryo.getInstantiatorStrategy())\n   .setFallbackInstantiatorStrategy(new StdInstantiatorStrategy());\n\n  return kryo;\n });\n\n /**\n  * è·å¾å½åçº¿ç¨ç Kryo å®ä¾\n  *\n  * @return å½åçº¿ç¨ç Kryo å®ä¾\n  */\n public static Kryo getInstance() {\n  return kryoLocal.get();\n }\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»\n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <T> å¯¹è±¡çç±»å\n  * @return åºåååç byte æ°ç»\n  */\n public static <T> byte[] writeToBytes(T obj) {\n  ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\n  Output output = new Output(byteArrayOutputStream);\n\n  Kryo kryo = getInstance();\n  kryo.writeObject(output, obj);\n  output.flush();\n\n  return byteArrayOutputStream.toByteArray();\n }\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»åï¼åä½¿ç¨ Base64 ç¼ç \n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <T> å¯¹è±¡çç±»å\n  * @return åºåååçå­ç¬¦ä¸²\n  */\n public static <T> String writeToString(T obj) {\n  byte[] bytes = writeToBytes(obj);\n  return new String(Base64.getEncoder().encode(bytes), StandardCharsets.UTF_8);\n }\n\n /**\n  * å° byte æ°ç»ååºååä¸ºåå¯¹è±¡\n  *\n  * @param bytes {@link #writeToBytes} æ¹æ³åºåååç byte æ°ç»\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <T>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n @SuppressWarnings("unchecked")\n public static <T> T readFromBytes(byte[] bytes, Class<T> clazz) {\n  ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes);\n  Input input = new Input(byteArrayInputStream);\n\n  Kryo kryo = getInstance();\n  return (T) kryo.readObject(input, clazz);\n }\n\n /**\n  * å°å­ç¬¦ä¸²ååºååä¸ºåå¯¹è±¡ï¼åä½¿ç¨ Base64 è§£ç \n  *\n  * @param str   {@link #writeToString} æ¹æ³åºåååçå­ç¬¦ä¸²\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <T>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n public static <T> T readFromString(String str, Class<T> clazz) {\n  byte[] bytes = str.getBytes(StandardCharsets.UTF_8);\n  return readFromBytes(Base64.getDecoder().decode(bytes), clazz);\n }\n\n}\n\n\næµè¯ï¼\n\nlong begin = System.currentTimeMillis();\nfor (int i = 0; i < BATCH_SIZE; i++) {\n    TestBean oldBean = BeanUtils.initJdk8Bean();\n    byte[] bytes = KryoDemo.writeToBytes(oldBean);\n    TestBean newBean = KryoDemo.readFromBytes(bytes, TestBean.class);\n}\nlong end = System.currentTimeMillis();\nSystem.out.printf("Kryo åºåå/ååºååèæ¶ï¼%s", (end - begin));\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * Protobuf å®ç½\n   * Protobuf Github\n   * Thrift Github\n   * Kryo Github\n   * Hessian å®ç½\n   * FST Github\n * æç« \n   * java åºååæ¡æ¶å¯¹æ¯',normalizedContent:'# java äºè¿å¶åºåå\n\n\n# ç®ä»\n\n\n# ä¸ºä»ä¹éè¦äºè¿å¶åºåååº\n\nåå å¾ç®åï¼å°±æ¯ java é»è®¤çåºååæºå¶ï¼objectinputstream å objectoutputstreamï¼å·æå¾å¤ç¼ºç¹ã\n\n> ä¸äºè§£ java é»è®¤çåºååæºå¶ï¼å¯ä»¥åèï¼java åºåå\n\njava èªèº«çåºååæ¹å¼å·æä»¥ä¸ç¼ºç¹ï¼\n\n * æ æ³è·¨è¯­è¨ä½¿ç¨ãè¿ç¹æä¸ºè´å½ï¼å¯¹äºå¾å¤éè¦è·¨è¯­è¨éä¿¡çå¼æç³»ç»æ¥è¯´ï¼ä¸è½è·¨è¯­è¨åºååï¼å³æå³çå®å¨æ æ³éä¿¡ï¼å½¼æ­¤æ°æ®ä¸è½è¯å«ï¼å½ç¶æ æ³äº¤äºäºï¼ã\n * åºååçæ§è½ä¸é«ãåºåååçæ°æ®ä½ç§¯è¾å¤§ï¼è¿å¤§å¤§å½±åå­å¨åä¼ è¾çæçã\n * åºååä¸å®éè¦å®ç° serializable æ¥å£ã\n * éè¦å³æ³¨ serialversionuidã\n\nå¼å¥äºè¿å¶åºåååºå°±æ¯ä¸ºäºè§£å³è¿äºé®é¢ï¼è¿å¨ rpc åºç¨ä¸­å°¤ä¸ºå¸¸è§ã\n\n\n# ä¸»æµåºåååºç®ä»\n\n# protobuf\n\nprotobuf æ¯ google å¼åçç»æåºåååºã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * ç»æåæ°æ®å­å¨æ ¼å¼ï¼xml,json ç­ï¼\n * é«æ§è½ç¼è§£ç ææ¯\n * è¯­è¨åå¹³å°æ å³ï¼æ©å±æ§å¥½\n * æ¯æ java, c++, python ä¸ç§è¯­è¨\n\n# thrift\n\n> thrift æ¯ apache å¼æºé¡¹ç®ï¼æ¯ä¸ä¸ªç¹å¯¹ç¹ç rpc å®ç°ã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * æ¯æå¤ç§è¯­è¨ï¼ç®åæ¯æ 28 ç§è¯­è¨ï¼å¦ï¼c++ãgoãjavaãphpãpythonãruby ç­ç­ï¼ã\n * ä½¿ç¨äºç»å»ºå¤§åæ°æ®äº¤æ¢åå­å¨å·¥å·ï¼å¯¹äºå¤§åç³»ç»ä¸­çåé¨æ°æ®ä¼ è¾ï¼ç¸å¯¹äº json å xml å¨æ§è½ä¸åä¼ è¾å¤§å°ä¸é½æææ¾çä¼å¿ã\n * æ¯æä¸ç§æ¯è¾å¸åçç¼ç æ¹å¼ï¼éç¨äºè¿å¶ç¼ç ï¼åç¼©äºè¿å¶ç¼ç ï¼ä¼åçå¯éå­æ®µåç¼©ç¼è§£ç ï¼ã\n\n# hessian\n\n> hessian æ¯ä¸ç§äºè¿å¶ä¼ è¾åè®®ã\n> \n> rpc æ¡æ¶ dubbo å°±æ¯æ thrift å hessionã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * æ¯æå¤ç§è¯­è¨ãå¦ï¼javaãpythonãc++ãc#ãphpãruby ç­ã\n * ç¸å¯¹å¶ä»äºè¿å¶åºåååºè¾æ¢ã\n\n# kryo\n\n> kryo æ¯ç¨äº java çå¿«éé«æçäºè¿å¶å¯¹è±¡å¾åºååæ¡æ¶ãkryo è¿å¯ä»¥æ§è¡èªå¨çæ·±æ·è´åæµæ·è´ã è¿æ¯ä»å¯¹è±¡å°å¯¹è±¡çç´æ¥å¤å¶ï¼èä¸æ¯ä»å¯¹è±¡å°å­èçå¤å¶ã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * éåº¦å¿«ï¼åºååä½ç§¯å°\n * å®æ¹ä¸æ¯æ java ä»¥å¤çå¶ä»è¯­è¨\n\n# fst\n\n> fst æ¯ä¸ä¸ª java å®ç°äºè¿å¶åºåååºã\n\nå®å·æä»¥ä¸ç¹æ§ï¼\n\n * è¿ä¹äº 100% å¼å®¹ jdk åºååï¼ä¸æ¯ jdk ååºååæ¹å¼å¿« 10 å\n * 2.17 å¼å§ä¸ android å¼å®¹\n * ï¼å¯éï¼2.29 å¼å§æ¯æå°ä»»ä½å¯åºååçå¯¹è±¡å¾ç¼ç /è§£ç ä¸º jsonï¼åæ¬å±äº«å¼ç¨ï¼\n\n# å°ç»\n\näºè§£äºä»¥ä¸è¿äºå¸¸è§çäºè¿å¶åºåååºçç¹æ§ãå¨ææ¯éåæ¶ï¼æä»¬å°±å¯ä»¥åå°æçæ¾ç¢ã\n\nï¼1ï¼éååèä¾æ®\n\nå¯¹äºäºè¿å¶åºåååºï¼æä»¬çéåèéä¸è¬æä»¥ä¸å ç¹ï¼\n\n * æ¯å¦æ¯æè·¨è¯­è¨\n   * æ ¹æ®ä¸å¡å®ééæ±æ¥å³å®ãä¸è¬æ¥è¯´ï¼æ¯æè·¨è¯­è¨ï¼ä¸ºäºå¼å®¹ï¼ä½¿ç¨å¤æåº¦ä¸ä¸è¬ä¼æ´é«ä¸äºã\n * åºååãååºååçæ§è½\n * ç±»åºæ¯å¦è½»éåï¼api æ¯å¦ç®åææ\n\nï¼2ï¼éåå»ºè®®\n\n * å¦æéè¦è·¨è¯­è¨éä¿¡ï¼é£ä¹å¯ä»¥èèï¼protobufãthriftãhessionã\n   \n   * thriftãprotobuf - éç¨äºå¯¹æ§è½ææï¼å¯¹å¼åä½éªè¦æ±ä¸é«çåé¨ç³»ç»ã\n   * hessian - éç¨äºå¯¹å¼åä½éªææï¼æ§è½æè¦æ±çåå¤é¨ç³»ç»ã\n\n * å¦æä¸éè¦è·¨è¯­è¨éä¿¡ï¼å¯ä»¥èèï¼kryo å fstï¼æ§è½ä¸éï¼ä¸ api ååç®åã\n\n\n# fst åºç¨\n\n\n# å¼å¥ä¾èµ\n\n<dependency>\n <groupid>de.ruedigermoeller</groupid>\n <artifactid>fst</artifactid>\n <version>2.56</version>\n</dependency>\n\n\n\n# fst api\n\nç¤ºä¾ï¼\n\nimport org.nustaq.serialization.fstconfiguration;\n\nimport java.io.ioexception;\nimport java.nio.charset.standardcharsets;\nimport java.util.base64;\n\npublic class fstdemo {\n\n private static fstconfiguration default_config = fstconfiguration.createdefaultconfiguration();\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»\n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <t> å¯¹è±¡çç±»å\n  * @return åºåååç byte æ°ç»\n  */\n public static <t> byte[] writetobytes(t obj) {\n  return default_config.asbytearray(obj);\n }\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»åï¼åä½¿ç¨ base64 ç¼ç \n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <t> å¯¹è±¡çç±»å\n  * @return åºåååçå­ç¬¦ä¸²\n  */\n public static <t> string writetostring(t obj) {\n  byte[] bytes = writetobytes(obj);\n  return new string(base64.getencoder().encode(bytes), standardcharsets.utf_8);\n }\n\n /**\n  * å° byte æ°ç»ååºååä¸ºåå¯¹è±¡\n  *\n  * @param bytes {@link #writetobytes} æ¹æ³åºåååç byte æ°ç»\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <t>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n public static <t> t readfrombytes(byte[] bytes, class<t> clazz) throws ioexception {\n  object obj = default_config.asobject(bytes);\n  if (clazz.isinstance(obj)) {\n   return (t) obj;\n  } else {\n   throw new ioexception("derialize failed");\n  }\n }\n\n /**\n  * å°å­ç¬¦ä¸²ååºååä¸ºåå¯¹è±¡ï¼åä½¿ç¨ base64 è§£ç \n  *\n  * @param str   {@link #writetostring} æ¹æ³åºåååçå­ç¬¦ä¸²\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <t>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n public static <t> t readfromstring(string str, class<t> clazz) throws ioexception {\n  byte[] bytes = str.getbytes(standardcharsets.utf_8);\n  return readfrombytes(base64.getdecoder().decode(bytes), clazz);\n }\n\n}\n\n\næµè¯ï¼\n\nlong begin = system.currenttimemillis();\nfor (int i = 0; i < batch_size; i++) {\n    testbean oldbean = beanutils.initjdk8bean();\n    byte[] bytes = fstdemo.writetobytes(oldbean);\n    testbean newbean = fstdemo.readfrombytes(bytes, testbean.class);\n}\nlong end = system.currenttimemillis();\nsystem.out.printf("fst åºåå/ååºååèæ¶ï¼%s", (end - begin));\n\n\n\n# kryo åºç¨\n\n\n# å¼å¥ä¾èµ\n\n<dependency>\n  <groupid>com.esotericsoftware</groupid>\n  <artifactid>kryo</artifactid>\n  <version>5.0.0-rc4</version>\n</dependency>\n\n\n\n# kryo api\n\nç¤ºä¾ï¼\n\nimport com.esotericsoftware.kryo.kryo;\nimport com.esotericsoftware.kryo.io.input;\nimport com.esotericsoftware.kryo.io.output;\nimport com.esotericsoftware.kryo.util.defaultinstantiatorstrategy;\nimport org.objenesis.strategy.stdinstantiatorstrategy;\n\nimport java.io.bytearrayinputstream;\nimport java.io.bytearrayoutputstream;\nimport java.nio.charset.standardcharsets;\nimport java.util.base64;\n\npublic class kryodemo {\n\n // æ¯ä¸ªçº¿ç¨ç kryo å®ä¾\n private static final threadlocal<kryo> kryolocal = threadlocal.withinitial(() -> {\n  kryo kryo = new kryo();\n\n  /**\n   * ä¸è¦è½»ææ¹åè¿éçéç½®ï¼æ´æ¹ä¹åï¼åºååçæ ¼å¼å°±ä¼åçååï¼\n   * ä¸çº¿çåæ¶å°±å¿é¡»æ¸é¤ redis éçææç¼å­ï¼\n   * å¦åé£äºç¼å­ååæ¥ååºååçæ¶åï¼å°±ä¼æ¥é\n   */\n  //æ¯æå¯¹è±¡å¾ªç¯å¼ç¨ï¼å¦åä¼æ æº¢åºï¼\n  kryo.setreferences(true); //é»è®¤å¼å°±æ¯ trueï¼æ·»å æ­¤è¡çç®çæ¯ä¸ºäºæéç»´æ¤èï¼ä¸è¦æ¹åè¿ä¸ªéç½®\n\n  //ä¸å¼ºå¶è¦æ±æ³¨åç±»ï¼æ³¨åè¡ä¸ºæ æ³ä¿è¯å¤ä¸ª jvm ååä¸ä¸ªç±»çæ³¨åç¼å·ç¸åï¼èä¸ä¸å¡ç³»ç»ä¸­å¤§éç class ä¹é¾ä»¥ä¸ä¸æ³¨åï¼\n  kryo.setregistrationrequired(false); //é»è®¤å¼å°±æ¯ falseï¼æ·»å æ­¤è¡çç®çæ¯ä¸ºäºæéç»´æ¤èï¼ä¸è¦æ¹åè¿ä¸ªéç½®\n\n  //fix the npe bug when deserializing collections.\n  ((defaultinstantiatorstrategy) kryo.getinstantiatorstrategy())\n   .setfallbackinstantiatorstrategy(new stdinstantiatorstrategy());\n\n  return kryo;\n });\n\n /**\n  * è·å¾å½åçº¿ç¨ç kryo å®ä¾\n  *\n  * @return å½åçº¿ç¨ç kryo å®ä¾\n  */\n public static kryo getinstance() {\n  return kryolocal.get();\n }\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»\n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <t> å¯¹è±¡çç±»å\n  * @return åºåååç byte æ°ç»\n  */\n public static <t> byte[] writetobytes(t obj) {\n  bytearrayoutputstream bytearrayoutputstream = new bytearrayoutputstream();\n  output output = new output(bytearrayoutputstream);\n\n  kryo kryo = getinstance();\n  kryo.writeobject(output, obj);\n  output.flush();\n\n  return bytearrayoutputstream.tobytearray();\n }\n\n /**\n  * å°å¯¹è±¡åºååä¸º byte æ°ç»åï¼åä½¿ç¨ base64 ç¼ç \n  *\n  * @param obj ä»»æå¯¹è±¡\n  * @param <t> å¯¹è±¡çç±»å\n  * @return åºåååçå­ç¬¦ä¸²\n  */\n public static <t> string writetostring(t obj) {\n  byte[] bytes = writetobytes(obj);\n  return new string(base64.getencoder().encode(bytes), standardcharsets.utf_8);\n }\n\n /**\n  * å° byte æ°ç»ååºååä¸ºåå¯¹è±¡\n  *\n  * @param bytes {@link #writetobytes} æ¹æ³åºåååç byte æ°ç»\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <t>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n @suppresswarnings("unchecked")\n public static <t> t readfrombytes(byte[] bytes, class<t> clazz) {\n  bytearrayinputstream bytearrayinputstream = new bytearrayinputstream(bytes);\n  input input = new input(bytearrayinputstream);\n\n  kryo kryo = getinstance();\n  return (t) kryo.readobject(input, clazz);\n }\n\n /**\n  * å°å­ç¬¦ä¸²ååºååä¸ºåå¯¹è±¡ï¼åä½¿ç¨ base64 è§£ç \n  *\n  * @param str   {@link #writetostring} æ¹æ³åºåååçå­ç¬¦ä¸²\n  * @param clazz åå¯¹è±¡çç±»å\n  * @param <t>   åå¯¹è±¡çç±»å\n  * @return åå¯¹è±¡\n  */\n public static <t> t readfromstring(string str, class<t> clazz) {\n  byte[] bytes = str.getbytes(standardcharsets.utf_8);\n  return readfrombytes(base64.getdecoder().decode(bytes), clazz);\n }\n\n}\n\n\næµè¯ï¼\n\nlong begin = system.currenttimemillis();\nfor (int i = 0; i < batch_size; i++) {\n    testbean oldbean = beanutils.initjdk8bean();\n    byte[] bytes = kryodemo.writetobytes(oldbean);\n    testbean newbean = kryodemo.readfrombytes(bytes, testbean.class);\n}\nlong end = system.currenttimemillis();\nsystem.out.printf("kryo åºåå/ååºååèæ¶ï¼%s", (end - begin));\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * protobuf å®ç½\n   * protobuf github\n   * thrift github\n   * kryo github\n   * hessian å®ç½\n   * fst github\n * æç« \n   * java åºååæ¡æ¶å¯¹æ¯',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java åºååå·¥å·",frontmatter:{title:"Java åºååå·¥å·",categories:["ç¼ç¨","Java","å·¥å·","IO"],tags:["Java","IO","åºåå"],abbrlink:"53c50fed",date:"2022-02-17T22:34:30.000Z",hidden:!0,permalink:"/pages/0358e9/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/01.IO/",relativePath:"12.å·¥å·/01.IO/README.md",key:"v-199c639b",path:"/pages/0358e9/",headers:[{level:2,title:"åå®¹",slug:"åå®¹",normalizedTitle:"åå®¹",charIndex:278},{level:2,title:"èµæ",slug:"èµæ",normalizedTitle:"èµæ",charIndex:360}],headersStr:"åå®¹ èµæ",content:"# Java åºååå·¥å·\n\nJava å®æ¹çåºååå­å¨è®¸å¤é®é¢ï¼å æ­¤ï¼å¾å¤äººæ´æ¿æä½¿ç¨ä¼ç§çç¬¬ä¸æ¹åºååå·¥å·æ¥æ¿ä»£ Java èªèº«çåºååæºå¶ã å¦ææ³è¯¦ç»äºè§£ Java èªèº«åºååæ¹å¼ï¼å¯ä»¥åèï¼æ·±å¥çè§£ Java åºåå\n\nåºåååºææ¯éåï¼\n\n * thriftãprotobuf - éç¨äºå¯¹æ§è½ææï¼å¯¹å¼åä½éªè¦æ±ä¸é«çåé¨ç³»ç»ã\n * hessian - éç¨äºå¯¹å¼åä½éªææï¼æ§è½æè¦æ±çåå¤é¨ç³»ç»ã\n * jacksonãgsonãfastjson - éç¨äºå¯¹åºåååçæ°æ®è¦æ±æè¯å¥½çå¯è¯»æ§ï¼è½¬ä¸º json ãxml å½¢å¼ï¼ã\n\n\n# åå®¹\n\n * JSON - FastjsonãJacksonãGson\n * äºè¿å¶ - ProtobufãThriftãHessianãKryoãFST\n\n\n# èµæ\n\n * Thrift Github\n * Protobuf Github\n * Hessian å®ç½\n * Fastjson Github\n * Jackson Github\n * Gson Github",normalizedContent:"# java åºååå·¥å·\n\njava å®æ¹çåºååå­å¨è®¸å¤é®é¢ï¼å æ­¤ï¼å¾å¤äººæ´æ¿æä½¿ç¨ä¼ç§çç¬¬ä¸æ¹åºååå·¥å·æ¥æ¿ä»£ java èªèº«çåºååæºå¶ã å¦ææ³è¯¦ç»äºè§£ java èªèº«åºååæ¹å¼ï¼å¯ä»¥åèï¼æ·±å¥çè§£ java åºåå\n\nåºåååºææ¯éåï¼\n\n * thriftãprotobuf - éç¨äºå¯¹æ§è½ææï¼å¯¹å¼åä½éªè¦æ±ä¸é«çåé¨ç³»ç»ã\n * hessian - éç¨äºå¯¹å¼åä½éªææï¼æ§è½æè¦æ±çåå¤é¨ç³»ç»ã\n * jacksonãgsonãfastjson - éç¨äºå¯¹åºåååçæ°æ®è¦æ±æè¯å¥½çå¯è¯»æ§ï¼è½¬ä¸º json ãxml å½¢å¼ï¼ã\n\n\n# åå®¹\n\n * json - fastjsonãjacksonãgson\n * äºè¿å¶ - protobufãthriftãhessianãkryoãfst\n\n\n# èµæ\n\n * thrift github\n * protobuf github\n * hessian å®ç½\n * fastjson github\n * jackson github\n * gson github",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Lombok å¿«éå¥é¨",frontmatter:{title:"Lombok å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","JavaBean"],tags:["Java","JavaBean","Lombok"],abbrlink:"6f8c7136",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/0d31cd/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/02.JavaBean/01.Lombok.html",relativePath:"12.å·¥å·/02.JavaBean/01.Lombok.md",key:"v-2507e04a",path:"/pages/0d31cd/",headers:[{level:2,title:"Lombok ç®ä»",slug:"lombok-ç®ä»",normalizedTitle:"lombok ç®ä»",charIndex:18},{level:2,title:"Lombok å®è£",slug:"lombok-å®è£",normalizedTitle:"lombok å®è£",charIndex:222},{level:2,title:"Lombok ä½¿ç¨",slug:"lombok-ä½¿ç¨",normalizedTitle:"lombok ä½¿ç¨",charIndex:789},{level:3,title:"@Getter and @Setter",slug:"getter-and-setter",normalizedTitle:"@getter and @setter",charIndex:829},{level:3,title:"@NonNull",slug:"nonnull",normalizedTitle:"@nonnull",charIndex:1264},{level:3,title:"@ToString",slug:"tostring",normalizedTitle:"@tostring",charIndex:1810},{level:3,title:"@EqualsAndHashCode",slug:"equalsandhashcode",normalizedTitle:"@equalsandhashcode",charIndex:2434},{level:3,title:"@Data",slug:"data",normalizedTitle:"@data",charIndex:4312},{level:3,title:"@Cleanup",slug:"cleanup",normalizedTitle:"@cleanup",charIndex:6361},{level:3,title:"@Synchronized",slug:"synchronized",normalizedTitle:"@synchronized",charIndex:7025},{level:3,title:"@SneakyThrows",slug:"sneakythrows",normalizedTitle:"@sneakythrows",charIndex:7492},{level:3,title:"ç¤ºä¾æºç ",slug:"ç¤ºä¾æºç ",normalizedTitle:"ç¤ºä¾æºç ",charIndex:7824},{level:2,title:"Lombok ä½¿ç¨æ³¨æç¹",slug:"lombok-ä½¿ç¨æ³¨æç¹",normalizedTitle:"lombok ä½¿ç¨æ³¨æç¹",charIndex:7854},{level:3,title:"è°¨æä½¿ç¨ @Builder",slug:"è°¨æä½¿ç¨-builder",normalizedTitle:"è°¨æä½¿ç¨ @builder",charIndex:7871},{level:3,title:"@Data æ³¨è§£åç»§æ¿",slug:"data-æ³¨è§£åç»§æ¿",normalizedTitle:"@data æ³¨è§£åç»§æ¿",charIndex:10399},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:12933}],headersStr:"Lombok ç®ä» Lombok å®è£ Lombok ä½¿ç¨ @Getter and @Setter @NonNull @ToString @EqualsAndHashCode @Data @Cleanup @Synchronized @SneakyThrows ç¤ºä¾æºç  Lombok ä½¿ç¨æ³¨æç¹ è°¨æä½¿ç¨ @Builder @Data æ³¨è§£åç»§æ¿ åèèµæ",content:'# Lombok å¿«éå¥é¨\n\n\n# Lombok ç®ä»\n\nLombok æ¯ä¸ç§ Java å®ç¨å·¥å·ï¼å¯ç¨æ¥å¸®å©å¼åäººåæ¶é¤ Java çåé¿ï¼å°¤å¶æ¯å¯¹äºç®åç Java å¯¹è±¡ï¼POJOï¼ãå®éè¿æ³¨éå®ç°è¿ä¸ç®çãéè¿å¨å¼åç¯å¢ä¸­å®ç° Lombokï¼å¼åäººåå¯ä»¥èçæå»ºè¯¸å¦ hashCode() å equals() ãgetter / setter è¿æ ·çæ¹æ³ä»¥åä»¥å¾ç¨æ¥åç±»åç§ accessor å mutator çå¤§éæ¶é´ã\n\n\n# Lombok å®è£\n\nç±äº Lombok ä»å¨ç¼è¯é¶æ®µçæä»£ç ï¼æä»¥ä½¿ç¨ Lombok æ³¨è§£çæºä»£ç ï¼å¨ IDE ä¸­ä¼è¢«é«äº®æ¾ç¤ºéè¯¯ï¼éå¯¹è¿ä¸ªé®é¢å¯ä»¥éè¿å®è£ IDE å¯¹åºçæä»¶æ¥è§£å³ãå·ä½çå®è£æ¹å¼å¯ä»¥åèï¼Setting up Lombok with Eclipse and Intellij\n\nä½¿ IntelliJ IDEA æ¯æ Lombok æ¹å¼å¦ä¸ï¼\n\n * Intellij è®¾ç½®æ¯ææ³¨è§£å¤ç\n   * ç¹å» File > Settings > Build > Annotation Processors\n   * å¾é Enable annotation processing\n * å®è£æä»¶\n   * ç¹å» Settings > Plugins > Browse repositories\n   * æ¥æ¾ Lombok Plugin å¹¶è¿è¡å®è£\n   * éå¯ IntelliJ IDEA\n * å° lombok æ·»å å° pom æä»¶\n\n<dependency>\n    <groupId>org.projectlombok</groupId>\n    <artifactId>lombok</artifactId>\n    <version>1.16.8</version>\n</dependency>\n\n\n\n# Lombok ä½¿ç¨\n\nLombok æä¾æ³¨è§£ API æ¥ä¿®é¥°æå®çç±»ï¼\n\n\n# @Getter and @Setter\n\n@Getter and @Setter Lombok ä»£ç ï¼\n\n@Getter @Setter private boolean employed = true;\n@Setter(AccessLevel.PROTECTED) private String name;\n\n\nç­ä»·äº Java æºç ï¼\n\nprivate boolean employed = true;\nprivate String name;\n\npublic boolean isEmployed() {\n    return employed;\n}\n\npublic void setEmployed(final boolean employed) {\n    this.employed = employed;\n}\n\nprotected void setName(final String name) {\n    this.name = name;\n}\n\n\n\n# @NonNull\n\n@NonNull Lombok ä»£ç ï¼\n\n@Getter @Setter @NonNull\nprivate List<Person> members;\n\n\nç­ä»·äº Java æºç ï¼\n\n@NonNull\nprivate List<Person> members;\n\npublic Family(@NonNull final List<Person> members) {\n    if (members == null) throw new java.lang.NullPointerException("members");\n    this.members = members;\n}\n\n@NonNull\npublic List<Person> getMembers() {\n    return members;\n}\n\npublic void setMembers(@NonNull final List<Person> members) {\n    if (members == null) throw new java.lang.NullPointerException("members");\n    this.members = members;\n}\n\n\n\n# @ToString\n\n@ToString Lombok ä»£ç ï¼\n\n@ToString(callSuper=true,exclude="someExcludedField")\npublic class Foo extends Bar {\n    private boolean someBoolean = true;\n    private String someStringField;\n    private float someExcludedField;\n}\n\n\nç­ä»·äº Java æºç ï¼\n\npublic class Foo extends Bar {\n    private boolean someBoolean = true;\n    private String someStringField;\n    private float someExcludedField;\n\n    @java.lang.Override\n    public java.lang.String toString() {\n        return "Foo(super=" + super.toString() +\n            ", someBoolean=" + someBoolean +\n            ", someStringField=" + someStringField + ")";\n    }\n}\n\n\n\n# @EqualsAndHashCode\n\n@EqualsAndHashCode Lombok ä»£ç ï¼\n\n@EqualsAndHashCode(callSuper=true,exclude={"address","city","state","zip"})\npublic class Person extends SentientBeing {\n    enum Gender { Male, Female }\n\n    @NonNull private String name;\n    @NonNull private Gender gender;\n\n    private String ssn;\n    private String address;\n    private String city;\n    private String state;\n    private String zip;\n}\n\n\nç­ä»·äº Java æºç ï¼\n\npublic class Person extends SentientBeing {\n\n    enum Gender {\n        /*public static final*/ Male /* = new Gender() */,\n        /*public static final*/ Female /* = new Gender() */;\n    }\n    @NonNull\n    private String name;\n    @NonNull\n    private Gender gender;\n    private String ssn;\n    private String address;\n    private String city;\n    private String state;\n    private String zip;\n\n    @java.lang.Override\n    public boolean equals(final java.lang.Object o) {\n        if (o == this) return true;\n        if (o == null) return false;\n        if (o.getClass() != this.getClass()) return false;\n        if (!super.equals(o)) return false;\n        final Person other = (Person)o;\n        if (this.name == null ? other.name != null : !this.name.equals(other.name)) return false;\n        if (this.gender == null ? other.gender != null : !this.gender.equals(other.gender)) return false;\n        if (this.ssn == null ? other.ssn != null : !this.ssn.equals(other.ssn)) return false;\n        return true;\n    }\n\n    @java.lang.Override\n    public int hashCode() {\n        final int PRIME = 31;\n        int result = 1;\n        result = result * PRIME + super.hashCode();\n        result = result * PRIME + (this.name == null ? 0 : this.name.hashCode());\n        result = result * PRIME + (this.gender == null ? 0 : this.gender.hashCode());\n        result = result * PRIME + (this.ssn == null ? 0 : this.ssn.hashCode());\n        return result;\n    }\n}\n\n\n\n# @Data\n\n@Data Lombok ä»£ç ï¼\n\n@Data(staticConstructor="of")\npublic class Company {\n    private final Person founder;\n    private String name;\n    private List<Person> employees;\n}\n\n\nç­ä»·äº Java æºç ï¼\n\npublic class Company {\n    private final Person founder;\n    private String name;\n    private List<Person> employees;\n\n    private Company(final Person founder) {\n        this.founder = founder;\n    }\n\n    public static Company of(final Person founder) {\n        return new Company(founder);\n    }\n\n    public Person getFounder() {\n        return founder;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(final String name) {\n        this.name = name;\n    }\n\n    public List<Person> getEmployees() {\n        return employees;\n    }\n\n    public void setEmployees(final List<Person> employees) {\n        this.employees = employees;\n    }\n\n    @java.lang.Override\n    public boolean equals(final java.lang.Object o) {\n        if (o == this) return true;\n        if (o == null) return false;\n        if (o.getClass() != this.getClass()) return false;\n        final Company other = (Company)o;\n        if (this.founder == null ? other.founder != null : !this.founder.equals(other.founder)) return false;\n        if (this.name == null ? other.name != null : !this.name.equals(other.name)) return false;\n        if (this.employees == null ? other.employees != null : !this.employees.equals(other.employees)) return false;\n        return true;\n    }\n\n    @java.lang.Override\n    public int hashCode() {\n        final int PRIME = 31;\n        int result = 1;\n        result = result * PRIME + (this.founder == null ? 0 : this.founder.hashCode());\n        result = result * PRIME + (this.name == null ? 0 : this.name.hashCode());\n        result = result * PRIME + (this.employees == null ? 0 : this.employees.hashCode());\n        return result;\n    }\n\n    @java.lang.Override\n    public java.lang.String toString() {\n        return "Company(founder=" + founder + ", name=" + name + ", employees=" + employees + ")";\n    }\n}\n\n\n\n# @Cleanup\n\n@Cleanup Lombok ä»£ç ï¼\n\npublic void testCleanUp() {\n    try {\n        @Cleanup ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        baos.write(new byte[] {\'Y\',\'e\',\'s\'});\n        System.out.println(baos.toString());\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n\n\nç­ä»·äº Java æºç ï¼\n\npublic void testCleanUp() {\n    try {\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        try {\n            baos.write(new byte[]{\'Y\', \'e\', \'s\'});\n            System.out.println(baos.toString());\n        } finally {\n            baos.close();\n        }\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n\n\n\n# @Synchronized\n\n@Synchronized Lombok ä»£ç ï¼\n\nprivate DateFormat format = new SimpleDateFormat("MM-dd-YYYY");\n\n@Synchronized\npublic String synchronizedFormat(Date date) {\n    return format.format(date);\n}\n\n\nç­ä»·äº Java æºç ï¼\n\nprivate final java.lang.Object $lock = new java.lang.Object[0];\nprivate DateFormat format = new SimpleDateFormat("MM-dd-YYYY");\n\npublic String synchronizedFormat(Date date) {\n    synchronized ($lock) {\n        return format.format(date);\n    }\n}\n\n\n\n# @SneakyThrows\n\n@SneakyThrows Lombok ä»£ç ï¼\n\n@SneakyThrows\npublic void testSneakyThrows() {\n    throw new IllegalAccessException();\n}\n\n\nç­ä»·äº Java æºç ï¼\n\npublic void testSneakyThrows() {\n    try {\n        throw new IllegalAccessException();\n    } catch (java.lang.Throwable $ex) {\n        throw lombok.Lombok.sneakyThrow($ex);\n    }\n}\n\n\n\n# ç¤ºä¾æºç \n\n> ç¤ºä¾æºç ï¼javalib-bean\n\n\n# Lombok ä½¿ç¨æ³¨æç¹\n\n\n# è°¨æä½¿ç¨ @Builder\n\nå¨ç±»ä¸æ æ³¨äº @Data å @Builder æ³¨è§£çæ¶åï¼ç¼è¯æ¶ï¼lombok ä¼ååç Class ä¸­ä¼æ²¡æé»è®¤çæé æ¹æ³ãå¨ååºååçæ¶åï¼æ²¡æé»è®¤æé æ¹æ³å°±å¯è½ä¼æ¥éã\n\nãç¤ºä¾ãä½¿ç¨ @Builder ä¸å½å¯¼è´ json ååºååå¤±è´¥\n\n@Data\n@Builder\npublic class BuilderDemo01 {\n\n    private String name;\n\n    public static void main(String[] args) throws JsonProcessingException {\n        BuilderDemo01 demo01 = BuilderDemo01.builder().name("demo01").build();\n        ObjectMapper mapper = new ObjectMapper();\n        String json = mapper.writeValueAsString(demo01);\n        BuilderDemo01 expectDemo01 = mapper.readValue(json, BuilderDemo01.class);\n        System.out.println(expectDemo01.toString());\n    }\n\n}\n\n\nè¿è¡æ¶ä¼æåºå¼å¸¸ï¼\n\nException in thread "main" com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `io.github.dunwu.javatech.bean.lombok.BuilderDemo01` (although at least one Creator exists): cannot deserialize from Object value (no delegate- or property-based Creator)\n at [Source: (String)"{"name":"demo01"}"; line: 1, column: 2]\n\tat com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:63)\n\tat com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1432)\n\tat com.fasterxml.jackson.databind.DeserializationContext.handleMissingInstantiator(DeserializationContext.java:1062)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1297)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:326)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:159)\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4218)\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3214)\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3182)\n\tat io.github.dunwu.javatech.bean.lombok.BuilderDemo01.main(BuilderDemo01.java:22)\n\n\nãç¤ºä¾ãä½¿ç¨ @Builder æ­£ç¡®æ¹æ³\n\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class BuilderDemo02 {\n\n    private String name;\n\n    public static void main(String[] args) throws JsonProcessingException {\n        BuilderDemo02 demo02 = BuilderDemo02.builder().name("demo01").build();\n        ObjectMapper mapper = new ObjectMapper();\n        String json = mapper.writeValueAsString(demo02);\n        BuilderDemo02 expectDemo02 = mapper.readValue(json, BuilderDemo02.class);\n        System.out.println(expectDemo02.toString());\n    }\n\n}\n\n\n\n# @Data æ³¨è§£åç»§æ¿\n\nä½¿ç¨ @Data æ³¨è§£æ¶ï¼åæäº @EqualsAndHashCode æ³¨è§£ï¼é£ä¹å°±ä¼å¨æ­¤ç±»ä¸­å­å¨ equals(Object other) å hashCode() æ¹æ³ï¼ä¸ä¸ä¼ä½¿ç¨ç¶ç±»çå±æ§ï¼è¿å°±å¯¼è´äºå¯è½çé®é¢ãæ¯å¦ï¼æå¤ä¸ªç±»æç¸åçé¨åå±æ§ï¼æå®ä»¬å®ä¹å°ç¶ç±»ä¸­ï¼æ°å¥½ idï¼æ°æ®åºä¸»é®ï¼ä¹å¨ç¶ç±»ä¸­ï¼é£ä¹å°±ä¼å­å¨é¨åå¯¹è±¡å¨æ¯è¾æ¶ï¼å®ä»¬å¹¶ä¸ç¸ç­ï¼è¿æ¯å ä¸ºï¼lombok èªå¨çæç equals(Object other) å hashCode() æ¹æ³å¤å®ä¸ºç¸ç­ï¼ä»èå¯¼è´åé¢æä¸ç¬¦ã\n\nä¿®å¤æ­¤é®é¢çæ¹æ³å¾ç®åï¼\n\n * ä½¿ç¨ @Data æ¶ï¼å ä¸ @EqualsAndHashCode(callSuper=true) æ³¨è§£ã\n * ä½¿ç¨ @Getter @Setter @ToString ä»£æ¿ @Data å¹¶ä¸èªå®ä¹ equals(Object other) å hashCode() æ¹æ³ã\n\nãç¤ºä¾ãæµè¯ @Data å @EqualsAndHashCode\n\n@Data\n@ToString(exclude = "age")\n@EqualsAndHashCode(exclude = { "age", "sex" })\npublic class Person {\n\n    protected String name;\n\n    protected Integer age;\n\n    protected String sex;\n\n}\n\n@Data\n@EqualsAndHashCode(callSuper = true, exclude = { "address", "city", "state", "zip" })\npublic class EqualsAndHashCodeDemo extends Person {\n\n    @NonNull\n    private String name;\n\n    @NonNull\n    private Gender gender;\n\n    private String ssn;\n\n    private String address;\n\n    private String city;\n\n    private String state;\n\n    private String zip;\n\n    public EqualsAndHashCodeDemo(@NonNull String name, @NonNull Gender gender) {\n        this.name = name;\n        this.gender = gender;\n    }\n\n    public EqualsAndHashCodeDemo(@NonNull String name, @NonNull Gender gender,\n        String ssn, String address, String city, String state, String zip) {\n        this.name = name;\n        this.gender = gender;\n        this.ssn = ssn;\n        this.address = address;\n        this.city = city;\n        this.state = state;\n        this.zip = zip;\n    }\n\n    public enum Gender {\n        Male,\n        Female\n    }\n\n}\n\n@Test\n@DisplayName("æµè¯ @EqualsAndHashCode")\npublic void testEqualsAndHashCodeDemo() {\n    EqualsAndHashCodeDemo demo1 =\n        new EqualsAndHashCodeDemo("name1", EqualsAndHashCodeDemo.Gender.Female, "ssn", "xxx", "xxx", "xxx", "xxx");\n    EqualsAndHashCodeDemo demo2 =\n        new EqualsAndHashCodeDemo("name1", EqualsAndHashCodeDemo.Gender.Female, "ssn", "ooo", "ooo", "ooo", "ooo");\n    Assertions.assertEquals(demo1, demo2);\n\n    Person person = new Person();\n    person.setName("å¼ ä¸");\n    person.setAge(20);\n    person.setSex("ç·");\n\n    Person person2 = new Person();\n    person2.setName("å¼ ä¸");\n    person2.setAge(18);\n    person2.setSex("ç·");\n\n    Person person3 = new Person();\n    person3.setName("æå");\n    person3.setAge(20);\n    person3.setSex("ç·");\n\n    Assertions.assertEquals(person2, person);\n    Assertions.assertNotEquals(person3, person);\n}\n\n\nä¸é¢çååæµè¯å¯ä»¥éè¿ï¼ä½å¦æå° @EqualsAndHashCode(callSuper = true, exclude = { "address", "city", "state", "zip" }) æ³¨æå°±ä¼æ¥éã\n\n\n# åèèµæ\n\n * Lombok å®ç½\n * Lombok Github\n * IntelliJ IDEA - Lombok Plugin',normalizedContent:'# lombok å¿«éå¥é¨\n\n\n# lombok ç®ä»\n\nlombok æ¯ä¸ç§ java å®ç¨å·¥å·ï¼å¯ç¨æ¥å¸®å©å¼åäººåæ¶é¤ java çåé¿ï¼å°¤å¶æ¯å¯¹äºç®åç java å¯¹è±¡ï¼pojoï¼ãå®éè¿æ³¨éå®ç°è¿ä¸ç®çãéè¿å¨å¼åç¯å¢ä¸­å®ç° lombokï¼å¼åäººåå¯ä»¥èçæå»ºè¯¸å¦ hashcode() å equals() ãgetter / setter è¿æ ·çæ¹æ³ä»¥åä»¥å¾ç¨æ¥åç±»åç§ accessor å mutator çå¤§éæ¶é´ã\n\n\n# lombok å®è£\n\nç±äº lombok ä»å¨ç¼è¯é¶æ®µçæä»£ç ï¼æä»¥ä½¿ç¨ lombok æ³¨è§£çæºä»£ç ï¼å¨ ide ä¸­ä¼è¢«é«äº®æ¾ç¤ºéè¯¯ï¼éå¯¹è¿ä¸ªé®é¢å¯ä»¥éè¿å®è£ ide å¯¹åºçæä»¶æ¥è§£å³ãå·ä½çå®è£æ¹å¼å¯ä»¥åèï¼setting up lombok with eclipse and intellij\n\nä½¿ intellij idea æ¯æ lombok æ¹å¼å¦ä¸ï¼\n\n * intellij è®¾ç½®æ¯ææ³¨è§£å¤ç\n   * ç¹å» file > settings > build > annotation processors\n   * å¾é enable annotation processing\n * å®è£æä»¶\n   * ç¹å» settings > plugins > browse repositories\n   * æ¥æ¾ lombok plugin å¹¶è¿è¡å®è£\n   * éå¯ intellij idea\n * å° lombok æ·»å å° pom æä»¶\n\n<dependency>\n    <groupid>org.projectlombok</groupid>\n    <artifactid>lombok</artifactid>\n    <version>1.16.8</version>\n</dependency>\n\n\n\n# lombok ä½¿ç¨\n\nlombok æä¾æ³¨è§£ api æ¥ä¿®é¥°æå®çç±»ï¼\n\n\n# @getter and @setter\n\n@getter and @setter lombok ä»£ç ï¼\n\n@getter @setter private boolean employed = true;\n@setter(accesslevel.protected) private string name;\n\n\nç­ä»·äº java æºç ï¼\n\nprivate boolean employed = true;\nprivate string name;\n\npublic boolean isemployed() {\n    return employed;\n}\n\npublic void setemployed(final boolean employed) {\n    this.employed = employed;\n}\n\nprotected void setname(final string name) {\n    this.name = name;\n}\n\n\n\n# @nonnull\n\n@nonnull lombok ä»£ç ï¼\n\n@getter @setter @nonnull\nprivate list<person> members;\n\n\nç­ä»·äº java æºç ï¼\n\n@nonnull\nprivate list<person> members;\n\npublic family(@nonnull final list<person> members) {\n    if (members == null) throw new java.lang.nullpointerexception("members");\n    this.members = members;\n}\n\n@nonnull\npublic list<person> getmembers() {\n    return members;\n}\n\npublic void setmembers(@nonnull final list<person> members) {\n    if (members == null) throw new java.lang.nullpointerexception("members");\n    this.members = members;\n}\n\n\n\n# @tostring\n\n@tostring lombok ä»£ç ï¼\n\n@tostring(callsuper=true,exclude="someexcludedfield")\npublic class foo extends bar {\n    private boolean someboolean = true;\n    private string somestringfield;\n    private float someexcludedfield;\n}\n\n\nç­ä»·äº java æºç ï¼\n\npublic class foo extends bar {\n    private boolean someboolean = true;\n    private string somestringfield;\n    private float someexcludedfield;\n\n    @java.lang.override\n    public java.lang.string tostring() {\n        return "foo(super=" + super.tostring() +\n            ", someboolean=" + someboolean +\n            ", somestringfield=" + somestringfield + ")";\n    }\n}\n\n\n\n# @equalsandhashcode\n\n@equalsandhashcode lombok ä»£ç ï¼\n\n@equalsandhashcode(callsuper=true,exclude={"address","city","state","zip"})\npublic class person extends sentientbeing {\n    enum gender { male, female }\n\n    @nonnull private string name;\n    @nonnull private gender gender;\n\n    private string ssn;\n    private string address;\n    private string city;\n    private string state;\n    private string zip;\n}\n\n\nç­ä»·äº java æºç ï¼\n\npublic class person extends sentientbeing {\n\n    enum gender {\n        /*public static final*/ male /* = new gender() */,\n        /*public static final*/ female /* = new gender() */;\n    }\n    @nonnull\n    private string name;\n    @nonnull\n    private gender gender;\n    private string ssn;\n    private string address;\n    private string city;\n    private string state;\n    private string zip;\n\n    @java.lang.override\n    public boolean equals(final java.lang.object o) {\n        if (o == this) return true;\n        if (o == null) return false;\n        if (o.getclass() != this.getclass()) return false;\n        if (!super.equals(o)) return false;\n        final person other = (person)o;\n        if (this.name == null ? other.name != null : !this.name.equals(other.name)) return false;\n        if (this.gender == null ? other.gender != null : !this.gender.equals(other.gender)) return false;\n        if (this.ssn == null ? other.ssn != null : !this.ssn.equals(other.ssn)) return false;\n        return true;\n    }\n\n    @java.lang.override\n    public int hashcode() {\n        final int prime = 31;\n        int result = 1;\n        result = result * prime + super.hashcode();\n        result = result * prime + (this.name == null ? 0 : this.name.hashcode());\n        result = result * prime + (this.gender == null ? 0 : this.gender.hashcode());\n        result = result * prime + (this.ssn == null ? 0 : this.ssn.hashcode());\n        return result;\n    }\n}\n\n\n\n# @data\n\n@data lombok ä»£ç ï¼\n\n@data(staticconstructor="of")\npublic class company {\n    private final person founder;\n    private string name;\n    private list<person> employees;\n}\n\n\nç­ä»·äº java æºç ï¼\n\npublic class company {\n    private final person founder;\n    private string name;\n    private list<person> employees;\n\n    private company(final person founder) {\n        this.founder = founder;\n    }\n\n    public static company of(final person founder) {\n        return new company(founder);\n    }\n\n    public person getfounder() {\n        return founder;\n    }\n\n    public string getname() {\n        return name;\n    }\n\n    public void setname(final string name) {\n        this.name = name;\n    }\n\n    public list<person> getemployees() {\n        return employees;\n    }\n\n    public void setemployees(final list<person> employees) {\n        this.employees = employees;\n    }\n\n    @java.lang.override\n    public boolean equals(final java.lang.object o) {\n        if (o == this) return true;\n        if (o == null) return false;\n        if (o.getclass() != this.getclass()) return false;\n        final company other = (company)o;\n        if (this.founder == null ? other.founder != null : !this.founder.equals(other.founder)) return false;\n        if (this.name == null ? other.name != null : !this.name.equals(other.name)) return false;\n        if (this.employees == null ? other.employees != null : !this.employees.equals(other.employees)) return false;\n        return true;\n    }\n\n    @java.lang.override\n    public int hashcode() {\n        final int prime = 31;\n        int result = 1;\n        result = result * prime + (this.founder == null ? 0 : this.founder.hashcode());\n        result = result * prime + (this.name == null ? 0 : this.name.hashcode());\n        result = result * prime + (this.employees == null ? 0 : this.employees.hashcode());\n        return result;\n    }\n\n    @java.lang.override\n    public java.lang.string tostring() {\n        return "company(founder=" + founder + ", name=" + name + ", employees=" + employees + ")";\n    }\n}\n\n\n\n# @cleanup\n\n@cleanup lombok ä»£ç ï¼\n\npublic void testcleanup() {\n    try {\n        @cleanup bytearrayoutputstream baos = new bytearrayoutputstream();\n        baos.write(new byte[] {\'y\',\'e\',\'s\'});\n        system.out.println(baos.tostring());\n    } catch (ioexception e) {\n        e.printstacktrace();\n    }\n}\n\n\nç­ä»·äº java æºç ï¼\n\npublic void testcleanup() {\n    try {\n        bytearrayoutputstream baos = new bytearrayoutputstream();\n        try {\n            baos.write(new byte[]{\'y\', \'e\', \'s\'});\n            system.out.println(baos.tostring());\n        } finally {\n            baos.close();\n        }\n    } catch (ioexception e) {\n        e.printstacktrace();\n    }\n}\n\n\n\n# @synchronized\n\n@synchronized lombok ä»£ç ï¼\n\nprivate dateformat format = new simpledateformat("mm-dd-yyyy");\n\n@synchronized\npublic string synchronizedformat(date date) {\n    return format.format(date);\n}\n\n\nç­ä»·äº java æºç ï¼\n\nprivate final java.lang.object $lock = new java.lang.object[0];\nprivate dateformat format = new simpledateformat("mm-dd-yyyy");\n\npublic string synchronizedformat(date date) {\n    synchronized ($lock) {\n        return format.format(date);\n    }\n}\n\n\n\n# @sneakythrows\n\n@sneakythrows lombok ä»£ç ï¼\n\n@sneakythrows\npublic void testsneakythrows() {\n    throw new illegalaccessexception();\n}\n\n\nç­ä»·äº java æºç ï¼\n\npublic void testsneakythrows() {\n    try {\n        throw new illegalaccessexception();\n    } catch (java.lang.throwable $ex) {\n        throw lombok.lombok.sneakythrow($ex);\n    }\n}\n\n\n\n# ç¤ºä¾æºç \n\n> ç¤ºä¾æºç ï¼javalib-bean\n\n\n# lombok ä½¿ç¨æ³¨æç¹\n\n\n# è°¨æä½¿ç¨ @builder\n\nå¨ç±»ä¸æ æ³¨äº @data å @builder æ³¨è§£çæ¶åï¼ç¼è¯æ¶ï¼lombok ä¼ååç class ä¸­ä¼æ²¡æé»è®¤çæé æ¹æ³ãå¨ååºååçæ¶åï¼æ²¡æé»è®¤æé æ¹æ³å°±å¯è½ä¼æ¥éã\n\nãç¤ºä¾ãä½¿ç¨ @builder ä¸å½å¯¼è´ json ååºååå¤±è´¥\n\n@data\n@builder\npublic class builderdemo01 {\n\n    private string name;\n\n    public static void main(string[] args) throws jsonprocessingexception {\n        builderdemo01 demo01 = builderdemo01.builder().name("demo01").build();\n        objectmapper mapper = new objectmapper();\n        string json = mapper.writevalueasstring(demo01);\n        builderdemo01 expectdemo01 = mapper.readvalue(json, builderdemo01.class);\n        system.out.println(expectdemo01.tostring());\n    }\n\n}\n\n\nè¿è¡æ¶ä¼æåºå¼å¸¸ï¼\n\nexception in thread "main" com.fasterxml.jackson.databind.exc.mismatchedinputexception: cannot construct instance of `io.github.dunwu.javatech.bean.lombok.builderdemo01` (although at least one creator exists): cannot deserialize from object value (no delegate- or property-based creator)\n at [source: (string)"{"name":"demo01"}"; line: 1, column: 2]\n\tat com.fasterxml.jackson.databind.exc.mismatchedinputexception.from(mismatchedinputexception.java:63)\n\tat com.fasterxml.jackson.databind.deserializationcontext.reportinputmismatch(deserializationcontext.java:1432)\n\tat com.fasterxml.jackson.databind.deserializationcontext.handlemissinginstantiator(deserializationcontext.java:1062)\n\tat com.fasterxml.jackson.databind.deser.beandeserializerbase.deserializefromobjectusingnondefault(beandeserializerbase.java:1297)\n\tat com.fasterxml.jackson.databind.deser.beandeserializer.deserializefromobject(beandeserializer.java:326)\n\tat com.fasterxml.jackson.databind.deser.beandeserializer.deserialize(beandeserializer.java:159)\n\tat com.fasterxml.jackson.databind.objectmapper._readmapandclose(objectmapper.java:4218)\n\tat com.fasterxml.jackson.databind.objectmapper.readvalue(objectmapper.java:3214)\n\tat com.fasterxml.jackson.databind.objectmapper.readvalue(objectmapper.java:3182)\n\tat io.github.dunwu.javatech.bean.lombok.builderdemo01.main(builderdemo01.java:22)\n\n\nãç¤ºä¾ãä½¿ç¨ @builder æ­£ç¡®æ¹æ³\n\n@data\n@builder\n@noargsconstructor\n@allargsconstructor\npublic class builderdemo02 {\n\n    private string name;\n\n    public static void main(string[] args) throws jsonprocessingexception {\n        builderdemo02 demo02 = builderdemo02.builder().name("demo01").build();\n        objectmapper mapper = new objectmapper();\n        string json = mapper.writevalueasstring(demo02);\n        builderdemo02 expectdemo02 = mapper.readvalue(json, builderdemo02.class);\n        system.out.println(expectdemo02.tostring());\n    }\n\n}\n\n\n\n# @data æ³¨è§£åç»§æ¿\n\nä½¿ç¨ @data æ³¨è§£æ¶ï¼åæäº @equalsandhashcode æ³¨è§£ï¼é£ä¹å°±ä¼å¨æ­¤ç±»ä¸­å­å¨ equals(object other) å hashcode() æ¹æ³ï¼ä¸ä¸ä¼ä½¿ç¨ç¶ç±»çå±æ§ï¼è¿å°±å¯¼è´äºå¯è½çé®é¢ãæ¯å¦ï¼æå¤ä¸ªç±»æç¸åçé¨åå±æ§ï¼æå®ä»¬å®ä¹å°ç¶ç±»ä¸­ï¼æ°å¥½ idï¼æ°æ®åºä¸»é®ï¼ä¹å¨ç¶ç±»ä¸­ï¼é£ä¹å°±ä¼å­å¨é¨åå¯¹è±¡å¨æ¯è¾æ¶ï¼å®ä»¬å¹¶ä¸ç¸ç­ï¼è¿æ¯å ä¸ºï¼lombok èªå¨çæç equals(object other) å hashcode() æ¹æ³å¤å®ä¸ºç¸ç­ï¼ä»èå¯¼è´åé¢æä¸ç¬¦ã\n\nä¿®å¤æ­¤é®é¢çæ¹æ³å¾ç®åï¼\n\n * ä½¿ç¨ @data æ¶ï¼å ä¸ @equalsandhashcode(callsuper=true) æ³¨è§£ã\n * ä½¿ç¨ @getter @setter @tostring ä»£æ¿ @data å¹¶ä¸èªå®ä¹ equals(object other) å hashcode() æ¹æ³ã\n\nãç¤ºä¾ãæµè¯ @data å @equalsandhashcode\n\n@data\n@tostring(exclude = "age")\n@equalsandhashcode(exclude = { "age", "sex" })\npublic class person {\n\n    protected string name;\n\n    protected integer age;\n\n    protected string sex;\n\n}\n\n@data\n@equalsandhashcode(callsuper = true, exclude = { "address", "city", "state", "zip" })\npublic class equalsandhashcodedemo extends person {\n\n    @nonnull\n    private string name;\n\n    @nonnull\n    private gender gender;\n\n    private string ssn;\n\n    private string address;\n\n    private string city;\n\n    private string state;\n\n    private string zip;\n\n    public equalsandhashcodedemo(@nonnull string name, @nonnull gender gender) {\n        this.name = name;\n        this.gender = gender;\n    }\n\n    public equalsandhashcodedemo(@nonnull string name, @nonnull gender gender,\n        string ssn, string address, string city, string state, string zip) {\n        this.name = name;\n        this.gender = gender;\n        this.ssn = ssn;\n        this.address = address;\n        this.city = city;\n        this.state = state;\n        this.zip = zip;\n    }\n\n    public enum gender {\n        male,\n        female\n    }\n\n}\n\n@test\n@displayname("æµè¯ @equalsandhashcode")\npublic void testequalsandhashcodedemo() {\n    equalsandhashcodedemo demo1 =\n        new equalsandhashcodedemo("name1", equalsandhashcodedemo.gender.female, "ssn", "xxx", "xxx", "xxx", "xxx");\n    equalsandhashcodedemo demo2 =\n        new equalsandhashcodedemo("name1", equalsandhashcodedemo.gender.female, "ssn", "ooo", "ooo", "ooo", "ooo");\n    assertions.assertequals(demo1, demo2);\n\n    person person = new person();\n    person.setname("å¼ ä¸");\n    person.setage(20);\n    person.setsex("ç·");\n\n    person person2 = new person();\n    person2.setname("å¼ ä¸");\n    person2.setage(18);\n    person2.setsex("ç·");\n\n    person person3 = new person();\n    person3.setname("æå");\n    person3.setage(20);\n    person3.setsex("ç·");\n\n    assertions.assertequals(person2, person);\n    assertions.assertnotequals(person3, person);\n}\n\n\nä¸é¢çååæµè¯å¯ä»¥éè¿ï¼ä½å¦æå° @equalsandhashcode(callsuper = true, exclude = { "address", "city", "state", "zip" }) æ³¨æå°±ä¼æ¥éã\n\n\n# åèèµæ\n\n * lombok å®ç½\n * lombok github\n * intellij idea - lombok plugin',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Dozer å¿«éå¥é¨",frontmatter:{title:"Dozer å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","JavaBean"],tags:["Java","JavaBean","Dozer"],abbrlink:"3632a3b1",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/596174/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/02.JavaBean/02.Dozer.html",relativePath:"12.å·¥å·/02.JavaBean/02.Dozer.md",key:"v-696c277c",path:"/pages/596174/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:127},{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:259},{level:3,title:"å¼å¥ jar å",slug:"å¼å¥-jar-å",normalizedTitle:"å¼å¥ jar å",charIndex:266},{level:3,title:"Eclipse æä»¶",slug:"eclipse-æä»¶",normalizedTitle:"eclipse æä»¶",charIndex:580},{level:2,title:"ä½¿ç¨",slug:"ä½¿ç¨",normalizedTitle:"ä½¿ç¨",charIndex:292},{level:3,title:"åå¤",slug:"åå¤",normalizedTitle:"åå¤",charIndex:761},{level:3,title:"Dozer çéç½®",slug:"dozer-çéç½®",normalizedTitle:"dozer çéç½®",charIndex:1126},{level:4,title:"ä¸ºä»ä¹è¦ææ å°éç½®?",slug:"ä¸ºä»ä¹è¦ææ å°éç½®",normalizedTitle:"ä¸ºä»ä¹è¦ææ å°éç½®?",charIndex:1139},{level:4,title:"æ å°éç½®æä»¶",slug:"æ å°éç½®æä»¶",normalizedTitle:"æ å°éç½®æä»¶",charIndex:1501},{level:3,title:"ä¸ Spring æ´å",slug:"ä¸-spring-æ´å",normalizedTitle:"ä¸ spring æ´å",charIndex:2226},{level:4,title:"éç½® DozerBeanMapperFactoryBean",slug:"éç½®-dozerbeanmapperfactorybean",normalizedTitle:"éç½® dozerbeanmapperfactorybean",charIndex:2241},{level:4,title:"èªå¨è£é",slug:"èªå¨è£é",normalizedTitle:"èªå¨è£é",charIndex:3075},{level:2,title:"Dozer æ¯æçæ°æ®ç±»åè½¬æ¢",slug:"dozer-æ¯æçæ°æ®ç±»åè½¬æ¢",normalizedTitle:"dozer æ¯æçæ°æ®ç±»åè½¬æ¢",charIndex:3686},{level:2,title:"Dozer çæ å°éç½®",slug:"dozer-çæ å°éç½®",normalizedTitle:"dozer çæ å°éç½®",charIndex:5053},{level:3,title:"ç¨æ³¨è§£æ¥éç½®æ å°",slug:"ç¨æ³¨è§£æ¥éç½®æ å°",normalizedTitle:"ç¨æ³¨è§£æ¥éç½®æ å°",charIndex:5184},{level:3,title:"ç¨ API æ¥éç½®æ å°",slug:"ç¨-api-æ¥éç½®æ å°",normalizedTitle:"ç¨ api æ¥éç½®æ å°",charIndex:6247},{level:3,title:"ç¨ XML æ¥éç½®æ å°",slug:"ç¨-xml-æ¥éç½®æ å°",normalizedTitle:"ç¨ xml æ¥éç½®æ å°",charIndex:6297},{level:4,title:"å±æ§åä¸åæ¶çæ å°(Basic Property Mapping)",slug:"å±æ§åä¸åæ¶çæ å°-basic-property-mapping",normalizedTitle:"å±æ§åä¸åæ¶çæ å°(basic property mapping)",charIndex:6382},{level:4,title:"å­ç¬¦ä¸²åæ¥ææ å°(String to Date Mapping)",slug:"å­ç¬¦ä¸²åæ¥ææ å°-string-to-date-mapping",normalizedTitle:"å­ç¬¦ä¸²åæ¥ææ å°(string to date mapping)",charIndex:6507},{level:4,title:"éååæ°ç»æ å°(Collection and Array Mapping)",slug:"éååæ°ç»æ å°-collection-and-array-mapping",normalizedTitle:"éååæ°ç»æ å°(collection and array mapping)",charIndex:7304},{level:4,title:"æ·±åº¦æ å°(Deep Mapping)",slug:"æ·±åº¦æ å°-deep-mapping",normalizedTitle:"æ·±åº¦æ å°(deep mapping)",charIndex:8457},{level:4,title:"æé¤å±æ§(Excluding Fields)",slug:"æé¤å±æ§-excluding-fields",normalizedTitle:"æé¤å±æ§(excluding fields)",charIndex:8945},{level:4,title:"ååæ å°(One-Way Mapping)",slug:"ååæ å°-one-way-mapping",normalizedTitle:"ååæ å°(one-way mapping)",charIndex:9175},{level:4,title:"å¨å±éç½®(Global Configuration)",slug:"å¨å±éç½®-global-configuration",normalizedTitle:"å¨å±éç½®(global configuration)",charIndex:9772},{level:4,title:"å®å¶è½¬æ¢(Custom Converters)",slug:"å®å¶è½¬æ¢-custom-converters",normalizedTitle:"å®å¶è½¬æ¢(custom converters)",charIndex:10716},{level:4,title:"æ å°çç»§æ¿(Inheritance Mapping)",slug:"æ å°çç»§æ¿-inheritance-mapping",normalizedTitle:"æ å°çç»§æ¿(inheritance mapping)",charIndex:13131},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:9054}],headersStr:"ç®ä» å®è£ å¼å¥ jar å Eclipse æä»¶ ä½¿ç¨ åå¤ Dozer çéç½® ä¸ºä»ä¹è¦ææ å°éç½®? æ å°éç½®æä»¶ ä¸ Spring æ´å éç½® DozerBeanMapperFactoryBean èªå¨è£é Dozer æ¯æçæ°æ®ç±»åè½¬æ¢ Dozer çæ å°éç½® ç¨æ³¨è§£æ¥éç½®æ å° ç¨ API æ¥éç½®æ å° ç¨ XML æ¥éç½®æ å° å±æ§åä¸åæ¶çæ å°(Basic Property Mapping) å­ç¬¦ä¸²åæ¥ææ å°(String to Date Mapping) éååæ°ç»æ å°(Collection and Array Mapping) æ·±åº¦æ å°(Deep Mapping) æé¤å±æ§(Excluding Fields) ååæ å°(One-Way Mapping) å¨å±éç½®(Global Configuration) å®å¶è½¬æ¢(Custom Converters) æ å°çç»§æ¿(Inheritance Mapping) åè",content:'# Dozer å¿«éå¥é¨\n\nè¿ç¯æç« æ¯æ¬äººå¨éè¯» Dozer å®æ¹ææ¡£ï¼5.5.1 çæ¬ï¼å®ç½å·²ç»ä¸å¹´å¤æ²¡æ´æ°äºï¼çè¿ç¨ä¸­ï¼æ´çä¸æ¥æè®¤ä¸ºæ¯è¾åºç¡çåºç¨åºæ¯ã\n\næ¬æä¸­æå°çä¾å­åºè¯¥è½è¦ç JavaBean æ å°çå¤§é¨ååºæ¯ï¼å¸æå¯¹ä½ ææå¸®å©ã\n\n\n# ç®ä»\n\nDozer æ¯ä»ä¹?\n\nDozer æ¯ä¸ä¸ª JavaBean æ å°å·¥å·åºã\n\nå®æ¯æç®åçå±æ§æ å°ï¼å¤æç±»åæ å°ï¼ååæ å°ï¼éå¼æ¾å¼çæ å°ï¼ä»¥åéå½æ å°ã\n\nå®æ¯æä¸ç§æ å°æ¹å¼ï¼æ³¨è§£ãAPIãXMLã\n\nå®æ¯å¼æºçï¼éµä»Apache 2.0 åè®®\n\n\n# å®è£\n\n\n# å¼å¥ jar å\n\nmaven æ¹å¼\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ mavenï¼æ·»å ä»¥ä¸ä¾èµå°ä½ ç pom.xml å³å¯ï¼\n\n<dependency>\n    <groupId>net.sf.dozer</groupId>\n    <artifactId>dozer</artifactId>\n    <version>5.4.0</version>\n</dependency>\n\n\né maven æ¹å¼\n\nå¦æä½ çé¡¹ç®ä¸ä½¿ç¨ mavenï¼é£å°±åªè½åæ¬ä¸æè¦ä¸æç´¯çç²¾ç¥äºã\n\nä½¿ç¨ Dozer éè¦å¼å¥ Dozer ç jar åä»¥åå¶ä¾èµçç¬¬ä¸æ¹ jar åã\n\n * Dozer\n * Dozer ä¾èµçç¬¬ä¸æ¹ jar å\n\n\n# Eclipse æä»¶\n\nDozer ææä»¶å¯ä»¥å¨ Eclipse ä¸­ä½¿ç¨(ä¸ç¥éæ¯å¦å¥½ç¨ï¼åæ­£ææ²¡ç¨è¿)\n\næä»¶å°å: http://dozer.sourceforge.net/eclipse-plugin\n\n\n# ä½¿ç¨\n\nå° Dozer å¼å¥å°å·¥ç¨ä¸­åï¼æä»¬å°±å¯ä»¥æ¥å°è¯ä¸çªäºã\n\nå®è·µåºçç¥ï¼åä»¥ä¸ä¸ªæç®åçä¾å­æ¥å±ç¤º Dozer æ å°çå¤çè¿ç¨ã\n\n\n# åå¤\n\næä»¬ååå¤ä¸¤ä¸ªè¦äºç¸æ å°çç±»\n\nNotSameAttributeA.java\n\npublic class NotSameAttributeA {\n    private long id;\n    private String name;\n    private Date date;\n\n    // çç¥getter/setter\n}\n\n\nNotSameAttributeB.java\n\npublic class NotSameAttributeB {\n    private long id;\n    private String value;\n    private Date date;\n\n    // çç¥getter/setter\n}\n\n\nè¿ä¸¤ä¸ªç±»å­å¨å±æ§åä¸å®å¨ç¸åçæåµï¼name å valueã\n\n\n# Dozer çéç½®\n\n# ä¸ºä»ä¹è¦ææ å°éç½®?\n\nå¦æè¦æ å°çä¸¤ä¸ªå¯¹è±¡æå®å¨ç¸åçå±æ§åï¼é£ä¹ä¸åé½å¾ç®åã\n\nåªéè¦ç´æ¥ä½¿ç¨ Dozer ç API å³å¯ï¼\n\nMapper mapper = new DozerBeanMapper();\nDestinationObject destObject =\n    mapper.map(sourceObject, DestinationObject.class);\n\n\nä½å®éæ å°æ¶ï¼å¾å¾å­å¨å±æ§åä¸åçæåµã\n\næä»¥ï¼ä½ éè¦ä¸äºéç½®æ¥åè¯ Dozer åºè¯¥è½¬æ¢ä»ä¹ï¼æä¹è½¬æ¢ã\n\næ³¨ï¼å®ç½çéå»ºè®®ï¼å¨ç°å®åºç¨ä¸­ï¼æå¥½ä¸è¦æ¯æ¬¡æ å°å¯¹è±¡æ¶é½åå»ºä¸ä¸ªMapperå®ä¾æ¥å·¥ä½ï¼è¿æ ·ä¼äº§çä¸å¿è¦çå¼éãå¦æä½ ä¸ä½¿ç¨ IoC å®¹å¨ï¼å¦ï¼springï¼æ¥ç®¡çä½ çé¡¹ç®ï¼é£ä¹ï¼æå¥½å°Mapperå®ä¹ä¸ºåä¾æ¨¡å¼ã\n\n# æ å°éç½®æä»¶\n\nå¨src/test/resourcesç®å½ä¸æ·»å dozer/dozer-mapping.xmlæä»¶ã <mapping>æ ç­¾ä¸­åè®¸ä½ å®ä¹<class-a>å<class-b>ï¼å¯¹åºçç¸äºæ å°çç±»ã <field>æ ç­¾éå®ä¹è¦æ å°çç¹æ®å±æ§ãéè¦æ³¨æ<a>å<class-a>å¯¹åºï¼<b>å<class-b>å¯¹åºï¼èªæçä½ ï¼çä¹çåºæ¥äºå§ã\n\n<?xml version="1.0" encoding="UTF-8"?>\n<mappings xmlns="http://dozer.sourceforge.net" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n          xsi:schemaLocation="http://dozer.sourceforge.net\n          http://dozer.sourceforge.net/schema/beanmapping.xsd">\n  <mapping date-format="yyyy-MM-dd">\n    <class-a>org.zp.notes.spring.common.dozer.vo.NotSameAttributeA</class-a>\n    <class-b>org.zp.notes.spring.common.dozer.vo.NotSameAttributeB</class-b>\n    <field>\n      <a>name</a>\n      <b>value</b>\n    </field>\n  </mapping>\n</mappings>\n\n\n\n# ä¸ Spring æ´å\n\n# éç½® DozerBeanMapperFactoryBean\n\nå¨src/test/resourcesç®å½ä¸æ·»å spring/spring-dozer.xmlæä»¶ã\n\nDozer ä¸ Spring çæ´åå¾ä¾¿å©ï¼ä½ åªéè¦å£°æä¸ä¸ªDozerBeanMapperFactoryBeanï¼ å°ææç dozer æ å°éç½®æä»¶ä½ä¸ºå±æ§æ³¨å¥å°mappingFilesï¼ DozerBeanMapperFactoryBeanä¼å è½½è¿äºè§åã\n\nspring-dozer.xml æä»¶èä¾\n\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-2.0.xsd"\n       default-autowire="byName" default-lazy-init="false">\n\n  <bean id="mapper" class="org.dozer.spring.DozerBeanMapperFactoryBean">\n    <property name="mappingFiles">\n      <list>\n        <value>classpath*:dozer/dozer-mapping.xml</value>\n      </list>\n    </property>\n  </bean>\n</beans>\n\n\n# èªå¨è£é\n\nè³æ­¤ï¼ä¸äºå·å¤ï¼ä½ åªéè¦èªå¨è£émapperã\n\nRunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = {"classpath:spring/spring-dozer.xml"})\n@TransactionConfiguration(defaultRollback = false)\npublic class DozerTest extends TestCase {\n    @Autowired\n    Mapper mapper;\n\n    @Test\n    public void testNotSameAttributeMapping() {\n        NotSameAttributeA src = new NotSameAttributeA();\n        src.setId(007);\n        src.setName("é¦å¾·");\n        src.setDate(new Date());\n\n        NotSameAttributeB desc = mapper.map(src, NotSameAttributeB.class);\n        Assert.assertNotNull(desc);\n    }\n}\n\n\nè¿è¡ä¸ä¸ååæµè¯ï¼ç»¿ç¯éè¿ã\n\n\n# Dozer æ¯æçæ°æ®ç±»åè½¬æ¢\n\nDozer å¯ä»¥èªå¨åæ°æ®ç±»åè½¬æ¢ãå½åï¼Dozer æ¯æä»¥ä¸æ°æ®ç±»åè½¬æ¢ï¼é½æ¯ååçï¼\n\n * Primitive to Primitive Wrapper\n   \n   åå(intãlong ç­)ååååè£ç±»(IntegerãLong)\n\n * Primitive to Custom Wrapper\n   \n   åååå®å¶çåè£\n\n * Primitive Wrapper to Primitive Wrapper\n   \n   åååè£ç±»ååè£ç±»\n\n * Primitive to Primitive\n   \n   ååååå\n\n * Complex Type to Complex Type\n   \n   å¤æç±»ååå¤æç±»å\n\n * String to Primitive\n   \n   å­ç¬¦ä¸²ååå\n\n * String to Primitive Wrapper\n   \n   å­ç¬¦ä¸²ååååè£ç±»\n\n * String to Complex Type if the Complex Type contains a String constructor\n   \n   å­ç¬¦ä¸²åæå­ç¬¦ä¸²æé å¨çå¤æç±»åï¼ç±»ï¼\n\n * String to Map\n   \n   å­ç¬¦ä¸²å Map\n\n * Collection to Collection\n   \n   éååéå\n\n * Collection to Array\n   \n   éååæ°ç»\n\n * Map to Complex Type\n   \n   Map åå¤æç±»å\n\n * Map to Custom Map Type\n   \n   Map åå®å¶ Map ç±»å\n\n * Enum to Enum\n   \n   æä¸¾åæä¸¾\n\n * Each of these can be mapped to one another: java.util.Date, java.sql.Date, java.sql.Time, java.sql.Timestamp, java.util.Calendar, java.util.GregorianCalendar\n   \n   è¿äºæ¶é´ç¸å³çå¸¸è§ç±»å¯ä»¥äºæ¢ï¼java.util.Date, java.sql.Date, java.sql.Time, java.sql.Timestamp, java.util.Calendar, java.util.GregorianCalendar\n\n * String to any of the supported Date/Calendar Objects.\n   \n   å­ç¬¦ä¸²åæ¯æ Date/Calendar çå¯¹è±¡\n\n * Objects containing a toString() method that produces a long representing time in (ms) to any supported Date/Calendar object.\n   \n   å¦æä¸ä¸ªå¯¹è±¡ç toString()æ¹æ³è¿åçæ¯ä¸ä¸ªä»£è¡¨ long åçæ¶é´æ°å¼ï¼åä½ï¼msï¼ï¼å°±å¯ä»¥åä»»ä½æ¯æ Date/Calendar çå¯¹è±¡è½¬æ¢ã\n\n\n# Dozer çæ å°éç½®\n\nå¨åé¢çç®åä¾å­ä¸­ï¼æä»¬ä½éªäºä¸æ Dozer çæ å°æµç¨ãä½æ¯ä¸¤ä¸ªç±»è¿è¡æ å°ï¼æå¾å¤å¤æçæåµï¼ç¸åºçï¼ä½ ä¹éè¦ä¸äºæ´å¤æçéç½®ã\n\nDozer æä¸ç§æ å°éç½®æ¹å¼ï¼\n\n * æ³¨è§£æ¹å¼\n * API æ¹å¼\n * XML æ¹å¼\n\n\n# ç¨æ³¨è§£æ¥éç½®æ å°\n\nDozer 5.3.2çæ¬å¼å§æ¯ææ³¨è§£æ¹å¼éç½®æ å°ï¼åªæä¸ä¸ªæ³¨è§£ï¼@Mappingï¼ãå¯ä»¥åºå¯¹ä¸äºç®åçæ å°å¤çï¼å¤æçå°±ç©ä¸è½¬äºã\n\nçä¸ä¸@Mappingçå£°æå°±å¯ä»¥ç¥éï¼è¿ä¸ªæ³¨è§£åªè½ç¨äºåç´ åæ¹æ³ã\n\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.FIELD, ElementType.METHOD})\npublic @interface Mapping {\n  String value() default "";\n}\n\n\nè®©æä»¬æ¥è¯è¯å§ï¼\n\nTargetBean.java\n\npublic class SourceBean {\n\n    private Long id;\n\n    private String name;\n\n    @Mapping("binaryData")\n    private String data;\n\n    @Mapping("pk")\n    public Long getId() {\n        return this.id;\n    }\n\n    //å¶ä½getter/setteræ¹æ³ç¥\n}\n\n\nTargetBean.java\n\npublic class TargetBean {\n\n    private String pk;\n\n    private String name;\n\n    private String binaryData;\n\n    //getter/setteræ¹æ³ç¥\n}\n\n\nå®ä¹äºä¸¤ä¸ªç¸äºæ å°ç Java ç±»ï¼åªéè¦å¨æºç±»ä¸­ç¨@Mappingæ è®°åç®æ ç±»ä¸­å¯¹åºçå±æ§å°±å¯ä»¥äºã\n\n@Test\npublic void testAnnotationMapping() {\n SourceBean src = new SourceBean();\n src.setId(7L);\n src.setName("é¦å¾·");\n src.setData("00000111");\n\n TargetBean desc = mapper.map(src, TargetBean.class);\n Assert.assertNotNull(desc);\n}\n\n\næµè¯ä¸ä¸ï¼ç»¿ç¯éè¿ã\n\nå®æ¹ææ¡£è¯´ï¼è½ç¶å½åçæ¬ï¼ææ¡£ççæ¬å¯¹åº Dozer 5.5.1ï¼ä»æ¯æ@Mappingï¼ä½æ¯å¨æªæ¥çåå¸çæ¬ä¼æä¾å¶ä»çæ³¨è§£åè½ï¼é£å°±æ¬è¯·æå¾å§ï¼åæ¬¡åæ§½ä¸ä¸ï¼ä¸å¹´å¤æ²¡æ´æ°äºï¼ã\n\n\n# ç¨ API æ¥éç½®æ å°\n\nä¸ªäººè§å¾è¿ç§æ¹å¼æ¯è¾éº»ç¦ï¼ä¸æ¨èï¼ä¹ä¸æ³å¤åä»ç»ï¼å°±æ¯è¿ä¹ä»»æ§ã\n\n\n# ç¨ XML æ¥éç½®æ å°\n\néè¦å¼ºè°çæ¯ï¼å¦æä¸¤ä¸ªç±»çææå±æ§é½è½å¾å¥½çäºè½¬ï¼å¯ä»¥ä½ ä¸­ææï¼æä¸­æä½ ï¼ä¸åå½¼æ­¤ï¼é£ä¹å°±ä¸è¦ç»èæ·»è¶³çå¨ xml ä¸­å»å£°ææ å°è§åäºã\n\n# å±æ§åä¸åæ¶çæ å°(Basic Property Mapping)\n\nDozer ä¼èªå¨æ å°å±æ§åç¸åçå±æ§ï¼æä»¥ä¸å¿æ·»å å¨ xml æä»¶ä¸­ã\n\n<field>\n  <a>one</a>\n  <b>onePrime</b>\n</field>\n\n\n# å­ç¬¦ä¸²åæ¥ææ å°(String to Date Mapping)\n\nå­ç¬¦ä¸²å¨åæ¥æè¿è¡æ å°æ¶ï¼åè®¸ç¨æ·æå®æ¥æçæ ¼å¼ã\n\næ ¼å¼çè®¾ç½®åä¸ºä¸ä¸ªä½ç¨åçº§å«ï¼\n\nå±æ§çº§å«\n\nå¯¹å½åå±æ§ææï¼è¿ä¸ªå±æ§å¿é¡»æ¯æ¥æå­ç¬¦ä¸²ï¼\n\n<field>\n  <a date-format="MM/dd/yyyy HH:mm:ss:SS">dateString</a>\n  <b>dateObject</b>\n</field>\n\n\nç±»çº§å«\n\nå¯¹è¿ä¸ªç±»ä¸­çæææ¥æç¸å³çå±æ§ææ\n\n<mapping date-format="MM-dd-yyyy HH:mm:ss">\n  <class-a>org.dozer.vo.TestObject</class-a>\n  <class-b>org.dozer.vo.TestObjectPrime</class-b>\n  <field>\n    <a>dateString</a>\n    <b>dateObject</b>\n  </field>\n</mapping>\n\n\nå¨å±çº§å«\n\nå¯¹æ´ä¸ªæä»¶ä¸­çæææ¥æç¸å³çå±æ§ææã\n\n<mappings>\n  <configuration>\n    <date-format>MM/dd/yyyy HH:mm</date-format>\n  </configuration>\n\n  <mapping wildcard="true">\n    <class-a>org.dozer.vo.TestObject</class-a>\n    <class-b>org.dozer.vo.TestObjectPrime</class-b>\n    <field>\n      <a>dateString</a>\n      <b>dateObject</b>\n    </field>\n  </mapping>\n</mappings>\n\n\n# éååæ°ç»æ å°(Collection and Array Mapping)\n\nDozer å¯ä»¥èªå¨å¤çä»¥ä¸ç±»åçååè½¬æ¢ã\n\n * List to List\n * List to Array\n * Array to Array\n * Set to Set\n * Set to Array\n * Set to List\n\nä½¿ç¨ hint\n\nå¦æä½¿ç¨æ³åææ°ç»ï¼æ²¡æå¿è¦ä½¿ç¨ hintã\n\nå¦æä¸ä½¿ç¨æ³åææ°ç»ãå¨å¤çéåææ°ç»ä¹é´çè½¬æ¢æ¶ï¼ä½ éè¦ç¨hintæå®ç®æ åè¡¨çæ°æ®ç±»åã\n\nè¥ä½ ä¸æå®hintï¼Dozer å°è®¤ä¸ºç®æ éååæºéåçç±»åæ¯ä¸è´çã\n\nä½¿ç¨ Hints çèä¾ï¼\n\n<field>\n  <a>hintList</a>\n  <b>hintList</b>\n  <b-hint>org.dozer.vo.TheFirstSubClassPrime</b-hint>\n</field>\n\n\nç´¯è®¡æ å°åéç´¯è®¡æ å°ï¼Cumulative vs. Non-Cumulative List Mappingï¼\n\nå¦æä½ è¦è½¬æ¢çç®æ ç±»å·²ç»åå§åï¼ä½ å¯ä»¥éæ©è®© Dozer æ·»å ææ´æ°å¯¹è±¡å°ä½ çéåä¸­ã\n\nèè¿åå³äºrelationship-typeéç½®ï¼é»è®¤æ¯ç´¯è®¡ã\n\nå®çè®¾ç½®æä½ç¨åçº§å«ï¼\n\n * å¨å±çº§\n\n<mappings>\n  <configuration>\n     <relationship-type>non-cumulative</relationship-type>\n  </configuration>\n</mappings>\n\n\n * ç±»çº§å«\n\n<mappings>\n  <mapping relationship-type="non-cumulative">\n    \x3c!-- çç¥ --\x3e\n  </mapping>\n</mappings>\n\n\n * å±æ§çº§å«\n\n<field relationship-type="cumulative">\n  <a>hintList</a>\n  <b>hintList</b>\n  <a-hint>org.dozer.vo.TheFirstSubClass</a-hint>\n  <b-hint>org.dozer.vo.TheFirstSubClassPrime</b-hint>\n</field>\n\n\nç§»å¨å­¤å¿(Removing Orphans)\n\nè¿éçå­¤å¿æ¯æç®æ éåä¸­å­å¨ï¼ä½æ¯æºéåä¸­ä¸å­å¨çåç´ ã\n\nä½ å¯ä»¥ä½¿ç¨remove-orphanså¼å³æ¥éæ©æ¯å¦ç§»é¤è¿æ ·çåç´ ã\n\n<field remove-orphans="true">\n  <a>srcList</a>\n  <b>destList</b>\n</field>\n\n\n# æ·±åº¦æ å°(Deep Mapping)\n\næè°æ·±åº¦æ å°ï¼æ¯æåè®¸ä½ æå®å±æ§çå±æ§ï¼æ¯å¦ä¸ä¸ªç±»çå±æ§æ¬èº«ä¹æ¯ä¸ä¸ªç±»ï¼ãä¸¾ä¾æ¥è¯´\n\nSource.java\n\npublic class Source {\n private long id;\n    private String info;\n}\n\n\nDest.java\n\npublic class Dest {\n private long id;\n    private Info info;\n}\n\n\npublic class Info {\n private String content;\n}\n\n\næ å°è§å\n\n<mapping>\n  <class-a>org.zp.notes.spring.common.dozer.vo.Source</class-a>\n  <class-b>org.zp.notes.spring.common.dozer.vo.Dest</class-b>\n  <field>\n    <a>info</a>\n    <b>info.content</b>\n  </field>\n</mapping>\n\n\n# æé¤å±æ§(Excluding Fields)\n\nå°±åä»»ä½å¢ä½é½ææ£ä¹±åå­ï¼ç±»ä¹é´è½¬æ¢æ¶ä¹ææ³è¦æé¤çå å­ã\n\nå¦ä½å¨åç±»åè½¬æ¢æ¶ï¼èªå¨æé¤ä¸äºå±æ§ï¼Dozer æä¾äºå ç§æ¹æ³ï¼è¿éåªä»ç»ä¸ç§æ¯è¾éç¨çæ¹æ³ã\n\næ´å¤è¯¦æåèå®ç½ã\n\nfield-exclude å¯ä»¥æé¤ä¸éè¦æ å°çå±æ§ã\n\n<field-exclude>\n  <a>fieldToExclude</a>\n  <b>fieldToExclude</b>\n</field-exclude>\n\n\n# ååæ å°(One-Way Mapping)\n\næ³¨ï¼æ¬æçæ å°æ¹å¼ï¼æ ç¹æ®è¯´æï¼é½æ¯ååæ å°çã\n\næçåºæ¯å¯è½å¸æè½¬æ¢è¿ç¨ä¸å¯éï¼å³ååè½¬æ¢ã\n\nååè½¬æ¢å¯ä»¥éè¿ä½¿ç¨one-wayæ¥å¼å¯\n\nç±»çº§å«\n\n<mapping type="one-way">\n  <class-a>org.dozer.vo.TestObjectFoo</class-a>\n  <class-b>org.dozer.vo.TestObjectFooPrime</class-b>\n    <field>\n      <a>oneFoo</a>\n      <b>oneFooPrime</b>\n    </field>\n</mapping>\n\n\nå±æ§çº§å«\n\n<mapping>\n  <class-a>org.dozer.vo.TestObjectFoo2</class-a>\n  <class-b>org.dozer.vo.TestObjectFooPrime2</class-b>\n  <field type="one-way">\n    <a>oneFoo2</a>\n    <b>oneFooPrime2</b>\n  </field>\n\n  <field type="one-way">\n    <a>oneFoo3.prime</a>\n    <b>oneFooPrime3</b>\n  </field>\n\n\n# å¨å±éç½®(Global Configuration)\n\nå¨å±éç½®ç¨æ¥è®¾ç½®å¨å±çéç½®ä¿¡æ¯ãæ­¤å¤ï¼ä»»ä½å®å¶è½¬æ¢é½æ¯å¨è¿éå®ä¹çã\n\nå¨å±éç½®é½æ¯å¯éçã\n\n * <date-format>è¡¨ç¤ºæ¥ææ ¼å¼\n * <stop-on-errors>éè¯¯å¤çå¼å³\n * <wildcard>ééç¬¦\n * <trim-strings>è£åªå­ç¬¦ä¸²å¼å³\n\n<configuration >\n\n  <date-format>MM/dd/yyyy HH:mm</date-format>\n  <stop-on-errors>true</stop-on-errors>\n  <wildcard>true</wildcard>\n  <trim-strings>false</trim-strings>\n\n  <custom-converters> \x3c!-- these are always bi-directional --\x3e\n    <converter type="org.dozer.converters.TestCustomConverter" >\n      <class-a>org.dozer.vo.TestCustomConverterObject</class-a>\n      <class-b>another.type.to.Associate</class-b>\n    </converter>\n\n  </custom-converters>\n</configuration>\n\n\nå¨å±éç½®çä½ç¨æ¯å¸®å©ä½ å°éç½®ä¸äºåæ°ï¼å¦æä¸ªå«ç±»çæ å°è§åéè¦åæ´ï¼ä½ å¯ä»¥ mapping ä¸­è¦çå®ã\n\nè¦ççèä¾å¦ä¸\n\n<mapping date-format="MM-dd-yyyy HH:mm:ss">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n<mapping wildcard="false">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n<mapping stop-on-errors="false">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n<mapping trim-strings="true">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n\n# å®å¶è½¬æ¢(Custom Converters)\n\nå¦æ Dozer é»è®¤çè½¬æ¢è§åä¸è½æ»¡è¶³å®ééè¦ï¼ä½ å¯ä»¥éæ©å®å¶è½¬æ¢ã\n\nå®å¶è½¬æ¢éè¿éç½® XML æ¥åè¯ Dozer å¦ä½å»è½¬æ¢ä¸¤ä¸ªæå®çç±»ãå½ Dozer è½¬æ¢è¿ä¸¤ä¸ªæå®ç±»çæ¶åï¼ä¼è°ç¨ä½ çæ å°è§åå»æ¿æ¢æ åæ å°è§åã\n\nä¸ºäºè®© Dozer è¯å«ï¼ä½ å¿é¡»å®ç°org.dozer.CustomConverteræ¥å£ãå¦åï¼Dozer ä¼æå¼å¸¸ã\n\nå·ä½åæ³ï¼\n\n(1) åå»ºä¸ä¸ªç±»å®ç°org.dozer.CustomConverteræ¥å£ã\n\npublic class TestCustomConverter implements CustomConverter {\n\n  public Object convert(Object destination, Object source,\n      Class destClass, Class sourceClass) {\n    if (source == null) {\n      return null;\n    }\n    CustomDoubleObject dest = null;\n    if (source instanceof Double) {\n      // check to see if the object already exists\n      if (destination == null) {\n        dest = new CustomDoubleObject();\n      } else {\n        dest = (CustomDoubleObject) destination;\n      }\n      dest.setTheDouble(((Double) source).doubleValue());\n      return dest;\n    } else if (source instanceof CustomDoubleObject) {\n      double sourceObj =\n        ((CustomDoubleObject) source).getTheDouble();\n      return new Double(sourceObj);\n    } else {\n      throw new MappingException("Converter TestCustomConverter "\n          + "used incorrectly. Arguments passed in were:"\n          + destination + " and " + source);\n    }\n  }\n\n\n(2) å¨ xml ä¸­å¼ç¨å®å¶çæ å°è§å\n\nå¼ç¨å®å¶çæ å°è§åä¹æ¯åçº§çï¼ä½ å¯ä»¥éæä½¿ç¨ã\n\n * å¨å±çº§\n\n<?xml version="1.0" encoding="UTF-8"?>\n<mappings xmlns="http://dozer.sourceforge.net"\n          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n          xsi:schemaLocation="http://dozer.sourceforge.net\n          http://dozer.sourceforge.net/schema/beanmapping.xsd">\n  <configuration>\n    \x3c!-- æ»æ¯ååè½¬æ¢ç --\x3e\n    <custom-converters>\n      <converter type="org.dozer.converters.TestCustomConverter" >\n        <class-a>org.dozer.vo.CustomDoubleObject</class-a>\n        <class-b>java.lang.Double</class-b>\n      </converter>\n\n      \x3c!-- You are responsible for mapping everything between\n           ClassA and ClassB --\x3e\n      <converter\n        type="org.dozer.converters.TestCustomHashMapConverter" >\n        <class-a>org.dozer.vo.TestCustomConverterHashMapObject</class-a>\n        <class-b>org.dozer.vo.TestCustomConverterHashMapPrimeObject</class-b>\n      </converter>\n    </custom-converters>\n  </configuration>\n</mappings>\n\n\n * å±æ§çº§\n\n<mapping>\n  <class-a>org.dozer.vo.SimpleObj</class-a>\n  <class-b>org.dozer.vo.SimpleObjPrime2</class-b>\n  <field custom-converter=\n    "org.dozer.converters.TestCustomConverter">\n    <a>field1</a>\n    <b>field1Prime</b>\n  </field>\n</mapping>\n\n\n# æ å°çç»§æ¿(Inheritance Mapping)\n\nDozer æ¯ææ å°è§åçç»§æ¿æºå¶ã\n\nå±æ§å¦ææçç¸åçåå­åä¸éè¦å¨ xml ä¸­éç½®ï¼é¤éä½¿ç¨äºhint\n\næä»¬æ¥çä¸ä¸ªä¾å­\n\n<mapping>\n  <class-a>org.dozer.vo.SuperClass</class-a>\n  <class-b>org.dozer.vo.SuperClassPrime</class-b>\n\n  <field>\n    <a>superAttribute</a>\n    <b>superAttr</b>\n  </field>\n</mapping>\n\n<mapping>\n  <class-a>org.dozer.vo.SubClass</class-a>\n  <class-b>org.dozer.vo.SubClassPrime</class-b>\n\n  <field>\n    <a>attribute</a>\n    <b>attributePrime</b>\n  </field>\n</mapping>\n\n<mapping>\n  <class-a>org.dozer.vo.SubClass2</class-a>\n  <class-b>org.dozer.vo.SubClassPrime2</class-b>\n\n  <field>\n    <a>attribute2</a>\n    <b>attributePrime2</b>\n  </field>\n</mapping>\n\n\nå¨ä¸é¢çä¾å­ä¸­ SubClassãSubClass2 æ¯ SuperClass çå­ç±»ï¼\n\nSubClassPrime å SubClassPrime2 æ¯ SuperClassPrime çå­ç±»ã\n\nsuperAttribute å superAttr çæ å°è§åä¼è¢«å­ç±»æç»§æ¿ï¼æä»¥ä¸å¿åéå¤çå¨å­ç±»ä¸­å»å£°æã\n\n\n# åè\n\nDozer å®æ¹ææ¡£ | Dozer æºç å°å',normalizedContent:'# dozer å¿«éå¥é¨\n\nè¿ç¯æç« æ¯æ¬äººå¨éè¯» dozer å®æ¹ææ¡£ï¼5.5.1 çæ¬ï¼å®ç½å·²ç»ä¸å¹´å¤æ²¡æ´æ°äºï¼çè¿ç¨ä¸­ï¼æ´çä¸æ¥æè®¤ä¸ºæ¯è¾åºç¡çåºç¨åºæ¯ã\n\næ¬æä¸­æå°çä¾å­åºè¯¥è½è¦ç javabean æ å°çå¤§é¨ååºæ¯ï¼å¸æå¯¹ä½ ææå¸®å©ã\n\n\n# ç®ä»\n\ndozer æ¯ä»ä¹?\n\ndozer æ¯ä¸ä¸ª javabean æ å°å·¥å·åºã\n\nå®æ¯æç®åçå±æ§æ å°ï¼å¤æç±»åæ å°ï¼ååæ å°ï¼éå¼æ¾å¼çæ å°ï¼ä»¥åéå½æ å°ã\n\nå®æ¯æä¸ç§æ å°æ¹å¼ï¼æ³¨è§£ãapiãxmlã\n\nå®æ¯å¼æºçï¼éµä»apache 2.0 åè®®\n\n\n# å®è£\n\n\n# å¼å¥ jar å\n\nmaven æ¹å¼\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ mavenï¼æ·»å ä»¥ä¸ä¾èµå°ä½ ç pom.xml å³å¯ï¼\n\n<dependency>\n    <groupid>net.sf.dozer</groupid>\n    <artifactid>dozer</artifactid>\n    <version>5.4.0</version>\n</dependency>\n\n\né maven æ¹å¼\n\nå¦æä½ çé¡¹ç®ä¸ä½¿ç¨ mavenï¼é£å°±åªè½åæ¬ä¸æè¦ä¸æç´¯çç²¾ç¥äºã\n\nä½¿ç¨ dozer éè¦å¼å¥ dozer ç jar åä»¥åå¶ä¾èµçç¬¬ä¸æ¹ jar åã\n\n * dozer\n * dozer ä¾èµçç¬¬ä¸æ¹ jar å\n\n\n# eclipse æä»¶\n\ndozer ææä»¶å¯ä»¥å¨ eclipse ä¸­ä½¿ç¨(ä¸ç¥éæ¯å¦å¥½ç¨ï¼åæ­£ææ²¡ç¨è¿)\n\næä»¶å°å: http://dozer.sourceforge.net/eclipse-plugin\n\n\n# ä½¿ç¨\n\nå° dozer å¼å¥å°å·¥ç¨ä¸­åï¼æä»¬å°±å¯ä»¥æ¥å°è¯ä¸çªäºã\n\nå®è·µåºçç¥ï¼åä»¥ä¸ä¸ªæç®åçä¾å­æ¥å±ç¤º dozer æ å°çå¤çè¿ç¨ã\n\n\n# åå¤\n\næä»¬ååå¤ä¸¤ä¸ªè¦äºç¸æ å°çç±»\n\nnotsameattributea.java\n\npublic class notsameattributea {\n    private long id;\n    private string name;\n    private date date;\n\n    // çç¥getter/setter\n}\n\n\nnotsameattributeb.java\n\npublic class notsameattributeb {\n    private long id;\n    private string value;\n    private date date;\n\n    // çç¥getter/setter\n}\n\n\nè¿ä¸¤ä¸ªç±»å­å¨å±æ§åä¸å®å¨ç¸åçæåµï¼name å valueã\n\n\n# dozer çéç½®\n\n# ä¸ºä»ä¹è¦ææ å°éç½®?\n\nå¦æè¦æ å°çä¸¤ä¸ªå¯¹è±¡æå®å¨ç¸åçå±æ§åï¼é£ä¹ä¸åé½å¾ç®åã\n\nåªéè¦ç´æ¥ä½¿ç¨ dozer ç api å³å¯ï¼\n\nmapper mapper = new dozerbeanmapper();\ndestinationobject destobject =\n    mapper.map(sourceobject, destinationobject.class);\n\n\nä½å®éæ å°æ¶ï¼å¾å¾å­å¨å±æ§åä¸åçæåµã\n\næä»¥ï¼ä½ éè¦ä¸äºéç½®æ¥åè¯ dozer åºè¯¥è½¬æ¢ä»ä¹ï¼æä¹è½¬æ¢ã\n\næ³¨ï¼å®ç½çéå»ºè®®ï¼å¨ç°å®åºç¨ä¸­ï¼æå¥½ä¸è¦æ¯æ¬¡æ å°å¯¹è±¡æ¶é½åå»ºä¸ä¸ªmapperå®ä¾æ¥å·¥ä½ï¼è¿æ ·ä¼äº§çä¸å¿è¦çå¼éãå¦æä½ ä¸ä½¿ç¨ ioc å®¹å¨ï¼å¦ï¼springï¼æ¥ç®¡çä½ çé¡¹ç®ï¼é£ä¹ï¼æå¥½å°mapperå®ä¹ä¸ºåä¾æ¨¡å¼ã\n\n# æ å°éç½®æä»¶\n\nå¨src/test/resourcesç®å½ä¸æ·»å dozer/dozer-mapping.xmlæä»¶ã <mapping>æ ç­¾ä¸­åè®¸ä½ å®ä¹<class-a>å<class-b>ï¼å¯¹åºçç¸äºæ å°çç±»ã <field>æ ç­¾éå®ä¹è¦æ å°çç¹æ®å±æ§ãéè¦æ³¨æ<a>å<class-a>å¯¹åºï¼<b>å<class-b>å¯¹åºï¼èªæçä½ ï¼çä¹çåºæ¥äºå§ã\n\n<?xml version="1.0" encoding="utf-8"?>\n<mappings xmlns="http://dozer.sourceforge.net" xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n          xsi:schemalocation="http://dozer.sourceforge.net\n          http://dozer.sourceforge.net/schema/beanmapping.xsd">\n  <mapping date-format="yyyy-mm-dd">\n    <class-a>org.zp.notes.spring.common.dozer.vo.notsameattributea</class-a>\n    <class-b>org.zp.notes.spring.common.dozer.vo.notsameattributeb</class-b>\n    <field>\n      <a>name</a>\n      <b>value</b>\n    </field>\n  </mapping>\n</mappings>\n\n\n\n# ä¸ spring æ´å\n\n# éç½® dozerbeanmapperfactorybean\n\nå¨src/test/resourcesç®å½ä¸æ·»å spring/spring-dozer.xmlæä»¶ã\n\ndozer ä¸ spring çæ´åå¾ä¾¿å©ï¼ä½ åªéè¦å£°æä¸ä¸ªdozerbeanmapperfactorybeanï¼ å°ææç dozer æ å°éç½®æä»¶ä½ä¸ºå±æ§æ³¨å¥å°mappingfilesï¼ dozerbeanmapperfactorybeanä¼å è½½è¿äºè§åã\n\nspring-dozer.xml æä»¶èä¾\n\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n       xsi:schemalocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-2.0.xsd"\n       default-autowire="byname" default-lazy-init="false">\n\n  <bean id="mapper" class="org.dozer.spring.dozerbeanmapperfactorybean">\n    <property name="mappingfiles">\n      <list>\n        <value>classpath*:dozer/dozer-mapping.xml</value>\n      </list>\n    </property>\n  </bean>\n</beans>\n\n\n# èªå¨è£é\n\nè³æ­¤ï¼ä¸äºå·å¤ï¼ä½ åªéè¦èªå¨è£émapperã\n\nrunwith(springjunit4classrunner.class)\n@contextconfiguration(locations = {"classpath:spring/spring-dozer.xml"})\n@transactionconfiguration(defaultrollback = false)\npublic class dozertest extends testcase {\n    @autowired\n    mapper mapper;\n\n    @test\n    public void testnotsameattributemapping() {\n        notsameattributea src = new notsameattributea();\n        src.setid(007);\n        src.setname("é¦å¾·");\n        src.setdate(new date());\n\n        notsameattributeb desc = mapper.map(src, notsameattributeb.class);\n        assert.assertnotnull(desc);\n    }\n}\n\n\nè¿è¡ä¸ä¸ååæµè¯ï¼ç»¿ç¯éè¿ã\n\n\n# dozer æ¯æçæ°æ®ç±»åè½¬æ¢\n\ndozer å¯ä»¥èªå¨åæ°æ®ç±»åè½¬æ¢ãå½åï¼dozer æ¯æä»¥ä¸æ°æ®ç±»åè½¬æ¢ï¼é½æ¯ååçï¼\n\n * primitive to primitive wrapper\n   \n   åå(intãlong ç­)ååååè£ç±»(integerãlong)\n\n * primitive to custom wrapper\n   \n   åååå®å¶çåè£\n\n * primitive wrapper to primitive wrapper\n   \n   åååè£ç±»ååè£ç±»\n\n * primitive to primitive\n   \n   ååååå\n\n * complex type to complex type\n   \n   å¤æç±»ååå¤æç±»å\n\n * string to primitive\n   \n   å­ç¬¦ä¸²ååå\n\n * string to primitive wrapper\n   \n   å­ç¬¦ä¸²ååååè£ç±»\n\n * string to complex type if the complex type contains a string constructor\n   \n   å­ç¬¦ä¸²åæå­ç¬¦ä¸²æé å¨çå¤æç±»åï¼ç±»ï¼\n\n * string to map\n   \n   å­ç¬¦ä¸²å map\n\n * collection to collection\n   \n   éååéå\n\n * collection to array\n   \n   éååæ°ç»\n\n * map to complex type\n   \n   map åå¤æç±»å\n\n * map to custom map type\n   \n   map åå®å¶ map ç±»å\n\n * enum to enum\n   \n   æä¸¾åæä¸¾\n\n * each of these can be mapped to one another: java.util.date, java.sql.date, java.sql.time, java.sql.timestamp, java.util.calendar, java.util.gregoriancalendar\n   \n   è¿äºæ¶é´ç¸å³çå¸¸è§ç±»å¯ä»¥äºæ¢ï¼java.util.date, java.sql.date, java.sql.time, java.sql.timestamp, java.util.calendar, java.util.gregoriancalendar\n\n * string to any of the supported date/calendar objects.\n   \n   å­ç¬¦ä¸²åæ¯æ date/calendar çå¯¹è±¡\n\n * objects containing a tostring() method that produces a long representing time in (ms) to any supported date/calendar object.\n   \n   å¦æä¸ä¸ªå¯¹è±¡ç tostring()æ¹æ³è¿åçæ¯ä¸ä¸ªä»£è¡¨ long åçæ¶é´æ°å¼ï¼åä½ï¼msï¼ï¼å°±å¯ä»¥åä»»ä½æ¯æ date/calendar çå¯¹è±¡è½¬æ¢ã\n\n\n# dozer çæ å°éç½®\n\nå¨åé¢çç®åä¾å­ä¸­ï¼æä»¬ä½éªäºä¸æ dozer çæ å°æµç¨ãä½æ¯ä¸¤ä¸ªç±»è¿è¡æ å°ï¼æå¾å¤å¤æçæåµï¼ç¸åºçï¼ä½ ä¹éè¦ä¸äºæ´å¤æçéç½®ã\n\ndozer æä¸ç§æ å°éç½®æ¹å¼ï¼\n\n * æ³¨è§£æ¹å¼\n * api æ¹å¼\n * xml æ¹å¼\n\n\n# ç¨æ³¨è§£æ¥éç½®æ å°\n\ndozer 5.3.2çæ¬å¼å§æ¯ææ³¨è§£æ¹å¼éç½®æ å°ï¼åªæä¸ä¸ªæ³¨è§£ï¼@mappingï¼ãå¯ä»¥åºå¯¹ä¸äºç®åçæ å°å¤çï¼å¤æçå°±ç©ä¸è½¬äºã\n\nçä¸ä¸@mappingçå£°æå°±å¯ä»¥ç¥éï¼è¿ä¸ªæ³¨è§£åªè½ç¨äºåç´ åæ¹æ³ã\n\n@retention(retentionpolicy.runtime)\n@target({elementtype.field, elementtype.method})\npublic @interface mapping {\n  string value() default "";\n}\n\n\nè®©æä»¬æ¥è¯è¯å§ï¼\n\ntargetbean.java\n\npublic class sourcebean {\n\n    private long id;\n\n    private string name;\n\n    @mapping("binarydata")\n    private string data;\n\n    @mapping("pk")\n    public long getid() {\n        return this.id;\n    }\n\n    //å¶ä½getter/setteræ¹æ³ç¥\n}\n\n\ntargetbean.java\n\npublic class targetbean {\n\n    private string pk;\n\n    private string name;\n\n    private string binarydata;\n\n    //getter/setteræ¹æ³ç¥\n}\n\n\nå®ä¹äºä¸¤ä¸ªç¸äºæ å°ç java ç±»ï¼åªéè¦å¨æºç±»ä¸­ç¨@mappingæ è®°åç®æ ç±»ä¸­å¯¹åºçå±æ§å°±å¯ä»¥äºã\n\n@test\npublic void testannotationmapping() {\n sourcebean src = new sourcebean();\n src.setid(7l);\n src.setname("é¦å¾·");\n src.setdata("00000111");\n\n targetbean desc = mapper.map(src, targetbean.class);\n assert.assertnotnull(desc);\n}\n\n\næµè¯ä¸ä¸ï¼ç»¿ç¯éè¿ã\n\nå®æ¹ææ¡£è¯´ï¼è½ç¶å½åçæ¬ï¼ææ¡£ççæ¬å¯¹åº dozer 5.5.1ï¼ä»æ¯æ@mappingï¼ä½æ¯å¨æªæ¥çåå¸çæ¬ä¼æä¾å¶ä»çæ³¨è§£åè½ï¼é£å°±æ¬è¯·æå¾å§ï¼åæ¬¡åæ§½ä¸ä¸ï¼ä¸å¹´å¤æ²¡æ´æ°äºï¼ã\n\n\n# ç¨ api æ¥éç½®æ å°\n\nä¸ªäººè§å¾è¿ç§æ¹å¼æ¯è¾éº»ç¦ï¼ä¸æ¨èï¼ä¹ä¸æ³å¤åä»ç»ï¼å°±æ¯è¿ä¹ä»»æ§ã\n\n\n# ç¨ xml æ¥éç½®æ å°\n\néè¦å¼ºè°çæ¯ï¼å¦æä¸¤ä¸ªç±»çææå±æ§é½è½å¾å¥½çäºè½¬ï¼å¯ä»¥ä½ ä¸­ææï¼æä¸­æä½ ï¼ä¸åå½¼æ­¤ï¼é£ä¹å°±ä¸è¦ç»èæ·»è¶³çå¨ xml ä¸­å»å£°ææ å°è§åäºã\n\n# å±æ§åä¸åæ¶çæ å°(basic property mapping)\n\ndozer ä¼èªå¨æ å°å±æ§åç¸åçå±æ§ï¼æä»¥ä¸å¿æ·»å å¨ xml æä»¶ä¸­ã\n\n<field>\n  <a>one</a>\n  <b>oneprime</b>\n</field>\n\n\n# å­ç¬¦ä¸²åæ¥ææ å°(string to date mapping)\n\nå­ç¬¦ä¸²å¨åæ¥æè¿è¡æ å°æ¶ï¼åè®¸ç¨æ·æå®æ¥æçæ ¼å¼ã\n\næ ¼å¼çè®¾ç½®åä¸ºä¸ä¸ªä½ç¨åçº§å«ï¼\n\nå±æ§çº§å«\n\nå¯¹å½åå±æ§ææï¼è¿ä¸ªå±æ§å¿é¡»æ¯æ¥æå­ç¬¦ä¸²ï¼\n\n<field>\n  <a date-format="mm/dd/yyyy hh:mm:ss:ss">datestring</a>\n  <b>dateobject</b>\n</field>\n\n\nç±»çº§å«\n\nå¯¹è¿ä¸ªç±»ä¸­çæææ¥æç¸å³çå±æ§ææ\n\n<mapping date-format="mm-dd-yyyy hh:mm:ss">\n  <class-a>org.dozer.vo.testobject</class-a>\n  <class-b>org.dozer.vo.testobjectprime</class-b>\n  <field>\n    <a>datestring</a>\n    <b>dateobject</b>\n  </field>\n</mapping>\n\n\nå¨å±çº§å«\n\nå¯¹æ´ä¸ªæä»¶ä¸­çæææ¥æç¸å³çå±æ§ææã\n\n<mappings>\n  <configuration>\n    <date-format>mm/dd/yyyy hh:mm</date-format>\n  </configuration>\n\n  <mapping wildcard="true">\n    <class-a>org.dozer.vo.testobject</class-a>\n    <class-b>org.dozer.vo.testobjectprime</class-b>\n    <field>\n      <a>datestring</a>\n      <b>dateobject</b>\n    </field>\n  </mapping>\n</mappings>\n\n\n# éååæ°ç»æ å°(collection and array mapping)\n\ndozer å¯ä»¥èªå¨å¤çä»¥ä¸ç±»åçååè½¬æ¢ã\n\n * list to list\n * list to array\n * array to array\n * set to set\n * set to array\n * set to list\n\nä½¿ç¨ hint\n\nå¦æä½¿ç¨æ³åææ°ç»ï¼æ²¡æå¿è¦ä½¿ç¨ hintã\n\nå¦æä¸ä½¿ç¨æ³åææ°ç»ãå¨å¤çéåææ°ç»ä¹é´çè½¬æ¢æ¶ï¼ä½ éè¦ç¨hintæå®ç®æ åè¡¨çæ°æ®ç±»åã\n\nè¥ä½ ä¸æå®hintï¼dozer å°è®¤ä¸ºç®æ éååæºéåçç±»åæ¯ä¸è´çã\n\nä½¿ç¨ hints çèä¾ï¼\n\n<field>\n  <a>hintlist</a>\n  <b>hintlist</b>\n  <b-hint>org.dozer.vo.thefirstsubclassprime</b-hint>\n</field>\n\n\nç´¯è®¡æ å°åéç´¯è®¡æ å°ï¼cumulative vs. non-cumulative list mappingï¼\n\nå¦æä½ è¦è½¬æ¢çç®æ ç±»å·²ç»åå§åï¼ä½ å¯ä»¥éæ©è®© dozer æ·»å ææ´æ°å¯¹è±¡å°ä½ çéåä¸­ã\n\nèè¿åå³äºrelationship-typeéç½®ï¼é»è®¤æ¯ç´¯è®¡ã\n\nå®çè®¾ç½®æä½ç¨åçº§å«ï¼\n\n * å¨å±çº§\n\n<mappings>\n  <configuration>\n     <relationship-type>non-cumulative</relationship-type>\n  </configuration>\n</mappings>\n\n\n * ç±»çº§å«\n\n<mappings>\n  <mapping relationship-type="non-cumulative">\n    \x3c!-- çç¥ --\x3e\n  </mapping>\n</mappings>\n\n\n * å±æ§çº§å«\n\n<field relationship-type="cumulative">\n  <a>hintlist</a>\n  <b>hintlist</b>\n  <a-hint>org.dozer.vo.thefirstsubclass</a-hint>\n  <b-hint>org.dozer.vo.thefirstsubclassprime</b-hint>\n</field>\n\n\nç§»å¨å­¤å¿(removing orphans)\n\nè¿éçå­¤å¿æ¯æç®æ éåä¸­å­å¨ï¼ä½æ¯æºéåä¸­ä¸å­å¨çåç´ ã\n\nä½ å¯ä»¥ä½¿ç¨remove-orphanså¼å³æ¥éæ©æ¯å¦ç§»é¤è¿æ ·çåç´ ã\n\n<field remove-orphans="true">\n  <a>srclist</a>\n  <b>destlist</b>\n</field>\n\n\n# æ·±åº¦æ å°(deep mapping)\n\næè°æ·±åº¦æ å°ï¼æ¯æåè®¸ä½ æå®å±æ§çå±æ§ï¼æ¯å¦ä¸ä¸ªç±»çå±æ§æ¬èº«ä¹æ¯ä¸ä¸ªç±»ï¼ãä¸¾ä¾æ¥è¯´\n\nsource.java\n\npublic class source {\n private long id;\n    private string info;\n}\n\n\ndest.java\n\npublic class dest {\n private long id;\n    private info info;\n}\n\n\npublic class info {\n private string content;\n}\n\n\næ å°è§å\n\n<mapping>\n  <class-a>org.zp.notes.spring.common.dozer.vo.source</class-a>\n  <class-b>org.zp.notes.spring.common.dozer.vo.dest</class-b>\n  <field>\n    <a>info</a>\n    <b>info.content</b>\n  </field>\n</mapping>\n\n\n# æé¤å±æ§(excluding fields)\n\nå°±åä»»ä½å¢ä½é½ææ£ä¹±åå­ï¼ç±»ä¹é´è½¬æ¢æ¶ä¹ææ³è¦æé¤çå å­ã\n\nå¦ä½å¨åç±»åè½¬æ¢æ¶ï¼èªå¨æé¤ä¸äºå±æ§ï¼dozer æä¾äºå ç§æ¹æ³ï¼è¿éåªä»ç»ä¸ç§æ¯è¾éç¨çæ¹æ³ã\n\næ´å¤è¯¦æåèå®ç½ã\n\nfield-exclude å¯ä»¥æé¤ä¸éè¦æ å°çå±æ§ã\n\n<field-exclude>\n  <a>fieldtoexclude</a>\n  <b>fieldtoexclude</b>\n</field-exclude>\n\n\n# ååæ å°(one-way mapping)\n\næ³¨ï¼æ¬æçæ å°æ¹å¼ï¼æ ç¹æ®è¯´æï¼é½æ¯ååæ å°çã\n\næçåºæ¯å¯è½å¸æè½¬æ¢è¿ç¨ä¸å¯éï¼å³ååè½¬æ¢ã\n\nååè½¬æ¢å¯ä»¥éè¿ä½¿ç¨one-wayæ¥å¼å¯\n\nç±»çº§å«\n\n<mapping type="one-way">\n  <class-a>org.dozer.vo.testobjectfoo</class-a>\n  <class-b>org.dozer.vo.testobjectfooprime</class-b>\n    <field>\n      <a>onefoo</a>\n      <b>onefooprime</b>\n    </field>\n</mapping>\n\n\nå±æ§çº§å«\n\n<mapping>\n  <class-a>org.dozer.vo.testobjectfoo2</class-a>\n  <class-b>org.dozer.vo.testobjectfooprime2</class-b>\n  <field type="one-way">\n    <a>onefoo2</a>\n    <b>onefooprime2</b>\n  </field>\n\n  <field type="one-way">\n    <a>onefoo3.prime</a>\n    <b>onefooprime3</b>\n  </field>\n\n\n# å¨å±éç½®(global configuration)\n\nå¨å±éç½®ç¨æ¥è®¾ç½®å¨å±çéç½®ä¿¡æ¯ãæ­¤å¤ï¼ä»»ä½å®å¶è½¬æ¢é½æ¯å¨è¿éå®ä¹çã\n\nå¨å±éç½®é½æ¯å¯éçã\n\n * <date-format>è¡¨ç¤ºæ¥ææ ¼å¼\n * <stop-on-errors>éè¯¯å¤çå¼å³\n * <wildcard>ééç¬¦\n * <trim-strings>è£åªå­ç¬¦ä¸²å¼å³\n\n<configuration >\n\n  <date-format>mm/dd/yyyy hh:mm</date-format>\n  <stop-on-errors>true</stop-on-errors>\n  <wildcard>true</wildcard>\n  <trim-strings>false</trim-strings>\n\n  <custom-converters> \x3c!-- these are always bi-directional --\x3e\n    <converter type="org.dozer.converters.testcustomconverter" >\n      <class-a>org.dozer.vo.testcustomconverterobject</class-a>\n      <class-b>another.type.to.associate</class-b>\n    </converter>\n\n  </custom-converters>\n</configuration>\n\n\nå¨å±éç½®çä½ç¨æ¯å¸®å©ä½ å°éç½®ä¸äºåæ°ï¼å¦æä¸ªå«ç±»çæ å°è§åéè¦åæ´ï¼ä½ å¯ä»¥ mapping ä¸­è¦çå®ã\n\nè¦ççèä¾å¦ä¸\n\n<mapping date-format="mm-dd-yyyy hh:mm:ss">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n<mapping wildcard="false">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n<mapping stop-on-errors="false">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n<mapping trim-strings="true">\n  \x3c!-- çç¥ --\x3e\n</mapping>\n\n\n# å®å¶è½¬æ¢(custom converters)\n\nå¦æ dozer é»è®¤çè½¬æ¢è§åä¸è½æ»¡è¶³å®ééè¦ï¼ä½ å¯ä»¥éæ©å®å¶è½¬æ¢ã\n\nå®å¶è½¬æ¢éè¿éç½® xml æ¥åè¯ dozer å¦ä½å»è½¬æ¢ä¸¤ä¸ªæå®çç±»ãå½ dozer è½¬æ¢è¿ä¸¤ä¸ªæå®ç±»çæ¶åï¼ä¼è°ç¨ä½ çæ å°è§åå»æ¿æ¢æ åæ å°è§åã\n\nä¸ºäºè®© dozer è¯å«ï¼ä½ å¿é¡»å®ç°org.dozer.customconverteræ¥å£ãå¦åï¼dozer ä¼æå¼å¸¸ã\n\nå·ä½åæ³ï¼\n\n(1) åå»ºä¸ä¸ªç±»å®ç°org.dozer.customconverteræ¥å£ã\n\npublic class testcustomconverter implements customconverter {\n\n  public object convert(object destination, object source,\n      class destclass, class sourceclass) {\n    if (source == null) {\n      return null;\n    }\n    customdoubleobject dest = null;\n    if (source instanceof double) {\n      // check to see if the object already exists\n      if (destination == null) {\n        dest = new customdoubleobject();\n      } else {\n        dest = (customdoubleobject) destination;\n      }\n      dest.setthedouble(((double) source).doublevalue());\n      return dest;\n    } else if (source instanceof customdoubleobject) {\n      double sourceobj =\n        ((customdoubleobject) source).getthedouble();\n      return new double(sourceobj);\n    } else {\n      throw new mappingexception("converter testcustomconverter "\n          + "used incorrectly. arguments passed in were:"\n          + destination + " and " + source);\n    }\n  }\n\n\n(2) å¨ xml ä¸­å¼ç¨å®å¶çæ å°è§å\n\nå¼ç¨å®å¶çæ å°è§åä¹æ¯åçº§çï¼ä½ å¯ä»¥éæä½¿ç¨ã\n\n * å¨å±çº§\n\n<?xml version="1.0" encoding="utf-8"?>\n<mappings xmlns="http://dozer.sourceforge.net"\n          xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n          xsi:schemalocation="http://dozer.sourceforge.net\n          http://dozer.sourceforge.net/schema/beanmapping.xsd">\n  <configuration>\n    \x3c!-- æ»æ¯ååè½¬æ¢ç --\x3e\n    <custom-converters>\n      <converter type="org.dozer.converters.testcustomconverter" >\n        <class-a>org.dozer.vo.customdoubleobject</class-a>\n        <class-b>java.lang.double</class-b>\n      </converter>\n\n      \x3c!-- you are responsible for mapping everything between\n           classa and classb --\x3e\n      <converter\n        type="org.dozer.converters.testcustomhashmapconverter" >\n        <class-a>org.dozer.vo.testcustomconverterhashmapobject</class-a>\n        <class-b>org.dozer.vo.testcustomconverterhashmapprimeobject</class-b>\n      </converter>\n    </custom-converters>\n  </configuration>\n</mappings>\n\n\n * å±æ§çº§\n\n<mapping>\n  <class-a>org.dozer.vo.simpleobj</class-a>\n  <class-b>org.dozer.vo.simpleobjprime2</class-b>\n  <field custom-converter=\n    "org.dozer.converters.testcustomconverter">\n    <a>field1</a>\n    <b>field1prime</b>\n  </field>\n</mapping>\n\n\n# æ å°çç»§æ¿(inheritance mapping)\n\ndozer æ¯ææ å°è§åçç»§æ¿æºå¶ã\n\nå±æ§å¦ææçç¸åçåå­åä¸éè¦å¨ xml ä¸­éç½®ï¼é¤éä½¿ç¨äºhint\n\næä»¬æ¥çä¸ä¸ªä¾å­\n\n<mapping>\n  <class-a>org.dozer.vo.superclass</class-a>\n  <class-b>org.dozer.vo.superclassprime</class-b>\n\n  <field>\n    <a>superattribute</a>\n    <b>superattr</b>\n  </field>\n</mapping>\n\n<mapping>\n  <class-a>org.dozer.vo.subclass</class-a>\n  <class-b>org.dozer.vo.subclassprime</class-b>\n\n  <field>\n    <a>attribute</a>\n    <b>attributeprime</b>\n  </field>\n</mapping>\n\n<mapping>\n  <class-a>org.dozer.vo.subclass2</class-a>\n  <class-b>org.dozer.vo.subclassprime2</class-b>\n\n  <field>\n    <a>attribute2</a>\n    <b>attributeprime2</b>\n  </field>\n</mapping>\n\n\nå¨ä¸é¢çä¾å­ä¸­ subclassãsubclass2 æ¯ superclass çå­ç±»ï¼\n\nsubclassprime å subclassprime2 æ¯ superclassprime çå­ç±»ã\n\nsuperattribute å superattr çæ å°è§åä¼è¢«å­ç±»æç»§æ¿ï¼æä»¥ä¸å¿åéå¤çå¨å­ç±»ä¸­å»å£°æã\n\n\n# åè\n\ndozer å®æ¹ææ¡£ | dozer æºç å°å',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Freemark å¿«éå¥é¨",frontmatter:{title:"Freemark å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æ¨¡æ¿å¼æ"],tags:["Java","æ¨¡æ¿å¼æ","Freemark"],abbrlink:"468afcee",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/34ec25/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/03.%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/01.Freemark.html",relativePath:"12.å·¥å·/03.æ¨¡æ¿å¼æ/01.Freemark.md",key:"v-783c66c8",path:"/pages/34ec25/",headers:[{level:2,title:"Freemark ç®ä»",slug:"freemark-ç®ä»",normalizedTitle:"freemark ç®ä»",charIndex:145},{level:2,title:"æ»ä½ç»æ",slug:"æ»ä½ç»æ",normalizedTitle:"æ»ä½ç»æ",charIndex:456},{level:3,title:"æä»¤",slug:"æä»¤",normalizedTitle:"æä»¤",charIndex:823},{level:3,title:"è¡¨è¾¾å¼",slug:"è¡¨è¾¾å¼",normalizedTitle:"è¡¨è¾¾å¼",charIndex:1073},{level:3,title:"åé",slug:"åé",normalizedTitle:"åé",charIndex:1357},{level:2,title:"æ°æ®ç±»å",slug:"æ°æ®ç±»å",normalizedTitle:"æ°æ®ç±»å",charIndex:2450},{level:3,title:"æ é",slug:"æ é",normalizedTitle:"æ é",charIndex:2477},{level:3,title:"å®¹å¨",slug:"å®¹å¨",normalizedTitle:"å®¹å¨",charIndex:2688},{level:3,title:"å­ç¨åº",slug:"å­ç¨åº",normalizedTitle:"å­ç¨åº",charIndex:2715},{level:3,title:"å¶å®",slug:"å¶å®",normalizedTitle:"å¶å®",charIndex:2744},{level:2,title:"è½¬ä¹ç¬¦",slug:"è½¬ä¹ç¬¦",normalizedTitle:"è½¬ä¹ç¬¦",charIndex:2758},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:3075}],headersStr:"Freemark ç®ä» æ»ä½ç»æ æä»¤ è¡¨è¾¾å¼ åé æ°æ®ç±»å æ é å®¹å¨ å­ç¨åº å¶å® è½¬ä¹ç¬¦ åèèµæ",content:'# Freemark å¿«éå¥é¨\n\n> FreeMarker æ¯ä¸æ¬¾æ¨¡æ¿å¼æï¼ å³ä¸ç§åºäºæ¨¡æ¿åè¦æ¹åçæ°æ®ï¼ å¹¶ç¨æ¥çæè¾åºææ¬(HTML ç½é¡µï¼çµå­é®ä»¶ï¼éç½®æä»¶ï¼æºä»£ç ç­)çéç¨å·¥å·ã å®ä¸æ¯é¢åæç»ç¨æ·çï¼èæ¯ä¸ä¸ª Java ç±»åºï¼æ¯ä¸æ¬¾ç¨åºåå¯ä»¥åµå¥ä»ä»¬æå¼åäº§åçç»ä»¶ã\n\n\n# Freemark ç®ä»\n\nFreemark æ¨¡æ¿ç¼åä¸º FreeMarker Template Language (FTL)ãå®æ¯ç®åçï¼ä¸ç¨çè¯­è¨ï¼ ä¸æ¯ å PHP é£æ ·æççç¼ç¨è¯­è¨ãå¨æ¨¡æ¿ä¸­ï¼ä½ å¯ä»¥ä¸æ³¨äºå¦ä½å±ç°æ°æ®ï¼ èå¨æ¨¡æ¿ä¹å¤å¯ä»¥ä¸æ³¨äºè¦å±ç¤ºä»ä¹æ°æ®ã\n\n\n\nè¿ç§æ¹å¼éå¸¸è¢«ç§°ä¸º MVC (æ¨¡å è§å¾ æ§å¶å¨) æ¨¡å¼ï¼å¯¹äºå¨æç½é¡µæ¥è¯´ï¼æ¯ä¸ç§ç¹å«æµè¡çæ¨¡å¼ã å®å¸®å©ä»å¼åäººå(Java ç¨åºå)ä¸­åç¦»åºç½é¡µè®¾è®¡å¸(HTML è®¾è®¡å¸)ãè®¾è®¡å¸æ éé¢å¯¹æ¨¡æ¿ä¸­çå¤æé»è¾ï¼ å¨æ²¡æç¨åºåæ¥ä¿®æ¹æéæ°ç¼è¯ä»£ç æ¶ï¼ä¹å¯ä»¥ä¿®æ¹é¡µé¢çæ ·å¼ã\n\nFreemark æ¨¡æ¿ä¸å¥è¯æ¦æ¬å°±æ¯ï¼æ¨¡æ¿ + æ°æ®æ¨¡å = è¾åº\n\n\n# æ»ä½ç»æ\n\n * ææ¬ï¼ææ¬ä¼ç§çåæ ·æ¥è¾åºã\n * æå¼ï¼è¿é¨åçè¾åºä¼è¢«è®¡ç®çå¼æ¥æ¿æ¢ãæå¼ç± ${ and } æåé(æè #{ and }ï¼è¿ç§é£æ ¼å·²ç»ä¸å»ºè®®åä½¿ç¨äºï¼ç¹å»æ¥çæ´å¤)ã\n * FTL æ ç­¾ï¼FTL æ ç­¾å HTML æ ç­¾å¾ç¸ä¼¼ï¼ä½æ¯å®ä»¬å´æ¯ç» FreeMarker çæç¤ºï¼ èä¸ä¸ä¼æå°å¨è¾åºåå®¹ä¸­ã\n * æ³¨éï¼æ³¨éå HTML çæ³¨éä¹å¾ç¸ä¼¼ï¼ä½å®ä»¬æ¯ç± <#-- å --\x3eæ¥åéçãæ³¨éä¼è¢« FreeMarker ç´æ¥å¿½ç¥ï¼ æ´ä¸ä¼å¨è¾åºåå®¹ä¸­æ¾ç¤ºã\n\n\n\n> ð æ³¨æï¼\n> \n>  * FTL æ¯åºåå¤§å°åçã\n>  * æå¼ ä»ä»å¯ä»¥å¨ ææ¬ ä¸­ä½¿ç¨ã\n>  * FTL æ ç­¾ ä¸å¯ä»¥å¨å¶ä» FTL æ ç­¾ å æå¼ ä¸­ä½¿ç¨ã\n>  * æ³¨é å¯ä»¥æ¾å¨ FTL æ ç­¾ å æå¼ ä¸­ã\n\n\n# æä»¤\n\nFTL æä»¤æä¸¤ç§ç±»åï¼ é¢å®ä¹æä»¤ å ç¨æ·èªå®ä¹æä»¤ã å¯¹äºç¨æ·èªå®ä¹çæä»¤ä½¿ç¨ @ æ¥ä»£æ¿ #ã\n\n> ð æ³¨æï¼\n> \n>  * FreeMarker ä»ä»å³å¿ FTL æ ç­¾çåµå¥èä¸å³å¿ HTML æ ç­¾çåµå¥ã å®åªä¼æ HTML çåæ¯ææ¬ï¼ä¸ä¼æ¥è§£é HTMLã\n>  * å¦æä½ å°è¯ä½¿ç¨ä¸ä¸ªä¸å­å¨çæä»¤(æ¯å¦ï¼è¾éäºæä»¤çåç§°)ï¼ FreeMarker å°±ä¼æç»æ§è¡æ¨¡æ¿ï¼åæ¶æåºéè¯¯ä¿¡æ¯ã\n>  * FreeMarker ä¼å¿½ç¥ FTL æ ç­¾ä¸­å¤ä½ç ç©ºç½æ è®°ã\n\n\n# è¡¨è¾¾å¼\n\nä»¥ä¸ä¸ºå¿«éæµè§æ¸åï¼å¦æéè¦äºè§£æ´å¤ç»èï¼è¯·åèè¿éã\n\n * ç´æ¥æå®å¼\n   * å­ç¬¦ä¸²ï¼ "Foo" æè \'Foo\' æè "It\'s \\"quoted\\"" æè \'It\\\'s "quoted"\' æè r"C:\\raw\\string"\n   * æ°å­ï¼ 123.45\n   * å¸å°å¼ï¼ trueï¼ false\n   * åºåï¼ ["foo", "bar", 123.45]ï¼ å¼åï¼ 0..9, 0..<10 (æ 0..!10), 0..\n   * åå¸è¡¨ï¼ {"name":"green mouse", "price":150}\n * æ£ç´¢åé\n   * é¡¶å±åéï¼ user\n   * ä»åå¸è¡¨ä¸­æ£ç´¢æ°æ®ï¼ user.nameï¼ user["name"]\n   * ä»åºåä¸­æ£ç´¢æ°æ®ï¼ products[5]\n   * ç¹æ®åéï¼ .main\n * å­ç¬¦ä¸²æä½\n   * æå¼(æè¿æ¥)ï¼ "Hello ${user}!" (æ "Hello " + user + "!")\n   * è·åä¸ä¸ªå­ç¬¦ï¼ name[0]\n   * å­ç¬¦ä¸²ååï¼ åå«ç»å°¾ï¼ name[0..4]ï¼ä¸åå«ç»å°¾ï¼ name[0..<5]ï¼åºäºé¿åº¦(å®½å®¹å¤ç)ï¼ name[0..*5]ï¼å»é¤å¼å¤´ï¼name[5..]\n * åºåæä½\n   * è¿æ¥ï¼ users + ["guest"]\n   * åºåååï¼åå«ç»å°¾ï¼ products[20..29]ï¼ ä¸åå«ç»å°¾ï¼ products[20..<30]ï¼åºäºé¿åº¦(å®½å®¹å¤ç)ï¼products[20..*10]ï¼å»é¤å¼å¤´ï¼ products[20..]\n * åå¸è¡¨æä½\n   * è¿æ¥ï¼ passwords + { "joe": "secret42" }\n * ç®æ¯è¿ç®ï¼ (x * 1.5 + 10) / 2 - y % 100\n * æ¯è¾è¿ç®ï¼ x == yï¼ x != yï¼ x < yï¼ x > yï¼ x >= yï¼ x <= yï¼ x lt yï¼ x lte yï¼ x gt yï¼ x gte yï¼ ç­ç­ãããããã\n * é»è¾æä½ï¼ !registered && (firstVisit || fromEurope)\n * åå»ºå½æ°ï¼ name?upper_case, path?ensure_starts_with(\'/\')\n * æ¹æ³è°ç¨ï¼ repeat("What", 3)\n * å¤çä¸å­å¨çå¼\n   * é»è®¤å¼ï¼ name!"unknown" æè (user.name)!"unknown" æè name! æè (user.name)!\n   * æ£æµä¸å­å¨çå¼ï¼ name?? æè (user.name)??\n * èµå¼æä½ï¼ =, +=, -=, *=, /=, %=, ++, --\n\n\n# åé\n\næ³¨æï¼åé ä»ä» å¨ ææ¬åº (æ¯å¦ <h1>Hello ${name}!</h1>) å å­ç¬¦ä¸² ä¸­èµ·ä½ç¨ã\n\næ­£ç¡®ç¤ºä¾ï¼\n\n<#include "/footer/${company}.html">\n<#if big>...</#if>\n\n\néè¯¯ç¤ºä¾ï¼\n\n<#if ${big}>...</#if>\n<#if "${big}">...</#if>\n\n\n\n# æ°æ®ç±»å\n\nFreemark æ¯æçç±»åæï¼\n\n\n# æ é\n\nå­ç¬¦ä¸²\n\n${"Hello ${user}"}\n${"I can escape with \\\\ ${user}"}\n${r"Now I can read dollar signs $"}\n\n\nè¾åºï¼\n\nHello deister\nI can escape with \\ deister\nNow I can read dollar signs $\n\n\næ°å­\n\nå¸å°å¼\n\næ¥æ/æ¶é´ (æ¥æï¼æ¶é´ææ¥ææ¶é´)\n\n\n# å®¹å¨\n\n * åå¸è¡¨\n * åºå\n * éå\n\n\n# å­ç¨åº\n\n * æ¹æ³åå½æ°\n * ç¨æ·èªå®ä¹æä»¤\n\n\n# å¶å®\n\n * ç»ç¹\n\n\n# è½¬ä¹ç¬¦\n\nFTL æ¯æçææè½¬ä¹å­ç¬¦ï¼\n\nè½¬ä¹åºå     å«ä¹\n\\"       å¼å· (u0022)\n\\\'       åå¼å·(åç§°ä¸ºæå·) (u0027)\n\\{       èµ·å§è±æ¬å·ï¼{\n\\\\       åææ  (u005C)\n\\n       æ¢è¡ç¬¦ (u000A)\n\\r       åè½¦ (u000D)\n\\t       æ°´å¹³å¶è¡¨ç¬¦(åç§°ä¸º tab) (u0009)\n\\b       éæ ¼ (u0008)\n\\f       æ¢é¡µ (u000C)\n\\l       å°äºå·ï¼<\n\\g       å¤§äºå·ï¼>\n\\a       &ç¬¦ï¼&\n\\xCode   å­ç¬¦ç 16 è¿å¶ Unicode ç  (UCS ç )\n\n\n# åèèµæ\n\n * Freemark Github\n * Freemark ä¸­ææç¨\n * å¨çº¿ Freemark å·¥å·',normalizedContent:'# freemark å¿«éå¥é¨\n\n> freemarker æ¯ä¸æ¬¾æ¨¡æ¿å¼æï¼ å³ä¸ç§åºäºæ¨¡æ¿åè¦æ¹åçæ°æ®ï¼ å¹¶ç¨æ¥çæè¾åºææ¬(html ç½é¡µï¼çµå­é®ä»¶ï¼éç½®æä»¶ï¼æºä»£ç ç­)çéç¨å·¥å·ã å®ä¸æ¯é¢åæç»ç¨æ·çï¼èæ¯ä¸ä¸ª java ç±»åºï¼æ¯ä¸æ¬¾ç¨åºåå¯ä»¥åµå¥ä»ä»¬æå¼åäº§åçç»ä»¶ã\n\n\n# freemark ç®ä»\n\nfreemark æ¨¡æ¿ç¼åä¸º freemarker template language (ftl)ãå®æ¯ç®åçï¼ä¸ç¨çè¯­è¨ï¼ ä¸æ¯ å php é£æ ·æççç¼ç¨è¯­è¨ãå¨æ¨¡æ¿ä¸­ï¼ä½ å¯ä»¥ä¸æ³¨äºå¦ä½å±ç°æ°æ®ï¼ èå¨æ¨¡æ¿ä¹å¤å¯ä»¥ä¸æ³¨äºè¦å±ç¤ºä»ä¹æ°æ®ã\n\n\n\nè¿ç§æ¹å¼éå¸¸è¢«ç§°ä¸º mvc (æ¨¡å è§å¾ æ§å¶å¨) æ¨¡å¼ï¼å¯¹äºå¨æç½é¡µæ¥è¯´ï¼æ¯ä¸ç§ç¹å«æµè¡çæ¨¡å¼ã å®å¸®å©ä»å¼åäººå(java ç¨åºå)ä¸­åç¦»åºç½é¡µè®¾è®¡å¸(html è®¾è®¡å¸)ãè®¾è®¡å¸æ éé¢å¯¹æ¨¡æ¿ä¸­çå¤æé»è¾ï¼ å¨æ²¡æç¨åºåæ¥ä¿®æ¹æéæ°ç¼è¯ä»£ç æ¶ï¼ä¹å¯ä»¥ä¿®æ¹é¡µé¢çæ ·å¼ã\n\nfreemark æ¨¡æ¿ä¸å¥è¯æ¦æ¬å°±æ¯ï¼æ¨¡æ¿ + æ°æ®æ¨¡å = è¾åº\n\n\n# æ»ä½ç»æ\n\n * ææ¬ï¼ææ¬ä¼ç§çåæ ·æ¥è¾åºã\n * æå¼ï¼è¿é¨åçè¾åºä¼è¢«è®¡ç®çå¼æ¥æ¿æ¢ãæå¼ç± ${ and } æåé(æè #{ and }ï¼è¿ç§é£æ ¼å·²ç»ä¸å»ºè®®åä½¿ç¨äºï¼ç¹å»æ¥çæ´å¤)ã\n * ftl æ ç­¾ï¼ftl æ ç­¾å html æ ç­¾å¾ç¸ä¼¼ï¼ä½æ¯å®ä»¬å´æ¯ç» freemarker çæç¤ºï¼ èä¸ä¸ä¼æå°å¨è¾åºåå®¹ä¸­ã\n * æ³¨éï¼æ³¨éå html çæ³¨éä¹å¾ç¸ä¼¼ï¼ä½å®ä»¬æ¯ç± <#-- å --\x3eæ¥åéçãæ³¨éä¼è¢« freemarker ç´æ¥å¿½ç¥ï¼ æ´ä¸ä¼å¨è¾åºåå®¹ä¸­æ¾ç¤ºã\n\n\n\n> ð æ³¨æï¼\n> \n>  * ftl æ¯åºåå¤§å°åçã\n>  * æå¼ ä»ä»å¯ä»¥å¨ ææ¬ ä¸­ä½¿ç¨ã\n>  * ftl æ ç­¾ ä¸å¯ä»¥å¨å¶ä» ftl æ ç­¾ å æå¼ ä¸­ä½¿ç¨ã\n>  * æ³¨é å¯ä»¥æ¾å¨ ftl æ ç­¾ å æå¼ ä¸­ã\n\n\n# æä»¤\n\nftl æä»¤æä¸¤ç§ç±»åï¼ é¢å®ä¹æä»¤ å ç¨æ·èªå®ä¹æä»¤ã å¯¹äºç¨æ·èªå®ä¹çæä»¤ä½¿ç¨ @ æ¥ä»£æ¿ #ã\n\n> ð æ³¨æï¼\n> \n>  * freemarker ä»ä»å³å¿ ftl æ ç­¾çåµå¥èä¸å³å¿ html æ ç­¾çåµå¥ã å®åªä¼æ html çåæ¯ææ¬ï¼ä¸ä¼æ¥è§£é htmlã\n>  * å¦æä½ å°è¯ä½¿ç¨ä¸ä¸ªä¸å­å¨çæä»¤(æ¯å¦ï¼è¾éäºæä»¤çåç§°)ï¼ freemarker å°±ä¼æç»æ§è¡æ¨¡æ¿ï¼åæ¶æåºéè¯¯ä¿¡æ¯ã\n>  * freemarker ä¼å¿½ç¥ ftl æ ç­¾ä¸­å¤ä½ç ç©ºç½æ è®°ã\n\n\n# è¡¨è¾¾å¼\n\nä»¥ä¸ä¸ºå¿«éæµè§æ¸åï¼å¦æéè¦äºè§£æ´å¤ç»èï¼è¯·åèè¿éã\n\n * ç´æ¥æå®å¼\n   * å­ç¬¦ä¸²ï¼ "foo" æè \'foo\' æè "it\'s \\"quoted\\"" æè \'it\\\'s "quoted"\' æè r"c:\\raw\\string"\n   * æ°å­ï¼ 123.45\n   * å¸å°å¼ï¼ trueï¼ false\n   * åºåï¼ ["foo", "bar", 123.45]ï¼ å¼åï¼ 0..9, 0..<10 (æ 0..!10), 0..\n   * åå¸è¡¨ï¼ {"name":"green mouse", "price":150}\n * æ£ç´¢åé\n   * é¡¶å±åéï¼ user\n   * ä»åå¸è¡¨ä¸­æ£ç´¢æ°æ®ï¼ user.nameï¼ user["name"]\n   * ä»åºåä¸­æ£ç´¢æ°æ®ï¼ products[5]\n   * ç¹æ®åéï¼ .main\n * å­ç¬¦ä¸²æä½\n   * æå¼(æè¿æ¥)ï¼ "hello ${user}!" (æ "hello " + user + "!")\n   * è·åä¸ä¸ªå­ç¬¦ï¼ name[0]\n   * å­ç¬¦ä¸²ååï¼ åå«ç»å°¾ï¼ name[0..4]ï¼ä¸åå«ç»å°¾ï¼ name[0..<5]ï¼åºäºé¿åº¦(å®½å®¹å¤ç)ï¼ name[0..*5]ï¼å»é¤å¼å¤´ï¼name[5..]\n * åºåæä½\n   * è¿æ¥ï¼ users + ["guest"]\n   * åºåååï¼åå«ç»å°¾ï¼ products[20..29]ï¼ ä¸åå«ç»å°¾ï¼ products[20..<30]ï¼åºäºé¿åº¦(å®½å®¹å¤ç)ï¼products[20..*10]ï¼å»é¤å¼å¤´ï¼ products[20..]\n * åå¸è¡¨æä½\n   * è¿æ¥ï¼ passwords + { "joe": "secret42" }\n * ç®æ¯è¿ç®ï¼ (x * 1.5 + 10) / 2 - y % 100\n * æ¯è¾è¿ç®ï¼ x == yï¼ x != yï¼ x < yï¼ x > yï¼ x >= yï¼ x <= yï¼ x lt yï¼ x lte yï¼ x gt yï¼ x gte yï¼ ç­ç­ãããããã\n * é»è¾æä½ï¼ !registered && (firstvisit || fromeurope)\n * åå»ºå½æ°ï¼ name?upper_case, path?ensure_starts_with(\'/\')\n * æ¹æ³è°ç¨ï¼ repeat("what", 3)\n * å¤çä¸å­å¨çå¼\n   * é»è®¤å¼ï¼ name!"unknown" æè (user.name)!"unknown" æè name! æè (user.name)!\n   * æ£æµä¸å­å¨çå¼ï¼ name?? æè (user.name)??\n * èµå¼æä½ï¼ =, +=, -=, *=, /=, %=, ++, --\n\n\n# åé\n\næ³¨æï¼åé ä»ä» å¨ ææ¬åº (æ¯å¦ <h1>hello ${name}!</h1>) å å­ç¬¦ä¸² ä¸­èµ·ä½ç¨ã\n\næ­£ç¡®ç¤ºä¾ï¼\n\n<#include "/footer/${company}.html">\n<#if big>...</#if>\n\n\néè¯¯ç¤ºä¾ï¼\n\n<#if ${big}>...</#if>\n<#if "${big}">...</#if>\n\n\n\n# æ°æ®ç±»å\n\nfreemark æ¯æçç±»åæï¼\n\n\n# æ é\n\nå­ç¬¦ä¸²\n\n${"hello ${user}"}\n${"i can escape with \\\\ ${user}"}\n${r"now i can read dollar signs $"}\n\n\nè¾åºï¼\n\nhello deister\ni can escape with \\ deister\nnow i can read dollar signs $\n\n\næ°å­\n\nå¸å°å¼\n\næ¥æ/æ¶é´ (æ¥æï¼æ¶é´ææ¥ææ¶é´)\n\n\n# å®¹å¨\n\n * åå¸è¡¨\n * åºå\n * éå\n\n\n# å­ç¨åº\n\n * æ¹æ³åå½æ°\n * ç¨æ·èªå®ä¹æä»¤\n\n\n# å¶å®\n\n * ç»ç¹\n\n\n# è½¬ä¹ç¬¦\n\nftl æ¯æçææè½¬ä¹å­ç¬¦ï¼\n\nè½¬ä¹åºå     å«ä¹\n\\"       å¼å· (u0022)\n\\\'       åå¼å·(åç§°ä¸ºæå·) (u0027)\n\\{       èµ·å§è±æ¬å·ï¼{\n\\\\       åææ  (u005c)\n\\n       æ¢è¡ç¬¦ (u000a)\n\\r       åè½¦ (u000d)\n\\t       æ°´å¹³å¶è¡¨ç¬¦(åç§°ä¸º tab) (u0009)\n\\b       éæ ¼ (u0008)\n\\f       æ¢é¡µ (u000c)\n\\l       å°äºå·ï¼<\n\\g       å¤§äºå·ï¼>\n\\a       &ç¬¦ï¼&\n\\xcode   å­ç¬¦ç 16 è¿å¶ unicode ç  (ucs ç )\n\n\n# åèèµæ\n\n * freemark github\n * freemark ä¸­ææç¨\n * å¨çº¿ freemark å·¥å·',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Thymeleaf å¿«éå¥é¨",frontmatter:{title:"Thymeleaf å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æ¨¡æ¿å¼æ"],tags:["Java","æ¨¡æ¿å¼æ","Thymeleaf"],abbrlink:"33db93c3",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/2263fb/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/03.%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/02.Thymeleaf.html",relativePath:"12.å·¥å·/03.æ¨¡æ¿å¼æ/02.Thymeleaf.md",key:"v-eb512f24",path:"/pages/2263fb/",headers:[{level:2,title:"æ åæ¹è¨",slug:"æ åæ¹è¨",normalizedTitle:"æ åæ¹è¨",charIndex:21},{level:3,title:"è¡¨è¾¾å¼",slug:"è¡¨è¾¾å¼",normalizedTitle:"è¡¨è¾¾å¼",charIndex:130},{level:4,title:"åéè¡¨è¾¾å¼",slug:"åéè¡¨è¾¾å¼",normalizedTitle:"åéè¡¨è¾¾å¼",charIndex:144},{level:4,title:"éæ©è¡¨è¾¾å¼",slug:"éæ©è¡¨è¾¾å¼",normalizedTitle:"éæ©è¡¨è¾¾å¼",charIndex:161},{level:4,title:"æ¶æ¯(i18n)è¡¨è¾¾å¼",slug:"æ¶æ¯-i18n-è¡¨è¾¾å¼",normalizedTitle:"æ¶æ¯(i18n)è¡¨è¾¾å¼",charIndex:1027},{level:4,title:"é¾æ¥(URL)è¡¨è¾¾å¼",slug:"é¾æ¥-url-è¡¨è¾¾å¼",normalizedTitle:"é¾æ¥(url)è¡¨è¾¾å¼",charIndex:1485},{level:4,title:"çæ®µè¡¨è¾¾å¼",slug:"çæ®µè¡¨è¾¾å¼",normalizedTitle:"çæ®µè¡¨è¾¾å¼",charIndex:227},{level:4,title:"è¡¨è¾¾å¼é¢å¤ç",slug:"è¡¨è¾¾å¼é¢å¤ç",normalizedTitle:"è¡¨è¾¾å¼é¢å¤ç",charIndex:2876},{level:3,title:"æå­åæä½",slug:"æå­åæä½",normalizedTitle:"æå­åæä½",charIndex:3067},{level:3,title:"åºæ¬å±æ§",slug:"åºæ¬å±æ§",normalizedTitle:"åºæ¬å±æ§",charIndex:3614},{level:3,title:"æ å URL",slug:"æ å-url",normalizedTitle:"æ å url",charIndex:4096},{level:4,title:"ç»å¯¹ç½å",slug:"ç»å¯¹ç½å",normalizedTitle:"ç»å¯¹ç½å",charIndex:4246},{level:4,title:"ä¸ä¸æç¸å³ URL",slug:"ä¸ä¸æç¸å³-url",normalizedTitle:"ä¸ä¸æç¸å³ url",charIndex:4511},{level:4,title:"ä¸æå¡å¨ç¸å³ URL",slug:"ä¸æå¡å¨ç¸å³-url",normalizedTitle:"ä¸æå¡å¨ç¸å³ url",charIndex:4834},{level:4,title:"åè®®ç¸å³ URL",slug:"åè®®ç¸å³-url",normalizedTitle:"åè®®ç¸å³ url",charIndex:5097},{level:4,title:"æ·»å åæ°",slug:"æ·»å åæ°",normalizedTitle:"æ·»å åæ°",charIndex:5361},{level:4,title:"ç½åçæ®µæ è¯ç¬¦",slug:"ç½åçæ®µæ è¯ç¬¦",normalizedTitle:"ç½åçæ®µæ è¯ç¬¦",charIndex:5852},{level:4,title:"URL éå",slug:"url-éå",normalizedTitle:"url éå",charIndex:1532},{level:4,title:"URL å¶å®å±æ§",slug:"url-å¶å®å±æ§",normalizedTitle:"url å¶å®å±æ§",charIndex:6360},{level:4,title:"å¨ URL ä¸­ä½¿ç¨è¡¨è¾¾å¼",slug:"å¨-url-ä¸­ä½¿ç¨è¡¨è¾¾å¼",normalizedTitle:"å¨ url ä¸­ä½¿ç¨è¡¨è¾¾å¼",charIndex:6656},{level:2,title:"æ©å±",slug:"æ©å±",normalizedTitle:"æ©å±",charIndex:7655},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:7668}],headersStr:"æ åæ¹è¨ è¡¨è¾¾å¼ åéè¡¨è¾¾å¼ éæ©è¡¨è¾¾å¼ æ¶æ¯(i18n)è¡¨è¾¾å¼ é¾æ¥(URL)è¡¨è¾¾å¼ çæ®µè¡¨è¾¾å¼ è¡¨è¾¾å¼é¢å¤ç æå­åæä½ åºæ¬å±æ§ æ å URL ç»å¯¹ç½å ä¸ä¸æç¸å³ URL ä¸æå¡å¨ç¸å³ URL åè®®ç¸å³ URL æ·»å åæ° ç½åçæ®µæ è¯ç¬¦ URL éå URL å¶å®å±æ§ å¨ URL ä¸­ä½¿ç¨è¡¨è¾¾å¼ æ©å± åèèµæ",content:'# Thymeleaf å¿«éå¥é¨\n\n\n# æ åæ¹è¨\n\næ åæ¹è¨æ¯æ Thymeleaf å®ä¹äºä¸ç»åè½ï¼è¿äºåè½åºè¯¥è¶³ä»¥æ»¡è¶³å¤§å¤æ°æåµãå¯ä»¥è¯å«è¿äºæ åæ¹è¨å¨æ¨¡æ¿ä¸­çä½¿ç¨ï¼å ä¸ºå®å°åå«ä»¥thåç¼å¼å¤´çå±æ§ï¼å¦<span th:text="...">ã\n\n\n# è¡¨è¾¾å¼\n\n${...} : åéè¡¨è¾¾å¼ã\n\n*{...} : éæ©è¡¨è¾¾å¼ã\n\n#{...} : æ¶æ¯ (i18n) è¡¨è¾¾å¼ã\n\n@{...} : é¾æ¥ (URL) è¡¨è¾¾å¼ã\n\n~{...} : çæ®µè¡¨è¾¾å¼ã\n\n# åéè¡¨è¾¾å¼\n\nåéè¡¨è¾¾å¼æ¯ OGNL è¡¨è¾¾å¼ - å¦æå° Thymeleaf ä¸ Spring - éæå¨ä¸ä¸æåéä¸(ä¹ç§°ä¸º Spring æ¯è¯­ä¸­çæ¨¡åå±æ§)ï¼åä¸º Spring ELã å®ä»¬çèµ·æ¥åè¿æ ·:\n\n${session.user.name}\n\n\nå®ä»¬ä½ä¸ºå±æ§å¼æä½ä¸ºå®ä»¬çä¸é¨åï¼åå³äºå±æ§:\n\n<span th:text="${book.author.name}"></span>\n\n\nä¸é¢çè¡¨è¾¾å¼ä¸ä¸é¢æ¯ç¸åç(å¨ OGNL å SpringEL ä¸­):\n\n((Book)context.getVariable("book")).getAuthor().getName()\n\n\nä½æ¯ä¸ä»å¨æ¶åè¾åºçåºæ¯ä¸­æ¾å°åéè¡¨è¾¾å¼ï¼èä¸è¿å¯ä»¥ä½¿ç¨æ´å¤æçå¤çæ¹å¼ï¼å¦:æ¡ä»¶ï¼è¿­ä»£â¦ç­ç­ã\n\n<li th:each="book : ${books}"></li>\n\n\nè¿é${books}ä»ä¸ä¸æä¸­éæ©åä¸ºbooksçåéï¼å¹¶å¨th:eachä¸­ä½¿ç¨å¾ªç¯å°å¶è¯ä¼°ä¸ºè¿­ä»£å¨ã\n\n# éæ©è¡¨è¾¾å¼\n\néæ©è¡¨è¾¾å¼å°±ååéè¡¨è¾¾å¼ä¸æ ·ï¼å®ä»¬ä¸æ¯æ´ä¸ªä¸ä¸æåéæ å°ä¸æ§è¡ï¼èæ¯å¨ååéæ©çå¯¹è±¡ã å®ä»¬çèµ·æ¥åè¿æ ·:\n\n*{customer.name}\n\n\nå®ä»¬æä½ç¨çå¯¹è±¡ç±th:objectå±æ§æå®:\n\n<div th:object="${book}">\n  ...\n  <span th:text="*{title}">...</span>\n  ...\n</div>\n\n\næä»¥è¿ç¸å½äº:\n\n{\n  // th:object="${book}"\n  final Book selection = (Book) context.getVariable("book");\n  // th:text="*{title}"\n  output(selection.getTitle());\n}\n\n\n# æ¶æ¯(i18n)è¡¨è¾¾å¼\n\næ¶æ¯è¡¨è¾¾å¼(éå¸¸ç§°ä¸ºææ¬å¤é¨åï¼å½éåæ i18n)åè®¸ä»å¤é¨æº(å¦:.properties)æä»¶ä¸­æ£ç´¢ç¹å®äºè¯­è¨ç¯å¢çæ¶æ¯ï¼éè¿é®æ¥å¼ç¨è¿å¼ç¨æ¶æ¯ã\n\nå¨ Spring åºç¨ç¨åºä¸­ï¼å®å°èªå¨ä¸ Spring ç MessageSource æºå¶éæãå¦ä¸ -\n\n#{main.title}\n#{message.entrycreated(${entryId})}\n\n\nä»¥ä¸æ¯å¨æ¨¡æ¿ä¸­ä½¿ç¨å®ä»¬çæ¹å¼:\n\n<table>\n  ...\n  <th th:text="#{header.address.city}">...</th>\n  <th th:text="#{header.address.country}">...</th>\n  ...\n</table>\n\n\nè¯·æ³¨æï¼å¦æå¸ææ¶æ¯é®ç±ä¸ä¸æåéçå¼ç¡®å®ï¼æèå¸æå°åéæå®ä¸ºåæ°ï¼åå¯ä»¥å¨æ¶æ¯è¡¨è¾¾å¼ä¸­ä½¿ç¨åéè¡¨è¾¾å¼:\n\n#{${config.adminWelcomeKey}(${session.user.name})} Jsp\n\n\n# é¾æ¥(URL)è¡¨è¾¾å¼\n\né¾æ¥è¡¨è¾¾å¼å¨æå»º URL å¹¶åå¶æ·»å æç¨çä¸ä¸æåä¼è¯ä¿¡æ¯(éå¸¸ç§°ä¸º URL éåçè¿ç¨)ã å æ­¤ï¼å¯¹äºé¨ç½²å¨ Web æå¡å¨ç/myappä¸ä¸æä¸­ç Web åºç¨ç¨åºï¼å¯ä»¥ä½¿ç¨ä»¥ä¸è¡¨è¾¾å¼:\n\n<a th:href="@{/order/list}">...</a>\n\n\nå¯ä»¥è½¬æ¢æå¦ä¸çä¸è¥¿:\n\n<a href="/myapp/order/list">...</a>\n\n\nçè³ï¼å¦æéè¦ä¿æä¼è¯ï¼å¹¶ä¸ cookie æªå¯ç¨(æèæå¡å¨è¿ä¸ç¥é)ï¼é£ä¹çæçæ ¼å¼ä¸º:\n\n<a href="/myapp/order/list;jsessionid=s2ds3fa31abd241e2a01932">...</a> HTML\n\n\nç½åä¹å¯ä»¥å¸¦åæ°ï¼å¦ä¸æç¤º:\n\n<a th:href="@{/order/details(id=${orderId},type=${orderType})}">...</a>\n\n\nè¿å°äº§çç±»ä¼¼ä»¥ä¸çç»æ -\n\n\x3c!-- æ³¨æï¼ç¬¦å·ä¼å¨æ ç­¾å±æ§ä¸­è¿è¡HTMLè½¬ä¹... --\x3e\n<a href="/myapp/order/details?id=23&type=online">...</a>\n\n\né¾æ¥è¡¨è¾¾å¼å¯ä»¥æ¯ç¸å¯¹çï¼å¨è¿ç§æåµä¸ï¼åºç¨ç¨åºä¸ä¸æå°ä¸ä¼è¢«å å° URL çåé¢:\n\n<a th:href="@{../documents/report}">...</a>\n\n\nä¹æ¯æå¡å¨ç¸å¯¹ç(åæ ·ï¼æ²¡æåºç¨ç¨åºä¸ä¸æçåç¼):\n\n<a th:href="@{~/contents/main}">...</a>\n\n\nååè®®ç¸å³(å°±åç»å¯¹ URL ä¸æ ·ï¼ä½æµè§å¨å°ä½¿ç¨ä¸æ­£å¨æ¾ç¤ºçé¡µé¢ç¸åç HTTP æ HTTPS åè®®):\n\n<a th:href="@{//static.mycompany.com/res/initial}">...</a>\n\n\nå½ç¶ï¼é¾æ¥è¡¨è¾¾å¼ä¹å¯ä»¥æ¯ç»å¯¹ç:\n\n<a th:href="@{http://www.mycompany.com/main}">...</a>\n\n\nä½æ¯ç»å¯¹(æåè®®ç¸å¯¹)URL ï¼å¨ Thymeleaf é¾æ¥è¡¨è¾¾å¼ä¸­åºè¯¥æ·»å ä»ä¹å¼ï¼ å¾ç®å:ç±ååºè¿æ»¤å¨å®ä¹ URL éå:å¨åºäº Servlet ç Web åºç¨ç¨åºä¸­ï¼å¯¹äºæ¯ä¸ªè¾åºç URL(ä¸ä¸æç¸å¯¹ï¼ç¸å¯¹ï¼ç»å¯¹â¦)ï¼å¨æ¾ç¤º URL ä¹åï¼Thymeleaf æ»æ¯è°ç¨HttpServletResponse.encodeUrl(...)æºå¶ã è¿æå³çä¸ä¸ªè¿æ»¤å¨å¯ä»¥éè¿åè£ HttpServletResponse å¯¹è±¡æ¥ä¸ºåºç¨ç¨åºæ§è¡èªå®ä¹ç URL éåã\n\n# çæ®µè¡¨è¾¾å¼\n\nçæ®µè¡¨è¾¾å¼æ¯ä¸ç§ç®åçæ¹æ³ç¨æ¥è¡¨ç¤ºæ è®°ççæ®µå¹¶å°å¶ç§»å¨å°æ¨¡æ¿ä¸­ã ç±äºè¿äºè¡¨è¾¾å¼ï¼çæ®µå¯ä»¥è¢«å¤å¶ï¼ä¼ éç»å¶ä»æ¨¡æ¿çåæ°ç­ç­ã\n\næå¸¸è§çæ¯ä½¿ç¨th:insertæth:replaceæ¥æå¥çæ®µ:\n\n<div th:insert="~{commons :: main}">...</div>\n\n\nä½æ¯å®ä»¬å¯ä»¥å¨ä»»ä½å°æ¹ä½¿ç¨ï¼å°±åä»»ä½å¶ä»åéä¸æ ·:\n\n<div th:with="frag=~{footer :: #main/text()}">\n  <p th:insert="${frag}"></p>\n</div>\n\n\nçæ®µè¡¨è¾¾å¼å¯ä»¥æåæ°ã\n\n# è¡¨è¾¾å¼é¢å¤ç\n\nå³äºè¡¨è¾¾å¼çæåä¸ä»¶äºæ¯ç¥éè¡¨è¾¾å¼é¢å¤çï¼å¨__ä¹é´æå®ï¼å¦ä¸æç¤º:\n\n#{selection.__${sel.code}__}\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ä¸ªè¢«æ§è¡çåéè¡¨è¾¾å¼æ¯:${sel.code}ï¼å¹¶ä¸å°ä½¿ç¨å®çç»æä½ä¸ºè¡¨è¾¾å¼çä¸é¨å(åè®¾${sel.code}çç»æä¸º:ALL)ï¼å¨æ­¤å¤æ§è¡å½éåçæåµä¸(è¿å°æ¥æ¾ä¸å³é®selection.ALLæ¶æ¯)ã\n\n\n# æå­åæä½\n\næå¾å¤ç±»åçæå­åæä½å¯ç¨ï¼å®ä»¬åå«å¦ä¸:\n\n * æå­\n   * ææ¬æå­ï¼ä¾å¦:\'one text\', \'Another one!\',â¦\n   * æ°å­æå­ï¼ä¾å¦:0,10, 314, 31.01, 112.83,â¦\n   * å¸å°æå­ï¼ä¾å¦:true,false\n   * Null æå­ï¼ä¾å¦:Null\n   * æå­æ è®°ï¼ä¾å¦:one, sometext, main,â¦\n * ææ¬æä½:\n   * å­ç¬¦ä¸²è¿æ¥:+\n   * æå­æ¿æ¢:|The name is ${name}|\n * ç®æ¯è¿ç®:\n   * äºè¿å¶æä½:+, -, *, /, %\n   * åå·(ä¸åè¿ç®ç¬¦):-\n * å¸å°è¿ç®:\n   * äºè¿å¶è¿ç®ç¬¦ï¼and,or\n   * å¸å°å¦å®(ä¸åè¿ç®ç¬¦):!,not\n * æ¯è¾åç¸ç­:\n   * æ¯è¾è¿ç®ç¬¦:>,<,>=,<=(gt,lt,ge,le)\n   * ç¸ç­è¿ç®ç¬¦:==, != (eq, ne)\n * æ¡ä»¶æä½ç¬¦:\n   * If-then:(if) ? (then)\n   * If-then-else:(if) ? (then) : (else)\n   * Default: (value) ?: (defaultvalue)\n\n\n# åºæ¬å±æ§\n\nä¸é¢æ¥ççæ åæ¹è¨ä¸­çå ä¸ªæåºæ¬çå±æ§ã ä»th:ææ¬å¼å§ï¼å®ä»£æ¿äºæ ç­¾çä¸»ä½:\n\n<p th:text="#{msg.welcome}">Welcome everyone!</p>\n\n\nç°å¨ï¼th:eachéå¤å®æå¨åç´ çæ¬¡æ°ï¼ç±å®çè¡¨è¾¾å¼è¿åçæ°ç»æåè¡¨ææå®çæ¬¡æ°ï¼ä¸ºè¿­ä»£åç´ åå»ºä¸ä¸ªåé¨åéï¼å¶è¯­æ³ä¸ Java ç foreach è¡¨è¾¾å¼ç¸å:\n\n<li th:each="book : ${books}" th:text="${book.title}">\n  En las Orillas del Sar\n</li>\n\n\næåï¼Thymeleaf ä¸ºç¹å®ç XHTML å HTML5 å±æ§æä¾äºè®¸å¤thå±æ§ï¼è¿äºå±æ§åªè¯ä¼°å®ä»¬çè¡¨è¾¾å¼ï¼å¹¶å°è¿äºå±æ§çå¼è®¾ç½®ä¸ºç»æã\n\n<form th:action="@{/createOrder}">\n  <input type="button" th:value="#{form.submit}" />\n  <a th:href="@{/admin/users}"></a>\n</form>\n\n\n\n# æ å URL\n\nThymeleaf æ åæ¹è¨(ç§°ä¸º Standard å SpringStandard)æä¾äºä¸ç§å¨ Web åºç¨ç¨åºä¸­è½»æ¾åå»º URL çæ¹æ³ï¼ä»¥ä¾¿å®ä»¬åå«ä»»ä½æéç URL å·¥ä»¶ã è¿æ¯éè¿è¿æ¥è¡¨è¾¾æ¹å¼æ¥å®æçï¼è¿æ¯ä¸ç§ç±»ä¼¼äº Thymeleaf æ åçè¡¨ç°:@{...}\n\n# ç»å¯¹ç½å\n\nç»å¯¹ URL ç¨äºåå»ºå°å¶ä»æå¡å¨çé¾æ¥ãå®ä»¬éè¦æå®ä¸ä¸ªåè®®åç§°(http://æhttps://)å¼å¤´ã\n\n<a th:href="@{https://www.yiibai.com/thymeleaf/}"></a>\n\n\nä¸é¢é¾æ¥ä¸ä¼è¢«ä¿®æ¹ï¼é¤éå¨æå¡å¨ä¸éç½®äº URL éåè¿æ»¤å¨ï¼å¹¶å¨HttpServletResponse.encodeUrl(...)æ¹æ³ä¸­æ§è¡ä¿®æ¹ãæåçæç HTML ä»£ç å¦ä¸:\n\n<a href="https://www.yiibai.com/thymeleaf/"></a>\n\n\n# ä¸ä¸æç¸å³ URL\n\næå¸¸ç¨ç URL ç±»åæ¯ä¸ä¸æç¸å³çã è¿äº URL æ¯ä¸æ¦å®è£å¨æå¡å¨ä¸ï¼å°±ä¼ä¸ Web åºç¨ç¨åºæ ¹ç¸å³è URLã ä¾å¦ï¼å¦æå°ä¸ä¸ªåç§°ä¸ºmyapp.warçæä»¶é¨ç½²å°ä¸ä¸ª Tomcat æå¡å¨ä¸­ï¼é£ä¹åºç¨ç¨åºä¸è¬æ¯éè¿ URL:http://localhost:8080/myappæ¥è®¿é®ï¼myappå°±æ¯ä¸ä¸æåç§°ã\n\nä¸ä¸ä¸æç¸å³ç URL ä»¥/å­ç¬¦å¼å¤´:\n\n<a th:href="@{/order/list}"></a>\n\n\nå¦æåºç¨ç¨åºè®¿é® URL ä¸º:http://localhost:8080/myappï¼åæ­¤ URL å°è¾åº:\n\n<a href="/myapp/order/list"></a>\n\n\n# ä¸æå¡å¨ç¸å³ URL\n\næå¡å¨ç¸å³ç URL ä¸ä¸ä¸æç¸å³ç URL éå¸¸ç¸ä¼¼ï¼åªæ¯å®ä»¬ä¸åå® URL è¦é¾æ¥å°åºç¨ç¨åºä¸ä¸æä¸­çèµæºï¼å æ­¤åè®¸é¾æ¥å°åä¸æå¡å¨ä¸­çä¸åä¸ä¸æ:\n\n<a th:href="@{~/billing-app/showDetails.html}"></a>\n\n\nå½ååºç¨ç¨åºçä¸ä¸æå°è¢«å¿½ç¥ï¼å æ­¤å°½ç®¡åºç¨ç¨åºé¨ç½²å¨http:// localhost:8080 / myappï¼ä½è¯¥ URL å°è¾åº:\n\n<a href="/billing-app/showDetails.html"></a>\n\n\n# åè®®ç¸å³ URL\n\nä¸åè®®ç¸å³ç URL å®éä¸æ¯ç»å¯¹ç URLï¼å®å°ä¿æç¨äºæ¾ç¤ºå½åé¡µé¢çåè®®(HTTPï¼HTTPS)ã å®ä»¬éå¸¸ç¨äºåæ¬æ ·å¼ï¼èæ¬ç­å¤é¨èµæº:\n\n<script th:src="@{//scriptserver.example.net/myscript.js}">\n  ...\n<\/script>\n\n\nå®å°åç°ä¸ä¸é¢ä¸è´ç URL(URL éåé¤å¤)ï¼å¦:\n\n<script src="//scriptserver.example.net/myscript.js">\n  ...\n<\/script>\n\n\n# æ·»å åæ°\n\nå¦ä½åä½¿ç¨@{...}è¡¨è¾¾å¼åå»ºç URL æ·»å åæ°ï¼ è¿ä¹å¾ç®å:\n\n<a th:href="@{/order/details(id=3)}"></a>\n\n\nä¸é¢ç¤ºä¾ä»£ç ï¼æç»å°è¾åºä¸º:\n\n<a href="/order/details?id=3"></a>\n\n\nä¹å¯ä»¥æ·»å å ä¸ªåæ°ï¼ç¨éå·åéå®ä»¬:\n\n<a th:href="@{/order/details(id=3,action=\'show_all\')}"></a>\n\n\nä¸é¢ä»£ç å°è¾åºç»æä¸º:\n\n\x3c!-- æ³¨æï¼ç¬¦å·å¨æ ç­¾å±æ§ä¸­è¿è¡HTMLè½¬ä¹... --\x3e\n<a href="/order/details?id=3&action=show_all"></a>\n\n\nè¿å¯ä»¥ä½¿ç¨æ­£å¸¸åæ°çè·¯å¾åéçå½¢å¼åå«åæ°ï¼ä½å¨ URL çè·¯å¾ä¸­æå®ä¸ä¸ªå ä½ç¬¦:\n\n<a th:href="@{/order/{id}/details(id=3,action=\'show_all\')}"></a>\n\n\nä¸é¢è¾åºç»æä¸º:\n\n<a href="/order/3/details?action=show_all"></a>\n\n\n# ç½åçæ®µæ è¯ç¬¦\n\nçæ®µæ è¯ç¬¦å¯ä»¥åå«å¨ URL ä¸­ï¼åå«åæ°åä¸åå«åæ°ã å®ä»¬å°å§ç»åå«å¨ç½åçåºç¡ä¸ï¼åèä»¥ä¸ä»£ç :\n\n<a th:href="@{/home#all_info(action=\'show\')}"></a>\n\n\næ§è¡è¾åºç»æå¦ä¸ -\n\n<a href="/home?action=show#all_info">\n\n\n# URL éå\n\nThymeleaf åè®¸å¨åºç¨ç¨åºä¸­éç½® URL éåè¿æ»¤å¨ï¼å®éè¿è°ç¨ Thymeleaf æ¨¡æ¿çæçæ¯ä¸ª URL ç Servlet API çjavax.servlet.http.HttpServletResponseç±»ä¸­çresponse.encodeURL()æ¹æ³æ¥å®ç°ã\n\nä¸é¢å¨ Java Web åºç¨ç¨åºä¸­æ¯æ URL éåæä½çæ åæ¹å¼ï¼å¹¶åè®¸ URL:\n\n * èªå¨æ£æµç¨æ·æ¯å¦å¯ç¨äº Cookieï¼å¦ææªå¯ç¨æèå¦æå®æ¯ç¬¬ä¸ä¸ªè¯·æ±å¹¶ä¸ cookie éç½®ä»æªç¥ãåå°;jsessionid=...çæ®µæ·»å å° URLã\n * å¨éè¦æ¶èªå¨å°ä»£çéç½®åºç¨äº URLã\n * ä½¿ç¨ä¸åç CDN è®¾ç½®ï¼ä»¥ä¾¿é¾æ¥å°åå¸å¨å¤ä¸ªæå¡å¨ä¸­çåå®¹ã\n\n# URL å¶å®å±æ§\n\nä¸è¦ä»¥ä¸ºå¨@{...}è¡¨è¾¾å¼ä¸­åªæth:hrefå±æ§æ¥è¡¨ç¤º URL ã äºå®ä¸ï¼å®ä»¬å¯ä»¥ååéè¡¨è¾¾å¼(${...})ææ¶æ¯å¤é¨å/å½éå(ï¼{...})ä¸æ ·ç¨äºä»»ä½å°æ¹ã\n\nä¾å¦ï¼è¡¨åæäº¤æ¶ï¼å¯ä½¿ç¨ä»¥ä¸åæ³ -\n\n<form th:action="@{/order/processOrder}"></form>\n\n\næä½ä¸ºå¶ä»è¡¨è¾¾çä¸é¨åã å¦ä¸ä½ä¸ºå¤é¨å/å½éåå­ç¬¦ä¸²çåæ°:\n\n<p\n  th:text="#{orders.explanation(\'3\', @{/order/details(id=3,action=\'show_all\')})}"\n></p>\n\n\n# å¨ URL ä¸­ä½¿ç¨è¡¨è¾¾å¼\n\nä¸é¢æ¥ççï¼å¦ä¸æç¤ºç URL è¡¨è¾¾å¼:\n\n<a th:href="@{/order/details(id=3,action=\'show_all\')}"></a>\n\n\nä½3å\'show_all\'é½ä¸è½æ¯æå­å¼ï¼å ä¸ºåªæå¨è¿è¡æ¶æè½ç¥éå®ä»¬çå¼ï¼æä¹åï¼\n\n<a\n  th:href="@{/order/details(id=${order.id},action=(${user.admin} ? \'show_all\' : \'show_public\'))}"\n></a>\n\n\nä¸é¢ççå¦ä¸ä¸ª URL è¡¨è¾¾å¼ï¼å¦ä¸æç¤º:\n\n<a th:href="@{/order/details(id=${order.id})}"></a>\n\n\nå®å¶å®æ¯ä¸é¢ URL çä¸ä¸ªå¿«æ·æ¹å¼:\n\n<a th:href="@{\'/order/details\'(id=${order.id})}"></a>\n\n\nè¿æå³ç URL åºæ¬èº«å¯ä»¥è¢«æå®ä¸ºä¸ä¸ªè¡¨è¾¾å¼ï¼ä¾å¦ä¸ä¸ªåéè¡¨è¾¾å¼:\n\n<a th:href="@{${detailsURL}(id=${order.id})}"></a>\n\n\næå¤é¨å/å½éåçææ¬:\n\n<a th:href="@{#{orders.details.localized_url}(id=${order.id})}"></a>\n\n\nçè³å¯ä»¥ä½¿ç¨å¤æçè¡¨è¾¾å¼ï¼åæ¬æ¡ä»¶è¡¨è¾¾å¼ï¼ä¾å¦:\n\n<a\n  th:href="@{(${user.admin}? \'/admin/home\' : ${user.homeUrl})(id=${order.id})}"\n></a>\n\n\nå¦æè¦æ´æ¸æ´ï¼é£ä¹å¯ä»¥ä½¿ç¨th:with :\n\n<a\n  th:with="baseUrl=(${user.admin}? \'/admin/home\' : ${user.homeUrl})"\n  th:href="@{${baseUrl}(id=${order.id})}"\n></a>\n\n\nåæè -\n\n<div th:with="baseUrl=(${user.admin}? \'/admin/home\' : ${user.homeUrl})">\n  ...\n  <a th:href="@{${baseUrl}(id=${order.id})}">...</a>\n  ...\n</div>\n\n\n\n# æ©å±\n\nTODO\n\n\n# åèèµæ\n\n * Thymeleaf å®ç½\n * Thymeleaf Github\n * Thymeleaf æç¨',normalizedContent:'# thymeleaf å¿«éå¥é¨\n\n\n# æ åæ¹è¨\n\næ åæ¹è¨æ¯æ thymeleaf å®ä¹äºä¸ç»åè½ï¼è¿äºåè½åºè¯¥è¶³ä»¥æ»¡è¶³å¤§å¤æ°æåµãå¯ä»¥è¯å«è¿äºæ åæ¹è¨å¨æ¨¡æ¿ä¸­çä½¿ç¨ï¼å ä¸ºå®å°åå«ä»¥thåç¼å¼å¤´çå±æ§ï¼å¦<span th:text="...">ã\n\n\n# è¡¨è¾¾å¼\n\n${...} : åéè¡¨è¾¾å¼ã\n\n*{...} : éæ©è¡¨è¾¾å¼ã\n\n#{...} : æ¶æ¯ (i18n) è¡¨è¾¾å¼ã\n\n@{...} : é¾æ¥ (url) è¡¨è¾¾å¼ã\n\n~{...} : çæ®µè¡¨è¾¾å¼ã\n\n# åéè¡¨è¾¾å¼\n\nåéè¡¨è¾¾å¼æ¯ ognl è¡¨è¾¾å¼ - å¦æå° thymeleaf ä¸ spring - éæå¨ä¸ä¸æåéä¸(ä¹ç§°ä¸º spring æ¯è¯­ä¸­çæ¨¡åå±æ§)ï¼åä¸º spring elã å®ä»¬çèµ·æ¥åè¿æ ·:\n\n${session.user.name}\n\n\nå®ä»¬ä½ä¸ºå±æ§å¼æä½ä¸ºå®ä»¬çä¸é¨åï¼åå³äºå±æ§:\n\n<span th:text="${book.author.name}"></span>\n\n\nä¸é¢çè¡¨è¾¾å¼ä¸ä¸é¢æ¯ç¸åç(å¨ ognl å springel ä¸­):\n\n((book)context.getvariable("book")).getauthor().getname()\n\n\nä½æ¯ä¸ä»å¨æ¶åè¾åºçåºæ¯ä¸­æ¾å°åéè¡¨è¾¾å¼ï¼èä¸è¿å¯ä»¥ä½¿ç¨æ´å¤æçå¤çæ¹å¼ï¼å¦:æ¡ä»¶ï¼è¿­ä»£â¦ç­ç­ã\n\n<li th:each="book : ${books}"></li>\n\n\nè¿é${books}ä»ä¸ä¸æä¸­éæ©åä¸ºbooksçåéï¼å¹¶å¨th:eachä¸­ä½¿ç¨å¾ªç¯å°å¶è¯ä¼°ä¸ºè¿­ä»£å¨ã\n\n# éæ©è¡¨è¾¾å¼\n\néæ©è¡¨è¾¾å¼å°±ååéè¡¨è¾¾å¼ä¸æ ·ï¼å®ä»¬ä¸æ¯æ´ä¸ªä¸ä¸æåéæ å°ä¸æ§è¡ï¼èæ¯å¨ååéæ©çå¯¹è±¡ã å®ä»¬çèµ·æ¥åè¿æ ·:\n\n*{customer.name}\n\n\nå®ä»¬æä½ç¨çå¯¹è±¡ç±th:objectå±æ§æå®:\n\n<div th:object="${book}">\n  ...\n  <span th:text="*{title}">...</span>\n  ...\n</div>\n\n\næä»¥è¿ç¸å½äº:\n\n{\n  // th:object="${book}"\n  final book selection = (book) context.getvariable("book");\n  // th:text="*{title}"\n  output(selection.gettitle());\n}\n\n\n# æ¶æ¯(i18n)è¡¨è¾¾å¼\n\næ¶æ¯è¡¨è¾¾å¼(éå¸¸ç§°ä¸ºææ¬å¤é¨åï¼å½éåæ i18n)åè®¸ä»å¤é¨æº(å¦:.properties)æä»¶ä¸­æ£ç´¢ç¹å®äºè¯­è¨ç¯å¢çæ¶æ¯ï¼éè¿é®æ¥å¼ç¨è¿å¼ç¨æ¶æ¯ã\n\nå¨ spring åºç¨ç¨åºä¸­ï¼å®å°èªå¨ä¸ spring ç messagesource æºå¶éæãå¦ä¸ -\n\n#{main.title}\n#{message.entrycreated(${entryid})}\n\n\nä»¥ä¸æ¯å¨æ¨¡æ¿ä¸­ä½¿ç¨å®ä»¬çæ¹å¼:\n\n<table>\n  ...\n  <th th:text="#{header.address.city}">...</th>\n  <th th:text="#{header.address.country}">...</th>\n  ...\n</table>\n\n\nè¯·æ³¨æï¼å¦æå¸ææ¶æ¯é®ç±ä¸ä¸æåéçå¼ç¡®å®ï¼æèå¸æå°åéæå®ä¸ºåæ°ï¼åå¯ä»¥å¨æ¶æ¯è¡¨è¾¾å¼ä¸­ä½¿ç¨åéè¡¨è¾¾å¼:\n\n#{${config.adminwelcomekey}(${session.user.name})} jsp\n\n\n# é¾æ¥(url)è¡¨è¾¾å¼\n\né¾æ¥è¡¨è¾¾å¼å¨æå»º url å¹¶åå¶æ·»å æç¨çä¸ä¸æåä¼è¯ä¿¡æ¯(éå¸¸ç§°ä¸º url éåçè¿ç¨)ã å æ­¤ï¼å¯¹äºé¨ç½²å¨ web æå¡å¨ç/myappä¸ä¸æä¸­ç web åºç¨ç¨åºï¼å¯ä»¥ä½¿ç¨ä»¥ä¸è¡¨è¾¾å¼:\n\n<a th:href="@{/order/list}">...</a>\n\n\nå¯ä»¥è½¬æ¢æå¦ä¸çä¸è¥¿:\n\n<a href="/myapp/order/list">...</a>\n\n\nçè³ï¼å¦æéè¦ä¿æä¼è¯ï¼å¹¶ä¸ cookie æªå¯ç¨(æèæå¡å¨è¿ä¸ç¥é)ï¼é£ä¹çæçæ ¼å¼ä¸º:\n\n<a href="/myapp/order/list;jsessionid=s2ds3fa31abd241e2a01932">...</a> html\n\n\nç½åä¹å¯ä»¥å¸¦åæ°ï¼å¦ä¸æç¤º:\n\n<a th:href="@{/order/details(id=${orderid},type=${ordertype})}">...</a>\n\n\nè¿å°äº§çç±»ä¼¼ä»¥ä¸çç»æ -\n\n\x3c!-- æ³¨æï¼ç¬¦å·ä¼å¨æ ç­¾å±æ§ä¸­è¿è¡htmlè½¬ä¹... --\x3e\n<a href="/myapp/order/details?id=23&type=online">...</a>\n\n\né¾æ¥è¡¨è¾¾å¼å¯ä»¥æ¯ç¸å¯¹çï¼å¨è¿ç§æåµä¸ï¼åºç¨ç¨åºä¸ä¸æå°ä¸ä¼è¢«å å° url çåé¢:\n\n<a th:href="@{../documents/report}">...</a>\n\n\nä¹æ¯æå¡å¨ç¸å¯¹ç(åæ ·ï¼æ²¡æåºç¨ç¨åºä¸ä¸æçåç¼):\n\n<a th:href="@{~/contents/main}">...</a>\n\n\nååè®®ç¸å³(å°±åç»å¯¹ url ä¸æ ·ï¼ä½æµè§å¨å°ä½¿ç¨ä¸æ­£å¨æ¾ç¤ºçé¡µé¢ç¸åç http æ https åè®®):\n\n<a th:href="@{//static.mycompany.com/res/initial}">...</a>\n\n\nå½ç¶ï¼é¾æ¥è¡¨è¾¾å¼ä¹å¯ä»¥æ¯ç»å¯¹ç:\n\n<a th:href="@{http://www.mycompany.com/main}">...</a>\n\n\nä½æ¯ç»å¯¹(æåè®®ç¸å¯¹)url ï¼å¨ thymeleaf é¾æ¥è¡¨è¾¾å¼ä¸­åºè¯¥æ·»å ä»ä¹å¼ï¼ å¾ç®å:ç±ååºè¿æ»¤å¨å®ä¹ url éå:å¨åºäº servlet ç web åºç¨ç¨åºä¸­ï¼å¯¹äºæ¯ä¸ªè¾åºç url(ä¸ä¸æç¸å¯¹ï¼ç¸å¯¹ï¼ç»å¯¹â¦)ï¼å¨æ¾ç¤º url ä¹åï¼thymeleaf æ»æ¯è°ç¨httpservletresponse.encodeurl(...)æºå¶ã è¿æå³çä¸ä¸ªè¿æ»¤å¨å¯ä»¥éè¿åè£ httpservletresponse å¯¹è±¡æ¥ä¸ºåºç¨ç¨åºæ§è¡èªå®ä¹ç url éåã\n\n# çæ®µè¡¨è¾¾å¼\n\nçæ®µè¡¨è¾¾å¼æ¯ä¸ç§ç®åçæ¹æ³ç¨æ¥è¡¨ç¤ºæ è®°ççæ®µå¹¶å°å¶ç§»å¨å°æ¨¡æ¿ä¸­ã ç±äºè¿äºè¡¨è¾¾å¼ï¼çæ®µå¯ä»¥è¢«å¤å¶ï¼ä¼ éç»å¶ä»æ¨¡æ¿çåæ°ç­ç­ã\n\næå¸¸è§çæ¯ä½¿ç¨th:insertæth:replaceæ¥æå¥çæ®µ:\n\n<div th:insert="~{commons :: main}">...</div>\n\n\nä½æ¯å®ä»¬å¯ä»¥å¨ä»»ä½å°æ¹ä½¿ç¨ï¼å°±åä»»ä½å¶ä»åéä¸æ ·:\n\n<div th:with="frag=~{footer :: #main/text()}">\n  <p th:insert="${frag}"></p>\n</div>\n\n\nçæ®µè¡¨è¾¾å¼å¯ä»¥æåæ°ã\n\n# è¡¨è¾¾å¼é¢å¤ç\n\nå³äºè¡¨è¾¾å¼çæåä¸ä»¶äºæ¯ç¥éè¡¨è¾¾å¼é¢å¤çï¼å¨__ä¹é´æå®ï¼å¦ä¸æç¤º:\n\n#{selection.__${sel.code}__}\n\n\nä¸é¢ä»£ç ä¸­ï¼ç¬¬ä¸ä¸ªè¢«æ§è¡çåéè¡¨è¾¾å¼æ¯:${sel.code}ï¼å¹¶ä¸å°ä½¿ç¨å®çç»æä½ä¸ºè¡¨è¾¾å¼çä¸é¨å(åè®¾${sel.code}çç»æä¸º:all)ï¼å¨æ­¤å¤æ§è¡å½éåçæåµä¸(è¿å°æ¥æ¾ä¸å³é®selection.allæ¶æ¯)ã\n\n\n# æå­åæä½\n\næå¾å¤ç±»åçæå­åæä½å¯ç¨ï¼å®ä»¬åå«å¦ä¸:\n\n * æå­\n   * ææ¬æå­ï¼ä¾å¦:\'one text\', \'another one!\',â¦\n   * æ°å­æå­ï¼ä¾å¦:0,10, 314, 31.01, 112.83,â¦\n   * å¸å°æå­ï¼ä¾å¦:true,false\n   * null æå­ï¼ä¾å¦:null\n   * æå­æ è®°ï¼ä¾å¦:one, sometext, main,â¦\n * ææ¬æä½:\n   * å­ç¬¦ä¸²è¿æ¥:+\n   * æå­æ¿æ¢:|the name is ${name}|\n * ç®æ¯è¿ç®:\n   * äºè¿å¶æä½:+, -, *, /, %\n   * åå·(ä¸åè¿ç®ç¬¦):-\n * å¸å°è¿ç®:\n   * äºè¿å¶è¿ç®ç¬¦ï¼and,or\n   * å¸å°å¦å®(ä¸åè¿ç®ç¬¦):!,not\n * æ¯è¾åç¸ç­:\n   * æ¯è¾è¿ç®ç¬¦:>,<,>=,<=(gt,lt,ge,le)\n   * ç¸ç­è¿ç®ç¬¦:==, != (eq, ne)\n * æ¡ä»¶æä½ç¬¦:\n   * if-then:(if) ? (then)\n   * if-then-else:(if) ? (then) : (else)\n   * default: (value) ?: (defaultvalue)\n\n\n# åºæ¬å±æ§\n\nä¸é¢æ¥ççæ åæ¹è¨ä¸­çå ä¸ªæåºæ¬çå±æ§ã ä»th:ææ¬å¼å§ï¼å®ä»£æ¿äºæ ç­¾çä¸»ä½:\n\n<p th:text="#{msg.welcome}">welcome everyone!</p>\n\n\nç°å¨ï¼th:eachéå¤å®æå¨åç´ çæ¬¡æ°ï¼ç±å®çè¡¨è¾¾å¼è¿åçæ°ç»æåè¡¨ææå®çæ¬¡æ°ï¼ä¸ºè¿­ä»£åç´ åå»ºä¸ä¸ªåé¨åéï¼å¶è¯­æ³ä¸ java ç foreach è¡¨è¾¾å¼ç¸å:\n\n<li th:each="book : ${books}" th:text="${book.title}">\n  en las orillas del sar\n</li>\n\n\næåï¼thymeleaf ä¸ºç¹å®ç xhtml å html5 å±æ§æä¾äºè®¸å¤thå±æ§ï¼è¿äºå±æ§åªè¯ä¼°å®ä»¬çè¡¨è¾¾å¼ï¼å¹¶å°è¿äºå±æ§çå¼è®¾ç½®ä¸ºç»æã\n\n<form th:action="@{/createorder}">\n  <input type="button" th:value="#{form.submit}" />\n  <a th:href="@{/admin/users}"></a>\n</form>\n\n\n\n# æ å url\n\nthymeleaf æ åæ¹è¨(ç§°ä¸º standard å springstandard)æä¾äºä¸ç§å¨ web åºç¨ç¨åºä¸­è½»æ¾åå»º url çæ¹æ³ï¼ä»¥ä¾¿å®ä»¬åå«ä»»ä½æéç url å·¥ä»¶ã è¿æ¯éè¿è¿æ¥è¡¨è¾¾æ¹å¼æ¥å®æçï¼è¿æ¯ä¸ç§ç±»ä¼¼äº thymeleaf æ åçè¡¨ç°:@{...}\n\n# ç»å¯¹ç½å\n\nç»å¯¹ url ç¨äºåå»ºå°å¶ä»æå¡å¨çé¾æ¥ãå®ä»¬éè¦æå®ä¸ä¸ªåè®®åç§°(http://æhttps://)å¼å¤´ã\n\n<a th:href="@{https://www.yiibai.com/thymeleaf/}"></a>\n\n\nä¸é¢é¾æ¥ä¸ä¼è¢«ä¿®æ¹ï¼é¤éå¨æå¡å¨ä¸éç½®äº url éåè¿æ»¤å¨ï¼å¹¶å¨httpservletresponse.encodeurl(...)æ¹æ³ä¸­æ§è¡ä¿®æ¹ãæåçæç html ä»£ç å¦ä¸:\n\n<a href="https://www.yiibai.com/thymeleaf/"></a>\n\n\n# ä¸ä¸æç¸å³ url\n\næå¸¸ç¨ç url ç±»åæ¯ä¸ä¸æç¸å³çã è¿äº url æ¯ä¸æ¦å®è£å¨æå¡å¨ä¸ï¼å°±ä¼ä¸ web åºç¨ç¨åºæ ¹ç¸å³è urlã ä¾å¦ï¼å¦æå°ä¸ä¸ªåç§°ä¸ºmyapp.warçæä»¶é¨ç½²å°ä¸ä¸ª tomcat æå¡å¨ä¸­ï¼é£ä¹åºç¨ç¨åºä¸è¬æ¯éè¿ url:http://localhost:8080/myappæ¥è®¿é®ï¼myappå°±æ¯ä¸ä¸æåç§°ã\n\nä¸ä¸ä¸æç¸å³ç url ä»¥/å­ç¬¦å¼å¤´:\n\n<a th:href="@{/order/list}"></a>\n\n\nå¦æåºç¨ç¨åºè®¿é® url ä¸º:http://localhost:8080/myappï¼åæ­¤ url å°è¾åº:\n\n<a href="/myapp/order/list"></a>\n\n\n# ä¸æå¡å¨ç¸å³ url\n\næå¡å¨ç¸å³ç url ä¸ä¸ä¸æç¸å³ç url éå¸¸ç¸ä¼¼ï¼åªæ¯å®ä»¬ä¸åå® url è¦é¾æ¥å°åºç¨ç¨åºä¸ä¸æä¸­çèµæºï¼å æ­¤åè®¸é¾æ¥å°åä¸æå¡å¨ä¸­çä¸åä¸ä¸æ:\n\n<a th:href="@{~/billing-app/showdetails.html}"></a>\n\n\nå½ååºç¨ç¨åºçä¸ä¸æå°è¢«å¿½ç¥ï¼å æ­¤å°½ç®¡åºç¨ç¨åºé¨ç½²å¨http:// localhost:8080 / myappï¼ä½è¯¥ url å°è¾åº:\n\n<a href="/billing-app/showdetails.html"></a>\n\n\n# åè®®ç¸å³ url\n\nä¸åè®®ç¸å³ç url å®éä¸æ¯ç»å¯¹ç urlï¼å®å°ä¿æç¨äºæ¾ç¤ºå½åé¡µé¢çåè®®(httpï¼https)ã å®ä»¬éå¸¸ç¨äºåæ¬æ ·å¼ï¼èæ¬ç­å¤é¨èµæº:\n\n<script th:src="@{//scriptserver.example.net/myscript.js}">\n  ...\n<\/script>\n\n\nå®å°åç°ä¸ä¸é¢ä¸è´ç url(url éåé¤å¤)ï¼å¦:\n\n<script src="//scriptserver.example.net/myscript.js">\n  ...\n<\/script>\n\n\n# æ·»å åæ°\n\nå¦ä½åä½¿ç¨@{...}è¡¨è¾¾å¼åå»ºç url æ·»å åæ°ï¼ è¿ä¹å¾ç®å:\n\n<a th:href="@{/order/details(id=3)}"></a>\n\n\nä¸é¢ç¤ºä¾ä»£ç ï¼æç»å°è¾åºä¸º:\n\n<a href="/order/details?id=3"></a>\n\n\nä¹å¯ä»¥æ·»å å ä¸ªåæ°ï¼ç¨éå·åéå®ä»¬:\n\n<a th:href="@{/order/details(id=3,action=\'show_all\')}"></a>\n\n\nä¸é¢ä»£ç å°è¾åºç»æä¸º:\n\n\x3c!-- æ³¨æï¼ç¬¦å·å¨æ ç­¾å±æ§ä¸­è¿è¡htmlè½¬ä¹... --\x3e\n<a href="/order/details?id=3&action=show_all"></a>\n\n\nè¿å¯ä»¥ä½¿ç¨æ­£å¸¸åæ°çè·¯å¾åéçå½¢å¼åå«åæ°ï¼ä½å¨ url çè·¯å¾ä¸­æå®ä¸ä¸ªå ä½ç¬¦:\n\n<a th:href="@{/order/{id}/details(id=3,action=\'show_all\')}"></a>\n\n\nä¸é¢è¾åºç»æä¸º:\n\n<a href="/order/3/details?action=show_all"></a>\n\n\n# ç½åçæ®µæ è¯ç¬¦\n\nçæ®µæ è¯ç¬¦å¯ä»¥åå«å¨ url ä¸­ï¼åå«åæ°åä¸åå«åæ°ã å®ä»¬å°å§ç»åå«å¨ç½åçåºç¡ä¸ï¼åèä»¥ä¸ä»£ç :\n\n<a th:href="@{/home#all_info(action=\'show\')}"></a>\n\n\næ§è¡è¾åºç»æå¦ä¸ -\n\n<a href="/home?action=show#all_info">\n\n\n# url éå\n\nthymeleaf åè®¸å¨åºç¨ç¨åºä¸­éç½® url éåè¿æ»¤å¨ï¼å®éè¿è°ç¨ thymeleaf æ¨¡æ¿çæçæ¯ä¸ª url ç servlet api çjavax.servlet.http.httpservletresponseç±»ä¸­çresponse.encodeurl()æ¹æ³æ¥å®ç°ã\n\nä¸é¢å¨ java web åºç¨ç¨åºä¸­æ¯æ url éåæä½çæ åæ¹å¼ï¼å¹¶åè®¸ url:\n\n * èªå¨æ£æµç¨æ·æ¯å¦å¯ç¨äº cookieï¼å¦ææªå¯ç¨æèå¦æå®æ¯ç¬¬ä¸ä¸ªè¯·æ±å¹¶ä¸ cookie éç½®ä»æªç¥ãåå°;jsessionid=...çæ®µæ·»å å° urlã\n * å¨éè¦æ¶èªå¨å°ä»£çéç½®åºç¨äº urlã\n * ä½¿ç¨ä¸åç cdn è®¾ç½®ï¼ä»¥ä¾¿é¾æ¥å°åå¸å¨å¤ä¸ªæå¡å¨ä¸­çåå®¹ã\n\n# url å¶å®å±æ§\n\nä¸è¦ä»¥ä¸ºå¨@{...}è¡¨è¾¾å¼ä¸­åªæth:hrefå±æ§æ¥è¡¨ç¤º url ã äºå®ä¸ï¼å®ä»¬å¯ä»¥ååéè¡¨è¾¾å¼(${...})ææ¶æ¯å¤é¨å/å½éå(ï¼{...})ä¸æ ·ç¨äºä»»ä½å°æ¹ã\n\nä¾å¦ï¼è¡¨åæäº¤æ¶ï¼å¯ä½¿ç¨ä»¥ä¸åæ³ -\n\n<form th:action="@{/order/processorder}"></form>\n\n\næä½ä¸ºå¶ä»è¡¨è¾¾çä¸é¨åã å¦ä¸ä½ä¸ºå¤é¨å/å½éåå­ç¬¦ä¸²çåæ°:\n\n<p\n  th:text="#{orders.explanation(\'3\', @{/order/details(id=3,action=\'show_all\')})}"\n></p>\n\n\n# å¨ url ä¸­ä½¿ç¨è¡¨è¾¾å¼\n\nä¸é¢æ¥ççï¼å¦ä¸æç¤ºç url è¡¨è¾¾å¼:\n\n<a th:href="@{/order/details(id=3,action=\'show_all\')}"></a>\n\n\nä½3å\'show_all\'é½ä¸è½æ¯æå­å¼ï¼å ä¸ºåªæå¨è¿è¡æ¶æè½ç¥éå®ä»¬çå¼ï¼æä¹åï¼\n\n<a\n  th:href="@{/order/details(id=${order.id},action=(${user.admin} ? \'show_all\' : \'show_public\'))}"\n></a>\n\n\nä¸é¢ççå¦ä¸ä¸ª url è¡¨è¾¾å¼ï¼å¦ä¸æç¤º:\n\n<a th:href="@{/order/details(id=${order.id})}"></a>\n\n\nå®å¶å®æ¯ä¸é¢ url çä¸ä¸ªå¿«æ·æ¹å¼:\n\n<a th:href="@{\'/order/details\'(id=${order.id})}"></a>\n\n\nè¿æå³ç url åºæ¬èº«å¯ä»¥è¢«æå®ä¸ºä¸ä¸ªè¡¨è¾¾å¼ï¼ä¾å¦ä¸ä¸ªåéè¡¨è¾¾å¼:\n\n<a th:href="@{${detailsurl}(id=${order.id})}"></a>\n\n\næå¤é¨å/å½éåçææ¬:\n\n<a th:href="@{#{orders.details.localized_url}(id=${order.id})}"></a>\n\n\nçè³å¯ä»¥ä½¿ç¨å¤æçè¡¨è¾¾å¼ï¼åæ¬æ¡ä»¶è¡¨è¾¾å¼ï¼ä¾å¦:\n\n<a\n  th:href="@{(${user.admin}? \'/admin/home\' : ${user.homeurl})(id=${order.id})}"\n></a>\n\n\nå¦æè¦æ´æ¸æ´ï¼é£ä¹å¯ä»¥ä½¿ç¨th:with :\n\n<a\n  th:with="baseurl=(${user.admin}? \'/admin/home\' : ${user.homeurl})"\n  th:href="@{${baseurl}(id=${order.id})}"\n></a>\n\n\nåæè -\n\n<div th:with="baseurl=(${user.admin}? \'/admin/home\' : ${user.homeurl})">\n  ...\n  <a th:href="@{${baseurl}(id=${order.id})}">...</a>\n  ...\n</div>\n\n\n\n# æ©å±\n\ntodo\n\n\n# åèèµæ\n\n * thymeleaf å®ç½\n * thymeleaf github\n * thymeleaf æç¨',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Velocity å¿«éå¥é¨",frontmatter:{title:"Velocity å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æ¨¡æ¿å¼æ"],tags:["Java","æ¨¡æ¿å¼æ","Velocity"],abbrlink:"bed8d6a9",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/7ecb81/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/03.%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/03.Velocity.html",relativePath:"12.å·¥å·/03.æ¨¡æ¿å¼æ/03.Velocity.md",key:"v-a63f00f0",path:"/pages/7ecb81/",headers:[{level:2,title:"æ³¨é",slug:"æ³¨é",normalizedTitle:"æ³¨é",charIndex:247},{level:2,title:"å¼ç¨",slug:"å¼ç¨",normalizedTitle:"å¼ç¨",charIndex:64},{level:3,title:"åé",slug:"åé",normalizedTitle:"åé",charIndex:667},{level:3,title:"å±æ§",slug:"å±æ§",normalizedTitle:"å±æ§",charIndex:670},{level:3,title:"æ¹æ³",slug:"æ¹æ³",normalizedTitle:"æ¹æ³",charIndex:78},{level:2,title:"èµå¼",slug:"èµå¼",normalizedTitle:"èµå¼",charIndex:947},{level:2,title:"å­ç¬¦ä¸²",slug:"å­ç¬¦ä¸²",normalizedTitle:"å­ç¬¦ä¸²",charIndex:1802},{level:2,title:"æ¡ä»¶",slug:"æ¡ä»¶",normalizedTitle:"æ¡ä»¶",charIndex:1952},{level:2,title:"é»è¾",slug:"é»è¾",normalizedTitle:"é»è¾",charIndex:2192},{level:2,title:"å¾ªç¯",slug:"å¾ªç¯",normalizedTitle:"å¾ªç¯",charIndex:2401},{level:2,title:"åå«",slug:"åå«",normalizedTitle:"åå«",charIndex:2507},{level:2,title:"è§£æ",slug:"è§£æ",normalizedTitle:"è§£æ",charIndex:1832},{level:2,title:"åæ­¢",slug:"åæ­¢",normalizedTitle:"åæ­¢",charIndex:2818},{level:2,title:"å®",slug:"å®",normalizedTitle:"å®",charIndex:2873},{level:2,title:"è½¬ä¹",slug:"è½¬ä¹",normalizedTitle:"è½¬ä¹",charIndex:3566},{level:2,title:"è¯­ä¹è¦ç¹",slug:"è¯­ä¹è¦ç¹",normalizedTitle:"è¯­ä¹è¦ç¹",charIndex:3712},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:4105}],headersStr:"æ³¨é å¼ç¨ åé å±æ§ æ¹æ³ èµå¼ å­ç¬¦ä¸² æ¡ä»¶ é»è¾ å¾ªç¯ åå« è§£æ åæ­¢ å® è½¬ä¹ è¯­ä¹è¦ç¹ åèèµæ",content:'# Velocity å¿«éå¥é¨\n\nVelocity ï¼ç®ç§° VTLï¼æ¯ä¸ä¸ªåºäº Java çæ¨¡çå¼æãå®åè®¸ web é¡µé¢è®¾è®¡èå¼ç¨ JAVA ä»£ç é¢å®ä¹çæ¹æ³ãWeb è®¾è®¡èå¯ä»¥æ ¹æ® MVC æ¨¡å¼å JAVA ç¨åºåå¹¶è¡å·¥ä½ï¼è¿æå³ç Web è®¾è®¡èå¯ä»¥åç¬ä¸æ³¨äºè®¾è®¡è¯å¥½çç«ç¹ï¼èç¨åºååå¯åç¬ä¸æ³¨äºç¼ååºå±ä»£ç ãVelocity å° Java ä»£ç ä» web é¡µé¢ä¸­åç¦»åºæ¥ï¼ä½¿ç«ç¹å¨é¿æ¶é´è¿è¡åä»ç¶å·æå¾å¥½çå¯ç»´æ¤æ§ï¼å¹¶æä¾äºä¸ä¸ªé¤ JSP å PHP ä¹å¤çå¯è¡çè¢«éæ¹æ¡ã\n\n\n# æ³¨é\n\nåè¡æ³¨éä»¥##å¼å§ï¼å¹¶å¨æ¬è¡ç»æã\n\n## This is a single line comment.\n\n\nå¤è¡æ³¨éï¼ä»¥ # å¼å§å¹¶ä»¥ # ç»æå¯ä»¥å¤çè¿ç§æåµã\n\n#*\n Thus begins a multi-line comment. Online visitors won\'t\n see this text because the Velocity Templating Engine will\n ignore it.\n*#\n\n\næ³¨éå ï¼å¯ä»¥ç¨æ¥å­å¨è¯¸å¦ææ¡£ä½èãçæ¬ä¿¡æ¯ç­ã\n\n#**\nThis is a VTL comment block and\nmay be used to store such information\nas the document author and versioning\ninformation:\n@author\n@version 5\n*#\n\n\n\n# å¼ç¨\n\nVTL ä¸­æä¸ç§ç±»åçå¼ç¨ï¼åéï¼å±æ§åæ¹æ³ã\n\n\n# åé\n\nåéï¼Variablesï¼çç®ç¥æ è®°æ¯æä¸ä¸ªåå¯¼ $ å­ç¬¦åè·ä¸ä¸ª VTL æ è¯ç¬¦ï¼Identifier.ï¼ç»æãä¸ä¸ª VTL æ è¯ç¬¦å¿é¡»ä»¥ä¸ä¸ªå­æ¯å¼å§(a .. z æ A .. Z)ã\n\nå©ä¸çå­ç¬¦å°ç±ä»¥ä¸ç±»åçå­ç¬¦ç»æï¼\n\n * å­æ¯ (a .. z, A .. Z)\n * æ°å­ (0 .. 9)\n * è¿å­ç¬¦("-")\n * ä¸åçº¿ ("_")\n\nç¤ºä¾ï¼ææåé\n\n## ææåéåéå\n$foo\n$mudSlinger\n$mud-slinger\n$mud_slinger\n$mudSlinger1\n\n## ç»åéèµå¼\n#set( $foo = "bar" )\n\n\n\n# å±æ§\n\nVTL å¼ç¨çç¬¬äºç§åç´ æ¯å±æ§ï¼èå±æ§å·æç¬ç¹çæ ¼å¼ãå±æ§çç®ç¥æ è®°è¯åå¯¼ç¬¦ $ åè·ä¸ä¸ª VTL æ è¯ç¬¦ï¼å¨åè·ä¸ä¸ªç¹å·(".")æååæ¯ä¸ä¸ª VTL æ è¯ç¬¦ã\n\nç¤ºä¾ï¼ææå±æ§\n\n$customer.Address\n$purchase.Total\n\n\n\n# æ¹æ³\n\næ¹æ³å¨ JAVA ä»£ç ä¸­å®ä¹ï¼å¹¶ä½ä¸äºæç¨çäºæï¼æ¯å¦è¿è¡ä¸ä¸ªè®¡ç®å¨æèä½åºä¸ä¸ªå³å®ãæ¹æ³æ¯å®éä¸ä¹æ¯å¼ç¨ï¼ç±åå¯¼ç¬¦ $ åè·ä¸ä¸ª VTL æ è¯ç¬¦ï¼åè·ä¸ä¸ª VTL æ¹æ³ä½ï¼Method Bodyï¼ã VTL æ¹æ³ä½ç±ä¸ä¸ª VTL æ è¯ç¬¦åè·ä¸ä¸ªå·¦æ¬å·ï¼åè·å¯éçåæ°åè¡¨ï¼æåæ¯å³æ¬å·ã\n\nç¤ºä¾ï¼æææ¹æ³\n\n$customer.getAddress()\n$purchase.getTotal()\n$page.setTitle( "My Home Page" )\n$person.setAttributes( ["Strange", "Weird", "Excited"] )\n\n\n\n# èµå¼\n\n#set æä»¤ç¨æ¥ä¸ºå¼ç¨è®¾ç½®ç¸åºçå¼ãå¼å¯ä»¥è¢«å¼æ´¾ç»åéå¼ç¨æèæ¯å±æ§å¼ç¨ï¼èä¸èµå¼è¦å¨æ¬å·éæ¬èµ·æ¥ã\n\n#set( $monkey = $bill ) ## variable reference\n#set( $monkey.Friend = "monica" ) ## string literal\n#set( $monkey.Blame = $whitehouse.Leak ) ## property reference\n#set( $monkey.Plan = $spindoctor.weave($web) ) ## method reference\n#set( $monkey.Number = 123 ) ##number literal\n#set( $monkey.Say = ["Not", $my, "fault"] ) ## ArrayList\n\n\n\n# å­ç¬¦ä¸²\n\nä½¿ç¨ #set æä»¤æ¶ï¼æ¬å¨åå¼å·ä¸­çå­é¢å­ç¬¦ä¸²å°è§£æåéæ°è§£é ã ç¶èï¼å½å­é¢å­ç¬¦ä¸²æ¬å¨åå¼å·ä¸­æ¶ï¼ä¸è¢«è§£æï¼\n\nç¤ºä¾ï¼\n\n#set( $foo = "bar" )\n$foo\n#set( $blargh = \'$foo\' )\n$blargh\n\n\nè¾åºï¼\n\nBar\n $foo\n\n\n\n# æ¡ä»¶\n\nVTL ä½¿ç¨ #Ifã#elseifã#else æä»¤åæ¡ä»¶è¯­å¥æ§å¶ã\n\nç¤ºä¾ï¼\n\n#if( $foo < 10 )\n    <strong>Go North</strong>\n#elseif( $foo == 10 )\n    <strong>Go East</strong>\n#elseif( $bar == 6 )\n    <strong>Go South</strong>\n#else\n    <strong>Go West</strong>\n#end\n\n\n\n# é»è¾\n\nVTL æ¯æä¸ï¼&&ï¼ãæï¼||ï¼ãéï¼!ï¼é»è¾å¤æ­ã\n\nç¤ºä¾ï¼\n\n#if( $foo && $bar )\n   <strong> This AND that</strong>\n#end\n\n#if( $foo || $bar )\n    <strong>This or That</strong>\n#end\n\n#if( !$foo )\n <strong>NOT that</strong>\n#end\n\n\n\n# å¾ªç¯\n\nVTL éè¿ #foreach æ¯æå¾ªç¯\n\n<ul>\n#foreach( $product in $allProducts )\n    <li>$product</li>\n#end\n</ul>\n\n\n\n# åå«\n\nVTL éè¿ #include æ¥å¯¼å¥å¶ä»æä»¶ã\n\nç¤ºä¾ï¼\n\n#include( "one.txt" )\n\n#include( "one.gif","two.txt","three.htm" )\n\n#include( "greetings.txt", $seasonalstock )\n\n\n\n# è§£æ\n\nVTL éè¿ #parse å¯¼å¥å¶ä» vm æä»¶ã\n\n$count\n#set( $count = $count - 1 )\n#if( $count > 0 )\n    #parse( "parsefoo.vm" )\n#else\n    All done with parsefoo.vm!\n#end\n\n\n\n# åæ­¢\n\nVTL ä½¿ç¨ #stop åæ­¢æ¨¡æ¿å¼æçæ§è¡ï¼å¹¶è¿åãè¿éå¸¸ç¨ä½è°è¯ã\n\n#stop ##\n\n\n\n# å®\n\nVTL ä½¿ç¨ #macro å #end éåæ¥å®ä¹å®ï¼ä»¥æ­¤å®ç°èªå®ä¹æä»¤ã\n\nç¤ºä¾ä¸ï¼\n\n## å®ä¹å®\n#macro( d )\n<tr><td></td></tr>\n#end\n\n## ä½¿ç¨å®\n#d()\n\n\nç¤ºä¾äºï¼\n\n## å®ä¹å®\n#macro( tablerows $color $somelist )\n  #foreach( $something in $somelist )\n    <tr><td bgcolor=$color>$something</td></tr>\n  #end\n#end\n\n## ä½¿ç¨å®\n#set( $greatlakes = ["Superior","Michigan","Huron","Erie","Ontario"] )\n#set( $color = "blue" )\n<table>\n    #tablerows( $color $greatlakes )\n</table>\n\n\nè¾åºï¼\n\n<table>\n  <tr>\n    <td bgcolor="blue">Superior</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">Michigan</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">Huron</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">Erie</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">Ontario</td>\n  </tr>\n</table>\n\n\n\n# è½¬ä¹\n\nVTL ä½¿ç¨ \\ ç¬¦å·æ¥è¿è¡å­ç¬¦è½¬ä¹ã\n\nç¤ºä¾ä¸\n\n## The following line defines $email in this template:\n#set( $email = "foo" )\n$email\n\\$email\n\n\nè¾åºï¼\n\nfoo\n$email\n\n\n\n# è¯­ä¹è¦ç¹\n\nVelocity æä¸äºè¯­ä¹è¦ç¹ï¼å®¹æäº§çæ­§ä¹ï¼è¿éå½çº³ä¸ä¸ã\n\nï¼1ï¼Velocity çè¡ä¸ºå¹¶ä¸åç©ºæ ¼çå½±åã\n\nç¤ºä¾ï¼ä»¥ä¸ä¸ç§åæ³ææä¸è´\n\n## åæ³ä¸\nSend me #set($foo = ["$10 and ","a cake"])#foreach($a in $foo)$a #end please.\n\n## åæ³äº\nSend me\n#set( $foo = ["$10 and ","a cake"] )\n#foreach( $a in $foo )\n$a\n#end\nplease.\n\n## åæ³ä¸\nSend me\n#set($foo       = ["$10 and ","a cake"])\n                 #foreach           ($a in $foo )$a\n         #end please.\n\n\n\n# åèèµæ\n\n * Velocity Github\n * Velocity å®ç½\n * Velocity ä¸­æææ¡£\n * velocity-spring-boot-project',normalizedContent:'# velocity å¿«éå¥é¨\n\nvelocity ï¼ç®ç§° vtlï¼æ¯ä¸ä¸ªåºäº java çæ¨¡çå¼æãå®åè®¸ web é¡µé¢è®¾è®¡èå¼ç¨ java ä»£ç é¢å®ä¹çæ¹æ³ãweb è®¾è®¡èå¯ä»¥æ ¹æ® mvc æ¨¡å¼å java ç¨åºåå¹¶è¡å·¥ä½ï¼è¿æå³ç web è®¾è®¡èå¯ä»¥åç¬ä¸æ³¨äºè®¾è®¡è¯å¥½çç«ç¹ï¼èç¨åºååå¯åç¬ä¸æ³¨äºç¼ååºå±ä»£ç ãvelocity å° java ä»£ç ä» web é¡µé¢ä¸­åç¦»åºæ¥ï¼ä½¿ç«ç¹å¨é¿æ¶é´è¿è¡åä»ç¶å·æå¾å¥½çå¯ç»´æ¤æ§ï¼å¹¶æä¾äºä¸ä¸ªé¤ jsp å php ä¹å¤çå¯è¡çè¢«éæ¹æ¡ã\n\n\n# æ³¨é\n\nåè¡æ³¨éä»¥##å¼å§ï¼å¹¶å¨æ¬è¡ç»æã\n\n## this is a single line comment.\n\n\nå¤è¡æ³¨éï¼ä»¥ # å¼å§å¹¶ä»¥ # ç»æå¯ä»¥å¤çè¿ç§æåµã\n\n#*\n thus begins a multi-line comment. online visitors won\'t\n see this text because the velocity templating engine will\n ignore it.\n*#\n\n\næ³¨éå ï¼å¯ä»¥ç¨æ¥å­å¨è¯¸å¦ææ¡£ä½èãçæ¬ä¿¡æ¯ç­ã\n\n#**\nthis is a vtl comment block and\nmay be used to store such information\nas the document author and versioning\ninformation:\n@author\n@version 5\n*#\n\n\n\n# å¼ç¨\n\nvtl ä¸­æä¸ç§ç±»åçå¼ç¨ï¼åéï¼å±æ§åæ¹æ³ã\n\n\n# åé\n\nåéï¼variablesï¼çç®ç¥æ è®°æ¯æä¸ä¸ªåå¯¼ $ å­ç¬¦åè·ä¸ä¸ª vtl æ è¯ç¬¦ï¼identifier.ï¼ç»æãä¸ä¸ª vtl æ è¯ç¬¦å¿é¡»ä»¥ä¸ä¸ªå­æ¯å¼å§(a .. z æ a .. z)ã\n\nå©ä¸çå­ç¬¦å°ç±ä»¥ä¸ç±»åçå­ç¬¦ç»æï¼\n\n * å­æ¯ (a .. z, a .. z)\n * æ°å­ (0 .. 9)\n * è¿å­ç¬¦("-")\n * ä¸åçº¿ ("_")\n\nç¤ºä¾ï¼ææåé\n\n## ææåéåéå\n$foo\n$mudslinger\n$mud-slinger\n$mud_slinger\n$mudslinger1\n\n## ç»åéèµå¼\n#set( $foo = "bar" )\n\n\n\n# å±æ§\n\nvtl å¼ç¨çç¬¬äºç§åç´ æ¯å±æ§ï¼èå±æ§å·æç¬ç¹çæ ¼å¼ãå±æ§çç®ç¥æ è®°è¯åå¯¼ç¬¦ $ åè·ä¸ä¸ª vtl æ è¯ç¬¦ï¼å¨åè·ä¸ä¸ªç¹å·(".")æååæ¯ä¸ä¸ª vtl æ è¯ç¬¦ã\n\nç¤ºä¾ï¼ææå±æ§\n\n$customer.address\n$purchase.total\n\n\n\n# æ¹æ³\n\næ¹æ³å¨ java ä»£ç ä¸­å®ä¹ï¼å¹¶ä½ä¸äºæç¨çäºæï¼æ¯å¦è¿è¡ä¸ä¸ªè®¡ç®å¨æèä½åºä¸ä¸ªå³å®ãæ¹æ³æ¯å®éä¸ä¹æ¯å¼ç¨ï¼ç±åå¯¼ç¬¦ $ åè·ä¸ä¸ª vtl æ è¯ç¬¦ï¼åè·ä¸ä¸ª vtl æ¹æ³ä½ï¼method bodyï¼ã vtl æ¹æ³ä½ç±ä¸ä¸ª vtl æ è¯ç¬¦åè·ä¸ä¸ªå·¦æ¬å·ï¼åè·å¯éçåæ°åè¡¨ï¼æåæ¯å³æ¬å·ã\n\nç¤ºä¾ï¼æææ¹æ³\n\n$customer.getaddress()\n$purchase.gettotal()\n$page.settitle( "my home page" )\n$person.setattributes( ["strange", "weird", "excited"] )\n\n\n\n# èµå¼\n\n#set æä»¤ç¨æ¥ä¸ºå¼ç¨è®¾ç½®ç¸åºçå¼ãå¼å¯ä»¥è¢«å¼æ´¾ç»åéå¼ç¨æèæ¯å±æ§å¼ç¨ï¼èä¸èµå¼è¦å¨æ¬å·éæ¬èµ·æ¥ã\n\n#set( $monkey = $bill ) ## variable reference\n#set( $monkey.friend = "monica" ) ## string literal\n#set( $monkey.blame = $whitehouse.leak ) ## property reference\n#set( $monkey.plan = $spindoctor.weave($web) ) ## method reference\n#set( $monkey.number = 123 ) ##number literal\n#set( $monkey.say = ["not", $my, "fault"] ) ## arraylist\n\n\n\n# å­ç¬¦ä¸²\n\nä½¿ç¨ #set æä»¤æ¶ï¼æ¬å¨åå¼å·ä¸­çå­é¢å­ç¬¦ä¸²å°è§£æåéæ°è§£é ã ç¶èï¼å½å­é¢å­ç¬¦ä¸²æ¬å¨åå¼å·ä¸­æ¶ï¼ä¸è¢«è§£æï¼\n\nç¤ºä¾ï¼\n\n#set( $foo = "bar" )\n$foo\n#set( $blargh = \'$foo\' )\n$blargh\n\n\nè¾åºï¼\n\nbar\n $foo\n\n\n\n# æ¡ä»¶\n\nvtl ä½¿ç¨ #ifã#elseifã#else æä»¤åæ¡ä»¶è¯­å¥æ§å¶ã\n\nç¤ºä¾ï¼\n\n#if( $foo < 10 )\n    <strong>go north</strong>\n#elseif( $foo == 10 )\n    <strong>go east</strong>\n#elseif( $bar == 6 )\n    <strong>go south</strong>\n#else\n    <strong>go west</strong>\n#end\n\n\n\n# é»è¾\n\nvtl æ¯æä¸ï¼&&ï¼ãæï¼||ï¼ãéï¼!ï¼é»è¾å¤æ­ã\n\nç¤ºä¾ï¼\n\n#if( $foo && $bar )\n   <strong> this and that</strong>\n#end\n\n#if( $foo || $bar )\n    <strong>this or that</strong>\n#end\n\n#if( !$foo )\n <strong>not that</strong>\n#end\n\n\n\n# å¾ªç¯\n\nvtl éè¿ #foreach æ¯æå¾ªç¯\n\n<ul>\n#foreach( $product in $allproducts )\n    <li>$product</li>\n#end\n</ul>\n\n\n\n# åå«\n\nvtl éè¿ #include æ¥å¯¼å¥å¶ä»æä»¶ã\n\nç¤ºä¾ï¼\n\n#include( "one.txt" )\n\n#include( "one.gif","two.txt","three.htm" )\n\n#include( "greetings.txt", $seasonalstock )\n\n\n\n# è§£æ\n\nvtl éè¿ #parse å¯¼å¥å¶ä» vm æä»¶ã\n\n$count\n#set( $count = $count - 1 )\n#if( $count > 0 )\n    #parse( "parsefoo.vm" )\n#else\n    all done with parsefoo.vm!\n#end\n\n\n\n# åæ­¢\n\nvtl ä½¿ç¨ #stop åæ­¢æ¨¡æ¿å¼æçæ§è¡ï¼å¹¶è¿åãè¿éå¸¸ç¨ä½è°è¯ã\n\n#stop ##\n\n\n\n# å®\n\nvtl ä½¿ç¨ #macro å #end éåæ¥å®ä¹å®ï¼ä»¥æ­¤å®ç°èªå®ä¹æä»¤ã\n\nç¤ºä¾ä¸ï¼\n\n## å®ä¹å®\n#macro( d )\n<tr><td></td></tr>\n#end\n\n## ä½¿ç¨å®\n#d()\n\n\nç¤ºä¾äºï¼\n\n## å®ä¹å®\n#macro( tablerows $color $somelist )\n  #foreach( $something in $somelist )\n    <tr><td bgcolor=$color>$something</td></tr>\n  #end\n#end\n\n## ä½¿ç¨å®\n#set( $greatlakes = ["superior","michigan","huron","erie","ontario"] )\n#set( $color = "blue" )\n<table>\n    #tablerows( $color $greatlakes )\n</table>\n\n\nè¾åºï¼\n\n<table>\n  <tr>\n    <td bgcolor="blue">superior</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">michigan</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">huron</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">erie</td>\n  </tr>\n  <tr>\n    <td bgcolor="blue">ontario</td>\n  </tr>\n</table>\n\n\n\n# è½¬ä¹\n\nvtl ä½¿ç¨ \\ ç¬¦å·æ¥è¿è¡å­ç¬¦è½¬ä¹ã\n\nç¤ºä¾ä¸\n\n## the following line defines $email in this template:\n#set( $email = "foo" )\n$email\n\\$email\n\n\nè¾åºï¼\n\nfoo\n$email\n\n\n\n# è¯­ä¹è¦ç¹\n\nvelocity æä¸äºè¯­ä¹è¦ç¹ï¼å®¹æäº§çæ­§ä¹ï¼è¿éå½çº³ä¸ä¸ã\n\nï¼1ï¼velocity çè¡ä¸ºå¹¶ä¸åç©ºæ ¼çå½±åã\n\nç¤ºä¾ï¼ä»¥ä¸ä¸ç§åæ³ææä¸è´\n\n## åæ³ä¸\nsend me #set($foo = ["$10 and ","a cake"])#foreach($a in $foo)$a #end please.\n\n## åæ³äº\nsend me\n#set( $foo = ["$10 and ","a cake"] )\n#foreach( $a in $foo )\n$a\n#end\nplease.\n\n## åæ³ä¸\nsend me\n#set($foo       = ["$10 and ","a cake"])\n                 #foreach           ($a in $foo )$a\n         #end please.\n\n\n\n# åèèµæ\n\n * velocity github\n * velocity å®ç½\n * velocity ä¸­æææ¡£\n * velocity-spring-boot-project',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java æ¨¡æ¿å¼æ",frontmatter:{title:"Java æ¨¡æ¿å¼æ",categories:["ç¼ç¨","Java","å·¥å·","æ¨¡æ¿å¼æ"],tags:["Java","æ¨¡æ¿å¼æ"],abbrlink:"d29d234e",date:"2022-02-17T22:34:30.000Z",hidden:!0,permalink:"/pages/9a5880/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/03.%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/",relativePath:"12.å·¥å·/03.æ¨¡æ¿å¼æ/README.md",key:"v-438f9dca",path:"/pages/9a5880/",headers:[{level:2,title:"åå®¹",slug:"åå®¹",normalizedTitle:"åå®¹",charIndex:60},{level:2,title:"èµæº",slug:"èµæº",normalizedTitle:"èµæº",charIndex:342}],headersStr:"åå®¹ èµæº",content:"# Java æ¨¡æ¿å¼æ\n\næ¨¡æ¿å¼æä¸å±äºç¹å®ææ¯é¢åï¼å®æ¯è·¨é¢åè·¨å¹³å°çæ¦å¿µã æ¨¡æ¿å¼æçä½ç¨å°±æ¯åç¦»ä¸å¡æ°æ®åæç»åç°åå®¹ï¼å®å¯ä»¥çæç¹å®æ ¼å¼çææ¡£ï¼æ¨¡æ¿ï¼ ã\n\næ¨¡æ¿å¼æç®åæ¥è¯´ï¼å°±æ¯ï¼æ¨¡æ¿ + æ°æ®æ¨¡å = è¾åº\n\nè¾æ©ï¼ä¹æ¯è¾ç»å¸çæ¨¡æ¿å¼ææ¯ JavaEE çæ åææ¯ JSPã\n\nä½ JSP å­å¨ä»¥ä¸ç¼ºç¹ï¼å¯¼è´éæ¸è¢«æ·æ±°ï¼\n\n * æ§è½å·®\n   * JSP æ¬è´¨ä¸æ¯ Servletï¼ç¬¬ä¸æ¬¡è¯·æ± JSP é¡µé¢ï¼å¿é¡»è¦å¨ web æå¡å¨ä¸­ç¼è¯æ servletï¼æä»¥ç¬¬ä¸æ¬¡ååºè¾æ¢ã\n   * æ¯æ¬¡è¯·æ± JSP é½æ¯è®¿é® servlet åç¨è¾åºæµè¾åºç html é¡µé¢ã\n   * JSP ä¸­çåå®¹å¾å¤ï¼é¡µé¢ååºä¼å¾æ¢ï¼å ä¸ºæ¯åæ­¥å è½½ã\n * æ æ³ååç«¯åç¦»\n   * å¨æèµæºåéæèµæºå¨é¨è¦åå¨ä¸èµ·ï¼æ æ³åå°ååç«¯åç¦»ãä¸æ¦æå¡å¨åºç°ç¶åµï¼ååå°ä¸èµ·ç©å®ã\n   * èä¸ Java å·¥ç¨å¸æ¢å½ç¹åå½å¦ï¼åè¦ç»´æ¤ Java ä»£ç ï¼åè¦ç»´æ¤ JSP ä»£ç ï¼çè¦ã\n   * åç«¯å·¥ç¨å¸å¦æä¸çè§£ JSP è¯­æ³ï¼é¢å¯¹åç§ JSP æ ç­¾ãè¡¨è¾¾å¼ãæä»¤ï¼ä¼ä¸è¸æµé¼ï¼çè¦ã\n * ä¸æ¯æææå¡å¨é½æ¯æ - JSP å¿é¡»è¦å¨æ¯æ JSP ææ¯ç web æå¡å¨éè¿è¡ï¼å¦ Tomcatï¼ãä½æäºæå¡å¨åä¸æ¯æ JSP ï¼å¦ Nginxã\n\nå¨ Java é¢åï¼ç®åæå¸¸è§çæ¨¡æ¿å¼æå°±æ¯ï¼\n\n * Freemark\n * Thymeleaf\n * Velocity\n\n\n# åå®¹\n\n * Freemark\n * Thymeleaf\n * Velocity\n\n\n# èµæº\n\n * Freemark\n   * Freemark Github\n   * Freemark ä¸­ææç¨\n   * å¨çº¿ Freemark å·¥å·\n * Velocity\n   * Velocity Github\n   * Velocity å®ç½\n   * Velocity ä¸­æææ¡£\n   * velocity-spring-boot-project",normalizedContent:"# java æ¨¡æ¿å¼æ\n\næ¨¡æ¿å¼æä¸å±äºç¹å®ææ¯é¢åï¼å®æ¯è·¨é¢åè·¨å¹³å°çæ¦å¿µã æ¨¡æ¿å¼æçä½ç¨å°±æ¯åç¦»ä¸å¡æ°æ®åæç»åç°åå®¹ï¼å®å¯ä»¥çæç¹å®æ ¼å¼çææ¡£ï¼æ¨¡æ¿ï¼ ã\n\næ¨¡æ¿å¼æç®åæ¥è¯´ï¼å°±æ¯ï¼æ¨¡æ¿ + æ°æ®æ¨¡å = è¾åº\n\nè¾æ©ï¼ä¹æ¯è¾ç»å¸çæ¨¡æ¿å¼ææ¯ javaee çæ åææ¯ jspã\n\nä½ jsp å­å¨ä»¥ä¸ç¼ºç¹ï¼å¯¼è´éæ¸è¢«æ·æ±°ï¼\n\n * æ§è½å·®\n   * jsp æ¬è´¨ä¸æ¯ servletï¼ç¬¬ä¸æ¬¡è¯·æ± jsp é¡µé¢ï¼å¿é¡»è¦å¨ web æå¡å¨ä¸­ç¼è¯æ servletï¼æä»¥ç¬¬ä¸æ¬¡ååºè¾æ¢ã\n   * æ¯æ¬¡è¯·æ± jsp é½æ¯è®¿é® servlet åç¨è¾åºæµè¾åºç html é¡µé¢ã\n   * jsp ä¸­çåå®¹å¾å¤ï¼é¡µé¢ååºä¼å¾æ¢ï¼å ä¸ºæ¯åæ­¥å è½½ã\n * æ æ³ååç«¯åç¦»\n   * å¨æèµæºåéæèµæºå¨é¨è¦åå¨ä¸èµ·ï¼æ æ³åå°ååç«¯åç¦»ãä¸æ¦æå¡å¨åºç°ç¶åµï¼ååå°ä¸èµ·ç©å®ã\n   * èä¸ java å·¥ç¨å¸æ¢å½ç¹åå½å¦ï¼åè¦ç»´æ¤ java ä»£ç ï¼åè¦ç»´æ¤ jsp ä»£ç ï¼çè¦ã\n   * åç«¯å·¥ç¨å¸å¦æä¸çè§£ jsp è¯­æ³ï¼é¢å¯¹åç§ jsp æ ç­¾ãè¡¨è¾¾å¼ãæä»¤ï¼ä¼ä¸è¸æµé¼ï¼çè¦ã\n * ä¸æ¯æææå¡å¨é½æ¯æ - jsp å¿é¡»è¦å¨æ¯æ jsp ææ¯ç web æå¡å¨éè¿è¡ï¼å¦ tomcatï¼ãä½æäºæå¡å¨åä¸æ¯æ jsp ï¼å¦ nginxã\n\nå¨ java é¢åï¼ç®åæå¸¸è§çæ¨¡æ¿å¼æå°±æ¯ï¼\n\n * freemark\n * thymeleaf\n * velocity\n\n\n# åå®¹\n\n * freemark\n * thymeleaf\n * velocity\n\n\n# èµæº\n\n * freemark\n   * freemark github\n   * freemark ä¸­ææç¨\n   * å¨çº¿ freemark å·¥å·\n * velocity\n   * velocity github\n   * velocity å®ç½\n   * velocity ä¸­æææ¡£\n   * velocity-spring-boot-project",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JUnit5 å¿«éå¥é¨",frontmatter:{title:"JUnit5 å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æµè¯"],tags:["Java","æµè¯","JUnit"],abbrlink:"e85f4bbe",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/06533c/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/04.%E6%B5%8B%E8%AF%95/01.Junit.html",relativePath:"12.å·¥å·/04.æµè¯/01.Junit.md",key:"v-c5441038",path:"/pages/06533c/",headers:[{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:37},{level:2,title:"JUnit æ³¨è§£",slug:"junit-æ³¨è§£",normalizedTitle:"junit æ³¨è§£",charIndex:764},{level:2,title:"ç¼åååæµè¯",slug:"ç¼åååæµè¯",normalizedTitle:"ç¼åååæµè¯",charIndex:4766},{level:3,title:"åºæ¬çååæµè¯ç±»åæ¹æ³",slug:"åºæ¬çååæµè¯ç±»åæ¹æ³",normalizedTitle:"åºæ¬çååæµè¯ç±»åæ¹æ³",charIndex:4777},{level:3,title:"å®å¶æµè¯ç±»åæ¹æ³çæ¾ç¤ºåç§°",slug:"å®å¶æµè¯ç±»åæ¹æ³çæ¾ç¤ºåç§°",normalizedTitle:"å®å¶æµè¯ç±»åæ¹æ³çæ¾ç¤ºåç§°",charIndex:5731},{level:3,title:"æ­è¨ï¼Assertionsï¼",slug:"æ­è¨-assertions",normalizedTitle:"æ­è¨ï¼assertionsï¼",charIndex:6216},{level:3,title:"åæ³ï¼Assumptionsï¼",slug:"åæ³-assumptions",normalizedTitle:"åæ³ï¼assumptionsï¼",charIndex:9987},{level:3,title:"ç¦ç¨",slug:"ç¦ç¨",normalizedTitle:"ç¦ç¨",charIndex:10949},{level:3,title:"æµè¯æ¡ä»¶",slug:"æµè¯æ¡ä»¶",normalizedTitle:"æµè¯æ¡ä»¶",charIndex:11359},{level:4,title:"æä½ç³»ç»æ¡ä»¶",slug:"æä½ç³»ç»æ¡ä»¶",normalizedTitle:"æä½ç³»ç»æ¡ä»¶",charIndex:11367},{level:4,title:"Java è¿è¡æ¶çæ¬æ¡ä»¶",slug:"java-è¿è¡æ¶çæ¬æ¡ä»¶",normalizedTitle:"java è¿è¡æ¶çæ¬æ¡ä»¶",charIndex:11731},{level:4,title:"ç³»ç»å±æ§æ¡ä»¶",slug:"ç³»ç»å±æ§æ¡ä»¶",normalizedTitle:"ç³»ç»å±æ§æ¡ä»¶",charIndex:11950},{level:3,title:"åµå¥æµè¯",slug:"åµå¥æµè¯",normalizedTitle:"åµå¥æµè¯",charIndex:12188},{level:3,title:"éå¤æµè¯",slug:"éå¤æµè¯",normalizedTitle:"éå¤æµè¯",charIndex:14499},{level:3,title:"åæ°åæµè¯",slug:"åæ°åæµè¯",normalizedTitle:"åæ°åæµè¯",charIndex:16211},{level:2,title:"å¼ç¨åå¼ç³",slug:"å¼ç¨åå¼ç³",normalizedTitle:"å¼ç¨åå¼ç³",charIndex:16398}],headersStr:"å®è£ JUnit æ³¨è§£ ç¼åååæµè¯ åºæ¬çååæµè¯ç±»åæ¹æ³ å®å¶æµè¯ç±»åæ¹æ³çæ¾ç¤ºåç§° æ­è¨ï¼Assertionsï¼ åæ³ï¼Assumptionsï¼ ç¦ç¨ æµè¯æ¡ä»¶ æä½ç³»ç»æ¡ä»¶ Java è¿è¡æ¶çæ¬æ¡ä»¶ ç³»ç»å±æ§æ¡ä»¶ åµå¥æµè¯ éå¤æµè¯ åæ°åæµè¯ å¼ç¨åå¼ç³",content:'# JUnit5 å¿«éå¥é¨\n\n> version: junit5\n\n\n# å®è£\n\nå¨ pom ä¸­æ·»å ä¾èµ\n\n<properties>\n  <junit.jupiter.version>5.3.2</junit.jupiter.version>\n</properties>\n\n<dependencies>\n  <dependency>\n    <groupId>org.junit.jupiter</groupId>\n    <artifactId>junit-jupiter-api</artifactId>\n    <version>${junit.jupiter.version}</version>\n    <scope>test</scope>\n  </dependency>\n  <dependency>\n    <groupId>org.junit.jupiter</groupId>\n    <artifactId>junit-jupiter-params</artifactId>\n    <version>${junit.jupiter.version}</version>\n    <scope>test</scope>\n  </dependency>\n  <dependency>\n    <groupId>org.junit.jupiter</groupId>\n    <artifactId>junit-jupiter-engine</artifactId>\n    <version>${junit.jupiter.version}</version>\n    <scope>test</scope>\n  </dependency>\n</dependencies>\n\n\nç»ä»¶é´ä¾èµå³ç³»ï¼\n\n\n\n\n# JUnit æ³¨è§£\n\nANNOTATION           DESCRIPTION\n@Test                Denotes that a method is a test method. Unlike JUnit 4âs\n                     @Test annotation, this annotation does not declare any\n                     attributes, since test extensions in JUnit Jupiter operate\n                     based on their own dedicated annotations. Such methods are\n                     inherited unless they are overridden.\n@ParameterizedTest   Denotes that a method is a parameterized test. Such methods\n                     are inherited unless they are overridden.\n@RepeatedTest        Denotes that a method is a test template for a repeated\n                     test. Such methods are inherited unless they are overridden.\n@TestFactory         Denotes that a method is a test factory for dynamic tests.\n                     Such methods are inherited unless they are overridden.\n@TestInstance        Used to configure the test instance lifecycle for the\n                     annotated test class. Such annotations are inherited.\n@TestTemplate        Denotes that a method is a template for test cases designed\n                     to be invoked multiple times depending on the number of\n                     invocation contexts returned by the registered providers.\n                     Such methods are inherited unless they are overridden.\n@DisplayName         Declares a custom display name for the test class or test\n                     method. Such annotations are not inherited.\n@BeforeEach          Denotes that the annotated method should be executed before\n                     each @Test, @RepeatedTest, @ParameterizedTest, or\n                     @TestFactory method in the current class; analogous to JUnit\n                     4âs @Before. Such methods are inherited unless they are\n                     overridden.\n@AfterEach           Denotes that the annotated method should be executed after\n                     each @Test, @RepeatedTest, @ParameterizedTest, or\n                     @TestFactory method in the current class; analogous to JUnit\n                     4âs @After. Such methods are inherited unless they are\n                     overridden.\n@BeforeAll           Denotes that the annotated method should be executed before\n                     all @Test, @RepeatedTest, @ParameterizedTest, and\n                     @TestFactory methods in the current class; analogous to\n                     JUnit 4âs @BeforeClass. Such methods are inherited (unless\n                     they are hidden or overridden) and must be static (unless\n                     the "per-class" test instance lifecycle is used).\n@AfterAll            Denotes that the annotated method should be executed after\n                     all @Test, @RepeatedTest, @ParameterizedTest, and\n                     @TestFactory methods in the current class; analogous to\n                     JUnit 4âs @AfterClass. Such methods are inherited (unless\n                     they are hidden or overridden) and must be static (unless\n                     the "per-class" test instance lifecycle is used).\n@Nested              Denotes that the annotated class is a nested, non-static\n                     test class. @BeforeAll and @AfterAllmethods cannot be used\n                     directly in a @Nested test class unless the "per-class" test\n                     instance lifecycle is used. Such annotations are not\n                     inherited.\n@Tag                 Used to declare tags for filtering tests, either at the\n                     class or method level; analogous to test groups in TestNG or\n                     Categories in JUnit 4. Such annotations are inherited at the\n                     class level but not at the method level.\n@Disabled            Used to disable a test class or test method; analogous to\n                     JUnit 4âs @Ignore. Such annotations are not inherited.\n@ExtendWith          Used to register custom extensions. Such annotations are\n                     inherited.\n\n\n# ç¼åååæµè¯\n\n\n# åºæ¬çååæµè¯ç±»åæ¹æ³\n\nimport org.junit.jupiter.api.*;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nclass Junit5StandardTests {\n\n    private static final Logger LOGGER = LoggerFactory.getLogger(Junit5StandardTests.class);\n\n    @BeforeAll\n    static void beforeAll() {\n        LOGGER.info("call beforeAll()");\n    }\n\n    @BeforeEach\n    void beforeEach() {\n        LOGGER.info("call beforeEach()");\n    }\n\n    @Test\n    void succeedingTest() {\n        LOGGER.info("call succeedingTest()");\n    }\n\n    @Test\n    void failingTest() {\n        LOGGER.info("call failingTest()");\n        // fail("a failing test");\n    }\n\n    @Test\n    @Disabled("for demonstration purposes")\n    void skippedTest() {\n        LOGGER.info("call skippedTest()");\n        // not executed\n    }\n\n    @AfterEach\n    void afterEach() {\n        LOGGER.info("call afterEach()");\n    }\n\n    @AfterAll\n    static void afterAll() {\n        LOGGER.info("call afterAll()");\n    }\n}\n\n\n\n# å®å¶æµè¯ç±»åæ¹æ³çæ¾ç¤ºåç§°\n\næ¯ææ®éå­ç¬¦ãç¹æ®ç¬¦å·ãemoji\n\nimport org.junit.jupiter.api.DisplayName;\nimport org.junit.jupiter.api.Test;\n\n@DisplayName("A special test case")\nclass JunitDisplayNameDemo {\n\n    @Test\n    @DisplayName("Custom test name containing spaces")\n    void testWithDisplayNameContainingSpaces() { }\n\n    @Test\n    @DisplayName("â¯Â°â¡Â°ï¼â¯")\n    void testWithDisplayNameContainingSpecialCharacters() { }\n\n    @Test\n    @DisplayName("ð±")\n    void testWithDisplayNameContainingEmoji() { }\n}\n\n\n\n# æ­è¨ï¼Assertionsï¼\n\nimport org.junit.jupiter.api.BeforeAll;\nimport org.junit.jupiter.api.Test;\n\nimport static java.time.Duration.ofMillis;\nimport static java.time.Duration.ofMinutes;\nimport static org.junit.jupiter.api.Assertions.*;\n\nclass AssertionsDemo {\n\n    private static Person person;\n\n    @BeforeAll\n    public static void beforeAll() {\n        person = new Person("John", "Doe");\n    }\n\n    @Test\n    void standardAssertions() {\n        assertEquals(2, 2);\n        assertEquals(4, 4, "The optional assertion message is now the last parameter.");\n        assertTrue(\'a\' < \'b\', () -> "Assertion messages can be lazily evaluated -- "\n            + "to avoid constructing complex messages unnecessarily.");\n    }\n\n    @Test\n    void groupedAssertions() {\n        // In a grouped assertion all assertions are executed, and any\n        // failures will be reported together.\n        assertAll("person", () -> assertEquals("John", person.getFirstName()),\n            () -> assertEquals("Doe", person.getLastName()));\n    }\n\n    @Test\n    void dependentAssertions() {\n        // Within a code block, if an assertion fails the\n        // subsequent code in the same block will be skipped.\n        assertAll("properties", () -> {\n            String firstName = person.getFirstName();\n            assertNotNull(firstName);\n\n            // Executed only if the previous assertion is valid.\n            assertAll("first name", () -> assertTrue(firstName.startsWith("J")),\n                () -> assertTrue(firstName.endsWith("n")));\n        }, () -> {\n            // Grouped assertion, so processed independently\n            // of results of first name assertions.\n            String lastName = person.getLastName();\n            assertNotNull(lastName);\n\n            // Executed only if the previous assertion is valid.\n            assertAll("last name", () -> assertTrue(lastName.startsWith("D")),\n                () -> assertTrue(lastName.endsWith("e")));\n        });\n    }\n\n    @Test\n    void exceptionTesting() {\n        Throwable exception = assertThrows(IllegalArgumentException.class, () -> {\n            throw new IllegalArgumentException("a message");\n        });\n        assertEquals("a message", exception.getMessage());\n    }\n\n    @Test\n    void timeoutNotExceeded() {\n        // The following assertion succeeds.\n        assertTimeout(ofMinutes(2), () -> {\n            // Perform task that takes less than 2 minutes.\n        });\n    }\n\n    @Test\n    void timeoutNotExceededWithResult() {\n        // The following assertion succeeds, and returns the supplied object.\n        String actualResult = assertTimeout(ofMinutes(2), () -> {\n            return "a result";\n        });\n        assertEquals("a result", actualResult);\n    }\n\n    @Test\n    void timeoutNotExceededWithMethod() {\n        // The following assertion invokes a method reference and returns an object.\n        String actualGreeting = assertTimeout(ofMinutes(2), AssertionsDemo::greeting);\n        assertEquals("Hello, World!", actualGreeting);\n    }\n\n    @Test\n    void timeoutExceeded() {\n        // The following assertion fails with an error message similar to:\n        // execution exceeded timeout of 10 ms by 91 ms\n        assertTimeout(ofMillis(10), () -> {\n            // Simulate task that takes more than 10 ms.\n            Thread.sleep(100);\n        });\n    }\n\n    @Test\n    void timeoutExceededWithPreemptiveTermination() {\n        // The following assertion fails with an error message similar to:\n        // execution timed out after 10 ms\n        assertTimeoutPreemptively(ofMillis(10), () -> {\n            // Simulate task that takes more than 10 ms.\n            Thread.sleep(100);\n        });\n    }\n\n    private static String greeting() {\n        return "Hello, World!";\n    }\n\n}\n\n\n\n# åæ³ï¼Assumptionsï¼\n\nimport static org.junit.jupiter.api.Assertions.assertEquals;\nimport static org.junit.jupiter.api.Assumptions.assumeTrue;\nimport static org.junit.jupiter.api.Assumptions.assumingThat;\n\nimport org.junit.jupiter.api.Test;\n\nclass AssumptionsDemo {\n\n    @Test\n    void testOnlyOnCiServer() {\n        assumeTrue("CI".equals(System.getenv("ENV")));\n        // remainder of test\n    }\n\n    @Test\n    void testOnlyOnDeveloperWorkstation() {\n        assumeTrue("DEV".equals(System.getenv("ENV")),\n            () -> "Aborting test: not on developer workstation");\n        // remainder of test\n    }\n\n    @Test\n    void testInAllEnvironments() {\n        assumingThat("CI".equals(System.getenv("ENV")),\n            () -> {\n                // perform these assertions only on the CI server\n                assertEquals(2, 2);\n            });\n\n        // perform these assertions in all environments\n        assertEquals("a string", "a string");\n    }\n\n}\n\n\n\n# ç¦ç¨\n\nç¦ç¨ååæµè¯ç±»ç¤ºä¾ï¼\n\nimport org.junit.jupiter.api.Disabled;\nimport org.junit.jupiter.api.Test;\n\n@Disabled\nclass DisabledClassDemo {\n    @Test\n    void testWillBeSkipped() {\n    }\n}\n\n\nç¦ç¨ååæµè¯æ¹æ³ç¤ºä¾ï¼\n\nimport org.junit.jupiter.api.Disabled;\nimport org.junit.jupiter.api.Test;\n\nclass DisabledTestsDemo {\n\n    @Disabled\n    @Test\n    void testWillBeSkipped() {\n    }\n\n    @Test\n    void testWillBeExecuted() {\n    }\n}\n\n\n\n# æµè¯æ¡ä»¶\n\n# æä½ç³»ç»æ¡ä»¶\n\n@Test\n@EnabledOnOs(MAC)\nvoid onlyOnMacOs() {\n    // ...\n}\n\n@TestOnMac\nvoid testOnMac() {\n    // ...\n}\n\n@Test\n@EnabledOnOs({ LINUX, MAC })\nvoid onLinuxOrMac() {\n    // ...\n}\n\n@Test\n@DisabledOnOs(WINDOWS)\nvoid notOnWindows() {\n    // ...\n}\n\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\n@Test\n@EnabledOnOs(MAC)\n@interface TestOnMac {\n}\n\n\n# Java è¿è¡æ¶çæ¬æ¡ä»¶\n\n@Test\n@EnabledOnJre(JAVA_8)\nvoid onlyOnJava8() {\n    // ...\n}\n\n@Test\n@EnabledOnJre({ JAVA_9, JAVA_10 })\nvoid onJava9Or10() {\n    // ...\n}\n\n@Test\n@DisabledOnJre(JAVA_9)\nvoid notOnJava9() {\n    // ...\n}\n\n\n# ç³»ç»å±æ§æ¡ä»¶\n\n@Test\n@EnabledIfSystemProperty(named = "os.arch", matches = ".*64.*")\nvoid onlyOn64BitArchitectures() {\n    // ...\n}\n\n@Test\n@DisabledIfSystemProperty(named = "ci-server", matches = "true")\nvoid notOnCiServer() {\n    // ...\n}\n\n\n\n# åµå¥æµè¯\n\nimport static org.junit.jupiter.api.Assertions.assertEquals;\nimport static org.junit.jupiter.api.Assertions.assertFalse;\nimport static org.junit.jupiter.api.Assertions.assertThrows;\nimport static org.junit.jupiter.api.Assertions.assertTrue;\n\nimport java.util.EmptyStackException;\nimport java.util.Stack;\n\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.DisplayName;\nimport org.junit.jupiter.api.Nested;\nimport org.junit.jupiter.api.Test;\n\n@DisplayName("A stack")\nclass TestingAStackDemo {\n\n    Stack<Object> stack;\n\n    @Test\n    @DisplayName("is instantiated with new Stack()")\n    void isInstantiatedWithNew() {\n        new Stack<>();\n    }\n\n    @Nested\n    @DisplayName("when new")\n    class WhenNew {\n\n        @BeforeEach\n        void createNewStack() {\n            stack = new Stack<>();\n        }\n\n        @Test\n        @DisplayName("is empty")\n        void isEmpty() {\n            assertTrue(stack.isEmpty());\n        }\n\n        @Test\n        @DisplayName("throws EmptyStackException when popped")\n        void throwsExceptionWhenPopped() {\n            assertThrows(EmptyStackException.class, () -> stack.pop());\n        }\n\n        @Test\n        @DisplayName("throws EmptyStackException when peeked")\n        void throwsExceptionWhenPeeked() {\n            assertThrows(EmptyStackException.class, () -> stack.peek());\n        }\n\n        @Nested\n        @DisplayName("after pushing an element")\n        class AfterPushing {\n\n            String anElement = "an element";\n\n            @BeforeEach\n            void pushAnElement() {\n                stack.push(anElement);\n            }\n\n            @Test\n            @DisplayName("it is no longer empty")\n            void isNotEmpty() {\n                assertFalse(stack.isEmpty());\n            }\n\n            @Test\n            @DisplayName("returns the element when popped and is empty")\n            void returnElementWhenPopped() {\n                assertEquals(anElement, stack.pop());\n                assertTrue(stack.isEmpty());\n            }\n\n            @Test\n            @DisplayName("returns the element when peeked but remains not empty")\n            void returnElementWhenPeeked() {\n                assertEquals(anElement, stack.peek());\n                assertFalse(stack.isEmpty());\n            }\n        }\n    }\n}\n\n\n\n# éå¤æµè¯\n\nimport static org.junit.jupiter.api.Assertions.assertEquals;\n\nimport java.util.logging.Logger;\n\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.DisplayName;\nimport org.junit.jupiter.api.RepeatedTest;\nimport org.junit.jupiter.api.RepetitionInfo;\nimport org.junit.jupiter.api.TestInfo;\n\nclass RepeatedTestsDemo {\n\n    private Logger logger = // ...\n\n    @BeforeEach\n    void beforeEach(TestInfo testInfo, RepetitionInfo repetitionInfo) {\n        int currentRepetition = repetitionInfo.getCurrentRepetition();\n        int totalRepetitions = repetitionInfo.getTotalRepetitions();\n        String methodName = testInfo.getTestMethod().get().getName();\n        logger.info(String.format("About to execute repetition %d of %d for %s", //\n            currentRepetition, totalRepetitions, methodName));\n    }\n\n    @RepeatedTest(10)\n    void repeatedTest() {\n        // ...\n    }\n\n    @RepeatedTest(5)\n    void repeatedTestWithRepetitionInfo(RepetitionInfo repetitionInfo) {\n        assertEquals(5, repetitionInfo.getTotalRepetitions());\n    }\n\n    @RepeatedTest(value = 1, name = "{displayName} {currentRepetition}/{totalRepetitions}")\n    @DisplayName("Repeat!")\n    void customDisplayName(TestInfo testInfo) {\n        assertEquals(testInfo.getDisplayName(), "Repeat! 1/1");\n    }\n\n    @RepeatedTest(value = 1, name = RepeatedTest.LONG_DISPLAY_NAME)\n    @DisplayName("Details...")\n    void customDisplayNameWithLongPattern(TestInfo testInfo) {\n        assertEquals(testInfo.getDisplayName(), "Details... :: repetition 1 of 1");\n    }\n\n    @RepeatedTest(value = 5, name = "Wiederholung {currentRepetition} von {totalRepetitions}")\n    void repeatedTestInGerman() {\n        // ...\n    }\n\n}\n\n\n\n# åæ°åæµè¯\n\n@ParameterizedTest\n@ValueSource(strings = { "racecar", "radar", "able was I ere I saw elba" })\nvoid palindromes(String candidate) {\n    assertTrue(isPalindrome(candidate));\n}\n\n\n\n# å¼ç¨åå¼ç³\n\n * Github\n * å®æ¹ç¨æ·æå\n * Javadoc\n * çæ¬å£°æ\n * å®æ¹ç¤ºä¾',normalizedContent:'# junit5 å¿«éå¥é¨\n\n> version: junit5\n\n\n# å®è£\n\nå¨ pom ä¸­æ·»å ä¾èµ\n\n<properties>\n  <junit.jupiter.version>5.3.2</junit.jupiter.version>\n</properties>\n\n<dependencies>\n  <dependency>\n    <groupid>org.junit.jupiter</groupid>\n    <artifactid>junit-jupiter-api</artifactid>\n    <version>${junit.jupiter.version}</version>\n    <scope>test</scope>\n  </dependency>\n  <dependency>\n    <groupid>org.junit.jupiter</groupid>\n    <artifactid>junit-jupiter-params</artifactid>\n    <version>${junit.jupiter.version}</version>\n    <scope>test</scope>\n  </dependency>\n  <dependency>\n    <groupid>org.junit.jupiter</groupid>\n    <artifactid>junit-jupiter-engine</artifactid>\n    <version>${junit.jupiter.version}</version>\n    <scope>test</scope>\n  </dependency>\n</dependencies>\n\n\nç»ä»¶é´ä¾èµå³ç³»ï¼\n\n\n\n\n# junit æ³¨è§£\n\nannotation           description\n@test                denotes that a method is a test method. unlike junit 4âs\n                     @test annotation, this annotation does not declare any\n                     attributes, since test extensions in junit jupiter operate\n                     based on their own dedicated annotations. such methods are\n                     inherited unless they are overridden.\n@parameterizedtest   denotes that a method is a parameterized test. such methods\n                     are inherited unless they are overridden.\n@repeatedtest        denotes that a method is a test template for a repeated\n                     test. such methods are inherited unless they are overridden.\n@testfactory         denotes that a method is a test factory for dynamic tests.\n                     such methods are inherited unless they are overridden.\n@testinstance        used to configure the test instance lifecycle for the\n                     annotated test class. such annotations are inherited.\n@testtemplate        denotes that a method is a template for test cases designed\n                     to be invoked multiple times depending on the number of\n                     invocation contexts returned by the registered providers.\n                     such methods are inherited unless they are overridden.\n@displayname         declares a custom display name for the test class or test\n                     method. such annotations are not inherited.\n@beforeeach          denotes that the annotated method should be executed before\n                     each @test, @repeatedtest, @parameterizedtest, or\n                     @testfactory method in the current class; analogous to junit\n                     4âs @before. such methods are inherited unless they are\n                     overridden.\n@aftereach           denotes that the annotated method should be executed after\n                     each @test, @repeatedtest, @parameterizedtest, or\n                     @testfactory method in the current class; analogous to junit\n                     4âs @after. such methods are inherited unless they are\n                     overridden.\n@beforeall           denotes that the annotated method should be executed before\n                     all @test, @repeatedtest, @parameterizedtest, and\n                     @testfactory methods in the current class; analogous to\n                     junit 4âs @beforeclass. such methods are inherited (unless\n                     they are hidden or overridden) and must be static (unless\n                     the "per-class" test instance lifecycle is used).\n@afterall            denotes that the annotated method should be executed after\n                     all @test, @repeatedtest, @parameterizedtest, and\n                     @testfactory methods in the current class; analogous to\n                     junit 4âs @afterclass. such methods are inherited (unless\n                     they are hidden or overridden) and must be static (unless\n                     the "per-class" test instance lifecycle is used).\n@nested              denotes that the annotated class is a nested, non-static\n                     test class. @beforeall and @afterallmethods cannot be used\n                     directly in a @nested test class unless the "per-class" test\n                     instance lifecycle is used. such annotations are not\n                     inherited.\n@tag                 used to declare tags for filtering tests, either at the\n                     class or method level; analogous to test groups in testng or\n                     categories in junit 4. such annotations are inherited at the\n                     class level but not at the method level.\n@disabled            used to disable a test class or test method; analogous to\n                     junit 4âs @ignore. such annotations are not inherited.\n@extendwith          used to register custom extensions. such annotations are\n                     inherited.\n\n\n# ç¼åååæµè¯\n\n\n# åºæ¬çååæµè¯ç±»åæ¹æ³\n\nimport org.junit.jupiter.api.*;\nimport org.slf4j.logger;\nimport org.slf4j.loggerfactory;\n\nclass junit5standardtests {\n\n    private static final logger logger = loggerfactory.getlogger(junit5standardtests.class);\n\n    @beforeall\n    static void beforeall() {\n        logger.info("call beforeall()");\n    }\n\n    @beforeeach\n    void beforeeach() {\n        logger.info("call beforeeach()");\n    }\n\n    @test\n    void succeedingtest() {\n        logger.info("call succeedingtest()");\n    }\n\n    @test\n    void failingtest() {\n        logger.info("call failingtest()");\n        // fail("a failing test");\n    }\n\n    @test\n    @disabled("for demonstration purposes")\n    void skippedtest() {\n        logger.info("call skippedtest()");\n        // not executed\n    }\n\n    @aftereach\n    void aftereach() {\n        logger.info("call aftereach()");\n    }\n\n    @afterall\n    static void afterall() {\n        logger.info("call afterall()");\n    }\n}\n\n\n\n# å®å¶æµè¯ç±»åæ¹æ³çæ¾ç¤ºåç§°\n\næ¯ææ®éå­ç¬¦ãç¹æ®ç¬¦å·ãemoji\n\nimport org.junit.jupiter.api.displayname;\nimport org.junit.jupiter.api.test;\n\n@displayname("a special test case")\nclass junitdisplaynamedemo {\n\n    @test\n    @displayname("custom test name containing spaces")\n    void testwithdisplaynamecontainingspaces() { }\n\n    @test\n    @displayname("â¯Â°â¡Â°ï¼â¯")\n    void testwithdisplaynamecontainingspecialcharacters() { }\n\n    @test\n    @displayname("ð±")\n    void testwithdisplaynamecontainingemoji() { }\n}\n\n\n\n# æ­è¨ï¼assertionsï¼\n\nimport org.junit.jupiter.api.beforeall;\nimport org.junit.jupiter.api.test;\n\nimport static java.time.duration.ofmillis;\nimport static java.time.duration.ofminutes;\nimport static org.junit.jupiter.api.assertions.*;\n\nclass assertionsdemo {\n\n    private static person person;\n\n    @beforeall\n    public static void beforeall() {\n        person = new person("john", "doe");\n    }\n\n    @test\n    void standardassertions() {\n        assertequals(2, 2);\n        assertequals(4, 4, "the optional assertion message is now the last parameter.");\n        asserttrue(\'a\' < \'b\', () -> "assertion messages can be lazily evaluated -- "\n            + "to avoid constructing complex messages unnecessarily.");\n    }\n\n    @test\n    void groupedassertions() {\n        // in a grouped assertion all assertions are executed, and any\n        // failures will be reported together.\n        assertall("person", () -> assertequals("john", person.getfirstname()),\n            () -> assertequals("doe", person.getlastname()));\n    }\n\n    @test\n    void dependentassertions() {\n        // within a code block, if an assertion fails the\n        // subsequent code in the same block will be skipped.\n        assertall("properties", () -> {\n            string firstname = person.getfirstname();\n            assertnotnull(firstname);\n\n            // executed only if the previous assertion is valid.\n            assertall("first name", () -> asserttrue(firstname.startswith("j")),\n                () -> asserttrue(firstname.endswith("n")));\n        }, () -> {\n            // grouped assertion, so processed independently\n            // of results of first name assertions.\n            string lastname = person.getlastname();\n            assertnotnull(lastname);\n\n            // executed only if the previous assertion is valid.\n            assertall("last name", () -> asserttrue(lastname.startswith("d")),\n                () -> asserttrue(lastname.endswith("e")));\n        });\n    }\n\n    @test\n    void exceptiontesting() {\n        throwable exception = assertthrows(illegalargumentexception.class, () -> {\n            throw new illegalargumentexception("a message");\n        });\n        assertequals("a message", exception.getmessage());\n    }\n\n    @test\n    void timeoutnotexceeded() {\n        // the following assertion succeeds.\n        asserttimeout(ofminutes(2), () -> {\n            // perform task that takes less than 2 minutes.\n        });\n    }\n\n    @test\n    void timeoutnotexceededwithresult() {\n        // the following assertion succeeds, and returns the supplied object.\n        string actualresult = asserttimeout(ofminutes(2), () -> {\n            return "a result";\n        });\n        assertequals("a result", actualresult);\n    }\n\n    @test\n    void timeoutnotexceededwithmethod() {\n        // the following assertion invokes a method reference and returns an object.\n        string actualgreeting = asserttimeout(ofminutes(2), assertionsdemo::greeting);\n        assertequals("hello, world!", actualgreeting);\n    }\n\n    @test\n    void timeoutexceeded() {\n        // the following assertion fails with an error message similar to:\n        // execution exceeded timeout of 10 ms by 91 ms\n        asserttimeout(ofmillis(10), () -> {\n            // simulate task that takes more than 10 ms.\n            thread.sleep(100);\n        });\n    }\n\n    @test\n    void timeoutexceededwithpreemptivetermination() {\n        // the following assertion fails with an error message similar to:\n        // execution timed out after 10 ms\n        asserttimeoutpreemptively(ofmillis(10), () -> {\n            // simulate task that takes more than 10 ms.\n            thread.sleep(100);\n        });\n    }\n\n    private static string greeting() {\n        return "hello, world!";\n    }\n\n}\n\n\n\n# åæ³ï¼assumptionsï¼\n\nimport static org.junit.jupiter.api.assertions.assertequals;\nimport static org.junit.jupiter.api.assumptions.assumetrue;\nimport static org.junit.jupiter.api.assumptions.assumingthat;\n\nimport org.junit.jupiter.api.test;\n\nclass assumptionsdemo {\n\n    @test\n    void testonlyonciserver() {\n        assumetrue("ci".equals(system.getenv("env")));\n        // remainder of test\n    }\n\n    @test\n    void testonlyondeveloperworkstation() {\n        assumetrue("dev".equals(system.getenv("env")),\n            () -> "aborting test: not on developer workstation");\n        // remainder of test\n    }\n\n    @test\n    void testinallenvironments() {\n        assumingthat("ci".equals(system.getenv("env")),\n            () -> {\n                // perform these assertions only on the ci server\n                assertequals(2, 2);\n            });\n\n        // perform these assertions in all environments\n        assertequals("a string", "a string");\n    }\n\n}\n\n\n\n# ç¦ç¨\n\nç¦ç¨ååæµè¯ç±»ç¤ºä¾ï¼\n\nimport org.junit.jupiter.api.disabled;\nimport org.junit.jupiter.api.test;\n\n@disabled\nclass disabledclassdemo {\n    @test\n    void testwillbeskipped() {\n    }\n}\n\n\nç¦ç¨ååæµè¯æ¹æ³ç¤ºä¾ï¼\n\nimport org.junit.jupiter.api.disabled;\nimport org.junit.jupiter.api.test;\n\nclass disabledtestsdemo {\n\n    @disabled\n    @test\n    void testwillbeskipped() {\n    }\n\n    @test\n    void testwillbeexecuted() {\n    }\n}\n\n\n\n# æµè¯æ¡ä»¶\n\n# æä½ç³»ç»æ¡ä»¶\n\n@test\n@enabledonos(mac)\nvoid onlyonmacos() {\n    // ...\n}\n\n@testonmac\nvoid testonmac() {\n    // ...\n}\n\n@test\n@enabledonos({ linux, mac })\nvoid onlinuxormac() {\n    // ...\n}\n\n@test\n@disabledonos(windows)\nvoid notonwindows() {\n    // ...\n}\n\n@target(elementtype.method)\n@retention(retentionpolicy.runtime)\n@test\n@enabledonos(mac)\n@interface testonmac {\n}\n\n\n# java è¿è¡æ¶çæ¬æ¡ä»¶\n\n@test\n@enabledonjre(java_8)\nvoid onlyonjava8() {\n    // ...\n}\n\n@test\n@enabledonjre({ java_9, java_10 })\nvoid onjava9or10() {\n    // ...\n}\n\n@test\n@disabledonjre(java_9)\nvoid notonjava9() {\n    // ...\n}\n\n\n# ç³»ç»å±æ§æ¡ä»¶\n\n@test\n@enabledifsystemproperty(named = "os.arch", matches = ".*64.*")\nvoid onlyon64bitarchitectures() {\n    // ...\n}\n\n@test\n@disabledifsystemproperty(named = "ci-server", matches = "true")\nvoid notonciserver() {\n    // ...\n}\n\n\n\n# åµå¥æµè¯\n\nimport static org.junit.jupiter.api.assertions.assertequals;\nimport static org.junit.jupiter.api.assertions.assertfalse;\nimport static org.junit.jupiter.api.assertions.assertthrows;\nimport static org.junit.jupiter.api.assertions.asserttrue;\n\nimport java.util.emptystackexception;\nimport java.util.stack;\n\nimport org.junit.jupiter.api.beforeeach;\nimport org.junit.jupiter.api.displayname;\nimport org.junit.jupiter.api.nested;\nimport org.junit.jupiter.api.test;\n\n@displayname("a stack")\nclass testingastackdemo {\n\n    stack<object> stack;\n\n    @test\n    @displayname("is instantiated with new stack()")\n    void isinstantiatedwithnew() {\n        new stack<>();\n    }\n\n    @nested\n    @displayname("when new")\n    class whennew {\n\n        @beforeeach\n        void createnewstack() {\n            stack = new stack<>();\n        }\n\n        @test\n        @displayname("is empty")\n        void isempty() {\n            asserttrue(stack.isempty());\n        }\n\n        @test\n        @displayname("throws emptystackexception when popped")\n        void throwsexceptionwhenpopped() {\n            assertthrows(emptystackexception.class, () -> stack.pop());\n        }\n\n        @test\n        @displayname("throws emptystackexception when peeked")\n        void throwsexceptionwhenpeeked() {\n            assertthrows(emptystackexception.class, () -> stack.peek());\n        }\n\n        @nested\n        @displayname("after pushing an element")\n        class afterpushing {\n\n            string anelement = "an element";\n\n            @beforeeach\n            void pushanelement() {\n                stack.push(anelement);\n            }\n\n            @test\n            @displayname("it is no longer empty")\n            void isnotempty() {\n                assertfalse(stack.isempty());\n            }\n\n            @test\n            @displayname("returns the element when popped and is empty")\n            void returnelementwhenpopped() {\n                assertequals(anelement, stack.pop());\n                asserttrue(stack.isempty());\n            }\n\n            @test\n            @displayname("returns the element when peeked but remains not empty")\n            void returnelementwhenpeeked() {\n                assertequals(anelement, stack.peek());\n                assertfalse(stack.isempty());\n            }\n        }\n    }\n}\n\n\n\n# éå¤æµè¯\n\nimport static org.junit.jupiter.api.assertions.assertequals;\n\nimport java.util.logging.logger;\n\nimport org.junit.jupiter.api.beforeeach;\nimport org.junit.jupiter.api.displayname;\nimport org.junit.jupiter.api.repeatedtest;\nimport org.junit.jupiter.api.repetitioninfo;\nimport org.junit.jupiter.api.testinfo;\n\nclass repeatedtestsdemo {\n\n    private logger logger = // ...\n\n    @beforeeach\n    void beforeeach(testinfo testinfo, repetitioninfo repetitioninfo) {\n        int currentrepetition = repetitioninfo.getcurrentrepetition();\n        int totalrepetitions = repetitioninfo.gettotalrepetitions();\n        string methodname = testinfo.gettestmethod().get().getname();\n        logger.info(string.format("about to execute repetition %d of %d for %s", //\n            currentrepetition, totalrepetitions, methodname));\n    }\n\n    @repeatedtest(10)\n    void repeatedtest() {\n        // ...\n    }\n\n    @repeatedtest(5)\n    void repeatedtestwithrepetitioninfo(repetitioninfo repetitioninfo) {\n        assertequals(5, repetitioninfo.gettotalrepetitions());\n    }\n\n    @repeatedtest(value = 1, name = "{displayname} {currentrepetition}/{totalrepetitions}")\n    @displayname("repeat!")\n    void customdisplayname(testinfo testinfo) {\n        assertequals(testinfo.getdisplayname(), "repeat! 1/1");\n    }\n\n    @repeatedtest(value = 1, name = repeatedtest.long_display_name)\n    @displayname("details...")\n    void customdisplaynamewithlongpattern(testinfo testinfo) {\n        assertequals(testinfo.getdisplayname(), "details... :: repetition 1 of 1");\n    }\n\n    @repeatedtest(value = 5, name = "wiederholung {currentrepetition} von {totalrepetitions}")\n    void repeatedtestingerman() {\n        // ...\n    }\n\n}\n\n\n\n# åæ°åæµè¯\n\n@parameterizedtest\n@valuesource(strings = { "racecar", "radar", "able was i ere i saw elba" })\nvoid palindromes(string candidate) {\n    asserttrue(ispalindrome(candidate));\n}\n\n\n\n# å¼ç¨åå¼ç³\n\n * github\n * å®æ¹ç¨æ·æå\n * javadoc\n * çæ¬å£°æ\n * å®æ¹ç¤ºä¾',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Mockito å¿«éå¥é¨",frontmatter:{title:"Mockito å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æµè¯"],tags:["Java","æµè¯","Mockito"],abbrlink:"6d4202df",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/ab18ad/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/04.%E6%B5%8B%E8%AF%95/02.Mockito.html",relativePath:"12.å·¥å·/04.æµè¯/02.Mockito.md",key:"v-f8abeb6c",path:"/pages/ab18ad/",headers:[{level:2,title:"é¢å¤ç¥è¯",slug:"é¢å¤ç¥è¯",normalizedTitle:"é¢å¤ç¥è¯",charIndex:52},{level:2,title:"ä½¿ç¨ mock å¯¹è±¡æ¥è¿è¡æµè¯",slug:"ä½¿ç¨-mock-å¯¹è±¡æ¥è¿è¡æµè¯",normalizedTitle:"ä½¿ç¨ mock å¯¹è±¡æ¥è¿è¡æµè¯",charIndex:120},{level:3,title:"ååæµè¯çç®æ åææ",slug:"ååæµè¯çç®æ åææ",normalizedTitle:"ååæµè¯çç®æ åææ",charIndex:140},{level:3,title:"æµè¯ç±»çåç±»",slug:"æµè¯ç±»çåç±»",normalizedTitle:"æµè¯ç±»çåç±»",charIndex:259},{level:3,title:"Mock å¯¹è±¡çäº§ç",slug:"mock-å¯¹è±¡çäº§ç",normalizedTitle:"mock å¯¹è±¡çäº§ç",charIndex:727},{level:3,title:"ä½¿ç¨ Mockito çæ Mock å¯¹è±¡",slug:"ä½¿ç¨-mockito-çæ-mock-å¯¹è±¡",normalizedTitle:"ä½¿ç¨ mockito çæ mock å¯¹è±¡",charIndex:1021},{level:2,title:"ä¸ºèªå·±çé¡¹ç®æ·»å  Mockito ä¾èµ",slug:"ä¸ºèªå·±çé¡¹ç®æ·»å -mockito-ä¾èµ",normalizedTitle:"ä¸ºèªå·±çé¡¹ç®æ·»å  mockito ä¾èµ",charIndex:1219},{level:3,title:"å¨ Gradle æ·»å  Mockito ä¾èµ",slug:"å¨-gradle-æ·»å -mockito-ä¾èµ",normalizedTitle:"å¨ gradle æ·»å  mockito ä¾èµ",charIndex:1243},{level:3,title:"å¨ Maven æ·»å  Mockito ä¾èµ",slug:"å¨-maven-æ·»å -mockito-ä¾èµ",normalizedTitle:"å¨ maven æ·»å  mockito ä¾èµ",charIndex:1427},{level:3,title:"å¨ Eclipse IDE ä½¿ç¨ Mockito",slug:"å¨-eclipse-ide-ä½¿ç¨-mockito",normalizedTitle:"å¨ eclipse ide ä½¿ç¨ mockito",charIndex:1550},{level:3,title:"ä»¥ OSGi æè Eclipse æä»¶å½¢å¼æ·»å  Mockito ä¾èµ",slug:"ä»¥-osgi-æè-eclipse-æä»¶å½¢å¼æ·»å -mockito-ä¾èµ",normalizedTitle:"ä»¥ osgi æè eclipse æä»¶å½¢å¼æ·»å  mockito ä¾èµ",charIndex:1653},{level:2,title:"ä½¿ç¨ Mockito API",slug:"ä½¿ç¨-mockito-api",normalizedTitle:"ä½¿ç¨ mockito api",charIndex:1843},{level:3,title:"éæå¼ç¨",slug:"éæå¼ç¨",normalizedTitle:"éæå¼ç¨",charIndex:1862},{level:3,title:"ä½¿ç¨ Mockito åå»ºåéç½® mock å¯¹è±¡",slug:"ä½¿ç¨-mockito-åå»ºåéç½®-mock-å¯¹è±¡",normalizedTitle:"ä½¿ç¨ mockito åå»ºåéç½® mock å¯¹è±¡",charIndex:1951},{level:3,title:"éç½® mock",slug:"éç½®-mock",normalizedTitle:"éç½® mock",charIndex:1097},{level:3,title:"éªè¯ mock å¯¹è±¡æ¹æ³æ¯å¦è¢«è°ç¨",slug:"éªè¯-mock-å¯¹è±¡æ¹æ³æ¯å¦è¢«è°ç¨",normalizedTitle:"éªè¯ mock å¯¹è±¡æ¹æ³æ¯å¦è¢«è°ç¨",charIndex:5121},{level:3,title:"ä½¿ç¨ Spy å°è£ java å¯¹è±¡",slug:"ä½¿ç¨-spy-å°è£-java-å¯¹è±¡",normalizedTitle:"ä½¿ç¨ spy å°è£ java å¯¹è±¡",charIndex:6082},{level:3,title:"ä½¿ç¨ @InjectMocks å¨ Mockito ä¸­è¿è¡ä¾èµæ³¨å¥",slug:"ä½¿ç¨-injectmocks-å¨-mockito-ä¸­è¿è¡ä¾èµæ³¨å¥",normalizedTitle:"ä½¿ç¨ @injectmocks å¨ mockito ä¸­è¿è¡ä¾èµæ³¨å¥",charIndex:6507},{level:3,title:"ææåæ°",slug:"ææåæ°",normalizedTitle:"ææåæ°",charIndex:7645},{level:3,title:"Mockito çéå¶",slug:"mockito-çéå¶",normalizedTitle:"mockito çéå¶",charIndex:8707},{level:2,title:"å¨ Android ä¸­ä½¿ç¨ Mockito",slug:"å¨-android-ä¸­ä½¿ç¨-mockito",normalizedTitle:"å¨ android ä¸­ä½¿ç¨ mockito",charIndex:8817},{level:2,title:"å®ä¾ï¼ä½¿ç¨ Mockito åä¸ä¸ª Instrumented Unit Test",slug:"å®ä¾-ä½¿ç¨-mockito-åä¸ä¸ª-instrumented-unit-test",normalizedTitle:"å®ä¾ï¼ä½¿ç¨ mockito åä¸ä¸ª instrumented unit test",charIndex:9369},{level:3,title:"åå»ºä¸ä¸ªæµè¯ç Android åºç¨",slug:"åå»ºä¸ä¸ªæµè¯ç-android-åºç¨",normalizedTitle:"åå»ºä¸ä¸ªæµè¯ç android åºç¨",charIndex:9414},{level:3,title:"å¨ app/build.gradle æä»¶ä¸­æ·»å  Mockito ä¾èµ",slug:"å¨-app-build-gradle-æä»¶ä¸­æ·»å -mockito-ä¾èµ",normalizedTitle:"å¨ app/build.gradle æä»¶ä¸­æ·»å  mockito ä¾èµ",charIndex:9789},{level:3,title:"åå»ºæµè¯",slug:"åå»ºæµè¯",normalizedTitle:"åå»ºæµè¯",charIndex:10344},{level:2,title:"å®ä¾ï¼ä½¿ç¨ Mockito åå»ºä¸ä¸ª mock å¯¹è±¡",slug:"å®ä¾-ä½¿ç¨-mockito-åå»ºä¸ä¸ª-mock-å¯¹è±¡",normalizedTitle:"å®ä¾ï¼ä½¿ç¨ mockito åå»ºä¸ä¸ª mock å¯¹è±¡",charIndex:11236},{level:3,title:"ç®æ ",slug:"ç®æ ",normalizedTitle:"ç®æ ",charIndex:145},{level:3,title:"åå»ºä¸ä¸ª Twitter API çä¾å­",slug:"åå»ºä¸ä¸ª-twitter-api-çä¾å­",normalizedTitle:"åå»ºä¸ä¸ª twitter api çä¾å­",charIndex:11307},{level:3,title:"æ¨¡æ ITweet çå®ä¾",slug:"æ¨¡æ-itweet-çå®ä¾",normalizedTitle:"æ¨¡æ itweet çå®ä¾",charIndex:11657},{level:3,title:"éªè¯æ¹æ³è°ç¨",slug:"éªè¯æ¹æ³è°ç¨",normalizedTitle:"éªè¯æ¹æ³è°ç¨",charIndex:12078},{level:3,title:"éªè¯",slug:"éªè¯",normalizedTitle:"éªè¯",charIndex:619},{level:2,title:"æ¨¡æéææ¹æ³",slug:"æ¨¡æéææ¹æ³",normalizedTitle:"æ¨¡æéææ¹æ³",charIndex:12456},{level:3,title:"ä½¿ç¨ Powermock æ¥æ¨¡æéææ¹æ³",slug:"ä½¿ç¨-powermock-æ¥æ¨¡æéææ¹æ³",normalizedTitle:"ä½¿ç¨ powermock æ¥æ¨¡æéææ¹æ³",charIndex:12467},{level:3,title:"ç¨å°è£çæ¹æ³ä»£æ¿ Powermock",slug:"ç¨å°è£çæ¹æ³ä»£æ¿-powermock",normalizedTitle:"ç¨å°è£çæ¹æ³ä»£æ¿ powermock",charIndex:13368},{level:2,title:"å¼ç¨åå¼ç³",slug:"å¼ç¨åå¼ç³",normalizedTitle:"å¼ç¨åå¼ç³",charIndex:13527}],headersStr:"é¢å¤ç¥è¯ ä½¿ç¨ mock å¯¹è±¡æ¥è¿è¡æµè¯ ååæµè¯çç®æ åææ æµè¯ç±»çåç±» Mock å¯¹è±¡çäº§ç ä½¿ç¨ Mockito çæ Mock å¯¹è±¡ ä¸ºèªå·±çé¡¹ç®æ·»å  Mockito ä¾èµ å¨ Gradle æ·»å  Mockito ä¾èµ å¨ Maven æ·»å  Mockito ä¾èµ å¨ Eclipse IDE ä½¿ç¨ Mockito ä»¥ OSGi æè Eclipse æä»¶å½¢å¼æ·»å  Mockito ä¾èµ ä½¿ç¨ Mockito API éæå¼ç¨ ä½¿ç¨ Mockito åå»ºåéç½® mock å¯¹è±¡ éç½® mock éªè¯ mock å¯¹è±¡æ¹æ³æ¯å¦è¢«è°ç¨ ä½¿ç¨ Spy å°è£ java å¯¹è±¡ ä½¿ç¨ @InjectMocks å¨ Mockito ä¸­è¿è¡ä¾èµæ³¨å¥ ææåæ° Mockito çéå¶ å¨ Android ä¸­ä½¿ç¨ Mockito å®ä¾ï¼ä½¿ç¨ Mockito åä¸ä¸ª Instrumented Unit Test åå»ºä¸ä¸ªæµè¯ç Android åºç¨ å¨ app/build.gradle æä»¶ä¸­æ·»å  Mockito ä¾èµ åå»ºæµè¯ å®ä¾ï¼ä½¿ç¨ Mockito åå»ºä¸ä¸ª mock å¯¹è±¡ ç®æ  åå»ºä¸ä¸ª Twitter API çä¾å­ æ¨¡æ ITweet çå®ä¾ éªè¯æ¹æ³è°ç¨ éªè¯ æ¨¡æéææ¹æ³ ä½¿ç¨ Powermock æ¥æ¨¡æéææ¹æ³ ç¨å°è£çæ¹æ³ä»£æ¿ Powermock å¼ç¨åå¼ç³",content:'# Mockito å¿«éå¥é¨\n\n> Mockito æ¯ä¸ä¸ªéå¯¹ Java ç mock æ¡æ¶ã\n\n\n# é¢å¤ç¥è¯\n\nå¦æéè¦å¾ä¸å­¦ä¹ ï¼ä½ éè¦åçè§£ Junit æ¡æ¶ä¸­çååæµè¯ã\n\nå¦æä½ ä¸çæ JUnitï¼è¯·ç Junit æç¨\n\n\n# ä½¿ç¨ mock å¯¹è±¡æ¥è¿è¡æµè¯\n\n\n# ååæµè¯çç®æ åææ\n\nååæµè¯çæè·¯æ¯å¨ä¸æ¶åä¾èµå³ç³»çæåµä¸æµè¯ä»£ç ï¼éç¦»æ§ï¼ï¼æä»¥æµè¯ä»£ç ä¸å¶ä»ç±»æèç³»ç»çå³ç³»åºè¯¥å°½éè¢«æ¶é¤ãä¸ä¸ªå¯è¡çæ¶é¤æ¹æ³æ¯æ¿æ¢æä¾èµç±»ï¼æµè¯æ¿æ¢ï¼ï¼ä¹å°±æ¯è¯´æä»¬å¯ä»¥ä½¿ç¨æ¿èº«æ¥æ¿æ¢æçæ­£çä¾èµå¯¹è±¡ã\n\n\n# æµè¯ç±»çåç±»\n\n * dummy object åä¸ºåæ°ä¼ éç»æ¹æ³ä½æ¯ç»å¯¹ä¸ä¼è¢«ä½¿ç¨ãè­¬å¦è¯´ï¼è¿ç§æµè¯ç±»åé¨çæ¹æ³ä¸ä¼è¢«è°ç¨ï¼æèæ¯ç¨æ¥å¡«åæä¸ªæ¹æ³çåæ°ã\n * Fake æ¯çæ­£æ¥å£ææ½è±¡ç±»çå®ç°ä½ï¼ä½ç»å¯¹è±¡åé¨å®ç°å¾ç®åãè­¬å¦è¯´ï¼å®å­å¨åå­ä¸­èä¸æ¯çæ­£çæ°æ®åºä¸­ãï¼è¯èæ³¨ï¼Fake å®ç°äºçæ­£çé»è¾ï¼ä½å®çå­å¨åªæ¯ä¸ºäºæµè¯ï¼èä¸éåäºç¨å¨äº§åä¸­ãï¼\n * stub ç±»æ¯ä¾èµç±»çé¨åæ¹æ³å®ç°ï¼èè¿äºæ¹æ³å¨ä½ æµè¯ç±»åæ¥å£çæ¶åä¼è¢«ç¨å°ï¼ä¹å°±æ¯è¯´ stub ç±»å¨æµè¯ä¸­ä¼è¢«å®ä¾åãstub ç±»ä¼ååºä»»ä½å¤é¨æµè¯çè°ç¨ãstub ç±»ææ¶åè¿ä¼è®°å½è°ç¨çä¸äºä¿¡æ¯ã\n * mock object æ¯æç±»æèæ¥å£çæ¨¡æå®ç°ï¼ä½ å¯ä»¥èªå®ä¹è¿ä¸ªå¯¹è±¡ä¸­æä¸ªæ¹æ³çè¾åºç»æã\n\næµè¯æ¿ä»£ææ¯è½å¤å¨æµè¯ä¸­æ¨¡ææµè¯ç±»ä»¥å¤å¯¹è±¡ãå æ­¤ä½ å¯ä»¥éªè¯æµè¯ç±»æ¯å¦ååºæ­£å¸¸ãè­¬å¦è¯´ï¼ä½ å¯ä»¥éªè¯å¨ Mock å¯¹è±¡çæä¸ä¸ªæ¹æ³æ¯å¦è¢«è°ç¨ãè¿å¯ä»¥ç¡®ä¿éç¦»äºå¤é¨ä¾èµçå¹²æ°åªæµè¯æµè¯ç±»ã\n\næä»¬éæ© Mock å¯¹è±¡çåå æ¯å ä¸º Mock å¯¹è±¡åªéè¦å°éä»£ç çéç½®ã\n\n\n# Mock å¯¹è±¡çäº§ç\n\nä½ å¯ä»¥æå¨åå»ºä¸ä¸ª Mock å¯¹è±¡æèä½¿ç¨ Mock æ¡æ¶æ¥æ¨¡æè¿äºç±»ï¼Mock æ¡æ¶åè®¸ä½ å¨è¿è¡æ¶åå»º Mock å¯¹è±¡å¹¶ä¸å®ä¹å®çè¡ä¸ºã\n\nä¸ä¸ªå¸åçä¾å­æ¯æ Mock å¯¹è±¡æ¨¡æææ°æ®çæä¾èãå¨æ­£å¼ççäº§ç¯å¢ä¸­å®ä¼è¢«å®ç°ç¨æ¥è¿æ¥æ°æ®æºãä½æ¯æä»¬å¨æµè¯çæ¶å Mock å¯¹è±¡å°ä¼æ¨¡æææ°æ®æä¾èæ¥ç¡®ä¿æä»¬çæµè¯ç¯å¢å§ç»æ¯ç¸åçã\n\nMock å¯¹è±¡å¯ä»¥è¢«æä¾æ¥è¿è¡æµè¯ãå æ­¤ï¼æä»¬æµè¯çç±»åºè¯¥é¿åä»»ä½å¤é¨æ°æ®çå¼ºä¾èµã\n\néè¿ Mock å¯¹è±¡æè Mock æ¡æ¶ï¼æä»¬å¯ä»¥æµè¯ä»£ç ä¸­ææçè¡ä¸ºãè­¬å¦è¯´ï¼éªè¯åªææä¸ªå­å¨ Mock å¯¹è±¡çæ¹æ³æ¯å¦è¢«è°ç¨äºã\n\n\n# ä½¿ç¨ Mockito çæ Mock å¯¹è±¡\n\nMockito æ¯ä¸ä¸ªæµè¡ mock æ¡æ¶ï¼å¯ä»¥å JUnit ç»åèµ·æ¥ä½¿ç¨ãMockito åè®¸ä½ åå»ºåéç½® mock å¯¹è±¡ãä½¿ç¨ Mockito å¯ä»¥ææ¾çç®åå¯¹å¤é¨ä¾èµçæµè¯ç±»çå¼åã\n\nä¸è¬ä½¿ç¨ Mockito éè¦æ§è¡ä¸é¢ä¸æ­¥\n\n 1. æ¨¡æå¹¶æ¿æ¢æµè¯ä»£ç ä¸­å¤é¨ä¾èµ\n 2. æ§è¡æµè¯ä»£ç \n 3. éªè¯æµè¯ä»£ç æ¯å¦è¢«æ­£ç¡®çæ§è¡ 0\n\n\n# ä¸ºèªå·±çé¡¹ç®æ·»å  Mockito ä¾èµ\n\n\n# å¨ Gradle æ·»å  Mockito ä¾èµ\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ Gradle æå»ºï¼å°ä¸é¢ä»£ç å å¥ Gradle çæå»ºæä»¶ä¸­ä¸ºèªå·±é¡¹ç®æ·»å  Mockito ä¾èµ\n\nrepositories { jcenter() }\ndependencies { testCompile "org.mockito:mockito-core:2.0.57-beta" }\n\n\n\n# å¨ Maven æ·»å  Mockito ä¾èµ\n\néè¦å¨ Maven å£°æä¾èµï¼æ¨å¯ä»¥å¨ http://search.maven.org ç½ç«ä¸­æç´¢ g:"org.mockito", a:"mockito-core" æ¥å¾å°å·ä½çå£°ææ¹å¼ã\n\n\n# å¨ Eclipse IDE ä½¿ç¨ Mockito\n\nEclipse IDE æ¯æ Gradle å Maven ä¸¤ç§æå»ºå·¥å·ï¼æä»¥å¨ Eclipse IDE æ·»å ä¾èµåå³ä½ ä½¿ç¨çæ¯åªä¸ä¸ªæå»ºå·¥å·ã\n\n\n# ä»¥ OSGi æè Eclipse æä»¶å½¢å¼æ·»å  Mockito ä¾èµ\n\nå¨ Eclipse RCP åºç¨ä¾èµéå¸¸å¯ä»¥å¨ p2 update ä¸å¾å°ãOrbit æ¯ä¸ä¸ªå¾å¥½çç¬¬ä¸æ¹ä»åºï¼æä»¬å¯ä»¥å¨éé¢å¯»æ¾è½å¨ Eclipse ä¸ä½¿ç¨çåºç¨åæä»¶ã\n\nOrbit ä»åºå°åï¼http://download.eclipse.org/tools/orbit/downloads\n\n\n# ä½¿ç¨ Mockito API\n\n\n# éæå¼ç¨\n\nå¦æå¨ä»£ç ä¸­éæå¼ç¨äºorg.mockito.Mockito.*;ï¼é£ä½ ä½ å°±å¯ä»¥ç´æ¥è°ç¨éææ¹æ³åéæåéèä¸ç¨åå»ºå¯¹è±¡ï¼è­¬å¦ç´æ¥è°ç¨ mock() æ¹æ³ã\n\n\n# ä½¿ç¨ Mockito åå»ºåéç½® mock å¯¹è±¡\n\né¤äºä¸é¢æè¯´çä½¿ç¨ mock() éææ¹æ³å¤ï¼Mockito è¿æ¯æéè¿ @Mock æ³¨è§£çæ¹å¼æ¥åå»º mock å¯¹è±¡ã\n\nå¦æä½ ä½¿ç¨æ³¨è§£ï¼é£ä¹å¿é¡»è¦å®ä¾å mock å¯¹è±¡ãMockito å¨éå°ä½¿ç¨æ³¨è§£çå­æ®µçæ¶åï¼ä¼è°ç¨MockitoAnnotations.initMocks(this) æ¥åå§åè¯¥ mock å¯¹è±¡ãå¦å¤ä¹å¯ä»¥éè¿ä½¿ç¨@RunWith(MockitoJUnitRunner.class)æ¥è¾¾å°ç¸åçææã\n\néè¿ä¸é¢çä¾å­æä»¬å¯ä»¥äºè§£å°ä½¿ç¨@Mock çæ¹æ³åMockitoRuleè§åã\n\nimport static org.mockito.Mockito.*;\n\npublic class MockitoTest  {\n\n        @Mock\n        MyDatabase databaseMock; (1)\n\n        @Rule public MockitoRule mockitoRule = MockitoJUnit.rule(); (2)\n\n        @Test\n        public void testQuery()  {\n                ClassToTest t  = new ClassToTest(databaseMock); (3)\n                boolean check = t.query("* from t"); (4)\n                assertTrue(check); (5)\n                verify(databaseMock).query("* from t"); (6)\n        }\n}\n\n\n 1. åè¯ Mockito æ¨¡æ databaseMock å®ä¾\n 2. Mockito éè¿ @mock æ³¨è§£åå»º mock å¯¹è±¡\n 3. ä½¿ç¨å·²ç»åå»ºç mock åå§åè¿ä¸ªç±»\n 4. å¨æµè¯ç¯å¢ä¸ï¼æ§è¡æµè¯ç±»ä¸­çä»£ç \n 5. ä½¿ç¨æ­è¨ç¡®ä¿è°ç¨çæ¹æ³è¿åå¼ä¸º true\n 6. éªè¯ query æ¹æ³æ¯å¦è¢« MyDatabase ç mock å¯¹è±¡è°ç¨\n\n\n# éç½® mock\n\nå½æä»¬éè¦éç½®æä¸ªæ¹æ³çè¿åå¼çæ¶åï¼Mockito æä¾äºé¾å¼ç API ä¾æä»¬æ¹ä¾¿çè°ç¨\n\nwhen(â¦.).thenReturn(â¦.)å¯ä»¥è¢«ç¨æ¥å®ä¹å½æ¡ä»¶æ»¡è¶³æ¶å½æ°çè¿åå¼ï¼å¦æä½ éè¦å®ä¹å¤ä¸ªè¿åå¼ï¼å¯ä»¥å¤æ¬¡å®ä¹ãå½ä½ å¤æ¬¡è°ç¨å½æ°çæ¶åï¼Mockito ä¼æ ¹æ®ä½ å®ä¹çååé¡ºåºæ¥è¿åè¿åå¼ãMocks è¿å¯ä»¥æ ¹æ®ä¼ å¥åæ°çä¸åæ¥å®ä¹ä¸åçè¿åå¼ãè­¬å¦è¯´ä½ çå½æ°å¯ä»¥å°anyString æè anyIntä½ä¸ºè¾å¥åæ°ï¼ç¶åå®ä¹å¶ç¹å®çæ¾åå¼ã\n\nimport static org.mockito.Mockito.*;\nimport static org.junit.Assert.*;\n\n@Test\npublic void test1()  {\n        //  åå»º mock\n        MyClass test = Mockito.mock(MyClass.class);\n\n        // èªå®ä¹ getUniqueId() çè¿åå¼\n        when(test.getUniqueId()).thenReturn(43);\n\n        // å¨æµè¯ä¸­ä½¿ç¨mockå¯¹è±¡\n        assertEquals(test.getUniqueId(), 43);\n}\n\n// è¿åå¤ä¸ªå¼\n@Test\npublic void testMoreThanOneReturnValue()  {\n        Iterator i= mock(Iterator.class);\n        when(i.next()).thenReturn("Mockito").thenReturn("rocks");\n        String result=i.next()+" "+i.next();\n        // æ­è¨\n        assertEquals("Mockito rocks", result);\n}\n\n// å¦ä½æ ¹æ®è¾å¥æ¥è¿åå¼\n@Test\npublic void testReturnValueDependentOnMethodParameter()  {\n        Comparable c= mock(Comparable.class);\n        when(c.compareTo("Mockito")).thenReturn(1);\n        when(c.compareTo("Eclipse")).thenReturn(2);\n        // æ­è¨\n        assertEquals(1,c.compareTo("Mockito"));\n}\n\n// å¦ä½è®©è¿åå¼ä¸ä¾èµäºè¾å¥\n@Test\npublic void testReturnValueInDependentOnMethodParameter()  {\n        Comparable c= mock(Comparable.class);\n        when(c.compareTo(anyInt())).thenReturn(-1);\n        // æ­è¨\n        assertEquals(-1 ,c.compareTo(9));\n}\n\n// æ ¹æ®åæ°ç±»åæ¥è¿åå¼\n@Test\npublic void testReturnValueInDependentOnMethodParameter()  {\n        Comparable c= mock(Comparable.class);\n        when(c.compareTo(isA(Todo.class))).thenReturn(0);\n        // æ­è¨\n        Todo todo = new Todo(5);\n        assertEquals(todo ,c.compareTo(new Todo(1)));\n}\n\n\nå¯¹äºæ è¿åå¼çå½æ°ï¼æä»¬å¯ä»¥ä½¿ç¨doReturn(â¦).when(â¦).methodCallæ¥è·å¾ç±»ä¼¼çææãä¾å¦æä»¬æ³å¨è°ç¨æäºæ è¿åå¼å½æ°çæ¶åæåºå¼å¸¸ï¼é£ä¹å¯ä»¥ä½¿ç¨doThrow æ¹æ³ãå¦ä¸é¢ä»£ç çæ®µæç¤º\n\nimport static org.mockito.Mockito.*;\nimport static org.junit.Assert.*;\n\n// ä¸é¢æµè¯ç¨ä¾æè¿°äºå¦ä½ä½¿ç¨doThrow()æ¹æ³\n\n@Test(expected=IOException.class)\npublic void testForIOException() {\n        // åå»ºå¹¶éç½® mock å¯¹è±¡\n        OutputStream mockStream = mock(OutputStream.class);\n        doThrow(new IOException()).when(mockStream).close();\n\n        // ä½¿ç¨ mock\n        OutputStreamWriter streamWriter= new OutputStreamWriter(mockStream);\n        streamWriter.close();\n}\n\n\n\n# éªè¯ mock å¯¹è±¡æ¹æ³æ¯å¦è¢«è°ç¨\n\nMockito ä¼è·è¸ª mock å¯¹è±¡éé¢ææçæ¹æ³ååéãæä»¥æä»¬å¯ä»¥ç¨æ¥éªè¯å½æ°å¨ä¼ å¥ç¹å®åæ°çæ¶åæ¯å¦è¢«è°ç¨ãè¿ç§æ¹å¼çæµè¯ç§°è¡ä¸ºæµè¯ï¼è¡ä¸ºæµè¯å¹¶ä¸ä¼æ£æ¥å½æ°çè¿åå¼ï¼èæ¯æ£æ¥å¨ä¼ å¥æ­£ç¡®åæ°æ¶åå½æ°æ¯å¦è¢«è°ç¨ã\n\nimport static org.mockito.Mockito.*;\n\n@Test\npublic void testVerify()  {\n        // åå»ºå¹¶éç½® mock å¯¹è±¡\n        MyClass test = Mockito.mock(MyClass.class);\n        when(test.getUniqueId()).thenReturn(43);\n\n        // è°ç¨mockå¯¹è±¡éé¢çæ¹æ³å¹¶ä¼ å¥åæ°ä¸º12\n        test.testing(12);\n        test.getUniqueId();\n        test.getUniqueId();\n\n        // æ¥çå¨ä¼ å¥åæ°ä¸º12çæ¶åæ¹æ³æ¯å¦è¢«è°ç¨\n        verify(test).testing(Matchers.eq(12));\n\n        // æ¹æ³æ¯å¦è¢«è°ç¨ä¸¤æ¬¡\n        verify(test, times(2)).getUniqueId();\n\n        // å¶ä»ç¨æ¥éªè¯å½æ°æ¯å¦è¢«è°ç¨çæ¹æ³\n        verify(mock, never()).someMethod("never called");\n        verify(mock, atLeastOnce()).someMethod("called at least once");\n        verify(mock, atLeast(2)).someMethod("called at least twice");\n        verify(mock, times(5)).someMethod("called five times");\n        verify(mock, atMost(3)).someMethod("called at most 3 times");\n}\n\n\n\n# ä½¿ç¨ Spy å°è£ java å¯¹è±¡\n\n@Spy æèspy()æ¹æ³å¯ä»¥è¢«ç¨æ¥å°è£ java å¯¹è±¡ãè¢«å°è£åï¼é¤éç¹æ®å£°æï¼ææ¡© stubï¼ï¼å¦åé½ä¼çæ­£çè°ç¨å¯¹è±¡éé¢çæ¯ä¸ä¸ªæ¹æ³\n\nimport static org.mockito.Mockito.*;\n\n// Lets mock a LinkedList\nList list = new LinkedList();\nList spy = spy(list);\n\n// å¯ç¨ doReturn() æ¥ææ¡©\ndoReturn("foo").when(spy).get(0);\n\n// ä¸é¢ä»£ç ä¸çæ\n// çæ­£çæ¹æ³ä¼è¢«è°ç¨\n// å°ä¼æåº IndexOutOfBoundsException çå¼å¸¸ï¼å ä¸º List ä¸ºç©º\nwhen(spy.get(0)).thenReturn("foo");\n\n\næ¹æ³verifyNoMoreInteractions()åè®¸ä½ æ£æ¥æ²¡æå¶ä»çæ¹æ³è¢«è°ç¨äºã\n\n\n# ä½¿ç¨ @InjectMocks å¨ Mockito ä¸­è¿è¡ä¾èµæ³¨å¥\n\næä»¬ä¹å¯ä»¥ä½¿ç¨@InjectMocks æ³¨è§£æ¥åå»ºå¯¹è±¡ï¼å®ä¼æ ¹æ®ç±»åæ¥æ³¨å¥å¯¹è±¡éé¢çæåæ¹æ³ååéãåå®æä»¬æ ArticleManager ç±»\n\npublic class ArticleManager {\n    private User user;\n    private ArticleDatabase database;\n\n    ArticleManager(User user) {\n     this.user = user;\n    }\n\n    void setDatabase(ArticleDatabase database) { }\n}\n\n\nè¿ä¸ªç±»ä¼è¢« Mockito æé ï¼èç±»çæåæ¹æ³ååéé½ä¼è¢« mock å¯¹è±¡æä»£æ¿ï¼æ­£å¦ä¸é¢çä»£ç çæ®µæç¤ºï¼\n\n@RunWith(MockitoJUnitRunner.class)\npublic class ArticleManagerTest  {\n\n       @Mock ArticleCalculator calculator;\n       @Mock ArticleDatabase database;\n       @Most User user;\n\n       @Spy private UserProvider userProvider = new ConsumerUserProvider();\n\n       @InjectMocks private ArticleManager manager; (1)\n\n       @Test public void shouldDoSomething() {\n               // åå® ArticleManager æä¸ä¸ªå« initialize() çæ¹æ³è¢«è°ç¨äº\n               // ä½¿ç¨ ArticleListener æ¥è°ç¨ addListener æ¹æ³\n               manager.initialize();\n\n               // éªè¯ addListener æ¹æ³è¢«è°ç¨\n               verify(database).addListener(any(ArticleListener.class));\n       }\n}\n\n\n 1. åå»º ArticleManager å®ä¾å¹¶æ³¨å¥ Mock å¯¹è±¡\n\næ´å¤çè¯¦æå¯ä»¥æ¥ç http://docs.mockito.googlecode.com/hg/1.9.5/org/mockito/InjectMocks.html\n\n\n# ææåæ°\n\nArgumentCaptorç±»åè®¸æä»¬å¨ verification æé´è®¿é®æ¹æ³çåæ°ãå¾å°æ¹æ³çåæ°åæä»¬å¯ä»¥ä½¿ç¨å®è¿è¡æµè¯ã\n\nimport static org.hamcrest.Matchers.hasItem;\nimport static org.junit.Assert.assertThat;\nimport static org.mockito.Mockito.mock;\nimport static org.mockito.Mockito.verify;\n\nimport java.util.Arrays;\nimport java.util.List;\n\nimport org.junit.Rule;\nimport org.junit.Test;\nimport org.mockito.ArgumentCaptor;\nimport org.mockito.Captor;\nimport org.mockito.junit.MockitoJUnit;\nimport org.mockito.junit.MockitoRule;\n\npublic class MockitoTests {\n    @Rule\n    public MockitoRule rule = MockitoJUnit.rule();\n\n    @Captor\n    private ArgumentCaptor<List<String>> captor;\n\n    @Test\n    public final void shouldContainCertainListItem() {\n        List<String> asList = Arrays.asList("someElement_test", "someElement");\n        final List<String> mockedList = mock(List.class);\n        mockedList.addAll(asList);\n\n        verify(mockedList).addAll(captor.capture());\n        final List<String> capturedArgument = captor.getValue();\n        assertThat(capturedArgument, hasItem("someElement"));\n    }\n}\n\n\n\n# Mockito çéå¶\n\nMockito å½ç¶ä¹æä¸å®çéå¶ãèä¸é¢ä¸ç§æ°æ®ç±»ååä¸è½å¤è¢«æµè¯\n\n * final classes\n * anonymous classes\n * primitive types\n\n\n# å¨ Android ä¸­ä½¿ç¨ Mockito\n\nå¨ Android ä¸­ç Gradle æå»ºæä»¶ä¸­å å¥ Mockito ä¾èµåå°±å¯ä»¥ç´æ¥ä½¿ç¨ Mockito äºãè¥æ³ä½¿ç¨ Android Instrumented tests çè¯ï¼è¿éè¦æ·»å  dexmaker å dexmaker-mockito ä¾èµå° Gradle çæå»ºæä»¶ä¸­ãï¼éè¦ Mockito 1.9.5 çæ¬ä»¥ä¸ï¼\n\ndependencies {\n    testCompile \'junit:junit:4.12\'\n    // Mockito unit test çä¾èµ\n    testCompile \'org.mockito:mockito-core:1.+\'\n    // Mockito Android instrumentation tests çä¾èµ\n    androidTestCompile \'org.mockito:mockito-core:1.+\'\n    androidTestCompile "com.google.dexmaker:dexmaker:1.2"\n    androidTestCompile "com.google.dexmaker:dexmaker-mockito:1.2"\n}\n\n\n\n# å®ä¾ï¼ä½¿ç¨ Mockito åä¸ä¸ª Instrumented Unit Test\n\n\n# åå»ºä¸ä¸ªæµè¯ç Android åºç¨\n\nåå»ºä¸ä¸ªååä¸ºcom.vogella.android.testing.mockito.contextmockç Android åºç¨ï¼æ·»å ä¸ä¸ªéææ¹æ³ ï¼æ¹æ³éé¢åå»ºä¸ä¸ªåå«åæ°ç Intentï¼å¦ä¸ä»£ç æç¤ºï¼\n\npublic static Intent createQuery(Context context, String query, String value) {\n    // ç®åèµ·è§ï¼éç¨MainActivity\n    Intent i = new Intent(context, MainActivity.class);\n    i.putExtra("QUERY", query);\n    i.putExtra("VALUE", value);\n    return i;\n}\n\n\n\n# å¨ app/build.gradle æä»¶ä¸­æ·»å  Mockito ä¾èµ\n\ndependencies {\n    // Mockito å JUnit çä¾èµ\n    // instrumentation unit tests on the JVM\n    androidTestCompile \'junit:junit:4.12\'\n    androidTestCompile \'org.mockito:mockito-core:2.0.57-beta\'\n    androidTestCompile \'com.android.support.test:runner:0.3\'\n    androidTestCompile "com.google.dexmaker:dexmaker:1.2"\n    androidTestCompile "com.google.dexmaker:dexmaker-mockito:1.2"\n\n    // Mockito å JUnit çä¾èµ\n    // tests on the JVM\n    testCompile \'junit:junit:4.12\'\n    testCompile \'org.mockito:mockito-core:1.+\'\n\n}\n\n\n\n# åå»ºæµè¯\n\nä½¿ç¨ Mockito åå»ºä¸ä¸ªååæµè¯æ¥éªè¯å¨ä¼ éæ­£ç¡® extra data çæåµä¸ï¼intent æ¯å¦è¢«è§¦åã\n\nå æ­¤æä»¬éè¦ä½¿ç¨ Mockito æ¥ mock ä¸ä¸ªContextå¯¹è±¡ï¼å¦ä¸ä»£ç æç¤ºï¼\n\npackage com.vogella.android.testing.mockitocontextmock;\n\nimport android.content.Context;\nimport android.content.Intent;\nimport android.os.Bundle;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.mockito.Mockito;\n\nimport static org.junit.Assert.assertEquals;\nimport static org.junit.Assert.assertNotNull;\n\npublic class TextIntentCreation {\n\n    @Test\n    public void testIntentShouldBeCreated() {\n        Context context = Mockito.mock(Context.class);\n        Intent intent = MainActivity.createQuery(context, "query", "value");\n        assertNotNull(intent);\n        Bundle extras = intent.getExtras();\n        assertNotNull(extras);\n        assertEquals("query", extras.getString("QUERY"));\n        assertEquals("value", extras.getString("VALUE"));\n    }\n}\n\n\n\n# å®ä¾ï¼ä½¿ç¨ Mockito åå»ºä¸ä¸ª mock å¯¹è±¡\n\n\n# ç®æ \n\nåå»ºä¸ä¸ª Apiï¼å®å¯ä»¥è¢« Mockito æ¥æ¨¡æå¹¶åä¸äºå·¥ä½\n\n\n# åå»ºä¸ä¸ª Twitter API çä¾å­\n\nå®ç° TwitterClientç±»ï¼å®åé¨ä½¿ç¨å°äº ITweet çå®ç°ãä½æ¯ITweetå®ä¾å¾é¾å¾å°ï¼è­¬å¦è¯´ä»éè¦å¯å¨ä¸ä¸ªå¾å¤æçæå¡æ¥å¾å°ã\n\npublic interface ITweet {\n\n        String getMessage();\n}\n\n\npublic class TwitterClient {\n\n        public void sendTweet(ITweet tweet) {\n                String message = tweet.getMessage();\n\n                // send the message to Twitter\n        }\n}\n\n\n\n# æ¨¡æ ITweet çå®ä¾\n\nä¸ºäºè½å¤ä¸å¯å¨å¤æçæå¡æ¥å¾å° ITweetï¼æä»¬å¯ä»¥ä½¿ç¨ Mockito æ¥æ¨¡æå¾å°è¯¥å®ä¾ã\n\n@Test\npublic void testSendingTweet() {\n        TwitterClient twitterClient = new TwitterClient();\n\n        ITweet iTweet = mock(ITweet.class);\n\n        when(iTweet.getMessage()).thenReturn("Using mockito is great");\n\n        twitterClient.sendTweet(iTweet);\n}\n\n\nç°å¨ TwitterClient å¯ä»¥ä½¿ç¨ ITweet æ¥å£çå®ç°ï¼å½è°ç¨ getMessage() æ¹æ³çæ¶åå°ä¼æå° "Using Mockito is great" ä¿¡æ¯ã\n\n\n# éªè¯æ¹æ³è°ç¨\n\nç¡®ä¿ getMessage() æ¹æ³è³å°è°ç¨ä¸æ¬¡ã\n\n@Test\npublic void testSendingTweet() {\n        TwitterClient twitterClient = new TwitterClient();\n\n        ITweet iTweet = mock(ITweet.class);\n\n        when(iTweet.getMessage()).thenReturn("Using mockito is great");\n\n        twitterClient.sendTweet(iTweet);\n\n        verify(iTweet, atLeastOnce()).getMessage();\n}\n\n\n\n# éªè¯\n\nè¿è¡æµè¯ï¼æ¥çä»£ç æ¯å¦æµè¯éè¿ã\n\n\n# æ¨¡æéææ¹æ³\n\n\n# ä½¿ç¨ Powermock æ¥æ¨¡æéææ¹æ³\n\nå ä¸º Mockito ä¸è½å¤ mock éææ¹æ³ï¼å æ­¤æä»¬å¯ä»¥ä½¿ç¨ Powermockã\n\nimport java.net.InetAddress;\nimport java.net.UnknownHostException;\n\npublic final class NetworkReader {\n    public static String getLocalHostname() {\n        String hostname = "";\n        try {\n            InetAddress addr = InetAddress.getLocalHost();\n            // Get hostname\n            hostname = addr.getHostName();\n        } catch ( UnknownHostException e ) {\n        }\n        return hostname;\n    }\n}\n\n\næä»¬æ¨¡æäº NetworkReader çä¾èµï¼å¦ä¸ä»£ç æç¤ºï¼\n\nimport org.junit.runner.RunWith;\nimport org.powermock.core.classloader.annotations.PrepareForTest;\n\n@RunWith( PowerMockRunner.class )\n@PrepareForTest( NetworkReader.class )\npublic class MyTest {\n\n// æµè¯ä»£ç \n\n @Test\npublic void testSomething() {\n    mockStatic( NetworkUtil.class );\n    when( NetworkReader.getLocalHostname() ).andReturn( "localhost" );\n\n    // ä¸ NetworkReader åä½çæµè¯\n}\n\n\n\n# ç¨å°è£çæ¹æ³ä»£æ¿ Powermock\n\nææ¶åæä»¬å¯ä»¥å¨éææ¹æ³å¨å´åå«ééæçæ¹æ³æ¥è¾¾å°å Powermock åæ ·çææã\n\nclass FooWraper {\n      void someMethod() {\n           Foo.someStaticMethod()\n       }\n}\n\n\n\n# å¼ç¨åå¼ç³\n\n * å®ç½\n * Github\n * ä½¿ç¨å¼ºå¤§ç Mockito æµè¯æ¡æ¶æ¥æµè¯ä½ çä»£ç ',normalizedContent:'# mockito å¿«éå¥é¨\n\n> mockito æ¯ä¸ä¸ªéå¯¹ java ç mock æ¡æ¶ã\n\n\n# é¢å¤ç¥è¯\n\nå¦æéè¦å¾ä¸å­¦ä¹ ï¼ä½ éè¦åçè§£ junit æ¡æ¶ä¸­çååæµè¯ã\n\nå¦æä½ ä¸çæ junitï¼è¯·ç junit æç¨\n\n\n# ä½¿ç¨ mock å¯¹è±¡æ¥è¿è¡æµè¯\n\n\n# ååæµè¯çç®æ åææ\n\nååæµè¯çæè·¯æ¯å¨ä¸æ¶åä¾èµå³ç³»çæåµä¸æµè¯ä»£ç ï¼éç¦»æ§ï¼ï¼æä»¥æµè¯ä»£ç ä¸å¶ä»ç±»æèç³»ç»çå³ç³»åºè¯¥å°½éè¢«æ¶é¤ãä¸ä¸ªå¯è¡çæ¶é¤æ¹æ³æ¯æ¿æ¢æä¾èµç±»ï¼æµè¯æ¿æ¢ï¼ï¼ä¹å°±æ¯è¯´æä»¬å¯ä»¥ä½¿ç¨æ¿èº«æ¥æ¿æ¢æçæ­£çä¾èµå¯¹è±¡ã\n\n\n# æµè¯ç±»çåç±»\n\n * dummy object åä¸ºåæ°ä¼ éç»æ¹æ³ä½æ¯ç»å¯¹ä¸ä¼è¢«ä½¿ç¨ãè­¬å¦è¯´ï¼è¿ç§æµè¯ç±»åé¨çæ¹æ³ä¸ä¼è¢«è°ç¨ï¼æèæ¯ç¨æ¥å¡«åæä¸ªæ¹æ³çåæ°ã\n * fake æ¯çæ­£æ¥å£ææ½è±¡ç±»çå®ç°ä½ï¼ä½ç»å¯¹è±¡åé¨å®ç°å¾ç®åãè­¬å¦è¯´ï¼å®å­å¨åå­ä¸­èä¸æ¯çæ­£çæ°æ®åºä¸­ãï¼è¯èæ³¨ï¼fake å®ç°äºçæ­£çé»è¾ï¼ä½å®çå­å¨åªæ¯ä¸ºäºæµè¯ï¼èä¸éåäºç¨å¨äº§åä¸­ãï¼\n * stub ç±»æ¯ä¾èµç±»çé¨åæ¹æ³å®ç°ï¼èè¿äºæ¹æ³å¨ä½ æµè¯ç±»åæ¥å£çæ¶åä¼è¢«ç¨å°ï¼ä¹å°±æ¯è¯´ stub ç±»å¨æµè¯ä¸­ä¼è¢«å®ä¾åãstub ç±»ä¼ååºä»»ä½å¤é¨æµè¯çè°ç¨ãstub ç±»ææ¶åè¿ä¼è®°å½è°ç¨çä¸äºä¿¡æ¯ã\n * mock object æ¯æç±»æèæ¥å£çæ¨¡æå®ç°ï¼ä½ å¯ä»¥èªå®ä¹è¿ä¸ªå¯¹è±¡ä¸­æä¸ªæ¹æ³çè¾åºç»æã\n\næµè¯æ¿ä»£ææ¯è½å¤å¨æµè¯ä¸­æ¨¡ææµè¯ç±»ä»¥å¤å¯¹è±¡ãå æ­¤ä½ å¯ä»¥éªè¯æµè¯ç±»æ¯å¦ååºæ­£å¸¸ãè­¬å¦è¯´ï¼ä½ å¯ä»¥éªè¯å¨ mock å¯¹è±¡çæä¸ä¸ªæ¹æ³æ¯å¦è¢«è°ç¨ãè¿å¯ä»¥ç¡®ä¿éç¦»äºå¤é¨ä¾èµçå¹²æ°åªæµè¯æµè¯ç±»ã\n\næä»¬éæ© mock å¯¹è±¡çåå æ¯å ä¸º mock å¯¹è±¡åªéè¦å°éä»£ç çéç½®ã\n\n\n# mock å¯¹è±¡çäº§ç\n\nä½ å¯ä»¥æå¨åå»ºä¸ä¸ª mock å¯¹è±¡æèä½¿ç¨ mock æ¡æ¶æ¥æ¨¡æè¿äºç±»ï¼mock æ¡æ¶åè®¸ä½ å¨è¿è¡æ¶åå»º mock å¯¹è±¡å¹¶ä¸å®ä¹å®çè¡ä¸ºã\n\nä¸ä¸ªå¸åçä¾å­æ¯æ mock å¯¹è±¡æ¨¡æææ°æ®çæä¾èãå¨æ­£å¼ççäº§ç¯å¢ä¸­å®ä¼è¢«å®ç°ç¨æ¥è¿æ¥æ°æ®æºãä½æ¯æä»¬å¨æµè¯çæ¶å mock å¯¹è±¡å°ä¼æ¨¡æææ°æ®æä¾èæ¥ç¡®ä¿æä»¬çæµè¯ç¯å¢å§ç»æ¯ç¸åçã\n\nmock å¯¹è±¡å¯ä»¥è¢«æä¾æ¥è¿è¡æµè¯ãå æ­¤ï¼æä»¬æµè¯çç±»åºè¯¥é¿åä»»ä½å¤é¨æ°æ®çå¼ºä¾èµã\n\néè¿ mock å¯¹è±¡æè mock æ¡æ¶ï¼æä»¬å¯ä»¥æµè¯ä»£ç ä¸­ææçè¡ä¸ºãè­¬å¦è¯´ï¼éªè¯åªææä¸ªå­å¨ mock å¯¹è±¡çæ¹æ³æ¯å¦è¢«è°ç¨äºã\n\n\n# ä½¿ç¨ mockito çæ mock å¯¹è±¡\n\nmockito æ¯ä¸ä¸ªæµè¡ mock æ¡æ¶ï¼å¯ä»¥å junit ç»åèµ·æ¥ä½¿ç¨ãmockito åè®¸ä½ åå»ºåéç½® mock å¯¹è±¡ãä½¿ç¨ mockito å¯ä»¥ææ¾çç®åå¯¹å¤é¨ä¾èµçæµè¯ç±»çå¼åã\n\nä¸è¬ä½¿ç¨ mockito éè¦æ§è¡ä¸é¢ä¸æ­¥\n\n 1. æ¨¡æå¹¶æ¿æ¢æµè¯ä»£ç ä¸­å¤é¨ä¾èµ\n 2. æ§è¡æµè¯ä»£ç \n 3. éªè¯æµè¯ä»£ç æ¯å¦è¢«æ­£ç¡®çæ§è¡ 0\n\n\n# ä¸ºèªå·±çé¡¹ç®æ·»å  mockito ä¾èµ\n\n\n# å¨ gradle æ·»å  mockito ä¾èµ\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ gradle æå»ºï¼å°ä¸é¢ä»£ç å å¥ gradle çæå»ºæä»¶ä¸­ä¸ºèªå·±é¡¹ç®æ·»å  mockito ä¾èµ\n\nrepositories { jcenter() }\ndependencies { testcompile "org.mockito:mockito-core:2.0.57-beta" }\n\n\n\n# å¨ maven æ·»å  mockito ä¾èµ\n\néè¦å¨ maven å£°æä¾èµï¼æ¨å¯ä»¥å¨ http://search.maven.org ç½ç«ä¸­æç´¢ g:"org.mockito", a:"mockito-core" æ¥å¾å°å·ä½çå£°ææ¹å¼ã\n\n\n# å¨ eclipse ide ä½¿ç¨ mockito\n\neclipse ide æ¯æ gradle å maven ä¸¤ç§æå»ºå·¥å·ï¼æä»¥å¨ eclipse ide æ·»å ä¾èµåå³ä½ ä½¿ç¨çæ¯åªä¸ä¸ªæå»ºå·¥å·ã\n\n\n# ä»¥ osgi æè eclipse æä»¶å½¢å¼æ·»å  mockito ä¾èµ\n\nå¨ eclipse rcp åºç¨ä¾èµéå¸¸å¯ä»¥å¨ p2 update ä¸å¾å°ãorbit æ¯ä¸ä¸ªå¾å¥½çç¬¬ä¸æ¹ä»åºï¼æä»¬å¯ä»¥å¨éé¢å¯»æ¾è½å¨ eclipse ä¸ä½¿ç¨çåºç¨åæä»¶ã\n\norbit ä»åºå°åï¼http://download.eclipse.org/tools/orbit/downloads\n\n\n# ä½¿ç¨ mockito api\n\n\n# éæå¼ç¨\n\nå¦æå¨ä»£ç ä¸­éæå¼ç¨äºorg.mockito.mockito.*;ï¼é£ä½ ä½ å°±å¯ä»¥ç´æ¥è°ç¨éææ¹æ³åéæåéèä¸ç¨åå»ºå¯¹è±¡ï¼è­¬å¦ç´æ¥è°ç¨ mock() æ¹æ³ã\n\n\n# ä½¿ç¨ mockito åå»ºåéç½® mock å¯¹è±¡\n\né¤äºä¸é¢æè¯´çä½¿ç¨ mock() éææ¹æ³å¤ï¼mockito è¿æ¯æéè¿ @mock æ³¨è§£çæ¹å¼æ¥åå»º mock å¯¹è±¡ã\n\nå¦æä½ ä½¿ç¨æ³¨è§£ï¼é£ä¹å¿é¡»è¦å®ä¾å mock å¯¹è±¡ãmockito å¨éå°ä½¿ç¨æ³¨è§£çå­æ®µçæ¶åï¼ä¼è°ç¨mockitoannotations.initmocks(this) æ¥åå§åè¯¥ mock å¯¹è±¡ãå¦å¤ä¹å¯ä»¥éè¿ä½¿ç¨@runwith(mockitojunitrunner.class)æ¥è¾¾å°ç¸åçææã\n\néè¿ä¸é¢çä¾å­æä»¬å¯ä»¥äºè§£å°ä½¿ç¨@mock çæ¹æ³åmockitoruleè§åã\n\nimport static org.mockito.mockito.*;\n\npublic class mockitotest  {\n\n        @mock\n        mydatabase databasemock; (1)\n\n        @rule public mockitorule mockitorule = mockitojunit.rule(); (2)\n\n        @test\n        public void testquery()  {\n                classtotest t  = new classtotest(databasemock); (3)\n                boolean check = t.query("* from t"); (4)\n                asserttrue(check); (5)\n                verify(databasemock).query("* from t"); (6)\n        }\n}\n\n\n 1. åè¯ mockito æ¨¡æ databasemock å®ä¾\n 2. mockito éè¿ @mock æ³¨è§£åå»º mock å¯¹è±¡\n 3. ä½¿ç¨å·²ç»åå»ºç mock åå§åè¿ä¸ªç±»\n 4. å¨æµè¯ç¯å¢ä¸ï¼æ§è¡æµè¯ç±»ä¸­çä»£ç \n 5. ä½¿ç¨æ­è¨ç¡®ä¿è°ç¨çæ¹æ³è¿åå¼ä¸º true\n 6. éªè¯ query æ¹æ³æ¯å¦è¢« mydatabase ç mock å¯¹è±¡è°ç¨\n\n\n# éç½® mock\n\nå½æä»¬éè¦éç½®æä¸ªæ¹æ³çè¿åå¼çæ¶åï¼mockito æä¾äºé¾å¼ç api ä¾æä»¬æ¹ä¾¿çè°ç¨\n\nwhen(â¦.).thenreturn(â¦.)å¯ä»¥è¢«ç¨æ¥å®ä¹å½æ¡ä»¶æ»¡è¶³æ¶å½æ°çè¿åå¼ï¼å¦æä½ éè¦å®ä¹å¤ä¸ªè¿åå¼ï¼å¯ä»¥å¤æ¬¡å®ä¹ãå½ä½ å¤æ¬¡è°ç¨å½æ°çæ¶åï¼mockito ä¼æ ¹æ®ä½ å®ä¹çååé¡ºåºæ¥è¿åè¿åå¼ãmocks è¿å¯ä»¥æ ¹æ®ä¼ å¥åæ°çä¸åæ¥å®ä¹ä¸åçè¿åå¼ãè­¬å¦è¯´ä½ çå½æ°å¯ä»¥å°anystring æè anyintä½ä¸ºè¾å¥åæ°ï¼ç¶åå®ä¹å¶ç¹å®çæ¾åå¼ã\n\nimport static org.mockito.mockito.*;\nimport static org.junit.assert.*;\n\n@test\npublic void test1()  {\n        //  åå»º mock\n        myclass test = mockito.mock(myclass.class);\n\n        // èªå®ä¹ getuniqueid() çè¿åå¼\n        when(test.getuniqueid()).thenreturn(43);\n\n        // å¨æµè¯ä¸­ä½¿ç¨mockå¯¹è±¡\n        assertequals(test.getuniqueid(), 43);\n}\n\n// è¿åå¤ä¸ªå¼\n@test\npublic void testmorethanonereturnvalue()  {\n        iterator i= mock(iterator.class);\n        when(i.next()).thenreturn("mockito").thenreturn("rocks");\n        string result=i.next()+" "+i.next();\n        // æ­è¨\n        assertequals("mockito rocks", result);\n}\n\n// å¦ä½æ ¹æ®è¾å¥æ¥è¿åå¼\n@test\npublic void testreturnvaluedependentonmethodparameter()  {\n        comparable c= mock(comparable.class);\n        when(c.compareto("mockito")).thenreturn(1);\n        when(c.compareto("eclipse")).thenreturn(2);\n        // æ­è¨\n        assertequals(1,c.compareto("mockito"));\n}\n\n// å¦ä½è®©è¿åå¼ä¸ä¾èµäºè¾å¥\n@test\npublic void testreturnvalueindependentonmethodparameter()  {\n        comparable c= mock(comparable.class);\n        when(c.compareto(anyint())).thenreturn(-1);\n        // æ­è¨\n        assertequals(-1 ,c.compareto(9));\n}\n\n// æ ¹æ®åæ°ç±»åæ¥è¿åå¼\n@test\npublic void testreturnvalueindependentonmethodparameter()  {\n        comparable c= mock(comparable.class);\n        when(c.compareto(isa(todo.class))).thenreturn(0);\n        // æ­è¨\n        todo todo = new todo(5);\n        assertequals(todo ,c.compareto(new todo(1)));\n}\n\n\nå¯¹äºæ è¿åå¼çå½æ°ï¼æä»¬å¯ä»¥ä½¿ç¨doreturn(â¦).when(â¦).methodcallæ¥è·å¾ç±»ä¼¼çææãä¾å¦æä»¬æ³å¨è°ç¨æäºæ è¿åå¼å½æ°çæ¶åæåºå¼å¸¸ï¼é£ä¹å¯ä»¥ä½¿ç¨dothrow æ¹æ³ãå¦ä¸é¢ä»£ç çæ®µæç¤º\n\nimport static org.mockito.mockito.*;\nimport static org.junit.assert.*;\n\n// ä¸é¢æµè¯ç¨ä¾æè¿°äºå¦ä½ä½¿ç¨dothrow()æ¹æ³\n\n@test(expected=ioexception.class)\npublic void testforioexception() {\n        // åå»ºå¹¶éç½® mock å¯¹è±¡\n        outputstream mockstream = mock(outputstream.class);\n        dothrow(new ioexception()).when(mockstream).close();\n\n        // ä½¿ç¨ mock\n        outputstreamwriter streamwriter= new outputstreamwriter(mockstream);\n        streamwriter.close();\n}\n\n\n\n# éªè¯ mock å¯¹è±¡æ¹æ³æ¯å¦è¢«è°ç¨\n\nmockito ä¼è·è¸ª mock å¯¹è±¡éé¢ææçæ¹æ³ååéãæä»¥æä»¬å¯ä»¥ç¨æ¥éªè¯å½æ°å¨ä¼ å¥ç¹å®åæ°çæ¶åæ¯å¦è¢«è°ç¨ãè¿ç§æ¹å¼çæµè¯ç§°è¡ä¸ºæµè¯ï¼è¡ä¸ºæµè¯å¹¶ä¸ä¼æ£æ¥å½æ°çè¿åå¼ï¼èæ¯æ£æ¥å¨ä¼ å¥æ­£ç¡®åæ°æ¶åå½æ°æ¯å¦è¢«è°ç¨ã\n\nimport static org.mockito.mockito.*;\n\n@test\npublic void testverify()  {\n        // åå»ºå¹¶éç½® mock å¯¹è±¡\n        myclass test = mockito.mock(myclass.class);\n        when(test.getuniqueid()).thenreturn(43);\n\n        // è°ç¨mockå¯¹è±¡éé¢çæ¹æ³å¹¶ä¼ å¥åæ°ä¸º12\n        test.testing(12);\n        test.getuniqueid();\n        test.getuniqueid();\n\n        // æ¥çå¨ä¼ å¥åæ°ä¸º12çæ¶åæ¹æ³æ¯å¦è¢«è°ç¨\n        verify(test).testing(matchers.eq(12));\n\n        // æ¹æ³æ¯å¦è¢«è°ç¨ä¸¤æ¬¡\n        verify(test, times(2)).getuniqueid();\n\n        // å¶ä»ç¨æ¥éªè¯å½æ°æ¯å¦è¢«è°ç¨çæ¹æ³\n        verify(mock, never()).somemethod("never called");\n        verify(mock, atleastonce()).somemethod("called at least once");\n        verify(mock, atleast(2)).somemethod("called at least twice");\n        verify(mock, times(5)).somemethod("called five times");\n        verify(mock, atmost(3)).somemethod("called at most 3 times");\n}\n\n\n\n# ä½¿ç¨ spy å°è£ java å¯¹è±¡\n\n@spy æèspy()æ¹æ³å¯ä»¥è¢«ç¨æ¥å°è£ java å¯¹è±¡ãè¢«å°è£åï¼é¤éç¹æ®å£°æï¼ææ¡© stubï¼ï¼å¦åé½ä¼çæ­£çè°ç¨å¯¹è±¡éé¢çæ¯ä¸ä¸ªæ¹æ³\n\nimport static org.mockito.mockito.*;\n\n// lets mock a linkedlist\nlist list = new linkedlist();\nlist spy = spy(list);\n\n// å¯ç¨ doreturn() æ¥ææ¡©\ndoreturn("foo").when(spy).get(0);\n\n// ä¸é¢ä»£ç ä¸çæ\n// çæ­£çæ¹æ³ä¼è¢«è°ç¨\n// å°ä¼æåº indexoutofboundsexception çå¼å¸¸ï¼å ä¸º list ä¸ºç©º\nwhen(spy.get(0)).thenreturn("foo");\n\n\næ¹æ³verifynomoreinteractions()åè®¸ä½ æ£æ¥æ²¡æå¶ä»çæ¹æ³è¢«è°ç¨äºã\n\n\n# ä½¿ç¨ @injectmocks å¨ mockito ä¸­è¿è¡ä¾èµæ³¨å¥\n\næä»¬ä¹å¯ä»¥ä½¿ç¨@injectmocks æ³¨è§£æ¥åå»ºå¯¹è±¡ï¼å®ä¼æ ¹æ®ç±»åæ¥æ³¨å¥å¯¹è±¡éé¢çæåæ¹æ³ååéãåå®æä»¬æ articlemanager ç±»\n\npublic class articlemanager {\n    private user user;\n    private articledatabase database;\n\n    articlemanager(user user) {\n     this.user = user;\n    }\n\n    void setdatabase(articledatabase database) { }\n}\n\n\nè¿ä¸ªç±»ä¼è¢« mockito æé ï¼èç±»çæåæ¹æ³ååéé½ä¼è¢« mock å¯¹è±¡æä»£æ¿ï¼æ­£å¦ä¸é¢çä»£ç çæ®µæç¤ºï¼\n\n@runwith(mockitojunitrunner.class)\npublic class articlemanagertest  {\n\n       @mock articlecalculator calculator;\n       @mock articledatabase database;\n       @most user user;\n\n       @spy private userprovider userprovider = new consumeruserprovider();\n\n       @injectmocks private articlemanager manager; (1)\n\n       @test public void shoulddosomething() {\n               // åå® articlemanager æä¸ä¸ªå« initialize() çæ¹æ³è¢«è°ç¨äº\n               // ä½¿ç¨ articlelistener æ¥è°ç¨ addlistener æ¹æ³\n               manager.initialize();\n\n               // éªè¯ addlistener æ¹æ³è¢«è°ç¨\n               verify(database).addlistener(any(articlelistener.class));\n       }\n}\n\n\n 1. åå»º articlemanager å®ä¾å¹¶æ³¨å¥ mock å¯¹è±¡\n\næ´å¤çè¯¦æå¯ä»¥æ¥ç http://docs.mockito.googlecode.com/hg/1.9.5/org/mockito/injectmocks.html\n\n\n# ææåæ°\n\nargumentcaptorç±»åè®¸æä»¬å¨ verification æé´è®¿é®æ¹æ³çåæ°ãå¾å°æ¹æ³çåæ°åæä»¬å¯ä»¥ä½¿ç¨å®è¿è¡æµè¯ã\n\nimport static org.hamcrest.matchers.hasitem;\nimport static org.junit.assert.assertthat;\nimport static org.mockito.mockito.mock;\nimport static org.mockito.mockito.verify;\n\nimport java.util.arrays;\nimport java.util.list;\n\nimport org.junit.rule;\nimport org.junit.test;\nimport org.mockito.argumentcaptor;\nimport org.mockito.captor;\nimport org.mockito.junit.mockitojunit;\nimport org.mockito.junit.mockitorule;\n\npublic class mockitotests {\n    @rule\n    public mockitorule rule = mockitojunit.rule();\n\n    @captor\n    private argumentcaptor<list<string>> captor;\n\n    @test\n    public final void shouldcontaincertainlistitem() {\n        list<string> aslist = arrays.aslist("someelement_test", "someelement");\n        final list<string> mockedlist = mock(list.class);\n        mockedlist.addall(aslist);\n\n        verify(mockedlist).addall(captor.capture());\n        final list<string> capturedargument = captor.getvalue();\n        assertthat(capturedargument, hasitem("someelement"));\n    }\n}\n\n\n\n# mockito çéå¶\n\nmockito å½ç¶ä¹æä¸å®çéå¶ãèä¸é¢ä¸ç§æ°æ®ç±»ååä¸è½å¤è¢«æµè¯\n\n * final classes\n * anonymous classes\n * primitive types\n\n\n# å¨ android ä¸­ä½¿ç¨ mockito\n\nå¨ android ä¸­ç gradle æå»ºæä»¶ä¸­å å¥ mockito ä¾èµåå°±å¯ä»¥ç´æ¥ä½¿ç¨ mockito äºãè¥æ³ä½¿ç¨ android instrumented tests çè¯ï¼è¿éè¦æ·»å  dexmaker å dexmaker-mockito ä¾èµå° gradle çæå»ºæä»¶ä¸­ãï¼éè¦ mockito 1.9.5 çæ¬ä»¥ä¸ï¼\n\ndependencies {\n    testcompile \'junit:junit:4.12\'\n    // mockito unit test çä¾èµ\n    testcompile \'org.mockito:mockito-core:1.+\'\n    // mockito android instrumentation tests çä¾èµ\n    androidtestcompile \'org.mockito:mockito-core:1.+\'\n    androidtestcompile "com.google.dexmaker:dexmaker:1.2"\n    androidtestcompile "com.google.dexmaker:dexmaker-mockito:1.2"\n}\n\n\n\n# å®ä¾ï¼ä½¿ç¨ mockito åä¸ä¸ª instrumented unit test\n\n\n# åå»ºä¸ä¸ªæµè¯ç android åºç¨\n\nåå»ºä¸ä¸ªååä¸ºcom.vogella.android.testing.mockito.contextmockç android åºç¨ï¼æ·»å ä¸ä¸ªéææ¹æ³ ï¼æ¹æ³éé¢åå»ºä¸ä¸ªåå«åæ°ç intentï¼å¦ä¸ä»£ç æç¤ºï¼\n\npublic static intent createquery(context context, string query, string value) {\n    // ç®åèµ·è§ï¼éç¨mainactivity\n    intent i = new intent(context, mainactivity.class);\n    i.putextra("query", query);\n    i.putextra("value", value);\n    return i;\n}\n\n\n\n# å¨ app/build.gradle æä»¶ä¸­æ·»å  mockito ä¾èµ\n\ndependencies {\n    // mockito å junit çä¾èµ\n    // instrumentation unit tests on the jvm\n    androidtestcompile \'junit:junit:4.12\'\n    androidtestcompile \'org.mockito:mockito-core:2.0.57-beta\'\n    androidtestcompile \'com.android.support.test:runner:0.3\'\n    androidtestcompile "com.google.dexmaker:dexmaker:1.2"\n    androidtestcompile "com.google.dexmaker:dexmaker-mockito:1.2"\n\n    // mockito å junit çä¾èµ\n    // tests on the jvm\n    testcompile \'junit:junit:4.12\'\n    testcompile \'org.mockito:mockito-core:1.+\'\n\n}\n\n\n\n# åå»ºæµè¯\n\nä½¿ç¨ mockito åå»ºä¸ä¸ªååæµè¯æ¥éªè¯å¨ä¼ éæ­£ç¡® extra data çæåµä¸ï¼intent æ¯å¦è¢«è§¦åã\n\nå æ­¤æä»¬éè¦ä½¿ç¨ mockito æ¥ mock ä¸ä¸ªcontextå¯¹è±¡ï¼å¦ä¸ä»£ç æç¤ºï¼\n\npackage com.vogella.android.testing.mockitocontextmock;\n\nimport android.content.context;\nimport android.content.intent;\nimport android.os.bundle;\n\nimport org.junit.test;\nimport org.junit.runner.runwith;\nimport org.mockito.mockito;\n\nimport static org.junit.assert.assertequals;\nimport static org.junit.assert.assertnotnull;\n\npublic class textintentcreation {\n\n    @test\n    public void testintentshouldbecreated() {\n        context context = mockito.mock(context.class);\n        intent intent = mainactivity.createquery(context, "query", "value");\n        assertnotnull(intent);\n        bundle extras = intent.getextras();\n        assertnotnull(extras);\n        assertequals("query", extras.getstring("query"));\n        assertequals("value", extras.getstring("value"));\n    }\n}\n\n\n\n# å®ä¾ï¼ä½¿ç¨ mockito åå»ºä¸ä¸ª mock å¯¹è±¡\n\n\n# ç®æ \n\nåå»ºä¸ä¸ª apiï¼å®å¯ä»¥è¢« mockito æ¥æ¨¡æå¹¶åä¸äºå·¥ä½\n\n\n# åå»ºä¸ä¸ª twitter api çä¾å­\n\nå®ç° twitterclientç±»ï¼å®åé¨ä½¿ç¨å°äº itweet çå®ç°ãä½æ¯itweetå®ä¾å¾é¾å¾å°ï¼è­¬å¦è¯´ä»éè¦å¯å¨ä¸ä¸ªå¾å¤æçæå¡æ¥å¾å°ã\n\npublic interface itweet {\n\n        string getmessage();\n}\n\n\npublic class twitterclient {\n\n        public void sendtweet(itweet tweet) {\n                string message = tweet.getmessage();\n\n                // send the message to twitter\n        }\n}\n\n\n\n# æ¨¡æ itweet çå®ä¾\n\nä¸ºäºè½å¤ä¸å¯å¨å¤æçæå¡æ¥å¾å° itweetï¼æä»¬å¯ä»¥ä½¿ç¨ mockito æ¥æ¨¡æå¾å°è¯¥å®ä¾ã\n\n@test\npublic void testsendingtweet() {\n        twitterclient twitterclient = new twitterclient();\n\n        itweet itweet = mock(itweet.class);\n\n        when(itweet.getmessage()).thenreturn("using mockito is great");\n\n        twitterclient.sendtweet(itweet);\n}\n\n\nç°å¨ twitterclient å¯ä»¥ä½¿ç¨ itweet æ¥å£çå®ç°ï¼å½è°ç¨ getmessage() æ¹æ³çæ¶åå°ä¼æå° "using mockito is great" ä¿¡æ¯ã\n\n\n# éªè¯æ¹æ³è°ç¨\n\nç¡®ä¿ getmessage() æ¹æ³è³å°è°ç¨ä¸æ¬¡ã\n\n@test\npublic void testsendingtweet() {\n        twitterclient twitterclient = new twitterclient();\n\n        itweet itweet = mock(itweet.class);\n\n        when(itweet.getmessage()).thenreturn("using mockito is great");\n\n        twitterclient.sendtweet(itweet);\n\n        verify(itweet, atleastonce()).getmessage();\n}\n\n\n\n# éªè¯\n\nè¿è¡æµè¯ï¼æ¥çä»£ç æ¯å¦æµè¯éè¿ã\n\n\n# æ¨¡æéææ¹æ³\n\n\n# ä½¿ç¨ powermock æ¥æ¨¡æéææ¹æ³\n\nå ä¸º mockito ä¸è½å¤ mock éææ¹æ³ï¼å æ­¤æä»¬å¯ä»¥ä½¿ç¨ powermockã\n\nimport java.net.inetaddress;\nimport java.net.unknownhostexception;\n\npublic final class networkreader {\n    public static string getlocalhostname() {\n        string hostname = "";\n        try {\n            inetaddress addr = inetaddress.getlocalhost();\n            // get hostname\n            hostname = addr.gethostname();\n        } catch ( unknownhostexception e ) {\n        }\n        return hostname;\n    }\n}\n\n\næä»¬æ¨¡æäº networkreader çä¾èµï¼å¦ä¸ä»£ç æç¤ºï¼\n\nimport org.junit.runner.runwith;\nimport org.powermock.core.classloader.annotations.preparefortest;\n\n@runwith( powermockrunner.class )\n@preparefortest( networkreader.class )\npublic class mytest {\n\n// æµè¯ä»£ç \n\n @test\npublic void testsomething() {\n    mockstatic( networkutil.class );\n    when( networkreader.getlocalhostname() ).andreturn( "localhost" );\n\n    // ä¸ networkreader åä½çæµè¯\n}\n\n\n\n# ç¨å°è£çæ¹æ³ä»£æ¿ powermock\n\nææ¶åæä»¬å¯ä»¥å¨éææ¹æ³å¨å´åå«ééæçæ¹æ³æ¥è¾¾å°å powermock åæ ·çææã\n\nclass foowraper {\n      void somemethod() {\n           foo.somestaticmethod()\n       }\n}\n\n\n\n# å¼ç¨åå¼ç³\n\n * å®ç½\n * github\n * ä½¿ç¨å¼ºå¤§ç mockito æµè¯æ¡æ¶æ¥æµè¯ä½ çä»£ç ',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JMeter å¿«éå¥é¨",frontmatter:{title:"JMeter å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æµè¯"],tags:["Java","æµè¯","JMeter"],abbrlink:"808e762c",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/d99171/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/04.%E6%B5%8B%E8%AF%95/03.Jmeter.html",relativePath:"12.å·¥å·/04.æµè¯/03.Jmeter.md",key:"v-955934dc",path:"/pages/d99171/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:79},{level:3,title:"ç¹æ§",slug:"ç¹æ§",normalizedTitle:"ç¹æ§",charIndex:119},{level:3,title:"å·¥ä½æµ",slug:"å·¥ä½æµ",normalizedTitle:"å·¥ä½æµ",charIndex:361},{level:3,title:"ä¸»è¦åç´ ",slug:"ä¸»è¦åç´ ",normalizedTitle:"ä¸»è¦åç´ ",charIndex:436},{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:1331},{level:3,title:"ç¯å¢è¦æ±",slug:"ç¯å¢è¦æ±",normalizedTitle:"ç¯å¢è¦æ±",charIndex:1338},{level:3,title:"ä¸è½½",slug:"ä¸è½½",normalizedTitle:"ä¸è½½",charIndex:1444},{level:3,title:"å¯å¨",slug:"å¯å¨",normalizedTitle:"å¯å¨",charIndex:1541},{level:2,title:"ä½¿ç¨",slug:"ä½¿ç¨",normalizedTitle:"ä½¿ç¨",charIndex:93},{level:3,title:"åå»ºæµè¯è®¡å",slug:"åå»ºæµè¯è®¡å",normalizedTitle:"åå»ºæµè¯è®¡å",charIndex:1626},{level:4,title:"åå»ºçº¿ç¨ç»",slug:"åå»ºçº¿ç¨ç»",normalizedTitle:"åå»ºçº¿ç¨ç»",charIndex:1713},{level:4,title:"éç½®åä»¶",slug:"éç½®åä»¶",normalizedTitle:"éç½®åä»¶",charIndex:1777},{level:4,title:"æé  HTTP è¯·æ±",slug:"æé -http-è¯·æ±",normalizedTitle:"æé  http è¯·æ±",charIndex:1853},{level:4,title:"æ·»å  HTTP è¯·æ±å¤´",slug:"æ·»å -http-è¯·æ±å¤´",normalizedTitle:"æ·»å  http è¯·æ±å¤´",charIndex:1985},{level:4,title:"æ·»å æ­è¨",slug:"æ·»å æ­è¨",normalizedTitle:"æ·»å æ­è¨",charIndex:2108},{level:4,title:"æ·»å å¯çç»ææ ",slug:"æ·»å å¯çç»ææ ",normalizedTitle:"æ·»å å¯çç»ææ ",charIndex:2191},{level:4,title:"æ·»å æ±æ»æ¥å",slug:"æ·»å æ±æ»æ¥å",normalizedTitle:"æ·»å æ±æ»æ¥å",charIndex:2259},{level:4,title:"ä¿å­æµè¯è®¡å",slug:"ä¿å­æµè¯è®¡å",normalizedTitle:"ä¿å­æµè¯è®¡å",charIndex:1664},{level:3,title:"æ§è¡æµè¯è®¡å",slug:"æ§è¡æµè¯è®¡å",normalizedTitle:"æ§è¡æµè¯è®¡å",charIndex:2333},{level:2,title:"é®é¢",slug:"é®é¢",normalizedTitle:"é®é¢",charIndex:2607},{level:3,title:"å¦ä½è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°",slug:"å¦ä½è¯»åæ¬å°-txt-csv-æä»¶ä½ä¸ºè¯·æ±åæ°",normalizedTitle:"å¦ä½è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°",charIndex:2614},{level:3,title:"å¦ä½æåºåéæ°æ®",slug:"å¦ä½æåºåéæ°æ®",normalizedTitle:"å¦ä½æåºåéæ°æ®",charIndex:2890},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2931}],headersStr:"ç®ä» ç¹æ§ å·¥ä½æµ ä¸»è¦åç´  å®è£ ç¯å¢è¦æ± ä¸è½½ å¯å¨ ä½¿ç¨ åå»ºæµè¯è®¡å åå»ºçº¿ç¨ç» éç½®åä»¶ æé  HTTP è¯·æ± æ·»å  HTTP è¯·æ±å¤´ æ·»å æ­è¨ æ·»å å¯çç»ææ  æ·»å æ±æ»æ¥å ä¿å­æµè¯è®¡å æ§è¡æµè¯è®¡å é®é¢ å¦ä½è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ° å¦ä½æåºåéæ°æ® åèèµæ",content:'# JMeter å¿«éå¥é¨\n\n> Jmeter æ¯ä¸æ¬¾åºäº Java å¼åçåè½åæ§è½æµè¯è½¯ä»¶ã\n> \n> ð æ¬æç¼è¾æ¶çææ°çæ¬ä¸ºï¼5.1.1\n\n\n# ç®ä»\n\nJmeter æ¯ä¸æ¬¾ä½¿ç¨ Java å¼åçåè½åæ§è½æµè¯è½¯ä»¶ã\n\n\n# ç¹æ§\n\nJmeter è½å¤å è½½åæ§è½æµè¯è®¸å¤ä¸åçåºç¨ç¨åº/æå¡å¨/åè®®ç±»åï¼\n\n * ç½ç» - HTTPï¼HTTPS(Javaï¼NodeJSï¼PHPï¼ASP.NET ç­)\n * SOAP / REST Web æå¡\n * FTP æä»¶\n * éè¿ JDBC çæ°æ®åº\n * LDAP\n * éè¿ JMS çé¢åæ¶æ¯çä¸­é´ä»¶(MOM)\n * é®ä»¶-SMTP(S)ï¼POP3(S)å IMAP(S)\n * æ¬æºå½ä»¤æ Shell èæ¬\n * TCP åè®®\n * Java å¯¹è±¡\n\n\n# å·¥ä½æµ\n\nJmeter çå·¥ä½åçæ¯ä»¿çç¨æ·åæå¡å¨åéè¯·æ±ï¼å¹¶æ¶éæå¡å¨åºç­ä¿¡æ¯å¹¶è®¡ç®ç»è®¡ä¿¡æ¯ã\n\nJmeter çå·¥ä½æµå¦ä¸å¾æç¤ºï¼\n\n\n\n\n# ä¸»è¦åç´ \n\nJmeter çä¸»è¦åç´ å¦ä¸ï¼\n\n * æµè¯è®¡å(Test Plan) - å¯ä»¥å°æµè¯è®¡åè§ä¸º JMeter çæµè¯èæ¬ ãæµè¯è®¡åç±æµè¯åç´ ç»æï¼ä¾å¦çº¿ç¨ç»ï¼é»è¾æ§å¶å¨ï¼æ ·æ¬çææ§å¶å¨ï¼çå¬å¨ï¼å®æ¶å¨ï¼æ­è¨åéç½®åç´ ã\n * çº¿ç¨ç»(Thread Group) - çº¿ç¨ç»çä½ç¨æ¯ï¼æ¨¡æå¤§éç¨æ·è´è½½çè¿è¡åºæ¯ã\n   * è®¾ç½®çº¿ç¨æ°\n   * è®¾ç½®å éæ\n   * è®¾ç½®æ§è¡æµè¯çæ¬¡æ°\n * æ§å¶å¨(Controllers) - å¯ä»¥åä¸ºä¸¤å¤§ç±»ï¼\n   * éæ ·å¨ï¼Samplerï¼ - éæ ·å¨çä½ç¨æ¯æ¨¡æç¨æ·å¯¹ç®æ æå¡å¨åéè¯·æ±ã éæ ·å¨æ¯å¿é¡»å°ç»ä»¶æ·»å å°æµè¯è®¡åä¸­çï¼å ä¸ºå®åªè½è®© JMeter ç¥ééè¦å°åªç§ç±»åçè¯·æ±åéå°æå¡å¨ã è¯·æ±å¯ä»¥æ¯ HTTPï¼HTTP(s)ï¼FTPï¼TCPï¼SMTPï¼SOAP ç­ã\n   * é»è¾æ§å¶å¨ - é»è¾æ§å¶å¨çä½ç¨æ¯ï¼æ§å¶å¤ä¸ªè¯·æ±åéçå¾ªç¯æ¬¡æ°åé¡ºåºç­ã\n * çå¬å¨(Listeners) - çå¬å¨çä½ç¨æ¯ï¼æ¶éæµè¯ç»æä¿¡æ¯ãå¦æ¥çç»ææ ãæ±æ»æ¥åç­ã\n * è®¡æ¶å¨(Timers) - è®¡æ¶å¨çä½ç¨æ¯ï¼æ§å¶å¤ä¸ªè¯·æ±åéçæ¶é´é¢æ¬¡ã\n * éç½®åç´ (Configuration Elements) - éç½®åç´ çå·¥ä½ä¸éæ ·å¨çå·¥ä½ç±»ä¼¼ãä½æ¯ï¼å®ä¸åéè¯·æ±ï¼èæ¯æä¾é¢å¤çæ°æ®ç­ï¼å¦ CSVãå½æ°å©æã\n * é¢å¤çå¨åç´ (Pre-Processor Elements) - é¢å¤çå¨åç´ å¨éæ ·å¨ååºè¯·æ±ä¹åæ§è¡ï¼å¦æé¢å¤çå¨éå å°éæ ·å¨åç´ ï¼é£ä¹å®å°å¨è¯¥éæ ·å¨åç´ è¿è¡ä¹åæ§è¡ãé¢å¤çå¨åç´ ç¨äºå¨è¿è¡ä¹ååå¤ç¯å¢ååæ°ã\n * åå¤çå¨åç´ (Post-Processor Elements) - åå¤çå¨åç´ æ¯å¨åééæ ·å¨è¯·æ±ä¹åæ§è¡çåç´ ï¼å¸¸ç¨äºå¤çååºæ°æ®ã\n\n\n\n> ð æç¤ºï¼\n> \n> Jmeter åç´ çæ°éå³ç³»å¤§è´å¦ä¸ï¼\n> \n>  1. èæ¬ä¸­æå¤åªè½æä¸ä¸ªæµè¯è®¡åã\n>  2. æµè¯è®¡åä¸­è³å°è¦æä¸ä¸ªçº¿ç¨ç»ã\n>  3. çº¿ç¨ç»ä¸­è³å°è¦æä¸ä¸ªåæ ·å¨ã\n>  4. çº¿ç¨ç»ä¸­è³å°è¦æä¸ä¸ªçå¬å¨ã\n\n\n# å®è£\n\n\n# ç¯å¢è¦æ±\n\n * å¿è¦çãJmeter åºäº JDK8 å¼åï¼æä»¥å¿é¡»è¿è¡å¨ JDK8 ç¯å¢ã\n   \n   * JDK8\n\n * å¯éçãæäº jar åä¸æ¯ Jmeter æä¾çï¼å¦æéè¦ç¸åºçåè½ï¼éè¦èªè¡ä¸è½½å¹¶ç½®äº lib ç®å½ã\n   \n   * JDBC\n   * JMS\n   * Bouncy Castle\n\n\n# ä¸è½½\n\nè¿å¥ Jmeter å®ç½ä¸è½½å°å éæ©éè¦çæ¬è¿è¡ä¸è½½ã\n\n\n# å¯å¨\n\nè§£å Jmeter åç¼©åï¼è¿å¥ bin ç®å½\n\nUnix ç±»ç³»ç»è¿è¡ jmeter ï¼Windows ç³»ç»è¿è¡ jmeter.bat\n\n\n\n\n# ä½¿ç¨\n\n\n# åå»ºæµè¯è®¡å\n\n> ð æ³¨æï¼\n> \n>  * å¨è¿è¡æ´ä¸ªæµè¯è®¡åä¹åï¼åºä¿å­æµè¯è®¡åã\n> \n>  * JMeter çæµè¯è®¡åä»¥ .jmx æ©å±æä»¶çå½¢å¼ä¿å­ã\n\n# åå»ºçº¿ç¨ç»\n\n * å¨âæµè¯è®¡åâä¸å³é® ãæ·»å ã=>ãçº¿ç¨ï¼ç¨æ·ï¼ã=>ãçº¿ç¨ç»ãã\n\n * è®¾ç½®çº¿ç¨æ°åå¾ªç¯æ¬¡æ°\n\n\n\n# éç½®åä»¶\n\n * å¨æ°å»ºççº¿ç¨ç»ä¸å³é® ãæ·»å ã=>ãéç½®åä»¶ã=>ãHTTP è¯·æ±é»è®¤å¼ãã\n\n * å¡«ååè®®ãæå¡å¨åç§°æ IPãç«¯å£å·\n\n\n\n# æé  HTTP è¯·æ±\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å -ã=>ãåæ ·å¨ã=>ãHTTP è¯·æ±ãã\n\n * å¡«ååè®®ãæå¡å¨åç§°æ IPãç«¯å£å·ï¼å¦æéç½®äº HTTP è¯·æ±é»è®¤å¼å¯ä»¥å¿½ç¥ï¼\n\n * å¡«åæ¹æ³ãè·¯å¾\n\n * å¡«ååæ°ãæ¶æ¯ä½æ°æ®ãæä»¶ä¸ä¼ \n\n\n\n# æ·»å  HTTP è¯·æ±å¤´\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãéç½®åä»¶ã=>ãHTTP ä¿¡æ¯å¤´ç®¡çå¨ã\n * ç±äºæçæµè¯ä¾ä¸­ä¼ è¾çæ°æ®ä¸º json å½¢å¼ï¼æä»¥è®¾ç½®é®å¼å¯¹ Content-Typeï¼application/json\n\n\n\n# æ·»å æ­è¨\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãæ­è¨ã=>ã ååºæ­è¨ ã\n * å¨æçæ¡ä¾ä¸­ï¼ä»¥ HTTP åºç­ç¶æç ä¸º 200 æ¥å¤æ­è¯·æ±æ¯å¦æå\n\n\n\n# æ·»å å¯çç»ææ \n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãçå¬å¨ã=>ãå¯çç»ææ ã\n * ç´æ¥ç¹å»è¿è¡ï¼å°±å¯ä»¥æ¥çæµè¯ç»æ\n\n\n\n# æ·»å æ±æ»æ¥å\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãçå¬å¨ã=>ãæ±æ»æ¥åã\n * ç´æ¥ç¹å»è¿è¡ï¼å°±å¯ä»¥æ¥çæµè¯ç»æ\n\n\n\n# ä¿å­æµè¯è®¡å\n\næ§è¡æµè¯è®¡ååï¼GUI ä¼æç¤ºåä¿å­éç½®ä¸º jmx æä»¶ã\n\n\n# æ§è¡æµè¯è®¡å\n\nå®æ¹å»ºè®®ä¸è¦ç´æ¥ä½¿ç¨ GUI æ¥æ§è¡æµè¯è®¡åï¼è¿ç§æ¨¡å¼æéç¨äºåå»ºæµè¯è®¡åå debugã\n\næ§è¡æµè¯è®¡ååºè¯¥ä½¿ç¨å½ä»¤è¡æ¨¡å¼ï¼è¯­æ³å½¢å¼å¦ä¸ï¼\n\njmeter -n -t [jmx file] -l [results file] -e -o [Path to web report folder]\n\n\næ§è¡æµè¯è®¡ååï¼å¨ -e -o åæ°åæå®ç web æ¥åç®å½ä¸ï¼å¯ä»¥æ¾å°æµè¯æ¥ååå®¹ãå¨æµè§å¨ä¸­æå¼ index.html æä»¶ï¼å¯ä»¥çå°å¦ä¸æ¥åï¼\n\n\n\n\n# é®é¢\n\n\n# å¦ä½è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°\n\nåèï¼Jmeter è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°ï¼å®ç°æ¥å£èªå¨å\n\nï¼1ï¼ä¾æ¬¡ç¹å»ãæ·»å ã=>ãéç½®åä»¶ã=>ãCSV æ°æ®æä»¶è®¾ç½®ã\n\néç½®å¦ä¸æç¤ºï¼\n\n\n\néè¦éç½®è¯´æï¼å¶ä»éç½®æ ¹æ®å®éæåµå¡«ï¼ï¼\n\n * æä»¶åï¼è¾å¥éè¦å¯¼å¥çæ°æ®æä»¶ä½ç½®ã\n * æä»¶ç¼ç ï¼è®¾ä¸º UTF-8ï¼é¿åä¹±ç ã\n * åéåç§°ï¼ä½¿ç¨ , åéè¾å¥åéåè¡¨ãå¦æªå¾ä¸­è®¾ç½®äºä¸¤ä¸ªåé a å b\n\nï¼2ï¼å¨ HTTP è¯·æ±çæ¶æ¯ä½æ°æ®ä¸­éç½®åæ°\n\n[{"a":"${a}","b":"${b}"}]\n\n\n\n# å¦ä½æåºåéæ°æ®\n\nä¾æ¬¡ç¹å»ãæ·»å ã=>ãé»è¾æ§å¶å¨ã=>ãäºå¡æ§å¶å¨ã\n\n\n# åèèµæ\n\n * Jmeter å®ç½\n * Jmeter Github\n * Jmeter æ§è½æµè¯å¥é¨\n * æç¾æç¨ - Jmeter æç¨\n * Jmeter è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°ï¼å®ç°æ¥å£èªå¨å',normalizedContent:'# jmeter å¿«éå¥é¨\n\n> jmeter æ¯ä¸æ¬¾åºäº java å¼åçåè½åæ§è½æµè¯è½¯ä»¶ã\n> \n> ð æ¬æç¼è¾æ¶çææ°çæ¬ä¸ºï¼5.1.1\n\n\n# ç®ä»\n\njmeter æ¯ä¸æ¬¾ä½¿ç¨ java å¼åçåè½åæ§è½æµè¯è½¯ä»¶ã\n\n\n# ç¹æ§\n\njmeter è½å¤å è½½åæ§è½æµè¯è®¸å¤ä¸åçåºç¨ç¨åº/æå¡å¨/åè®®ç±»åï¼\n\n * ç½ç» - httpï¼https(javaï¼nodejsï¼phpï¼asp.net ç­)\n * soap / rest web æå¡\n * ftp æä»¶\n * éè¿ jdbc çæ°æ®åº\n * ldap\n * éè¿ jms çé¢åæ¶æ¯çä¸­é´ä»¶(mom)\n * é®ä»¶-smtp(s)ï¼pop3(s)å imap(s)\n * æ¬æºå½ä»¤æ shell èæ¬\n * tcp åè®®\n * java å¯¹è±¡\n\n\n# å·¥ä½æµ\n\njmeter çå·¥ä½åçæ¯ä»¿çç¨æ·åæå¡å¨åéè¯·æ±ï¼å¹¶æ¶éæå¡å¨åºç­ä¿¡æ¯å¹¶è®¡ç®ç»è®¡ä¿¡æ¯ã\n\njmeter çå·¥ä½æµå¦ä¸å¾æç¤ºï¼\n\n\n\n\n# ä¸»è¦åç´ \n\njmeter çä¸»è¦åç´ å¦ä¸ï¼\n\n * æµè¯è®¡å(test plan) - å¯ä»¥å°æµè¯è®¡åè§ä¸º jmeter çæµè¯èæ¬ ãæµè¯è®¡åç±æµè¯åç´ ç»æï¼ä¾å¦çº¿ç¨ç»ï¼é»è¾æ§å¶å¨ï¼æ ·æ¬çææ§å¶å¨ï¼çå¬å¨ï¼å®æ¶å¨ï¼æ­è¨åéç½®åç´ ã\n * çº¿ç¨ç»(thread group) - çº¿ç¨ç»çä½ç¨æ¯ï¼æ¨¡æå¤§éç¨æ·è´è½½çè¿è¡åºæ¯ã\n   * è®¾ç½®çº¿ç¨æ°\n   * è®¾ç½®å éæ\n   * è®¾ç½®æ§è¡æµè¯çæ¬¡æ°\n * æ§å¶å¨(controllers) - å¯ä»¥åä¸ºä¸¤å¤§ç±»ï¼\n   * éæ ·å¨ï¼samplerï¼ - éæ ·å¨çä½ç¨æ¯æ¨¡æç¨æ·å¯¹ç®æ æå¡å¨åéè¯·æ±ã éæ ·å¨æ¯å¿é¡»å°ç»ä»¶æ·»å å°æµè¯è®¡åä¸­çï¼å ä¸ºå®åªè½è®© jmeter ç¥ééè¦å°åªç§ç±»åçè¯·æ±åéå°æå¡å¨ã è¯·æ±å¯ä»¥æ¯ httpï¼http(s)ï¼ftpï¼tcpï¼smtpï¼soap ç­ã\n   * é»è¾æ§å¶å¨ - é»è¾æ§å¶å¨çä½ç¨æ¯ï¼æ§å¶å¤ä¸ªè¯·æ±åéçå¾ªç¯æ¬¡æ°åé¡ºåºç­ã\n * çå¬å¨(listeners) - çå¬å¨çä½ç¨æ¯ï¼æ¶éæµè¯ç»æä¿¡æ¯ãå¦æ¥çç»ææ ãæ±æ»æ¥åç­ã\n * è®¡æ¶å¨(timers) - è®¡æ¶å¨çä½ç¨æ¯ï¼æ§å¶å¤ä¸ªè¯·æ±åéçæ¶é´é¢æ¬¡ã\n * éç½®åç´ (configuration elements) - éç½®åç´ çå·¥ä½ä¸éæ ·å¨çå·¥ä½ç±»ä¼¼ãä½æ¯ï¼å®ä¸åéè¯·æ±ï¼èæ¯æä¾é¢å¤çæ°æ®ç­ï¼å¦ csvãå½æ°å©æã\n * é¢å¤çå¨åç´ (pre-processor elements) - é¢å¤çå¨åç´ å¨éæ ·å¨ååºè¯·æ±ä¹åæ§è¡ï¼å¦æé¢å¤çå¨éå å°éæ ·å¨åç´ ï¼é£ä¹å®å°å¨è¯¥éæ ·å¨åç´ è¿è¡ä¹åæ§è¡ãé¢å¤çå¨åç´ ç¨äºå¨è¿è¡ä¹ååå¤ç¯å¢ååæ°ã\n * åå¤çå¨åç´ (post-processor elements) - åå¤çå¨åç´ æ¯å¨åééæ ·å¨è¯·æ±ä¹åæ§è¡çåç´ ï¼å¸¸ç¨äºå¤çååºæ°æ®ã\n\n\n\n> ð æç¤ºï¼\n> \n> jmeter åç´ çæ°éå³ç³»å¤§è´å¦ä¸ï¼\n> \n>  1. èæ¬ä¸­æå¤åªè½æä¸ä¸ªæµè¯è®¡åã\n>  2. æµè¯è®¡åä¸­è³å°è¦æä¸ä¸ªçº¿ç¨ç»ã\n>  3. çº¿ç¨ç»ä¸­è³å°è¦æä¸ä¸ªåæ ·å¨ã\n>  4. çº¿ç¨ç»ä¸­è³å°è¦æä¸ä¸ªçå¬å¨ã\n\n\n# å®è£\n\n\n# ç¯å¢è¦æ±\n\n * å¿è¦çãjmeter åºäº jdk8 å¼åï¼æä»¥å¿é¡»è¿è¡å¨ jdk8 ç¯å¢ã\n   \n   * jdk8\n\n * å¯éçãæäº jar åä¸æ¯ jmeter æä¾çï¼å¦æéè¦ç¸åºçåè½ï¼éè¦èªè¡ä¸è½½å¹¶ç½®äº lib ç®å½ã\n   \n   * jdbc\n   * jms\n   * bouncy castle\n\n\n# ä¸è½½\n\nè¿å¥ jmeter å®ç½ä¸è½½å°å éæ©éè¦çæ¬è¿è¡ä¸è½½ã\n\n\n# å¯å¨\n\nè§£å jmeter åç¼©åï¼è¿å¥ bin ç®å½\n\nunix ç±»ç³»ç»è¿è¡ jmeter ï¼windows ç³»ç»è¿è¡ jmeter.bat\n\n\n\n\n# ä½¿ç¨\n\n\n# åå»ºæµè¯è®¡å\n\n> ð æ³¨æï¼\n> \n>  * å¨è¿è¡æ´ä¸ªæµè¯è®¡åä¹åï¼åºä¿å­æµè¯è®¡åã\n> \n>  * jmeter çæµè¯è®¡åä»¥ .jmx æ©å±æä»¶çå½¢å¼ä¿å­ã\n\n# åå»ºçº¿ç¨ç»\n\n * å¨âæµè¯è®¡åâä¸å³é® ãæ·»å ã=>ãçº¿ç¨ï¼ç¨æ·ï¼ã=>ãçº¿ç¨ç»ãã\n\n * è®¾ç½®çº¿ç¨æ°åå¾ªç¯æ¬¡æ°\n\n\n\n# éç½®åä»¶\n\n * å¨æ°å»ºççº¿ç¨ç»ä¸å³é® ãæ·»å ã=>ãéç½®åä»¶ã=>ãhttp è¯·æ±é»è®¤å¼ãã\n\n * å¡«ååè®®ãæå¡å¨åç§°æ ipãç«¯å£å·\n\n\n\n# æé  http è¯·æ±\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å -ã=>ãåæ ·å¨ã=>ãhttp è¯·æ±ãã\n\n * å¡«ååè®®ãæå¡å¨åç§°æ ipãç«¯å£å·ï¼å¦æéç½®äº http è¯·æ±é»è®¤å¼å¯ä»¥å¿½ç¥ï¼\n\n * å¡«åæ¹æ³ãè·¯å¾\n\n * å¡«ååæ°ãæ¶æ¯ä½æ°æ®ãæä»¶ä¸ä¼ \n\n\n\n# æ·»å  http è¯·æ±å¤´\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãéç½®åä»¶ã=>ãhttp ä¿¡æ¯å¤´ç®¡çå¨ã\n * ç±äºæçæµè¯ä¾ä¸­ä¼ è¾çæ°æ®ä¸º json å½¢å¼ï¼æä»¥è®¾ç½®é®å¼å¯¹ content-typeï¼application/json\n\n\n\n# æ·»å æ­è¨\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãæ­è¨ã=>ã ååºæ­è¨ ã\n * å¨æçæ¡ä¾ä¸­ï¼ä»¥ http åºç­ç¶æç ä¸º 200 æ¥å¤æ­è¯·æ±æ¯å¦æå\n\n\n\n# æ·»å å¯çç»ææ \n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãçå¬å¨ã=>ãå¯çç»ææ ã\n * ç´æ¥ç¹å»è¿è¡ï¼å°±å¯ä»¥æ¥çæµè¯ç»æ\n\n\n\n# æ·»å æ±æ»æ¥å\n\n * å¨âçº¿ç¨ç»âä¸å³é® ãæ·»å ã=>ãçå¬å¨ã=>ãæ±æ»æ¥åã\n * ç´æ¥ç¹å»è¿è¡ï¼å°±å¯ä»¥æ¥çæµè¯ç»æ\n\n\n\n# ä¿å­æµè¯è®¡å\n\næ§è¡æµè¯è®¡ååï¼gui ä¼æç¤ºåä¿å­éç½®ä¸º jmx æä»¶ã\n\n\n# æ§è¡æµè¯è®¡å\n\nå®æ¹å»ºè®®ä¸è¦ç´æ¥ä½¿ç¨ gui æ¥æ§è¡æµè¯è®¡åï¼è¿ç§æ¨¡å¼æéç¨äºåå»ºæµè¯è®¡åå debugã\n\næ§è¡æµè¯è®¡ååºè¯¥ä½¿ç¨å½ä»¤è¡æ¨¡å¼ï¼è¯­æ³å½¢å¼å¦ä¸ï¼\n\njmeter -n -t [jmx file] -l [results file] -e -o [path to web report folder]\n\n\næ§è¡æµè¯è®¡ååï¼å¨ -e -o åæ°åæå®ç web æ¥åç®å½ä¸ï¼å¯ä»¥æ¾å°æµè¯æ¥ååå®¹ãå¨æµè§å¨ä¸­æå¼ index.html æä»¶ï¼å¯ä»¥çå°å¦ä¸æ¥åï¼\n\n\n\n\n# é®é¢\n\n\n# å¦ä½è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°\n\nåèï¼jmeter è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°ï¼å®ç°æ¥å£èªå¨å\n\nï¼1ï¼ä¾æ¬¡ç¹å»ãæ·»å ã=>ãéç½®åä»¶ã=>ãcsv æ°æ®æä»¶è®¾ç½®ã\n\néç½®å¦ä¸æç¤ºï¼\n\n\n\néè¦éç½®è¯´æï¼å¶ä»éç½®æ ¹æ®å®éæåµå¡«ï¼ï¼\n\n * æä»¶åï¼è¾å¥éè¦å¯¼å¥çæ°æ®æä»¶ä½ç½®ã\n * æä»¶ç¼ç ï¼è®¾ä¸º utf-8ï¼é¿åä¹±ç ã\n * åéåç§°ï¼ä½¿ç¨ , åéè¾å¥åéåè¡¨ãå¦æªå¾ä¸­è®¾ç½®äºä¸¤ä¸ªåé a å b\n\nï¼2ï¼å¨ http è¯·æ±çæ¶æ¯ä½æ°æ®ä¸­éç½®åæ°\n\n[{"a":"${a}","b":"${b}"}]\n\n\n\n# å¦ä½æåºåéæ°æ®\n\nä¾æ¬¡ç¹å»ãæ·»å ã=>ãé»è¾æ§å¶å¨ã=>ãäºå¡æ§å¶å¨ã\n\n\n# åèèµæ\n\n * jmeter å®ç½\n * jmeter github\n * jmeter æ§è½æµè¯å¥é¨\n * æç¾æç¨ - jmeter æç¨\n * jmeter è¯»åæ¬å° txt/csv æä»¶ä½ä¸ºè¯·æ±åæ°ï¼å®ç°æ¥å£èªå¨å',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JMH å¿«éå¥é¨",frontmatter:{title:"JMH å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·","æµè¯"],tags:["Java","æµè¯","JUnit"],abbrlink:"293b6b64",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/747d3e/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/04.%E6%B5%8B%E8%AF%95/04.JMH.html",relativePath:"12.å·¥å·/04.æµè¯/04.JMH.md",key:"v-63d503f0",path:"/pages/747d3e/",headers:[{level:2,title:"åºåæµè¯ç®ä»",slug:"åºåæµè¯ç®ä»",normalizedTitle:"åºåæµè¯ç®ä»",charIndex:15},{level:3,title:"ä»ä¹æ¯åºåæµè¯",slug:"ä»ä¹æ¯åºåæµè¯",normalizedTitle:"ä»ä¹æ¯åºåæµè¯",charIndex:26},{level:3,title:"ä½æ¶éè¦å¾®åºåæµè¯",slug:"ä½æ¶éè¦å¾®åºåæµè¯",normalizedTitle:"ä½æ¶éè¦å¾®åºåæµè¯",charIndex:351},{level:2,title:"JMH ç®ä»",slug:"jmh-ç®ä»",normalizedTitle:"jmh ç®ä»",charIndex:466},{level:3,title:"ä¸ºä»ä¹éè¦ JMH",slug:"ä¸ºä»ä¹éè¦-jmh",normalizedTitle:"ä¸ºä»ä¹éè¦ jmh",charIndex:699},{level:4,title:"æ­»ç æ¶é¤",slug:"æ­»ç æ¶é¤",normalizedTitle:"æ­»ç æ¶é¤",charIndex:712},{level:4,title:"å¸¸éæå ä¸å¸¸éä¼ æ­",slug:"å¸¸éæå ä¸å¸¸éä¼ æ­",normalizedTitle:"å¸¸éæå ä¸å¸¸éä¼ æ­",charIndex:757},{level:3,title:"JMH çæ³¨æç¹",slug:"jmh-çæ³¨æç¹",normalizedTitle:"jmh çæ³¨æç¹",charIndex:888},{level:3,title:"åºç¨åºæ¯",slug:"åºç¨åºæ¯",normalizedTitle:"åºç¨åºæ¯",charIndex:952},{level:3,title:"JMH æ¦å¿µ",slug:"jmh-æ¦å¿µ",normalizedTitle:"jmh æ¦å¿µ",charIndex:1126},{level:2,title:"JMH å¿«éå¥é¨",slug:"jmh-å¿«éå¥é¨-2",normalizedTitle:"jmh å¿«éå¥é¨",charIndex:2},{level:3,title:"æ·»å  maven ä¾èµ",slug:"æ·»å -maven-ä¾èµ",normalizedTitle:"æ·»å  maven ä¾èµ",charIndex:1452},{level:3,title:"æµè¯ä»£ç ",slug:"æµè¯ä»£ç ",normalizedTitle:"æµè¯ä»£ç ",charIndex:1798},{level:3,title:"æ§è¡ JMH",slug:"æ§è¡-jmh",normalizedTitle:"æ§è¡ jmh",charIndex:2846},{level:4,title:"å½ä»¤è¡",slug:"å½ä»¤è¡",normalizedTitle:"å½ä»¤è¡",charIndex:2856},{level:4,title:"æ§è¡ main æ¹æ³",slug:"æ§è¡-main-æ¹æ³",normalizedTitle:"æ§è¡ main æ¹æ³",charIndex:3246},{level:2,title:"JMH API",slug:"jmh-api",normalizedTitle:"jmh api",charIndex:7822},{level:3,title:"@BenchmarkMode",slug:"benchmarkmode",normalizedTitle:"@benchmarkmode",charIndex:1915},{level:3,title:"@Warmup",slug:"warmup",normalizedTitle:"@warmup",charIndex:1947},{level:3,title:"@Measurement",slug:"measurement",normalizedTitle:"@measurement",charIndex:1971},{level:3,title:"@Threads",slug:"threads",normalizedTitle:"@threads",charIndex:2040},{level:3,title:"@Fork",slug:"fork",normalizedTitle:"@fork",charIndex:2052},{level:3,title:"@OutputTimeUnit",slug:"outputtimeunit",normalizedTitle:"@outputtimeunit",charIndex:2061},{level:3,title:"@Benchmark",slug:"benchmark",normalizedTitle:"@benchmark",charIndex:1915},{level:3,title:"@Param",slug:"param",normalizedTitle:"@param",charIndex:8843},{level:3,title:"@Setup",slug:"setup",normalizedTitle:"@setup",charIndex:8913},{level:3,title:"@TearDown",slug:"teardown",normalizedTitle:"@teardown",charIndex:8974},{level:3,title:"@State",slug:"state",normalizedTitle:"@state",charIndex:9050},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:9352}],headersStr:"åºåæµè¯ç®ä» ä»ä¹æ¯åºåæµè¯ ä½æ¶éè¦å¾®åºåæµè¯ JMH ç®ä» ä¸ºä»ä¹éè¦ JMH æ­»ç æ¶é¤ å¸¸éæå ä¸å¸¸éä¼ æ­ JMH çæ³¨æç¹ åºç¨åºæ¯ JMH æ¦å¿µ JMH å¿«éå¥é¨ æ·»å  maven ä¾èµ æµè¯ä»£ç  æ§è¡ JMH å½ä»¤è¡ æ§è¡ main æ¹æ³ JMH API @BenchmarkMode @Warmup @Measurement @Threads @Fork @OutputTimeUnit @Benchmark @Param @Setup @TearDown @State åèèµæ",content:'# JMH å¿«éå¥é¨\n\n\n# åºåæµè¯ç®ä»\n\n\n# ä»ä¹æ¯åºåæµè¯\n\nåºåæµè¯æ¯æéè¿è®¾è®¡ç§å­¦çæµè¯æ¹æ³ãæµè¯å·¥å·åæµè¯ç³»ç»ï¼å®ç°å¯¹ä¸ç±»æµè¯å¯¹è±¡çæé¡¹æ§è½ææ è¿è¡å®éçåå¯å¯¹æ¯çæµè¯ã\n\nç°ä»£è½¯ä»¶å¸¸å¸¸é½æé«æ§è½ä½ä¸ºç®æ ãé£ä¹ï¼ä½ä¸ºé«æ§è½ï¼æ§è½å°±æ¯å¿«ï¼æ´å¿«åï¼æ¾ç¶ï¼å¦ææ²¡æä¸ä¸ªéåçæ åï¼é¾ä»¥è¡¡éæ§è½çå¥½åã\n\nä¸åçåºåæµè¯å¶å·ä½åå®¹åèå´ä¹å­å¨å¾å¤§çä¸åãå¦ææ¯ä¸ä¸çæ§è½å·¥ç¨å¸ï¼æ´å çæçå¯è½æ¯ç±»ä¼¼ SPEC æä¾çå·¥ä¸æ åçç³»ç»çº§æµè¯ï¼èå¯¹äºå¤§å¤æ° Java å¼åèï¼æ´çæçåæ¯èå´ç¸å¯¹è¾å°ãå³æ³¨ç¹æ´å ç»èçå¾®åºåæµè¯ï¼Micro-Benchmarkï¼ãä½è° Micro Benchmark å¢ï¼ ç®åå°è¯´å°±æ¯å¨ method å±é¢ä¸ç benchmarkï¼ç²¾åº¦å¯ä»¥ç²¾ç¡®å° å¾®ç§çº§ã\n\n\n# ä½æ¶éè¦å¾®åºåæµè¯\n\nå¾®åºåæµè¯å¤§å¤æ¯ API çº§å«çæ§è½æµè¯ã\n\nå¾®åºåæµè¯çéç¨åºæ¯ï¼\n\n * å¦æå¼åå¬å±ç±»åºãä¸­é´ä»¶ï¼ä¼è¢«å¶ä»æ¨¡åç»å¸¸è°ç¨ç APIã\n * å¯¹äºæ§è½ï¼å¦ååºå»¶è¿ãååéæä¸¥æ ¼è¦æ±çæ ¸å¿ APIã\n\n\n# JMH ç®ä»\n\nJMH(å³ Java Microbenchmark Harness)ï¼æ¯ç®åä¸»æµçå¾®åºåæµè¯æ¡æ¶ãJMH æ¯ç± Hotspot JVM å¢éä¸å®¶å¼åçï¼é¤äºæ¯æå®æ´çåºåæµè¯è¿ç¨ï¼åæ¬é¢ç­ãè¿è¡ãç»è®¡åæ¥åç­ï¼è¿æ¯æ Java åå¶ä» JVM è¯­è¨ãæ´éè¦çæ¯ï¼å®éå¯¹ Hotspot JVM æä¾äºåç§ç¹æ§ï¼ä»¥ä¿è¯åºåæµè¯çæ­£ç¡®æ§ï¼æ´ä½åç¡®æ§å¤§å¤§ä¼äºå¶ä»æ¡æ¶ï¼å¹¶ä¸ï¼JMH è¿æä¾äºç¨è¿ä¹ç½ççæ¹å¼è¿è¡ Profiling ç­å·¥ä½çè½åã\n\n\n# ä¸ºä»ä¹éè¦ JMH\n\n# æ­»ç æ¶é¤\n\næè°æ­»ç ï¼æ¯ææ³¨éçä»£ç ï¼ä¸å¯è¾¾çä»£ç åï¼å¯è¾¾ä½ä¸è¢«ä½¿ç¨çä»£ç ç­ç­ ã\n\n# å¸¸éæå ä¸å¸¸éä¼ æ­\n\nå¸¸éæå  (Constant folding) æ¯ä¸ä¸ªå¨ç¼è¯æ¶æç®åå¸¸æ°çä¸ä¸ªè¿ç¨ï¼å¸¸æ°å¨è¡¨ç¤ºå¼ä¸­ä»ä»ä»£è¡¨ä¸ä¸ªç®åçæ°å¼ï¼å°±åæ¯æ´æ° 2ï¼è¥æ¯ä¸ä¸ªåæ°ä»æªè¢«ä¿®æ¹ä¹å¯ä½ä¸ºå¸¸æ°ï¼æèç´æ¥å°ä¸ä¸ªåæ°è¢«æç¡®å°è¢«æ æ³¨ä¸ºå¸¸æ°ï¼ä¾å¦ä¸é¢çæè¿°ï¼\n\n\n# JMH çæ³¨æç¹\n\n * æµè¯åéè¦é¢ç­ã\n * é²æ­¢æ ç¨ä»£ç è¿å¥æµè¯æ¹æ³ä¸­ã\n * å¹¶åæµè¯ã\n * æµè¯ç»æåç°ã\n\n\n# åºç¨åºæ¯\n\n 1. å½ä½ å·²ç»æ¾åºäºç­ç¹å½æ°ï¼èéè¦å¯¹ç­ç¹å½æ°è¿è¡è¿ä¸æ­¥çä¼åæ¶ï¼å°±å¯ä»¥ä½¿ç¨ JMH å¯¹ä¼åçææè¿è¡å®éçåæã\n 2. æ³å®éå°ç¥éæä¸ªå½æ°éè¦æ§è¡å¤é¿æ¶é´ï¼ä»¥åæ§è¡æ¶é´åè¾å¥ n çç¸å³æ§\n 3. ä¸ä¸ªå½æ°æä¸¤ç§ä¸åå®ç°ï¼ä¾å¦ JSON åºåå/ååºååæ Jackson å Gson å®ç°ï¼ï¼ä¸ç¥éåªç§å®ç°æ§è½æ´å¥½\n\n\n# JMH æ¦å¿µ\n\n * Iteration - iteration æ¯ JMH è¿è¡æµè¯çæå°åä½ï¼åå«ä¸ç» invocationsã\n * Invocation - ä¸æ¬¡ benchmark æ¹æ³è°ç¨ã\n * Operation - benchmark æ¹æ³ä¸­ï¼è¢«æµéæä½çæ§è¡ãå¦æè¢«æµè¯çæä½å¨ benchmark æ¹æ³ä¸­å¾ªç¯æ§è¡ï¼å¯ä»¥ä½¿ç¨@OperationsPerInvocationè¡¨æå¾ªç¯æ¬¡æ°ï¼ä½¿æµè¯ç»æä¸ºåæ¬¡ operation çæ§è½ã\n * Warmup - å¨å®éè¿è¡ benchmark ååè¿è¡é¢ç­ãå ä¸ºæä¸ªå½æ°è¢«è°ç¨å¤æ¬¡ä¹åï¼JIT ä¼å¯¹å¶è¿è¡ç¼è¯ï¼éè¿é¢ç­å¯ä»¥ä½¿æµéç»ææ´å æ¥è¿çå®æåµã\n\n\n# JMH å¿«éå¥é¨\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupId>org.openjdk.jmh</groupId>\n    <artifactId>jmh-core</artifactId>\n    <version>${jmh.version}</version>\n</dependency>\n<dependency>\n    <groupId>org.openjdk.jmh</groupId>\n    <artifactId>jmh-generator-annprocess</artifactId>\n    <version>${jmh.version}</version>\n    <scope>provided</scope>\n</dependency>\n\n\n\n# æµè¯ä»£ç \n\nimport org.openjdk.jmh.annotations.*;\nimport org.openjdk.jmh.runner.*;\n\nimport java.util.concurrent.TimeUnit;\n\n@BenchmarkMode(Mode.Throughput)\n@Warmup(iterations = 3)\n@Measurement(iterations = 10, time = 5, timeUnit = TimeUnit.SECONDS)\n@Threads(8)\n@Fork(2)\n@OutputTimeUnit(TimeUnit.MILLISECONDS)\npublic class StringBuilderBenchmark {\n\n    @Benchmark\n    public void testStringAdd() {\n        String a = "";\n        for (int i = 0; i < 10; i++) {\n            a += i;\n        }\n        // System.out.println(a);\n    }\n\n    @Benchmark\n    public void testStringBuilderAdd() {\n        StringBuilder sb = new StringBuilder();\n        for (int i = 0; i < 10; i++) {\n            sb.append(i);\n        }\n        // System.out.println(sb.toString());\n    }\n\n    public static void main(String[] args) throws RunnerException {\n        Options options = new OptionsBuilder()\n            .include(StringBuilderBenchmark.class.getSimpleName())\n            .output("d:/Benchmark.log")\n            .build();\n        new Runner(options).run();\n    }\n\n}\n\n\n\n# æ§è¡ JMH\n\n# å½ä»¤è¡\n\nï¼1ï¼åå§å benchmarking å·¥ç¨\n\n$ mvn archetype:generate \\\n          -DinteractiveMode=false \\\n          -DarchetypeGroupId=org.openjdk.jmh \\\n          -DarchetypeArtifactId=jmh-java-benchmark-archetype \\\n          -DgroupId=org.sample \\\n          -DartifactId=test \\\n          -Dversion=1.0\n\n\nï¼2ï¼æå»º benchmark\n\ncd test/\nmvn clean install\n\n\nï¼3ï¼è¿è¡ benchmark\n\njava -jar target/benchmarks.jar\n\n\n# æ§è¡ main æ¹æ³\n\næ§è¡ main æ¹æ³ï¼èå¿ç­å¾æµè¯ç»æï¼æç»ä¼çæä¸ä¸ªæµè¯æ¥åï¼åå®¹å¤§è´å¦ä¸ï¼\n\n# JMH version: 1.22\n# VM version: JDK 1.8.0_181, Java HotSpot(TM) 64-Bit Server VM, 25.181-b13\n# VM invoker: C:\\Program Files\\Java\\jdk1.8.0_181\\jre\\bin\\java.exe\n# VM options: -javaagent:D:\\Program Files\\JetBrains\\IntelliJ IDEA 2019.2.3\\lib\\idea_rt.jar=58635:D:\\Program Files\\JetBrains\\IntelliJ IDEA 2019.2.3\\bin -Dfile.encoding=UTF-8\n# Warmup: 3 iterations, 10 s each\n# Measurement: 10 iterations, 5 s each\n# Timeout: 10 min per iteration\n# Threads: 8 threads, will synchronize iterations\n# Benchmark mode: Throughput, ops/time\n# Benchmark: io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringAdd\n\n# Run progress: 0.00% complete, ETA 00:05:20\n# Fork: 1 of 2\n# Warmup Iteration   1: 21803.050 ops/ms\n# Warmup Iteration   2: 22501.860 ops/ms\n# Warmup Iteration   3: 20953.944 ops/ms\nIteration   1: 21627.645 ops/ms\nIteration   2: 21215.269 ops/ms\nIteration   3: 20863.282 ops/ms\nIteration   4: 21617.715 ops/ms\nIteration   5: 21695.645 ops/ms\nIteration   6: 21886.784 ops/ms\nIteration   7: 21986.899 ops/ms\nIteration   8: 22389.540 ops/ms\nIteration   9: 22507.313 ops/ms\nIteration  10: 22124.133 ops/ms\n\n# Run progress: 25.00% complete, ETA 00:04:02\n# Fork: 2 of 2\n# Warmup Iteration   1: 22262.108 ops/ms\n# Warmup Iteration   2: 21567.804 ops/ms\n# Warmup Iteration   3: 21787.002 ops/ms\nIteration   1: 21598.970 ops/ms\nIteration   2: 22486.133 ops/ms\nIteration   3: 22157.834 ops/ms\nIteration   4: 22321.827 ops/ms\nIteration   5: 22477.063 ops/ms\nIteration   6: 22154.760 ops/ms\nIteration   7: 21561.095 ops/ms\nIteration   8: 22194.863 ops/ms\nIteration   9: 22493.844 ops/ms\nIteration  10: 22568.078 ops/ms\n\n\nResult "io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringAdd":\n  21996.435 Â±(99.9%) 412.955 ops/ms [Average]\n  (min, avg, max) = (20863.282, 21996.435, 22568.078), stdev = 475.560\n  CI (99.9%): [21583.480, 22409.390] (assumes normal distribution)\n\n\n# JMH version: 1.22\n# VM version: JDK 1.8.0_181, Java HotSpot(TM) 64-Bit Server VM, 25.181-b13\n# VM invoker: C:\\Program Files\\Java\\jdk1.8.0_181\\jre\\bin\\java.exe\n# VM options: -javaagent:D:\\Program Files\\JetBrains\\IntelliJ IDEA 2019.2.3\\lib\\idea_rt.jar=58635:D:\\Program Files\\JetBrains\\IntelliJ IDEA 2019.2.3\\bin -Dfile.encoding=UTF-8\n# Warmup: 3 iterations, 10 s each\n# Measurement: 10 iterations, 5 s each\n# Timeout: 10 min per iteration\n# Threads: 8 threads, will synchronize iterations\n# Benchmark mode: Throughput, ops/time\n# Benchmark: io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringBuilderAdd\n\n# Run progress: 50.00% complete, ETA 00:02:41\n# Fork: 1 of 2\n# Warmup Iteration   1: 241500.886 ops/ms\n# Warmup Iteration   2: 134206.032 ops/ms\n# Warmup Iteration   3: 86907.846 ops/ms\nIteration   1: 86143.339 ops/ms\nIteration   2: 74725.356 ops/ms\nIteration   3: 72316.121 ops/ms\nIteration   4: 77319.716 ops/ms\nIteration   5: 83469.256 ops/ms\nIteration   6: 87712.360 ops/ms\nIteration   7: 79421.899 ops/ms\nIteration   8: 80867.839 ops/ms\nIteration   9: 82619.163 ops/ms\nIteration  10: 87026.928 ops/ms\n\n# Run progress: 75.00% complete, ETA 00:01:20\n# Fork: 2 of 2\n# Warmup Iteration   1: 228342.337 ops/ms\n# Warmup Iteration   2: 124737.248 ops/ms\n# Warmup Iteration   3: 82598.851 ops/ms\nIteration   1: 86877.318 ops/ms\nIteration   2: 89388.624 ops/ms\nIteration   3: 88523.558 ops/ms\nIteration   4: 87547.332 ops/ms\nIteration   5: 88376.087 ops/ms\nIteration   6: 88848.837 ops/ms\nIteration   7: 85998.124 ops/ms\nIteration   8: 86796.998 ops/ms\nIteration   9: 87994.726 ops/ms\nIteration  10: 87784.453 ops/ms\n\n\nResult "io.github.dunwu.javatech.jmh.StringBuilderBenchmark.testStringBuilderAdd":\n  84487.902 Â±(99.9%) 4355.525 ops/ms [Average]\n  (min, avg, max) = (72316.121, 84487.902, 89388.624), stdev = 5015.829\n  CI (99.9%): [80132.377, 88843.427] (assumes normal distribution)\n\n\n# Run complete. Total time: 00:05:23\n\nREMEMBER: The numbers below are just data. To gain reusable insights, you need to follow up on\nwhy the numbers are the way they are. Use profilers (see -prof, -lprof), design factorial\nexperiments, perform baseline and negative tests that provide experimental control, make sure\nthe benchmarking environment is safe on JVM/OS/HW level, ask for reviews from the domain experts.\nDo not assume the numbers tell you what you want them to tell.\n\nBenchmark                                     Mode  Cnt      Score      Error   Units\nStringBuilderBenchmark.testStringAdd         thrpt   20  21996.435 Â±  412.955  ops/ms\nStringBuilderBenchmark.testStringBuilderAdd  thrpt   20  84487.902 Â± 4355.525  ops/ms\n\n\n\n# JMH API\n\nä¸é¢æ¥äºè§£ä¸ä¸ jmh å¸¸ç¨ API\n\n\n# @BenchmarkMode\n\nåºåæµè¯ç±»åãè¿ééæ©çæ¯ Throughput ä¹å°±æ¯ååéãæ ¹æ®æºç ç¹è¿å»ï¼æ¯ç§ç±»ååé¢é½æå¯¹åºçè§£éï¼æ¯è¾å¥½çè§£ï¼ååéä¼å¾å°åä½æ¶é´åå¯ä»¥è¿è¡çæä½æ°ã\n\n * Throughput - æ´ä½ååéï¼ä¾å¦â1 ç§åå¯ä»¥æ§è¡å¤å°æ¬¡è°ç¨âã\n * AverageTime - è°ç¨çå¹³åæ¶é´ï¼ä¾å¦âæ¯æ¬¡è°ç¨å¹³åèæ¶ xxx æ¯«ç§âã\n * SampleTime - éæºåæ ·ï¼æåè¾åºåæ ·ç»æçåå¸ï¼ä¾å¦â99%çè°ç¨å¨ xxx æ¯«ç§ä»¥åï¼99.99%çè°ç¨å¨ xxx æ¯«ç§ä»¥åâ\n * SingleShotTime - ä»¥ä¸æ¨¡å¼é½æ¯é»è®¤ä¸æ¬¡ iteration æ¯ 1sï¼å¯æ SingleShotTime æ¯åªè¿è¡ä¸æ¬¡ãå¾å¾åæ¶æ warmup æ¬¡æ°è®¾ä¸º 0ï¼ç¨äºæµè¯å·å¯å¨æ¶çæ§è½ã\n * All - æææ¨¡å¼\n\n\n# @Warmup\n\nä¸é¢æä»¬æå°äºï¼è¿è¡åºåæµè¯åéè¦è¿è¡é¢ç­ãä¸è¬æä»¬åå æ¬¡è¿è¡ç¨åºæµè¯çæ¶åé½ä¼æ¯è¾æ¢ï¼ æä»¥è¦è®©ç¨åºè¿è¡å è½®é¢ç­ï¼ä¿è¯æµè¯çåç¡®æ§ãå¶ä¸­çåæ° iterations ä¹å°±éå¸¸å¥½çè§£äºï¼å°±æ¯é¢ç­è½®æ°ã\n\nä¸ºä»ä¹éè¦é¢ç­ï¼å ä¸º JVM ç JIT æºå¶çå­å¨ï¼å¦ææä¸ªå½æ°è¢«è°ç¨å¤æ¬¡ä¹åï¼JVM ä¼å°è¯å°å¶ç¼è¯æä¸ºæºå¨ç ä»èæé«æ§è¡éåº¦ãæä»¥ä¸ºäºè®© benchmark çç»ææ´å æ¥è¿çå®æåµå°±éè¦è¿è¡é¢ç­ã\n\n\n# @Measurement\n\nåº¦éï¼å¶å®å°±æ¯ä¸äºåºæ¬çæµè¯åæ°ã\n\n * iterations - è¿è¡æµè¯çè½®æ¬¡\n * time - æ¯è½®è¿è¡çæ¶é¿\n * timeUnit - æ¶é¿åä½\n\né½æ¯ä¸äºåºæ¬çåæ°ï¼å¯ä»¥æ ¹æ®å·ä½æåµè°æ´ãä¸è¬æ¯è¾éçä¸è¥¿å¯ä»¥è¿è¡å¤§éçæµè¯ï¼æ¾å°æå¡å¨ä¸è¿è¡ã\n\n\n# @Threads\n\næ¯ä¸ªè¿ç¨ä¸­çæµè¯çº¿ç¨ï¼è¿ä¸ªéå¸¸å¥½çè§£ï¼æ ¹æ®å·ä½æåµéæ©ï¼ä¸è¬ä¸º cpu ä¹ä»¥ 2ã\n\n\n# @Fork\n\nè¿è¡ fork çæ¬¡æ°ãå¦æ fork æ°æ¯ 2 çè¯ï¼å JMH ä¼ fork åºä¸¤ä¸ªè¿ç¨æ¥è¿è¡æµè¯ã\n\n\n# @OutputTimeUnit\n\nè¿ä¸ªæ¯è¾ç®åäºï¼åºåæµè¯ç»æçæ¶é´ç±»åãä¸è¬éæ©ç§ãæ¯«ç§ãå¾®ç§ã\n\n\n# @Benchmark\n\næ¹æ³çº§æ³¨è§£ï¼è¡¨ç¤ºè¯¥æ¹æ³æ¯éè¦è¿è¡ benchmark çå¯¹è±¡ï¼ç¨æ³å JUnit ç @Test ç±»ä¼¼ã\n\n\n# @Param\n\nå±æ§çº§æ³¨è§£ï¼@Param å¯ä»¥ç¨æ¥æå®æé¡¹åæ°çå¤ç§æåµãç¹å«éåç¨æ¥æµè¯ä¸ä¸ªå½æ°å¨ä¸åçåæ°è¾å¥çæåµä¸çæ§è½ã\n\n\n# @Setup\n\næ¹æ³çº§æ³¨è§£ï¼è¿ä¸ªæ³¨è§£çä½ç¨å°±æ¯æä»¬éè¦å¨æµè¯ä¹åè¿è¡ä¸äºåå¤å·¥ä½ï¼æ¯å¦å¯¹ä¸äºæ°æ®çåå§åä¹ç±»çã\n\n\n# @TearDown\n\næ¹æ³çº§æ³¨è§£ï¼è¿ä¸ªæ³¨è§£çä½ç¨å°±æ¯æä»¬éè¦å¨æµè¯ä¹åè¿è¡ä¸äºç»æå·¥ä½ï¼æ¯å¦å³é­çº¿ç¨æ± ï¼æ°æ®åºè¿æ¥ç­çï¼ä¸»è¦ç¨äºèµæºçåæ¶ç­ã\n\n\n# @State\n\nå½ä½¿ç¨ @Setup åæ°çæ¶åï¼å¿é¡»å¨ç±»ä¸å è¿ä¸ªåæ°ï¼ä¸ç¶ä¼æç¤ºæ æ³è¿è¡ã\n\nState ç¨äºå£°ææä¸ªç±»æ¯ä¸ä¸ªâç¶æâï¼ç¶åæ¥åä¸ä¸ª Scope åæ°ç¨æ¥è¡¨ç¤ºè¯¥ç¶æçå±äº«èå´ã å ä¸ºå¾å¤ benchmark ä¼éè¦ä¸äºè¡¨ç¤ºç¶æçç±»ï¼JMH åè®¸ä½ æè¿äºç±»ä»¥ä¾èµæ³¨å¥çæ¹å¼æ³¨å¥å° benchmark å½æ°éãScope ä¸»è¦åä¸ºä¸ç§ã\n\n * Thread - è¯¥ç¶æä¸ºæ¯ä¸ªçº¿ç¨ç¬äº«ã\n * Group - è¯¥ç¶æä¸ºåä¸ä¸ªç»éé¢ææçº¿ç¨å±äº«ã\n * Benchmark - è¯¥ç¶æå¨ææçº¿ç¨é´å±äº«ã\n\nå³äº State çç¨æ³ï¼å®æ¹ç code sample éææ¯è¾å¥½çä¾å­ã\n\n\n# åèèµæ\n\n * jmh å®æ¹ç¤ºä¾\n * Java å¾®åºåæµè¯æ¡æ¶ JMH\n * JAVA æ¾é â JMH ä¸ 8 ä¸ªæµè¯é·é±',normalizedContent:'# jmh å¿«éå¥é¨\n\n\n# åºåæµè¯ç®ä»\n\n\n# ä»ä¹æ¯åºåæµè¯\n\nåºåæµè¯æ¯æéè¿è®¾è®¡ç§å­¦çæµè¯æ¹æ³ãæµè¯å·¥å·åæµè¯ç³»ç»ï¼å®ç°å¯¹ä¸ç±»æµè¯å¯¹è±¡çæé¡¹æ§è½ææ è¿è¡å®éçåå¯å¯¹æ¯çæµè¯ã\n\nç°ä»£è½¯ä»¶å¸¸å¸¸é½æé«æ§è½ä½ä¸ºç®æ ãé£ä¹ï¼ä½ä¸ºé«æ§è½ï¼æ§è½å°±æ¯å¿«ï¼æ´å¿«åï¼æ¾ç¶ï¼å¦ææ²¡æä¸ä¸ªéåçæ åï¼é¾ä»¥è¡¡éæ§è½çå¥½åã\n\nä¸åçåºåæµè¯å¶å·ä½åå®¹åèå´ä¹å­å¨å¾å¤§çä¸åãå¦ææ¯ä¸ä¸çæ§è½å·¥ç¨å¸ï¼æ´å çæçå¯è½æ¯ç±»ä¼¼ spec æä¾çå·¥ä¸æ åçç³»ç»çº§æµè¯ï¼èå¯¹äºå¤§å¤æ° java å¼åèï¼æ´çæçåæ¯èå´ç¸å¯¹è¾å°ãå³æ³¨ç¹æ´å ç»èçå¾®åºåæµè¯ï¼micro-benchmarkï¼ãä½è° micro benchmark å¢ï¼ ç®åå°è¯´å°±æ¯å¨ method å±é¢ä¸ç benchmarkï¼ç²¾åº¦å¯ä»¥ç²¾ç¡®å° å¾®ç§çº§ã\n\n\n# ä½æ¶éè¦å¾®åºåæµè¯\n\nå¾®åºåæµè¯å¤§å¤æ¯ api çº§å«çæ§è½æµè¯ã\n\nå¾®åºåæµè¯çéç¨åºæ¯ï¼\n\n * å¦æå¼åå¬å±ç±»åºãä¸­é´ä»¶ï¼ä¼è¢«å¶ä»æ¨¡åç»å¸¸è°ç¨ç apiã\n * å¯¹äºæ§è½ï¼å¦ååºå»¶è¿ãååéæä¸¥æ ¼è¦æ±çæ ¸å¿ apiã\n\n\n# jmh ç®ä»\n\njmh(å³ java microbenchmark harness)ï¼æ¯ç®åä¸»æµçå¾®åºåæµè¯æ¡æ¶ãjmh æ¯ç± hotspot jvm å¢éä¸å®¶å¼åçï¼é¤äºæ¯æå®æ´çåºåæµè¯è¿ç¨ï¼åæ¬é¢ç­ãè¿è¡ãç»è®¡åæ¥åç­ï¼è¿æ¯æ java åå¶ä» jvm è¯­è¨ãæ´éè¦çæ¯ï¼å®éå¯¹ hotspot jvm æä¾äºåç§ç¹æ§ï¼ä»¥ä¿è¯åºåæµè¯çæ­£ç¡®æ§ï¼æ´ä½åç¡®æ§å¤§å¤§ä¼äºå¶ä»æ¡æ¶ï¼å¹¶ä¸ï¼jmh è¿æä¾äºç¨è¿ä¹ç½ççæ¹å¼è¿è¡ profiling ç­å·¥ä½çè½åã\n\n\n# ä¸ºä»ä¹éè¦ jmh\n\n# æ­»ç æ¶é¤\n\næè°æ­»ç ï¼æ¯ææ³¨éçä»£ç ï¼ä¸å¯è¾¾çä»£ç åï¼å¯è¾¾ä½ä¸è¢«ä½¿ç¨çä»£ç ç­ç­ ã\n\n# å¸¸éæå ä¸å¸¸éä¼ æ­\n\nå¸¸éæå  (constant folding) æ¯ä¸ä¸ªå¨ç¼è¯æ¶æç®åå¸¸æ°çä¸ä¸ªè¿ç¨ï¼å¸¸æ°å¨è¡¨ç¤ºå¼ä¸­ä»ä»ä»£è¡¨ä¸ä¸ªç®åçæ°å¼ï¼å°±åæ¯æ´æ° 2ï¼è¥æ¯ä¸ä¸ªåæ°ä»æªè¢«ä¿®æ¹ä¹å¯ä½ä¸ºå¸¸æ°ï¼æèç´æ¥å°ä¸ä¸ªåæ°è¢«æç¡®å°è¢«æ æ³¨ä¸ºå¸¸æ°ï¼ä¾å¦ä¸é¢çæè¿°ï¼\n\n\n# jmh çæ³¨æç¹\n\n * æµè¯åéè¦é¢ç­ã\n * é²æ­¢æ ç¨ä»£ç è¿å¥æµè¯æ¹æ³ä¸­ã\n * å¹¶åæµè¯ã\n * æµè¯ç»æåç°ã\n\n\n# åºç¨åºæ¯\n\n 1. å½ä½ å·²ç»æ¾åºäºç­ç¹å½æ°ï¼èéè¦å¯¹ç­ç¹å½æ°è¿è¡è¿ä¸æ­¥çä¼åæ¶ï¼å°±å¯ä»¥ä½¿ç¨ jmh å¯¹ä¼åçææè¿è¡å®éçåæã\n 2. æ³å®éå°ç¥éæä¸ªå½æ°éè¦æ§è¡å¤é¿æ¶é´ï¼ä»¥åæ§è¡æ¶é´åè¾å¥ n çç¸å³æ§\n 3. ä¸ä¸ªå½æ°æä¸¤ç§ä¸åå®ç°ï¼ä¾å¦ json åºåå/ååºååæ jackson å gson å®ç°ï¼ï¼ä¸ç¥éåªç§å®ç°æ§è½æ´å¥½\n\n\n# jmh æ¦å¿µ\n\n * iteration - iteration æ¯ jmh è¿è¡æµè¯çæå°åä½ï¼åå«ä¸ç» invocationsã\n * invocation - ä¸æ¬¡ benchmark æ¹æ³è°ç¨ã\n * operation - benchmark æ¹æ³ä¸­ï¼è¢«æµéæä½çæ§è¡ãå¦æè¢«æµè¯çæä½å¨ benchmark æ¹æ³ä¸­å¾ªç¯æ§è¡ï¼å¯ä»¥ä½¿ç¨@operationsperinvocationè¡¨æå¾ªç¯æ¬¡æ°ï¼ä½¿æµè¯ç»æä¸ºåæ¬¡ operation çæ§è½ã\n * warmup - å¨å®éè¿è¡ benchmark ååè¿è¡é¢ç­ãå ä¸ºæä¸ªå½æ°è¢«è°ç¨å¤æ¬¡ä¹åï¼jit ä¼å¯¹å¶è¿è¡ç¼è¯ï¼éè¿é¢ç­å¯ä»¥ä½¿æµéç»ææ´å æ¥è¿çå®æåµã\n\n\n# jmh å¿«éå¥é¨\n\n\n# æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupid>org.openjdk.jmh</groupid>\n    <artifactid>jmh-core</artifactid>\n    <version>${jmh.version}</version>\n</dependency>\n<dependency>\n    <groupid>org.openjdk.jmh</groupid>\n    <artifactid>jmh-generator-annprocess</artifactid>\n    <version>${jmh.version}</version>\n    <scope>provided</scope>\n</dependency>\n\n\n\n# æµè¯ä»£ç \n\nimport org.openjdk.jmh.annotations.*;\nimport org.openjdk.jmh.runner.*;\n\nimport java.util.concurrent.timeunit;\n\n@benchmarkmode(mode.throughput)\n@warmup(iterations = 3)\n@measurement(iterations = 10, time = 5, timeunit = timeunit.seconds)\n@threads(8)\n@fork(2)\n@outputtimeunit(timeunit.milliseconds)\npublic class stringbuilderbenchmark {\n\n    @benchmark\n    public void teststringadd() {\n        string a = "";\n        for (int i = 0; i < 10; i++) {\n            a += i;\n        }\n        // system.out.println(a);\n    }\n\n    @benchmark\n    public void teststringbuilderadd() {\n        stringbuilder sb = new stringbuilder();\n        for (int i = 0; i < 10; i++) {\n            sb.append(i);\n        }\n        // system.out.println(sb.tostring());\n    }\n\n    public static void main(string[] args) throws runnerexception {\n        options options = new optionsbuilder()\n            .include(stringbuilderbenchmark.class.getsimplename())\n            .output("d:/benchmark.log")\n            .build();\n        new runner(options).run();\n    }\n\n}\n\n\n\n# æ§è¡ jmh\n\n# å½ä»¤è¡\n\nï¼1ï¼åå§å benchmarking å·¥ç¨\n\n$ mvn archetype:generate \\\n          -dinteractivemode=false \\\n          -darchetypegroupid=org.openjdk.jmh \\\n          -darchetypeartifactid=jmh-java-benchmark-archetype \\\n          -dgroupid=org.sample \\\n          -dartifactid=test \\\n          -dversion=1.0\n\n\nï¼2ï¼æå»º benchmark\n\ncd test/\nmvn clean install\n\n\nï¼3ï¼è¿è¡ benchmark\n\njava -jar target/benchmarks.jar\n\n\n# æ§è¡ main æ¹æ³\n\næ§è¡ main æ¹æ³ï¼èå¿ç­å¾æµè¯ç»æï¼æç»ä¼çæä¸ä¸ªæµè¯æ¥åï¼åå®¹å¤§è´å¦ä¸ï¼\n\n# jmh version: 1.22\n# vm version: jdk 1.8.0_181, java hotspot(tm) 64-bit server vm, 25.181-b13\n# vm invoker: c:\\program files\\java\\jdk1.8.0_181\\jre\\bin\\java.exe\n# vm options: -javaagent:d:\\program files\\jetbrains\\intellij idea 2019.2.3\\lib\\idea_rt.jar=58635:d:\\program files\\jetbrains\\intellij idea 2019.2.3\\bin -dfile.encoding=utf-8\n# warmup: 3 iterations, 10 s each\n# measurement: 10 iterations, 5 s each\n# timeout: 10 min per iteration\n# threads: 8 threads, will synchronize iterations\n# benchmark mode: throughput, ops/time\n# benchmark: io.github.dunwu.javatech.jmh.stringbuilderbenchmark.teststringadd\n\n# run progress: 0.00% complete, eta 00:05:20\n# fork: 1 of 2\n# warmup iteration   1: 21803.050 ops/ms\n# warmup iteration   2: 22501.860 ops/ms\n# warmup iteration   3: 20953.944 ops/ms\niteration   1: 21627.645 ops/ms\niteration   2: 21215.269 ops/ms\niteration   3: 20863.282 ops/ms\niteration   4: 21617.715 ops/ms\niteration   5: 21695.645 ops/ms\niteration   6: 21886.784 ops/ms\niteration   7: 21986.899 ops/ms\niteration   8: 22389.540 ops/ms\niteration   9: 22507.313 ops/ms\niteration  10: 22124.133 ops/ms\n\n# run progress: 25.00% complete, eta 00:04:02\n# fork: 2 of 2\n# warmup iteration   1: 22262.108 ops/ms\n# warmup iteration   2: 21567.804 ops/ms\n# warmup iteration   3: 21787.002 ops/ms\niteration   1: 21598.970 ops/ms\niteration   2: 22486.133 ops/ms\niteration   3: 22157.834 ops/ms\niteration   4: 22321.827 ops/ms\niteration   5: 22477.063 ops/ms\niteration   6: 22154.760 ops/ms\niteration   7: 21561.095 ops/ms\niteration   8: 22194.863 ops/ms\niteration   9: 22493.844 ops/ms\niteration  10: 22568.078 ops/ms\n\n\nresult "io.github.dunwu.javatech.jmh.stringbuilderbenchmark.teststringadd":\n  21996.435 Â±(99.9%) 412.955 ops/ms [average]\n  (min, avg, max) = (20863.282, 21996.435, 22568.078), stdev = 475.560\n  ci (99.9%): [21583.480, 22409.390] (assumes normal distribution)\n\n\n# jmh version: 1.22\n# vm version: jdk 1.8.0_181, java hotspot(tm) 64-bit server vm, 25.181-b13\n# vm invoker: c:\\program files\\java\\jdk1.8.0_181\\jre\\bin\\java.exe\n# vm options: -javaagent:d:\\program files\\jetbrains\\intellij idea 2019.2.3\\lib\\idea_rt.jar=58635:d:\\program files\\jetbrains\\intellij idea 2019.2.3\\bin -dfile.encoding=utf-8\n# warmup: 3 iterations, 10 s each\n# measurement: 10 iterations, 5 s each\n# timeout: 10 min per iteration\n# threads: 8 threads, will synchronize iterations\n# benchmark mode: throughput, ops/time\n# benchmark: io.github.dunwu.javatech.jmh.stringbuilderbenchmark.teststringbuilderadd\n\n# run progress: 50.00% complete, eta 00:02:41\n# fork: 1 of 2\n# warmup iteration   1: 241500.886 ops/ms\n# warmup iteration   2: 134206.032 ops/ms\n# warmup iteration   3: 86907.846 ops/ms\niteration   1: 86143.339 ops/ms\niteration   2: 74725.356 ops/ms\niteration   3: 72316.121 ops/ms\niteration   4: 77319.716 ops/ms\niteration   5: 83469.256 ops/ms\niteration   6: 87712.360 ops/ms\niteration   7: 79421.899 ops/ms\niteration   8: 80867.839 ops/ms\niteration   9: 82619.163 ops/ms\niteration  10: 87026.928 ops/ms\n\n# run progress: 75.00% complete, eta 00:01:20\n# fork: 2 of 2\n# warmup iteration   1: 228342.337 ops/ms\n# warmup iteration   2: 124737.248 ops/ms\n# warmup iteration   3: 82598.851 ops/ms\niteration   1: 86877.318 ops/ms\niteration   2: 89388.624 ops/ms\niteration   3: 88523.558 ops/ms\niteration   4: 87547.332 ops/ms\niteration   5: 88376.087 ops/ms\niteration   6: 88848.837 ops/ms\niteration   7: 85998.124 ops/ms\niteration   8: 86796.998 ops/ms\niteration   9: 87994.726 ops/ms\niteration  10: 87784.453 ops/ms\n\n\nresult "io.github.dunwu.javatech.jmh.stringbuilderbenchmark.teststringbuilderadd":\n  84487.902 Â±(99.9%) 4355.525 ops/ms [average]\n  (min, avg, max) = (72316.121, 84487.902, 89388.624), stdev = 5015.829\n  ci (99.9%): [80132.377, 88843.427] (assumes normal distribution)\n\n\n# run complete. total time: 00:05:23\n\nremember: the numbers below are just data. to gain reusable insights, you need to follow up on\nwhy the numbers are the way they are. use profilers (see -prof, -lprof), design factorial\nexperiments, perform baseline and negative tests that provide experimental control, make sure\nthe benchmarking environment is safe on jvm/os/hw level, ask for reviews from the domain experts.\ndo not assume the numbers tell you what you want them to tell.\n\nbenchmark                                     mode  cnt      score      error   units\nstringbuilderbenchmark.teststringadd         thrpt   20  21996.435 Â±  412.955  ops/ms\nstringbuilderbenchmark.teststringbuilderadd  thrpt   20  84487.902 Â± 4355.525  ops/ms\n\n\n\n# jmh api\n\nä¸é¢æ¥äºè§£ä¸ä¸ jmh å¸¸ç¨ api\n\n\n# @benchmarkmode\n\nåºåæµè¯ç±»åãè¿ééæ©çæ¯ throughput ä¹å°±æ¯ååéãæ ¹æ®æºç ç¹è¿å»ï¼æ¯ç§ç±»ååé¢é½æå¯¹åºçè§£éï¼æ¯è¾å¥½çè§£ï¼ååéä¼å¾å°åä½æ¶é´åå¯ä»¥è¿è¡çæä½æ°ã\n\n * throughput - æ´ä½ååéï¼ä¾å¦â1 ç§åå¯ä»¥æ§è¡å¤å°æ¬¡è°ç¨âã\n * averagetime - è°ç¨çå¹³åæ¶é´ï¼ä¾å¦âæ¯æ¬¡è°ç¨å¹³åèæ¶ xxx æ¯«ç§âã\n * sampletime - éæºåæ ·ï¼æåè¾åºåæ ·ç»æçåå¸ï¼ä¾å¦â99%çè°ç¨å¨ xxx æ¯«ç§ä»¥åï¼99.99%çè°ç¨å¨ xxx æ¯«ç§ä»¥åâ\n * singleshottime - ä»¥ä¸æ¨¡å¼é½æ¯é»è®¤ä¸æ¬¡ iteration æ¯ 1sï¼å¯æ singleshottime æ¯åªè¿è¡ä¸æ¬¡ãå¾å¾åæ¶æ warmup æ¬¡æ°è®¾ä¸º 0ï¼ç¨äºæµè¯å·å¯å¨æ¶çæ§è½ã\n * all - æææ¨¡å¼\n\n\n# @warmup\n\nä¸é¢æä»¬æå°äºï¼è¿è¡åºåæµè¯åéè¦è¿è¡é¢ç­ãä¸è¬æä»¬åå æ¬¡è¿è¡ç¨åºæµè¯çæ¶åé½ä¼æ¯è¾æ¢ï¼ æä»¥è¦è®©ç¨åºè¿è¡å è½®é¢ç­ï¼ä¿è¯æµè¯çåç¡®æ§ãå¶ä¸­çåæ° iterations ä¹å°±éå¸¸å¥½çè§£äºï¼å°±æ¯é¢ç­è½®æ°ã\n\nä¸ºä»ä¹éè¦é¢ç­ï¼å ä¸º jvm ç jit æºå¶çå­å¨ï¼å¦ææä¸ªå½æ°è¢«è°ç¨å¤æ¬¡ä¹åï¼jvm ä¼å°è¯å°å¶ç¼è¯æä¸ºæºå¨ç ä»èæé«æ§è¡éåº¦ãæä»¥ä¸ºäºè®© benchmark çç»ææ´å æ¥è¿çå®æåµå°±éè¦è¿è¡é¢ç­ã\n\n\n# @measurement\n\nåº¦éï¼å¶å®å°±æ¯ä¸äºåºæ¬çæµè¯åæ°ã\n\n * iterations - è¿è¡æµè¯çè½®æ¬¡\n * time - æ¯è½®è¿è¡çæ¶é¿\n * timeunit - æ¶é¿åä½\n\né½æ¯ä¸äºåºæ¬çåæ°ï¼å¯ä»¥æ ¹æ®å·ä½æåµè°æ´ãä¸è¬æ¯è¾éçä¸è¥¿å¯ä»¥è¿è¡å¤§éçæµè¯ï¼æ¾å°æå¡å¨ä¸è¿è¡ã\n\n\n# @threads\n\næ¯ä¸ªè¿ç¨ä¸­çæµè¯çº¿ç¨ï¼è¿ä¸ªéå¸¸å¥½çè§£ï¼æ ¹æ®å·ä½æåµéæ©ï¼ä¸è¬ä¸º cpu ä¹ä»¥ 2ã\n\n\n# @fork\n\nè¿è¡ fork çæ¬¡æ°ãå¦æ fork æ°æ¯ 2 çè¯ï¼å jmh ä¼ fork åºä¸¤ä¸ªè¿ç¨æ¥è¿è¡æµè¯ã\n\n\n# @outputtimeunit\n\nè¿ä¸ªæ¯è¾ç®åäºï¼åºåæµè¯ç»æçæ¶é´ç±»åãä¸è¬éæ©ç§ãæ¯«ç§ãå¾®ç§ã\n\n\n# @benchmark\n\næ¹æ³çº§æ³¨è§£ï¼è¡¨ç¤ºè¯¥æ¹æ³æ¯éè¦è¿è¡ benchmark çå¯¹è±¡ï¼ç¨æ³å junit ç @test ç±»ä¼¼ã\n\n\n# @param\n\nå±æ§çº§æ³¨è§£ï¼@param å¯ä»¥ç¨æ¥æå®æé¡¹åæ°çå¤ç§æåµãç¹å«éåç¨æ¥æµè¯ä¸ä¸ªå½æ°å¨ä¸åçåæ°è¾å¥çæåµä¸çæ§è½ã\n\n\n# @setup\n\næ¹æ³çº§æ³¨è§£ï¼è¿ä¸ªæ³¨è§£çä½ç¨å°±æ¯æä»¬éè¦å¨æµè¯ä¹åè¿è¡ä¸äºåå¤å·¥ä½ï¼æ¯å¦å¯¹ä¸äºæ°æ®çåå§åä¹ç±»çã\n\n\n# @teardown\n\næ¹æ³çº§æ³¨è§£ï¼è¿ä¸ªæ³¨è§£çä½ç¨å°±æ¯æä»¬éè¦å¨æµè¯ä¹åè¿è¡ä¸äºç»æå·¥ä½ï¼æ¯å¦å³é­çº¿ç¨æ± ï¼æ°æ®åºè¿æ¥ç­çï¼ä¸»è¦ç¨äºèµæºçåæ¶ç­ã\n\n\n# @state\n\nå½ä½¿ç¨ @setup åæ°çæ¶åï¼å¿é¡»å¨ç±»ä¸å è¿ä¸ªåæ°ï¼ä¸ç¶ä¼æç¤ºæ æ³è¿è¡ã\n\nstate ç¨äºå£°ææä¸ªç±»æ¯ä¸ä¸ªâç¶æâï¼ç¶åæ¥åä¸ä¸ª scope åæ°ç¨æ¥è¡¨ç¤ºè¯¥ç¶æçå±äº«èå´ã å ä¸ºå¾å¤ benchmark ä¼éè¦ä¸äºè¡¨ç¤ºç¶æçç±»ï¼jmh åè®¸ä½ æè¿äºç±»ä»¥ä¾èµæ³¨å¥çæ¹å¼æ³¨å¥å° benchmark å½æ°éãscope ä¸»è¦åä¸ºä¸ç§ã\n\n * thread - è¯¥ç¶æä¸ºæ¯ä¸ªçº¿ç¨ç¬äº«ã\n * group - è¯¥ç¶æä¸ºåä¸ä¸ªç»éé¢ææçº¿ç¨å±äº«ã\n * benchmark - è¯¥ç¶æå¨ææçº¿ç¨é´å±äº«ã\n\nå³äº state çç¨æ³ï¼å®æ¹ç code sample éææ¯è¾å¥½çä¾å­ã\n\n\n# åèèµæ\n\n * jmh å®æ¹ç¤ºä¾\n * java å¾®åºåæµè¯æ¡æ¶ jmh\n * java æ¾é â jmh ä¸ 8 ä¸ªæµè¯é·é±',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"javalib-log",frontmatter:{title:"javalib-log",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","æ¥å¿"],abbrlink:"da18907e",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/337701/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/01.Java%E6%97%A5%E5%BF%97.html",relativePath:"12.å·¥å·/99.å¶ä»/01.Javaæ¥å¿.md",key:"v-f2154a58",path:"/pages/337701/",headers:[{level:2,title:"æ¥å¿æ¡æ¶",slug:"æ¥å¿æ¡æ¶",normalizedTitle:"æ¥å¿æ¡æ¶",charIndex:125},{level:3,title:"java.util.logging (JUL)",slug:"java-util-logging-jul",normalizedTitle:"java.util.logging (jul)",charIndex:134},{level:3,title:"Log4j",slug:"log4j",normalizedTitle:"log4j",charIndex:218},{level:3,title:"Logback",slug:"logback",normalizedTitle:"logback",charIndex:555},{level:3,title:"Log4j2",slug:"log4j2",normalizedTitle:"log4j2",charIndex:902},{level:3,title:"Log4j vs Logback vs Log4j2",slug:"log4j-vs-logback-vs-log4j2",normalizedTitle:"log4j vs logback vs log4j2",charIndex:972},{level:2,title:"æ¥å¿é¨é¢",slug:"æ¥å¿é¨é¢",normalizedTitle:"æ¥å¿é¨é¢",charIndex:1753},{level:3,title:"common-logging",slug:"common-logging",normalizedTitle:"common-logging",charIndex:1826},{level:3,title:"slf4j",slug:"slf4j",normalizedTitle:"slf4j",charIndex:2072},{level:3,title:"common-logging vs slf4j",slug:"common-logging-vs-slf4j",normalizedTitle:"common-logging vs slf4j",charIndex:2376},{level:3,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:2636},{level:2,title:"å®æ½æ¥å¿è§£å³æ¹æ¡",slug:"å®æ½æ¥å¿è§£å³æ¹æ¡",normalizedTitle:"å®æ½æ¥å¿è§£å³æ¹æ¡",charIndex:2704},{level:3,title:"å¼å¥ jar å",slug:"å¼å¥-jar-å",normalizedTitle:"å¼å¥ jar å",charIndex:2736},{level:4,title:"slf4j ç´æ¥ç»å®æ¥å¿ç»ä»¶",slug:"slf4j-ç´æ¥ç»å®æ¥å¿ç»ä»¶",normalizedTitle:"slf4j ç´æ¥ç»å®æ¥å¿ç»ä»¶",charIndex:3130},{level:4,title:"slf4j å¼å®¹é slf4j æ¥å¿ç»ä»¶",slug:"slf4j-å¼å®¹é-slf4j-æ¥å¿ç»ä»¶",normalizedTitle:"slf4j å¼å®¹é slf4j æ¥å¿ç»ä»¶",charIndex:3893},{level:4,title:"spring éæ slf4j",slug:"spring-éæ-slf4j",normalizedTitle:"spring éæ slf4j",charIndex:4662},{level:4,title:"common-logging ç»å®æ¥å¿ç»ä»¶",slug:"common-logging-ç»å®æ¥å¿ç»ä»¶",normalizedTitle:"common-logging ç»å®æ¥å¿ç»ä»¶",charIndex:5203},{level:3,title:"ä½¿ç¨ API",slug:"ä½¿ç¨-api",normalizedTitle:"ä½¿ç¨ api",charIndex:2756},{level:4,title:"slf4j ç¨æ³",slug:"slf4j-ç¨æ³",normalizedTitle:"slf4j ç¨æ³",charIndex:5532},{level:4,title:"common-logging ç¨æ³",slug:"common-logging-ç¨æ³",normalizedTitle:"common-logging ç¨æ³",charIndex:6039},{level:2,title:"log4j2 éç½®",slug:"log4j2-éç½®",normalizedTitle:"log4j2 éç½®",charIndex:6649},{level:2,title:"logback éç½®",slug:"logback-éç½®",normalizedTitle:"logback éç½®",charIndex:8907},{level:3,title:"<configuration>",slug:"configuration",normalizedTitle:"<configuration>",charIndex:8922},{level:3,title:"<appender>",slug:"appender",normalizedTitle:"<appender>",charIndex:8995},{level:4,title:"<file>",slug:"file",normalizedTitle:"<file>",charIndex:9111},{level:4,title:"<filter>",slug:"filter",normalizedTitle:"<filter>",charIndex:9118},{level:4,title:"<layout>",slug:"layout",normalizedTitle:"<layout>",charIndex:9127},{level:4,title:"<encoder>",slug:"encoder",normalizedTitle:"<encoder>",charIndex:9136},{level:3,title:"<logger>",slug:"logger",normalizedTitle:"<logger>",charIndex:9006},{level:4,title:"<appender-ref>",slug:"appender-ref",normalizedTitle:"<appender-ref>",charIndex:9614},{level:3,title:"<root>",slug:"root",normalizedTitle:"<root>",charIndex:9015},{level:3,title:"å®æ´ç logback.xml åèç¤ºä¾",slug:"å®æ´ç-logback-xml-åèç¤ºä¾",normalizedTitle:"å®æ´ç logback.xml åèç¤ºä¾",charIndex:9815},{level:2,title:"log4j éç½®",slug:"log4j-éç½®",normalizedTitle:"log4j éç½®",charIndex:16371},{level:3,title:"å®æ´ç log4j.xml åèç¤ºä¾",slug:"å®æ´ç-log4j-xml-åèç¤ºä¾",normalizedTitle:"å®æ´ç log4j.xml åèç¤ºä¾",charIndex:16384},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:9831}],headersStr:"æ¥å¿æ¡æ¶ java.util.logging (JUL) Log4j Logback Log4j2 Log4j vs Logback vs Log4j2 æ¥å¿é¨é¢ common-logging slf4j common-logging vs slf4j æ»ç» å®æ½æ¥å¿è§£å³æ¹æ¡ å¼å¥ jar å slf4j ç´æ¥ç»å®æ¥å¿ç»ä»¶ slf4j å¼å®¹é slf4j æ¥å¿ç»ä»¶ spring éæ slf4j common-logging ç»å®æ¥å¿ç»ä»¶ ä½¿ç¨ API slf4j ç¨æ³ common-logging ç¨æ³ log4j2 éç½® logback éç½® <configuration> <appender> <file> <filter> <layout> <encoder> <logger> <appender-ref> <root> å®æ´ç logback.xml åèç¤ºä¾ log4j éç½® å®æ´ç log4j.xml åèç¤ºä¾ åè",content:'# ç»è¯´ Java ä¸»æµæ¥å¿å·¥å·åº\n\n> å¨é¡¹ç®å¼åä¸­ï¼ä¸ºäºè·è¸ªä»£ç çè¿è¡æåµï¼å¸¸å¸¸è¦ä½¿ç¨æ¥å¿æ¥è®°å½ä¿¡æ¯ã\n> \n> å¨ Java ä¸çï¼æå¾å¤çæ¥å¿å·¥å·åºæ¥å®ç°æ¥å¿åè½ï¼é¿åäºæä»¬éå¤é è½®å­ã\n> \n> æä»¬åæ¥éä¸äºè§£ä¸ä¸ä¸»æµæ¥å¿å·¥å·ã\n\n\n# æ¥å¿æ¡æ¶\n\n\n# java.util.logging (JUL)\n\nJDK1.4 å¼å§ï¼éè¿ java.util.logging æä¾æ¥å¿åè½ã\n\nå®è½æ»¡è¶³åºæ¬çæ¥å¿éè¦ï¼ä½æ¯åè½æ²¡æ Log4j å¼ºå¤§ï¼èä¸ä½¿ç¨èå´ä¹æ²¡æ Log4j å¹¿æ³ã\n\n\n# Log4j\n\nLog4j æ¯ apache çä¸ä¸ªå¼æºé¡¹ç®ï¼åå§äºº Ceki Gulcuã\n\nLog4j åºè¯¥è¯´æ¯ Java é¢åèµæ ¼æèï¼åºç¨æå¹¿çæ¥å¿å·¥å·ãä»è¯çä¹æ¥å°ç°å¨ä¸ç´å¹¿åä¸çæ¬¢è¿ã\n\nLog4j æ¯é«åº¦å¯éç½®çï¼å¹¶å¯éè¿å¨è¿è¡æ¶çå¤é¨æä»¶éç½®ãå®æ ¹æ®è®°å½çä¼åçº§å«ï¼å¹¶æä¾æºå¶ï¼ä»¥æç¤ºè®°å½ä¿¡æ¯å°è®¸å¤çç®çå°ï¼è¯¸å¦ï¼æ°æ®åºï¼æä»¶ï¼æ§å¶å°ï¼UNIX ç³»ç»æ¥å¿ç­ã\n\nLog4j ä¸­æä¸ä¸ªä¸»è¦ç»æé¨åï¼\n\n * loggers - è´è´£æè·è®°å½ä¿¡æ¯ã\n * appenders - è´è´£åå¸æ¥å¿ä¿¡æ¯ï¼ä»¥ä¸åçé¦éç®çå°ã\n * layouts - è´è´£æ ¼å¼åä¸åé£æ ¼çæ¥å¿ä¿¡æ¯ã\n\nå®ç½å°å\n\n\n# Logback\n\nLogback æ¯ç± log4j åå§äºº Ceki Gulcu è®¾è®¡çåä¸ä¸ªå¼æºæ¥è®°ç»ä»¶ï¼ç®æ æ¯æ¿ä»£ log4jã\n\nlogback å½ååæä¸ä¸ªæ¨¡åï¼logback-coreãlogback-classic å logback-accessã\n\n * logback-core - æ¯å¶å®ä¸¤ä¸ªæ¨¡åçåºç¡æ¨¡åã\n * logback-classic - æ¯ log4j çä¸ä¸ª æ¹è¯çæ¬ãæ­¤å¤ logback-classic å®æ´å®ç° SLF4J API ä½¿ä½ å¯ä»¥å¾æ¹ä¾¿å°æ´æ¢æå¶å®æ¥è®°ç³»ç»å¦ log4j æ JDK14 Loggingã\n * logback-access - è®¿é®æ¨¡åä¸ Servlet å®¹å¨éææä¾éè¿ Http æ¥è®¿é®æ¥è®°çåè½ã\n\nå®ç½å°å\n\n\n# Log4j2\n\nå®ç½å°å\n\næç§å®æ¹çè¯´æ³ï¼Log4j2 æ¯ Log4j å Logback çæ¿ä»£ã\n\nLog4j2 æ¶æï¼\n\n\n\n\n# Log4j vs Logback vs Log4j2\n\næç§å®æ¹çè¯´æ³ï¼Log4j2 å¤§å¤§ä¼äº Log4j å Logbackã\n\né£ä¹ï¼Log4j2 ç¸æ¯äºåé®ä¸ç Log4j å Logbackï¼å®å·æåªäºä¼å¿å¢ï¼\n\n 1.  Log4j2 æ¨å¨ç¨ä½å®¡è®¡æ¥å¿è®°å½æ¡æ¶ã Log4j 1.x å Logback é½ä¼å¨éæ°éç½®æ¶ä¸¢å¤±äºä»¶ã Log4j 2 ä¸ä¼ãå¨ Logback ä¸­ï¼Appender ä¸­çå¼å¸¸æ°¸è¿ä¸ä¼å¯¹åºç¨ç¨åºå¯è§ãå¨ Log4j ä¸­ï¼å¯ä»¥å° Appender éç½®ä¸ºåè®¸å¼å¸¸æ¸éå°åºç¨ç¨åºã\n 2.  Log4j2 å¨å¤çº¿ç¨åºæ¯ä¸­ï¼å¼æ­¥ Loggers çååéæ¯ Log4j 1.x å Logback é« 10 åï¼å»¶è¿ä½å ä¸ªæ°éçº§ã\n 3.  Log4j2 å¯¹äºç¬ç«åºç¨ç¨åºæ¯æ åå¾çï¼å¯¹äºç¨³å®ç¶ææ¥å¿è®°å½æé´ç Web åºç¨ç¨åºæ¥è¯´æ¯ä½åå¾ãè¿åå°äºåå¾æ¶éå¨çååï¼å¹¶ä¸å¯ä»¥æä¾æ´å¥½çååºæ¶é´æ§è½ã\n 4.  Log4j2 ä½¿ç¨æä»¶ç³»ç»ï¼éè¿æ·»å æ°ç AppenderãFilterãLayoutãLookup å Pattern Converterï¼å¯ä»¥éå¸¸è½»æ¾å°æ©å±æ¡æ¶ï¼èæ éå¯¹ Log4j è¿è¡ä»»ä½æ´æ¹ã\n 5.  ç±äºæä»¶ç³»ç»éç½®æ´ç®åãéç½®ä¸­çæ¡ç®ä¸éè¦æå®ç±»åã\n 6.  æ¯æèªå®ä¹æ¥å¿ç­çº§ã\n 7.  æ¯æ lambda è¡¨è¾¾å¼ã\n 8.  æ¯ææ¶æ¯å¯¹è±¡ã\n 9.  Log4j å Logback ç Layout è¿åçæ¯å­ç¬¦ä¸²ï¼è Log4j2 è¿åçæ¯äºè¿å¶æ°ç»ï¼è¿ä½¿å¾å®è½è¢«åç§ Appender ä½¿ç¨ã\n 10. Syslog Appender æ¯æ TCP å UDP å¹¶ä¸æ¯æ BSD ç³»ç»æ¥å¿ã\n 11. Log4j2 å©ç¨ Java5 å¹¶åç¹æ§ï¼å°½éå°ç²åº¦çä½¿ç¨éï¼åå°éçå¼éã\n\n\n# æ¥å¿é¨é¢\n\nä½è°æ¥å¿é¨é¢ï¼\n\næ¥å¿é¨é¢æ¯å¯¹ä¸åæ¥å¿æ¡æ¶æä¾çä¸ä¸ª API å°è£ï¼å¯ä»¥å¨é¨ç½²çæ¶åä¸ä¿®æ¹ä»»ä½éç½®å³å¯æ¥å¥ä¸ç§æ¥å¿å®ç°æ¹æ¡ã\n\n\n# common-logging\n\ncommon-logging æ¯ apache çä¸ä¸ªå¼æºé¡¹ç®ãä¹ç§°Jakarta Commons Loggingï¼ç¼©å JCLã\n\ncommon-logging çåè½æ¯æä¾æ¥å¿åè½ç API æ¥å£ï¼æ¬èº«å¹¶ä¸æä¾æ¥å¿çå·ä½å®ç°ï¼å½ç¶ï¼common-logging åé¨æä¸ä¸ª Simple logger çç®åå®ç°ï¼ä½æ¯åè½å¾å¼±ï¼ç´æ¥å¿½ç¥ï¼ï¼èæ¯å¨è¿è¡æ¶å¨æçç»å®æ¥å¿å®ç°ç»ä»¶æ¥å·¥ä½ï¼å¦ log4jãjava.util.logginï¼ã\n\nå®ç½å°å\n\n\n# slf4j\n\nå¨ç§°ä¸º Simple Logging Facade for Javaï¼å³ java ç®åæ¥å¿é¨é¢ã\n\nä»ä¹ï¼ä½èåæ¯ Ceki Gulcuï¼è¿ä½å¤§ç¥åäº Log4jãLogback å slf4jï¼ä¸æ³¨æ¥å¿ç»ä»¶å¼åäºç¾å¹´ï¼ä¸ç´åªè½è¶è¶èªå·±ã\n\nç±»ä¼¼äº Common-Loggingï¼slf4j æ¯å¯¹ä¸åæ¥å¿æ¡æ¶æä¾çä¸ä¸ª API å°è£ï¼å¯ä»¥å¨é¨ç½²çæ¶åä¸ä¿®æ¹ä»»ä½éç½®å³å¯æ¥å¥ä¸ç§æ¥å¿å®ç°æ¹æ¡ãä½æ¯ï¼slf4j å¨ç¼è¯æ¶éæç»å®çæ­£ç Log åºãä½¿ç¨ SLF4J æ¶ï¼å¦æä½ éè¦ä½¿ç¨æä¸ç§æ¥å¿å®ç°ï¼é£ä¹ä½ å¿é¡»éæ©æ­£ç¡®ç SLF4J ç jar åçéåï¼åç§æ¡¥æ¥åï¼ã\n\nå®ç½å°å\n\n\n\n\n# common-logging vs slf4j\n\nslf4j åºç±»ä¼¼äº Apache Common-Loggingãä½æ¯ï¼ä»å¨ç¼è¯æ¶éæç»å®çæ­£çæ¥å¿åºãè¿ç¹ä¼¼ä¹å¾éº»ç¦ï¼å¶å®ä¹ä¸è¿æ¯å¯¼å¥æ¡¥æ¥ jar åèå·²ã\n\nslf4j ä¸å¤§äº®ç¹æ¯æä¾äºæ´æ¹ä¾¿çæ¥å¿è®°å½æ¹å¼ï¼\n\nä¸éè¦ä½¿ç¨logger.isDebugEnabled()æ¥è§£å³æ¥å¿å ä¸ºå­ç¬¦æ¼æ¥äº§ççæ§è½é®é¢ãslf4j çæ¹å¼æ¯ä½¿ç¨{}ä½ä¸ºå­ç¬¦ä¸²æ¿æ¢ç¬¦ï¼å½¢å¼å¦ä¸ï¼\n\nlogger.debug("id: {}, name: {} ", id, name);\n\n\n\n# æ»ç»\n\nç»¼ä¸æè¿°ï¼ä½¿ç¨ slf4j + Logback å¯è°æ¯ç®åæçæ³çæ¥å¿è§£å³æ¹æ¡äºã\n\næ¥ä¸æ¥ï¼å°±æ¯å¦ä½å¨é¡¹ç®ä¸­å®æ½äºã\n\n\n# å®æ½æ¥å¿è§£å³æ¹æ¡\n\nä½¿ç¨æ¥å¿è§£å³æ¹æ¡åºæ¬å¯åä¸ºä¸æ­¥ï¼\n\n 1. å¼å¥ jar å\n 2. éç½®\n 3. ä½¿ç¨ API\n\nå¸¸è§çåç§æ¥å¿è§£å³æ¹æ¡çç¬¬ 2 æ­¥åç¬¬ 3 æ­¥åºæ¬ä¸æ ·ï¼å®æ½ä¸çå·®å«ä¸»è¦å¨ç¬¬ 1 æ­¥ï¼ä¹å°±æ¯ä½¿ç¨ä¸åçåºã\n\n\n# å¼å¥ jar å\n\nè¿éé¦éæ¨èä½¿ç¨ slf4j + logback çç»åã\n\nå¦æä½ ä¹ æ¯äº common-loggingï¼å¯ä»¥éæ© common-logging+log4jã\n\nå¼ºçå»ºè®®ä¸è¦ç´æ¥ä½¿ç¨æ¥å¿å®ç°ç»ä»¶(logbackãlog4jãjava.util.logging)ï¼çç±åé¢ä¹è¯´è¿ï¼å°±æ¯æ æ³çµæ´»æ¿æ¢æ¥å¿åºã\n\nè¿æä¸ç§æåµï¼ä½ çèé¡¹ç®ä½¿ç¨äº common-loggingï¼ææ¯ç´æ¥ä½¿ç¨æ¥å¿å®ç°ç»ä»¶ãå¦æä¿®æ¹èçä»£ç ï¼å·¥ä½éå¤ªå¤§ï¼éè¦å¼å®¹å¤çãå¨ä¸æï¼é½å°çå°åç§åºå¯¹æ¹æ³ã\n\næ³¨ï¼æ®ææç¥ï¼å½åä»æ²¡ææ¹æ³å¯ä»¥å° slf4j æ¡¥æ¥å° common-loggingãå¦ææå­¤éå¯¡é»äºï¼è¯·ä¸åèµæã\n\n# slf4j ç´æ¥ç»å®æ¥å¿ç»ä»¶\n\nslf4j + logback\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\nlogback-classic-1.0.13.jar ä¼èªå¨å° slf4j-api-1.7.21.jar å logback-core-1.0.13.jar ä¹æ·»å å°ä½ çé¡¹ç®ä¸­ã\n\n<dependency>\n  <groupId>ch.qos.logback</groupId>\n  <artifactId>logback-classic</artifactId>\n  <version>1.0.13</version>\n</dependency>\n\n\nslf4j + log4j\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\nslf4j-log4j12-1.7.21.jar ä¼èªå¨å° slf4j-api-1.7.21.jar å log4j-1.2.17.jar ä¹æ·»å å°ä½ çé¡¹ç®ä¸­ã\n\n<dependency>\n  <groupId>org.slf4j</groupId>\n  <artifactId>slf4j-log4j12</artifactId>\n  <version>1.7.21</version>\n</dependency>\n\n\nslf4j + java.util.logging\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\nslf4j-jdk14-1.7.21.jar ä¼èªå¨å° slf4j-api-1.7.21.jar ä¹æ·»å å°ä½ çé¡¹ç®ä¸­ã\n\n<dependency>\n  <groupId>org.slf4j</groupId>\n  <artifactId>slf4j-jdk14</artifactId>\n  <version>1.7.21</version>\n</dependency>\n\n\n# slf4j å¼å®¹é slf4j æ¥å¿ç»ä»¶\n\nå¨ä»ç»è§£å³æ¹æ¡åï¼åæä¸ä¸ªæ¦å¿µââæ¡¥æ¥\n\nä»ä¹æ¯æ¡¥æ¥å¢\n\nåå¦ä½ æ­£å¨å¼ååºç¨ç¨åºæè°ç¨çç»ä»¶å½ä¸­å·²ç»ä½¿ç¨äº common-loggingï¼è¿æ¶ä½ éè¦ jcl-over-slf4j.jar ææ¥å¿ä¿¡æ¯è¾åºéå®åå° slf4j-apiï¼slf4j-api åå»è°ç¨ slf4j å®éä¾èµçæ¥å¿ç»ä»¶ãè¿ä¸ªè¿ç¨ç§°ä¸ºæ¡¥æ¥ãä¸å¾æ¯å®æ¹ç slf4j æ¡¥æ¥ç­ç¥å¾ï¼\n\n\n\nä»å¾ä¸­åºè¯¥å¯ä»¥çåºï¼æ è®ºä½ çèé¡¹ç®ä¸­ä½¿ç¨çæ¯ common-logging ææ¯ç´æ¥ä½¿ç¨ log4jãjava.util.loggingï¼é½å¯ä»¥ä½¿ç¨å¯¹åºçæ¡¥æ¥ jar åæ¥è§£å³å¼å®¹é®é¢ã\n\nslf4j å¼å®¹ common-logging\n\n<dependency>\n  <groupId>org.slf4j</groupId>\n  <artifactId>jcl-over-slf4j</artifactId>\n  <version>1.7.12</version>\n</dependency>\n\n\nslf4j å¼å®¹ log4j\n\n<dependency>\n    <groupId>org.slf4j</groupId>\n    <artifactId>log4j-over-slf4j</artifactId>\n    <version>1.7.12</version>\n</dependency>\n\n\nslf4j å¼å®¹ java.util.logging\n\n<dependency>\n    <groupId>org.slf4j</groupId>\n    <artifactId>jul-to-slf4j</artifactId>\n    <version>1.7.12</version>\n</dependency>\n\n\n# spring éæ slf4j\n\nå java web å¼åï¼åºæ¬ç¦»ä¸å¼ spring æ¡æ¶ãå¾éæ¾ï¼spring ä½¿ç¨çæ¥å¿è§£å³æ¹æ¡æ¯ common-logging + log4jã\n\næä»¥ï¼ä½ éè¦ä¸ä¸ªæ¡¥æ¥ jar åï¼logback-ext-springã\n\n<dependency>\n  <groupId>ch.qos.logback</groupId>\n  <artifactId>logback-classic</artifactId>\n  <version>1.1.3</version>\n</dependency>\n<dependency>\n  <groupId>org.logback-extensions</groupId>\n  <artifactId>logback-ext-spring</artifactId>\n  <version>0.1.2</version>\n</dependency>\n<dependency>\n  <groupId>org.slf4j</groupId>\n  <artifactId>jcl-over-slf4j</artifactId>\n  <version>1.7.12</version>\n</dependency>\n\n\n# common-logging ç»å®æ¥å¿ç»ä»¶\n\ncommon-logging + log4j\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\n<dependency>\n  <groupId>commons-logging</groupId>\n  <artifactId>commons-logging</artifactId>\n  <version>1.2</version>\n</dependency>\n<dependency>\n  <groupId>log4j</groupId>\n  <artifactId>log4j</artifactId>\n  <version>1.2.17</version>\n</dependency>\n\n\n\n# ä½¿ç¨ API\n\n# slf4j ç¨æ³\n\nä½¿ç¨ slf4j ç API å¾ç®åãä½¿ç¨LoggerFactoryåå§åä¸ä¸ªLoggerå®ä¾ï¼ç¶åè°ç¨ Logger å¯¹åºçæå°ç­çº§å½æ°å°±è¡äºã\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class App {\n    private static final Logger log = LoggerFactory.getLogger(App.class);\n    public static void main(String[] args) {\n        String msg = "print log, current level: {}";\n        log.trace(msg, "trace");\n        log.debug(msg, "debug");\n        log.info(msg, "info");\n        log.warn(msg, "warn");\n        log.error(msg, "error");\n    }\n}\n\n\n# common-logging ç¨æ³\n\ncommon-logging ç¨æ³å slf4j å ä¹ä¸æ ·ï¼ä½æ¯æ¯æçæå°ç­çº§å¤äºä¸ä¸ªæ´é«çº§å«çï¼fatalã\n\næ­¤å¤ï¼common-logging ä¸æ¯æ{}æ¿æ¢åæ°ï¼ä½ åªè½éæ©æ¼æ¥å­ç¬¦ä¸²è¿ç§æ¹å¼äºã\n\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\n\npublic class JclTest {\n    private static final Log log = LogFactory.getLog(JclTest.class);\n\n    public static void main(String[] args) {\n        String msg = "print log, current level: ";\n        log.trace(msg + "trace");\n        log.debug(msg + "debug");\n        log.info(msg + "info");\n        log.warn(msg + "warn");\n        log.error(msg + "error");\n        log.fatal(msg + "fatal");\n    }\n}\n\n\n\n# log4j2 éç½®\n\nlog4j2 åºæ¬éç½®å½¢å¼å¦ä¸ï¼\n\n<?xml version="1.0" encoding="UTF-8"?>;\n<Configuration>\n  <Properties>\n    <Property name="name1">value</property>\n    <Property name="name2" value="value2"/>\n  </Properties>\n  <Filter type="type" ... />\n  <Appenders>\n    <Appender type="type" name="name">\n      <Filter type="type" ... />\n    </Appender>\n    ...\n  </Appenders>\n  <Loggers>\n    <Logger name="name1">\n      <Filter type="type" ... />\n    </Logger>\n    ...\n    <Root level="level">\n      <AppenderRef ref="name"/>\n    </Root>\n  </Loggers>\n</Configuration>\n\n\néç½®ç¤ºä¾ï¼\n\n<?xml version="1.0" encoding="UTF-8"?>\n<Configuration status="debug" strict="true" name="XMLConfigTest"\n               packages="org.apache.logging.log4j.test">\n  <Properties>\n    <Property name="filename">target/test.log</Property>\n  </Properties>\n  <Filter type="ThresholdFilter" level="trace"/>\n\n  <Appenders>\n    <Appender type="Console" name="STDOUT">\n      <Layout type="PatternLayout" pattern="%m MDC%X%n"/>\n      <Filters>\n        <Filter type="MarkerFilter" marker="FLOW" onMatch="DENY" onMismatch="NEUTRAL"/>\n        <Filter type="MarkerFilter" marker="EXCEPTION" onMatch="DENY" onMismatch="ACCEPT"/>\n      </Filters>\n    </Appender>\n    <Appender type="Console" name="FLOW">\n      <Layout type="PatternLayout" pattern="%C{1}.%M %m %ex%n"/>\x3c!-- class and line number --\x3e\n      <Filters>\n        <Filter type="MarkerFilter" marker="FLOW" onMatch="ACCEPT" onMismatch="NEUTRAL"/>\n        <Filter type="MarkerFilter" marker="EXCEPTION" onMatch="ACCEPT" onMismatch="DENY"/>\n      </Filters>\n    </Appender>\n    <Appender type="File" name="File" fileName="${filename}">\n      <Layout type="PatternLayout">\n        <Pattern>%d %p %C{1.} [%t] %m%n</Pattern>\n      </Layout>\n    </Appender>\n  </Appenders>\n\n  <Loggers>\n    <Logger name="org.apache.logging.log4j.test1" level="debug" additivity="false">\n      <Filter type="ThreadContextMapFilter">\n        <KeyValuePair key="test" value="123"/>\n      </Filter>\n      <AppenderRef ref="STDOUT"/>\n    </Logger>\n\n    <Logger name="org.apache.logging.log4j.test2" level="debug" additivity="false">\n      <AppenderRef ref="File"/>\n    </Logger>\n\n    <Root level="trace">\n      <AppenderRef ref="STDOUT"/>\n    </Root>\n  </Loggers>\n\n</Configuration>\n\n\n\n# logback éç½®\n\n\n# <configuration>\n\n * ä½ç¨ï¼<configuration> æ¯ logback éç½®æä»¶çæ ¹åç´ ã\n * è¦ç¹\n   * å®æ <appender>ã<logger>ã<root> ä¸ä¸ªå­åç´ ã\n\n\n\n\n# <appender>\n\n * ä½ç¨ï¼å°è®°å½æ¥å¿çä»»å¡å§æç»åä¸º appender çç»ä»¶ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n   * å®æ <file>ã<filter>ã<layout>ã<encoder> åä¸ªå­åç´ ã\n * å±æ§\n   * nameï¼è®¾ç½® appender åç§°ã\n   * classï¼è®¾ç½®å·ä½çå®ä¾åç±»ã\n\n# <file>\n\n * ä½ç¨ï¼è®¾ç½®æ¥å¿æä»¶è·¯å¾ã\n\n# <filter>\n\n * ä½ç¨ï¼è®¾ç½®è¿æ»¤å¨ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n\n# <layout>\n\n * ä½ç¨ï¼è®¾ç½® appenderã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæä¸ä¸ªã\n * å±æ§\n   * classï¼è®¾ç½®å·ä½çå®ä¾åç±»ã\n\n# <encoder>\n\n * ä½ç¨ï¼è®¾ç½®ç¼ç ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n * å±æ§\n   * classï¼è®¾ç½®å·ä½çå®ä¾åç±»ã\n\n\n\n\n# <logger>\n\n * ä½ç¨ï¼è®¾ç½® loggerã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n * å±æ§\n   * name\n   * levelï¼è®¾ç½®æ¥å¿çº§å«ãä¸åºåå¤§å°åãå¯éå¼ï¼TRACEãDEBUGãINFOãWARNãERRORãALLãOFFã\n   * additivityï¼å¯éå¼ï¼true æ falseã\n\n# <appender-ref>\n\n * ä½ç¨ï¼appender å¼ç¨ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n\n\n# <root>\n\n * ä½ç¨ï¼è®¾ç½®æ ¹ loggerã\n * è¦ç¹\n   * åªè½éç½®ä¸ä¸ªã\n   * é¤äº levelï¼ä¸æ¯æä»»ä½å±æ§ãlevel å±æ§å <logger> ä¸­çç¸åã\n   * æä¸ä¸ªå­åç´  <appender-ref>ï¼ä¸ <logger> ä¸­çç¸åã\n\n\n# å®æ´ç logback.xml åèç¤ºä¾\n\nå¨ä¸é¢çéç½®æä»¶ä¸­ï¼æä¸ºèªå·±çé¡¹ç®ä»£ç ï¼æ ¹ç®å½ï¼org.zp.notes.springï¼è®¾ç½®äºäºç§ç­çº§ï¼\n\nTRACEãDEBUGãINFOãWARNãERRORï¼ä¼åçº§ä¾æ¬¡ä»ä½å°é«ã\n\nå ä¸ºå³æ³¨ spring æ¡æ¶æ¬èº«çä¸äºä¿¡æ¯ï¼æå¢å äºä¸é¨æå° spring WARN åä»¥ä¸ç­çº§çæ¥å¿ã\n\n<?xml version="1.0" encoding="UTF-8" ?>\n\n\x3c!-- logbackä¸­ä¸å±æ5ç§ææçº§å«ï¼åå«æ¯TRACEãDEBUGãINFOãWARNãERRORï¼ä¼åçº§ä¾æ¬¡ä»ä½å°é« --\x3e\n<configuration scan="true" scanPeriod="60 seconds" debug="false">\n\n  <property name="DIR_NAME" value="spring-helloworld"/>\n\n  \x3c!-- å°è®°å½æ¥å¿æå°å°æ§å¶å° --\x3e\n  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  \x3c!-- RollingFileAppender begin --\x3e\n  <appender name="ALL" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/all.%d{yyyy-MM-dd}.log</fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>30MB</maxFileSize>\n    </triggeringPolicy>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="ERROR" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/error.%d{yyyy-MM-dd}.log</fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>10MB</maxFileSize>\n    </triggeringPolicy>\n\n    <filter class="ch.qos.logback.classic.filter.LevelFilter">\n      <level>ERROR</level>\n      <onMatch>ACCEPT</onMatch>\n      <onMismatch>DENY</onMismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="WARN" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/warn.%d{yyyy-MM-dd}.log</fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>10MB</maxFileSize>\n    </triggeringPolicy>\n\n    <filter class="ch.qos.logback.classic.filter.LevelFilter">\n      <level>WARN</level>\n      <onMatch>ACCEPT</onMatch>\n      <onMismatch>DENY</onMismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="INFO" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/info.%d{yyyy-MM-dd}.log</fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>10MB</maxFileSize>\n    </triggeringPolicy>\n\n    <filter class="ch.qos.logback.classic.filter.LevelFilter">\n      <level>INFO</level>\n      <onMatch>ACCEPT</onMatch>\n      <onMismatch>DENY</onMismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="DEBUG" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/debug.%d{yyyy-MM-dd}.log</fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>10MB</maxFileSize>\n    </triggeringPolicy>\n\n    <filter class="ch.qos.logback.classic.filter.LevelFilter">\n      <level>DEBUG</level>\n      <onMatch>ACCEPT</onMatch>\n      <onMismatch>DENY</onMismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="TRACE" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/trace.%d{yyyy-MM-dd}.log</fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>10MB</maxFileSize>\n    </triggeringPolicy>\n\n    <filter class="ch.qos.logback.classic.filter.LevelFilter">\n      <level>TRACE</level>\n      <onMatch>ACCEPT</onMatch>\n      <onMismatch>DENY</onMismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="SPRING" class="ch.qos.logback.core.rolling.RollingFileAppender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n      <fileNamePattern>${user.dir}/logs/${DIR_NAME}/springframework.%d{yyyy-MM-dd}.log\n      </fileNamePattern>\n      <maxHistory>30</maxHistory>\n    </rollingPolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">\n      <maxFileSize>10MB</maxFileSize>\n    </triggeringPolicy>\n\n    <encoder>\n      <pattern>%d{HH:mm:ss.SSS} [%thread] [%-5p] %c{36}.%M - %m%n</pattern>\n    </encoder>\n  </appender>\n  \x3c!-- RollingFileAppender end --\x3e\n\n  \x3c!-- logger begin --\x3e\n  \x3c!-- æ¬é¡¹ç®çæ¥å¿è®°å½ï¼åçº§æå° --\x3e\n  <logger name="org.zp.notes.spring" level="TRACE" additivity="false">\n    <appender-ref ref="STDOUT"/>\n    <appender-ref ref="ERROR"/>\n    <appender-ref ref="WARN"/>\n    <appender-ref ref="INFO"/>\n    <appender-ref ref="DEBUG"/>\n    <appender-ref ref="TRACE"/>\n  </logger>\n\n  \x3c!-- SPRINGæ¡æ¶æ¥å¿ --\x3e\n  <logger name="org.springframework" level="WARN" additivity="false">\n    <appender-ref ref="SPRING"/>\n  </logger>\n\n  <root level="TRACE">\n    <appender-ref ref="ALL"/>\n  </root>\n  \x3c!-- logger end --\x3e\n\n</configuration>\n\n\n\n# log4j éç½®\n\n\n# å®æ´ç log4j.xml åèç¤ºä¾\n\nlog4j çéç½®æä»¶ä¸è¬æ xml æ ¼å¼æ properties æ ¼å¼ãè¿éä¸ºäºå logback.xml åä¸ªå¯¹æ¯ï¼å°±ä¸ä»ç» properties äºï¼å¶å®ä¹æ²¡å¤ªå¤§å·®å«ã\n\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">\n\n<log4j:configuration xmlns:log4j=\'http://jakarta.apache.org/log4j/\'>\n\n  <appender name="STDOUT" class="org.apache.log4j.ConsoleAppender">\n    <layout class="org.apache.log4j.PatternLayout">\n      <param name="ConversionPattern"\n             value="%d{yyyy-MM-dd HH:mm:ss,SSS\\} [%-5p] [%t] %c{36\\}.%M - %m%n"/>\n    </layout>\n\n    \x3c!--è¿æ»¤å¨è®¾ç½®è¾åºççº§å«--\x3e\n    <filter class="org.apache.log4j.varia.LevelRangeFilter">\n      <param name="levelMin" value="debug"/>\n      <param name="levelMax" value="fatal"/>\n      <param name="AcceptOnMatch" value="true"/>\n    </filter>\n  </appender>\n\n\n  <appender name="ALL" class="org.apache.log4j.DailyRollingFileAppender">\n    <param name="File" value="${user.dir}/logs/spring-common/jcl/all"/>\n    <param name="Append" value="true"/>\n    \x3c!-- æ¯å¤©éæ°çææ¥å¿æä»¶ --\x3e\n    <param name="DatePattern" value="\'-\'yyyy-MM-dd\'.log\'"/>\n    \x3c!-- æ¯å°æ¶éæ°çææ¥å¿æä»¶ --\x3e\n    \x3c!--<param name="DatePattern" value="\'-\'yyyy-MM-dd-HH\'.log\'"/>--\x3e\n    <layout class="org.apache.log4j.PatternLayout">\n      <param name="ConversionPattern"\n             value="%d{yyyy-MM-dd HH:mm:ss,SSS\\} [%-5p] [%t] %c{36\\}.%M - %m%n"/>\n    </layout>\n  </appender>\n\n  \x3c!-- æå®loggerçè®¾ç½®ï¼additivityæç¤ºæ¯å¦éµå¾ªç¼ºççç»§æ¿æºå¶--\x3e\n  <logger name="org.zp.notes.spring" additivity="false">\n    <level value="error"/>\n    <appender-ref ref="STDOUT"/>\n    <appender-ref ref="ALL"/>\n  </logger>\n\n  \x3c!-- æ ¹loggerçè®¾ç½®--\x3e\n  <root>\n    <level value="warn"/>\n    <appender-ref ref="STDOUT"/>\n  </root>\n</log4j:configuration>\n\n\n\n# åè\n\n * slf4 å®æ¹ææ¡£\n * logback å®æ¹ææ¡£\n * log4j å®æ¹ææ¡£\n * commons-logging å®æ¹ææ¡£\n * http://blog.csdn.net/yycdaizi/article/details/8276265',normalizedContent:'# ç»è¯´ java ä¸»æµæ¥å¿å·¥å·åº\n\n> å¨é¡¹ç®å¼åä¸­ï¼ä¸ºäºè·è¸ªä»£ç çè¿è¡æåµï¼å¸¸å¸¸è¦ä½¿ç¨æ¥å¿æ¥è®°å½ä¿¡æ¯ã\n> \n> å¨ java ä¸çï¼æå¾å¤çæ¥å¿å·¥å·åºæ¥å®ç°æ¥å¿åè½ï¼é¿åäºæä»¬éå¤é è½®å­ã\n> \n> æä»¬åæ¥éä¸äºè§£ä¸ä¸ä¸»æµæ¥å¿å·¥å·ã\n\n\n# æ¥å¿æ¡æ¶\n\n\n# java.util.logging (jul)\n\njdk1.4 å¼å§ï¼éè¿ java.util.logging æä¾æ¥å¿åè½ã\n\nå®è½æ»¡è¶³åºæ¬çæ¥å¿éè¦ï¼ä½æ¯åè½æ²¡æ log4j å¼ºå¤§ï¼èä¸ä½¿ç¨èå´ä¹æ²¡æ log4j å¹¿æ³ã\n\n\n# log4j\n\nlog4j æ¯ apache çä¸ä¸ªå¼æºé¡¹ç®ï¼åå§äºº ceki gulcuã\n\nlog4j åºè¯¥è¯´æ¯ java é¢åèµæ ¼æèï¼åºç¨æå¹¿çæ¥å¿å·¥å·ãä»è¯çä¹æ¥å°ç°å¨ä¸ç´å¹¿åä¸çæ¬¢è¿ã\n\nlog4j æ¯é«åº¦å¯éç½®çï¼å¹¶å¯éè¿å¨è¿è¡æ¶çå¤é¨æä»¶éç½®ãå®æ ¹æ®è®°å½çä¼åçº§å«ï¼å¹¶æä¾æºå¶ï¼ä»¥æç¤ºè®°å½ä¿¡æ¯å°è®¸å¤çç®çå°ï¼è¯¸å¦ï¼æ°æ®åºï¼æä»¶ï¼æ§å¶å°ï¼unix ç³»ç»æ¥å¿ç­ã\n\nlog4j ä¸­æä¸ä¸ªä¸»è¦ç»æé¨åï¼\n\n * loggers - è´è´£æè·è®°å½ä¿¡æ¯ã\n * appenders - è´è´£åå¸æ¥å¿ä¿¡æ¯ï¼ä»¥ä¸åçé¦éç®çå°ã\n * layouts - è´è´£æ ¼å¼åä¸åé£æ ¼çæ¥å¿ä¿¡æ¯ã\n\nå®ç½å°å\n\n\n# logback\n\nlogback æ¯ç± log4j åå§äºº ceki gulcu è®¾è®¡çåä¸ä¸ªå¼æºæ¥è®°ç»ä»¶ï¼ç®æ æ¯æ¿ä»£ log4jã\n\nlogback å½ååæä¸ä¸ªæ¨¡åï¼logback-coreãlogback-classic å logback-accessã\n\n * logback-core - æ¯å¶å®ä¸¤ä¸ªæ¨¡åçåºç¡æ¨¡åã\n * logback-classic - æ¯ log4j çä¸ä¸ª æ¹è¯çæ¬ãæ­¤å¤ logback-classic å®æ´å®ç° slf4j api ä½¿ä½ å¯ä»¥å¾æ¹ä¾¿å°æ´æ¢æå¶å®æ¥è®°ç³»ç»å¦ log4j æ jdk14 loggingã\n * logback-access - è®¿é®æ¨¡åä¸ servlet å®¹å¨éææä¾éè¿ http æ¥è®¿é®æ¥è®°çåè½ã\n\nå®ç½å°å\n\n\n# log4j2\n\nå®ç½å°å\n\næç§å®æ¹çè¯´æ³ï¼log4j2 æ¯ log4j å logback çæ¿ä»£ã\n\nlog4j2 æ¶æï¼\n\n\n\n\n# log4j vs logback vs log4j2\n\næç§å®æ¹çè¯´æ³ï¼log4j2 å¤§å¤§ä¼äº log4j å logbackã\n\né£ä¹ï¼log4j2 ç¸æ¯äºåé®ä¸ç log4j å logbackï¼å®å·æåªäºä¼å¿å¢ï¼\n\n 1.  log4j2 æ¨å¨ç¨ä½å®¡è®¡æ¥å¿è®°å½æ¡æ¶ã log4j 1.x å logback é½ä¼å¨éæ°éç½®æ¶ä¸¢å¤±äºä»¶ã log4j 2 ä¸ä¼ãå¨ logback ä¸­ï¼appender ä¸­çå¼å¸¸æ°¸è¿ä¸ä¼å¯¹åºç¨ç¨åºå¯è§ãå¨ log4j ä¸­ï¼å¯ä»¥å° appender éç½®ä¸ºåè®¸å¼å¸¸æ¸éå°åºç¨ç¨åºã\n 2.  log4j2 å¨å¤çº¿ç¨åºæ¯ä¸­ï¼å¼æ­¥ loggers çååéæ¯ log4j 1.x å logback é« 10 åï¼å»¶è¿ä½å ä¸ªæ°éçº§ã\n 3.  log4j2 å¯¹äºç¬ç«åºç¨ç¨åºæ¯æ åå¾çï¼å¯¹äºç¨³å®ç¶ææ¥å¿è®°å½æé´ç web åºç¨ç¨åºæ¥è¯´æ¯ä½åå¾ãè¿åå°äºåå¾æ¶éå¨çååï¼å¹¶ä¸å¯ä»¥æä¾æ´å¥½çååºæ¶é´æ§è½ã\n 4.  log4j2 ä½¿ç¨æä»¶ç³»ç»ï¼éè¿æ·»å æ°ç appenderãfilterãlayoutãlookup å pattern converterï¼å¯ä»¥éå¸¸è½»æ¾å°æ©å±æ¡æ¶ï¼èæ éå¯¹ log4j è¿è¡ä»»ä½æ´æ¹ã\n 5.  ç±äºæä»¶ç³»ç»éç½®æ´ç®åãéç½®ä¸­çæ¡ç®ä¸éè¦æå®ç±»åã\n 6.  æ¯æèªå®ä¹æ¥å¿ç­çº§ã\n 7.  æ¯æ lambda è¡¨è¾¾å¼ã\n 8.  æ¯ææ¶æ¯å¯¹è±¡ã\n 9.  log4j å logback ç layout è¿åçæ¯å­ç¬¦ä¸²ï¼è log4j2 è¿åçæ¯äºè¿å¶æ°ç»ï¼è¿ä½¿å¾å®è½è¢«åç§ appender ä½¿ç¨ã\n 10. syslog appender æ¯æ tcp å udp å¹¶ä¸æ¯æ bsd ç³»ç»æ¥å¿ã\n 11. log4j2 å©ç¨ java5 å¹¶åç¹æ§ï¼å°½éå°ç²åº¦çä½¿ç¨éï¼åå°éçå¼éã\n\n\n# æ¥å¿é¨é¢\n\nä½è°æ¥å¿é¨é¢ï¼\n\næ¥å¿é¨é¢æ¯å¯¹ä¸åæ¥å¿æ¡æ¶æä¾çä¸ä¸ª api å°è£ï¼å¯ä»¥å¨é¨ç½²çæ¶åä¸ä¿®æ¹ä»»ä½éç½®å³å¯æ¥å¥ä¸ç§æ¥å¿å®ç°æ¹æ¡ã\n\n\n# common-logging\n\ncommon-logging æ¯ apache çä¸ä¸ªå¼æºé¡¹ç®ãä¹ç§°jakarta commons loggingï¼ç¼©å jclã\n\ncommon-logging çåè½æ¯æä¾æ¥å¿åè½ç api æ¥å£ï¼æ¬èº«å¹¶ä¸æä¾æ¥å¿çå·ä½å®ç°ï¼å½ç¶ï¼common-logging åé¨æä¸ä¸ª simple logger çç®åå®ç°ï¼ä½æ¯åè½å¾å¼±ï¼ç´æ¥å¿½ç¥ï¼ï¼èæ¯å¨è¿è¡æ¶å¨æçç»å®æ¥å¿å®ç°ç»ä»¶æ¥å·¥ä½ï¼å¦ log4jãjava.util.logginï¼ã\n\nå®ç½å°å\n\n\n# slf4j\n\nå¨ç§°ä¸º simple logging facade for javaï¼å³ java ç®åæ¥å¿é¨é¢ã\n\nä»ä¹ï¼ä½èåæ¯ ceki gulcuï¼è¿ä½å¤§ç¥åäº log4jãlogback å slf4jï¼ä¸æ³¨æ¥å¿ç»ä»¶å¼åäºç¾å¹´ï¼ä¸ç´åªè½è¶è¶èªå·±ã\n\nç±»ä¼¼äº common-loggingï¼slf4j æ¯å¯¹ä¸åæ¥å¿æ¡æ¶æä¾çä¸ä¸ª api å°è£ï¼å¯ä»¥å¨é¨ç½²çæ¶åä¸ä¿®æ¹ä»»ä½éç½®å³å¯æ¥å¥ä¸ç§æ¥å¿å®ç°æ¹æ¡ãä½æ¯ï¼slf4j å¨ç¼è¯æ¶éæç»å®çæ­£ç log åºãä½¿ç¨ slf4j æ¶ï¼å¦æä½ éè¦ä½¿ç¨æä¸ç§æ¥å¿å®ç°ï¼é£ä¹ä½ å¿é¡»éæ©æ­£ç¡®ç slf4j ç jar åçéåï¼åç§æ¡¥æ¥åï¼ã\n\nå®ç½å°å\n\n\n\n\n# common-logging vs slf4j\n\nslf4j åºç±»ä¼¼äº apache common-loggingãä½æ¯ï¼ä»å¨ç¼è¯æ¶éæç»å®çæ­£çæ¥å¿åºãè¿ç¹ä¼¼ä¹å¾éº»ç¦ï¼å¶å®ä¹ä¸è¿æ¯å¯¼å¥æ¡¥æ¥ jar åèå·²ã\n\nslf4j ä¸å¤§äº®ç¹æ¯æä¾äºæ´æ¹ä¾¿çæ¥å¿è®°å½æ¹å¼ï¼\n\nä¸éè¦ä½¿ç¨logger.isdebugenabled()æ¥è§£å³æ¥å¿å ä¸ºå­ç¬¦æ¼æ¥äº§ççæ§è½é®é¢ãslf4j çæ¹å¼æ¯ä½¿ç¨{}ä½ä¸ºå­ç¬¦ä¸²æ¿æ¢ç¬¦ï¼å½¢å¼å¦ä¸ï¼\n\nlogger.debug("id: {}, name: {} ", id, name);\n\n\n\n# æ»ç»\n\nç»¼ä¸æè¿°ï¼ä½¿ç¨ slf4j + logback å¯è°æ¯ç®åæçæ³çæ¥å¿è§£å³æ¹æ¡äºã\n\næ¥ä¸æ¥ï¼å°±æ¯å¦ä½å¨é¡¹ç®ä¸­å®æ½äºã\n\n\n# å®æ½æ¥å¿è§£å³æ¹æ¡\n\nä½¿ç¨æ¥å¿è§£å³æ¹æ¡åºæ¬å¯åä¸ºä¸æ­¥ï¼\n\n 1. å¼å¥ jar å\n 2. éç½®\n 3. ä½¿ç¨ api\n\nå¸¸è§çåç§æ¥å¿è§£å³æ¹æ¡çç¬¬ 2 æ­¥åç¬¬ 3 æ­¥åºæ¬ä¸æ ·ï¼å®æ½ä¸çå·®å«ä¸»è¦å¨ç¬¬ 1 æ­¥ï¼ä¹å°±æ¯ä½¿ç¨ä¸åçåºã\n\n\n# å¼å¥ jar å\n\nè¿éé¦éæ¨èä½¿ç¨ slf4j + logback çç»åã\n\nå¦æä½ ä¹ æ¯äº common-loggingï¼å¯ä»¥éæ© common-logging+log4jã\n\nå¼ºçå»ºè®®ä¸è¦ç´æ¥ä½¿ç¨æ¥å¿å®ç°ç»ä»¶(logbackãlog4jãjava.util.logging)ï¼çç±åé¢ä¹è¯´è¿ï¼å°±æ¯æ æ³çµæ´»æ¿æ¢æ¥å¿åºã\n\nè¿æä¸ç§æåµï¼ä½ çèé¡¹ç®ä½¿ç¨äº common-loggingï¼ææ¯ç´æ¥ä½¿ç¨æ¥å¿å®ç°ç»ä»¶ãå¦æä¿®æ¹èçä»£ç ï¼å·¥ä½éå¤ªå¤§ï¼éè¦å¼å®¹å¤çãå¨ä¸æï¼é½å°çå°åç§åºå¯¹æ¹æ³ã\n\næ³¨ï¼æ®ææç¥ï¼å½åä»æ²¡ææ¹æ³å¯ä»¥å° slf4j æ¡¥æ¥å° common-loggingãå¦ææå­¤éå¯¡é»äºï¼è¯·ä¸åèµæã\n\n# slf4j ç´æ¥ç»å®æ¥å¿ç»ä»¶\n\nslf4j + logback\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\nlogback-classic-1.0.13.jar ä¼èªå¨å° slf4j-api-1.7.21.jar å logback-core-1.0.13.jar ä¹æ·»å å°ä½ çé¡¹ç®ä¸­ã\n\n<dependency>\n  <groupid>ch.qos.logback</groupid>\n  <artifactid>logback-classic</artifactid>\n  <version>1.0.13</version>\n</dependency>\n\n\nslf4j + log4j\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\nslf4j-log4j12-1.7.21.jar ä¼èªå¨å° slf4j-api-1.7.21.jar å log4j-1.2.17.jar ä¹æ·»å å°ä½ çé¡¹ç®ä¸­ã\n\n<dependency>\n  <groupid>org.slf4j</groupid>\n  <artifactid>slf4j-log4j12</artifactid>\n  <version>1.7.21</version>\n</dependency>\n\n\nslf4j + java.util.logging\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\nslf4j-jdk14-1.7.21.jar ä¼èªå¨å° slf4j-api-1.7.21.jar ä¹æ·»å å°ä½ çé¡¹ç®ä¸­ã\n\n<dependency>\n  <groupid>org.slf4j</groupid>\n  <artifactid>slf4j-jdk14</artifactid>\n  <version>1.7.21</version>\n</dependency>\n\n\n# slf4j å¼å®¹é slf4j æ¥å¿ç»ä»¶\n\nå¨ä»ç»è§£å³æ¹æ¡åï¼åæä¸ä¸ªæ¦å¿µââæ¡¥æ¥\n\nä»ä¹æ¯æ¡¥æ¥å¢\n\nåå¦ä½ æ­£å¨å¼ååºç¨ç¨åºæè°ç¨çç»ä»¶å½ä¸­å·²ç»ä½¿ç¨äº common-loggingï¼è¿æ¶ä½ éè¦ jcl-over-slf4j.jar ææ¥å¿ä¿¡æ¯è¾åºéå®åå° slf4j-apiï¼slf4j-api åå»è°ç¨ slf4j å®éä¾èµçæ¥å¿ç»ä»¶ãè¿ä¸ªè¿ç¨ç§°ä¸ºæ¡¥æ¥ãä¸å¾æ¯å®æ¹ç slf4j æ¡¥æ¥ç­ç¥å¾ï¼\n\n\n\nä»å¾ä¸­åºè¯¥å¯ä»¥çåºï¼æ è®ºä½ çèé¡¹ç®ä¸­ä½¿ç¨çæ¯ common-logging ææ¯ç´æ¥ä½¿ç¨ log4jãjava.util.loggingï¼é½å¯ä»¥ä½¿ç¨å¯¹åºçæ¡¥æ¥ jar åæ¥è§£å³å¼å®¹é®é¢ã\n\nslf4j å¼å®¹ common-logging\n\n<dependency>\n  <groupid>org.slf4j</groupid>\n  <artifactid>jcl-over-slf4j</artifactid>\n  <version>1.7.12</version>\n</dependency>\n\n\nslf4j å¼å®¹ log4j\n\n<dependency>\n    <groupid>org.slf4j</groupid>\n    <artifactid>log4j-over-slf4j</artifactid>\n    <version>1.7.12</version>\n</dependency>\n\n\nslf4j å¼å®¹ java.util.logging\n\n<dependency>\n    <groupid>org.slf4j</groupid>\n    <artifactid>jul-to-slf4j</artifactid>\n    <version>1.7.12</version>\n</dependency>\n\n\n# spring éæ slf4j\n\nå java web å¼åï¼åºæ¬ç¦»ä¸å¼ spring æ¡æ¶ãå¾éæ¾ï¼spring ä½¿ç¨çæ¥å¿è§£å³æ¹æ¡æ¯ common-logging + log4jã\n\næä»¥ï¼ä½ éè¦ä¸ä¸ªæ¡¥æ¥ jar åï¼logback-ext-springã\n\n<dependency>\n  <groupid>ch.qos.logback</groupid>\n  <artifactid>logback-classic</artifactid>\n  <version>1.1.3</version>\n</dependency>\n<dependency>\n  <groupid>org.logback-extensions</groupid>\n  <artifactid>logback-ext-spring</artifactid>\n  <version>0.1.2</version>\n</dependency>\n<dependency>\n  <groupid>org.slf4j</groupid>\n  <artifactid>jcl-over-slf4j</artifactid>\n  <version>1.7.12</version>\n</dependency>\n\n\n# common-logging ç»å®æ¥å¿ç»ä»¶\n\ncommon-logging + log4j\n\næ·»å ä¾èµå° pom.xml ä¸­å³å¯ã\n\n<dependency>\n  <groupid>commons-logging</groupid>\n  <artifactid>commons-logging</artifactid>\n  <version>1.2</version>\n</dependency>\n<dependency>\n  <groupid>log4j</groupid>\n  <artifactid>log4j</artifactid>\n  <version>1.2.17</version>\n</dependency>\n\n\n\n# ä½¿ç¨ api\n\n# slf4j ç¨æ³\n\nä½¿ç¨ slf4j ç api å¾ç®åãä½¿ç¨loggerfactoryåå§åä¸ä¸ªloggerå®ä¾ï¼ç¶åè°ç¨ logger å¯¹åºçæå°ç­çº§å½æ°å°±è¡äºã\n\nimport org.slf4j.logger;\nimport org.slf4j.loggerfactory;\n\npublic class app {\n    private static final logger log = loggerfactory.getlogger(app.class);\n    public static void main(string[] args) {\n        string msg = "print log, current level: {}";\n        log.trace(msg, "trace");\n        log.debug(msg, "debug");\n        log.info(msg, "info");\n        log.warn(msg, "warn");\n        log.error(msg, "error");\n    }\n}\n\n\n# common-logging ç¨æ³\n\ncommon-logging ç¨æ³å slf4j å ä¹ä¸æ ·ï¼ä½æ¯æ¯æçæå°ç­çº§å¤äºä¸ä¸ªæ´é«çº§å«çï¼fatalã\n\næ­¤å¤ï¼common-logging ä¸æ¯æ{}æ¿æ¢åæ°ï¼ä½ åªè½éæ©æ¼æ¥å­ç¬¦ä¸²è¿ç§æ¹å¼äºã\n\nimport org.apache.commons.logging.log;\nimport org.apache.commons.logging.logfactory;\n\npublic class jcltest {\n    private static final log log = logfactory.getlog(jcltest.class);\n\n    public static void main(string[] args) {\n        string msg = "print log, current level: ";\n        log.trace(msg + "trace");\n        log.debug(msg + "debug");\n        log.info(msg + "info");\n        log.warn(msg + "warn");\n        log.error(msg + "error");\n        log.fatal(msg + "fatal");\n    }\n}\n\n\n\n# log4j2 éç½®\n\nlog4j2 åºæ¬éç½®å½¢å¼å¦ä¸ï¼\n\n<?xml version="1.0" encoding="utf-8"?>;\n<configuration>\n  <properties>\n    <property name="name1">value</property>\n    <property name="name2" value="value2"/>\n  </properties>\n  <filter type="type" ... />\n  <appenders>\n    <appender type="type" name="name">\n      <filter type="type" ... />\n    </appender>\n    ...\n  </appenders>\n  <loggers>\n    <logger name="name1">\n      <filter type="type" ... />\n    </logger>\n    ...\n    <root level="level">\n      <appenderref ref="name"/>\n    </root>\n  </loggers>\n</configuration>\n\n\néç½®ç¤ºä¾ï¼\n\n<?xml version="1.0" encoding="utf-8"?>\n<configuration status="debug" strict="true" name="xmlconfigtest"\n               packages="org.apache.logging.log4j.test">\n  <properties>\n    <property name="filename">target/test.log</property>\n  </properties>\n  <filter type="thresholdfilter" level="trace"/>\n\n  <appenders>\n    <appender type="console" name="stdout">\n      <layout type="patternlayout" pattern="%m mdc%x%n"/>\n      <filters>\n        <filter type="markerfilter" marker="flow" onmatch="deny" onmismatch="neutral"/>\n        <filter type="markerfilter" marker="exception" onmatch="deny" onmismatch="accept"/>\n      </filters>\n    </appender>\n    <appender type="console" name="flow">\n      <layout type="patternlayout" pattern="%c{1}.%m %m %ex%n"/>\x3c!-- class and line number --\x3e\n      <filters>\n        <filter type="markerfilter" marker="flow" onmatch="accept" onmismatch="neutral"/>\n        <filter type="markerfilter" marker="exception" onmatch="accept" onmismatch="deny"/>\n      </filters>\n    </appender>\n    <appender type="file" name="file" filename="${filename}">\n      <layout type="patternlayout">\n        <pattern>%d %p %c{1.} [%t] %m%n</pattern>\n      </layout>\n    </appender>\n  </appenders>\n\n  <loggers>\n    <logger name="org.apache.logging.log4j.test1" level="debug" additivity="false">\n      <filter type="threadcontextmapfilter">\n        <keyvaluepair key="test" value="123"/>\n      </filter>\n      <appenderref ref="stdout"/>\n    </logger>\n\n    <logger name="org.apache.logging.log4j.test2" level="debug" additivity="false">\n      <appenderref ref="file"/>\n    </logger>\n\n    <root level="trace">\n      <appenderref ref="stdout"/>\n    </root>\n  </loggers>\n\n</configuration>\n\n\n\n# logback éç½®\n\n\n# <configuration>\n\n * ä½ç¨ï¼<configuration> æ¯ logback éç½®æä»¶çæ ¹åç´ ã\n * è¦ç¹\n   * å®æ <appender>ã<logger>ã<root> ä¸ä¸ªå­åç´ ã\n\n\n\n\n# <appender>\n\n * ä½ç¨ï¼å°è®°å½æ¥å¿çä»»å¡å§æç»åä¸º appender çç»ä»¶ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n   * å®æ <file>ã<filter>ã<layout>ã<encoder> åä¸ªå­åç´ ã\n * å±æ§\n   * nameï¼è®¾ç½® appender åç§°ã\n   * classï¼è®¾ç½®å·ä½çå®ä¾åç±»ã\n\n# <file>\n\n * ä½ç¨ï¼è®¾ç½®æ¥å¿æä»¶è·¯å¾ã\n\n# <filter>\n\n * ä½ç¨ï¼è®¾ç½®è¿æ»¤å¨ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n\n# <layout>\n\n * ä½ç¨ï¼è®¾ç½® appenderã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæä¸ä¸ªã\n * å±æ§\n   * classï¼è®¾ç½®å·ä½çå®ä¾åç±»ã\n\n# <encoder>\n\n * ä½ç¨ï¼è®¾ç½®ç¼ç ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n * å±æ§\n   * classï¼è®¾ç½®å·ä½çå®ä¾åç±»ã\n\n\n\n\n# <logger>\n\n * ä½ç¨ï¼è®¾ç½® loggerã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n * å±æ§\n   * name\n   * levelï¼è®¾ç½®æ¥å¿çº§å«ãä¸åºåå¤§å°åãå¯éå¼ï¼traceãdebugãinfoãwarnãerrorãallãoffã\n   * additivityï¼å¯éå¼ï¼true æ falseã\n\n# <appender-ref>\n\n * ä½ç¨ï¼appender å¼ç¨ã\n * è¦ç¹\n   * å¯ä»¥éç½®é¶ä¸ªæå¤ä¸ªã\n\n\n# <root>\n\n * ä½ç¨ï¼è®¾ç½®æ ¹ loggerã\n * è¦ç¹\n   * åªè½éç½®ä¸ä¸ªã\n   * é¤äº levelï¼ä¸æ¯æä»»ä½å±æ§ãlevel å±æ§å <logger> ä¸­çç¸åã\n   * æä¸ä¸ªå­åç´  <appender-ref>ï¼ä¸ <logger> ä¸­çç¸åã\n\n\n# å®æ´ç logback.xml åèç¤ºä¾\n\nå¨ä¸é¢çéç½®æä»¶ä¸­ï¼æä¸ºèªå·±çé¡¹ç®ä»£ç ï¼æ ¹ç®å½ï¼org.zp.notes.springï¼è®¾ç½®äºäºç§ç­çº§ï¼\n\ntraceãdebugãinfoãwarnãerrorï¼ä¼åçº§ä¾æ¬¡ä»ä½å°é«ã\n\nå ä¸ºå³æ³¨ spring æ¡æ¶æ¬èº«çä¸äºä¿¡æ¯ï¼æå¢å äºä¸é¨æå° spring warn åä»¥ä¸ç­çº§çæ¥å¿ã\n\n<?xml version="1.0" encoding="utf-8" ?>\n\n\x3c!-- logbackä¸­ä¸å±æ5ç§ææçº§å«ï¼åå«æ¯traceãdebugãinfoãwarnãerrorï¼ä¼åçº§ä¾æ¬¡ä»ä½å°é« --\x3e\n<configuration scan="true" scanperiod="60 seconds" debug="false">\n\n  <property name="dir_name" value="spring-helloworld"/>\n\n  \x3c!-- å°è®°å½æ¥å¿æå°å°æ§å¶å° --\x3e\n  <appender name="stdout" class="ch.qos.logback.core.consoleappender">\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  \x3c!-- rollingfileappender begin --\x3e\n  <appender name="all" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/all.%d{yyyy-mm-dd}.log</filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>30mb</maxfilesize>\n    </triggeringpolicy>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="error" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/error.%d{yyyy-mm-dd}.log</filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>10mb</maxfilesize>\n    </triggeringpolicy>\n\n    <filter class="ch.qos.logback.classic.filter.levelfilter">\n      <level>error</level>\n      <onmatch>accept</onmatch>\n      <onmismatch>deny</onmismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="warn" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/warn.%d{yyyy-mm-dd}.log</filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>10mb</maxfilesize>\n    </triggeringpolicy>\n\n    <filter class="ch.qos.logback.classic.filter.levelfilter">\n      <level>warn</level>\n      <onmatch>accept</onmatch>\n      <onmismatch>deny</onmismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="info" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/info.%d{yyyy-mm-dd}.log</filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>10mb</maxfilesize>\n    </triggeringpolicy>\n\n    <filter class="ch.qos.logback.classic.filter.levelfilter">\n      <level>info</level>\n      <onmatch>accept</onmatch>\n      <onmismatch>deny</onmismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="debug" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/debug.%d{yyyy-mm-dd}.log</filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>10mb</maxfilesize>\n    </triggeringpolicy>\n\n    <filter class="ch.qos.logback.classic.filter.levelfilter">\n      <level>debug</level>\n      <onmatch>accept</onmatch>\n      <onmismatch>deny</onmismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="trace" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/trace.%d{yyyy-mm-dd}.log</filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>10mb</maxfilesize>\n    </triggeringpolicy>\n\n    <filter class="ch.qos.logback.classic.filter.levelfilter">\n      <level>trace</level>\n      <onmatch>accept</onmatch>\n      <onmismatch>deny</onmismatch>\n    </filter>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n\n  <appender name="spring" class="ch.qos.logback.core.rolling.rollingfileappender">\n    \x3c!-- æ ¹æ®æ¶é´æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <rollingpolicy class="ch.qos.logback.core.rolling.timebasedrollingpolicy">\n      <filenamepattern>${user.dir}/logs/${dir_name}/springframework.%d{yyyy-mm-dd}.log\n      </filenamepattern>\n      <maxhistory>30</maxhistory>\n    </rollingpolicy>\n\n    \x3c!-- æ ¹æ®æä»¶å¤§å°æ¥å¶å®æ»å¨ç­ç¥ --\x3e\n    <triggeringpolicy class="ch.qos.logback.core.rolling.sizebasedtriggeringpolicy">\n      <maxfilesize>10mb</maxfilesize>\n    </triggeringpolicy>\n\n    <encoder>\n      <pattern>%d{hh:mm:ss.sss} [%thread] [%-5p] %c{36}.%m - %m%n</pattern>\n    </encoder>\n  </appender>\n  \x3c!-- rollingfileappender end --\x3e\n\n  \x3c!-- logger begin --\x3e\n  \x3c!-- æ¬é¡¹ç®çæ¥å¿è®°å½ï¼åçº§æå° --\x3e\n  <logger name="org.zp.notes.spring" level="trace" additivity="false">\n    <appender-ref ref="stdout"/>\n    <appender-ref ref="error"/>\n    <appender-ref ref="warn"/>\n    <appender-ref ref="info"/>\n    <appender-ref ref="debug"/>\n    <appender-ref ref="trace"/>\n  </logger>\n\n  \x3c!-- springæ¡æ¶æ¥å¿ --\x3e\n  <logger name="org.springframework" level="warn" additivity="false">\n    <appender-ref ref="spring"/>\n  </logger>\n\n  <root level="trace">\n    <appender-ref ref="all"/>\n  </root>\n  \x3c!-- logger end --\x3e\n\n</configuration>\n\n\n\n# log4j éç½®\n\n\n# å®æ´ç log4j.xml åèç¤ºä¾\n\nlog4j çéç½®æä»¶ä¸è¬æ xml æ ¼å¼æ properties æ ¼å¼ãè¿éä¸ºäºå logback.xml åä¸ªå¯¹æ¯ï¼å°±ä¸ä»ç» properties äºï¼å¶å®ä¹æ²¡å¤ªå¤§å·®å«ã\n\n<?xml version="1.0" encoding="utf-8"?>\n<!doctype log4j:configuration system "log4j.dtd">\n\n<log4j:configuration xmlns:log4j=\'http://jakarta.apache.org/log4j/\'>\n\n  <appender name="stdout" class="org.apache.log4j.consoleappender">\n    <layout class="org.apache.log4j.patternlayout">\n      <param name="conversionpattern"\n             value="%d{yyyy-mm-dd hh:mm:ss,sss\\} [%-5p] [%t] %c{36\\}.%m - %m%n"/>\n    </layout>\n\n    \x3c!--è¿æ»¤å¨è®¾ç½®è¾åºççº§å«--\x3e\n    <filter class="org.apache.log4j.varia.levelrangefilter">\n      <param name="levelmin" value="debug"/>\n      <param name="levelmax" value="fatal"/>\n      <param name="acceptonmatch" value="true"/>\n    </filter>\n  </appender>\n\n\n  <appender name="all" class="org.apache.log4j.dailyrollingfileappender">\n    <param name="file" value="${user.dir}/logs/spring-common/jcl/all"/>\n    <param name="append" value="true"/>\n    \x3c!-- æ¯å¤©éæ°çææ¥å¿æä»¶ --\x3e\n    <param name="datepattern" value="\'-\'yyyy-mm-dd\'.log\'"/>\n    \x3c!-- æ¯å°æ¶éæ°çææ¥å¿æä»¶ --\x3e\n    \x3c!--<param name="datepattern" value="\'-\'yyyy-mm-dd-hh\'.log\'"/>--\x3e\n    <layout class="org.apache.log4j.patternlayout">\n      <param name="conversionpattern"\n             value="%d{yyyy-mm-dd hh:mm:ss,sss\\} [%-5p] [%t] %c{36\\}.%m - %m%n"/>\n    </layout>\n  </appender>\n\n  \x3c!-- æå®loggerçè®¾ç½®ï¼additivityæç¤ºæ¯å¦éµå¾ªç¼ºççç»§æ¿æºå¶--\x3e\n  <logger name="org.zp.notes.spring" additivity="false">\n    <level value="error"/>\n    <appender-ref ref="stdout"/>\n    <appender-ref ref="all"/>\n  </logger>\n\n  \x3c!-- æ ¹loggerçè®¾ç½®--\x3e\n  <root>\n    <level value="warn"/>\n    <appender-ref ref="stdout"/>\n  </root>\n</log4j:configuration>\n\n\n\n# åè\n\n * slf4 å®æ¹ææ¡£\n * logback å®æ¹ææ¡£\n * log4j å®æ¹ææ¡£\n * commons-logging å®æ¹ææ¡£\n * http://blog.csdn.net/yycdaizi/article/details/8276265',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"javalib-util",frontmatter:{title:"javalib-util",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","å·¥å·å"],abbrlink:"8280ff5f",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/14e432/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/02.Java%E5%B7%A5%E5%85%B7%E5%8C%85.html",relativePath:"12.å·¥å·/99.å¶ä»/02.Javaå·¥å·å.md",key:"v-dbf118bc",path:"/pages/14e432/",headersStr:null,content:"# ç»è¯´ Java ä¸»æµå·¥å·å\n\n * apache.commons\n   * commons-lang\n   * commons-collections\n   * common-io\n * guava",normalizedContent:"# ç»è¯´ java ä¸»æµå·¥å·å\n\n * apache.commons\n   * commons-lang\n   * commons-collections\n   * common-io\n * guava",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Reflections å¿«éå¥é¨",frontmatter:{title:"Reflections å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","åå°","Reflections"],abbrlink:"3e51d2b2",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/ea4914/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/03.Reflections.html",relativePath:"12.å·¥å·/99.å¶ä»/03.Reflections.md",key:"v-65004ca6",path:"/pages/ea4914/",headers:[{level:2,title:"ä½¿ç¨",slug:"ä½¿ç¨",normalizedTitle:"ä½¿ç¨",charIndex:403},{level:2,title:"ReflectionUtils",slug:"reflectionutils",normalizedTitle:"reflectionutils",charIndex:2194}],headersStr:"ä½¿ç¨ ReflectionUtils",content:'# Reflections å¿«éå¥é¨\n\nå¼å¥ pom\n\n<dependency>\n    <groupId>org.reflections</groupId>\n    <artifactId>reflections</artifactId>\n    <version>0.9.11</version>\n</dependency>\n\n\nå¸ååºç¨\n\nReflections reflections = new Reflections("my.project");\nSet<Class<? extends SomeType>> subTypes = reflections.getSubTypesOf(SomeType.class);\nSet<Class<?>> annotated = reflections.getTypesAnnotatedWith(SomeAnnotation.class);\n\n\n\n# ä½¿ç¨\n\nåºæ¬ä¸ï¼ä½¿ç¨ Reflections é¦åä½¿ç¨ urls å scanners å¯¹å¶è¿è¡å®ä¾å\n\n//scan urls that contain \'my.package\', include inputs starting with \'my.package\', use the default scanners\nReflections reflections = new Reflections("my.package");\n\n//or using ConfigurationBuilder\nnew Reflections(new ConfigurationBuilder()\n     .setUrls(ClasspathHelper.forPackage("my.project.prefix"))\n     .setScanners(new SubTypesScanner(),\n                  new TypeAnnotationsScanner().filterResultsBy(optionalFilter), ...),\n     .filterInputsBy(new FilterBuilder().includePackage("my.project.prefix"))\n     ...);\n\n\nç¶åï¼ä½¿ç¨æ¹ä¾¿çæ¥è¯¢æ¹æ³\n\n// å­ç±»åæ«æ\nSet<Class<? extends Module>> modules =\n    reflections.getSubTypesOf(com.google.inject.Module.class);\n// ç±»åæ³¨è§£æ«æ\nSet<Class<?>> singletons =\n    reflections.getTypesAnnotatedWith(javax.inject.Singleton.class);\n// èµæºæ«æ\nSet<String> properties =\n    reflections.getResources(Pattern.compile(".*\\\\.properties"));\n// æ¹æ³æ³¨è§£æ«æ\nSet<Method> resources =\n    reflections.getMethodsAnnotatedWith(javax.ws.rs.Path.class);\nSet<Constructor> injectables =\n    reflections.getConstructorsAnnotatedWith(javax.inject.Inject.class);\n// å­æ®µæ³¨è§£æ«æ\nSet<Field> ids =\n    reflections.getFieldsAnnotatedWith(javax.persistence.Id.class);\n// æ¹æ³åæ°æ«æ\nSet<Method> someMethods =\n    reflections.getMethodsMatchParams(long.class, int.class);\nSet<Method> voidMethods =\n    reflections.getMethodsReturn(void.class);\nSet<Method> pathParamMethods =\n    reflections.getMethodsWithAnyParamAnnotated(PathParam.class);\n// æ¹æ³åæ°åæ«æ\nList<String> parameterNames =\n    reflections.getMethodParamNames(Method.class)\n// æ¹æ³ä½¿ç¨æ«æ\nSet<Member> usages =\n    reflections.getMethodUsages(Method.class)\n\n\nè¯´æï¼\n\n * å¦ææªéç½®æ«æç¨åºï¼åå°ä½¿ç¨é»è®¤å¼ - SubTypesScanner å TypeAnnotationsScannerã\n * è¿å¯ä»¥éç½®ç±»å è½½å¨ï¼å®å°ç¨äºä»åç§°ä¸­è§£æè¿è¡æ¶ç±»ã\n * Reflection é»è®¤æåµä¸ä¼æ©å±è¶ç±»åã è¿è§£å³äºä¼ è¾ URL ä¸è¢«æ«æçä¸äºé®é¢ã\n\n\n# ReflectionUtils\n\nimport static org.reflections.ReflectionUtils.*;\n\nSet<Method> getters = getAllMethods(someClass,\n  withModifier(Modifier.PUBLIC), withPrefix("get"), withParametersCount(0));\n\n//or\nSet<Method> listMethodsFromCollectionToBoolean =\n  getAllMethods(List.class,\n    withParametersAssignableTo(Collection.class), withReturnType(boolean.class));\n\nSet<Field> fields = getAllFields(SomeClass.class, withAnnotation(annotation), withTypeAssignableTo(type));\n',normalizedContent:'# reflections å¿«éå¥é¨\n\nå¼å¥ pom\n\n<dependency>\n    <groupid>org.reflections</groupid>\n    <artifactid>reflections</artifactid>\n    <version>0.9.11</version>\n</dependency>\n\n\nå¸ååºç¨\n\nreflections reflections = new reflections("my.project");\nset<class<? extends sometype>> subtypes = reflections.getsubtypesof(sometype.class);\nset<class<?>> annotated = reflections.gettypesannotatedwith(someannotation.class);\n\n\n\n# ä½¿ç¨\n\nåºæ¬ä¸ï¼ä½¿ç¨ reflections é¦åä½¿ç¨ urls å scanners å¯¹å¶è¿è¡å®ä¾å\n\n//scan urls that contain \'my.package\', include inputs starting with \'my.package\', use the default scanners\nreflections reflections = new reflections("my.package");\n\n//or using configurationbuilder\nnew reflections(new configurationbuilder()\n     .seturls(classpathhelper.forpackage("my.project.prefix"))\n     .setscanners(new subtypesscanner(),\n                  new typeannotationsscanner().filterresultsby(optionalfilter), ...),\n     .filterinputsby(new filterbuilder().includepackage("my.project.prefix"))\n     ...);\n\n\nç¶åï¼ä½¿ç¨æ¹ä¾¿çæ¥è¯¢æ¹æ³\n\n// å­ç±»åæ«æ\nset<class<? extends module>> modules =\n    reflections.getsubtypesof(com.google.inject.module.class);\n// ç±»åæ³¨è§£æ«æ\nset<class<?>> singletons =\n    reflections.gettypesannotatedwith(javax.inject.singleton.class);\n// èµæºæ«æ\nset<string> properties =\n    reflections.getresources(pattern.compile(".*\\\\.properties"));\n// æ¹æ³æ³¨è§£æ«æ\nset<method> resources =\n    reflections.getmethodsannotatedwith(javax.ws.rs.path.class);\nset<constructor> injectables =\n    reflections.getconstructorsannotatedwith(javax.inject.inject.class);\n// å­æ®µæ³¨è§£æ«æ\nset<field> ids =\n    reflections.getfieldsannotatedwith(javax.persistence.id.class);\n// æ¹æ³åæ°æ«æ\nset<method> somemethods =\n    reflections.getmethodsmatchparams(long.class, int.class);\nset<method> voidmethods =\n    reflections.getmethodsreturn(void.class);\nset<method> pathparammethods =\n    reflections.getmethodswithanyparamannotated(pathparam.class);\n// æ¹æ³åæ°åæ«æ\nlist<string> parameternames =\n    reflections.getmethodparamnames(method.class)\n// æ¹æ³ä½¿ç¨æ«æ\nset<member> usages =\n    reflections.getmethodusages(method.class)\n\n\nè¯´æï¼\n\n * å¦ææªéç½®æ«æç¨åºï¼åå°ä½¿ç¨é»è®¤å¼ - subtypesscanner å typeannotationsscannerã\n * è¿å¯ä»¥éç½®ç±»å è½½å¨ï¼å®å°ç¨äºä»åç§°ä¸­è§£æè¿è¡æ¶ç±»ã\n * reflection é»è®¤æåµä¸ä¼æ©å±è¶ç±»åã è¿è§£å³äºä¼ è¾ url ä¸è¢«æ«æçä¸äºé®é¢ã\n\n\n# reflectionutils\n\nimport static org.reflections.reflectionutils.*;\n\nset<method> getters = getallmethods(someclass,\n  withmodifier(modifier.public), withprefix("get"), withparameterscount(0));\n\n//or\nset<method> listmethodsfromcollectiontoboolean =\n  getallmethods(list.class,\n    withparametersassignableto(collection.class), withreturntype(boolean.class));\n\nset<field> fields = getallfields(someclass.class, withannotation(annotation), withtypeassignableto(type));\n',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"JavaMail å¿«éå¥é¨",frontmatter:{title:"JavaMail å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","é®ä»¶"],abbrlink:"83e73e",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/da3f07/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/04.JavaMail.html",relativePath:"12.å·¥å·/99.å¶ä»/04.JavaMail.md",key:"v-35c0dec5",path:"/pages/da3f07/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:20},{level:3,title:"é®ä»¶ç¸å³çæ å",slug:"é®ä»¶ç¸å³çæ å",normalizedTitle:"é®ä»¶ç¸å³çæ å",charIndex:27},{level:3,title:"JavaMail ç®ä»",slug:"javamail-ç®ä»",normalizedTitle:"javamail ç®ä»",charIndex:458},{level:3,title:"é®ä»¶ä¼ è¾è¿ç¨",slug:"é®ä»¶ä¼ è¾è¿ç¨",normalizedTitle:"é®ä»¶ä¼ è¾è¿ç¨",charIndex:780},{level:3,title:"Message ç»æ",slug:"message-ç»æ",normalizedTitle:"message ç»æ",charIndex:1016},{level:2,title:"JavaMail çæ ¸å¿ç±»",slug:"javamail-çæ ¸å¿ç±»",normalizedTitle:"javamail çæ ¸å¿ç±»",charIndex:1144},{level:3,title:"java.util.Properties ç±»ï¼å±æ§å¯¹è±¡ï¼",slug:"java-util-properties-ç±»-å±æ§å¯¹è±¡",normalizedTitle:"java.util.properties ç±»ï¼å±æ§å¯¹è±¡ï¼",charIndex:1232},{level:3,title:"javax.mail.Session ç±»ï¼ä¼è¯å¯¹è±¡ï¼",slug:"javax-mail-session-ç±»-ä¼è¯å¯¹è±¡",normalizedTitle:"javax.mail.session ç±»ï¼ä¼è¯å¯¹è±¡ï¼",charIndex:2117},{level:3,title:"javax.mail.Transport ç±»ï¼é®ä»¶ä¼ è¾ï¼",slug:"javax-mail-transport-ç±»-é®ä»¶ä¼ è¾",normalizedTitle:"javax.mail.transport ç±»ï¼é®ä»¶ä¼ è¾ï¼",charIndex:2597},{level:3,title:"javax.mail.Store ç±»ï¼é®ä»¶å­å¨ ï¼",slug:"javax-mail-store-ç±»-é®ä»¶å­å¨",normalizedTitle:"javax.mail.store ç±»ï¼é®ä»¶å­å¨ ï¼",charIndex:3011},{level:3,title:"javax.mail.Message ç±»ï¼æ¶æ¯å¯¹è±¡ï¼",slug:"javax-mail-message-ç±»-æ¶æ¯å¯¹è±¡",normalizedTitle:"javax.mail.message ç±»ï¼æ¶æ¯å¯¹è±¡ï¼",charIndex:3292},{level:3,title:"javax.mail.Address ç±»ï¼å°åï¼",slug:"javax-mail-address-ç±»-å°å",normalizedTitle:"javax.mail.address ç±»ï¼å°åï¼",charIndex:3840},{level:3,title:"Authenticator ç±»ï¼è®¤è¯èï¼",slug:"authenticator-ç±»-è®¤è¯è",normalizedTitle:"authenticator ç±»ï¼è®¤è¯èï¼",charIndex:4102},{level:2,title:"å®ä¾",slug:"å®ä¾",normalizedTitle:"å®ä¾",charIndex:2301},{level:3,title:"åéææ¬é®ä»¶",slug:"åéææ¬é®ä»¶",normalizedTitle:"åéææ¬é®ä»¶",charIndex:4759},{level:3,title:"åé HTML æ ¼å¼çé®ä»¶",slug:"åé-html-æ ¼å¼çé®ä»¶",normalizedTitle:"åé html æ ¼å¼çé®ä»¶",charIndex:5899},{level:3,title:"åéå¸¦éä»¶çé®ä»¶",slug:"åéå¸¦éä»¶çé®ä»¶",normalizedTitle:"åéå¸¦éä»¶çé®ä»¶",charIndex:7594},{level:3,title:"è·åé®ç®±ä¸­çé®ä»¶",slug:"è·åé®ç®±ä¸­çé®ä»¶",normalizedTitle:"è·åé®ç®±ä¸­çé®ä»¶",charIndex:9240},{level:3,title:"è½¬åé®ä»¶",slug:"è½¬åé®ä»¶",normalizedTitle:"è½¬åé®ä»¶",charIndex:10289}],headersStr:"ç®ä» é®ä»¶ç¸å³çæ å JavaMail ç®ä» é®ä»¶ä¼ è¾è¿ç¨ Message ç»æ JavaMail çæ ¸å¿ç±» java.util.Properties ç±»ï¼å±æ§å¯¹è±¡ï¼ javax.mail.Session ç±»ï¼ä¼è¯å¯¹è±¡ï¼ javax.mail.Transport ç±»ï¼é®ä»¶ä¼ è¾ï¼ javax.mail.Store ç±»ï¼é®ä»¶å­å¨ ï¼ javax.mail.Message ç±»ï¼æ¶æ¯å¯¹è±¡ï¼ javax.mail.Address ç±»ï¼å°åï¼ Authenticator ç±»ï¼è®¤è¯èï¼ å®ä¾ åéææ¬é®ä»¶ åé HTML æ ¼å¼çé®ä»¶ åéå¸¦éä»¶çé®ä»¶ è·åé®ç®±ä¸­çé®ä»¶ è½¬åé®ä»¶",content:'# JavaMail å¿«éå¥é¨\n\n\n# ç®ä»\n\n\n# é®ä»¶ç¸å³çæ å\n\nååææä¾ç JavaMail æå¡ç¨åºå¯ä»¥æéæ©å°å®ç°æäºé®ä»¶åè®®ï¼å¸¸è§çé®ä»¶åè®®åæ¬ï¼\n\n * SMTP(Simple Mail Transfer Protocol) ï¼å³ç®åé®ä»¶ä¼ è¾åè®®ï¼å®æ¯ä¸ç»ç¨äºç±æºå°åå°ç®çå°åä¼ éé®ä»¶çè§åï¼ç±å®æ¥æ§å¶ä¿¡ä»¶çä¸­è½¬æ¹å¼ã\n * POP3(Post Office Protocol - Version 3) ï¼å³é®å±åè®®çæ¬ 3 ï¼ç¨äºæ¥æ¶çµå­é®ä»¶çæ ååè®®ã\n * IMAP(Internet Mail Access Protocol) ï¼å³ Internet é®ä»¶è®¿é®åè®®ãæ¯ POP3 çæ¿ä»£åè®®ã\n\nè¿ä¸ç§åè®®é½æå¯¹åº SSL å å¯ä¼ è¾çåè®®ï¼åå«æ¯ SMTPSï¼ POP3Så IMAPSã\n\nMIME(Multipurpose Internet Mail Extensions) ï¼å³å¤ç¨éå ç¹ç½é®ä»¶æ©å±æ åãå®ä¸æ¯é®ä»¶ä¼ è¾åè®®ãä½å¯¹ä¼ è¾åå®¹çæ¶æ¯ãéä»¶åå¶å®çåå®¹å®ä¹äºæ ¼å¼ã\n\n\n# JavaMail ç®ä»\n\nJavaMail æ¯ç± Sun åå¸çç¨æ¥å¤ç email ç API ãå®å¹¶æ²¡æåå«å¨ Java SE ä¸­ï¼èæ¯ä½ä¸º Java EE çä¸é¨åã\n\n * mail.jar ï¼æ­¤ JAR æä»¶åå« JavaMail API å Sun æä¾ç SMTP ã IMAP å POP3 æå¡æä¾ç¨åºï¼\n * activation.jar ï¼æ­¤ JAR æä»¶åå« JAF API å Sun çå®ç°ã\n\nJavaMail åä¸­ç¨äºå¤ççµå­é®ä»¶çæ ¸å¿ç±»æ¯ï¼ Properties ã Session ã Message ã Address ã Authenticator ã Transport ã Store ç­ã\n\n\n# é®ä»¶ä¼ è¾è¿ç¨\n\nå¦ä¸å¾ï¼çµå­é®ä»¶çå¤çæ­¥éª¤å¦ä¸ï¼\n\n 1. åå»ºä¸ä¸ª Session å¯¹è±¡ã\n 2. Session å¯¹è±¡åå»ºä¸ä¸ª Transport å¯¹è±¡ /Store å¯¹è±¡ï¼ç¨æ¥åé / ä¿å­é®ä»¶ã\n 3. Transport å¯¹è±¡ /Store å¯¹è±¡è¿æ¥é®ä»¶æå¡å¨ã\n 4. Transport å¯¹è±¡ /Store å¯¹è±¡åå»ºä¸ä¸ª Message å¯¹è±¡ ( ä¹å°±æ¯é®ä»¶åå®¹ ) ã\n 5. Transport å¯¹è±¡åéé®ä»¶ï¼ Store å¯¹è±¡è·åé®ç®±çé®ä»¶ã\n\n\n# Message ç»æ\n\n * MimeMessage ç±»ï¼ä»£è¡¨æ´å°é®ä»¶ã\n * MimeBodyPart ç±»ï¼ä»£è¡¨é®ä»¶çä¸ä¸ª MIME ä¿¡æ¯ã\n * MimeMultipart ç±»ï¼ä»£è¡¨ä¸ä¸ªç±å¤ä¸ª MIME ä¿¡æ¯ç»åæçç»å MIME ä¿¡æ¯ã\n\n\n\n\n# JavaMail çæ ¸å¿ç±»\n\nJavaMail å¯¹æ¶åé®ä»¶è¿è¡äºé«çº§çæ½è±¡ï¼å½¢æäºä¸äºå³é®ççæ¥å£åç±»ï¼å®ä»¬ææäºç¨åºçåºç¡ï¼ä¸é¢æä»¬åå«æ¥äºè§£ä¸ä¸è¿äºæå¸¸è§çå¯¹è±¡ã\n\n\n# java.util.Properties ç±»ï¼å±æ§å¯¹è±¡ï¼\n\njava.util.Properties ç±»ä»£è¡¨ä¸ç»å±æ§éåã\n\nå®çæ¯ä¸ä¸ªé®åå¼é½æ¯ String ç±»åã\n\nç±äº JavaMail éè¦åé®ä»¶æå¡å¨è¿è¡éä¿¡ï¼è¿å°±è¦æ±ç¨åºæä¾è®¸å¤è¯¸å¦æå¡å¨å°åãç«¯å£ãç¨æ·åãå¯ç ç­ä¿¡æ¯ï¼ JavaMail éè¿ Properties å¯¹è±¡å°è£è¿äºå±æ§ä¿¡æ¯ã\n\nä¾ï¼ å¦ä¸é¢çä»£ç å°è£äºå ä¸ªå±æ§ä¿¡æ¯ï¼\n\nProperties prop = new Properties();\nprop.setProperty("mail.debug", "true");\nprop.setProperty("mail.host", "[email protected]");\nprop.setProperty("mail.transport.protocol", "smtp");\nprop.setProperty("mail.smtp.auth", "true");\n\n\néå¯¹ä¸åççé®ä»¶åè®®ï¼ JavaMail è§å®äºæå¡æä¾èå¿é¡»æ¯æä¸ç³»åå±æ§ï¼\n\nä¸è¡¨æ¯ä¸äºå¸¸è§å±æ§ï¼å±æ§å¼é½ä»¥ String ç±»åè¿è¡è®¾ç½®ï¼å±æ§ç±»åæ ä»è¡¨ç¤ºå±æ§æ¯å¦ä½è¢«è§£æçï¼ï¼\n\nå³é®è¯                       ç±»å        æè¿°\nmail.debug                boolean   debug å¼å³ã\nmail.host                 String    æå®åéãæ¥æ¶é®ä»¶çé»è®¤é®ç®±æå¡å¨ã\nmail.store.protocol       String    æå®æ¥æ¶é®ä»¶çåè®®ã\nmail.transport.protocol   String    æå®åéé®ä»¶çåè®®ã\nmail.debug.auth           boolean   debug è¾åºä¸­æ¯å¦åå«è®¤è¯å½ä»¤ãé»è®¤æ¯ false ã\n\nè¯¦æè¯·åèå®æ¹ API ææ¡£ï¼\n\nhttps://javamail.java.net/nonav/docs/api/ ã\n\n\n# javax.mail.Session ç±»ï¼ä¼è¯å¯¹è±¡ï¼\n\nSession è¡¨ç¤ºä¸ä¸ªé®ä»¶ä¼è¯ã\n\nSession çä¸»è¦ä½ç¨åæ¬ä¸¤ä¸ªæ¹é¢ï¼\n\n * æ¥æ¶åç§éç½®å±æ§ä¿¡æ¯ï¼éè¿ Properties å¯¹è±¡è®¾ç½®çå±æ§ä¿¡æ¯ï¼\n * åå§å JavaMail ç¯å¢ï¼æ ¹æ® JavaMail çéç½®æä»¶ï¼åå§å JavaMail ç¯å¢ï¼ä»¥ä¾¿éè¿ Session å¯¹è±¡åå»ºå¶ä»éè¦ç±»çå®ä¾ã\n\nJavaMail å¨ Jar åç META-INF ç®å½ä¸ï¼éè¿ä»¥ä¸æä»¶æä¾äºåºæ¬éç½®ä¿¡æ¯ï¼ä»¥ä¾¿ session è½å¤æ ¹æ®è¿ä¸ªéç½®æä»¶å è½½æä¾èçå®ç°ç±»ï¼\n\n * javamail.default.providers\n * javamail.default.address.map\n\n\n\nä¾ï¼\n\nProperties props = new Properties();\nprops.setProperty("mail.transport.protocol", "smtp");\nSession session = Session.getInstance(props);\n\n\n\n# javax.mail.Transport ç±»ï¼é®ä»¶ä¼ è¾ï¼\n\né®ä»¶æä½åªæåéææ¥æ¶ä¸¤ç§å¤çæ¹å¼ã\n\nJavaMail å°è¿ä¸¤ç§ä¸åæä½æè¿°ä¸ºä¼ è¾ï¼ javax.mail.Transport ï¼åå­å¨ï¼ javax.mail.Store ï¼ï¼ä¼ è¾å¯¹åºé®ä»¶çåéï¼èå­å¨å¯¹åºé®ä»¶çæ¥æ¶ã\n\n * getTransport - Session ç±»ä¸­ç **getTransport()**æå¤ä¸ªéè½½æ¹æ³ï¼å¯ä»¥ç¨æ¥åå»º Transport å¯¹è±¡ã\n * connect - å¦æè®¾ç½®äºè®¤è¯å½ä»¤ââ mail.smtp.auth ï¼é£ä¹ä½¿ç¨ Transport ç±»ç connect æ¹æ³è¿æ¥æå¡å¨æ¶ï¼åå¿é¡»å ä¸ç¨æ·ååå¯ç ã\n * sendMessage - Transport ç±»ç sendMessage æ¹æ³ç¨æ¥åéé®ä»¶æ¶æ¯ã\n * close - Transport ç±»ç close æ¹æ³ç¨æ¥å³é­åé®ä»¶æå¡å¨çè¿æ¥ã\n\n\n# javax.mail.Store ç±»ï¼é®ä»¶å­å¨ ï¼\n\n * getStore - Session ç±»ä¸­ç getStore () æå¤ä¸ªéè½½æ¹æ³ï¼å¯ä»¥ç¨æ¥åå»º Store å¯¹è±¡ã\n * connect - å¦æè®¾ç½®äºè®¤è¯å½ä»¤ââ mail.smtp.auth ï¼é£ä¹ä½¿ç¨ Store ç±»ç connect æ¹æ³è¿æ¥æå¡å¨æ¶ï¼åå¿é¡»å ä¸ç¨æ·ååå¯ç ã\n * getFolder - Store ç±»ç getFolder æ¹æ³å¯ä»¥ è·åé®ç®±åçé®ä»¶å¤¹ Folder å¯¹è±¡\n * close - Store ç±»ç close æ¹æ³ç¨æ¥å³é­åé®ä»¶æå¡å¨çè¿æ¥ã\n\n\n# javax.mail.Message ç±»ï¼æ¶æ¯å¯¹è±¡ï¼\n\n * javax.mail.Message - æ¯ä¸ªæ½è±¡ç±»ï¼åªè½ç¨å­ç±»å»å®ä¾åï¼å¤æ°æåµä¸ä¸º javax.mail.internet.MimeMessageã\n * MimeMessage - ä»£è¡¨ MIME ç±»åççµå­é®ä»¶æ¶æ¯ã\n\nè¦åå»ºä¸ä¸ª Message ï¼éè¦å° Session å¯¹è±¡ä¼ éç» MimeMessage æé å¨ï¼\n\nMimeMessage message = new MimeMessage(session);\n\n\næ³¨æï¼è¿å­å¨å¶å®æé å¨ï¼å¦ç¨æ RFC822 æ ¼å¼çè¾å¥æµæ¥åå»ºæ¶æ¯ã\n\n * setFrom - è®¾ç½®é®ä»¶çåä»¶äºº\n * setRecipient - è®¾ç½®é®ä»¶çåéäººãæéäººãå¯éäºº\n\nä¸ç§é¢å®ä¹çå°åç±»åæ¯ï¼\n\n * Message.RecipientType.TO - æ¶ä»¶äºº\n * Message.RecipientType.CC - æéäºº\n * Message.RecipientType.BCC - å¯éäºº\n * setSubject - è®¾ç½®é®ä»¶çä¸»é¢\n * setContent - è®¾ç½®é®ä»¶åå®¹\n * setText - å¦æé®ä»¶åå®¹æ¯çº¯ææ¬ï¼å¯ä»¥ä½¿ç¨æ­¤æ¥å£è®¾ç½®ææ¬åå®¹ã\n\n\n# javax.mail.Address ç±»ï¼å°åï¼\n\nä¸æ¦æ¨åå»ºäº Session å Message ï¼å¹¶å°åå®¹å¡«å¥æ¶æ¯åï¼å°±å¯ä»¥ç¨ Address ç¡®å®ä¿¡ä»¶å°åäºãå Message ä¸æ ·ï¼ Address ä¹æ¯ä¸ªæ½è±¡ç±»ãæ¨ç¨çæ¯ javax.mail.internet.InternetAddress ç±»ã\n\nè¥åå»ºçå°ååªåå«çµå­é®ä»¶å°åï¼åªè¦ä¼ éçµå­é®ä»¶å°åå°æé å¨å°±è¡äºã\n\nä¾ï¼\n\nAddress address = new InternetAddress("[email protected]");\n\n\n\n# Authenticator ç±»ï¼è®¤è¯èï¼\n\nä¸ java.net ç±»ä¸æ ·ï¼ JavaMail API ä¹å¯ä»¥å©ç¨ Authenticator éè¿ç¨æ·ååå¯ç è®¿é®åä¿æ¤çèµæºãå¯¹äº JavaMail API æ¥è¯´ï¼è¿äºèµæºå°±æ¯é®ä»¶æå¡å¨ãAuthenticator å¨ javax.mail åä¸­ï¼èä¸å®å java.net ä¸­ååçç±» Authenticator ä¸åãä¸¤èå¹¶ä¸å±äº«åä¸ä¸ª Authenticator ï¼å ä¸º JavaMail API ç¨äº Java 1.1 ï¼å®æ²¡æ java.net ç±»å«ã\n\nè¦ä½¿ç¨ Authenticator ï¼ååå»ºä¸ä¸ªæ½è±¡ç±»çå­ç±»ï¼å¹¶ä» getPasswordAuthentication() æ¹æ³ä¸­è¿å PasswordAuthentication å®ä¾ãåå»ºå®æåï¼æ¨å¿éå session æ³¨å Authenticator ãç¶åï¼å¨éè¦è®¤è¯çæ¶åï¼å°±ä¼éç¥ Authenticator ãæ¨å¯ä»¥å¼¹åºçªå£ï¼ä¹å¯ä»¥ä»éç½®æä»¶ä¸­ï¼è½ç¶æ²¡æå å¯æ¯ä¸å®å¨çï¼è¯»åç¨æ·ååå¯ç ï¼å°å®ä»¬ä½ä¸º PasswordAuthentication å¯¹è±¡è¿åç»è°ç¨ç¨åºã\n\nä¾ï¼\n\nProperties props = new Properties();\nAuthenticator auth = new MyAuthenticator();\nSession session = Session.getDefaultInstance(props, auth);\n\n\n\n# å®ä¾\n\n\n# åéææ¬é®ä»¶\n\npublic static void main(String[] args) throws Exception {\n    Properties prop = new Properties();\n    prop.setProperty("mail.debug", "true");\n    prop.setProperty("mail.host", MAIL_SERVER_HOST);\n    prop.setProperty("mail.transport.protocol", "smtp");\n    prop.setProperty("mail.smtp.auth", "true");\n\n    // 1ãåå»ºsession\n    Session session = Session.getInstance(prop);\n    Transport ts = null;\n\n    // 2ãéè¿sessionå¾å°transportå¯¹è±¡\n    ts = session.getTransport();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    ts.connect(MAIL_SERVER_HOST, USER, PASSWORD);\n\n    // 4ãåå»ºé®ä»¶\n    MimeMessage message = new MimeMessage(session);\n\n    // é®ä»¶æ¶æ¯å¤´\n    message.setFrom(new InternetAddress(MAIL_FROM)); // é®ä»¶çåä»¶äºº\n    message.setRecipient(Message.RecipientType.TO, new InternetAddress(MAIL_TO)); // é®ä»¶çæ¶ä»¶äºº\n    message.setRecipient(Message.RecipientType.CC, new InternetAddress(MAIL_CC)); // é®ä»¶çæéäºº\n    message.setRecipient(Message.RecipientType.BCC, new InternetAddress(MAIL_BCC)); // é®ä»¶çå¯éäºº\n    message.setSubject("æµè¯ææ¬é®ä»¶"); // é®ä»¶çæ é¢\n\n    // é®ä»¶æ¶æ¯ä½\n    message.setText("å¤©ä¸æ åã");\n\n    // 5ãåéé®ä»¶\n    ts.sendMessage(message, message.getAllRecipients());\n    ts.close();\n}\n\n\n\n# åé HTML æ ¼å¼çé®ä»¶\n\npublic static void main(String[] args) throws Exception {\n    Properties prop = new Properties();\n    prop.setProperty("mail.debug", "true");\n    prop.setProperty("mail.host", MAIL_SERVER_HOST);\n    prop.setProperty("mail.transport.protocol", "smtp");\n    prop.setProperty("mail.smtp.auth", "true");\n\n    // 1ãåå»ºsession\n    Session session = Session.getInstance(prop);\n    Transport ts = null;\n\n    // 2ãéè¿sessionå¾å°transportå¯¹è±¡\n    ts = session.getTransport();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    ts.connect(MAIL_SERVER_HOST, USER, PASSWORD);\n\n    // 4ãåå»ºé®ä»¶\n    MimeMessage message = new MimeMessage(session);\n\n    // é®ä»¶æ¶æ¯å¤´\n    message.setFrom(new InternetAddress(MAIL_FROM)); // é®ä»¶çåä»¶äºº\n    message.setRecipient(Message.RecipientType.TO, new InternetAddress(MAIL_TO)); // é®ä»¶çæ¶ä»¶äºº\n    message.setRecipient(Message.RecipientType.CC, new InternetAddress(MAIL_CC)); // é®ä»¶çæéäºº\n    message.setRecipient(Message.RecipientType.BCC, new InternetAddress(MAIL_BCC)); // é®ä»¶çå¯éäºº\n    message.setSubject("æµè¯HTMLé®ä»¶"); // é®ä»¶çæ é¢\n\n    String htmlContent = "<h1>Hello</h1>" + "<p>æ¾ç¤ºå¾ç<img src=\'cid:abc.jpg\'>1.jpg</p>";\n    MimeBodyPart text = new MimeBodyPart();\n    text.setContent(htmlContent, "text/html;charset=UTF-8");\n    MimeBodyPart image = new MimeBodyPart();\n    DataHandler dh = new DataHandler(new FileDataSource("D:\\\\05_Datas\\\\å¾åº\\\\åä»å°å¹´èå½±.png"));\n    image.setDataHandler(dh);\n    image.setContentID("abc.jpg");\n\n    // æè¿°æ°æ®å³ç³»\n    MimeMultipart mm = new MimeMultipart();\n    mm.addBodyPart(text);\n    mm.addBodyPart(image);\n    mm.setSubType("related");\n    message.setContent(mm);\n    message.saveChanges();\n\n    // 5ãåéé®ä»¶\n    ts.sendMessage(message, message.getAllRecipients());\n    ts.close();\n}\n\n\n\n# åéå¸¦éä»¶çé®ä»¶\n\npublic static void main(String[] args) throws Exception {\n    Properties prop = new Properties();\n    prop.setProperty("mail.debug", "true");\n    prop.setProperty("mail.host", MAIL_SERVER_HOST);\n    prop.setProperty("mail.transport.protocol", "smtp");\n    prop.setProperty("mail.smtp.auth", "true");\n\n    // 1ãåå»ºsession\n    Session session = Session.getInstance(prop);\n\n    // 2ãéè¿sessionå¾å°transportå¯¹è±¡\n    Transport ts = session.getTransport();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    ts.connect(MAIL_SERVER_HOST, USER, PASSWORD);\n\n    // 4ãåå»ºé®ä»¶\n    MimeMessage message = new MimeMessage(session);\n\n    // é®ä»¶æ¶æ¯å¤´\n    message.setFrom(new InternetAddress(MAIL_FROM)); // é®ä»¶çåä»¶äºº\n    message.setRecipient(Message.RecipientType.TO, new InternetAddress(MAIL_TO)); // é®ä»¶çæ¶ä»¶äºº\n    message.setRecipient(Message.RecipientType.CC, new InternetAddress(MAIL_CC)); // é®ä»¶çæéäºº\n    message.setRecipient(Message.RecipientType.BCC, new InternetAddress(MAIL_BCC)); // é®ä»¶çå¯éäºº\n    message.setSubject("æµè¯å¸¦éä»¶é®ä»¶"); // é®ä»¶çæ é¢\n\n    MimeBodyPart text = new MimeBodyPart();\n    text.setContent("é®ä»¶ä¸­æä¸¤ä¸ªéä»¶ã", "text/html;charset=UTF-8");\n\n    // æè¿°æ°æ®å³ç³»\n    MimeMultipart mm = new MimeMultipart();\n    mm.setSubType("related");\n    mm.addBodyPart(text);\n    String[] files = {\n            "D:\\\\00_Temp\\\\temp\\\\1.jpg", "D:\\\\00_Temp\\\\temp\\\\2.png"\n    };\n\n    // æ·»å é®ä»¶éä»¶\n    for (String filename : files) {\n        MimeBodyPart attachPart = new MimeBodyPart();\n        attachPart.attachFile(filename);\n        mm.addBodyPart(attachPart);\n    }\n\n    message.setContent(mm);\n    message.saveChanges();\n\n    // 5ãåéé®ä»¶\n    ts.sendMessage(message, message.getAllRecipients());\n    ts.close();\n}\n\n\n\n# è·åé®ç®±ä¸­çé®ä»¶\n\n public static void main(String[] args) throws Exception {\n\n    // åå»ºä¸ä¸ªæå·ä½è¿æ¥ä¿¡æ¯çPropertieså¯¹è±¡\n    Properties prop = new Properties();\n    prop.setProperty("mail.debug", "true");\n    prop.setProperty("mail.store.protocol", "pop3");\n    prop.setProperty("mail.pop3.host", MAIL_SERVER_HOST);\n\n    // 1ãåå»ºsession\n    Session session = Session.getInstance(prop);\n\n    // 2ãéè¿sessionå¾å°Storeå¯¹è±¡\n    Store store = session.getStore();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    store.connect(MAIL_SERVER_HOST, USER, PASSWORD);\n\n    // 4ãè·å¾é®ç®±åçé®ä»¶å¤¹\n    Folder folder = store.getFolder("inbox");\n    folder.open(Folder.READ_ONLY);\n\n    // è·å¾é®ä»¶å¤¹Folderåçææé®ä»¶Messageå¯¹è±¡\n    Message[] messages = folder.getMessages();\n    for (int i = 0; i < messages.length; i++) {\n        String subject = messages[i].getSubject();\n        String from = (messages[i].getFrom()[0]).toString();\n        System.out.println("ç¬¬ " + (i + 1) + "å°é®ä»¶çä¸»é¢ï¼" + subject);\n        System.out.println("ç¬¬ " + (i + 1) + "å°é®ä»¶çåä»¶äººå°åï¼" + from);\n    }\n\n    // 5ãå³é­\n    folder.close(false);\n    store.close();\n}\n\n\n\n# è½¬åé®ä»¶\n\nä¾ï¼è·åæå®é®ä»¶å¤¹ä¸çç¬¬ä¸å°é®ä»¶å¹¶è½¬å\n\n public static void main(String[] args) throws Exception {\n    Properties prop = new Properties();\n    prop.put("mail.store.protocol", "pop3");\n    prop.put("mail.pop3.host", MAIL_SERVER_POP3);\n    prop.put("mail.pop3.starttls.enable", "true");\n    prop.put("mail.smtp.auth", "true");\n    prop.put("mail.smtp.host", MAIL_SERVER_SMTP);\n\n    // 1ãåå»ºsession\n    Session session = Session.getDefaultInstance(prop);\n\n    // 2ãè¯»åé®ä»¶å¤¹\n    Store store = session.getStore("pop3");\n    store.connect(MAIL_SERVER_POP3, USER, PASSWORD);\n    Folder folder = store.getFolder("inbox");\n    folder.open(Folder.READ_ONLY);\n\n    // è·åé®ä»¶å¤¹ä¸­ç¬¬1å°é®ä»¶ä¿¡æ¯\n    Message[] messages = folder.getMessages();\n    if (messages.length <= 0) {\n        return;\n    }\n    Message message = messages[0];\n\n    // æå°é®ä»¶å³é®ä¿¡æ¯\n    String from = InternetAddress.toString(message.getFrom());\n    if (from != null) {\n        System.out.println("From: " + from);\n    }\n\n    String replyTo = InternetAddress.toString(message.getReplyTo());\n    if (replyTo != null) {\n        System.out.println("Reply-to: " + replyTo);\n    }\n\n    String to = InternetAddress.toString(message.getRecipients(Message.RecipientType.TO));\n    if (to != null) {\n        System.out.println("To: " + to);\n    }\n\n    String subject = message.getSubject();\n    if (subject != null) {\n        System.out.println("Subject: " + subject);\n    }\n\n    Date sent = message.getSentDate();\n    if (sent != null) {\n        System.out.println("Sent: " + sent);\n    }\n\n    // è®¾ç½®è½¬åé®ä»¶ä¿¡æ¯å¤´\n    Message forward = new MimeMessage(session);\n    forward.setFrom(new InternetAddress(MAIL_FROM));\n    forward.setRecipient(Message.RecipientType.TO, new InternetAddress(MAIL_TO));\n    forward.setSubject("Fwd: " + message.getSubject());\n\n    // è®¾ç½®è½¬åé®ä»¶åå®¹\n    MimeBodyPart bodyPart = new MimeBodyPart();\n    bodyPart.setContent(message, "message/rfc822");\n\n    Multipart multipart = new MimeMultipart();\n    multipart.addBodyPart(bodyPart);\n    forward.setContent(multipart);\n    forward.saveChanges();\n\n    Transport ts = session.getTransport("smtp");\n    ts.connect(USER, PASSWORD);\n    ts.sendMessage(forward, forward.getAllRecipients());\n\n    folder.close(false);\n    store.close();\n    ts.close();\n    System.out.println("message forwarded successfully....");\n}\n',normalizedContent:'# javamail å¿«éå¥é¨\n\n\n# ç®ä»\n\n\n# é®ä»¶ç¸å³çæ å\n\nååææä¾ç javamail æå¡ç¨åºå¯ä»¥æéæ©å°å®ç°æäºé®ä»¶åè®®ï¼å¸¸è§çé®ä»¶åè®®åæ¬ï¼\n\n * smtp(simple mail transfer protocol) ï¼å³ç®åé®ä»¶ä¼ è¾åè®®ï¼å®æ¯ä¸ç»ç¨äºç±æºå°åå°ç®çå°åä¼ éé®ä»¶çè§åï¼ç±å®æ¥æ§å¶ä¿¡ä»¶çä¸­è½¬æ¹å¼ã\n * pop3(post office protocol - version 3) ï¼å³é®å±åè®®çæ¬ 3 ï¼ç¨äºæ¥æ¶çµå­é®ä»¶çæ ååè®®ã\n * imap(internet mail access protocol) ï¼å³ internet é®ä»¶è®¿é®åè®®ãæ¯ pop3 çæ¿ä»£åè®®ã\n\nè¿ä¸ç§åè®®é½æå¯¹åº ssl å å¯ä¼ è¾çåè®®ï¼åå«æ¯ smtpsï¼ pop3så imapsã\n\nmime(multipurpose internet mail extensions) ï¼å³å¤ç¨éå ç¹ç½é®ä»¶æ©å±æ åãå®ä¸æ¯é®ä»¶ä¼ è¾åè®®ãä½å¯¹ä¼ è¾åå®¹çæ¶æ¯ãéä»¶åå¶å®çåå®¹å®ä¹äºæ ¼å¼ã\n\n\n# javamail ç®ä»\n\njavamail æ¯ç± sun åå¸çç¨æ¥å¤ç email ç api ãå®å¹¶æ²¡æåå«å¨ java se ä¸­ï¼èæ¯ä½ä¸º java ee çä¸é¨åã\n\n * mail.jar ï¼æ­¤ jar æä»¶åå« javamail api å sun æä¾ç smtp ã imap å pop3 æå¡æä¾ç¨åºï¼\n * activation.jar ï¼æ­¤ jar æä»¶åå« jaf api å sun çå®ç°ã\n\njavamail åä¸­ç¨äºå¤ççµå­é®ä»¶çæ ¸å¿ç±»æ¯ï¼ properties ã session ã message ã address ã authenticator ã transport ã store ç­ã\n\n\n# é®ä»¶ä¼ è¾è¿ç¨\n\nå¦ä¸å¾ï¼çµå­é®ä»¶çå¤çæ­¥éª¤å¦ä¸ï¼\n\n 1. åå»ºä¸ä¸ª session å¯¹è±¡ã\n 2. session å¯¹è±¡åå»ºä¸ä¸ª transport å¯¹è±¡ /store å¯¹è±¡ï¼ç¨æ¥åé / ä¿å­é®ä»¶ã\n 3. transport å¯¹è±¡ /store å¯¹è±¡è¿æ¥é®ä»¶æå¡å¨ã\n 4. transport å¯¹è±¡ /store å¯¹è±¡åå»ºä¸ä¸ª message å¯¹è±¡ ( ä¹å°±æ¯é®ä»¶åå®¹ ) ã\n 5. transport å¯¹è±¡åéé®ä»¶ï¼ store å¯¹è±¡è·åé®ç®±çé®ä»¶ã\n\n\n# message ç»æ\n\n * mimemessage ç±»ï¼ä»£è¡¨æ´å°é®ä»¶ã\n * mimebodypart ç±»ï¼ä»£è¡¨é®ä»¶çä¸ä¸ª mime ä¿¡æ¯ã\n * mimemultipart ç±»ï¼ä»£è¡¨ä¸ä¸ªç±å¤ä¸ª mime ä¿¡æ¯ç»åæçç»å mime ä¿¡æ¯ã\n\n\n\n\n# javamail çæ ¸å¿ç±»\n\njavamail å¯¹æ¶åé®ä»¶è¿è¡äºé«çº§çæ½è±¡ï¼å½¢æäºä¸äºå³é®ççæ¥å£åç±»ï¼å®ä»¬ææäºç¨åºçåºç¡ï¼ä¸é¢æä»¬åå«æ¥äºè§£ä¸ä¸è¿äºæå¸¸è§çå¯¹è±¡ã\n\n\n# java.util.properties ç±»ï¼å±æ§å¯¹è±¡ï¼\n\njava.util.properties ç±»ä»£è¡¨ä¸ç»å±æ§éåã\n\nå®çæ¯ä¸ä¸ªé®åå¼é½æ¯ string ç±»åã\n\nç±äº javamail éè¦åé®ä»¶æå¡å¨è¿è¡éä¿¡ï¼è¿å°±è¦æ±ç¨åºæä¾è®¸å¤è¯¸å¦æå¡å¨å°åãç«¯å£ãç¨æ·åãå¯ç ç­ä¿¡æ¯ï¼ javamail éè¿ properties å¯¹è±¡å°è£è¿äºå±æ§ä¿¡æ¯ã\n\nä¾ï¼ å¦ä¸é¢çä»£ç å°è£äºå ä¸ªå±æ§ä¿¡æ¯ï¼\n\nproperties prop = new properties();\nprop.setproperty("mail.debug", "true");\nprop.setproperty("mail.host", "[email protected]");\nprop.setproperty("mail.transport.protocol", "smtp");\nprop.setproperty("mail.smtp.auth", "true");\n\n\néå¯¹ä¸åççé®ä»¶åè®®ï¼ javamail è§å®äºæå¡æä¾èå¿é¡»æ¯æä¸ç³»åå±æ§ï¼\n\nä¸è¡¨æ¯ä¸äºå¸¸è§å±æ§ï¼å±æ§å¼é½ä»¥ string ç±»åè¿è¡è®¾ç½®ï¼å±æ§ç±»åæ ä»è¡¨ç¤ºå±æ§æ¯å¦ä½è¢«è§£æçï¼ï¼\n\nå³é®è¯                       ç±»å        æè¿°\nmail.debug                boolean   debug å¼å³ã\nmail.host                 string    æå®åéãæ¥æ¶é®ä»¶çé»è®¤é®ç®±æå¡å¨ã\nmail.store.protocol       string    æå®æ¥æ¶é®ä»¶çåè®®ã\nmail.transport.protocol   string    æå®åéé®ä»¶çåè®®ã\nmail.debug.auth           boolean   debug è¾åºä¸­æ¯å¦åå«è®¤è¯å½ä»¤ãé»è®¤æ¯ false ã\n\nè¯¦æè¯·åèå®æ¹ api ææ¡£ï¼\n\nhttps://javamail.java.net/nonav/docs/api/ ã\n\n\n# javax.mail.session ç±»ï¼ä¼è¯å¯¹è±¡ï¼\n\nsession è¡¨ç¤ºä¸ä¸ªé®ä»¶ä¼è¯ã\n\nsession çä¸»è¦ä½ç¨åæ¬ä¸¤ä¸ªæ¹é¢ï¼\n\n * æ¥æ¶åç§éç½®å±æ§ä¿¡æ¯ï¼éè¿ properties å¯¹è±¡è®¾ç½®çå±æ§ä¿¡æ¯ï¼\n * åå§å javamail ç¯å¢ï¼æ ¹æ® javamail çéç½®æä»¶ï¼åå§å javamail ç¯å¢ï¼ä»¥ä¾¿éè¿ session å¯¹è±¡åå»ºå¶ä»éè¦ç±»çå®ä¾ã\n\njavamail å¨ jar åç meta-inf ç®å½ä¸ï¼éè¿ä»¥ä¸æä»¶æä¾äºåºæ¬éç½®ä¿¡æ¯ï¼ä»¥ä¾¿ session è½å¤æ ¹æ®è¿ä¸ªéç½®æä»¶å è½½æä¾èçå®ç°ç±»ï¼\n\n * javamail.default.providers\n * javamail.default.address.map\n\n\n\nä¾ï¼\n\nproperties props = new properties();\nprops.setproperty("mail.transport.protocol", "smtp");\nsession session = session.getinstance(props);\n\n\n\n# javax.mail.transport ç±»ï¼é®ä»¶ä¼ è¾ï¼\n\né®ä»¶æä½åªæåéææ¥æ¶ä¸¤ç§å¤çæ¹å¼ã\n\njavamail å°è¿ä¸¤ç§ä¸åæä½æè¿°ä¸ºä¼ è¾ï¼ javax.mail.transport ï¼åå­å¨ï¼ javax.mail.store ï¼ï¼ä¼ è¾å¯¹åºé®ä»¶çåéï¼èå­å¨å¯¹åºé®ä»¶çæ¥æ¶ã\n\n * gettransport - session ç±»ä¸­ç **gettransport()**æå¤ä¸ªéè½½æ¹æ³ï¼å¯ä»¥ç¨æ¥åå»º transport å¯¹è±¡ã\n * connect - å¦æè®¾ç½®äºè®¤è¯å½ä»¤ââ mail.smtp.auth ï¼é£ä¹ä½¿ç¨ transport ç±»ç connect æ¹æ³è¿æ¥æå¡å¨æ¶ï¼åå¿é¡»å ä¸ç¨æ·ååå¯ç ã\n * sendmessage - transport ç±»ç sendmessage æ¹æ³ç¨æ¥åéé®ä»¶æ¶æ¯ã\n * close - transport ç±»ç close æ¹æ³ç¨æ¥å³é­åé®ä»¶æå¡å¨çè¿æ¥ã\n\n\n# javax.mail.store ç±»ï¼é®ä»¶å­å¨ ï¼\n\n * getstore - session ç±»ä¸­ç getstore () æå¤ä¸ªéè½½æ¹æ³ï¼å¯ä»¥ç¨æ¥åå»º store å¯¹è±¡ã\n * connect - å¦æè®¾ç½®äºè®¤è¯å½ä»¤ââ mail.smtp.auth ï¼é£ä¹ä½¿ç¨ store ç±»ç connect æ¹æ³è¿æ¥æå¡å¨æ¶ï¼åå¿é¡»å ä¸ç¨æ·ååå¯ç ã\n * getfolder - store ç±»ç getfolder æ¹æ³å¯ä»¥ è·åé®ç®±åçé®ä»¶å¤¹ folder å¯¹è±¡\n * close - store ç±»ç close æ¹æ³ç¨æ¥å³é­åé®ä»¶æå¡å¨çè¿æ¥ã\n\n\n# javax.mail.message ç±»ï¼æ¶æ¯å¯¹è±¡ï¼\n\n * javax.mail.message - æ¯ä¸ªæ½è±¡ç±»ï¼åªè½ç¨å­ç±»å»å®ä¾åï¼å¤æ°æåµä¸ä¸º javax.mail.internet.mimemessageã\n * mimemessage - ä»£è¡¨ mime ç±»åççµå­é®ä»¶æ¶æ¯ã\n\nè¦åå»ºä¸ä¸ª message ï¼éè¦å° session å¯¹è±¡ä¼ éç» mimemessage æé å¨ï¼\n\nmimemessage message = new mimemessage(session);\n\n\næ³¨æï¼è¿å­å¨å¶å®æé å¨ï¼å¦ç¨æ rfc822 æ ¼å¼çè¾å¥æµæ¥åå»ºæ¶æ¯ã\n\n * setfrom - è®¾ç½®é®ä»¶çåä»¶äºº\n * setrecipient - è®¾ç½®é®ä»¶çåéäººãæéäººãå¯éäºº\n\nä¸ç§é¢å®ä¹çå°åç±»åæ¯ï¼\n\n * message.recipienttype.to - æ¶ä»¶äºº\n * message.recipienttype.cc - æéäºº\n * message.recipienttype.bcc - å¯éäºº\n * setsubject - è®¾ç½®é®ä»¶çä¸»é¢\n * setcontent - è®¾ç½®é®ä»¶åå®¹\n * settext - å¦æé®ä»¶åå®¹æ¯çº¯ææ¬ï¼å¯ä»¥ä½¿ç¨æ­¤æ¥å£è®¾ç½®ææ¬åå®¹ã\n\n\n# javax.mail.address ç±»ï¼å°åï¼\n\nä¸æ¦æ¨åå»ºäº session å message ï¼å¹¶å°åå®¹å¡«å¥æ¶æ¯åï¼å°±å¯ä»¥ç¨ address ç¡®å®ä¿¡ä»¶å°åäºãå message ä¸æ ·ï¼ address ä¹æ¯ä¸ªæ½è±¡ç±»ãæ¨ç¨çæ¯ javax.mail.internet.internetaddress ç±»ã\n\nè¥åå»ºçå°ååªåå«çµå­é®ä»¶å°åï¼åªè¦ä¼ éçµå­é®ä»¶å°åå°æé å¨å°±è¡äºã\n\nä¾ï¼\n\naddress address = new internetaddress("[email protected]");\n\n\n\n# authenticator ç±»ï¼è®¤è¯èï¼\n\nä¸ java.net ç±»ä¸æ ·ï¼ javamail api ä¹å¯ä»¥å©ç¨ authenticator éè¿ç¨æ·ååå¯ç è®¿é®åä¿æ¤çèµæºãå¯¹äº javamail api æ¥è¯´ï¼è¿äºèµæºå°±æ¯é®ä»¶æå¡å¨ãauthenticator å¨ javax.mail åä¸­ï¼èä¸å®å java.net ä¸­ååçç±» authenticator ä¸åãä¸¤èå¹¶ä¸å±äº«åä¸ä¸ª authenticator ï¼å ä¸º javamail api ç¨äº java 1.1 ï¼å®æ²¡æ java.net ç±»å«ã\n\nè¦ä½¿ç¨ authenticator ï¼ååå»ºä¸ä¸ªæ½è±¡ç±»çå­ç±»ï¼å¹¶ä» getpasswordauthentication() æ¹æ³ä¸­è¿å passwordauthentication å®ä¾ãåå»ºå®æåï¼æ¨å¿éå session æ³¨å authenticator ãç¶åï¼å¨éè¦è®¤è¯çæ¶åï¼å°±ä¼éç¥ authenticator ãæ¨å¯ä»¥å¼¹åºçªå£ï¼ä¹å¯ä»¥ä»éç½®æä»¶ä¸­ï¼è½ç¶æ²¡æå å¯æ¯ä¸å®å¨çï¼è¯»åç¨æ·ååå¯ç ï¼å°å®ä»¬ä½ä¸º passwordauthentication å¯¹è±¡è¿åç»è°ç¨ç¨åºã\n\nä¾ï¼\n\nproperties props = new properties();\nauthenticator auth = new myauthenticator();\nsession session = session.getdefaultinstance(props, auth);\n\n\n\n# å®ä¾\n\n\n# åéææ¬é®ä»¶\n\npublic static void main(string[] args) throws exception {\n    properties prop = new properties();\n    prop.setproperty("mail.debug", "true");\n    prop.setproperty("mail.host", mail_server_host);\n    prop.setproperty("mail.transport.protocol", "smtp");\n    prop.setproperty("mail.smtp.auth", "true");\n\n    // 1ãåå»ºsession\n    session session = session.getinstance(prop);\n    transport ts = null;\n\n    // 2ãéè¿sessionå¾å°transportå¯¹è±¡\n    ts = session.gettransport();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    ts.connect(mail_server_host, user, password);\n\n    // 4ãåå»ºé®ä»¶\n    mimemessage message = new mimemessage(session);\n\n    // é®ä»¶æ¶æ¯å¤´\n    message.setfrom(new internetaddress(mail_from)); // é®ä»¶çåä»¶äºº\n    message.setrecipient(message.recipienttype.to, new internetaddress(mail_to)); // é®ä»¶çæ¶ä»¶äºº\n    message.setrecipient(message.recipienttype.cc, new internetaddress(mail_cc)); // é®ä»¶çæéäºº\n    message.setrecipient(message.recipienttype.bcc, new internetaddress(mail_bcc)); // é®ä»¶çå¯éäºº\n    message.setsubject("æµè¯ææ¬é®ä»¶"); // é®ä»¶çæ é¢\n\n    // é®ä»¶æ¶æ¯ä½\n    message.settext("å¤©ä¸æ åã");\n\n    // 5ãåéé®ä»¶\n    ts.sendmessage(message, message.getallrecipients());\n    ts.close();\n}\n\n\n\n# åé html æ ¼å¼çé®ä»¶\n\npublic static void main(string[] args) throws exception {\n    properties prop = new properties();\n    prop.setproperty("mail.debug", "true");\n    prop.setproperty("mail.host", mail_server_host);\n    prop.setproperty("mail.transport.protocol", "smtp");\n    prop.setproperty("mail.smtp.auth", "true");\n\n    // 1ãåå»ºsession\n    session session = session.getinstance(prop);\n    transport ts = null;\n\n    // 2ãéè¿sessionå¾å°transportå¯¹è±¡\n    ts = session.gettransport();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    ts.connect(mail_server_host, user, password);\n\n    // 4ãåå»ºé®ä»¶\n    mimemessage message = new mimemessage(session);\n\n    // é®ä»¶æ¶æ¯å¤´\n    message.setfrom(new internetaddress(mail_from)); // é®ä»¶çåä»¶äºº\n    message.setrecipient(message.recipienttype.to, new internetaddress(mail_to)); // é®ä»¶çæ¶ä»¶äºº\n    message.setrecipient(message.recipienttype.cc, new internetaddress(mail_cc)); // é®ä»¶çæéäºº\n    message.setrecipient(message.recipienttype.bcc, new internetaddress(mail_bcc)); // é®ä»¶çå¯éäºº\n    message.setsubject("æµè¯htmlé®ä»¶"); // é®ä»¶çæ é¢\n\n    string htmlcontent = "<h1>hello</h1>" + "<p>æ¾ç¤ºå¾ç<img src=\'cid:abc.jpg\'>1.jpg</p>";\n    mimebodypart text = new mimebodypart();\n    text.setcontent(htmlcontent, "text/html;charset=utf-8");\n    mimebodypart image = new mimebodypart();\n    datahandler dh = new datahandler(new filedatasource("d:\\\\05_datas\\\\å¾åº\\\\åä»å°å¹´èå½±.png"));\n    image.setdatahandler(dh);\n    image.setcontentid("abc.jpg");\n\n    // æè¿°æ°æ®å³ç³»\n    mimemultipart mm = new mimemultipart();\n    mm.addbodypart(text);\n    mm.addbodypart(image);\n    mm.setsubtype("related");\n    message.setcontent(mm);\n    message.savechanges();\n\n    // 5ãåéé®ä»¶\n    ts.sendmessage(message, message.getallrecipients());\n    ts.close();\n}\n\n\n\n# åéå¸¦éä»¶çé®ä»¶\n\npublic static void main(string[] args) throws exception {\n    properties prop = new properties();\n    prop.setproperty("mail.debug", "true");\n    prop.setproperty("mail.host", mail_server_host);\n    prop.setproperty("mail.transport.protocol", "smtp");\n    prop.setproperty("mail.smtp.auth", "true");\n\n    // 1ãåå»ºsession\n    session session = session.getinstance(prop);\n\n    // 2ãéè¿sessionå¾å°transportå¯¹è±¡\n    transport ts = session.gettransport();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    ts.connect(mail_server_host, user, password);\n\n    // 4ãåå»ºé®ä»¶\n    mimemessage message = new mimemessage(session);\n\n    // é®ä»¶æ¶æ¯å¤´\n    message.setfrom(new internetaddress(mail_from)); // é®ä»¶çåä»¶äºº\n    message.setrecipient(message.recipienttype.to, new internetaddress(mail_to)); // é®ä»¶çæ¶ä»¶äºº\n    message.setrecipient(message.recipienttype.cc, new internetaddress(mail_cc)); // é®ä»¶çæéäºº\n    message.setrecipient(message.recipienttype.bcc, new internetaddress(mail_bcc)); // é®ä»¶çå¯éäºº\n    message.setsubject("æµè¯å¸¦éä»¶é®ä»¶"); // é®ä»¶çæ é¢\n\n    mimebodypart text = new mimebodypart();\n    text.setcontent("é®ä»¶ä¸­æä¸¤ä¸ªéä»¶ã", "text/html;charset=utf-8");\n\n    // æè¿°æ°æ®å³ç³»\n    mimemultipart mm = new mimemultipart();\n    mm.setsubtype("related");\n    mm.addbodypart(text);\n    string[] files = {\n            "d:\\\\00_temp\\\\temp\\\\1.jpg", "d:\\\\00_temp\\\\temp\\\\2.png"\n    };\n\n    // æ·»å é®ä»¶éä»¶\n    for (string filename : files) {\n        mimebodypart attachpart = new mimebodypart();\n        attachpart.attachfile(filename);\n        mm.addbodypart(attachpart);\n    }\n\n    message.setcontent(mm);\n    message.savechanges();\n\n    // 5ãåéé®ä»¶\n    ts.sendmessage(message, message.getallrecipients());\n    ts.close();\n}\n\n\n\n# è·åé®ç®±ä¸­çé®ä»¶\n\n public static void main(string[] args) throws exception {\n\n    // åå»ºä¸ä¸ªæå·ä½è¿æ¥ä¿¡æ¯çpropertieså¯¹è±¡\n    properties prop = new properties();\n    prop.setproperty("mail.debug", "true");\n    prop.setproperty("mail.store.protocol", "pop3");\n    prop.setproperty("mail.pop3.host", mail_server_host);\n\n    // 1ãåå»ºsession\n    session session = session.getinstance(prop);\n\n    // 2ãéè¿sessionå¾å°storeå¯¹è±¡\n    store store = session.getstore();\n\n    // 3ãè¿ä¸é®ä»¶æå¡å¨\n    store.connect(mail_server_host, user, password);\n\n    // 4ãè·å¾é®ç®±åçé®ä»¶å¤¹\n    folder folder = store.getfolder("inbox");\n    folder.open(folder.read_only);\n\n    // è·å¾é®ä»¶å¤¹folderåçææé®ä»¶messageå¯¹è±¡\n    message[] messages = folder.getmessages();\n    for (int i = 0; i < messages.length; i++) {\n        string subject = messages[i].getsubject();\n        string from = (messages[i].getfrom()[0]).tostring();\n        system.out.println("ç¬¬ " + (i + 1) + "å°é®ä»¶çä¸»é¢ï¼" + subject);\n        system.out.println("ç¬¬ " + (i + 1) + "å°é®ä»¶çåä»¶äººå°åï¼" + from);\n    }\n\n    // 5ãå³é­\n    folder.close(false);\n    store.close();\n}\n\n\n\n# è½¬åé®ä»¶\n\nä¾ï¼è·åæå®é®ä»¶å¤¹ä¸çç¬¬ä¸å°é®ä»¶å¹¶è½¬å\n\n public static void main(string[] args) throws exception {\n    properties prop = new properties();\n    prop.put("mail.store.protocol", "pop3");\n    prop.put("mail.pop3.host", mail_server_pop3);\n    prop.put("mail.pop3.starttls.enable", "true");\n    prop.put("mail.smtp.auth", "true");\n    prop.put("mail.smtp.host", mail_server_smtp);\n\n    // 1ãåå»ºsession\n    session session = session.getdefaultinstance(prop);\n\n    // 2ãè¯»åé®ä»¶å¤¹\n    store store = session.getstore("pop3");\n    store.connect(mail_server_pop3, user, password);\n    folder folder = store.getfolder("inbox");\n    folder.open(folder.read_only);\n\n    // è·åé®ä»¶å¤¹ä¸­ç¬¬1å°é®ä»¶ä¿¡æ¯\n    message[] messages = folder.getmessages();\n    if (messages.length <= 0) {\n        return;\n    }\n    message message = messages[0];\n\n    // æå°é®ä»¶å³é®ä¿¡æ¯\n    string from = internetaddress.tostring(message.getfrom());\n    if (from != null) {\n        system.out.println("from: " + from);\n    }\n\n    string replyto = internetaddress.tostring(message.getreplyto());\n    if (replyto != null) {\n        system.out.println("reply-to: " + replyto);\n    }\n\n    string to = internetaddress.tostring(message.getrecipients(message.recipienttype.to));\n    if (to != null) {\n        system.out.println("to: " + to);\n    }\n\n    string subject = message.getsubject();\n    if (subject != null) {\n        system.out.println("subject: " + subject);\n    }\n\n    date sent = message.getsentdate();\n    if (sent != null) {\n        system.out.println("sent: " + sent);\n    }\n\n    // è®¾ç½®è½¬åé®ä»¶ä¿¡æ¯å¤´\n    message forward = new mimemessage(session);\n    forward.setfrom(new internetaddress(mail_from));\n    forward.setrecipient(message.recipienttype.to, new internetaddress(mail_to));\n    forward.setsubject("fwd: " + message.getsubject());\n\n    // è®¾ç½®è½¬åé®ä»¶åå®¹\n    mimebodypart bodypart = new mimebodypart();\n    bodypart.setcontent(message, "message/rfc822");\n\n    multipart multipart = new mimemultipart();\n    multipart.addbodypart(bodypart);\n    forward.setcontent(multipart);\n    forward.savechanges();\n\n    transport ts = session.gettransport("smtp");\n    ts.connect(user, password);\n    ts.sendmessage(forward, forward.getallrecipients());\n\n    folder.close(false);\n    store.close();\n    ts.close();\n    system.out.println("message forwarded successfully....");\n}\n',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Jsoup å¿«éå¥é¨",frontmatter:{title:"Jsoup å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","Html","Jsoup"],abbrlink:"2dece711",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/c516cc/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/05.Jsoup.html",relativePath:"12.å·¥å·/99.å¶ä»/05.Jsoup.md",key:"v-066da6f7",path:"/pages/c516cc/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:17},{level:2,title:"å è½½",slug:"å è½½",normalizedTitle:"å è½½",charIndex:175},{level:3,title:"ä» HTML å­ç¬¦ä¸²å è½½ä¸ä¸ªææ¡£",slug:"ä»-html-å­ç¬¦ä¸²å è½½ä¸ä¸ªææ¡£",normalizedTitle:"ä» html å­ç¬¦ä¸²å è½½ä¸ä¸ªææ¡£",charIndex:288},{level:3,title:"è§£æä¸ä¸ª body çæ­",slug:"è§£æä¸ä¸ª-body-çæ­",normalizedTitle:"è§£æä¸ä¸ª body çæ­",charIndex:865},{level:4,title:"ä¿è¯å®å¨ Stay safe",slug:"ä¿è¯å®å¨-stay-safe",normalizedTitle:"ä¿è¯å®å¨ stay safe",charIndex:1408},{level:3,title:"ä» URL å è½½ä¸ä¸ªææ¡£",slug:"ä»-url-å è½½ä¸ä¸ªææ¡£",normalizedTitle:"ä» url å è½½ä¸ä¸ªææ¡£",charIndex:1541},{level:3,title:"ä»ä¸ä¸ªæä»¶å è½½ä¸ä¸ªææ¡£",slug:"ä»ä¸ä¸ªæä»¶å è½½ä¸ä¸ªææ¡£",normalizedTitle:"ä»ä¸ä¸ªæä»¶å è½½ä¸ä¸ªææ¡£",charIndex:1967},{level:2,title:"è§£æ",slug:"è§£æ",normalizedTitle:"è§£æ",charIndex:43},{level:3,title:"ä½¿ç¨ DOM æ¹æ³æ¥éåä¸ä¸ªææ¡£",slug:"ä½¿ç¨-dom-æ¹æ³æ¥éåä¸ä¸ªææ¡£",normalizedTitle:"ä½¿ç¨ dom æ¹æ³æ¥éåä¸ä¸ªææ¡£",charIndex:2456},{level:4,title:"æ¥æ¾åç´ ",slug:"æ¥æ¾åç´ ",normalizedTitle:"æ¥æ¾åç´ ",charIndex:2919},{level:4,title:"åç´ æ°æ®",slug:"åç´ æ°æ®",normalizedTitle:"åç´ æ°æ®",charIndex:3296},{level:4,title:"æä½ HTML åææ¬",slug:"æä½-html-åææ¬",normalizedTitle:"æä½ html åææ¬",charIndex:3605},{level:3,title:"ä½¿ç¨éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ ",slug:"ä½¿ç¨éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ ",normalizedTitle:"ä½¿ç¨éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ ",charIndex:3807},{level:4,title:"Selector éæ©å¨æ¦è¿°",slug:"selector-éæ©å¨æ¦è¿°",normalizedTitle:"selector éæ©å¨æ¦è¿°",charIndex:4520},{level:4,title:"Selector éæ©å¨ç»åä½¿ç¨",slug:"selector-éæ©å¨ç»åä½¿ç¨",normalizedTitle:"selector éæ©å¨ç»åä½¿ç¨",charIndex:5007},{level:4,title:"ä¼ªéæ©å¨ selectors",slug:"ä¼ªéæ©å¨-selectors",normalizedTitle:"ä¼ªéæ©å¨ selectors",charIndex:5499},{level:3,title:"ä»åç´ æ½åå±æ§ï¼ææ¬å HTML",slug:"ä»åç´ æ½åå±æ§-ææ¬å-html",normalizedTitle:"ä»åç´ æ½åå±æ§ï¼ææ¬å html",charIndex:6175},{level:3,title:"å¤ç URLs",slug:"å¤ç-urls",normalizedTitle:"å¤ç urls",charIndex:7200},{level:2,title:"æ°æ®ä¿®æ¹",slug:"æ°æ®ä¿®æ¹",normalizedTitle:"æ°æ®ä¿®æ¹",charIndex:7884},{level:3,title:"è®¾ç½®å±æ§çå¼",slug:"è®¾ç½®å±æ§çå¼",normalizedTitle:"è®¾ç½®å±æ§çå¼",charIndex:7893},{level:3,title:"è®¾ç½®ä¸ä¸ªåç´ ç HTML åå®¹",slug:"è®¾ç½®ä¸ä¸ªåç´ ç-html-åå®¹",normalizedTitle:"è®¾ç½®ä¸ä¸ªåç´ ç html åå®¹",charIndex:8479},{level:3,title:"è®¾ç½®åç´ çææ¬åå®¹",slug:"è®¾ç½®åç´ çææ¬åå®¹",normalizedTitle:"è®¾ç½®åç´ çææ¬åå®¹",charIndex:9372},{level:2,title:"HTML æ¸ç",slug:"html-æ¸ç",normalizedTitle:"html æ¸ç",charIndex:9877},{level:3,title:"æ¶é¤ä¸åä¿¡ä»»ç HTML (æ¥é²æ­¢ XSS æ»å»)",slug:"æ¶é¤ä¸åä¿¡ä»»ç-html-æ¥é²æ­¢-xss-æ»å»",normalizedTitle:"æ¶é¤ä¸åä¿¡ä»»ç html (æ¥é²æ­¢ xss æ»å»)",charIndex:9889},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:6159}],headersStr:"ç®ä» å è½½ ä» HTML å­ç¬¦ä¸²å è½½ä¸ä¸ªææ¡£ è§£æä¸ä¸ª body çæ­ ä¿è¯å®å¨ Stay safe ä» URL å è½½ä¸ä¸ªææ¡£ ä»ä¸ä¸ªæä»¶å è½½ä¸ä¸ªææ¡£ è§£æ ä½¿ç¨ DOM æ¹æ³æ¥éåä¸ä¸ªææ¡£ æ¥æ¾åç´  åç´ æ°æ® æä½ HTML åææ¬ ä½¿ç¨éæ©å¨è¯­æ³æ¥æ¥æ¾åç´  Selector éæ©å¨æ¦è¿° Selector éæ©å¨ç»åä½¿ç¨ ä¼ªéæ©å¨ selectors ä»åç´ æ½åå±æ§ï¼ææ¬å HTML å¤ç URLs æ°æ®ä¿®æ¹ è®¾ç½®å±æ§çå¼ è®¾ç½®ä¸ä¸ªåç´ ç HTML åå®¹ è®¾ç½®åç´ çææ¬åå®¹ HTML æ¸ç æ¶é¤ä¸åä¿¡ä»»ç HTML (æ¥é²æ­¢ XSS æ»å») åè",content:'# Jsoup å¿«éå¥é¨\n\n\n# ç®ä»\n\njsoup æ¯ä¸æ¬¾ Java ç HTML è§£æå¨ï¼å¯ç´æ¥è§£ææä¸ª URL å°åãHTML ææ¬åå®¹ãå®æä¾äºä¸å¥éå¸¸çåç APIï¼å¯éè¿ DOMï¼CSS ä»¥åç±»ä¼¼äº JQuery çæä½æ¹æ³æ¥ååºåæä½æ°æ®ã\n\njsoup å·¥ä½çæµç¨ä¸»è¦å¦ä¸ï¼\n\n 1. ä»ä¸ä¸ª URLï¼æä»¶æå­ç¬¦ä¸²ä¸­è§£æ HTMLï¼å¹¶å è½½ä¸ºä¸ä¸ª Document å¯¹è±¡ã\n 2. ä½¿ç¨ DOM æ CSS éæ©å¨æ¥ååºæ°æ®ï¼\n 3. å¯æä½ HTML åç´ ãå±æ§ãææ¬ã\n\njsoup æ¯åºäº MIT åè®®åå¸çï¼å¯æ¾å¿ä½¿ç¨äºåä¸é¡¹ç®ã\n\n\n# å è½½\n\n\n# ä» HTML å­ç¬¦ä¸²å è½½ä¸ä¸ªææ¡£\n\nä½¿ç¨éæ Jsoup.parse(String html) æ¹æ³æ Jsoup.parse(String html, String baseUri) ç¤ºä¾ä»£ç ï¼\n\nString html = "<html><head><title>First parse</title></head>"\n  + "<body><p>Parsed HTML into a doc.</p></body></html>";\nDocument doc = Jsoup.parse(html);\n\n\n> è¯´æ\n> \n> parse(String html, String baseUri) è¿æ¹æ³è½å¤å°è¾å¥ç HTML è§£æä¸ºä¸ä¸ªæ°çææ¡£ (Documentï¼ï¼åæ° baseUri æ¯ç¨æ¥å°ç¸å¯¹ URL è½¬æç»å¯¹ URLï¼å¹¶æå®ä»åªä¸ªç½ç«è·åææ¡£ãå¦è¿ä¸ªæ¹æ³ä¸éç¨ï¼ä½ å¯ä»¥ä½¿ç¨ parse(String html) æ¹æ³æ¥è§£ææ HTML å­ç¬¦ä¸²å¦ä¸é¢çç¤ºä¾ã\n> \n> åªè¦è§£æçä¸æ¯ç©ºå­ç¬¦ä¸²ï¼å°±è½è¿åä¸ä¸ªç»æåççææ¡£ï¼å¶ä¸­åå«(è³å°) ä¸ä¸ª head åä¸ä¸ª body åç´ ã\n> \n> ä¸æ¦æ¥æäºä¸ä¸ª Documentï¼ä½ å°±å¯ä»¥ä½¿ç¨ Document ä¸­éå½çæ¹æ³æå®ç¶ç±» ElementåNodeä¸­çæ¹æ³æ¥åå¾ç¸å³æ°æ®ã\n\n\n# è§£æä¸ä¸ª body çæ­\n\né®é¢\n\nåå¦ä½ æä¸ä¸ª HTML çæ­ (æ¯å¦. ä¸ä¸ª div åå«ä¸å¯¹ p æ ç­¾; ä¸ä¸ªä¸å®æ´ç HTML ææ¡£) æ³å¯¹å®è¿è¡è§£æãè¿ä¸ª HTML çæ­å¯ä»¥æ¯ç¨æ·æäº¤çä¸æ¡è¯è®ºæå¨ä¸ä¸ª CMS é¡µé¢ä¸­ç¼è¾ body é¨åã\n\nåæ³\n\nä½¿ç¨Jsoup.parseBodyFragment(String html)æ¹æ³.\n\nString html = "<div><p>Lorem ipsum.</p>";\nDocument doc = Jsoup.parseBodyFragment(html);\nElement body = doc.body();\n\n\n> è¯´æ\n> \n> parseBodyFragment æ¹æ³åå»ºä¸ä¸ªç©ºå£³çææ¡£ï¼å¹¶æå¥è§£æè¿ç HTML å°bodyåç´ ä¸­ãåå¦ä½ ä½¿ç¨æ­£å¸¸ç Jsoup.parse(String html) æ¹æ³ï¼éå¸¸ä½ ä¹å¯ä»¥å¾å°ç¸åçç»æï¼ä½æ¯æç¡®å°ç¨æ·è¾å¥ä½ä¸º body çæ®µå¤çï¼ä»¥ç¡®ä¿ç¨æ·ææä¾çä»»ä½ç³ç³ç HTML é½å°è¢«è§£ææ body åç´ ã\n> \n> Document.body() æ¹æ³è½å¤åå¾ææ¡£ body åç´ çææå­åç´ ï¼ä¸ doc.getElementsByTag("body")ç¸åã\n\n# ä¿è¯å®å¨ Stay safe\n\nåå¦ä½ å¯ä»¥è®©ç¨æ·è¾å¥ HTML åå®¹ï¼é£ä¹è¦å°å¿é¿åè·¨ç«èæ¬æ»å»ãå©ç¨åºäº Whitelist çæ¸é¤å¨å clean(String bodyHtml, Whitelist whitelist)æ¹æ³æ¥æ¸é¤ç¨æ·è¾å¥çæ¶æåå®¹ã\n\n\n# ä» URL å è½½ä¸ä¸ªææ¡£\n\nä½¿ç¨ Jsoup.connect(String url)æ¹æ³\n\nDocument doc = Jsoup.connect("http://example.com/").get();\n\n\n> è¯´æ\n> \n> connect(String url) æ¹æ³åå»ºä¸ä¸ªæ°ç Connection, å get() åå¾åè§£æä¸ä¸ª HTML æä»¶ãå¦æä»è¯¥ URL è·å HTML æ¶åçéè¯¯ï¼ä¾¿ä¼æåº IOExceptionï¼åºéå½å¤çã\n\nConnection æ¥å£è¿æä¾ä¸ä¸ªæ¹æ³é¾æ¥è§£å³ç¹æ®è¯·æ±ï¼å·ä½å¦ä¸ï¼\n\nDocument doc = Jsoup.connect("http://example.com")\n  .data("query", "Java")\n  .userAgent("Mozilla")\n  .cookie("auth", "token")\n  .timeout(3000)\n  .post();\n\n\n\n# ä»ä¸ä¸ªæä»¶å è½½ä¸ä¸ªææ¡£\n\nå¯ä»¥ä½¿ç¨éæ Jsoup.parse(File in, String charsetName, String baseUri) æ¹æ³\n\nFile input = new File("/tmp/input.html");\nDocument doc = Jsoup.parse(input, "UTF-8", "http://example.com/");\n\n\n> è¯´æ\n> \n> parse(File in, String charsetName, String baseUri) è¿ä¸ªæ¹æ³ç¨æ¥å è½½åè§£æä¸ä¸ª HTML æä»¶ãå¦å¨å è½½æä»¶çæ¶ååçéè¯¯ï¼å°æåº IOExceptionï¼åºä½éå½å¤çã\n> \n> baseUri åæ°ç¨äºè§£å³æä»¶ä¸­ URLs æ¯ç¸å¯¹è·¯å¾çé®é¢ãå¦æä¸éè¦å¯ä»¥ä¼ å¥ä¸ä¸ªç©ºçå­ç¬¦ä¸²ã\n> \n> å¦å¤è¿æä¸ä¸ªæ¹æ³parse(File in, String charsetName) ï¼å®ä½¿ç¨æä»¶çè·¯å¾åä¸º baseUriã è¿ä¸ªæ¹æ³éç¨äºå¦æè¢«è§£ææä»¶ä½äºç½ç«çæ¬å°æä»¶ç³»ç»ï¼ä¸ç¸å³é¾æ¥ä¹æåè¯¥æä»¶ç³»ç»ã\n\n\n# è§£æ\n\n\n# ä½¿ç¨ DOM æ¹æ³æ¥éåä¸ä¸ªææ¡£\n\né®é¢\n\nä½ æä¸ä¸ª HTML ææ¡£è¦ä»ä¸­æåæ°æ®ï¼å¹¶äºè§£è¿ä¸ª HTML ææ¡£çç»æã\n\næ¹æ³\n\nå° HTML è§£ææä¸ä¸ªDocumentä¹åï¼å°±å¯ä»¥ä½¿ç¨ç±»ä¼¼äº DOM çæ¹æ³è¿è¡æä½ãç¤ºä¾ä»£ç ï¼\n\nFile input = new File("/tmp/input.html");\nDocument doc = Jsoup.parse(input, "UTF-8", "http://example.com/");\n\nElement content = doc.getElementById("content");\nElements links = content.getElementsByTag("a");\nfor (Element link : links) {\n  String linkHref = link.attr("href");\n  String linkText = link.text();\n}\n\n\nè¯´æ\n\nElements è¿ä¸ªå¯¹è±¡æä¾äºä¸ç³»åç±»ä¼¼äº DOM çæ¹æ³æ¥æ¥æ¾åç´ ï¼æ½åå¹¶å¤çå¶ä¸­çæ°æ®ã\n\nå·ä½å¦ä¸ï¼\n\n# æ¥æ¾åç´ \n\n * getElementById(String id)\n * getElementsByTag(String tag)\n * getElementsByClass(String className)\n * getElementsByAttribute(String key) (and related methods)\n * Element siblings: siblingElements(), firstElementSibling(), lastElementSibling();nextElementSibling(), previousElementSibling()\n * Graph: parent(), children(), child(int index)\n\n# åç´ æ°æ®\n\n * attr(String key)è·åå±æ§attr(String key, String value)è®¾ç½®å±æ§\n * attributes()è·åææå±æ§\n * id(), className() and classNames()\n * text()è·åææ¬åå®¹text(String value) è®¾ç½®ææ¬åå®¹\n * html()è·ååç´ å HTMLhtml(String value)è®¾ç½®åç´ åç HTML åå®¹\n * outerHtml()è·ååç´ å¤ HTML åå®¹\n * data()è·åæ°æ®åå®¹ï¼ä¾å¦ï¼script å style æ ç­¾)\n * tag() and tagName()\n\n# æä½ HTML åææ¬\n\n * append(String html), prepend(String html)\n * appendText(String text), prependText(String text)\n * appendElement(String tagName), prependElement(String tagName)\n * html(String value)\n\n\n# ä½¿ç¨éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ \n\né®é¢\n\nä½ æ³ä½¿ç¨ç±»ä¼¼äº CSS æ jQuery çè¯­æ³æ¥æ¥æ¾åæä½åç´ ã\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨Element.select(String selector) å Elements.select(String selector) æ¹æ³å®ç°ï¼\n\nFile input = new File("/tmp/input.html");\nDocument doc = Jsoup.parse(input, "UTF-8", "http://example.com/");\n\nElements links = doc.select("a[href]"); //å¸¦æhrefå±æ§çaåç´ \nElements pngs = doc.select("img[src$=.png]");\n  //æ©å±åä¸º.pngçå¾ç\n\nElement masthead = doc.select("div.masthead").first();\n  //classç­äºmastheadçdivæ ç­¾\n\nElements resultLinks = doc.select("h3.r > a"); //å¨h3åç´ ä¹åçaåç´ \n\n\n> è¯´æ\n> \n> jsoup elements å¯¹è±¡æ¯æç±»ä¼¼äºCSS (æjquery)çéæ©å¨è¯­æ³ï¼æ¥å®ç°éå¸¸å¼ºå¤§åçµæ´»çæ¥æ¾åè½ã.\n> \n> è¿ä¸ªselect æ¹æ³å¨Document, Element,æElementså¯¹è±¡ä¸­é½å¯ä»¥ä½¿ç¨ãä¸æ¯ä¸ä¸æç¸å³çï¼å æ­¤å¯å®ç°æå®åç´ çè¿æ»¤ï¼æèé¾å¼éæ©è®¿é®ã\n> \n> Select æ¹æ³å°è¿åä¸ä¸ªElementséåï¼å¹¶æä¾ä¸ç»æ¹æ³æ¥æ½ååå¤çç»æã\n\n# Selector éæ©å¨æ¦è¿°\n\n * tagname: éè¿æ ç­¾æ¥æ¾åç´ ï¼æ¯å¦ï¼a\n * ns|tag: éè¿æ ç­¾å¨å½åç©ºé´æ¥æ¾åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨ fb|name è¯­æ³æ¥æ¥æ¾ `` åç´ \n * #id: éè¿ ID æ¥æ¾åç´ ï¼æ¯å¦ï¼#logo\n * .class: éè¿ class åç§°æ¥æ¾åç´ ï¼æ¯å¦ï¼.masthead\n * [attribute]: å©ç¨å±æ§æ¥æ¾åç´ ï¼æ¯å¦ï¼[href]\n * [^attr]: å©ç¨å±æ§ååç¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨[^data-] æ¥æ¥æ¾å¸¦æ HTML5 Dataset å±æ§çåç´ \n * [attr=value]: å©ç¨å±æ§å¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼[width=500]\n * [attr^=value], [attr$=value], [attr*=value]: å©ç¨å¹éå±æ§å¼å¼å¤´ãç»å°¾æåå«å±æ§å¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼[href*=/path/]\n * [attr\\~=regex]: å©ç¨å±æ§å¼å¹éæ­£åè¡¨è¾¾å¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼ img[src\\~=(?i)\\.(png|jpe?g)]\n * *: è¿ä¸ªç¬¦å·å°å¹éææåç´ \n\n# Selector éæ©å¨ç»åä½¿ç¨\n\n * el##id: åç´ +IDï¼æ¯å¦ï¼ div##logo\n * el.class: åç´ +classï¼æ¯å¦ï¼ div.masthead\n * el[attr]: åç´ +classï¼æ¯å¦ï¼ a[href]\n * ä»»æç»åï¼æ¯å¦ï¼a[href].highlight\n * ancestor child: æ¥æ¾æä¸ªåç´ ä¸å­åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨.body p æ¥æ¾å¨"body"åç´ ä¸çææpåç´ \n * parent > child: æ¥æ¾æä¸ªç¶åç´ ä¸çç´æ¥å­åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨div.content > p æ¥æ¾ p åç´ ï¼ä¹å¯ä»¥ç¨body > * æ¥æ¾ body æ ç­¾ä¸ææç´æ¥å­åç´ \n * siblingA + siblingB: æ¥æ¾å¨ A åç´ ä¹åç¬¬ä¸ä¸ªåçº§åç´  Bï¼æ¯å¦ï¼div.head + div\n * siblingA \\~ siblingX: æ¥æ¾ A åç´ ä¹åçåçº§ X åç´ ï¼æ¯å¦ï¼h1 \\~ p\n * el, el, el:å¤ä¸ªéæ©å¨ç»åï¼æ¥æ¾å¹éä»»ä¸éæ©å¨çå¯ä¸åç´ ï¼ä¾å¦ï¼div.masthead, div.logo\n\n# ä¼ªéæ©å¨ selectors\n\n * :lt(n): æ¥æ¾åªäºåç´ çåçº§ç´¢å¼å¼ï¼å®çä½ç½®å¨ DOM æ ä¸­æ¯ç¸å¯¹äºå®çç¶èç¹ï¼å°äº nï¼æ¯å¦ï¼td:lt(3) è¡¨ç¤ºå°äºä¸åçåç´ \n * :gt(n):æ¥æ¾åªäºåç´ çåçº§ç´¢å¼å¼å¤§äºn``ï¼æ¯å¦ï¼ div p:gt(2)è¡¨ç¤ºåªäº div ä¸­æåå« 2 ä¸ªä»¥ä¸ç p åç´ \n * :eq(n): æ¥æ¾åªäºåç´ çåçº§ç´¢å¼å¼ä¸nç¸ç­ï¼æ¯å¦ï¼form input:eq(1)è¡¨ç¤ºåå«ä¸ä¸ª input æ ç­¾ç Form åç´ \n * :has(seletor): æ¥æ¾å¹ééæ©å¨åå«åç´ çåç´ ï¼æ¯å¦ï¼div:has(p)è¡¨ç¤ºåªäº div åå«äº p åç´ \n * :not(selector): æ¥æ¾ä¸éæ©å¨ä¸å¹éçåç´ ï¼æ¯å¦ï¼ div:not(.logo) è¡¨ç¤ºä¸åå« class=logo åç´ çææ div åè¡¨\n * :contains(text): æ¥æ¾åå«ç»å®ææ¬çåç´ ï¼æç´¢ä¸åºåå¤§ä¸åï¼æ¯å¦ï¼ p:contains(jsoup)\n * :containsOwn(text): æ¥æ¾ç´æ¥åå«ç»å®ææ¬çåç´ \n * :matches(regex): æ¥æ¾åªäºåç´ çææ¬å¹éæå®çæ­£åè¡¨è¾¾å¼ï¼æ¯å¦ï¼div:matches((?i)login)\n * :matchesOwn(regex): æ¥æ¾èªèº«åå«ææ¬å¹éæå®æ­£åè¡¨è¾¾å¼çåç´ \n * æ³¨æï¼ä¸è¿°ä¼ªéæ©å¨ç´¢å¼æ¯ä» 0 å¼å§çï¼ä¹å°±æ¯è¯´ç¬¬ä¸ä¸ªåç´ ç´¢å¼å¼ä¸º 0ï¼ç¬¬äºä¸ªåç´  index ä¸º 1 ç­\n\nå¯ä»¥æ¥çSelector API åèæ¥äºè§£æ´è¯¦ç»çåå®¹\n\n\n# ä»åç´ æ½åå±æ§ï¼ææ¬å HTML\n\né®é¢\n\nå¨è§£æè·å¾ä¸ä¸ª Document å®ä¾å¯¹è±¡ï¼å¹¶æ¥æ¾å°ä¸äºåç´ ä¹åï¼ä½ å¸æåå¾å¨è¿äºåç´ ä¸­çæ°æ®ã\n\næ¹æ³\n\n * è¦åå¾ä¸ä¸ªå±æ§çå¼ï¼å¯ä»¥ä½¿ç¨Node.attr(String key) æ¹æ³\n * å¯¹äºä¸ä¸ªåç´ ä¸­çææ¬ï¼å¯ä»¥ä½¿ç¨Element.text()æ¹æ³\n * å¯¹äºè¦åå¾åç´ æå±æ§ä¸­ç HTML åå®¹ï¼å¯ä»¥ä½¿ç¨Element.html(), æ Node.outerHtml()æ¹æ³\n\nç¤ºä¾ï¼\n\nString html = "<p>An <a href=\'http://example.com/\'><b>example</b></a> link.</p>";\nDocument doc = Jsoup.parse(html);//è§£æHTMLå­ç¬¦ä¸²è¿åä¸ä¸ªDocumentå®ç°\nElement link = doc.select("a").first();//æ¥æ¾ç¬¬ä¸ä¸ªaåç´ \n\nString text = doc.body().text(); // "An example link"//åå¾å­ç¬¦ä¸²ä¸­çææ¬\nString linkHref = link.attr("href"); // "http://example.com/"//åå¾é¾æ¥å°å\nString linkText = link.text(); // "example""//åå¾é¾æ¥å°åä¸­çææ¬\n\nString linkOuterH = link.outerHtml();\n    // "<a href="http://example.com"><b>example</b></a>"\nString linkInnerH = link.html(); // "<b>example</b>"//åå¾é¾æ¥åçhtmlåå®¹\n\n\n> è¯´æ\n> \n> ä¸è¿°æ¹æ³æ¯åç´ æ°æ®è®¿é®çæ ¸å¿åæ³ãæ­¤å¤è¿å¶å®ä¸äºæ¹æ³å¯ä»¥ä½¿ç¨ï¼\n> \n>  * Element.id()\n>  * Element.tagName()\n>  * Element.className() and Element.hasClass(String className)\n> \n> è¿äºè®¿é®å¨æ¹æ³é½æç¸åºç setter æ¹æ³æ¥æ´æ¹æ°æ®\n\nåè§\n\n * ElementåElementséåç±»çåèææ¡£\n * URLs å¤ç\n * ä½¿ç¨ CSS éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ \n\n\n# å¤ç URLs\n\né®é¢\n\nä½ æä¸ä¸ªåå«ç¸å¯¹ URLs è·¯å¾ç HTML ææ¡£ï¼éè¦å°è¿äºç¸å¯¹è·¯å¾è½¬æ¢æç»å¯¹è·¯å¾ç URLsã\n\næ¹æ³\n\n 1. å¨ä½ è§£æææ¡£æ¶ç¡®ä¿ææå®base URIï¼ç¶å\n 2. ä½¿ç¨ abs: å±æ§åç¼æ¥åå¾åå«base URIçç»å¯¹è·¯å¾ãä»£ç å¦ä¸ï¼\n\nDocument doc = Jsoup.connect("http://www.open-open.com").get();\n\nElement link = doc.select("a").first();\nString relHref = link.attr("href"); // == "/"\nString absHref = link.attr("abs:href"); // "http://www.open-open.com/"\n\n\n\n> è¯´æ\n> \n> å¨ HTML åç´ ä¸­ï¼URLs ç»å¸¸åæç¸å¯¹äºææ¡£ä½ç½®çç¸å¯¹è·¯å¾ï¼ <a href="/download">...</a>. å½ä½ ä½¿ç¨ Node.attr(String key) æ¹æ³æ¥åå¾ a åç´ ç href å±æ§æ¶ï¼å®å°ç´æ¥è¿åå¨ HTML æºç ä¸­æå®å®çå¼ã\n> \n> åå¦ä½ éè¦åå¾ä¸ä¸ªç»å¯¹è·¯å¾ï¼éè¦å¨å±æ§ååå  abs: åç¼ãè¿æ ·å°±å¯ä»¥è¿ååå«æ ¹è·¯å¾ç URL å°åattr("abs:href")\n> \n> å æ­¤ï¼å¨è§£æ HTML ææ¡£æ¶ï¼å®ä¹ base URI éå¸¸éè¦ã\n> \n> å¦æä½ ä¸æ³ä½¿ç¨abs: åç¼ï¼è¿æä¸ä¸ªæ¹æ³è½å¤å®ç°åæ ·çåè½ Node.absUrl(String key)ã\n\n\n# æ°æ®ä¿®æ¹\n\n\n# è®¾ç½®å±æ§çå¼\n\né®é¢\n\nå¨ä½ è§£æä¸ä¸ª Document ä¹åå¯è½æ³ä¿®æ¹å¶ä¸­çæäºå±æ§å¼ï¼ç¶ååä¿å­å°ç£çæé½è¾åºå°åå°é¡µé¢ã\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨å±æ§è®¾ç½®æ¹æ³ Element.attr(String key, String value), å Elements.attr(String key, String value).\n\nåå¦ä½ éè¦ä¿®æ¹ä¸ä¸ªåç´ ç class å±æ§ï¼å¯ä»¥ä½¿ç¨ Element.addClass(String className) åElement.removeClass(String className) æ¹æ³ã\n\nElements æä¾äºæ¹éæä½åç´ å±æ§å class çæ¹æ³ï¼æ¯å¦ï¼è¦ä¸º div ä¸­çæ¯ä¸ä¸ª a åç´ é½æ·»å ä¸ä¸ªrel="nofollow" å¯ä»¥ä½¿ç¨å¦ä¸æ¹æ³ï¼\n\ndoc.select("div.comments a").attr("rel", "nofollow");\n\n\n\n> è¯´æ\n> \n> ä¸Elementä¸­çå¶å®æ¹æ³ä¸æ ·ï¼attr æ¹æ³ä¹æ¯è¿åå½ Element (æå¨ä½¿ç¨éæ©å¨æ¯è¿å Elementséå)ãè¿æ ·è½å¤å¾æ¹ä¾¿ä½¿ç¨æ¹æ³è¿ç¨çä¹¦åæ¹å¼ãæ¯å¦ï¼\n> \n> doc.select("div.masthead").attr("title", "jsoup").addClass("round-box");\n\n\n# è®¾ç½®ä¸ä¸ªåç´ ç HTML åå®¹\n\né®é¢\n\nä½ éè¦ä¸ä¸ªåç´ ä¸­ç HTML åå®¹\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨Elementä¸­ç HTML è®¾ç½®æ¹æ³å·ä½å¦ä¸ï¼\n\nElement div = doc.select("div").first(); // <div></div>\ndiv.html("<p>lorem ipsum</p>"); // <div><p>lorem ipsum</p></div>\ndiv.prepend("<p>First</p>");//å¨divåæ·»å htmlåå®¹\ndiv.append("<p>Last</p>");//å¨divä¹åæ·»å htmlåå®¹\n// æ·»å®åçç»æ: <div><p>First</p><p>lorem ipsum</p><p>Last</p></div>\n\nElement span = doc.select("span").first(); // <span>One</span>\nspan.wrap("<li><a href=\'http://example.com/\'></a></li>");\n// æ·»å®åçç»æ: <li><a href="http://example.com"><span>One</span></a></li>\n\n\n> è¯´æ\n> \n>  * Element.html(String html) è¿ä¸ªæ¹æ³å°åæ¸é¤åç´ ä¸­ç HTML åå®¹ï¼ç¶åç¨ä¼ å¥ç HTML ä»£æ¿ã\n>  * Element.prepend(String first) å Element.append(String last) æ¹æ³ç¨äºå¨åå«å¨åç´ åé¨ HTML çåé¢ååé¢æ·»å  HTML åå®¹\n>  * Element.wrap(String around) å¯¹åç´ åè£¹ä¸ä¸ªå¤é¨ HTML åå®¹ã\n> \n> åè§\n> \n> å¯ä»¥æ¥ç API åèææ¡£ä¸­ Element.prependElement(String tag)åElement.appendElement(String tag) æ¹æ³æ¥åå»ºæ°çåç´ å¹¶ä½ä¸ºææ¡£çå­åç´ æå¥å¶ä¸­ã\n\n\n# è®¾ç½®åç´ çææ¬åå®¹\n\né®é¢\n\nä½ éè¦ä¿®æ¹ä¸ä¸ª HTML ææ¡£ä¸­çææ¬åå®¹\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨Elementçè®¾ç½®æ¹æ³ï¼:\n\nElement div = doc.select("div").first(); // <div></div>\ndiv.text("five > four"); // <div>five &gt; four</div>\ndiv.prepend("First ");\ndiv.append(" Last");\n// now: <div>First five &gt; four Last</div>\n\n\n> è¯´æ\n> \n> ææ¬è®¾ç½®æ¹æ³ä¸ HTML setter æ¹æ³ä¸æ ·ï¼\n> \n>  * Element.text(String text) å°æ¸é¤ä¸ä¸ªåç´ ä¸­çåé¨ HTML åå®¹ï¼ç¶åæä¾çææ¬è¿è¡ä»£æ¿\n>  * Element.prepend(String first) å Element.append(String last) å°åå«å¨åç´ çåé¨ html ååæ·»å ææ¬èç¹ã\n> \n> å¯¹äºä¼ å¥çææ¬å¦æå«æå <, > ç­è¿æ ·çå­ç¬¦ï¼å°ä»¥ææ¬å¤çï¼èé HTMLã\n\n\n# HTML æ¸ç\n\n\n# æ¶é¤ä¸åä¿¡ä»»ç HTML (æ¥é²æ­¢ XSS æ»å»)\n\né®é¢\n\nå¨åç½ç«çæ¶åï¼ç»å¸¸ä¼æä¾ç¨æ·è¯è®ºçåè½ãæäºä¸æå¥½æçç¨æ·ï¼ä¼æä¸äºèæ¬å°è¯è®ºåå®¹ä¸­ï¼èè¿äºèæ¬å¯è½ä¼ç ´åæ´ä¸ªé¡µé¢çè¡ä¸ºï¼æ´ä¸¥éçæ¯è·åä¸äºæºè¦ä¿¡æ¯ï¼æ­¤æ¶éè¦æ¸çè¯¥ HTMLï¼ä»¥é¿åè·¨ç«èæ¬cross-site scriptingæ»å»ï¼XSSï¼ã\n\næ¹æ³\n\nä½¿ç¨ jsoup HTML Cleaner æ¹æ³è¿è¡æ¸é¤ï¼ä½éè¦æå®ä¸ä¸ªå¯éç½®ç Whitelistã\n\nString unsafe =\n  "<p><a href=\'http://example.com/\' onclick=\'stealCookies()\'>Link</a></p>";\nString safe = Jsoup.clean(unsafe, Whitelist.basic());\n// now: <p><a href="http://example.com/" rel="nofollow">Link</a></p>\n\n\nè¯´æ\n\nXSS åå« CSS (Cross Site Script) ï¼è·¨ç«èæ¬æ»å»ãå®æçæ¯æ¶ææ»å»èå¾ Web é¡µé¢éæå¥æ¶æ html ä»£ç ï¼å½ç¨æ·æµè§è¯¥é¡µä¹æ¶ï¼åµå¥å¶ä¸­ Web éé¢ç html ä»£ç ä¼è¢«æ§è¡ï¼ä»èè¾¾å°æ¶ææ»å»ç¨æ·çç¹æ®ç®çãXSS å±äºè¢«å¨å¼çæ»å»ï¼å ä¸ºå¶è¢«å¨ä¸ä¸å¥½å©ç¨ï¼æä»¥è®¸å¤äººå¸¸å¿½ç¥å¶å±å®³æ§ãæä»¥æä»¬ç»å¸¸åªè®©ç¨æ·è¾å¥çº¯ææ¬çåå®¹ï¼ä½è¿æ ·ç¨æ·ä½éªå°±æ¯è¾å·®äºã\n\nä¸ä¸ªæ´å¥½çè§£å³æ¹æ³å°±æ¯ä½¿ç¨ä¸ä¸ªå¯ææ¬ç¼è¾å¨ WYSIWYG å¦ CKEditor å TinyMCEãè¿äºå¯ä»¥è¾åº HTML å¹¶è½å¤è®©ç¨æ·å¯è§åç¼è¾ãè½ç¶ä»ä»¬å¯ä»¥å¨å®¢æ·ç«¯è¿è¡æ ¡éªï¼ä½æ¯è¿æ ·è¿ä¸å¤å®å¨ï¼éè¦å¨æå¡å¨ç«¯è¿è¡æ ¡éªå¹¶æ¸é¤æå®³ç HTML ä»£ç ï¼è¿æ ·æè½ç¡®ä¿è¾å¥å°ä½ ç½ç«ç HTML æ¯å®å¨çãå¦åï¼æ»å»èè½å¤ç»è¿å®¢æ·ç«¯ç Javascript éªè¯ï¼å¹¶æ³¨å¥ä¸å®å¨ç HMTL ç´æ¥è¿å¥æ¨çç½ç«ã\n\njsoup ç whitelist æ¸çå¨è½å¤å¨æå¡å¨ç«¯å¯¹ç¨æ·è¾å¥ç HTML è¿è¡è¿æ»¤ï¼åªè¾åºä¸äºå®å¨çæ ç­¾åå±æ§ã\n\njsoup æä¾äºä¸ç³»åç Whitelist åºæ¬éç½®ï¼è½å¤æ»¡è¶³å¤§å¤æ°è¦æ±ï¼ä½å¦æå¿è¦ï¼ä¹å¯ä»¥è¿è¡ä¿®æ¹ï¼ä¸è¿è¦å°å¿ã\n\nè¿ä¸ª cleaner éå¸¸å¥½ç¨ä¸ä»å¯ä»¥é¿å XSS æ»å»ï¼è¿å¯ä»¥éå¶ç¨æ·å¯ä»¥è¾å¥çæ ç­¾èå´ã\n\nåè§\n\n * åéXSS cheat sheet ï¼æä¸ä¸ªä¾å­å¯ä»¥äºè§£ä¸ºä»ä¹ä¸è½ä½¿ç¨æ­£åè¡¨è¾¾å¼ï¼èéç¨å®å¨ç whitelist parser-based æ¸çå¨ææ¯æ­£ç¡®çéæ©ã\n * åéCleaner ï¼äºè§£å¦ä½è¿åä¸ä¸ª Document å¯¹è±¡ï¼èä¸æ¯å­ç¬¦ä¸²\n * åéWhitelistï¼äºè§£å¦ä½åå»ºä¸ä¸ªèªå®ä¹ç whitelist\n * nofollow é¾æ¥å±æ§äºè§£\n\n\n# åè\n\n * jsoup github æç®¡ä»£ç \n * jsoup Cookbook\n * jsoup Cookbook(ä¸­æç)\n * ä¸éç jsoup å­¦ä¹ ç¬è®°',normalizedContent:'# jsoup å¿«éå¥é¨\n\n\n# ç®ä»\n\njsoup æ¯ä¸æ¬¾ java ç html è§£æå¨ï¼å¯ç´æ¥è§£ææä¸ª url å°åãhtml ææ¬åå®¹ãå®æä¾äºä¸å¥éå¸¸çåç apiï¼å¯éè¿ domï¼css ä»¥åç±»ä¼¼äº jquery çæä½æ¹æ³æ¥ååºåæä½æ°æ®ã\n\njsoup å·¥ä½çæµç¨ä¸»è¦å¦ä¸ï¼\n\n 1. ä»ä¸ä¸ª urlï¼æä»¶æå­ç¬¦ä¸²ä¸­è§£æ htmlï¼å¹¶å è½½ä¸ºä¸ä¸ª document å¯¹è±¡ã\n 2. ä½¿ç¨ dom æ css éæ©å¨æ¥ååºæ°æ®ï¼\n 3. å¯æä½ html åç´ ãå±æ§ãææ¬ã\n\njsoup æ¯åºäº mit åè®®åå¸çï¼å¯æ¾å¿ä½¿ç¨äºåä¸é¡¹ç®ã\n\n\n# å è½½\n\n\n# ä» html å­ç¬¦ä¸²å è½½ä¸ä¸ªææ¡£\n\nä½¿ç¨éæ jsoup.parse(string html) æ¹æ³æ jsoup.parse(string html, string baseuri) ç¤ºä¾ä»£ç ï¼\n\nstring html = "<html><head><title>first parse</title></head>"\n  + "<body><p>parsed html into a doc.</p></body></html>";\ndocument doc = jsoup.parse(html);\n\n\n> è¯´æ\n> \n> parse(string html, string baseuri) è¿æ¹æ³è½å¤å°è¾å¥ç html è§£æä¸ºä¸ä¸ªæ°çææ¡£ (documentï¼ï¼åæ° baseuri æ¯ç¨æ¥å°ç¸å¯¹ url è½¬æç»å¯¹ urlï¼å¹¶æå®ä»åªä¸ªç½ç«è·åææ¡£ãå¦è¿ä¸ªæ¹æ³ä¸éç¨ï¼ä½ å¯ä»¥ä½¿ç¨ parse(string html) æ¹æ³æ¥è§£ææ html å­ç¬¦ä¸²å¦ä¸é¢çç¤ºä¾ã\n> \n> åªè¦è§£æçä¸æ¯ç©ºå­ç¬¦ä¸²ï¼å°±è½è¿åä¸ä¸ªç»æåççææ¡£ï¼å¶ä¸­åå«(è³å°) ä¸ä¸ª head åä¸ä¸ª body åç´ ã\n> \n> ä¸æ¦æ¥æäºä¸ä¸ª documentï¼ä½ å°±å¯ä»¥ä½¿ç¨ document ä¸­éå½çæ¹æ³æå®ç¶ç±» elementånodeä¸­çæ¹æ³æ¥åå¾ç¸å³æ°æ®ã\n\n\n# è§£æä¸ä¸ª body çæ­\n\né®é¢\n\nåå¦ä½ æä¸ä¸ª html çæ­ (æ¯å¦. ä¸ä¸ª div åå«ä¸å¯¹ p æ ç­¾; ä¸ä¸ªä¸å®æ´ç html ææ¡£) æ³å¯¹å®è¿è¡è§£æãè¿ä¸ª html çæ­å¯ä»¥æ¯ç¨æ·æäº¤çä¸æ¡è¯è®ºæå¨ä¸ä¸ª cms é¡µé¢ä¸­ç¼è¾ body é¨åã\n\nåæ³\n\nä½¿ç¨jsoup.parsebodyfragment(string html)æ¹æ³.\n\nstring html = "<div><p>lorem ipsum.</p>";\ndocument doc = jsoup.parsebodyfragment(html);\nelement body = doc.body();\n\n\n> è¯´æ\n> \n> parsebodyfragment æ¹æ³åå»ºä¸ä¸ªç©ºå£³çææ¡£ï¼å¹¶æå¥è§£æè¿ç html å°bodyåç´ ä¸­ãåå¦ä½ ä½¿ç¨æ­£å¸¸ç jsoup.parse(string html) æ¹æ³ï¼éå¸¸ä½ ä¹å¯ä»¥å¾å°ç¸åçç»æï¼ä½æ¯æç¡®å°ç¨æ·è¾å¥ä½ä¸º body çæ®µå¤çï¼ä»¥ç¡®ä¿ç¨æ·ææä¾çä»»ä½ç³ç³ç html é½å°è¢«è§£ææ body åç´ ã\n> \n> document.body() æ¹æ³è½å¤åå¾ææ¡£ body åç´ çææå­åç´ ï¼ä¸ doc.getelementsbytag("body")ç¸åã\n\n# ä¿è¯å®å¨ stay safe\n\nåå¦ä½ å¯ä»¥è®©ç¨æ·è¾å¥ html åå®¹ï¼é£ä¹è¦å°å¿é¿åè·¨ç«èæ¬æ»å»ãå©ç¨åºäº whitelist çæ¸é¤å¨å clean(string bodyhtml, whitelist whitelist)æ¹æ³æ¥æ¸é¤ç¨æ·è¾å¥çæ¶æåå®¹ã\n\n\n# ä» url å è½½ä¸ä¸ªææ¡£\n\nä½¿ç¨ jsoup.connect(string url)æ¹æ³\n\ndocument doc = jsoup.connect("http://example.com/").get();\n\n\n> è¯´æ\n> \n> connect(string url) æ¹æ³åå»ºä¸ä¸ªæ°ç connection, å get() åå¾åè§£æä¸ä¸ª html æä»¶ãå¦æä»è¯¥ url è·å html æ¶åçéè¯¯ï¼ä¾¿ä¼æåº ioexceptionï¼åºéå½å¤çã\n\nconnection æ¥å£è¿æä¾ä¸ä¸ªæ¹æ³é¾æ¥è§£å³ç¹æ®è¯·æ±ï¼å·ä½å¦ä¸ï¼\n\ndocument doc = jsoup.connect("http://example.com")\n  .data("query", "java")\n  .useragent("mozilla")\n  .cookie("auth", "token")\n  .timeout(3000)\n  .post();\n\n\n\n# ä»ä¸ä¸ªæä»¶å è½½ä¸ä¸ªææ¡£\n\nå¯ä»¥ä½¿ç¨éæ jsoup.parse(file in, string charsetname, string baseuri) æ¹æ³\n\nfile input = new file("/tmp/input.html");\ndocument doc = jsoup.parse(input, "utf-8", "http://example.com/");\n\n\n> è¯´æ\n> \n> parse(file in, string charsetname, string baseuri) è¿ä¸ªæ¹æ³ç¨æ¥å è½½åè§£æä¸ä¸ª html æä»¶ãå¦å¨å è½½æä»¶çæ¶ååçéè¯¯ï¼å°æåº ioexceptionï¼åºä½éå½å¤çã\n> \n> baseuri åæ°ç¨äºè§£å³æä»¶ä¸­ urls æ¯ç¸å¯¹è·¯å¾çé®é¢ãå¦æä¸éè¦å¯ä»¥ä¼ å¥ä¸ä¸ªç©ºçå­ç¬¦ä¸²ã\n> \n> å¦å¤è¿æä¸ä¸ªæ¹æ³parse(file in, string charsetname) ï¼å®ä½¿ç¨æä»¶çè·¯å¾åä¸º baseuriã è¿ä¸ªæ¹æ³éç¨äºå¦æè¢«è§£ææä»¶ä½äºç½ç«çæ¬å°æä»¶ç³»ç»ï¼ä¸ç¸å³é¾æ¥ä¹æåè¯¥æä»¶ç³»ç»ã\n\n\n# è§£æ\n\n\n# ä½¿ç¨ dom æ¹æ³æ¥éåä¸ä¸ªææ¡£\n\né®é¢\n\nä½ æä¸ä¸ª html ææ¡£è¦ä»ä¸­æåæ°æ®ï¼å¹¶äºè§£è¿ä¸ª html ææ¡£çç»æã\n\næ¹æ³\n\nå° html è§£ææä¸ä¸ªdocumentä¹åï¼å°±å¯ä»¥ä½¿ç¨ç±»ä¼¼äº dom çæ¹æ³è¿è¡æä½ãç¤ºä¾ä»£ç ï¼\n\nfile input = new file("/tmp/input.html");\ndocument doc = jsoup.parse(input, "utf-8", "http://example.com/");\n\nelement content = doc.getelementbyid("content");\nelements links = content.getelementsbytag("a");\nfor (element link : links) {\n  string linkhref = link.attr("href");\n  string linktext = link.text();\n}\n\n\nè¯´æ\n\nelements è¿ä¸ªå¯¹è±¡æä¾äºä¸ç³»åç±»ä¼¼äº dom çæ¹æ³æ¥æ¥æ¾åç´ ï¼æ½åå¹¶å¤çå¶ä¸­çæ°æ®ã\n\nå·ä½å¦ä¸ï¼\n\n# æ¥æ¾åç´ \n\n * getelementbyid(string id)\n * getelementsbytag(string tag)\n * getelementsbyclass(string classname)\n * getelementsbyattribute(string key) (and related methods)\n * element siblings: siblingelements(), firstelementsibling(), lastelementsibling();nextelementsibling(), previouselementsibling()\n * graph: parent(), children(), child(int index)\n\n# åç´ æ°æ®\n\n * attr(string key)è·åå±æ§attr(string key, string value)è®¾ç½®å±æ§\n * attributes()è·åææå±æ§\n * id(), classname() and classnames()\n * text()è·åææ¬åå®¹text(string value) è®¾ç½®ææ¬åå®¹\n * html()è·ååç´ å htmlhtml(string value)è®¾ç½®åç´ åç html åå®¹\n * outerhtml()è·ååç´ å¤ html åå®¹\n * data()è·åæ°æ®åå®¹ï¼ä¾å¦ï¼script å style æ ç­¾)\n * tag() and tagname()\n\n# æä½ html åææ¬\n\n * append(string html), prepend(string html)\n * appendtext(string text), prependtext(string text)\n * appendelement(string tagname), prependelement(string tagname)\n * html(string value)\n\n\n# ä½¿ç¨éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ \n\né®é¢\n\nä½ æ³ä½¿ç¨ç±»ä¼¼äº css æ jquery çè¯­æ³æ¥æ¥æ¾åæä½åç´ ã\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨element.select(string selector) å elements.select(string selector) æ¹æ³å®ç°ï¼\n\nfile input = new file("/tmp/input.html");\ndocument doc = jsoup.parse(input, "utf-8", "http://example.com/");\n\nelements links = doc.select("a[href]"); //å¸¦æhrefå±æ§çaåç´ \nelements pngs = doc.select("img[src$=.png]");\n  //æ©å±åä¸º.pngçå¾ç\n\nelement masthead = doc.select("div.masthead").first();\n  //classç­äºmastheadçdivæ ç­¾\n\nelements resultlinks = doc.select("h3.r > a"); //å¨h3åç´ ä¹åçaåç´ \n\n\n> è¯´æ\n> \n> jsoup elements å¯¹è±¡æ¯æç±»ä¼¼äºcss (æjquery)çéæ©å¨è¯­æ³ï¼æ¥å®ç°éå¸¸å¼ºå¤§åçµæ´»çæ¥æ¾åè½ã.\n> \n> è¿ä¸ªselect æ¹æ³å¨document, element,æelementså¯¹è±¡ä¸­é½å¯ä»¥ä½¿ç¨ãä¸æ¯ä¸ä¸æç¸å³çï¼å æ­¤å¯å®ç°æå®åç´ çè¿æ»¤ï¼æèé¾å¼éæ©è®¿é®ã\n> \n> select æ¹æ³å°è¿åä¸ä¸ªelementséåï¼å¹¶æä¾ä¸ç»æ¹æ³æ¥æ½ååå¤çç»æã\n\n# selector éæ©å¨æ¦è¿°\n\n * tagname: éè¿æ ç­¾æ¥æ¾åç´ ï¼æ¯å¦ï¼a\n * ns|tag: éè¿æ ç­¾å¨å½åç©ºé´æ¥æ¾åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨ fb|name è¯­æ³æ¥æ¥æ¾ `` åç´ \n * #id: éè¿ id æ¥æ¾åç´ ï¼æ¯å¦ï¼#logo\n * .class: éè¿ class åç§°æ¥æ¾åç´ ï¼æ¯å¦ï¼.masthead\n * [attribute]: å©ç¨å±æ§æ¥æ¾åç´ ï¼æ¯å¦ï¼[href]\n * [^attr]: å©ç¨å±æ§ååç¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨[^data-] æ¥æ¥æ¾å¸¦æ html5 dataset å±æ§çåç´ \n * [attr=value]: å©ç¨å±æ§å¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼[width=500]\n * [attr^=value], [attr$=value], [attr*=value]: å©ç¨å¹éå±æ§å¼å¼å¤´ãç»å°¾æåå«å±æ§å¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼[href*=/path/]\n * [attr\\~=regex]: å©ç¨å±æ§å¼å¹éæ­£åè¡¨è¾¾å¼æ¥æ¥æ¾åç´ ï¼æ¯å¦ï¼ img[src\\~=(?i)\\.(png|jpe?g)]\n * *: è¿ä¸ªç¬¦å·å°å¹éææåç´ \n\n# selector éæ©å¨ç»åä½¿ç¨\n\n * el##id: åç´ +idï¼æ¯å¦ï¼ div##logo\n * el.class: åç´ +classï¼æ¯å¦ï¼ div.masthead\n * el[attr]: åç´ +classï¼æ¯å¦ï¼ a[href]\n * ä»»æç»åï¼æ¯å¦ï¼a[href].highlight\n * ancestor child: æ¥æ¾æä¸ªåç´ ä¸å­åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨.body p æ¥æ¾å¨"body"åç´ ä¸çææpåç´ \n * parent > child: æ¥æ¾æä¸ªç¶åç´ ä¸çç´æ¥å­åç´ ï¼æ¯å¦ï¼å¯ä»¥ç¨div.content > p æ¥æ¾ p åç´ ï¼ä¹å¯ä»¥ç¨body > * æ¥æ¾ body æ ç­¾ä¸ææç´æ¥å­åç´ \n * siblinga + siblingb: æ¥æ¾å¨ a åç´ ä¹åç¬¬ä¸ä¸ªåçº§åç´  bï¼æ¯å¦ï¼div.head + div\n * siblinga \\~ siblingx: æ¥æ¾ a åç´ ä¹åçåçº§ x åç´ ï¼æ¯å¦ï¼h1 \\~ p\n * el, el, el:å¤ä¸ªéæ©å¨ç»åï¼æ¥æ¾å¹éä»»ä¸éæ©å¨çå¯ä¸åç´ ï¼ä¾å¦ï¼div.masthead, div.logo\n\n# ä¼ªéæ©å¨ selectors\n\n * :lt(n): æ¥æ¾åªäºåç´ çåçº§ç´¢å¼å¼ï¼å®çä½ç½®å¨ dom æ ä¸­æ¯ç¸å¯¹äºå®çç¶èç¹ï¼å°äº nï¼æ¯å¦ï¼td:lt(3) è¡¨ç¤ºå°äºä¸åçåç´ \n * :gt(n):æ¥æ¾åªäºåç´ çåçº§ç´¢å¼å¼å¤§äºn``ï¼æ¯å¦ï¼ div p:gt(2)è¡¨ç¤ºåªäº div ä¸­æåå« 2 ä¸ªä»¥ä¸ç p åç´ \n * :eq(n): æ¥æ¾åªäºåç´ çåçº§ç´¢å¼å¼ä¸nç¸ç­ï¼æ¯å¦ï¼form input:eq(1)è¡¨ç¤ºåå«ä¸ä¸ª input æ ç­¾ç form åç´ \n * :has(seletor): æ¥æ¾å¹ééæ©å¨åå«åç´ çåç´ ï¼æ¯å¦ï¼div:has(p)è¡¨ç¤ºåªäº div åå«äº p åç´ \n * :not(selector): æ¥æ¾ä¸éæ©å¨ä¸å¹éçåç´ ï¼æ¯å¦ï¼ div:not(.logo) è¡¨ç¤ºä¸åå« class=logo åç´ çææ div åè¡¨\n * :contains(text): æ¥æ¾åå«ç»å®ææ¬çåç´ ï¼æç´¢ä¸åºåå¤§ä¸åï¼æ¯å¦ï¼ p:contains(jsoup)\n * :containsown(text): æ¥æ¾ç´æ¥åå«ç»å®ææ¬çåç´ \n * :matches(regex): æ¥æ¾åªäºåç´ çææ¬å¹éæå®çæ­£åè¡¨è¾¾å¼ï¼æ¯å¦ï¼div:matches((?i)login)\n * :matchesown(regex): æ¥æ¾èªèº«åå«ææ¬å¹éæå®æ­£åè¡¨è¾¾å¼çåç´ \n * æ³¨æï¼ä¸è¿°ä¼ªéæ©å¨ç´¢å¼æ¯ä» 0 å¼å§çï¼ä¹å°±æ¯è¯´ç¬¬ä¸ä¸ªåç´ ç´¢å¼å¼ä¸º 0ï¼ç¬¬äºä¸ªåç´  index ä¸º 1 ç­\n\nå¯ä»¥æ¥çselector api åèæ¥äºè§£æ´è¯¦ç»çåå®¹\n\n\n# ä»åç´ æ½åå±æ§ï¼ææ¬å html\n\né®é¢\n\nå¨è§£æè·å¾ä¸ä¸ª document å®ä¾å¯¹è±¡ï¼å¹¶æ¥æ¾å°ä¸äºåç´ ä¹åï¼ä½ å¸æåå¾å¨è¿äºåç´ ä¸­çæ°æ®ã\n\næ¹æ³\n\n * è¦åå¾ä¸ä¸ªå±æ§çå¼ï¼å¯ä»¥ä½¿ç¨node.attr(string key) æ¹æ³\n * å¯¹äºä¸ä¸ªåç´ ä¸­çææ¬ï¼å¯ä»¥ä½¿ç¨element.text()æ¹æ³\n * å¯¹äºè¦åå¾åç´ æå±æ§ä¸­ç html åå®¹ï¼å¯ä»¥ä½¿ç¨element.html(), æ node.outerhtml()æ¹æ³\n\nç¤ºä¾ï¼\n\nstring html = "<p>an <a href=\'http://example.com/\'><b>example</b></a> link.</p>";\ndocument doc = jsoup.parse(html);//è§£æhtmlå­ç¬¦ä¸²è¿åä¸ä¸ªdocumentå®ç°\nelement link = doc.select("a").first();//æ¥æ¾ç¬¬ä¸ä¸ªaåç´ \n\nstring text = doc.body().text(); // "an example link"//åå¾å­ç¬¦ä¸²ä¸­çææ¬\nstring linkhref = link.attr("href"); // "http://example.com/"//åå¾é¾æ¥å°å\nstring linktext = link.text(); // "example""//åå¾é¾æ¥å°åä¸­çææ¬\n\nstring linkouterh = link.outerhtml();\n    // "<a href="http://example.com"><b>example</b></a>"\nstring linkinnerh = link.html(); // "<b>example</b>"//åå¾é¾æ¥åçhtmlåå®¹\n\n\n> è¯´æ\n> \n> ä¸è¿°æ¹æ³æ¯åç´ æ°æ®è®¿é®çæ ¸å¿åæ³ãæ­¤å¤è¿å¶å®ä¸äºæ¹æ³å¯ä»¥ä½¿ç¨ï¼\n> \n>  * element.id()\n>  * element.tagname()\n>  * element.classname() and element.hasclass(string classname)\n> \n> è¿äºè®¿é®å¨æ¹æ³é½æç¸åºç setter æ¹æ³æ¥æ´æ¹æ°æ®\n\nåè§\n\n * elementåelementséåç±»çåèææ¡£\n * urls å¤ç\n * ä½¿ç¨ css éæ©å¨è¯­æ³æ¥æ¥æ¾åç´ \n\n\n# å¤ç urls\n\né®é¢\n\nä½ æä¸ä¸ªåå«ç¸å¯¹ urls è·¯å¾ç html ææ¡£ï¼éè¦å°è¿äºç¸å¯¹è·¯å¾è½¬æ¢æç»å¯¹è·¯å¾ç urlsã\n\næ¹æ³\n\n 1. å¨ä½ è§£æææ¡£æ¶ç¡®ä¿ææå®base uriï¼ç¶å\n 2. ä½¿ç¨ abs: å±æ§åç¼æ¥åå¾åå«base uriçç»å¯¹è·¯å¾ãä»£ç å¦ä¸ï¼\n\ndocument doc = jsoup.connect("http://www.open-open.com").get();\n\nelement link = doc.select("a").first();\nstring relhref = link.attr("href"); // == "/"\nstring abshref = link.attr("abs:href"); // "http://www.open-open.com/"\n\n\n\n> è¯´æ\n> \n> å¨ html åç´ ä¸­ï¼urls ç»å¸¸åæç¸å¯¹äºææ¡£ä½ç½®çç¸å¯¹è·¯å¾ï¼ <a href="/download">...</a>. å½ä½ ä½¿ç¨ node.attr(string key) æ¹æ³æ¥åå¾ a åç´ ç href å±æ§æ¶ï¼å®å°ç´æ¥è¿åå¨ html æºç ä¸­æå®å®çå¼ã\n> \n> åå¦ä½ éè¦åå¾ä¸ä¸ªç»å¯¹è·¯å¾ï¼éè¦å¨å±æ§ååå  abs: åç¼ãè¿æ ·å°±å¯ä»¥è¿ååå«æ ¹è·¯å¾ç url å°åattr("abs:href")\n> \n> å æ­¤ï¼å¨è§£æ html ææ¡£æ¶ï¼å®ä¹ base uri éå¸¸éè¦ã\n> \n> å¦æä½ ä¸æ³ä½¿ç¨abs: åç¼ï¼è¿æä¸ä¸ªæ¹æ³è½å¤å®ç°åæ ·çåè½ node.absurl(string key)ã\n\n\n# æ°æ®ä¿®æ¹\n\n\n# è®¾ç½®å±æ§çå¼\n\né®é¢\n\nå¨ä½ è§£æä¸ä¸ª document ä¹åå¯è½æ³ä¿®æ¹å¶ä¸­çæäºå±æ§å¼ï¼ç¶ååä¿å­å°ç£çæé½è¾åºå°åå°é¡µé¢ã\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨å±æ§è®¾ç½®æ¹æ³ element.attr(string key, string value), å elements.attr(string key, string value).\n\nåå¦ä½ éè¦ä¿®æ¹ä¸ä¸ªåç´ ç class å±æ§ï¼å¯ä»¥ä½¿ç¨ element.addclass(string classname) åelement.removeclass(string classname) æ¹æ³ã\n\nelements æä¾äºæ¹éæä½åç´ å±æ§å class çæ¹æ³ï¼æ¯å¦ï¼è¦ä¸º div ä¸­çæ¯ä¸ä¸ª a åç´ é½æ·»å ä¸ä¸ªrel="nofollow" å¯ä»¥ä½¿ç¨å¦ä¸æ¹æ³ï¼\n\ndoc.select("div.comments a").attr("rel", "nofollow");\n\n\n\n> è¯´æ\n> \n> ä¸elementä¸­çå¶å®æ¹æ³ä¸æ ·ï¼attr æ¹æ³ä¹æ¯è¿åå½ element (æå¨ä½¿ç¨éæ©å¨æ¯è¿å elementséå)ãè¿æ ·è½å¤å¾æ¹ä¾¿ä½¿ç¨æ¹æ³è¿ç¨çä¹¦åæ¹å¼ãæ¯å¦ï¼\n> \n> doc.select("div.masthead").attr("title", "jsoup").addclass("round-box");\n\n\n# è®¾ç½®ä¸ä¸ªåç´ ç html åå®¹\n\né®é¢\n\nä½ éè¦ä¸ä¸ªåç´ ä¸­ç html åå®¹\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨elementä¸­ç html è®¾ç½®æ¹æ³å·ä½å¦ä¸ï¼\n\nelement div = doc.select("div").first(); // <div></div>\ndiv.html("<p>lorem ipsum</p>"); // <div><p>lorem ipsum</p></div>\ndiv.prepend("<p>first</p>");//å¨divåæ·»å htmlåå®¹\ndiv.append("<p>last</p>");//å¨divä¹åæ·»å htmlåå®¹\n// æ·»å®åçç»æ: <div><p>first</p><p>lorem ipsum</p><p>last</p></div>\n\nelement span = doc.select("span").first(); // <span>one</span>\nspan.wrap("<li><a href=\'http://example.com/\'></a></li>");\n// æ·»å®åçç»æ: <li><a href="http://example.com"><span>one</span></a></li>\n\n\n> è¯´æ\n> \n>  * element.html(string html) è¿ä¸ªæ¹æ³å°åæ¸é¤åç´ ä¸­ç html åå®¹ï¼ç¶åç¨ä¼ å¥ç html ä»£æ¿ã\n>  * element.prepend(string first) å element.append(string last) æ¹æ³ç¨äºå¨åå«å¨åç´ åé¨ html çåé¢ååé¢æ·»å  html åå®¹\n>  * element.wrap(string around) å¯¹åç´ åè£¹ä¸ä¸ªå¤é¨ html åå®¹ã\n> \n> åè§\n> \n> å¯ä»¥æ¥ç api åèææ¡£ä¸­ element.prependelement(string tag)åelement.appendelement(string tag) æ¹æ³æ¥åå»ºæ°çåç´ å¹¶ä½ä¸ºææ¡£çå­åç´ æå¥å¶ä¸­ã\n\n\n# è®¾ç½®åç´ çææ¬åå®¹\n\né®é¢\n\nä½ éè¦ä¿®æ¹ä¸ä¸ª html ææ¡£ä¸­çææ¬åå®¹\n\næ¹æ³\n\nå¯ä»¥ä½¿ç¨elementçè®¾ç½®æ¹æ³ï¼:\n\nelement div = doc.select("div").first(); // <div></div>\ndiv.text("five > four"); // <div>five &gt; four</div>\ndiv.prepend("first ");\ndiv.append(" last");\n// now: <div>first five &gt; four last</div>\n\n\n> è¯´æ\n> \n> ææ¬è®¾ç½®æ¹æ³ä¸ html setter æ¹æ³ä¸æ ·ï¼\n> \n>  * element.text(string text) å°æ¸é¤ä¸ä¸ªåç´ ä¸­çåé¨ html åå®¹ï¼ç¶åæä¾çææ¬è¿è¡ä»£æ¿\n>  * element.prepend(string first) å element.append(string last) å°åå«å¨åç´ çåé¨ html ååæ·»å ææ¬èç¹ã\n> \n> å¯¹äºä¼ å¥çææ¬å¦æå«æå <, > ç­è¿æ ·çå­ç¬¦ï¼å°ä»¥ææ¬å¤çï¼èé htmlã\n\n\n# html æ¸ç\n\n\n# æ¶é¤ä¸åä¿¡ä»»ç html (æ¥é²æ­¢ xss æ»å»)\n\né®é¢\n\nå¨åç½ç«çæ¶åï¼ç»å¸¸ä¼æä¾ç¨æ·è¯è®ºçåè½ãæäºä¸æå¥½æçç¨æ·ï¼ä¼æä¸äºèæ¬å°è¯è®ºåå®¹ä¸­ï¼èè¿äºèæ¬å¯è½ä¼ç ´åæ´ä¸ªé¡µé¢çè¡ä¸ºï¼æ´ä¸¥éçæ¯è·åä¸äºæºè¦ä¿¡æ¯ï¼æ­¤æ¶éè¦æ¸çè¯¥ htmlï¼ä»¥é¿åè·¨ç«èæ¬cross-site scriptingæ»å»ï¼xssï¼ã\n\næ¹æ³\n\nä½¿ç¨ jsoup html cleaner æ¹æ³è¿è¡æ¸é¤ï¼ä½éè¦æå®ä¸ä¸ªå¯éç½®ç whitelistã\n\nstring unsafe =\n  "<p><a href=\'http://example.com/\' onclick=\'stealcookies()\'>link</a></p>";\nstring safe = jsoup.clean(unsafe, whitelist.basic());\n// now: <p><a href="http://example.com/" rel="nofollow">link</a></p>\n\n\nè¯´æ\n\nxss åå« css (cross site script) ï¼è·¨ç«èæ¬æ»å»ãå®æçæ¯æ¶ææ»å»èå¾ web é¡µé¢éæå¥æ¶æ html ä»£ç ï¼å½ç¨æ·æµè§è¯¥é¡µä¹æ¶ï¼åµå¥å¶ä¸­ web éé¢ç html ä»£ç ä¼è¢«æ§è¡ï¼ä»èè¾¾å°æ¶ææ»å»ç¨æ·çç¹æ®ç®çãxss å±äºè¢«å¨å¼çæ»å»ï¼å ä¸ºå¶è¢«å¨ä¸ä¸å¥½å©ç¨ï¼æä»¥è®¸å¤äººå¸¸å¿½ç¥å¶å±å®³æ§ãæä»¥æä»¬ç»å¸¸åªè®©ç¨æ·è¾å¥çº¯ææ¬çåå®¹ï¼ä½è¿æ ·ç¨æ·ä½éªå°±æ¯è¾å·®äºã\n\nä¸ä¸ªæ´å¥½çè§£å³æ¹æ³å°±æ¯ä½¿ç¨ä¸ä¸ªå¯ææ¬ç¼è¾å¨ wysiwyg å¦ ckeditor å tinymceãè¿äºå¯ä»¥è¾åº html å¹¶è½å¤è®©ç¨æ·å¯è§åç¼è¾ãè½ç¶ä»ä»¬å¯ä»¥å¨å®¢æ·ç«¯è¿è¡æ ¡éªï¼ä½æ¯è¿æ ·è¿ä¸å¤å®å¨ï¼éè¦å¨æå¡å¨ç«¯è¿è¡æ ¡éªå¹¶æ¸é¤æå®³ç html ä»£ç ï¼è¿æ ·æè½ç¡®ä¿è¾å¥å°ä½ ç½ç«ç html æ¯å®å¨çãå¦åï¼æ»å»èè½å¤ç»è¿å®¢æ·ç«¯ç javascript éªè¯ï¼å¹¶æ³¨å¥ä¸å®å¨ç hmtl ç´æ¥è¿å¥æ¨çç½ç«ã\n\njsoup ç whitelist æ¸çå¨è½å¤å¨æå¡å¨ç«¯å¯¹ç¨æ·è¾å¥ç html è¿è¡è¿æ»¤ï¼åªè¾åºä¸äºå®å¨çæ ç­¾åå±æ§ã\n\njsoup æä¾äºä¸ç³»åç whitelist åºæ¬éç½®ï¼è½å¤æ»¡è¶³å¤§å¤æ°è¦æ±ï¼ä½å¦æå¿è¦ï¼ä¹å¯ä»¥è¿è¡ä¿®æ¹ï¼ä¸è¿è¦å°å¿ã\n\nè¿ä¸ª cleaner éå¸¸å¥½ç¨ä¸ä»å¯ä»¥é¿å xss æ»å»ï¼è¿å¯ä»¥éå¶ç¨æ·å¯ä»¥è¾å¥çæ ç­¾èå´ã\n\nåè§\n\n * åéxss cheat sheet ï¼æä¸ä¸ªä¾å­å¯ä»¥äºè§£ä¸ºä»ä¹ä¸è½ä½¿ç¨æ­£åè¡¨è¾¾å¼ï¼èéç¨å®å¨ç whitelist parser-based æ¸çå¨ææ¯æ­£ç¡®çéæ©ã\n * åécleaner ï¼äºè§£å¦ä½è¿åä¸ä¸ª document å¯¹è±¡ï¼èä¸æ¯å­ç¬¦ä¸²\n * åéwhitelistï¼äºè§£å¦ä½åå»ºä¸ä¸ªèªå®ä¹ç whitelist\n * nofollow é¾æ¥å±æ§äºè§£\n\n\n# åè\n\n * jsoup github æç®¡ä»£ç \n * jsoup cookbook\n * jsoup cookbook(ä¸­æç)\n * ä¸éç jsoup å­¦ä¹ ç¬è®°',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Thumbnailator å¿«éå¥é¨",frontmatter:{title:"Thumbnailator å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","å¾å½¢å¤ç","Thumbnailator"],abbrlink:"950b94a1",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/aa9f61/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/06.Thumbnailator.html",relativePath:"12.å·¥å·/99.å¶ä»/06.Thumbnailator.md",key:"v-aab99b9a",path:"/pages/aa9f61/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:25},{level:2,title:"æ ¸å¿ API",slug:"æ ¸å¿-api",normalizedTitle:"æ ¸å¿ api",charIndex:311},{level:3,title:"Thumbnails",slug:"thumbnails",normalizedTitle:"thumbnails",charIndex:124},{level:3,title:"Thumbnails.Builder",slug:"thumbnails-builder",normalizedTitle:"thumbnails.builder",charIndex:385},{level:4,title:"è®¾ç½®åæ°çå½æ°",slug:"è®¾ç½®åæ°çå½æ°",normalizedTitle:"è®¾ç½®åæ°çå½æ°",charIndex:1500},{level:4,title:"è¾åºå½æ°",slug:"è¾åºå½æ°",normalizedTitle:"è¾åºå½æ°",charIndex:2140},{level:3,title:"å·¥ä½æµ",slug:"å·¥ä½æµ",normalizedTitle:"å·¥ä½æµ",charIndex:3099},{level:2,title:"å®æ",slug:"å®æ",normalizedTitle:"å®æ",charIndex:3307},{level:3,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:3420},{level:3,title:"å¾çç¼©æ¾",slug:"å¾çç¼©æ¾",normalizedTitle:"å¾çç¼©æ¾",charIndex:3578},{level:3,title:"å¾çæè½¬",slug:"å¾çæè½¬",normalizedTitle:"å¾çæè½¬",charIndex:3945},{level:3,title:"å æ°´å°",slug:"å æ°´å°",normalizedTitle:"å æ°´å°",charIndex:85},{level:3,title:"æ¹éå¤çå¾ç",slug:"æ¹éå¤çå¾ç",normalizedTitle:"æ¹éå¤çå¾ç",charIndex:4569},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:3274}],headersStr:"ç®ä» æ ¸å¿ API Thumbnails Thumbnails.Builder è®¾ç½®åæ°çå½æ° è¾åºå½æ° å·¥ä½æµ å®æ å®è£ å¾çç¼©æ¾ å¾çæè½¬ å æ°´å° æ¹éå¤çå¾ç åè",content:'# Thumbnailator å¿«éå¥é¨\n\n\n# ç®ä»\n\nThumbnailator æ¯ä¸ä¸ªå¼æºç Java é¡¹ç®ï¼å®æä¾äºéå¸¸ç®åç API æ¥å¯¹å¾çè¿è¡ç¼©æ¾ãæè½¬ä»¥åå æ°´å°çå¤çã\n\næå¤ç®åå¢ï¼ç®åå°ä¸è¡ä»£ç å°±å¯ä»¥å®æå¾çå¤çãå½¢å¼å¦ä¸ï¼\n\nThumbnails.of(new File("path/to/directory").listFiles())\n    .size(640, 480)\n    .outputFormat("jpg")\n    .toFiles(Rename.PREFIX_DOT_THUMBNAIL);\n\n\nå½ç¶ï¼Thumbnailator è¿æä¸äºä½¿ç¨ç»èï¼ä¸é¢æä¼ä¸ä¸éæ¥ã\n\n\n# æ ¸å¿ API\n\n\n# Thumbnails\n\nThumbnails æ¯ä½¿ç¨ Thumbnailator åå»ºç¼©ç¥å¾çä¸»å¥å£ã\n\nå®æä¾äºä¸ç»åå§å Thumbnails.Builder çæ¥å£ã\n\nåçä¸è¿ç»æ¥å£çå£°æï¼\n\n// å¯åé¿åº¦åæ°åè¡¨\npublic static Builder<File> of(String... files) {...}\npublic static Builder<File> of(File... files) {...}\npublic static Builder<URL> of(URL... urls) {...}\npublic static Builder<? extends InputStream> of(InputStream... inputStreams) {...}\npublic static Builder<BufferedImage> of(BufferedImage... images) {...}\n// è¿­ä»£å¨ï¼ææå®ç° Iterable æ¥å£ç Java å¯¹è±¡é½å¯ä»¥ï¼å½ç¶ä¹åæ¬ ListãSetï¼\npublic static Builder<File> fromFilenames(Iterable<String> files) {...}\npublic static Builder<File> fromFiles(Iterable<File> files) {...}\npublic static Builder<URL> fromURLs(Iterable<URL> urls) {...}\npublic static Builder<InputStream> fromInputStreams(Iterable<? extends InputStream> inputStreams) {...}\npublic static Builder<BufferedImage> fromImages(Iterable<BufferedImage> images) {...}\n\n\nå¾æ¾ç¶ï¼Thumbnails åè®¸éè¿ä¼ å¥æä»¶åãæä»¶ãç½ç»å¾ç URLãå¾çæµãå¾çç¼å­å¤ç§æ¹å¼æ¥åå§åæé å¨ã\n\nå æ­¤ï¼ä½ å¯ä»¥æ ¹æ®å®ééæ±æ¥çµæ´»çéæ©å¾ççè¾å¥æ¹å¼ã\n\néè¦æ³¨æä¸ç¹ï¼å¦æè¾å¥æ¯å¤ä¸ªå¯¹è±¡ï¼æ è®ºä½ æ¯ç´æ¥è¾å¥å®¹å¨å¯¹è±¡æä½¿ç¨å¯ååæ°æ¹å¼ä¼ å¥å¤ä¸ªå¯¹è±¡ï¼ï¼åè¾åºä¹å¿é¡»éç¨è¾åºå¤ä¸ªå¯¹è±¡çæ¹å¼ï¼å¦åä¼æ¥å¼å¸¸ã\n\n\n# Thumbnails.Builder\n\nThumbnails.Builder æ¯ Thumbnails çåé¨éæç±»ãå®ç¨äºè®¾ç½®çæç¼©ç¥å¾ä»»å¡çç¸å³åæ°ã\n\næ³¨ï¼Thumbnails.Builder çæé å½æ°æ¯ç§æå½æ°ãæä»¥ï¼å®åªåè®¸éè¿ Thumbnails çå®ä¾åå½æ°æ¥è¿è¡åå§åã\n\n# è®¾ç½®åæ°çå½æ°\n\nThumbnails.Builder æä¾äºä¸ç»å½æ°é¾å½¢å¼çæ¥å£æ¥è®¾ç½®ç¼©æ¾å¾åæ°ã\n\nä»¥è®¾ç½®å¤§å°å½æ°ä¸ºä¾ï¼\n\npublic Builder<T> size(int width, int height)\n{\n updateStatus(Properties.SIZE, Status.ALREADY_SET);\n updateStatus(Properties.SCALE, Status.CANNOT_SET);\n\n validateDimensions(width, height);\n this.width = width;\n this.height = height;\n\n return this;\n}\n\n\néè¿è¿å this æéï¼ä½¿å¾è®¾ç½®åæ°å½æ°å¯ä»¥ä»¥é¾å¼è°ç¨çæ¹å¼æ¥ä½¿ç¨ï¼å½¢å¼å¦ä¸ï¼\n\nThumbnails.of(new File("original.jpg"))\n        .size(160, 160)\n        .rotate(90)\n        .watermark(Positions.BOTTOM_RIGHT, ImageIO.read(new File("watermark.png")), 0.5f)\n        .outputQuality(0.8)\n        .toFile(new File("image-with-watermark.jpg"));\n\n\nå¥½å¤ï¼ä¸è¨èªæï¼é£å°±æ¯å¤§å¤§ç®åäºä»£ç ã\n\n# è¾åºå½æ°\n\nThumbnails.Builder æä¾äºä¸ç»éè½½å½æ°æ¥è¾åºçæçç¼©æ¾å¾ã\n\nå½æ°å£°æå¦ä¸ï¼\n\n// è¿åå¾çç¼å­\npublic List<BufferedImage> asBufferedImages() throws IOException {...}\npublic BufferedImage asBufferedImage() throws IOException {...}\n// è¿åæä»¶åè¡¨\npublic List<File> asFiles(Iterable<File> iterable) throws IOException {...}\npublic List<File> asFiles(Rename rename) throws IOException {...}\npublic List<File> asFiles(File destinationDir, Rename rename) throws IOException {...}\n// åå»ºæä»¶\npublic void toFile(File outFile) throws IOException {...}\npublic void toFile(String outFilepath) throws IOException {...}\npublic void toFiles(Iterable<File> iterable) throws IOException {...}\npublic void toFiles(Rename rename) throws IOException {...}\npublic void toFiles(File destinationDir, Rename rename) throws IOException {...}\n// åå»ºè¾åºæµ\npublic void toOutputStream(OutputStream os) throws IOException {...}\npublic void toOutputStreams(Iterable<? extends OutputStream> iterable) throws IOException {...}\n\n\n\n# å·¥ä½æµ\n\nThumbnailator çå·¥ä½æ­¥éª¤ååç®åï¼å¯åä¸ºä¸æ­¥ï¼\n\n 1. è¾å¥ï¼Thumbnails æ ¹æ®è¾å¥åå§åæé å¨ââ Thumbnails.Builder ã\n\n 2. è®¾ç½®ï¼Thumbnails.Builder è®¾ç½®ç¼©æ¾å¾ççåæ°ã\n\n 3. è¾åºï¼Thumbnails.Builder è¾åºå¾çæä»¶æå¾çæµã\n\n> æ´å¤è¯¦æå¯ä»¥åèï¼ Thumbnailator å®ç½ javadoc\n\n\n# å®æ\n\nåæä»ç»äº Thumbnailator çæ ¸å¿ APIï¼æ¥ä¸æ¥æä»¬å°±å¯ä»¥éè¿å®ææ¥çç Thumbnailator ç©¶ç«å¯ä»¥åäºä»ä¹ã\n\nThumbnailator çæä»ä¹æ ·çå¾çï¼æ¯æ ¹æ®è®¾ç½®åæ°æ¥å³å®çã\n\n\n# å®è£\n\nmaven é¡¹ç®ä¸­å¼å¥ä¾èµï¼\n\n<dependency>\n  <groupId>net.coobird</groupId>\n  <artifactId>thumbnailator</artifactId>\n  <version>[0.4, 0.5)</version>\n</dependency>\n\n\n\n# å¾çç¼©æ¾\n\nThumbnails.Builder ç size å½æ°å¯ä»¥è®¾ç½®æ°å¾çç²¾ç¡®çå®½åº¦åé«åº¦ï¼ä¹å¯ä»¥ç¨ scale å½æ°è®¾ç½®ç¼©æ¾æ¯ä¾ã\n\nThumbnails.of("oldFile.png")\n  .size(16, 16)\n  .toFile("newFile_16_16.png");\n\nThumbnails.of("oldFile.png")\n  .scale(2.0)\n  .toFile("newFile_scale_2.0.png");\n\nThumbnails.of("oldFile.png")\n  .scale(1.0, 0.5)\n  .toFile("newFile_scale_1.0_0.5.png");\n\n\noldFile.png\n\n\n\nnewFile_scale_1.0_0.5.png\n\n\n\n\n# å¾çæè½¬\n\nThumbnails.Builder ç size å½æ°å¯ä»¥è®¾ç½®æ°å¾ççæè½¬è§åº¦ã\n\nThumbnails.of("oldFile.png")\n  .scale(0.8)\n  .rotate(90)\n  .toFile("newFile_rotate_90.png");\n\nThumbnails.of("oldFile.png")\n  .scale(0.8)\n  .rotate(180)\n  .toFile("newFile_rotate_180.png");\n\n\nnewFile_rotate_90.png\n\n\n\n\n# å æ°´å°\n\nThumbnails.Builder ç watermark å½æ°å¯ä»¥ä¸ºå¾çæ·»å æ°´å°å¾çãç¬¬ä¸ä¸ªåæ°æ¯æ°´å°çä½ç½®ï¼ç¬¬äºä¸ªåæ°æ¯æ°´å°å¾ççç¼å­æ°æ®ï¼ç¬¬ä¸ä¸ªåæ°æ¯éæåº¦ã\n\nBufferedImage watermarkImage = ImageIO.read(new File("wartermarkFile.png"));\nThumbnails.of("oldFile.png")\n  .scale(0.8)\n  .watermark(Positions.BOTTOM_LEFT, watermarkImage, 0.5f)\n  .toFile("newFile_watermark.png");\n\n\nwartermarkFile.png\n\n\n\nnewFile_watermark.png\n\n\n\n\n# æ¹éå¤çå¾ç\n\nä¸é¢ä»¥æ¹éç»å¾çå æ°´å°æ¥å±ç¤ºä¸ä¸å¦ä½å¤çå¤ä¸ªå¾çæä»¶ã\n\nBufferedImage watermarkImage = ImageIO.read(new File("wartermarkFile.png"));\n\nFile destinationDir = new File("D:\\\\watermark\\\\");\nThumbnails.of("oldFile.png", "oldFile2.png")\n  .scale(0.8)\n  .watermark(Positions.BOTTOM_LEFT, watermarkImage, 0.5f)\n  .toFiles(destinationDir, Rename.PREFIX_DOT_THUMBNAIL);\n\n\n> éè¦åèå®æ´æµè¯ä¾ä»£ç è¯· ç¹å»è¿é\n\n\n# åè\n\nThumbnailator å®æ¹ç¤ºä¾ææ¡£',normalizedContent:'# thumbnailator å¿«éå¥é¨\n\n\n# ç®ä»\n\nthumbnailator æ¯ä¸ä¸ªå¼æºç java é¡¹ç®ï¼å®æä¾äºéå¸¸ç®åç api æ¥å¯¹å¾çè¿è¡ç¼©æ¾ãæè½¬ä»¥åå æ°´å°çå¤çã\n\næå¤ç®åå¢ï¼ç®åå°ä¸è¡ä»£ç å°±å¯ä»¥å®æå¾çå¤çãå½¢å¼å¦ä¸ï¼\n\nthumbnails.of(new file("path/to/directory").listfiles())\n    .size(640, 480)\n    .outputformat("jpg")\n    .tofiles(rename.prefix_dot_thumbnail);\n\n\nå½ç¶ï¼thumbnailator è¿æä¸äºä½¿ç¨ç»èï¼ä¸é¢æä¼ä¸ä¸éæ¥ã\n\n\n# æ ¸å¿ api\n\n\n# thumbnails\n\nthumbnails æ¯ä½¿ç¨ thumbnailator åå»ºç¼©ç¥å¾çä¸»å¥å£ã\n\nå®æä¾äºä¸ç»åå§å thumbnails.builder çæ¥å£ã\n\nåçä¸è¿ç»æ¥å£çå£°æï¼\n\n// å¯åé¿åº¦åæ°åè¡¨\npublic static builder<file> of(string... files) {...}\npublic static builder<file> of(file... files) {...}\npublic static builder<url> of(url... urls) {...}\npublic static builder<? extends inputstream> of(inputstream... inputstreams) {...}\npublic static builder<bufferedimage> of(bufferedimage... images) {...}\n// è¿­ä»£å¨ï¼ææå®ç° iterable æ¥å£ç java å¯¹è±¡é½å¯ä»¥ï¼å½ç¶ä¹åæ¬ listãsetï¼\npublic static builder<file> fromfilenames(iterable<string> files) {...}\npublic static builder<file> fromfiles(iterable<file> files) {...}\npublic static builder<url> fromurls(iterable<url> urls) {...}\npublic static builder<inputstream> frominputstreams(iterable<? extends inputstream> inputstreams) {...}\npublic static builder<bufferedimage> fromimages(iterable<bufferedimage> images) {...}\n\n\nå¾æ¾ç¶ï¼thumbnails åè®¸éè¿ä¼ å¥æä»¶åãæä»¶ãç½ç»å¾ç urlãå¾çæµãå¾çç¼å­å¤ç§æ¹å¼æ¥åå§åæé å¨ã\n\nå æ­¤ï¼ä½ å¯ä»¥æ ¹æ®å®ééæ±æ¥çµæ´»çéæ©å¾ççè¾å¥æ¹å¼ã\n\néè¦æ³¨æä¸ç¹ï¼å¦æè¾å¥æ¯å¤ä¸ªå¯¹è±¡ï¼æ è®ºä½ æ¯ç´æ¥è¾å¥å®¹å¨å¯¹è±¡æä½¿ç¨å¯ååæ°æ¹å¼ä¼ å¥å¤ä¸ªå¯¹è±¡ï¼ï¼åè¾åºä¹å¿é¡»éç¨è¾åºå¤ä¸ªå¯¹è±¡çæ¹å¼ï¼å¦åä¼æ¥å¼å¸¸ã\n\n\n# thumbnails.builder\n\nthumbnails.builder æ¯ thumbnails çåé¨éæç±»ãå®ç¨äºè®¾ç½®çæç¼©ç¥å¾ä»»å¡çç¸å³åæ°ã\n\næ³¨ï¼thumbnails.builder çæé å½æ°æ¯ç§æå½æ°ãæä»¥ï¼å®åªåè®¸éè¿ thumbnails çå®ä¾åå½æ°æ¥è¿è¡åå§åã\n\n# è®¾ç½®åæ°çå½æ°\n\nthumbnails.builder æä¾äºä¸ç»å½æ°é¾å½¢å¼çæ¥å£æ¥è®¾ç½®ç¼©æ¾å¾åæ°ã\n\nä»¥è®¾ç½®å¤§å°å½æ°ä¸ºä¾ï¼\n\npublic builder<t> size(int width, int height)\n{\n updatestatus(properties.size, status.already_set);\n updatestatus(properties.scale, status.cannot_set);\n\n validatedimensions(width, height);\n this.width = width;\n this.height = height;\n\n return this;\n}\n\n\néè¿è¿å this æéï¼ä½¿å¾è®¾ç½®åæ°å½æ°å¯ä»¥ä»¥é¾å¼è°ç¨çæ¹å¼æ¥ä½¿ç¨ï¼å½¢å¼å¦ä¸ï¼\n\nthumbnails.of(new file("original.jpg"))\n        .size(160, 160)\n        .rotate(90)\n        .watermark(positions.bottom_right, imageio.read(new file("watermark.png")), 0.5f)\n        .outputquality(0.8)\n        .tofile(new file("image-with-watermark.jpg"));\n\n\nå¥½å¤ï¼ä¸è¨èªæï¼é£å°±æ¯å¤§å¤§ç®åäºä»£ç ã\n\n# è¾åºå½æ°\n\nthumbnails.builder æä¾äºä¸ç»éè½½å½æ°æ¥è¾åºçæçç¼©æ¾å¾ã\n\nå½æ°å£°æå¦ä¸ï¼\n\n// è¿åå¾çç¼å­\npublic list<bufferedimage> asbufferedimages() throws ioexception {...}\npublic bufferedimage asbufferedimage() throws ioexception {...}\n// è¿åæä»¶åè¡¨\npublic list<file> asfiles(iterable<file> iterable) throws ioexception {...}\npublic list<file> asfiles(rename rename) throws ioexception {...}\npublic list<file> asfiles(file destinationdir, rename rename) throws ioexception {...}\n// åå»ºæä»¶\npublic void tofile(file outfile) throws ioexception {...}\npublic void tofile(string outfilepath) throws ioexception {...}\npublic void tofiles(iterable<file> iterable) throws ioexception {...}\npublic void tofiles(rename rename) throws ioexception {...}\npublic void tofiles(file destinationdir, rename rename) throws ioexception {...}\n// åå»ºè¾åºæµ\npublic void tooutputstream(outputstream os) throws ioexception {...}\npublic void tooutputstreams(iterable<? extends outputstream> iterable) throws ioexception {...}\n\n\n\n# å·¥ä½æµ\n\nthumbnailator çå·¥ä½æ­¥éª¤ååç®åï¼å¯åä¸ºä¸æ­¥ï¼\n\n 1. è¾å¥ï¼thumbnails æ ¹æ®è¾å¥åå§åæé å¨ââ thumbnails.builder ã\n\n 2. è®¾ç½®ï¼thumbnails.builder è®¾ç½®ç¼©æ¾å¾ççåæ°ã\n\n 3. è¾åºï¼thumbnails.builder è¾åºå¾çæä»¶æå¾çæµã\n\n> æ´å¤è¯¦æå¯ä»¥åèï¼ thumbnailator å®ç½ javadoc\n\n\n# å®æ\n\nåæä»ç»äº thumbnailator çæ ¸å¿ apiï¼æ¥ä¸æ¥æä»¬å°±å¯ä»¥éè¿å®ææ¥çç thumbnailator ç©¶ç«å¯ä»¥åäºä»ä¹ã\n\nthumbnailator çæä»ä¹æ ·çå¾çï¼æ¯æ ¹æ®è®¾ç½®åæ°æ¥å³å®çã\n\n\n# å®è£\n\nmaven é¡¹ç®ä¸­å¼å¥ä¾èµï¼\n\n<dependency>\n  <groupid>net.coobird</groupid>\n  <artifactid>thumbnailator</artifactid>\n  <version>[0.4, 0.5)</version>\n</dependency>\n\n\n\n# å¾çç¼©æ¾\n\nthumbnails.builder ç size å½æ°å¯ä»¥è®¾ç½®æ°å¾çç²¾ç¡®çå®½åº¦åé«åº¦ï¼ä¹å¯ä»¥ç¨ scale å½æ°è®¾ç½®ç¼©æ¾æ¯ä¾ã\n\nthumbnails.of("oldfile.png")\n  .size(16, 16)\n  .tofile("newfile_16_16.png");\n\nthumbnails.of("oldfile.png")\n  .scale(2.0)\n  .tofile("newfile_scale_2.0.png");\n\nthumbnails.of("oldfile.png")\n  .scale(1.0, 0.5)\n  .tofile("newfile_scale_1.0_0.5.png");\n\n\noldfile.png\n\n\n\nnewfile_scale_1.0_0.5.png\n\n\n\n\n# å¾çæè½¬\n\nthumbnails.builder ç size å½æ°å¯ä»¥è®¾ç½®æ°å¾ççæè½¬è§åº¦ã\n\nthumbnails.of("oldfile.png")\n  .scale(0.8)\n  .rotate(90)\n  .tofile("newfile_rotate_90.png");\n\nthumbnails.of("oldfile.png")\n  .scale(0.8)\n  .rotate(180)\n  .tofile("newfile_rotate_180.png");\n\n\nnewfile_rotate_90.png\n\n\n\n\n# å æ°´å°\n\nthumbnails.builder ç watermark å½æ°å¯ä»¥ä¸ºå¾çæ·»å æ°´å°å¾çãç¬¬ä¸ä¸ªåæ°æ¯æ°´å°çä½ç½®ï¼ç¬¬äºä¸ªåæ°æ¯æ°´å°å¾ççç¼å­æ°æ®ï¼ç¬¬ä¸ä¸ªåæ°æ¯éæåº¦ã\n\nbufferedimage watermarkimage = imageio.read(new file("wartermarkfile.png"));\nthumbnails.of("oldfile.png")\n  .scale(0.8)\n  .watermark(positions.bottom_left, watermarkimage, 0.5f)\n  .tofile("newfile_watermark.png");\n\n\nwartermarkfile.png\n\n\n\nnewfile_watermark.png\n\n\n\n\n# æ¹éå¤çå¾ç\n\nä¸é¢ä»¥æ¹éç»å¾çå æ°´å°æ¥å±ç¤ºä¸ä¸å¦ä½å¤çå¤ä¸ªå¾çæä»¶ã\n\nbufferedimage watermarkimage = imageio.read(new file("wartermarkfile.png"));\n\nfile destinationdir = new file("d:\\\\watermark\\\\");\nthumbnails.of("oldfile.png", "oldfile2.png")\n  .scale(0.8)\n  .watermark(positions.bottom_left, watermarkimage, 0.5f)\n  .tofiles(destinationdir, rename.prefix_dot_thumbnail);\n\n\n> éè¦åèå®æ´æµè¯ä¾ä»£ç è¯· ç¹å»è¿é\n\n\n# åè\n\nthumbnailator å®æ¹ç¤ºä¾ææ¡£',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"ZXing å¿«éå¥é¨",frontmatter:{title:"ZXing å¿«éå¥é¨",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","æ¡å½¢ç ","ZXing"],abbrlink:"b465c57d",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/cc8ce5/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/99.%E5%85%B6%E4%BB%96/07.Zxing.html",relativePath:"12.å·¥å·/99.å¶ä»/07.Zxing.md",key:"v-4c05d3a6",path:"/pages/cc8ce5/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:17},{level:2,title:"å®æ",slug:"å®æ",normalizedTitle:"å®æ",charIndex:164},{level:3,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:223},{level:3,title:"çæäºç»´ç å¾ç",slug:"çæäºç»´ç å¾ç",normalizedTitle:"çæäºç»´ç å¾ç",charIndex:529},{level:3,title:"è§£æäºç»´ç å¾ç",slug:"è§£æäºç»´ç å¾ç",normalizedTitle:"è§£æäºç»´ç å¾ç",charIndex:210},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:2066}],headersStr:"ç®ä» å®æ å®è£ çæäºç»´ç å¾ç è§£æäºç»´ç å¾ç åè",content:'# ZXing å¿«éå¥é¨\n\n\n# ç®ä»\n\nZXing æ¯ä¸ä¸ªå¼æº Java ç±»åºç¨äºè§£æå¤ç§æ ¼å¼ç 1D/2D æ¡å½¢ç ãç®æ æ¯è½å¤å¯¹ QR ç¼ç ãData MatrixãUPC ç 1D æ¡å½¢ç è¿è¡è§£ç ã å¶æä¾äºå¤ç§å¹³å°ä¸çå®¢æ·ç«¯åæ¬ï¼J2MEãJ2SE å Androidã\n\nå®ç½ï¼ZXing github ä»åº\n\n\n# å®æ\n\næ¬ä¾æ¼ç¤ºå¦ä½å¨ä¸ä¸ªé android ç Java é¡¹ç®ä¸­ä½¿ç¨ ZXing æ¥çæãè§£æäºç»´ç å¾çã\n\n\n# å®è£\n\nmaven é¡¹ç®åªéå¼å¥ä¾èµï¼\n\n<dependency>\n  <groupId>com.google.zxing</groupId>\n  <artifactId>core</artifactId>\n  <version>3.3.0</version>\n</dependency>\n<dependency>\n  <groupId>com.google.zxing</groupId>\n  <artifactId>javase</artifactId>\n  <version>3.3.0</version>\n</dependency>\n\n\nå¦æé maven é¡¹ç®ï¼å°±å»å®ç½ä¸è½½åå¸çæ¬ï¼ä¸è½½å°å\n\n\n# çæäºç»´ç å¾ç\n\nZXing çæäºç»´ç å¾çæä»¥ä¸æ­¥éª¤ï¼\n\n 1. com.google.zxing.MultiFormatWriter æ ¹æ®åå®¹ä»¥åå¾åç¼ç åæ°çæå¾å 2D ç©éµã\n 2. com.google.zxing.client.j2se.MatrixToImageWriter æ ¹æ®å¾åç©éµçæå¾çæä»¶æå¾çç¼å­ BufferedImage ã\n\npublic void encode(String content, String filepath) throws WriterException, IOException {\n int width = 100;\n int height = 100;\n Map<EncodeHintType, Object> encodeHints = new HashMap<EncodeHintType, Object>();\n encodeHints.put(EncodeHintType.CHARACTER_SET, "UTF-8");\n BitMatrix bitMatrix = new MultiFormatWriter().encode(content, BarcodeFormat.QR_CODE, width, height, encodeHints);\n Path path = FileSystems.getDefault().getPath(filepath);\n MatrixToImageWriter.writeToPath(bitMatrix, "png", path);\n}\n\n\n\n# è§£æäºç»´ç å¾ç\n\nZXing è§£æäºç»´ç å¾çæä»¥ä¸æ­¥éª¤ï¼\n\n 1. ä½¿ç¨ javax.imageio.ImageIO è¯»åå¾çæä»¶ï¼å¹¶å­ä¸ºä¸ä¸ª java.awt.image.BufferedImage å¯¹è±¡ã\n\n 2. å° java.awt.image.BufferedImage è½¬æ¢ä¸º ZXing è½è¯å«ç com.google.zxing.BinaryBitmap å¯¹è±¡ã\n\n 3. com.google.zxing.MultiFormatReader æ ¹æ®å¾åè§£ç åæ°æ¥è§£æ com.google.zxing.BinaryBitmap ã\n\npublic String decode(String filepath) throws IOException, NotFoundException {\n BufferedImage bufferedImage = ImageIO.read(new FileInputStream(filepath));\n LuminanceSource source = new BufferedImageLuminanceSource(bufferedImage);\n Binarizer binarizer = new HybridBinarizer(source);\n BinaryBitmap bitmap = new BinaryBitmap(binarizer);\n HashMap<DecodeHintType, Object> decodeHints = new HashMap<DecodeHintType, Object>();\n decodeHints.put(DecodeHintType.CHARACTER_SET, "UTF-8");\n Result result = new MultiFormatReader().decode(bitmap, decodeHints);\n return result.getText();\n}\n\n\nå®æ´åèç¤ºä¾ï¼æµè¯ä¾ä»£ç \n\nä»¥ä¸æ¯ä¸ä¸ªçæçäºç»´ç å¾çç¤ºä¾ï¼\n\n\n\n\n# åè\n\nZXing github ä»åº',normalizedContent:'# zxing å¿«éå¥é¨\n\n\n# ç®ä»\n\nzxing æ¯ä¸ä¸ªå¼æº java ç±»åºç¨äºè§£æå¤ç§æ ¼å¼ç 1d/2d æ¡å½¢ç ãç®æ æ¯è½å¤å¯¹ qr ç¼ç ãdata matrixãupc ç 1d æ¡å½¢ç è¿è¡è§£ç ã å¶æä¾äºå¤ç§å¹³å°ä¸çå®¢æ·ç«¯åæ¬ï¼j2meãj2se å androidã\n\nå®ç½ï¼zxing github ä»åº\n\n\n# å®æ\n\næ¬ä¾æ¼ç¤ºå¦ä½å¨ä¸ä¸ªé android ç java é¡¹ç®ä¸­ä½¿ç¨ zxing æ¥çæãè§£æäºç»´ç å¾çã\n\n\n# å®è£\n\nmaven é¡¹ç®åªéå¼å¥ä¾èµï¼\n\n<dependency>\n  <groupid>com.google.zxing</groupid>\n  <artifactid>core</artifactid>\n  <version>3.3.0</version>\n</dependency>\n<dependency>\n  <groupid>com.google.zxing</groupid>\n  <artifactid>javase</artifactid>\n  <version>3.3.0</version>\n</dependency>\n\n\nå¦æé maven é¡¹ç®ï¼å°±å»å®ç½ä¸è½½åå¸çæ¬ï¼ä¸è½½å°å\n\n\n# çæäºç»´ç å¾ç\n\nzxing çæäºç»´ç å¾çæä»¥ä¸æ­¥éª¤ï¼\n\n 1. com.google.zxing.multiformatwriter æ ¹æ®åå®¹ä»¥åå¾åç¼ç åæ°çæå¾å 2d ç©éµã\n 2. com.google.zxing.client.j2se.matrixtoimagewriter æ ¹æ®å¾åç©éµçæå¾çæä»¶æå¾çç¼å­ bufferedimage ã\n\npublic void encode(string content, string filepath) throws writerexception, ioexception {\n int width = 100;\n int height = 100;\n map<encodehinttype, object> encodehints = new hashmap<encodehinttype, object>();\n encodehints.put(encodehinttype.character_set, "utf-8");\n bitmatrix bitmatrix = new multiformatwriter().encode(content, barcodeformat.qr_code, width, height, encodehints);\n path path = filesystems.getdefault().getpath(filepath);\n matrixtoimagewriter.writetopath(bitmatrix, "png", path);\n}\n\n\n\n# è§£æäºç»´ç å¾ç\n\nzxing è§£æäºç»´ç å¾çæä»¥ä¸æ­¥éª¤ï¼\n\n 1. ä½¿ç¨ javax.imageio.imageio è¯»åå¾çæä»¶ï¼å¹¶å­ä¸ºä¸ä¸ª java.awt.image.bufferedimage å¯¹è±¡ã\n\n 2. å° java.awt.image.bufferedimage è½¬æ¢ä¸º zxing è½è¯å«ç com.google.zxing.binarybitmap å¯¹è±¡ã\n\n 3. com.google.zxing.multiformatreader æ ¹æ®å¾åè§£ç åæ°æ¥è§£æ com.google.zxing.binarybitmap ã\n\npublic string decode(string filepath) throws ioexception, notfoundexception {\n bufferedimage bufferedimage = imageio.read(new fileinputstream(filepath));\n luminancesource source = new bufferedimageluminancesource(bufferedimage);\n binarizer binarizer = new hybridbinarizer(source);\n binarybitmap bitmap = new binarybitmap(binarizer);\n hashmap<decodehinttype, object> decodehints = new hashmap<decodehinttype, object>();\n decodehints.put(decodehinttype.character_set, "utf-8");\n result result = new multiformatreader().decode(bitmap, decodehints);\n return result.gettext();\n}\n\n\nå®æ´åèç¤ºä¾ï¼æµè¯ä¾ä»£ç \n\nä»¥ä¸æ¯ä¸ä¸ªçæçäºç»´ç å¾çç¤ºä¾ï¼\n\n\n\n\n# åè\n\nzxing github ä»åº',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java å·¥å·",frontmatter:{title:"Java å·¥å·",categories:["ç¼ç¨","Java","å·¥å·"],tags:["Java","å·¥å·"],abbrlink:13035347,date:"2022-02-18T08:53:11.000Z",hidden:!0,permalink:"/pages/4b6820/"},regularPath:"/12.%E5%B7%A5%E5%85%B7/",relativePath:"12.å·¥å·/README.md",key:"v-ed73b8ba",path:"/pages/4b6820/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:14},{level:3,title:"Java IO",slug:"java-io",normalizedTitle:"java io",charIndex:24},{level:3,title:"JavaBean å·¥å·",slug:"javabean-å·¥å·",normalizedTitle:"javabean å·¥å·",charIndex:118},{level:3,title:"Java æ¨¡æ¿å¼æ",slug:"java-æ¨¡æ¿å¼æ",normalizedTitle:"java æ¨¡æ¿å¼æ",charIndex:154},{level:3,title:"Java æµè¯å·¥å·",slug:"java-æµè¯å·¥å·",normalizedTitle:"java æµè¯å·¥å·",charIndex:206},{level:3,title:"å¶ä»",slug:"å¶ä»",normalizedTitle:"å¶ä»",charIndex:258},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:351},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:361}],headersStr:"ð åå®¹ Java IO JavaBean å·¥å· Java æ¨¡æ¿å¼æ Java æµè¯å·¥å· å¶ä» ð èµæ ðª ä¼ é",content:"# Java å·¥å·\n\n\n# ð åå®¹\n\n\n# Java IO\n\n * JSON åºåå - fastjsonãJacksonãGson\n * äºè¿å¶åºåå - ProtobufãThriftãHessianãKryoãFST\n\n\n# JavaBean å·¥å·\n\n * Lombok\n * Dozer\n\n\n# Java æ¨¡æ¿å¼æ\n\n * Freemark\n * Velocity\n * Thymeleaf\n\n\n# Java æµè¯å·¥å·\n\n * Junit\n * Mockito\n * Jmeter\n * JMH\n\n\n# å¶ä»\n\n * Java æ¥å¿\n * Java å·¥å·å\n * Reflections\n * JavaMail\n * Jsoup\n * Thumbnailator\n * Zxing\n\n\n# ð èµæ\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java å·¥å·\n\n\n# ð åå®¹\n\n\n# java io\n\n * json åºåå - fastjsonãjacksonãgson\n * äºè¿å¶åºåå - protobufãthriftãhessianãkryoãfst\n\n\n# javabean å·¥å·\n\n * lombok\n * dozer\n\n\n# java æ¨¡æ¿å¼æ\n\n * freemark\n * velocity\n * thymeleaf\n\n\n# java æµè¯å·¥å·\n\n * junit\n * mockito\n * jmeter\n * jmh\n\n\n# å¶ä»\n\n * java æ¥å¿\n * java å·¥å·å\n * reflections\n * javamail\n * jsoup\n * thumbnailator\n * zxing\n\n\n# ð èµæ\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Mybatiså¿«éå¥é¨",frontmatter:{title:"Mybatiså¿«éå¥é¨",categories:["ç¼ç¨","Java","æ¡æ¶","ORM"],tags:["Java","æ¡æ¶","ORM","Mybatis"],abbrlink:"a7445586",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/538358/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/11.ORM/01.Mybatis%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html",relativePath:"13.æ¡æ¶/11.ORM/01.Mybatiså¿«éå¥é¨.md",key:"v-af4ff908",path:"/pages/538358/",headers:[{level:2,title:"Mybatis ç®ä»",slug:"mybatis-ç®ä»",normalizedTitle:"mybatis ç®ä»",charIndex:102},{level:3,title:"ä»ä¹æ¯ MyBatis",slug:"ä»ä¹æ¯-mybatis",normalizedTitle:"ä»ä¹æ¯ mybatis",charIndex:119},{level:3,title:"MyBatis vs. Hibernate",slug:"mybatis-vs-hibernate",normalizedTitle:"mybatis vs. hibernate",charIndex:310},{level:2,title:"å¿«éå¥é¨",slug:"å¿«éå¥é¨",normalizedTitle:"å¿«éå¥é¨",charIndex:10},{level:3,title:"æ°æ®åºåå¤",slug:"æ°æ®åºåå¤",normalizedTitle:"æ°æ®åºåå¤",charIndex:821},{level:3,title:"æ·»å  Mybatis",slug:"æ·»å -mybatis",normalizedTitle:"æ·»å  mybatis",charIndex:1448},{level:3,title:"Mybatis éç½®",slug:"mybatis-éç½®",normalizedTitle:"mybatis éç½®",charIndex:1631},{level:3,title:"Mapper",slug:"mapper",normalizedTitle:"mapper",charIndex:2506},{level:4,title:"Mapper.xml",slug:"mapper-xml",normalizedTitle:"mapper.xml",charIndex:2506},{level:4,title:"Mapper.java",slug:"mapper-java",normalizedTitle:"mapper.java",charIndex:4443},{level:4,title:"æ°æ®å®ä½.java",slug:"æ°æ®å®ä½-java",normalizedTitle:"æ°æ®å®ä½.java",charIndex:4914},{level:3,title:"æµè¯ç¨åº",slug:"æµè¯ç¨åº",normalizedTitle:"æµè¯ç¨åº",charIndex:5237},{level:2,title:"Mybatis xml éç½®",slug:"mybatis-xml-éç½®",normalizedTitle:"mybatis xml éç½®",charIndex:6290},{level:2,title:"Mybatis xml æ å°å¨",slug:"mybatis-xml-æ å°å¨",normalizedTitle:"mybatis xml æ å°å¨",charIndex:6662},{level:2,title:"Mybatis æ©å±",slug:"mybatis-æ©å±",normalizedTitle:"mybatis æ©å±",charIndex:7030},{level:3,title:"Mybatis ç±»åå¤çå¨",slug:"mybatis-ç±»åå¤çå¨",normalizedTitle:"mybatis ç±»åå¤çå¨",charIndex:7045},{level:3,title:"Mybatis æä»¶",slug:"mybatis-æä»¶",normalizedTitle:"mybatis æä»¶",charIndex:8426},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:9825}],headersStr:"Mybatis ç®ä» ä»ä¹æ¯ MyBatis MyBatis vs. Hibernate å¿«éå¥é¨ æ°æ®åºåå¤ æ·»å  Mybatis Mybatis éç½® Mapper Mapper.xml Mapper.java æ°æ®å®ä½.java æµè¯ç¨åº Mybatis xml éç½® Mybatis xml æ å°å¨ Mybatis æ©å± Mybatis ç±»åå¤çå¨ Mybatis æä»¶ åèèµæ",content:'# MyBatis å¿«éå¥é¨\n\n> MyBatis çåèº«å°±æ¯ iBatis ï¼æ¯ä¸ä¸ªä½ç¨å¨æ°æ®æä¹å±çå¯¹è±¡å³ç³»æ å°ï¼Object Relational Mappingï¼ç®ç§° ORMï¼æ¡æ¶ã\n\n\n\n\n# Mybatis ç®ä»\n\n\n\n\n# ä»ä¹æ¯ MyBatis\n\nMyBatis æ¯ä¸æ¬¾æä¹å±æ¡æ¶ï¼å®æ¯æå®å¶å SQLãå­å¨è¿ç¨ä»¥åé«çº§æ å°ãMyBatis é¿åäºå ä¹ææç JDBC ä»£ç åæå¨è®¾ç½®åæ°ä»¥åè·åç»æéãMyBatis å¯ä»¥ä½¿ç¨ç®åç XML ææ³¨è§£æ¥éç½®åæ å°åçç±»åãæ¥å£å Java ç POJOï¼Plain Old Java Objectsï¼æ®éèå¼ Java å¯¹è±¡ï¼ä¸ºæ°æ®åºä¸­çè®°å½ã\n\n\n# MyBatis vs. Hibernate\n\nMyBatis å Hibernate é½æ¯ Java ä¸çä¸­æ¯è¾æµè¡ç ORM æ¡æ¶ãæä»¬åºè¯¥äºè§£å¶åèªçä¼å¿ï¼æ ¹æ®é¡¹ç®çéè¦å»ææ©å¨å¼åä¸­ä½¿ç¨åªä¸ªæ¡æ¶ã\n\nMybatis ä¼å¿\n\n * MyBatis å¯ä»¥è¿è¡æ´ä¸ºç»è´ç SQL ä¼åï¼å¯ä»¥åå°æ¥è¯¢å­æ®µã\n * MyBatis å®¹æææ¡ï¼è Hibernate é¨æ§è¾é«ã\n\nHibernate ä¼å¿\n\n * Hibernate ç DAO å±å¼åæ¯ MyBatis ç®åï¼Mybatis éè¦ç»´æ¤ SQL åç»ææ å°ã\n * Hibernate å¯¹å¯¹è±¡çç»´æ¤åç¼å­è¦æ¯ MyBatis å¥½ï¼å¯¹å¢å æ¹æ¥çå¯¹è±¡çç»´æ¤è¦æ¹ä¾¿ã\n * Hibernate æ°æ®åºç§»æ¤æ§å¾å¥½ï¼MyBatis çæ°æ®åºç§»æ¤æ§ä¸å¥½ï¼ä¸åçæ°æ®åºéè¦åä¸å SQLã\n * Hibernate ææ´å¥½çäºçº§ç¼å­æºå¶ï¼å¯ä»¥ä½¿ç¨ç¬¬ä¸æ¹ç¼å­ãMyBatis æ¬èº«æä¾çç¼å­æºå¶ä¸ä½³ã\n\n\n# å¿«éå¥é¨\n\n> è¿éï¼æå°ä»¥ä¸ä¸ªå¥é¨çº§çç¤ºä¾æ¥æ¼ç¤º Mybatis æ¯å¦ä½å·¥ä½çã\n> \n> æ³¨ï¼æ¬æåé¢ç« èä¸­çåçãæºç é¨åä¹å°åºäºè¿ä¸ªç¤ºä¾æ¥è¿è¡è®²è§£ã\n\n\n# æ°æ®åºåå¤\n\nå¨æ¬ç¤ºä¾ä¸­ï¼éè¦éå¯¹ä¸å¼ ç¨æ·è¡¨è¿è¡ CRUD æä½ãå¶æ°æ®æ¨¡åå¦ä¸ï¼\n\nCREATE TABLE IF NOT EXISTS user (\n    id      BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT \'Id\',\n    name    VARCHAR(10)         NOT NULL DEFAULT \'\' COMMENT \'ç¨æ·å\',\n    age     INT(3)              NOT NULL DEFAULT 0 COMMENT \'å¹´é¾\',\n    address VARCHAR(32)         NOT NULL DEFAULT \'\' COMMENT \'å°å\',\n    email   VARCHAR(32)         NOT NULL DEFAULT \'\' COMMENT \'é®ä»¶\',\n    PRIMARY KEY (id)\n) COMMENT = \'ç¨æ·è¡¨\';\n\nINSERT INTO user (name, age, address, email)\nVALUES (\'å¼ ä¸\', 18, \'åäº¬\', \'xxx@163.com\');\nINSERT INTO user (name, age, address, email)\nVALUES (\'æå\', 19, \'ä¸æµ·\', \'xxx@163.com\');\n\n\n\n# æ·»å  Mybatis\n\nå¦æä½¿ç¨ Maven æ¥æå»ºé¡¹ç®ï¼åéå°ä¸é¢çä¾èµä»£ç ç½®äº pom.xml æä»¶ä¸­ï¼\n\n<dependency>\n  <groupId>org.mybatis</groupId>\n  <artifactId>mybatis</artifactId>\n  <version>x.x.x</version>\n</dependency>\n\n\n\n# Mybatis éç½®\n\nXML éç½®æä»¶ä¸­åå«äºå¯¹ MyBatis ç³»ç»çæ ¸å¿è®¾ç½®ï¼åæ¬è·åæ°æ®åºè¿æ¥å®ä¾çæ°æ®æºï¼DataSourceï¼ä»¥åå³å®äºå¡ä½ç¨ååæ§å¶æ¹å¼çäºå¡ç®¡çå¨ï¼TransactionManagerï¼ã\n\næ¬ç¤ºä¾ä¸­åªæ¯ç»åºæç®åçéç½®ã\n\nãç¤ºä¾ãmybatis-config.xml æä»¶\n\n<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"\n  "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n  <environments default="development">\n    <environment id="development">\n      <transactionManager type="JDBC" />\n      <dataSource type="POOLED">\n        <property name="driver" value="com.mysql.cj.jdbc.Driver" />\n        <property name="url"\n                  value="jdbc:mysql://127.0.0.1:3306/spring_tutorial?serverTimezone=UTC" />\n        <property name="username" value="root" />\n        <property name="password" value="root" />\n      </dataSource>\n    </environment>\n  </environments>\n  <mappers>\n    <mapper resource="mybatis/mapper/UserMapper.xml" />\n  </mappers>\n</configuration>\n\n\n> è¯´æï¼ä¸é¢çéç½®æä»¶ä¸­ä»ä»æå®äºæ°æ®æºè¿æ¥æ¹å¼å User è¡¨çæ å°éç½®æä»¶ã\n\n\n# Mapper\n\n# Mapper.xml\n\nä¸ªäººçè§£ï¼Mapper.xml æä»¶å¯ä»¥çåæ¯ Mybatis ç JDBC SQL æ¨¡æ¿ã\n\nãç¤ºä¾ãUserMapper.xml æä»¶\n\nä¸é¢æ¯ä¸ä¸ªéè¿ Mybatis Generator èªå¨çæçå®æ´ç Mapper æä»¶ã\n\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="io.github.dunwu.spring.orm.mapper.UserMapper">\n  <resultMap id="BaseResultMap" type="io.github.dunwu.spring.orm.entity.User">\n    <id column="id" jdbcType="BIGINT" property="id" />\n    <result column="name" jdbcType="VARCHAR" property="name" />\n    <result column="age" jdbcType="INTEGER" property="age" />\n    <result column="address" jdbcType="VARCHAR" property="address" />\n    <result column="email" jdbcType="VARCHAR" property="email" />\n  </resultMap>\n  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">\n    delete from user\n    where id = #{id,jdbcType=BIGINT}\n  </delete>\n  <insert id="insert" parameterType="io.github.dunwu.spring.orm.entity.User">\n    insert into user (id, name, age,\n      address, email)\n    values (#{id,jdbcType=BIGINT}, #{name,jdbcType=VARCHAR}, #{age,jdbcType=INTEGER},\n      #{address,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR})\n  </insert>\n  <update id="updateByPrimaryKey" parameterType="io.github.dunwu.spring.orm.entity.User">\n    update user\n    set name = #{name,jdbcType=VARCHAR},\n      age = #{age,jdbcType=INTEGER},\n      address = #{address,jdbcType=VARCHAR},\n      email = #{email,jdbcType=VARCHAR}\n    where id = #{id,jdbcType=BIGINT}\n  </update>\n  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">\n    select id, name, age, address, email\n    from user\n    where id = #{id,jdbcType=BIGINT}\n  </select>\n  <select id="selectAll" resultMap="BaseResultMap">\n    select id, name, age, address, email\n    from user\n  </select>\n</mapper>\n\n\n# Mapper.java\n\nMapper.java æä»¶æ¯ Mapper.xml å¯¹åºç Java å¯¹è±¡ã\n\nãç¤ºä¾ãUserMapper.java æä»¶\n\npublic interface UserMapper {\n\n    int deleteByPrimaryKey(Long id);\n\n    int insert(User record);\n\n    User selectByPrimaryKey(Long id);\n\n    List<User> selectAll();\n\n    int updateByPrimaryKey(User record);\n\n}\n\n\nå¯¹æ¯ UserMapper.java å UserMapper.xml æä»¶ï¼ä¸é¾åç°ï¼\n\nUserMapper.java ä¸­çæ¹æ³å UserMapper.xml ç CRUD è¯­å¥åç´ ï¼ <insert>ã<delete>ã<update>ã<select>ï¼å­å¨ä¸ä¸å¯¹åºå³ç³»ã\n\nå¨ Mybatis ä¸­ï¼æ­£æ¯éè¿æ¹æ³çå¨éå®åï¼å°äºèç»å®å¨ä¸èµ·ã\n\n# æ°æ®å®ä½.java\n\nãç¤ºä¾ãUser.java æä»¶\n\npublic class User {\n    private Long id;\n\n    private String name;\n\n    private Integer age;\n\n    private String address;\n\n    private String email;\n\n}\n\n\n<insert>ã<delete>ã<update>ã<select> ç parameterType å±æ§ä»¥å <resultMap> ç type å±æ§é½å¯è½ä¼ç»å®å°æ°æ®å®ä½ãè¿æ ·å°±å¯ä»¥æ JDBC æä½çè¾å¥è¾åºå JavaBean ç»åèµ·æ¥ï¼æ´å æ¹ä¾¿ãæäºçè§£ã\n\n\n# æµè¯ç¨åº\n\nãç¤ºä¾ãMybatisDemo.java æä»¶\n\npublic class MybatisDemo {\n\n    public static void main(String[] args) throws Exception {\n        // 1. å è½½ mybatis éç½®æä»¶ï¼åå»º SqlSessionFactory\n        // æ³¨ï¼å¨å®éçåºç¨ä¸­ï¼SqlSessionFactory åºè¯¥æ¯åä¾\n        InputStream inputStream = Resources.getResourceAsStream("mybatis/mybatis-config.xml");\n        SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n        SqlSessionFactory factory = builder.build(inputStream);\n\n        // 2. åå»ºä¸ä¸ª SqlSession å®ä¾ï¼è¿è¡æ°æ®åºæä½\n        SqlSession sqlSession = factory.openSession();\n\n        // 3. Mapper æ å°å¹¶æ§è¡\n        Long params = 1L;\n        List<User> list = sqlSession.selectList("io.github.dunwu.spring.orm.mapper.UserMapper.selectByPrimaryKey", params);\n        for (User user : list) {\n            System.out.println("user name: " + user.getName());\n        }\n        // è¾åºï¼user name: å¼ ä¸\n    }\n\n}\n\n\n> è¯´æï¼\n> \n> SqlSession æ¥å£æ¯ Mybatis API æ ¸å¿ä¸­çæ ¸å¿ï¼å®ä»£è¡¨äº Mybatis åæ°æ®åºçä¸æ¬¡å®æ´ä¼è¯ã\n> \n>  * Mybatis ä¼è§£æéç½®ï¼å¹¶æ ¹æ®éç½®åå»º SqlSession ã\n>  * ç¶åï¼Mybatis å° Mapper æ å°ä¸º SqlSessionï¼ç¶åä¼ éåæ°ï¼æ§è¡ SQL è¯­å¥å¹¶è·åç»æã\n\n\n# Mybatis xml éç½®\n\n> éç½®çè¯¦ç»åå®¹è¯·åèï¼ã Mybatis å®æ¹ææ¡£ä¹éç½® ã ã\n\nMyBatis çéç½®æä»¶åå«äºä¼æ·±æ·±å½±å MyBatis è¡ä¸ºçè®¾ç½®åå±æ§ä¿¡æ¯ãä¸»è¦éç½®é¡¹æä»¥ä¸ï¼\n\n * propertiesï¼å±æ§ï¼\n * settingsï¼è®¾ç½®ï¼\n * typeAliasesï¼ç±»åå«åï¼\n * typeHandlersï¼ç±»åå¤çå¨ï¼\n * objectFactoryï¼å¯¹è±¡å·¥åï¼\n * pluginsï¼æä»¶ï¼\n * environmentsï¼ç¯å¢éç½®ï¼\n   * environmentï¼ç¯å¢åéï¼\n     * transactionManagerï¼äºå¡ç®¡çå¨ï¼\n     * dataSourceï¼æ°æ®æºï¼\n * databaseIdProviderï¼æ°æ®åºååæ è¯ï¼\n * mappersï¼æ å°å¨ï¼\n\n\n# Mybatis xml æ å°å¨\n\n> SQL XML æ å°æä»¶è¯¦ç»åå®¹è¯·åèï¼ã Mybatis å®æ¹ææ¡£ä¹ XML æ å°æä»¶ ãã\n\nXML æ å°æä»¶åªæå ä¸ªé¡¶çº§åç´ ï¼\n\n * cache â å¯¹ç»å®å½åç©ºé´çç¼å­éç½®ã\n * cache-ref â å¯¹å¶ä»å½åç©ºé´ç¼å­éç½®çå¼ç¨ã\n * resultMap â æ¯æå¤æä¹æ¯æå¼ºå¤§çåç´ ï¼ç¨æ¥æè¿°å¦ä½ä»æ°æ®åºç»æéä¸­æ¥å è½½å¯¹è±¡ã\n * parameterMap â å·²è¢«åºå¼ï¼èå¼é£æ ¼çåæ°æ å°ãæ´å¥½çåæ³æ¯ä½¿ç¨åèåæ°ï¼æ­¤åç´ å¯è½å¨å°æ¥è¢«ç§»é¤ãææ¡£ä¸­ä¸ä¼ä»ç»æ­¤åç´ ã\n * sql â å¯è¢«å¶ä»è¯­å¥å¼ç¨çå¯éç¨è¯­å¥åã\n * insert â æ å°æå¥è¯­å¥\n * update â æ å°æ´æ°è¯­å¥\n * delete â æ å°å é¤è¯­å¥\n * select â æ å°æ¥è¯¢è¯­å¥\n\n\n# Mybatis æ©å±\n\n\n# Mybatis ç±»åå¤çå¨\n\nMyBatis å¨è®¾ç½®é¢å¤çè¯­å¥ï¼PreparedStatementï¼ä¸­çåæ°æä»ç»æéä¸­ååºä¸ä¸ªå¼æ¶ï¼ é½ä¼ç¨ç±»åå¤çå¨å°è·åå°çå¼ä»¥åéçæ¹å¼è½¬æ¢æ Java ç±»åãä¸è¡¨æè¿°äºä¸äºé»è®¤çç±»åå¤çå¨ã\n\nä» 3.4.5 å¼å§ï¼MyBatis é»è®¤æ¯æ JSR-310ï¼æ¥æåæ¶é´ APIï¼ ã\n\nä½ å¯ä»¥éåå·²æçç±»åå¤çå¨æåå»ºä½ èªå·±çç±»åå¤çå¨æ¥å¤çä¸æ¯æçæéæ åçç±»åã å·ä½åæ³ä¸ºï¼å®ç° org.apache.ibatis.type.TypeHandler æ¥å£ï¼ æç»§æ¿ä¸ä¸ªå¾ä¾¿å©çç±» org.apache.ibatis.type.BaseTypeHandlerï¼ å¹¶ä¸å¯ä»¥ï¼å¯éå°ï¼å°å®æ å°å°ä¸ä¸ª JDBC ç±»åãæ¯å¦ï¼\n\n// ExampleTypeHandler.java\n@MappedJdbcTypes(JdbcType.VARCHAR)\npublic class ExampleTypeHandler extends BaseTypeHandler<String> {\n\n  @Override\n  public void setNonNullParameter(PreparedStatement ps, int i, String parameter, JdbcType jdbcType) throws SQLException {\n    ps.setString(i, parameter);\n  }\n\n  @Override\n  public String getNullableResult(ResultSet rs, String columnName) throws SQLException {\n    return rs.getString(columnName);\n  }\n\n  @Override\n  public String getNullableResult(ResultSet rs, int columnIndex) throws SQLException {\n    return rs.getString(columnIndex);\n  }\n\n  @Override\n  public String getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {\n    return cs.getString(columnIndex);\n  }\n}\n\n\n\x3c!-- mybatis-config.xml --\x3e\n<typeHandlers>\n  <typeHandler handler="org.mybatis.example.ExampleTypeHandler"/>\n</typeHandlers>\n\n\nä½¿ç¨ä¸è¿°çç±»åå¤çå¨å°ä¼è¦çå·²æçå¤ç Java String ç±»åçå±æ§ä»¥å VARCHAR ç±»åçåæ°åç»æçç±»åå¤çå¨ã è¦æ³¨æ MyBatis ä¸ä¼éè¿æ£æµæ°æ®åºåä¿¡æ¯æ¥å³å®ä½¿ç¨åªç§ç±»åï¼æä»¥ä½ å¿é¡»å¨åæ°åç»ææ å°ä¸­ææå­æ®µæ¯ VARCHAR ç±»åï¼ ä»¥ä½¿å¶è½å¤ç»å®å°æ­£ç¡®çç±»åå¤çå¨ä¸ãè¿æ¯å ä¸º MyBatis ç´å°è¯­å¥è¢«æ§è¡æ¶ææ¸æ¥æ°æ®ç±»åã\n\n\n# Mybatis æä»¶\n\nMyBatis åè®¸ä½ å¨æ å°è¯­å¥æ§è¡è¿ç¨ä¸­çæä¸ç¹è¿è¡æ¦æªè°ç¨ãé»è®¤æåµä¸ï¼MyBatis åè®¸ä½¿ç¨æä»¶æ¥æ¦æªçæ¹æ³è°ç¨åæ¬ï¼\n\n * Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)\n * ParameterHandler (getParameterObject, setParameters)\n * ResultSetHandler (handleResultSets, handleOutputParameters)\n * StatementHandler (prepare, parameterize, batch, update, query)\n\nè¿äºç±»ä¸­æ¹æ³çç»èå¯ä»¥éè¿æ¥çæ¯ä¸ªæ¹æ³çç­¾åæ¥åç°ï¼æèç´æ¥æ¥ç MyBatis åè¡åä¸­çæºä»£ç ã å¦æä½ æ³åçä¸ä»ä»æ¯çæ§æ¹æ³çè°ç¨ï¼é£ä¹ä½ æå¥½ç¸å½äºè§£è¦éåçæ¹æ³çè¡ä¸ºã å ä¸ºå¨è¯å¾ä¿®æ¹æéåå·²ææ¹æ³çè¡ä¸ºæ¶ï¼å¾å¯è½ä¼ç ´å MyBatis çæ ¸å¿æ¨¡åã è¿äºé½æ¯æ´åºå±çç±»åæ¹æ³ï¼æä»¥ä½¿ç¨æä»¶çæ¶åè¦ç¹å«å½å¿ã\n\néè¿ MyBatis æä¾çå¼ºå¤§æºå¶ï¼ä½¿ç¨æä»¶æ¯éå¸¸ç®åçï¼åªéå®ç° Interceptor æ¥å£ï¼å¹¶æå®æ³è¦æ¦æªçæ¹æ³ç­¾åå³å¯ã\n\n// ExamplePlugin.java\n@Intercepts({@Signature(\n  type= Executor.class,\n  method = "update",\n  args = {MappedStatement.class,Object.class})})\npublic class ExamplePlugin implements Interceptor {\n  private Properties properties = new Properties();\n  public Object intercept(Invocation invocation) throws Throwable {\n    // implement pre processing if need\n    Object returnObject = invocation.proceed();\n    // implement post processing if need\n    return returnObject;\n  }\n  public void setProperties(Properties properties) {\n    this.properties = properties;\n  }\n}\n\n\n\x3c!-- mybatis-config.xml --\x3e\n<plugins>\n  <plugin interceptor="org.mybatis.example.ExamplePlugin">\n    <property name="someProperty" value="100"/>\n  </plugin>\n</plugins>\n\n\nä¸é¢çæä»¶å°ä¼æ¦æªå¨ Executor å®ä¾ä¸­ææç âupdateâ æ¹æ³è°ç¨ï¼ è¿éç Executor æ¯è´è´£æ§è¡åºå±æ å°è¯­å¥çåé¨å¯¹è±¡ã\n\n\n# åèèµæ\n\n * å®æ¹\n   * Mybatis Github\n   * Mybatis å®ç½\n   * MyBatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * MyBatis å®æ¹éæ Springï¼mybatis-springï¼\n   * Mybatis å®æ¹éæ Spring Bootï¼mybatis-spring-bootï¼\n * æ©å±æä»¶\n   * MyBatis-Plus - CRUD æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * Mapper - CRUD æ©å±æä»¶\n   * Mybatis-PageHelper - Mybatis éç¨åé¡µæä»¶\n * æç« \n   * æ·±å¥çè§£ mybatis åç\n   * mybatis æºç ä¸­ææ³¨é\n   * MyBatis Generator è¯¦è§£\n   * Mybatis å¸¸è§é¢è¯é¢\n   * Mybatis ä¸­å¼ºå¤§ç resultMap',normalizedContent:'# mybatis å¿«éå¥é¨\n\n> mybatis çåèº«å°±æ¯ ibatis ï¼æ¯ä¸ä¸ªä½ç¨å¨æ°æ®æä¹å±çå¯¹è±¡å³ç³»æ å°ï¼object relational mappingï¼ç®ç§° ormï¼æ¡æ¶ã\n\n\n\n\n# mybatis ç®ä»\n\n\n\n\n# ä»ä¹æ¯ mybatis\n\nmybatis æ¯ä¸æ¬¾æä¹å±æ¡æ¶ï¼å®æ¯æå®å¶å sqlãå­å¨è¿ç¨ä»¥åé«çº§æ å°ãmybatis é¿åäºå ä¹ææç jdbc ä»£ç åæå¨è®¾ç½®åæ°ä»¥åè·åç»æéãmybatis å¯ä»¥ä½¿ç¨ç®åç xml ææ³¨è§£æ¥éç½®åæ å°åçç±»åãæ¥å£å java ç pojoï¼plain old java objectsï¼æ®éèå¼ java å¯¹è±¡ï¼ä¸ºæ°æ®åºä¸­çè®°å½ã\n\n\n# mybatis vs. hibernate\n\nmybatis å hibernate é½æ¯ java ä¸çä¸­æ¯è¾æµè¡ç orm æ¡æ¶ãæä»¬åºè¯¥äºè§£å¶åèªçä¼å¿ï¼æ ¹æ®é¡¹ç®çéè¦å»ææ©å¨å¼åä¸­ä½¿ç¨åªä¸ªæ¡æ¶ã\n\nmybatis ä¼å¿\n\n * mybatis å¯ä»¥è¿è¡æ´ä¸ºç»è´ç sql ä¼åï¼å¯ä»¥åå°æ¥è¯¢å­æ®µã\n * mybatis å®¹æææ¡ï¼è hibernate é¨æ§è¾é«ã\n\nhibernate ä¼å¿\n\n * hibernate ç dao å±å¼åæ¯ mybatis ç®åï¼mybatis éè¦ç»´æ¤ sql åç»ææ å°ã\n * hibernate å¯¹å¯¹è±¡çç»´æ¤åç¼å­è¦æ¯ mybatis å¥½ï¼å¯¹å¢å æ¹æ¥çå¯¹è±¡çç»´æ¤è¦æ¹ä¾¿ã\n * hibernate æ°æ®åºç§»æ¤æ§å¾å¥½ï¼mybatis çæ°æ®åºç§»æ¤æ§ä¸å¥½ï¼ä¸åçæ°æ®åºéè¦åä¸å sqlã\n * hibernate ææ´å¥½çäºçº§ç¼å­æºå¶ï¼å¯ä»¥ä½¿ç¨ç¬¬ä¸æ¹ç¼å­ãmybatis æ¬èº«æä¾çç¼å­æºå¶ä¸ä½³ã\n\n\n# å¿«éå¥é¨\n\n> è¿éï¼æå°ä»¥ä¸ä¸ªå¥é¨çº§çç¤ºä¾æ¥æ¼ç¤º mybatis æ¯å¦ä½å·¥ä½çã\n> \n> æ³¨ï¼æ¬æåé¢ç« èä¸­çåçãæºç é¨åä¹å°åºäºè¿ä¸ªç¤ºä¾æ¥è¿è¡è®²è§£ã\n\n\n# æ°æ®åºåå¤\n\nå¨æ¬ç¤ºä¾ä¸­ï¼éè¦éå¯¹ä¸å¼ ç¨æ·è¡¨è¿è¡ crud æä½ãå¶æ°æ®æ¨¡åå¦ä¸ï¼\n\ncreate table if not exists user (\n    id      bigint(10) unsigned not null auto_increment comment \'id\',\n    name    varchar(10)         not null default \'\' comment \'ç¨æ·å\',\n    age     int(3)              not null default 0 comment \'å¹´é¾\',\n    address varchar(32)         not null default \'\' comment \'å°å\',\n    email   varchar(32)         not null default \'\' comment \'é®ä»¶\',\n    primary key (id)\n) comment = \'ç¨æ·è¡¨\';\n\ninsert into user (name, age, address, email)\nvalues (\'å¼ ä¸\', 18, \'åäº¬\', \'xxx@163.com\');\ninsert into user (name, age, address, email)\nvalues (\'æå\', 19, \'ä¸æµ·\', \'xxx@163.com\');\n\n\n\n# æ·»å  mybatis\n\nå¦æä½¿ç¨ maven æ¥æå»ºé¡¹ç®ï¼åéå°ä¸é¢çä¾èµä»£ç ç½®äº pom.xml æä»¶ä¸­ï¼\n\n<dependency>\n  <groupid>org.mybatis</groupid>\n  <artifactid>mybatis</artifactid>\n  <version>x.x.x</version>\n</dependency>\n\n\n\n# mybatis éç½®\n\nxml éç½®æä»¶ä¸­åå«äºå¯¹ mybatis ç³»ç»çæ ¸å¿è®¾ç½®ï¼åæ¬è·åæ°æ®åºè¿æ¥å®ä¾çæ°æ®æºï¼datasourceï¼ä»¥åå³å®äºå¡ä½ç¨ååæ§å¶æ¹å¼çäºå¡ç®¡çå¨ï¼transactionmanagerï¼ã\n\næ¬ç¤ºä¾ä¸­åªæ¯ç»åºæç®åçéç½®ã\n\nãç¤ºä¾ãmybatis-config.xml æä»¶\n\n<?xml version="1.0" encoding="utf-8"?>\n<!doctype configuration public "-//mybatis.org//dtd config 3.0//en"\n  "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n  <environments default="development">\n    <environment id="development">\n      <transactionmanager type="jdbc" />\n      <datasource type="pooled">\n        <property name="driver" value="com.mysql.cj.jdbc.driver" />\n        <property name="url"\n                  value="jdbc:mysql://127.0.0.1:3306/spring_tutorial?servertimezone=utc" />\n        <property name="username" value="root" />\n        <property name="password" value="root" />\n      </datasource>\n    </environment>\n  </environments>\n  <mappers>\n    <mapper resource="mybatis/mapper/usermapper.xml" />\n  </mappers>\n</configuration>\n\n\n> è¯´æï¼ä¸é¢çéç½®æä»¶ä¸­ä»ä»æå®äºæ°æ®æºè¿æ¥æ¹å¼å user è¡¨çæ å°éç½®æä»¶ã\n\n\n# mapper\n\n# mapper.xml\n\nä¸ªäººçè§£ï¼mapper.xml æä»¶å¯ä»¥çåæ¯ mybatis ç jdbc sql æ¨¡æ¿ã\n\nãç¤ºä¾ãusermapper.xml æä»¶\n\nä¸é¢æ¯ä¸ä¸ªéè¿ mybatis generator èªå¨çæçå®æ´ç mapper æä»¶ã\n\n<?xml version="1.0" encoding="utf-8"?>\n<!doctype mapper public "-//mybatis.org//dtd mapper 3.0//en" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="io.github.dunwu.spring.orm.mapper.usermapper">\n  <resultmap id="baseresultmap" type="io.github.dunwu.spring.orm.entity.user">\n    <id column="id" jdbctype="bigint" property="id" />\n    <result column="name" jdbctype="varchar" property="name" />\n    <result column="age" jdbctype="integer" property="age" />\n    <result column="address" jdbctype="varchar" property="address" />\n    <result column="email" jdbctype="varchar" property="email" />\n  </resultmap>\n  <delete id="deletebyprimarykey" parametertype="java.lang.long">\n    delete from user\n    where id = #{id,jdbctype=bigint}\n  </delete>\n  <insert id="insert" parametertype="io.github.dunwu.spring.orm.entity.user">\n    insert into user (id, name, age,\n      address, email)\n    values (#{id,jdbctype=bigint}, #{name,jdbctype=varchar}, #{age,jdbctype=integer},\n      #{address,jdbctype=varchar}, #{email,jdbctype=varchar})\n  </insert>\n  <update id="updatebyprimarykey" parametertype="io.github.dunwu.spring.orm.entity.user">\n    update user\n    set name = #{name,jdbctype=varchar},\n      age = #{age,jdbctype=integer},\n      address = #{address,jdbctype=varchar},\n      email = #{email,jdbctype=varchar}\n    where id = #{id,jdbctype=bigint}\n  </update>\n  <select id="selectbyprimarykey" parametertype="java.lang.long" resultmap="baseresultmap">\n    select id, name, age, address, email\n    from user\n    where id = #{id,jdbctype=bigint}\n  </select>\n  <select id="selectall" resultmap="baseresultmap">\n    select id, name, age, address, email\n    from user\n  </select>\n</mapper>\n\n\n# mapper.java\n\nmapper.java æä»¶æ¯ mapper.xml å¯¹åºç java å¯¹è±¡ã\n\nãç¤ºä¾ãusermapper.java æä»¶\n\npublic interface usermapper {\n\n    int deletebyprimarykey(long id);\n\n    int insert(user record);\n\n    user selectbyprimarykey(long id);\n\n    list<user> selectall();\n\n    int updatebyprimarykey(user record);\n\n}\n\n\nå¯¹æ¯ usermapper.java å usermapper.xml æä»¶ï¼ä¸é¾åç°ï¼\n\nusermapper.java ä¸­çæ¹æ³å usermapper.xml ç crud è¯­å¥åç´ ï¼ <insert>ã<delete>ã<update>ã<select>ï¼å­å¨ä¸ä¸å¯¹åºå³ç³»ã\n\nå¨ mybatis ä¸­ï¼æ­£æ¯éè¿æ¹æ³çå¨éå®åï¼å°äºèç»å®å¨ä¸èµ·ã\n\n# æ°æ®å®ä½.java\n\nãç¤ºä¾ãuser.java æä»¶\n\npublic class user {\n    private long id;\n\n    private string name;\n\n    private integer age;\n\n    private string address;\n\n    private string email;\n\n}\n\n\n<insert>ã<delete>ã<update>ã<select> ç parametertype å±æ§ä»¥å <resultmap> ç type å±æ§é½å¯è½ä¼ç»å®å°æ°æ®å®ä½ãè¿æ ·å°±å¯ä»¥æ jdbc æä½çè¾å¥è¾åºå javabean ç»åèµ·æ¥ï¼æ´å æ¹ä¾¿ãæäºçè§£ã\n\n\n# æµè¯ç¨åº\n\nãç¤ºä¾ãmybatisdemo.java æä»¶\n\npublic class mybatisdemo {\n\n    public static void main(string[] args) throws exception {\n        // 1. å è½½ mybatis éç½®æä»¶ï¼åå»º sqlsessionfactory\n        // æ³¨ï¼å¨å®éçåºç¨ä¸­ï¼sqlsessionfactory åºè¯¥æ¯åä¾\n        inputstream inputstream = resources.getresourceasstream("mybatis/mybatis-config.xml");\n        sqlsessionfactorybuilder builder = new sqlsessionfactorybuilder();\n        sqlsessionfactory factory = builder.build(inputstream);\n\n        // 2. åå»ºä¸ä¸ª sqlsession å®ä¾ï¼è¿è¡æ°æ®åºæä½\n        sqlsession sqlsession = factory.opensession();\n\n        // 3. mapper æ å°å¹¶æ§è¡\n        long params = 1l;\n        list<user> list = sqlsession.selectlist("io.github.dunwu.spring.orm.mapper.usermapper.selectbyprimarykey", params);\n        for (user user : list) {\n            system.out.println("user name: " + user.getname());\n        }\n        // è¾åºï¼user name: å¼ ä¸\n    }\n\n}\n\n\n> è¯´æï¼\n> \n> sqlsession æ¥å£æ¯ mybatis api æ ¸å¿ä¸­çæ ¸å¿ï¼å®ä»£è¡¨äº mybatis åæ°æ®åºçä¸æ¬¡å®æ´ä¼è¯ã\n> \n>  * mybatis ä¼è§£æéç½®ï¼å¹¶æ ¹æ®éç½®åå»º sqlsession ã\n>  * ç¶åï¼mybatis å° mapper æ å°ä¸º sqlsessionï¼ç¶åä¼ éåæ°ï¼æ§è¡ sql è¯­å¥å¹¶è·åç»æã\n\n\n# mybatis xml éç½®\n\n> éç½®çè¯¦ç»åå®¹è¯·åèï¼ã mybatis å®æ¹ææ¡£ä¹éç½® ã ã\n\nmybatis çéç½®æä»¶åå«äºä¼æ·±æ·±å½±å mybatis è¡ä¸ºçè®¾ç½®åå±æ§ä¿¡æ¯ãä¸»è¦éç½®é¡¹æä»¥ä¸ï¼\n\n * propertiesï¼å±æ§ï¼\n * settingsï¼è®¾ç½®ï¼\n * typealiasesï¼ç±»åå«åï¼\n * typehandlersï¼ç±»åå¤çå¨ï¼\n * objectfactoryï¼å¯¹è±¡å·¥åï¼\n * pluginsï¼æä»¶ï¼\n * environmentsï¼ç¯å¢éç½®ï¼\n   * environmentï¼ç¯å¢åéï¼\n     * transactionmanagerï¼äºå¡ç®¡çå¨ï¼\n     * datasourceï¼æ°æ®æºï¼\n * databaseidproviderï¼æ°æ®åºååæ è¯ï¼\n * mappersï¼æ å°å¨ï¼\n\n\n# mybatis xml æ å°å¨\n\n> sql xml æ å°æä»¶è¯¦ç»åå®¹è¯·åèï¼ã mybatis å®æ¹ææ¡£ä¹ xml æ å°æä»¶ ãã\n\nxml æ å°æä»¶åªæå ä¸ªé¡¶çº§åç´ ï¼\n\n * cache â å¯¹ç»å®å½åç©ºé´çç¼å­éç½®ã\n * cache-ref â å¯¹å¶ä»å½åç©ºé´ç¼å­éç½®çå¼ç¨ã\n * resultmap â æ¯æå¤æä¹æ¯æå¼ºå¤§çåç´ ï¼ç¨æ¥æè¿°å¦ä½ä»æ°æ®åºç»æéä¸­æ¥å è½½å¯¹è±¡ã\n * parametermap â å·²è¢«åºå¼ï¼èå¼é£æ ¼çåæ°æ å°ãæ´å¥½çåæ³æ¯ä½¿ç¨åèåæ°ï¼æ­¤åç´ å¯è½å¨å°æ¥è¢«ç§»é¤ãææ¡£ä¸­ä¸ä¼ä»ç»æ­¤åç´ ã\n * sql â å¯è¢«å¶ä»è¯­å¥å¼ç¨çå¯éç¨è¯­å¥åã\n * insert â æ å°æå¥è¯­å¥\n * update â æ å°æ´æ°è¯­å¥\n * delete â æ å°å é¤è¯­å¥\n * select â æ å°æ¥è¯¢è¯­å¥\n\n\n# mybatis æ©å±\n\n\n# mybatis ç±»åå¤çå¨\n\nmybatis å¨è®¾ç½®é¢å¤çè¯­å¥ï¼preparedstatementï¼ä¸­çåæ°æä»ç»æéä¸­ååºä¸ä¸ªå¼æ¶ï¼ é½ä¼ç¨ç±»åå¤çå¨å°è·åå°çå¼ä»¥åéçæ¹å¼è½¬æ¢æ java ç±»åãä¸è¡¨æè¿°äºä¸äºé»è®¤çç±»åå¤çå¨ã\n\nä» 3.4.5 å¼å§ï¼mybatis é»è®¤æ¯æ jsr-310ï¼æ¥æåæ¶é´ apiï¼ ã\n\nä½ å¯ä»¥éåå·²æçç±»åå¤çå¨æåå»ºä½ èªå·±çç±»åå¤çå¨æ¥å¤çä¸æ¯æçæéæ åçç±»åã å·ä½åæ³ä¸ºï¼å®ç° org.apache.ibatis.type.typehandler æ¥å£ï¼ æç»§æ¿ä¸ä¸ªå¾ä¾¿å©çç±» org.apache.ibatis.type.basetypehandlerï¼ å¹¶ä¸å¯ä»¥ï¼å¯éå°ï¼å°å®æ å°å°ä¸ä¸ª jdbc ç±»åãæ¯å¦ï¼\n\n// exampletypehandler.java\n@mappedjdbctypes(jdbctype.varchar)\npublic class exampletypehandler extends basetypehandler<string> {\n\n  @override\n  public void setnonnullparameter(preparedstatement ps, int i, string parameter, jdbctype jdbctype) throws sqlexception {\n    ps.setstring(i, parameter);\n  }\n\n  @override\n  public string getnullableresult(resultset rs, string columnname) throws sqlexception {\n    return rs.getstring(columnname);\n  }\n\n  @override\n  public string getnullableresult(resultset rs, int columnindex) throws sqlexception {\n    return rs.getstring(columnindex);\n  }\n\n  @override\n  public string getnullableresult(callablestatement cs, int columnindex) throws sqlexception {\n    return cs.getstring(columnindex);\n  }\n}\n\n\n\x3c!-- mybatis-config.xml --\x3e\n<typehandlers>\n  <typehandler handler="org.mybatis.example.exampletypehandler"/>\n</typehandlers>\n\n\nä½¿ç¨ä¸è¿°çç±»åå¤çå¨å°ä¼è¦çå·²æçå¤ç java string ç±»åçå±æ§ä»¥å varchar ç±»åçåæ°åç»æçç±»åå¤çå¨ã è¦æ³¨æ mybatis ä¸ä¼éè¿æ£æµæ°æ®åºåä¿¡æ¯æ¥å³å®ä½¿ç¨åªç§ç±»åï¼æä»¥ä½ å¿é¡»å¨åæ°åç»ææ å°ä¸­ææå­æ®µæ¯ varchar ç±»åï¼ ä»¥ä½¿å¶è½å¤ç»å®å°æ­£ç¡®çç±»åå¤çå¨ä¸ãè¿æ¯å ä¸º mybatis ç´å°è¯­å¥è¢«æ§è¡æ¶ææ¸æ¥æ°æ®ç±»åã\n\n\n# mybatis æä»¶\n\nmybatis åè®¸ä½ å¨æ å°è¯­å¥æ§è¡è¿ç¨ä¸­çæä¸ç¹è¿è¡æ¦æªè°ç¨ãé»è®¤æåµä¸ï¼mybatis åè®¸ä½¿ç¨æä»¶æ¥æ¦æªçæ¹æ³è°ç¨åæ¬ï¼\n\n * executor (update, query, flushstatements, commit, rollback, gettransaction, close, isclosed)\n * parameterhandler (getparameterobject, setparameters)\n * resultsethandler (handleresultsets, handleoutputparameters)\n * statementhandler (prepare, parameterize, batch, update, query)\n\nè¿äºç±»ä¸­æ¹æ³çç»èå¯ä»¥éè¿æ¥çæ¯ä¸ªæ¹æ³çç­¾åæ¥åç°ï¼æèç´æ¥æ¥ç mybatis åè¡åä¸­çæºä»£ç ã å¦æä½ æ³åçä¸ä»ä»æ¯çæ§æ¹æ³çè°ç¨ï¼é£ä¹ä½ æå¥½ç¸å½äºè§£è¦éåçæ¹æ³çè¡ä¸ºã å ä¸ºå¨è¯å¾ä¿®æ¹æéåå·²ææ¹æ³çè¡ä¸ºæ¶ï¼å¾å¯è½ä¼ç ´å mybatis çæ ¸å¿æ¨¡åã è¿äºé½æ¯æ´åºå±çç±»åæ¹æ³ï¼æä»¥ä½¿ç¨æä»¶çæ¶åè¦ç¹å«å½å¿ã\n\néè¿ mybatis æä¾çå¼ºå¤§æºå¶ï¼ä½¿ç¨æä»¶æ¯éå¸¸ç®åçï¼åªéå®ç° interceptor æ¥å£ï¼å¹¶æå®æ³è¦æ¦æªçæ¹æ³ç­¾åå³å¯ã\n\n// exampleplugin.java\n@intercepts({@signature(\n  type= executor.class,\n  method = "update",\n  args = {mappedstatement.class,object.class})})\npublic class exampleplugin implements interceptor {\n  private properties properties = new properties();\n  public object intercept(invocation invocation) throws throwable {\n    // implement pre processing if need\n    object returnobject = invocation.proceed();\n    // implement post processing if need\n    return returnobject;\n  }\n  public void setproperties(properties properties) {\n    this.properties = properties;\n  }\n}\n\n\n\x3c!-- mybatis-config.xml --\x3e\n<plugins>\n  <plugin interceptor="org.mybatis.example.exampleplugin">\n    <property name="someproperty" value="100"/>\n  </plugin>\n</plugins>\n\n\nä¸é¢çæä»¶å°ä¼æ¦æªå¨ executor å®ä¾ä¸­ææç âupdateâ æ¹æ³è°ç¨ï¼ è¿éç executor æ¯è´è´£æ§è¡åºå±æ å°è¯­å¥çåé¨å¯¹è±¡ã\n\n\n# åèèµæ\n\n * å®æ¹\n   * mybatis github\n   * mybatis å®ç½\n   * mybatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * mybatis å®æ¹éæ springï¼mybatis-springï¼\n   * mybatis å®æ¹éæ spring bootï¼mybatis-spring-bootï¼\n * æ©å±æä»¶\n   * mybatis-plus - crud æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * mapper - crud æ©å±æä»¶\n   * mybatis-pagehelper - mybatis éç¨åé¡µæä»¶\n * æç« \n   * æ·±å¥çè§£ mybatis åç\n   * mybatis æºç ä¸­ææ³¨é\n   * mybatis generator è¯¦è§£\n   * mybatis å¸¸è§é¢è¯é¢\n   * mybatis ä¸­å¼ºå¤§ç resultmap',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Mybatisåç",frontmatter:{title:"Mybatisåç",categories:["ç¼ç¨","Java","æ¡æ¶","ORM"],tags:["Java","æ¡æ¶","ORM","Mybatis"],abbrlink:"b18bb060",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/3f3dba/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/11.ORM/02.Mybatis%E5%8E%9F%E7%90%86.html",relativePath:"13.æ¡æ¶/11.ORM/02.Mybatisåç.md",key:"v-96ecc776",path:"/pages/3f3dba/",headers:[{level:2,title:"Mybatis å®æ´ç¤ºä¾",slug:"mybatis-å®æ´ç¤ºä¾",normalizedTitle:"mybatis å®æ´ç¤ºä¾",charIndex:78},{level:3,title:"æ°æ®åºåå¤",slug:"æ°æ®åºåå¤",normalizedTitle:"æ°æ®åºåå¤",charIndex:247},{level:3,title:"æ·»å  Mybatis",slug:"æ·»å -mybatis",normalizedTitle:"æ·»å  mybatis",charIndex:874},{level:3,title:"Mybatis éç½®",slug:"mybatis-éç½®",normalizedTitle:"mybatis éç½®",charIndex:1057},{level:3,title:"Mapper",slug:"mapper",normalizedTitle:"mapper",charIndex:1932},{level:4,title:"Mapper.xml",slug:"mapper-xml",normalizedTitle:"mapper.xml",charIndex:1932},{level:4,title:"Mapper.java",slug:"mapper-java",normalizedTitle:"mapper.java",charIndex:3869},{level:4,title:"æ°æ®å®ä½.java",slug:"æ°æ®å®ä½-java",normalizedTitle:"æ°æ®å®ä½.java",charIndex:4340},{level:3,title:"æµè¯ç¨åº",slug:"æµè¯ç¨åº",normalizedTitle:"æµè¯ç¨åº",charIndex:4663},{level:2,title:"Mybatis çå½å¨æ",slug:"mybatis-çå½å¨æ",normalizedTitle:"mybatis çå½å¨æ",charIndex:5716},{level:3,title:"SqlSessionFactoryBuilder",slug:"sqlsessionfactorybuilder",normalizedTitle:"sqlsessionfactorybuilder",charIndex:4983},{level:4,title:"SqlSessionFactoryBuilder çèè´£",slug:"sqlsessionfactorybuilder-çèè´£",normalizedTitle:"sqlsessionfactorybuilder çèè´£",charIndex:5763},{level:4,title:"SqlSessionFactoryBuilder ççå½å¨æ",slug:"sqlsessionfactorybuilder-ççå½å¨æ",normalizedTitle:"sqlsessionfactorybuilder ççå½å¨æ",charIndex:6397},{level:3,title:"SqlSessionFactory",slug:"sqlsessionfactory",normalizedTitle:"sqlsessionfactory",charIndex:4817},{level:4,title:"SqlSessionFactory èè´£",slug:"sqlsessionfactory-èè´£",normalizedTitle:"sqlsessionfactory èè´£",charIndex:6680},{level:4,title:"SqlSessionFactory çå½å¨æ",slug:"sqlsessionfactory-çå½å¨æ",normalizedTitle:"sqlsessionfactory çå½å¨æ",charIndex:7734},{level:3,title:"SqlSession",slug:"sqlsession",normalizedTitle:"sqlsession",charIndex:4817},{level:4,title:"SqlSession èè´£",slug:"sqlsession-èè´£",normalizedTitle:"sqlsession èè´£",charIndex:7815},{level:4,title:"SqlSession çå½å¨æ",slug:"sqlsession-çå½å¨æ",normalizedTitle:"sqlsession çå½å¨æ",charIndex:7968},{level:3,title:"æ å°å¨",slug:"æ å°å¨",normalizedTitle:"æ å°å¨",charIndex:7876},{level:4,title:"æ å°å¨èè´£",slug:"æ å°å¨èè´£",normalizedTitle:"æ å°å¨èè´£",charIndex:8576},{level:4,title:"æ å°å¨çå½å¨æ",slug:"æ å°å¨çå½å¨æ",normalizedTitle:"æ å°å¨çå½å¨æ",charIndex:9331},{level:2,title:"Mybatis çæ¶æ",slug:"mybatis-çæ¶æ",normalizedTitle:"mybatis çæ¶æ",charIndex:9864},{level:3,title:"éç½®å±",slug:"éç½®å±",normalizedTitle:"éç½®å±",charIndex:10601},{level:3,title:"æ¥å£å±",slug:"æ¥å£å±",normalizedTitle:"æ¥å£å±",charIndex:10782},{level:3,title:"æ°æ®å¤çå±",slug:"æ°æ®å¤çå±",normalizedTitle:"æ°æ®å¤çå±",charIndex:11128},{level:3,title:"æ¡æ¶æ¯æå±",slug:"æ¡æ¶æ¯æå±",normalizedTitle:"æ¡æ¶æ¯æå±",charIndex:11658},{level:2,title:"SqlSession åé¨å·¥ä½æºå¶",slug:"sqlsession-åé¨å·¥ä½æºå¶",normalizedTitle:"sqlsession åé¨å·¥ä½æºå¶",charIndex:12447},{level:3,title:"SqlSession å­ç»ä»¶",slug:"sqlsession-å­ç»ä»¶",normalizedTitle:"sqlsession å­ç»ä»¶",charIndex:12720},{level:4,title:"Executor",slug:"executor",normalizedTitle:"executor",charIndex:6994},{level:4,title:"StatementHandler",slug:"statementhandler",normalizedTitle:"statementhandler",charIndex:10051},{level:4,title:"ParameterHandler",slug:"parameterhandler",normalizedTitle:"parameterhandler",charIndex:10152},{level:4,title:"ResultSetHandler",slug:"resultsethandler",normalizedTitle:"resultsethandler",charIndex:10211},{level:4,title:"TypeHandler",slug:"typehandler",normalizedTitle:"typehandler",charIndex:10277},{level:3,title:"SqlSession å Mapper",slug:"sqlsession-å-mapper",normalizedTitle:"sqlsession å mapper",charIndex:14308},{level:3,title:"SqlSession å Executor",slug:"sqlsession-å-executor",normalizedTitle:"sqlsession å executor",charIndex:15167},{level:3,title:"Executor å·¥ä½æµç¨",slug:"executor-å·¥ä½æµç¨",normalizedTitle:"executor å·¥ä½æµç¨",charIndex:16589},{level:3,title:"StatementHandler å·¥ä½æµç¨",slug:"statementhandler-å·¥ä½æµç¨",normalizedTitle:"statementhandler å·¥ä½æµç¨",charIndex:20173},{level:3,title:"ParameterHandler å·¥ä½æµç¨",slug:"parameterhandler-å·¥ä½æµç¨",normalizedTitle:"parameterhandler å·¥ä½æµç¨",charIndex:21804},{level:3,title:"ResultSetHandler å·¥ä½æµç¨",slug:"resultsethandler-å·¥ä½æµç¨",normalizedTitle:"resultsethandler å·¥ä½æµç¨",charIndex:23661},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:25345}],headersStr:"Mybatis å®æ´ç¤ºä¾ æ°æ®åºåå¤ æ·»å  Mybatis Mybatis éç½® Mapper Mapper.xml Mapper.java æ°æ®å®ä½.java æµè¯ç¨åº Mybatis çå½å¨æ SqlSessionFactoryBuilder SqlSessionFactoryBuilder çèè´£ SqlSessionFactoryBuilder ççå½å¨æ SqlSessionFactory SqlSessionFactory èè´£ SqlSessionFactory çå½å¨æ SqlSession SqlSession èè´£ SqlSession çå½å¨æ æ å°å¨ æ å°å¨èè´£ æ å°å¨çå½å¨æ Mybatis çæ¶æ éç½®å± æ¥å£å± æ°æ®å¤çå± æ¡æ¶æ¯æå± SqlSession åé¨å·¥ä½æºå¶ SqlSession å­ç»ä»¶ Executor StatementHandler ParameterHandler ResultSetHandler TypeHandler SqlSession å Mapper SqlSession å Executor Executor å·¥ä½æµç¨ StatementHandler å·¥ä½æµç¨ ParameterHandler å·¥ä½æµç¨ ResultSetHandler å·¥ä½æµç¨ åèèµæ",content:'# Mybatis åç\n\n> Mybatis çåèº«å°±æ¯ iBatis ï¼æ¯ä¸æ¬¾ä¼ç§çæä¹å±æ¡æ¶ï¼å®æ¯æèªå®ä¹ SQLãå­å¨è¿ç¨ä»¥åé«çº§æ å°ãæ¬æä»¥ä¸ä¸ª Mybatis å®æ´ç¤ºä¾ä¸ºåå¥ç¹ï¼ç»å Mybatis åºå±æºç åæï¼å¾æå¹¶èçè®²è§£ Mybatis çæ ¸å¿å·¥ä½æºå¶ã\n\n\n# Mybatis å®æ´ç¤ºä¾\n\n> è¿éï¼æå°ä»¥ä¸ä¸ªå¥é¨çº§çç¤ºä¾æ¥æ¼ç¤º Mybatis æ¯å¦ä½å·¥ä½çã\n> \n> æ³¨ï¼æ¬æåé¢ç« èä¸­çåçãæºç é¨åä¹å°åºäºè¿ä¸ªç¤ºä¾æ¥è¿è¡è®²è§£ã\n> \n> å®æ´ç¤ºä¾æºç å°å\n\n\n# æ°æ®åºåå¤\n\nå¨æ¬ç¤ºä¾ä¸­ï¼éè¦éå¯¹ä¸å¼ ç¨æ·è¡¨è¿è¡ CRUD æä½ãå¶æ°æ®æ¨¡åå¦ä¸ï¼\n\nCREATE TABLE IF NOT EXISTS user (\n    id      BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT \'Id\',\n    name    VARCHAR(10)         NOT NULL DEFAULT \'\' COMMENT \'ç¨æ·å\',\n    age     INT(3)              NOT NULL DEFAULT 0 COMMENT \'å¹´é¾\',\n    address VARCHAR(32)         NOT NULL DEFAULT \'\' COMMENT \'å°å\',\n    email   VARCHAR(32)         NOT NULL DEFAULT \'\' COMMENT \'é®ä»¶\',\n    PRIMARY KEY (id)\n) COMMENT = \'ç¨æ·è¡¨\';\n\nINSERT INTO user (name, age, address, email)\nVALUES (\'å¼ ä¸\', 18, \'åäº¬\', \'xxx@163.com\');\nINSERT INTO user (name, age, address, email)\nVALUES (\'æå\', 19, \'ä¸æµ·\', \'xxx@163.com\');\n\n\n\n# æ·»å  Mybatis\n\nå¦æä½¿ç¨ Maven æ¥æå»ºé¡¹ç®ï¼åéå°ä¸é¢çä¾èµä»£ç ç½®äº pom.xml æä»¶ä¸­ï¼\n\n<dependency>\n  <groupId>org.Mybatis</groupId>\n  <artifactId>Mybatis</artifactId>\n  <version>x.x.x</version>\n</dependency>\n\n\n\n# Mybatis éç½®\n\nXML éç½®æä»¶ä¸­åå«äºå¯¹ Mybatis ç³»ç»çæ ¸å¿è®¾ç½®ï¼åæ¬è·åæ°æ®åºè¿æ¥å®ä¾çæ°æ®æºï¼DataSourceï¼ä»¥åå³å®äºå¡ä½ç¨ååæ§å¶æ¹å¼çäºå¡ç®¡çå¨ï¼TransactionManagerï¼ã\n\næ¬ç¤ºä¾ä¸­åªæ¯ç»åºæç®åçéç½®ã\n\nãç¤ºä¾ãMybatis-config.xml æä»¶\n\n<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE configuration PUBLIC "-//Mybatis.org//DTD Config 3.0//EN"\n  "http://Mybatis.org/dtd/Mybatis-3-config.dtd">\n<configuration>\n  <environments default="development">\n    <environment id="development">\n      <transactionManager type="JDBC" />\n      <dataSource type="POOLED">\n        <property name="driver" value="com.mysql.cj.jdbc.Driver" />\n        <property name="url"\n                  value="jdbc:mysql://127.0.0.1:3306/spring_tutorial?serverTimezone=UTC" />\n        <property name="username" value="root" />\n        <property name="password" value="root" />\n      </dataSource>\n    </environment>\n  </environments>\n  <mappers>\n    <mapper resource="Mybatis/mapper/UserMapper.xml" />\n  </mappers>\n</configuration>\n\n\n> è¯´æï¼ä¸é¢çéç½®æä»¶ä¸­ä»ä»æå®äºæ°æ®æºè¿æ¥æ¹å¼å User è¡¨çæ å°éç½®æä»¶ã\n\n\n# Mapper\n\n# Mapper.xml\n\nä¸ªäººçè§£ï¼Mapper.xml æä»¶å¯ä»¥çåæ¯ Mybatis ç JDBC SQL æ¨¡æ¿ã\n\nãç¤ºä¾ãUserMapper.xml æä»¶\n\nä¸é¢æ¯ä¸ä¸ªéè¿ Mybatis Generator èªå¨çæçå®æ´ç Mapper æä»¶ã\n\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE mapper PUBLIC "-//Mybatis.org//DTD Mapper 3.0//EN" "http://Mybatis.org/dtd/Mybatis-3-mapper.dtd">\n<mapper namespace="io.github.dunwu.spring.orm.mapper.UserMapper">\n  <resultMap id="BaseResultMap" type="io.github.dunwu.spring.orm.entity.User">\n    <id column="id" jdbcType="BIGINT" property="id" />\n    <result column="name" jdbcType="VARCHAR" property="name" />\n    <result column="age" jdbcType="INTEGER" property="age" />\n    <result column="address" jdbcType="VARCHAR" property="address" />\n    <result column="email" jdbcType="VARCHAR" property="email" />\n  </resultMap>\n  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">\n    delete from user\n    where id = #{id,jdbcType=BIGINT}\n  </delete>\n  <insert id="insert" parameterType="io.github.dunwu.spring.orm.entity.User">\n    insert into user (id, name, age,\n      address, email)\n    values (#{id,jdbcType=BIGINT}, #{name,jdbcType=VARCHAR}, #{age,jdbcType=INTEGER},\n      #{address,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR})\n  </insert>\n  <update id="updateByPrimaryKey" parameterType="io.github.dunwu.spring.orm.entity.User">\n    update user\n    set name = #{name,jdbcType=VARCHAR},\n      age = #{age,jdbcType=INTEGER},\n      address = #{address,jdbcType=VARCHAR},\n      email = #{email,jdbcType=VARCHAR}\n    where id = #{id,jdbcType=BIGINT}\n  </update>\n  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">\n    select id, name, age, address, email\n    from user\n    where id = #{id,jdbcType=BIGINT}\n  </select>\n  <select id="selectAll" resultMap="BaseResultMap">\n    select id, name, age, address, email\n    from user\n  </select>\n</mapper>\n\n\n# Mapper.java\n\nMapper.java æä»¶æ¯ Mapper.xml å¯¹åºç Java å¯¹è±¡ã\n\nãç¤ºä¾ãUserMapper.java æä»¶\n\npublic interface UserMapper {\n\n    int deleteByPrimaryKey(Long id);\n\n    int insert(User record);\n\n    User selectByPrimaryKey(Long id);\n\n    List<User> selectAll();\n\n    int updateByPrimaryKey(User record);\n\n}\n\n\nå¯¹æ¯ UserMapper.java å UserMapper.xml æä»¶ï¼ä¸é¾åç°ï¼\n\nUserMapper.java ä¸­çæ¹æ³å UserMapper.xml ç CRUD è¯­å¥åç´ ï¼ <insert>ã<delete>ã<update>ã<select>ï¼å­å¨ä¸ä¸å¯¹åºå³ç³»ã\n\nå¨ Mybatis ä¸­ï¼æ­£æ¯éè¿æ¹æ³çå¨éå®åï¼å°äºèç»å®å¨ä¸èµ·ã\n\n# æ°æ®å®ä½.java\n\nãç¤ºä¾ãUser.java æä»¶\n\npublic class User {\n    private Long id;\n\n    private String name;\n\n    private Integer age;\n\n    private String address;\n\n    private String email;\n\n}\n\n\n<insert>ã<delete>ã<update>ã<select> ç parameterType å±æ§ä»¥å <resultMap> ç type å±æ§é½å¯è½ä¼ç»å®å°æ°æ®å®ä½ãè¿æ ·å°±å¯ä»¥æ JDBC æä½çè¾å¥è¾åºå JavaBean ç»åèµ·æ¥ï¼æ´å æ¹ä¾¿ãæäºçè§£ã\n\n\n# æµè¯ç¨åº\n\nãç¤ºä¾ãMybatisDemo.java æä»¶\n\npublic class MybatisDemo {\n\n    public static void main(String[] args) throws Exception {\n        // 1. å è½½ Mybatis éç½®æä»¶ï¼åå»º SqlSessionFactory\n        // æ³¨ï¼å¨å®éçåºç¨ä¸­ï¼SqlSessionFactory åºè¯¥æ¯åä¾\n        InputStream inputStream = Resources.getResourceAsStream("Mybatis/Mybatis-config.xml");\n        SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n        SqlSessionFactory factory = builder.build(inputStream);\n\n        // 2. åå»ºä¸ä¸ª SqlSession å®ä¾ï¼è¿è¡æ°æ®åºæä½\n        SqlSession sqlSession = factory.openSession();\n\n        // 3. Mapper æ å°å¹¶æ§è¡\n        Long params = 1L;\n        List<User> list = sqlSession.selectList("io.github.dunwu.spring.orm.mapper.UserMapper.selectByPrimaryKey", params);\n        for (User user : list) {\n            System.out.println("user name: " + user.getName());\n        }\n        // è¾åºï¼user name: å¼ ä¸\n    }\n\n}\n\n\n> è¯´æï¼\n> \n> SqlSession æ¥å£æ¯ Mybatis API æ ¸å¿ä¸­çæ ¸å¿ï¼å®ä»£è¡¨äº Mybatis åæ°æ®åºçä¸æ¬¡å®æ´ä¼è¯ã\n> \n>  * Mybatis ä¼è§£æéç½®ï¼å¹¶æ ¹æ®éç½®åå»º SqlSession ã\n>  * ç¶åï¼Mybatis å° Mapper æ å°ä¸º SqlSessionï¼ç¶åä¼ éåæ°ï¼æ§è¡ SQL è¯­å¥å¹¶è·åç»æã\n\n\n# Mybatis çå½å¨æ\n\n\n\n\n# SqlSessionFactoryBuilder\n\n# SqlSessionFactoryBuilder çèè´£\n\nSqlSessionFactoryBuilder è´è´£åå»º SqlSessionFactory å®ä¾ãSqlSessionFactoryBuilder å¯ä»¥ä» XML éç½®æä»¶æä¸ä¸ªé¢åå®å¶ç Configuration çå®ä¾æå»ºåº SqlSessionFactory çå®ä¾ã\n\nConfiguration ç±»åå«äºå¯¹ä¸ä¸ª SqlSessionFactory å®ä¾ä½ å¯è½å³å¿çææåå®¹ã\n\n\n\nSqlSessionFactoryBuilder åºç¨äºå»ºé èè®¾è®¡æ¨¡å¼ï¼å®æäºä¸ª build æ¹æ³ï¼åè®¸ä½ éè¿ä¸åçèµæºåå»º SqlSessionFactory å®ä¾ã\n\nSqlSessionFactory build(InputStream inputStream)\nSqlSessionFactory build(InputStream inputStream, String environment)\nSqlSessionFactory build(InputStream inputStream, Properties properties)\nSqlSessionFactory build(InputStream inputStream, String env, Properties props)\nSqlSessionFactory build(Configuration config)\n\n\n# SqlSessionFactoryBuilder ççå½å¨æ\n\nSqlSessionFactoryBuilder å¯ä»¥è¢«å®ä¾åãä½¿ç¨åä¸¢å¼ï¼ä¸æ¦åå»ºäº SqlSessionFactoryï¼å°±ä¸åéè¦å®äºã å æ­¤ SqlSessionFactoryBuilder å®ä¾çæä½³ä½ç¨åæ¯æ¹æ³ä½ç¨åï¼ä¹å°±æ¯å±é¨æ¹æ³åéï¼ãä½ å¯ä»¥éç¨ SqlSessionFactoryBuilder æ¥åå»ºå¤ä¸ª SqlSessionFactory å®ä¾ï¼ä½æå¥½è¿æ¯ä¸è¦ä¸ç´ä¿ççå®ï¼ä»¥ä¿è¯ææç XML è§£æèµæºå¯ä»¥è¢«éæ¾ç»æ´éè¦çäºæã\n\n\n# SqlSessionFactory\n\n# SqlSessionFactory èè´£\n\nSqlSessionFactory è´è´£åå»º SqlSession å®ä¾ã\n\n\n\nSqlSessionFactory åºç¨äºå·¥åè®¾è®¡æ¨¡å¼ï¼å®æä¾äºä¸ç»æ¹æ³ï¼ç¨äºåå»º SqlSession å®ä¾ã\n\nSqlSession openSession()\nSqlSession openSession(boolean autoCommit)\nSqlSession openSession(Connection connection)\nSqlSession openSession(TransactionIsolationLevel level)\nSqlSession openSession(ExecutorType execType, TransactionIsolationLevel level)\nSqlSession openSession(ExecutorType execType)\nSqlSession openSession(ExecutorType execType, boolean autoCommit)\nSqlSession openSession(ExecutorType execType, Connection connection)\nConfiguration getConfiguration();\n\n\næ¹æ³è¯´æï¼\n\n * é»è®¤ç openSession() æ¹æ³æ²¡æåæ°ï¼å®ä¼åå»ºå·å¤å¦ä¸ç¹æ§ç SqlSessionï¼\n   * äºå¡ä½ç¨åå°ä¼å¼å¯ï¼ä¹å°±æ¯ä¸èªå¨æäº¤ï¼ã\n   * å°ç±å½åç¯å¢éç½®ç DataSource å®ä¾ä¸­è·å Connection å¯¹è±¡ã\n   * äºå¡éç¦»çº§å«å°ä¼ä½¿ç¨é©±å¨ææ°æ®æºçé»è®¤è®¾ç½®ã\n   * é¢å¤çè¯­å¥ä¸ä¼è¢«å¤ç¨ï¼ä¹ä¸ä¼æ¹éå¤çæ´æ°ã\n * TransactionIsolationLevel è¡¨ç¤ºäºå¡éç¦»çº§å«ï¼å®å¯¹åºç JDBC çäºä¸ªäºå¡éç¦»çº§å«ã\n * ExecutorType æä¸¾ç±»åå®ä¹äºä¸ä¸ªå¼:\n   * ExecutorType.SIMPLEï¼è¯¥ç±»åçæ§è¡å¨æ²¡æç¹å«çè¡ä¸ºãå®ä¸ºæ¯ä¸ªè¯­å¥çæ§è¡åå»ºä¸ä¸ªæ°çé¢å¤çè¯­å¥ã\n   * ExecutorType.REUSEï¼è¯¥ç±»åçæ§è¡å¨ä¼å¤ç¨é¢å¤çè¯­å¥ã\n   * ExecutorType.BATCHï¼è¯¥ç±»åçæ§è¡å¨ä¼æ¹éæ§è¡æææ´æ°è¯­å¥ï¼å¦æ SELECT å¨å¤ä¸ªæ´æ°ä¸­é´æ§è¡ï¼å°å¨å¿è¦æ¶å°å¤æ¡æ´æ°è¯­å¥åéå¼æ¥ï¼ä»¥æ¹ä¾¿çè§£ã\n\n# SqlSessionFactory çå½å¨æ\n\nSqlSessionFactory åºè¯¥ä»¥åä¾å½¢å¼å¨åºç¨çè¿è¡æé´ä¸ç´å­å¨ã\n\n\n# SqlSession\n\n# SqlSession èè´£\n\nMybatis çä¸»è¦ Java æ¥å£å°±æ¯ SqlSessionãå®åå«äºæææ§è¡è¯­å¥ï¼è·åæ å°å¨åç®¡çäºå¡ç­æ¹æ³ã\n\n> è¯¦ç»åå®¹å¯ä»¥åèï¼ã Mybatis å®æ¹ææ¡£ä¹ SqlSessions ã ã\n\nSqlSession ç±»çæ¹æ³å¯ä»¥æç§ä¸å¾è¿è¡å¤§è´åç±»ï¼\n\n\n\n# SqlSession çå½å¨æ\n\nSqlSessions æ¯ç± SqlSessionFactory å®ä¾åå»ºçï¼è SqlSessionFactory æ¯ç± SqlSessionFactoryBuilder åå»ºçã\n\n> ð æ³¨æï¼å½ Mybatis ä¸ä¸äºä¾èµæ³¨å¥æ¡æ¶ï¼å¦ Spring æè Guiceï¼åæ¶ä½¿ç¨æ¶ï¼SqlSessions å°è¢«ä¾èµæ³¨å¥æ¡æ¶æåå»ºï¼æä»¥ä½ ä¸éè¦ä½¿ç¨ SqlSessionFactoryBuilder æè SqlSessionFactoryã\n\næ¯ä¸ªçº¿ç¨é½åºè¯¥æå®èªå·±ç SqlSession å®ä¾ã\n\nSqlSession çå®ä¾ä¸æ¯çº¿ç¨å®å¨çï¼å æ­¤æ¯ä¸è½è¢«å±äº«çï¼æä»¥å®çæä½³çä½ç¨åæ¯è¯·æ±ææ¹æ³ä½ç¨åã ç»å¯¹ä¸è½å° SqlSession å®ä¾çå¼ç¨æ¾å¨ä¸ä¸ªç±»çéæåï¼çè³ä¸ä¸ªç±»çå®ä¾åéä¹ä¸è¡ã ä¹ç»ä¸è½å° SqlSession å®ä¾çå¼ç¨æ¾å¨ä»»ä½ç±»åçæç®¡ä½ç¨åä¸­ï¼æ¯å¦ Servlet æ¡æ¶ä¸­ç HttpSessionã æ­£ç¡®å¨ Web ä¸­ä½¿ç¨ SqlSession çåºæ¯æ¯ï¼æ¯æ¬¡æ¶å°ç HTTP è¯·æ±ï¼å°±å¯ä»¥æå¼ä¸ä¸ª SqlSessionï¼è¿åä¸ä¸ªååºï¼å°±å³é­å®ã\n\nç¼ç¨æ¨¡å¼ï¼\n\ntry (SqlSession session = sqlSessionFactory.openSession()) {\n  // ä½ çåºç¨é»è¾ä»£ç \n}\n\n\n\n# æ å°å¨\n\n# æ å°å¨èè´£\n\næ å°å¨æ¯ä¸äºç±ç¨æ·åå»ºçãç»å® SQL è¯­å¥çæ¥å£ã\n\nSqlSession ä¸­ç insertãupdateãdelete å select æ¹æ³é½å¾å¼ºå¤§ï¼ä½ä¹æäºç¹çãæ´éç¨çæ¹å¼æ¯ä½¿ç¨æ å°å¨ç±»æ¥æ§è¡æ å°è¯­å¥ãä¸ä¸ªæ å°å¨ç±»å°±æ¯ä¸ä¸ªä»éå£°æä¸ SqlSession æ¹æ³ç¸å¹éçæ¹æ³çæ¥å£ç±»ã\n\nMybatis å°éç½®æä»¶ä¸­çæ¯ä¸ä¸ª <mapper> èç¹æ½è±¡ä¸ºä¸ä¸ª Mapper æ¥å£ï¼èè¿ä¸ªæ¥å£ä¸­å£°æçæ¹æ³åè· <mapper> èç¹ä¸­ç <select|update|delete|insert> èç¹ç¸å¯¹åºï¼å³ <select|update|delete|insert> èç¹ç id å¼ä¸º Mapper æ¥å£ä¸­çæ¹æ³åç§°ï¼parameterType å¼è¡¨ç¤º Mapper å¯¹åºæ¹æ³çå¥åç±»åï¼è resultMap å¼åå¯¹åºäº Mapper æ¥å£è¡¨ç¤ºçè¿åå¼ç±»åæèè¿åç»æéçåç´ ç±»åã\n\nMybatis ä¼æ ¹æ®ç¸åºçæ¥å£å£°æçæ¹æ³ä¿¡æ¯ï¼éè¿å¨æä»£çæºå¶çæä¸ä¸ª Mapper å®ä¾ï¼Mybatis ä¼æ ¹æ®è¿ä¸ªæ¹æ³çæ¹æ³åååæ°ç±»åï¼ç¡®å® Statement Idï¼ç¶åå SqlSession è¿è¡æ å°ï¼åºå±è¿æ¯éè¿ SqlSession å®æåæ°æ®åºçäº¤äºã\n\nä¸é¢çç¤ºä¾å±ç¤ºäºä¸äºæ¹æ³ç­¾åä»¥åå®ä»¬æ¯å¦ä½æ å°å° SqlSession ä¸çã\n\n\n\n> æ³¨æ\n> \n>  * æ å°å¨æ¥å£ä¸éè¦å»å®ç°ä»»ä½æ¥å£æç»§æ¿èªä»»ä½ç±»ãåªè¦æ¹æ³å¯ä»¥è¢«å¯ä¸æ è¯å¯¹åºçæ å°è¯­å¥å°±å¯ä»¥äºã\n>  * æ å°å¨æ¥å£å¯ä»¥ç»§æ¿èªå¶ä»æ¥å£ãå½ä½¿ç¨ XML æ¥æå»ºæ å°å¨æ¥å£æ¶è¦ä¿è¯è¯­å¥è¢«åå«å¨åéçå½åç©ºé´ä¸­ãèä¸ï¼å¯ä¸çéå¶å°±æ¯ä½ ä¸è½å¨ä¸¤ä¸ªç»§æ¿å³ç³»çæ¥å£ä¸­æ¥æç¸åçæ¹æ³ç­¾åï¼æ½å¨çå±é©åæ³ä¸å¯åï¼ã\n\n# æ å°å¨çå½å¨æ\n\næ å°å¨æ¥å£çå®ä¾æ¯ä» SqlSession ä¸­è·å¾çãå æ­¤ä»ææ¯å±é¢è®²ï¼ä»»ä½æ å°å¨å®ä¾çæå¤§ä½ç¨åæ¯åè¯·æ±å®ä»¬ç SqlSession ç¸åçãå°½ç®¡å¦æ­¤ï¼æ å°å¨å®ä¾çæä½³ä½ç¨åæ¯æ¹æ³ä½ç¨åã ä¹å°±æ¯è¯´ï¼æ å°å¨å®ä¾åºè¯¥å¨è°ç¨å®ä»¬çæ¹æ³ä¸­è¢«è¯·æ±ï¼ç¨è¿ä¹åå³å¯ä¸¢å¼ã\n\nç¼ç¨æ¨¡å¼ï¼\n\ntry (SqlSession session = sqlSessionFactory.openSession()) {\n  BlogMapper mapper = session.getMapper(BlogMapper.class);\n  // ä½ çåºç¨é»è¾ä»£ç \n}\n\n\n * æ å°å¨æ³¨è§£\n\nMybatis æ¯ä¸ä¸ª XML é©±å¨çæ¡æ¶ãéç½®ä¿¡æ¯æ¯åºäº XML çï¼èä¸æ å°è¯­å¥ä¹æ¯å®ä¹å¨ XML ä¸­çãMybatis 3 ä»¥åï¼æ¯ææ³¨è§£éç½®ãæ³¨è§£éç½®åºäºéç½® APIï¼èéç½® API åºäº XML éç½®ã\n\nMybatis æ¯æè¯¸å¦ @Insertã@Updateã@Deleteã@Selectã@Result ç­æ³¨è§£ã\n\n> è¯¦ç»åå®¹è¯·åèï¼Mybatis å®æ¹ææ¡£ä¹ sqlSessionsï¼å¶ä¸­åä¸¾äº Mybatis æ¯æçæ³¨è§£æ¸åï¼ä»¥ååºæ¬ç¨æ³ã\n\n\n# Mybatis çæ¶æ\n\nä» Mybatis ä»£ç å®ç°çè§åº¦æ¥çï¼Mybatis çä¸»è¦ç»ä»¶æä»¥ä¸å ä¸ªï¼\n\n * SqlSession - ä½ä¸º Mybatis å·¥ä½çä¸»è¦é¡¶å± APIï¼è¡¨ç¤ºåæ°æ®åºäº¤äºçä¼è¯ï¼å®æå¿è¦æ°æ®åºå¢å æ¹æ¥åè½ã\n * Executor - Mybatis æ§è¡å¨ï¼æ¯ Mybatis è°åº¦çæ ¸å¿ï¼è´è´£ SQL è¯­å¥ççæåæ¥è¯¢ç¼å­çç»´æ¤ã\n * StatementHandler - å°è£äº JDBC Statement æä½ï¼è´è´£å¯¹ JDBC statement çæä½ï¼å¦è®¾ç½®åæ°ãå° Statement ç»æéè½¬æ¢æ List éåã\n * ParameterHandler - è´è´£å¯¹ç¨æ·ä¼ éçåæ°è½¬æ¢æ JDBC Statement æéè¦çåæ°ã\n * ResultSetHandler - è´è´£å° JDBC è¿åç ResultSet ç»æéå¯¹è±¡è½¬æ¢æ List ç±»åçéåã\n * TypeHandler - è´è´£ java æ°æ®ç±»åå jdbc æ°æ®ç±»åä¹é´çæ å°åè½¬æ¢ã\n * MappedStatement - MappedStatement ç»´æ¤äºä¸æ¡ <select|update|delete|insert> èç¹çå°è£ã\n * SqlSource - è´è´£æ ¹æ®ç¨æ·ä¼ éç parameterObjectï¼å¨æå°çæ SQL è¯­å¥ï¼å°ä¿¡æ¯å°è£å° BoundSql å¯¹è±¡ä¸­ï¼å¹¶è¿åã\n * BoundSql - è¡¨ç¤ºå¨æçæç SQL è¯­å¥ä»¥åç¸åºçåæ°ä¿¡æ¯ã\n * Configuration - Mybatis ææçéç½®ä¿¡æ¯é½ç»´æå¨ Configuration å¯¹è±¡ä¹ä¸­ã\n\nè¿äºç»ä»¶çæ¶æå±æ¬¡å¦ä¸ï¼\n\n\n\n\n# éç½®å±\n\néç½®å±å³å®äº Mybatis çå·¥ä½æ¹å¼ã\n\nMybatis æä¾äºä¸¤ç§éç½®æ¹å¼ï¼\n\n * åºäº XML éç½®æä»¶çæ¹å¼\n * åºäº Java API çæ¹å¼\n\nSqlSessionFactoryBuilder ä¼æ ¹æ®éç½®åå»º SqlSessionFactory ï¼\n\nSqlSessionFactory è´è´£åå»º SqlSessions ã\n\n\n# æ¥å£å±\n\næ¥å£å±è´è´£åæ°æ®åºäº¤äºçæ¹å¼ã\n\nMybatis åæ°æ®åºçäº¤äºæä¸¤ç§æ¹å¼ï¼\n\n * ä½¿ç¨ SqlSessionï¼SqlSession å°è£äºæææ§è¡è¯­å¥ï¼è·åæ å°å¨åç®¡çäºå¡çæ¹æ³ã\n   * ç¨æ·åªéè¦ä¼ å¥ Statement Id åæ¥è¯¢åæ°ç» SqlSession å¯¹è±¡ï¼å°±å¯ä»¥å¾æ¹ä¾¿çåæ°æ®åºè¿è¡äº¤äºã\n   * è¿ç§æ¹å¼çç¼ºç¹æ¯ä¸ç¬¦åé¢åå¯¹è±¡ç¼ç¨çèå¼ã\n * ä½¿ç¨ Mapper æ¥å£ï¼Mybatis ä¼æ ¹æ®ç¸åºçæ¥å£å£°æçæ¹æ³ä¿¡æ¯ï¼éè¿å¨æä»£çæºå¶çæä¸ä¸ª Mapper å®ä¾ï¼Mybatis ä¼æ ¹æ®è¿ä¸ªæ¹æ³çæ¹æ³åååæ°ç±»åï¼ç¡®å® Statement Idï¼ç¶åå SqlSession è¿è¡æ å°ï¼åºå±è¿æ¯éè¿ SqlSession å®æåæ°æ®åºçäº¤äºã\n\n\n# æ°æ®å¤çå±\n\næ°æ®å¤çå±å¯ä»¥è¯´æ¯ Mybatis çæ ¸å¿ï¼ä»å¤§çæ¹é¢ä¸è®²ï¼å®è¦å®æä¸¤ä¸ªåè½ï¼\n\n * æ ¹æ®ä¼ å Statement ååæ°æå»ºå¨æ SQL è¯­å¥\n   * å¨æè¯­å¥çæå¯ä»¥è¯´æ¯ Mybatis æ¡æ¶éå¸¸ä¼éçä¸ä¸ªè®¾è®¡ï¼Mybatis éè¿ä¼ å¥çåæ°å¼ï¼ä½¿ç¨ Ognl æ¥å¨æå°æé  SQL è¯­å¥ï¼ä½¿å¾ Mybatis æå¾å¼ºççµæ´»æ§åæ©å±æ§ã\n   * åæ°æ å°æçæ¯å¯¹äº java æ°æ®ç±»åå jdbc æ°æ®ç±»åä¹é´çè½¬æ¢ï¼è¿éæåæ¬ä¸¤ä¸ªè¿ç¨ï¼æ¥è¯¢é¶æ®µï¼æä»¬è¦å° java ç±»åçæ°æ®ï¼è½¬æ¢æ jdbc ç±»åçæ°æ®ï¼éè¿ preparedStatement.setXXX() æ¥è®¾å¼ï¼å¦ä¸ä¸ªå°±æ¯å¯¹ resultset æ¥è¯¢ç»æéç jdbcType æ°æ®è½¬æ¢æ java æ°æ®ç±»åã\n * æ§è¡ SQL è¯­å¥ä»¥åå¤çååºç»æé ResultSet\n   * å¨æ SQL è¯­å¥çæä¹åï¼Mybatis å°æ§è¡ SQL è¯­å¥ï¼å¹¶å°å¯è½è¿åçç»æéè½¬æ¢æ List<E> åè¡¨ã\n   * Mybatis å¨å¯¹ç»æéçå¤çä¸­ï¼æ¯æç»æéå³ç³»ä¸å¯¹å¤åå¤å¯¹ä¸çè½¬æ¢ï¼å¹¶ä¸æä¸¤ç§æ¯ææ¹å¼ï¼ä¸ç§ä¸ºåµå¥æ¥è¯¢è¯­å¥çæ¥è¯¢ï¼è¿æä¸ç§æ¯åµå¥ç»æéçæ¥è¯¢ã\n\n\n# æ¡æ¶æ¯æå±\n\n * äºå¡ç®¡çæºå¶ - Mybatis å°äºå¡æ½è±¡æäº Transaction æ¥å£ãMybatis çäºå¡ç®¡çåä¸ºä¸¤ç§å½¢å¼ï¼\n   \n   * ä½¿ç¨ JDBC çäºå¡ç®¡çæºå¶ï¼å³å©ç¨ java.sql.Connection å¯¹è±¡å®æå¯¹äºå¡çæäº¤ï¼commitï¼ãåæ»ï¼rollbackï¼ãå³é­ï¼closeï¼ç­ã\n   * ä½¿ç¨ MANAGED çäºå¡ç®¡çæºå¶ï¼Mybatis èªèº«ä¸ä¼å»å®ç°äºå¡ç®¡çï¼èæ¯è®©ç¨åºçå®¹å¨å¦ï¼JBOSSï¼Weblogicï¼æ¥å®ç°å¯¹äºå¡çç®¡çã\n\n * è¿æ¥æ± ç®¡ç\n\n * SQL è¯­å¥çéç½® - æ¯æä¸¤ç§æ¹å¼ï¼\n   \n   * xml éç½®\n   * æ³¨è§£éç½®\n\n * ç¼å­æºå¶ - Mybatis éç¨ä¸¤çº§ç¼å­ç»æ\n   \n   * ä¸çº§ç¼å­æ¯ Session ä¼è¯çº§å«çç¼å­ - ä¸çº§ç¼å­åè¢«ç§°ä¹ä¸ºæ¬å°ç¼å­ãä¸è¬èè¨ï¼ä¸ä¸ª SqlSession å¯¹è±¡ä¼ä½¿ç¨ä¸ä¸ª Executor å¯¹è±¡æ¥å®æä¼è¯æä½ï¼Executor å¯¹è±¡ä¼ç»´æ¤ä¸ä¸ª Cache ç¼å­ï¼ä»¥æé«æ¥è¯¢æ§è½ã\n     * ä¸çº§ç¼å­ççå½å¨ææ¯ Session ä¼è¯çº§å«çã\n   * äºçº§ç¼å­æ¯ Application åºç¨çº§å«çç¼å­ - ç¨æ·éç½®äº "cacheEnabled=true"ï¼æä¼å¼å¯äºçº§ç¼å­ã\n     * å¦æå¼å¯äºäºçº§ç¼å­ï¼SqlSession ä¼åä½¿ç¨ CachingExecutor å¯¹è±¡æ¥å¤çæ¥è¯¢è¯·æ±ãCachingExecutor ä¼å¨äºçº§ç¼å­ä¸­æ¥çæ¯å¦æå¹éçæ°æ®ï¼å¦æå¹éï¼åç´æ¥è¿åç¼å­ç»æï¼å¦æç¼å­ä¸­æ²¡æï¼åäº¤ç»çæ­£ç Executor å¯¹è±¡æ¥å®ææ¥è¯¢ï¼ä¹å CachingExecutor ä¼å°çæ­£ Executor è¿åçæ¥è¯¢ç»ææ¾ç½®å°ç¼å­ä¸­ï¼ç¶åå¨è¿åç»ç¨æ·ã\n     * äºçº§ç¼å­ççå½å¨ææ¯åºç¨çº§å«çã\n\n\n\n\n# SqlSession åé¨å·¥ä½æºå¶\n\nä»åæï¼æä»¬å·²ç»äºè§£äºï¼Mybatis å°è£äºå¯¹æ°æ®åºçè®¿é®ï¼æå¯¹æ°æ®åºçä¼è¯åäºå¡æ§å¶æ¾å°äº SqlSession å¯¹è±¡ä¸­ãé£ä¹å·ä½æ¯å¦ä½å·¥ä½çå¢ï¼æ¥ä¸æ¥ï¼æä»¬éè¿æºç è§£è¯»æ¥è¿è¡åæã\n\n\n\nSqlSession å¯¹äº insertãupdateãdeleteãselect çåé¨å¤çæºå¶åºæ¬ä¸å¤§åå°å¼ãæä»¥ï¼æ¥ä¸æ¥ï¼æä¼ä»¥ä¸æ¬¡å®æ´ç select æ¥è¯¢æµç¨ä¸ºä¾è®²è§£ SqlSession åé¨çå·¥ä½æºå¶ãç¸ä¿¡è¯»èå¦æçè§£äº select çå¤çæµç¨ï¼å¯¹äºå¶ä» CRUD æä½ä¹è½åå°ä¸éç¾éã\n\n\n# SqlSession å­ç»ä»¶\n\nåé¢çåå®¹å·²ç»ä»ç»äºï¼SqlSession æ¯ Mybatis çé¡¶å±æ¥å£ï¼å®æä¾äºæææ§è¡è¯­å¥ï¼è·åæ å°å¨åç®¡çäºå¡ç­æ¹æ³ã\n\nå®éä¸ï¼SqlSession æ¯éè¿èåå¤ä¸ªå­ç»ä»¶ï¼è®©æ¯ä¸ªå­ç»ä»¶è´è´£åèªåè½çæ¹å¼ï¼å®ç°äºä»»å¡çä¸åã\n\nå¨äºè§£åä¸ªå­ç»ä»¶å·¥ä½æºå¶åï¼åè®©æä»¬ç®åè®¤è¯ä¸ä¸ SqlSession çæ ¸å¿å­ç»ä»¶ã\n\n# Executor\n\nExecutor å³æ§è¡å¨ï¼å®è´è´£çæå¨æ SQL ä»¥åç®¡çç¼å­ã\n\n\n\n * Executor å³æ§è¡å¨æ¥å£ã\n * BaseExecutor æ¯ Executor çæ½è±¡ç±»ï¼å®éç¨äºæ¨¡æ¿æ¹æ³è®¾è®¡æ¨¡å¼ï¼åç½®äºä¸äºå±æ§æ¹æ³ï¼èå°å®å¶åæ¹æ³çç»å­ç±»å»å®ç°ã\n * SimpleExecutor æ¯æç®åçæ§è¡å¨ãå®åªä¼ç´æ¥æ§è¡ SQLï¼ä¸ä¼åé¢å¤çäºã\n * BatchExecutor æ¯æ¹å¤çæ§è¡å¨ãå®çä½ç¨æ¯éè¿æ¹å¤çæ¥ä¼åæ§è½ãå¼å¾æ³¨æçæ¯ï¼æ¹éæ´æ°æä½ï¼ç±äºåé¨æç¼å­æºå¶ï¼ä½¿ç¨å®åéè¦è°ç¨ flushStatements æ¥æ¸é¤ç¼å­ã\n * ReuseExecutor æ¯å¯éç¨çæ§è¡å¨ãéç¨çå¯¹è±¡æ¯ Statementï¼ä¹å°±æ¯è¯´ï¼è¯¥æ§è¡å¨ä¼ç¼å­åä¸ä¸ª SQL ç Statementï¼é¿åéå¤åå»º Statementãå¶åé¨çå®ç°æ¯éè¿ä¸ä¸ª HashMap æ¥ç»´æ¤ Statement å¯¹è±¡çãç±äºå½å Map åªå¨è¯¥ session ä¸­ææï¼æä»¥ä½¿ç¨å®åéè¦è°ç¨ flushStatements æ¥æ¸é¤ Mapã\n * CachingExecutor æ¯ç¼å­æ§è¡å¨ãå®åªå¨å¯ç¨äºçº§ç¼å­æ¶æä¼ç¨å°ã\n\n# StatementHandler\n\nStatementHandler å¯¹è±¡è´è´£è®¾ç½® Statement å¯¹è±¡ä¸­çæ¥è¯¢åæ°ãå¤ç JDBC è¿åç resultSetï¼å° resultSet å å·¥ä¸º List éåè¿åã\n\nStatementHandler çå®¶ææåï¼\n\n\n\n * StatementHandler æ¯æ¥å£ï¼\n * BaseStatementHandler æ¯å®ç° StatementHandler çæ½è±¡ç±»ï¼åç½®ä¸äºå±æ§æ¹æ³ï¼\n * SimpleStatementHandler è´è´£å¤ç Statementï¼\n * PreparedStatementHandler è´è´£å¤ç PreparedStatementï¼\n * CallableStatementHandler è´è´£å¤ç CallableStatementã\n * RoutingStatementHandler è´è´£ä»£ç StatementHandler å·ä½å­ç±»ï¼æ ¹æ® Statement ç±»åï¼éæ©å®ä¾å SimpleStatementHandlerãPreparedStatementHandlerãCallableStatementHandlerã\n\n# ParameterHandler\n\nParameterHandler è´è´£å°ä¼ å¥ç Java å¯¹è±¡è½¬æ¢ JDBC ç±»åå¯¹è±¡ï¼å¹¶ä¸º PreparedStatement çå¨æ SQL å¡«åæ°å¼ã\n\nParameterHandler åªæä¸ä¸ªå·ä½å®ç°ç±»ï¼å³ DefaultParameterHandlerã\n\n# ResultSetHandler\n\nResultSetHandler è´è´£ä¸¤ä»¶äºï¼\n\n * å¤ç Statement æ§è¡åäº§ççç»æéï¼çæç»æåè¡¨\n * å¤çå­å¨è¿ç¨æ§è¡åçè¾åºåæ°\n\nResultSetHandler åªæä¸ä¸ªå·ä½å®ç°ç±»ï¼å³ DefaultResultSetHandlerã\n\n# TypeHandler\n\nTypeHandler è´è´£å° Java å¯¹è±¡ç±»åå JDBC ç±»åè¿è¡ç¸äºè½¬æ¢ã\n\n\n# SqlSession å Mapper\n\nåæ¥åå¿ä¸ä¸ Mybatis å®æ´ç¤ºä¾ç« èç æµè¯ç¨åºé¨åçä»£ç ã\n\nMybatisDemo.java æä»¶ä¸­çä»£ç çæ®µï¼\n\n// 2. åå»ºä¸ä¸ª SqlSession å®ä¾ï¼è¿è¡æ°æ®åºæä½\nSqlSession sqlSession = factory.openSession();\n\n// 3. Mapper æ å°å¹¶æ§è¡\nLong params = 1L;\nList<User> list = sqlSession.selectList("io.github.dunwu.spring.orm.mapper.UserMapper.selectByPrimaryKey", params);\nfor (User user : list) {\n    System.out.println("user name: " + user.getName());\n}\n\n\nç¤ºä¾ä»£ç ä¸­ï¼ç» sqlSession å¯¹è±¡çä¼ éä¸ä¸ªéç½®ç Sql è¯­å¥ç Statement Id ååæ°ï¼ç¶åè¿åç»æ\n\nio.github.dunwu.spring.orm.mapper.UserMapper.selectByPrimaryKey æ¯éç½®å¨ UserMapper.xml ç Statement IDï¼params æ¯ SQL åæ°ã\n\nUserMapper.xml æä»¶ä¸­çä»£ç çæ®µï¼\n\n  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">\n    select id, name, age, address, email\n    from user\n    where id = #{id,jdbcType=BIGINT}\n  </select>\n\n\nMybatis éè¿æ¹æ³çå¨éå®åï¼å° SqlSession å Mapper ç¸äºæ å°èµ·æ¥ã\n\n\n# SqlSession å Executor\n\norg.apache.ibatis.session.defaults.DefaultSqlSession ä¸­ selectList æ¹æ³çæºç ï¼\n\n@Override\npublic <E> List<E> selectList(String statement) {\n  return this.selectList(statement, null);\n}\n\n@Override\npublic <E> List<E> selectList(String statement, Object parameter) {\n  return this.selectList(statement, parameter, RowBounds.DEFAULT);\n}\n\n@Override\npublic <E> List<E> selectList(String statement, Object parameter, RowBounds rowBounds) {\n  try {\n    // 1. æ ¹æ® Statement Idï¼å¨éç½®å¯¹è±¡ Configuration ä¸­æ¥æ¾åéç½®æä»¶ç¸å¯¹åºç MappedStatement\n    MappedStatement ms = configuration.getMappedStatement(statement);\n    // 2. å° SQL è¯­å¥äº¤ç±æ§è¡å¨ Executor å¤ç\n    return executor.query(ms, wrapCollection(parameter), rowBounds, Executor.NO_RESULT_HANDLER);\n  } catch (Exception e) {\n    throw ExceptionFactory.wrapException("Error querying database.  Cause: " + e, e);\n  } finally {\n    ErrorContext.instance().reset();\n  }\n}\n\n\nè¯´æï¼\n\nMybatis ææçéç½®ä¿¡æ¯é½ç»´æå¨ Configuration å¯¹è±¡ä¹ä¸­ãä¸­ç»´æ¤äºä¸ä¸ª Map<String, MappedStatement> å¯¹è±¡ãå¶ä¸­ï¼key ä¸º Mapper æ¹æ³çå¨éå®åï¼å¯¹äºæ¬ä¾èè¨ï¼key å°±æ¯ io.github.dunwu.spring.orm.mapper.UserMapper.selectByPrimaryKey ï¼ï¼value ä¸º MappedStatement å¯¹è±¡ãæä»¥ï¼ä¼ å¥ Statement Id å°±å¯ä»¥ä» Map ä¸­æ¾å°å¯¹åºç MappedStatementã\n\nMappedStatement ç»´æ¤äºä¸ä¸ª Mapper æ¹æ³çåæ°æ®ä¿¡æ¯ï¼å¶æ°æ®ç»ç»å¯ä»¥åèä¸é¢ç debug æªå¾ï¼\n\n\n\n> å°ç»ï¼\n> \n> éè¿ "SqlSession å Mapper" ä»¥å "SqlSession å Executor" è¿ä¸¤èï¼æä»¬å·²ç»ç¥éï¼\n> \n> SqlSession çèè½æ¯ï¼æ ¹æ® Statement ID, å¨ Configuration ä¸­è·åå°å¯¹åºç MappedStatement å¯¹è±¡ï¼ç¶åè°ç¨ Executor æ¥æ§è¡å·ä½çæä½ã\n\n\n# Executor å·¥ä½æµç¨\n\nç»§ç»­ä¸ä¸èçæµç¨ï¼SqlSession å° SQL è¯­å¥äº¤ç±æ§è¡å¨ Executor å¤çãExecutor ååäºåªäºäºå¿å¢ï¼\n\nï¼1ï¼æ§è¡å¨æ¥è¯¢å¥å£\n\npublic <E> List<E> query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler) throws SQLException {\n\t// 1. æ ¹æ®ä¼ åï¼å¨æçæéè¦æ§è¡ç SQL è¯­å¥ï¼ç¨ BoundSql å¯¹è±¡è¡¨ç¤º\n    BoundSql boundSql = ms.getBoundSql(parameter);\n    // 2. æ ¹æ®ä¼ åï¼åå»ºä¸ä¸ªç¼å­Key\n    CacheKey key = createCacheKey(ms, parameter, rowBounds, boundSql);\n    return query(ms, parameter, rowBounds, resultHandler, key, boundSql);\n }\n\n\næ§è¡å¨æ¥è¯¢å¥å£ä¸»è¦åä¸¤ä»¶äºï¼\n\n * çæå¨æ SQLï¼æ ¹æ®ä¼ åï¼å¨æçæéè¦æ§è¡ç SQL è¯­å¥ï¼ç¨ BoundSql å¯¹è±¡è¡¨ç¤ºã\n * ç®¡çç¼å­ï¼æ ¹æ®ä¼ åï¼åå»ºä¸ä¸ªç¼å­ Keyã\n\nï¼2ï¼æ§è¡å¨æ¥è¯¢ç¬¬äºå¥å£\n\n  @SuppressWarnings("unchecked")\n  @Override\n  public <E> List<E> query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException {\n    // ç¥\n    List<E> list;\n    try {\n      queryStack++;\n      list = resultHandler == null ? (List<E>) localCache.getObject(key) : null;\n      // 3. ç¼å­ä¸­æå¼ï¼åç´æ¥ä»ç¼å­ä¸­åæ°æ®ï¼å¦åï¼æ¥è¯¢æ°æ®åº\n      if (list != null) {\n        handleLocallyCachedOutputParameters(ms, key, parameter, boundSql);\n      } else {\n        list = queryFromDatabase(ms, parameter, rowBounds, resultHandler, key, boundSql);\n      }\n    } finally {\n      queryStack--;\n    }\n    // ç¥\n    return list;\n  }\n\n\nå®éæ¥è¯¢æ¹æ³ä¸»è¦çèè½æ¯å¤æ­ç¼å­ key æ¯å¦è½å½ä¸­ç¼å­ï¼\n\n * å½ä¸­ï¼åå°ç¼å­ä¸­æ°æ®è¿åï¼\n * ä¸å½ä¸­ï¼åæ¥è¯¢æ°æ®åºï¼\n\nï¼3ï¼æ¥è¯¢æ°æ®åº\n\n  private <E> List<E> queryFromDatabase(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException {\n    List<E> list;\n    localCache.putObject(key, EXECUTION_PLACEHOLDER);\n    try {\n      // 4. æ§è¡æ¥è¯¢ï¼è·å List ç»æï¼å¹¶å°æ¥è¯¢çç»ææ´æ°æ¬å°ç¼å­ä¸­\n      list = doQuery(ms, parameter, rowBounds, resultHandler, boundSql);\n    } finally {\n      localCache.removeObject(key);\n    }\n    localCache.putObject(key, list);\n    if (ms.getStatementType() == StatementType.CALLABLE) {\n      localOutputParameterCache.putObject(key, parameter);\n    }\n    return list;\n  }\n\n\nqueryFromDatabase æ¹æ³çèè´£æ¯è°ç¨ doQueryï¼åæ°æ®åºåèµ·æ¥è¯¢ï¼å¹¶å°è¿åçç»ææ´æ°å°æ¬å°ç¼å­ã\n\nï¼4ï¼å®éæ¥è¯¢æ¹æ³\n\nSimpleExecutor ç±»ç doQuery()æ¹æ³å®ç°\n\n  @Override\n  public <E> List<E> doQuery(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) throws SQLException {\n    Statement stmt = null;\n    try {\n      Configuration configuration = ms.getConfiguration();\n      // 5. æ ¹æ®æ¢æçåæ°ï¼åå»ºStatementHandlerå¯¹è±¡æ¥æ§è¡æ¥è¯¢æä½\n      StatementHandler handler = configuration.newStatementHandler(wrapper, ms, parameter, rowBounds, resultHandler, boundSql);\n      // 6. åå»ºjava.Sql.Statementå¯¹è±¡ï¼ä¼ éç»StatementHandlerå¯¹è±¡\n      stmt = prepareStatement(handler, ms.getStatementLog());\n      // 7. è°ç¨StatementHandler.query()æ¹æ³ï¼è¿åListç»æ\n      return handler.query(stmt, resultHandler);\n    } finally {\n      closeStatement(stmt);\n    }\n  }\n\n\nä¸è¿°ç Executor.query()æ¹æ³å ç»è½¬æï¼æåä¼åå»ºä¸ä¸ª StatementHandler å¯¹è±¡ï¼ç¶åå°å¿è¦çåæ°ä¼ éç» StatementHandlerï¼ä½¿ç¨ StatementHandler æ¥å®æå¯¹æ°æ®åºçæ¥è¯¢ï¼æç»è¿å List ç»æéã ä»ä¸é¢çä»£ç ä¸­æä»¬å¯ä»¥çåºï¼Executor çåè½åä½ç¨æ¯ï¼\n\n 1. æ ¹æ®ä¼ éçåæ°ï¼å®æ SQL è¯­å¥çå¨æè§£æï¼çæ BoundSql å¯¹è±¡ï¼ä¾ StatementHandler ä½¿ç¨ï¼\n\n 2. ä¸ºæ¥è¯¢åå»ºç¼å­ï¼ä»¥æé«æ§è½\n\n 3. åå»º JDBC ç Statement è¿æ¥å¯¹è±¡ï¼ä¼ éç» StatementHandler å¯¹è±¡ï¼è¿å List æ¥è¯¢ç»æã\n\nprepareStatement() æ¹æ³çå®ç°ï¼\n\n  private Statement prepareStatement(StatementHandler handler, Log statementLog) throws SQLException {\n    Statement stmt;\n    Connection connection = getConnection(statementLog);\n    stmt = handler.prepare(connection, transaction.getTimeout());\n    //å¯¹åå»ºçStatementå¯¹è±¡è®¾ç½®åæ°ï¼å³è®¾ç½®SQL è¯­å¥ä¸­ ? è®¾ç½®ä¸ºæå®çåæ°\n    handler.parameterize(stmt);\n    return stmt;\n  }\n\n\nå¯¹äº JDBC ç PreparedStatement ç±»åçå¯¹è±¡ï¼åå»ºçè¿ç¨ä¸­ï¼æä»¬ä½¿ç¨çæ¯ SQL è¯­å¥å­ç¬¦ä¸²ä¼åå« è¥å¹²ä¸ª? å ä½ç¬¦ï¼æä»¬å¶ååå¯¹å ä½ç¬¦è¿è¡è®¾å¼ã\n\n\n# StatementHandler å·¥ä½æµç¨\n\nStatementHandler æä¸ä¸ªå­ç±» RoutingStatementHandlerï¼å®è´è´£ä»£çå¶ä» StatementHandler å­ç±»çå·¥ä½ã\n\nå®ä¼æ ¹æ®éç½®ç Statement ç±»åï¼éæ©å®ä¾åç¸åºç StatementHandlerï¼ç¶åç±å¶ä»£çå¯¹è±¡å®æå·¥ä½ã\n\nãæºç ãRoutingStatementHandler\n\npublic RoutingStatementHandler(Executor executor, MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) {\n\n  switch (ms.getStatementType()) {\n    case STATEMENT:\n      delegate = new SimpleStatementHandler(executor, ms, parameter, rowBounds, resultHandler, boundSql);\n      break;\n    case PREPARED:\n      delegate = new PreparedStatementHandler(executor, ms, parameter, rowBounds, resultHandler, boundSql);\n      break;\n    case CALLABLE:\n      delegate = new CallableStatementHandler(executor, ms, parameter, rowBounds, resultHandler, boundSql);\n      break;\n    default:\n      throw new ExecutorException("Unknown statement type: " + ms.getStatementType());\n  }\n\n}\n\n\nãæºç ãRoutingStatementHandler ç parameterize æ¹æ³æºç \n\nãæºç ãPreparedStatementHandler ç parameterize æ¹æ³æºç \n\nStatementHandler ä½¿ç¨ ParameterHandler å¯¹è±¡æ¥å®æå¯¹ Statement çèµå¼ã\n\n@Override\npublic void parameterize(Statement statement) throws SQLException {\n  // ä½¿ç¨ ParameterHandler å¯¹è±¡æ¥å®æå¯¹ Statement çè®¾å¼\n  parameterHandler.setParameters((PreparedStatement) statement);\n}\n\n\nãæºç ãStatementHandler ç query æ¹æ³æºç \n\nStatementHandler ä½¿ç¨ ResultSetHandler å¯¹è±¡æ¥å®æå¯¹ ResultSet çå¤çã\n\n@Override\npublic <E> List<E> query(Statement statement, ResultHandler resultHandler) throws SQLException {\n  PreparedStatement ps = (PreparedStatement) statement;\n  ps.execute();\n  // ä½¿ç¨ResultHandleræ¥å¤çResultSet\n  return resultSetHandler.handleResultSets(ps);\n}\n\n\n\n# ParameterHandler å·¥ä½æµç¨\n\nãæºç ãDefaultParameterHandler ç setParameters æ¹æ³\n\n  @Override\n  public void setParameters(PreparedStatement ps) {\n\t// parameterMappings æ¯å¯¹å ä½ç¬¦ #{} å¯¹åºåæ°çå°è£\n    List<ParameterMapping> parameterMappings = boundSql.getParameterMappings();\n    if (parameterMappings != null) {\n      for (int i = 0; i < parameterMappings.size(); i++) {\n        ParameterMapping parameterMapping = parameterMappings.get(i);\n        // ä¸å¤çå­å¨è¿ç¨ä¸­çåæ°\n        if (parameterMapping.getMode() != ParameterMode.OUT) {\n          Object value;\n          String propertyName = parameterMapping.getProperty();\n          if (boundSql.hasAdditionalParameter(propertyName)) { // issue #448 ask first for additional params\n            // è·åå¯¹åºçå®éæ°å¼\n            value = boundSql.getAdditionalParameter(propertyName);\n          } else if (parameterObject == null) {\n            value = null;\n          } else if (typeHandlerRegistry.hasTypeHandler(parameterObject.getClass())) {\n            value = parameterObject;\n          } else {\n            // è·åå¯¹è±¡ä¸­ç¸åºçå±æ§ææ¥æ¾ Map å¯¹è±¡ä¸­çå¼\n            MetaObject metaObject = configuration.newMetaObject(parameterObject);\n            value = metaObject.getValue(propertyName);\n          }\n\n          TypeHandler typeHandler = parameterMapping.getTypeHandler();\n          JdbcType jdbcType = parameterMapping.getJdbcType();\n          if (value == null && jdbcType == null) {\n            jdbcType = configuration.getJdbcTypeForNull();\n          }\n          try {\n            // éè¿ TypeHandler å° Java å¯¹è±¡åæ°è½¬ä¸º JDBC ç±»åçåæ°\n            // ç¶åï¼å°æ°å¼å¨æç»å®å° PreparedStaement ä¸­\n            typeHandler.setParameter(ps, i + 1, value, jdbcType);\n          } catch (TypeException | SQLException e) {\n            throw new TypeException("Could not set parameters for mapping: " + parameterMapping + ". Cause: " + e, e);\n          }\n        }\n      }\n    }\n  }\n\n\n\n# ResultSetHandler å·¥ä½æµç¨\n\nResultSetHandler çå®ç°å¯ä»¥æ¦æ¬ä¸ºï¼å° Statement æ§è¡åçç»æéï¼æç§ Mapper æä»¶ä¸­éç½®ç ResultType æ ResultMap æ¥è½¬æ¢æå¯¹åºç JavaBean å¯¹è±¡ï¼æåå°ç»æè¿åã\n\nãæºç ãDefaultResultSetHandler ç handleResultSets æ¹æ³\n\nhandleResultSets æ¹æ³æ¯ DefaultResultSetHandler çæå³é®æ¹æ³ãå¶å®ç°å¦ä¸ï¼\n\n@Override\npublic List<Object> handleResultSets(Statement stmt) throws SQLException {\n  ErrorContext.instance().activity("handling results").object(mappedStatement.getId());\n\n  final List<Object> multipleResults = new ArrayList<>();\n\n  int resultSetCount = 0;\n  // ç¬¬ä¸ä¸ªç»æé\n  ResultSetWrapper rsw = getFirstResultSet(stmt);\n  List<ResultMap> resultMaps = mappedStatement.getResultMaps();\n  // å¤æ­ç»æéçæ°é\n  int resultMapCount = resultMaps.size();\n  validateResultMapsCount(rsw, resultMapCount);\n  // éåå¤çç»æé\n  while (rsw != null && resultMapCount > resultSetCount) {\n    ResultMap resultMap = resultMaps.get(resultSetCount);\n    handleResultSet(rsw, resultMap, multipleResults, null);\n    rsw = getNextResultSet(stmt);\n    cleanUpAfterHandlingResultSet();\n    resultSetCount++;\n  }\n\n  String[] resultSets = mappedStatement.getResultSets();\n  if (resultSets != null) {\n    while (rsw != null && resultSetCount < resultSets.length) {\n      ResultMapping parentMapping = nextResultMaps.get(resultSets[resultSetCount]);\n      if (parentMapping != null) {\n        String nestedResultMapId = parentMapping.getNestedResultMapId();\n        ResultMap resultMap = configuration.getResultMap(nestedResultMapId);\n        handleResultSet(rsw, resultMap, null, parentMapping);\n      }\n      rsw = getNextResultSet(stmt);\n      cleanUpAfterHandlingResultSet();\n      resultSetCount++;\n    }\n  }\n\n  return collapseSingleResultList(multipleResults);\n}\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * Mybatis Github\n   * Mybatis å®ç½\n * æç« \n   * æ·±å¥çè§£ Mybatis åç\n   * Mybatis æºç ä¸­ææ³¨é\n   * Mybatis ä¸­å¼ºå¤§ç resultMap',normalizedContent:'# mybatis åç\n\n> mybatis çåèº«å°±æ¯ ibatis ï¼æ¯ä¸æ¬¾ä¼ç§çæä¹å±æ¡æ¶ï¼å®æ¯æèªå®ä¹ sqlãå­å¨è¿ç¨ä»¥åé«çº§æ å°ãæ¬æä»¥ä¸ä¸ª mybatis å®æ´ç¤ºä¾ä¸ºåå¥ç¹ï¼ç»å mybatis åºå±æºç åæï¼å¾æå¹¶èçè®²è§£ mybatis çæ ¸å¿å·¥ä½æºå¶ã\n\n\n# mybatis å®æ´ç¤ºä¾\n\n> è¿éï¼æå°ä»¥ä¸ä¸ªå¥é¨çº§çç¤ºä¾æ¥æ¼ç¤º mybatis æ¯å¦ä½å·¥ä½çã\n> \n> æ³¨ï¼æ¬æåé¢ç« èä¸­çåçãæºç é¨åä¹å°åºäºè¿ä¸ªç¤ºä¾æ¥è¿è¡è®²è§£ã\n> \n> å®æ´ç¤ºä¾æºç å°å\n\n\n# æ°æ®åºåå¤\n\nå¨æ¬ç¤ºä¾ä¸­ï¼éè¦éå¯¹ä¸å¼ ç¨æ·è¡¨è¿è¡ crud æä½ãå¶æ°æ®æ¨¡åå¦ä¸ï¼\n\ncreate table if not exists user (\n    id      bigint(10) unsigned not null auto_increment comment \'id\',\n    name    varchar(10)         not null default \'\' comment \'ç¨æ·å\',\n    age     int(3)              not null default 0 comment \'å¹´é¾\',\n    address varchar(32)         not null default \'\' comment \'å°å\',\n    email   varchar(32)         not null default \'\' comment \'é®ä»¶\',\n    primary key (id)\n) comment = \'ç¨æ·è¡¨\';\n\ninsert into user (name, age, address, email)\nvalues (\'å¼ ä¸\', 18, \'åäº¬\', \'xxx@163.com\');\ninsert into user (name, age, address, email)\nvalues (\'æå\', 19, \'ä¸æµ·\', \'xxx@163.com\');\n\n\n\n# æ·»å  mybatis\n\nå¦æä½¿ç¨ maven æ¥æå»ºé¡¹ç®ï¼åéå°ä¸é¢çä¾èµä»£ç ç½®äº pom.xml æä»¶ä¸­ï¼\n\n<dependency>\n  <groupid>org.mybatis</groupid>\n  <artifactid>mybatis</artifactid>\n  <version>x.x.x</version>\n</dependency>\n\n\n\n# mybatis éç½®\n\nxml éç½®æä»¶ä¸­åå«äºå¯¹ mybatis ç³»ç»çæ ¸å¿è®¾ç½®ï¼åæ¬è·åæ°æ®åºè¿æ¥å®ä¾çæ°æ®æºï¼datasourceï¼ä»¥åå³å®äºå¡ä½ç¨ååæ§å¶æ¹å¼çäºå¡ç®¡çå¨ï¼transactionmanagerï¼ã\n\næ¬ç¤ºä¾ä¸­åªæ¯ç»åºæç®åçéç½®ã\n\nãç¤ºä¾ãmybatis-config.xml æä»¶\n\n<?xml version="1.0" encoding="utf-8"?>\n<!doctype configuration public "-//mybatis.org//dtd config 3.0//en"\n  "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n  <environments default="development">\n    <environment id="development">\n      <transactionmanager type="jdbc" />\n      <datasource type="pooled">\n        <property name="driver" value="com.mysql.cj.jdbc.driver" />\n        <property name="url"\n                  value="jdbc:mysql://127.0.0.1:3306/spring_tutorial?servertimezone=utc" />\n        <property name="username" value="root" />\n        <property name="password" value="root" />\n      </datasource>\n    </environment>\n  </environments>\n  <mappers>\n    <mapper resource="mybatis/mapper/usermapper.xml" />\n  </mappers>\n</configuration>\n\n\n> è¯´æï¼ä¸é¢çéç½®æä»¶ä¸­ä»ä»æå®äºæ°æ®æºè¿æ¥æ¹å¼å user è¡¨çæ å°éç½®æä»¶ã\n\n\n# mapper\n\n# mapper.xml\n\nä¸ªäººçè§£ï¼mapper.xml æä»¶å¯ä»¥çåæ¯ mybatis ç jdbc sql æ¨¡æ¿ã\n\nãç¤ºä¾ãusermapper.xml æä»¶\n\nä¸é¢æ¯ä¸ä¸ªéè¿ mybatis generator èªå¨çæçå®æ´ç mapper æä»¶ã\n\n<?xml version="1.0" encoding="utf-8"?>\n<!doctype mapper public "-//mybatis.org//dtd mapper 3.0//en" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="io.github.dunwu.spring.orm.mapper.usermapper">\n  <resultmap id="baseresultmap" type="io.github.dunwu.spring.orm.entity.user">\n    <id column="id" jdbctype="bigint" property="id" />\n    <result column="name" jdbctype="varchar" property="name" />\n    <result column="age" jdbctype="integer" property="age" />\n    <result column="address" jdbctype="varchar" property="address" />\n    <result column="email" jdbctype="varchar" property="email" />\n  </resultmap>\n  <delete id="deletebyprimarykey" parametertype="java.lang.long">\n    delete from user\n    where id = #{id,jdbctype=bigint}\n  </delete>\n  <insert id="insert" parametertype="io.github.dunwu.spring.orm.entity.user">\n    insert into user (id, name, age,\n      address, email)\n    values (#{id,jdbctype=bigint}, #{name,jdbctype=varchar}, #{age,jdbctype=integer},\n      #{address,jdbctype=varchar}, #{email,jdbctype=varchar})\n  </insert>\n  <update id="updatebyprimarykey" parametertype="io.github.dunwu.spring.orm.entity.user">\n    update user\n    set name = #{name,jdbctype=varchar},\n      age = #{age,jdbctype=integer},\n      address = #{address,jdbctype=varchar},\n      email = #{email,jdbctype=varchar}\n    where id = #{id,jdbctype=bigint}\n  </update>\n  <select id="selectbyprimarykey" parametertype="java.lang.long" resultmap="baseresultmap">\n    select id, name, age, address, email\n    from user\n    where id = #{id,jdbctype=bigint}\n  </select>\n  <select id="selectall" resultmap="baseresultmap">\n    select id, name, age, address, email\n    from user\n  </select>\n</mapper>\n\n\n# mapper.java\n\nmapper.java æä»¶æ¯ mapper.xml å¯¹åºç java å¯¹è±¡ã\n\nãç¤ºä¾ãusermapper.java æä»¶\n\npublic interface usermapper {\n\n    int deletebyprimarykey(long id);\n\n    int insert(user record);\n\n    user selectbyprimarykey(long id);\n\n    list<user> selectall();\n\n    int updatebyprimarykey(user record);\n\n}\n\n\nå¯¹æ¯ usermapper.java å usermapper.xml æä»¶ï¼ä¸é¾åç°ï¼\n\nusermapper.java ä¸­çæ¹æ³å usermapper.xml ç crud è¯­å¥åç´ ï¼ <insert>ã<delete>ã<update>ã<select>ï¼å­å¨ä¸ä¸å¯¹åºå³ç³»ã\n\nå¨ mybatis ä¸­ï¼æ­£æ¯éè¿æ¹æ³çå¨éå®åï¼å°äºèç»å®å¨ä¸èµ·ã\n\n# æ°æ®å®ä½.java\n\nãç¤ºä¾ãuser.java æä»¶\n\npublic class user {\n    private long id;\n\n    private string name;\n\n    private integer age;\n\n    private string address;\n\n    private string email;\n\n}\n\n\n<insert>ã<delete>ã<update>ã<select> ç parametertype å±æ§ä»¥å <resultmap> ç type å±æ§é½å¯è½ä¼ç»å®å°æ°æ®å®ä½ãè¿æ ·å°±å¯ä»¥æ jdbc æä½çè¾å¥è¾åºå javabean ç»åèµ·æ¥ï¼æ´å æ¹ä¾¿ãæäºçè§£ã\n\n\n# æµè¯ç¨åº\n\nãç¤ºä¾ãmybatisdemo.java æä»¶\n\npublic class mybatisdemo {\n\n    public static void main(string[] args) throws exception {\n        // 1. å è½½ mybatis éç½®æä»¶ï¼åå»º sqlsessionfactory\n        // æ³¨ï¼å¨å®éçåºç¨ä¸­ï¼sqlsessionfactory åºè¯¥æ¯åä¾\n        inputstream inputstream = resources.getresourceasstream("mybatis/mybatis-config.xml");\n        sqlsessionfactorybuilder builder = new sqlsessionfactorybuilder();\n        sqlsessionfactory factory = builder.build(inputstream);\n\n        // 2. åå»ºä¸ä¸ª sqlsession å®ä¾ï¼è¿è¡æ°æ®åºæä½\n        sqlsession sqlsession = factory.opensession();\n\n        // 3. mapper æ å°å¹¶æ§è¡\n        long params = 1l;\n        list<user> list = sqlsession.selectlist("io.github.dunwu.spring.orm.mapper.usermapper.selectbyprimarykey", params);\n        for (user user : list) {\n            system.out.println("user name: " + user.getname());\n        }\n        // è¾åºï¼user name: å¼ ä¸\n    }\n\n}\n\n\n> è¯´æï¼\n> \n> sqlsession æ¥å£æ¯ mybatis api æ ¸å¿ä¸­çæ ¸å¿ï¼å®ä»£è¡¨äº mybatis åæ°æ®åºçä¸æ¬¡å®æ´ä¼è¯ã\n> \n>  * mybatis ä¼è§£æéç½®ï¼å¹¶æ ¹æ®éç½®åå»º sqlsession ã\n>  * ç¶åï¼mybatis å° mapper æ å°ä¸º sqlsessionï¼ç¶åä¼ éåæ°ï¼æ§è¡ sql è¯­å¥å¹¶è·åç»æã\n\n\n# mybatis çå½å¨æ\n\n\n\n\n# sqlsessionfactorybuilder\n\n# sqlsessionfactorybuilder çèè´£\n\nsqlsessionfactorybuilder è´è´£åå»º sqlsessionfactory å®ä¾ãsqlsessionfactorybuilder å¯ä»¥ä» xml éç½®æä»¶æä¸ä¸ªé¢åå®å¶ç configuration çå®ä¾æå»ºåº sqlsessionfactory çå®ä¾ã\n\nconfiguration ç±»åå«äºå¯¹ä¸ä¸ª sqlsessionfactory å®ä¾ä½ å¯è½å³å¿çææåå®¹ã\n\n\n\nsqlsessionfactorybuilder åºç¨äºå»ºé èè®¾è®¡æ¨¡å¼ï¼å®æäºä¸ª build æ¹æ³ï¼åè®¸ä½ éè¿ä¸åçèµæºåå»º sqlsessionfactory å®ä¾ã\n\nsqlsessionfactory build(inputstream inputstream)\nsqlsessionfactory build(inputstream inputstream, string environment)\nsqlsessionfactory build(inputstream inputstream, properties properties)\nsqlsessionfactory build(inputstream inputstream, string env, properties props)\nsqlsessionfactory build(configuration config)\n\n\n# sqlsessionfactorybuilder ççå½å¨æ\n\nsqlsessionfactorybuilder å¯ä»¥è¢«å®ä¾åãä½¿ç¨åä¸¢å¼ï¼ä¸æ¦åå»ºäº sqlsessionfactoryï¼å°±ä¸åéè¦å®äºã å æ­¤ sqlsessionfactorybuilder å®ä¾çæä½³ä½ç¨åæ¯æ¹æ³ä½ç¨åï¼ä¹å°±æ¯å±é¨æ¹æ³åéï¼ãä½ å¯ä»¥éç¨ sqlsessionfactorybuilder æ¥åå»ºå¤ä¸ª sqlsessionfactory å®ä¾ï¼ä½æå¥½è¿æ¯ä¸è¦ä¸ç´ä¿ççå®ï¼ä»¥ä¿è¯ææç xml è§£æèµæºå¯ä»¥è¢«éæ¾ç»æ´éè¦çäºæã\n\n\n# sqlsessionfactory\n\n# sqlsessionfactory èè´£\n\nsqlsessionfactory è´è´£åå»º sqlsession å®ä¾ã\n\n\n\nsqlsessionfactory åºç¨äºå·¥åè®¾è®¡æ¨¡å¼ï¼å®æä¾äºä¸ç»æ¹æ³ï¼ç¨äºåå»º sqlsession å®ä¾ã\n\nsqlsession opensession()\nsqlsession opensession(boolean autocommit)\nsqlsession opensession(connection connection)\nsqlsession opensession(transactionisolationlevel level)\nsqlsession opensession(executortype exectype, transactionisolationlevel level)\nsqlsession opensession(executortype exectype)\nsqlsession opensession(executortype exectype, boolean autocommit)\nsqlsession opensession(executortype exectype, connection connection)\nconfiguration getconfiguration();\n\n\næ¹æ³è¯´æï¼\n\n * é»è®¤ç opensession() æ¹æ³æ²¡æåæ°ï¼å®ä¼åå»ºå·å¤å¦ä¸ç¹æ§ç sqlsessionï¼\n   * äºå¡ä½ç¨åå°ä¼å¼å¯ï¼ä¹å°±æ¯ä¸èªå¨æäº¤ï¼ã\n   * å°ç±å½åç¯å¢éç½®ç datasource å®ä¾ä¸­è·å connection å¯¹è±¡ã\n   * äºå¡éç¦»çº§å«å°ä¼ä½¿ç¨é©±å¨ææ°æ®æºçé»è®¤è®¾ç½®ã\n   * é¢å¤çè¯­å¥ä¸ä¼è¢«å¤ç¨ï¼ä¹ä¸ä¼æ¹éå¤çæ´æ°ã\n * transactionisolationlevel è¡¨ç¤ºäºå¡éç¦»çº§å«ï¼å®å¯¹åºç jdbc çäºä¸ªäºå¡éç¦»çº§å«ã\n * executortype æä¸¾ç±»åå®ä¹äºä¸ä¸ªå¼:\n   * executortype.simpleï¼è¯¥ç±»åçæ§è¡å¨æ²¡æç¹å«çè¡ä¸ºãå®ä¸ºæ¯ä¸ªè¯­å¥çæ§è¡åå»ºä¸ä¸ªæ°çé¢å¤çè¯­å¥ã\n   * executortype.reuseï¼è¯¥ç±»åçæ§è¡å¨ä¼å¤ç¨é¢å¤çè¯­å¥ã\n   * executortype.batchï¼è¯¥ç±»åçæ§è¡å¨ä¼æ¹éæ§è¡æææ´æ°è¯­å¥ï¼å¦æ select å¨å¤ä¸ªæ´æ°ä¸­é´æ§è¡ï¼å°å¨å¿è¦æ¶å°å¤æ¡æ´æ°è¯­å¥åéå¼æ¥ï¼ä»¥æ¹ä¾¿çè§£ã\n\n# sqlsessionfactory çå½å¨æ\n\nsqlsessionfactory åºè¯¥ä»¥åä¾å½¢å¼å¨åºç¨çè¿è¡æé´ä¸ç´å­å¨ã\n\n\n# sqlsession\n\n# sqlsession èè´£\n\nmybatis çä¸»è¦ java æ¥å£å°±æ¯ sqlsessionãå®åå«äºæææ§è¡è¯­å¥ï¼è·åæ å°å¨åç®¡çäºå¡ç­æ¹æ³ã\n\n> è¯¦ç»åå®¹å¯ä»¥åèï¼ã mybatis å®æ¹ææ¡£ä¹ sqlsessions ã ã\n\nsqlsession ç±»çæ¹æ³å¯ä»¥æç§ä¸å¾è¿è¡å¤§è´åç±»ï¼\n\n\n\n# sqlsession çå½å¨æ\n\nsqlsessions æ¯ç± sqlsessionfactory å®ä¾åå»ºçï¼è sqlsessionfactory æ¯ç± sqlsessionfactorybuilder åå»ºçã\n\n> ð æ³¨æï¼å½ mybatis ä¸ä¸äºä¾èµæ³¨å¥æ¡æ¶ï¼å¦ spring æè guiceï¼åæ¶ä½¿ç¨æ¶ï¼sqlsessions å°è¢«ä¾èµæ³¨å¥æ¡æ¶æåå»ºï¼æä»¥ä½ ä¸éè¦ä½¿ç¨ sqlsessionfactorybuilder æè sqlsessionfactoryã\n\næ¯ä¸ªçº¿ç¨é½åºè¯¥æå®èªå·±ç sqlsession å®ä¾ã\n\nsqlsession çå®ä¾ä¸æ¯çº¿ç¨å®å¨çï¼å æ­¤æ¯ä¸è½è¢«å±äº«çï¼æä»¥å®çæä½³çä½ç¨åæ¯è¯·æ±ææ¹æ³ä½ç¨åã ç»å¯¹ä¸è½å° sqlsession å®ä¾çå¼ç¨æ¾å¨ä¸ä¸ªç±»çéæåï¼çè³ä¸ä¸ªç±»çå®ä¾åéä¹ä¸è¡ã ä¹ç»ä¸è½å° sqlsession å®ä¾çå¼ç¨æ¾å¨ä»»ä½ç±»åçæç®¡ä½ç¨åä¸­ï¼æ¯å¦ servlet æ¡æ¶ä¸­ç httpsessionã æ­£ç¡®å¨ web ä¸­ä½¿ç¨ sqlsession çåºæ¯æ¯ï¼æ¯æ¬¡æ¶å°ç http è¯·æ±ï¼å°±å¯ä»¥æå¼ä¸ä¸ª sqlsessionï¼è¿åä¸ä¸ªååºï¼å°±å³é­å®ã\n\nç¼ç¨æ¨¡å¼ï¼\n\ntry (sqlsession session = sqlsessionfactory.opensession()) {\n  // ä½ çåºç¨é»è¾ä»£ç \n}\n\n\n\n# æ å°å¨\n\n# æ å°å¨èè´£\n\næ å°å¨æ¯ä¸äºç±ç¨æ·åå»ºçãç»å® sql è¯­å¥çæ¥å£ã\n\nsqlsession ä¸­ç insertãupdateãdelete å select æ¹æ³é½å¾å¼ºå¤§ï¼ä½ä¹æäºç¹çãæ´éç¨çæ¹å¼æ¯ä½¿ç¨æ å°å¨ç±»æ¥æ§è¡æ å°è¯­å¥ãä¸ä¸ªæ å°å¨ç±»å°±æ¯ä¸ä¸ªä»éå£°æä¸ sqlsession æ¹æ³ç¸å¹éçæ¹æ³çæ¥å£ç±»ã\n\nmybatis å°éç½®æä»¶ä¸­çæ¯ä¸ä¸ª <mapper> èç¹æ½è±¡ä¸ºä¸ä¸ª mapper æ¥å£ï¼èè¿ä¸ªæ¥å£ä¸­å£°æçæ¹æ³åè· <mapper> èç¹ä¸­ç <select|update|delete|insert> èç¹ç¸å¯¹åºï¼å³ <select|update|delete|insert> èç¹ç id å¼ä¸º mapper æ¥å£ä¸­çæ¹æ³åç§°ï¼parametertype å¼è¡¨ç¤º mapper å¯¹åºæ¹æ³çå¥åç±»åï¼è resultmap å¼åå¯¹åºäº mapper æ¥å£è¡¨ç¤ºçè¿åå¼ç±»åæèè¿åç»æéçåç´ ç±»åã\n\nmybatis ä¼æ ¹æ®ç¸åºçæ¥å£å£°æçæ¹æ³ä¿¡æ¯ï¼éè¿å¨æä»£çæºå¶çæä¸ä¸ª mapper å®ä¾ï¼mybatis ä¼æ ¹æ®è¿ä¸ªæ¹æ³çæ¹æ³åååæ°ç±»åï¼ç¡®å® statement idï¼ç¶åå sqlsession è¿è¡æ å°ï¼åºå±è¿æ¯éè¿ sqlsession å®æåæ°æ®åºçäº¤äºã\n\nä¸é¢çç¤ºä¾å±ç¤ºäºä¸äºæ¹æ³ç­¾åä»¥åå®ä»¬æ¯å¦ä½æ å°å° sqlsession ä¸çã\n\n\n\n> æ³¨æ\n> \n>  * æ å°å¨æ¥å£ä¸éè¦å»å®ç°ä»»ä½æ¥å£æç»§æ¿èªä»»ä½ç±»ãåªè¦æ¹æ³å¯ä»¥è¢«å¯ä¸æ è¯å¯¹åºçæ å°è¯­å¥å°±å¯ä»¥äºã\n>  * æ å°å¨æ¥å£å¯ä»¥ç»§æ¿èªå¶ä»æ¥å£ãå½ä½¿ç¨ xml æ¥æå»ºæ å°å¨æ¥å£æ¶è¦ä¿è¯è¯­å¥è¢«åå«å¨åéçå½åç©ºé´ä¸­ãèä¸ï¼å¯ä¸çéå¶å°±æ¯ä½ ä¸è½å¨ä¸¤ä¸ªç»§æ¿å³ç³»çæ¥å£ä¸­æ¥æç¸åçæ¹æ³ç­¾åï¼æ½å¨çå±é©åæ³ä¸å¯åï¼ã\n\n# æ å°å¨çå½å¨æ\n\næ å°å¨æ¥å£çå®ä¾æ¯ä» sqlsession ä¸­è·å¾çãå æ­¤ä»ææ¯å±é¢è®²ï¼ä»»ä½æ å°å¨å®ä¾çæå¤§ä½ç¨åæ¯åè¯·æ±å®ä»¬ç sqlsession ç¸åçãå°½ç®¡å¦æ­¤ï¼æ å°å¨å®ä¾çæä½³ä½ç¨åæ¯æ¹æ³ä½ç¨åã ä¹å°±æ¯è¯´ï¼æ å°å¨å®ä¾åºè¯¥å¨è°ç¨å®ä»¬çæ¹æ³ä¸­è¢«è¯·æ±ï¼ç¨è¿ä¹åå³å¯ä¸¢å¼ã\n\nç¼ç¨æ¨¡å¼ï¼\n\ntry (sqlsession session = sqlsessionfactory.opensession()) {\n  blogmapper mapper = session.getmapper(blogmapper.class);\n  // ä½ çåºç¨é»è¾ä»£ç \n}\n\n\n * æ å°å¨æ³¨è§£\n\nmybatis æ¯ä¸ä¸ª xml é©±å¨çæ¡æ¶ãéç½®ä¿¡æ¯æ¯åºäº xml çï¼èä¸æ å°è¯­å¥ä¹æ¯å®ä¹å¨ xml ä¸­çãmybatis 3 ä»¥åï¼æ¯ææ³¨è§£éç½®ãæ³¨è§£éç½®åºäºéç½® apiï¼èéç½® api åºäº xml éç½®ã\n\nmybatis æ¯æè¯¸å¦ @insertã@updateã@deleteã@selectã@result ç­æ³¨è§£ã\n\n> è¯¦ç»åå®¹è¯·åèï¼mybatis å®æ¹ææ¡£ä¹ sqlsessionsï¼å¶ä¸­åä¸¾äº mybatis æ¯æçæ³¨è§£æ¸åï¼ä»¥ååºæ¬ç¨æ³ã\n\n\n# mybatis çæ¶æ\n\nä» mybatis ä»£ç å®ç°çè§åº¦æ¥çï¼mybatis çä¸»è¦ç»ä»¶æä»¥ä¸å ä¸ªï¼\n\n * sqlsession - ä½ä¸º mybatis å·¥ä½çä¸»è¦é¡¶å± apiï¼è¡¨ç¤ºåæ°æ®åºäº¤äºçä¼è¯ï¼å®æå¿è¦æ°æ®åºå¢å æ¹æ¥åè½ã\n * executor - mybatis æ§è¡å¨ï¼æ¯ mybatis è°åº¦çæ ¸å¿ï¼è´è´£ sql è¯­å¥ççæåæ¥è¯¢ç¼å­çç»´æ¤ã\n * statementhandler - å°è£äº jdbc statement æä½ï¼è´è´£å¯¹ jdbc statement çæä½ï¼å¦è®¾ç½®åæ°ãå° statement ç»æéè½¬æ¢æ list éåã\n * parameterhandler - è´è´£å¯¹ç¨æ·ä¼ éçåæ°è½¬æ¢æ jdbc statement æéè¦çåæ°ã\n * resultsethandler - è´è´£å° jdbc è¿åç resultset ç»æéå¯¹è±¡è½¬æ¢æ list ç±»åçéåã\n * typehandler - è´è´£ java æ°æ®ç±»åå jdbc æ°æ®ç±»åä¹é´çæ å°åè½¬æ¢ã\n * mappedstatement - mappedstatement ç»´æ¤äºä¸æ¡ <select|update|delete|insert> èç¹çå°è£ã\n * sqlsource - è´è´£æ ¹æ®ç¨æ·ä¼ éç parameterobjectï¼å¨æå°çæ sql è¯­å¥ï¼å°ä¿¡æ¯å°è£å° boundsql å¯¹è±¡ä¸­ï¼å¹¶è¿åã\n * boundsql - è¡¨ç¤ºå¨æçæç sql è¯­å¥ä»¥åç¸åºçåæ°ä¿¡æ¯ã\n * configuration - mybatis ææçéç½®ä¿¡æ¯é½ç»´æå¨ configuration å¯¹è±¡ä¹ä¸­ã\n\nè¿äºç»ä»¶çæ¶æå±æ¬¡å¦ä¸ï¼\n\n\n\n\n# éç½®å±\n\néç½®å±å³å®äº mybatis çå·¥ä½æ¹å¼ã\n\nmybatis æä¾äºä¸¤ç§éç½®æ¹å¼ï¼\n\n * åºäº xml éç½®æä»¶çæ¹å¼\n * åºäº java api çæ¹å¼\n\nsqlsessionfactorybuilder ä¼æ ¹æ®éç½®åå»º sqlsessionfactory ï¼\n\nsqlsessionfactory è´è´£åå»º sqlsessions ã\n\n\n# æ¥å£å±\n\næ¥å£å±è´è´£åæ°æ®åºäº¤äºçæ¹å¼ã\n\nmybatis åæ°æ®åºçäº¤äºæä¸¤ç§æ¹å¼ï¼\n\n * ä½¿ç¨ sqlsessionï¼sqlsession å°è£äºæææ§è¡è¯­å¥ï¼è·åæ å°å¨åç®¡çäºå¡çæ¹æ³ã\n   * ç¨æ·åªéè¦ä¼ å¥ statement id åæ¥è¯¢åæ°ç» sqlsession å¯¹è±¡ï¼å°±å¯ä»¥å¾æ¹ä¾¿çåæ°æ®åºè¿è¡äº¤äºã\n   * è¿ç§æ¹å¼çç¼ºç¹æ¯ä¸ç¬¦åé¢åå¯¹è±¡ç¼ç¨çèå¼ã\n * ä½¿ç¨ mapper æ¥å£ï¼mybatis ä¼æ ¹æ®ç¸åºçæ¥å£å£°æçæ¹æ³ä¿¡æ¯ï¼éè¿å¨æä»£çæºå¶çæä¸ä¸ª mapper å®ä¾ï¼mybatis ä¼æ ¹æ®è¿ä¸ªæ¹æ³çæ¹æ³åååæ°ç±»åï¼ç¡®å® statement idï¼ç¶åå sqlsession è¿è¡æ å°ï¼åºå±è¿æ¯éè¿ sqlsession å®æåæ°æ®åºçäº¤äºã\n\n\n# æ°æ®å¤çå±\n\næ°æ®å¤çå±å¯ä»¥è¯´æ¯ mybatis çæ ¸å¿ï¼ä»å¤§çæ¹é¢ä¸è®²ï¼å®è¦å®æä¸¤ä¸ªåè½ï¼\n\n * æ ¹æ®ä¼ å statement ååæ°æå»ºå¨æ sql è¯­å¥\n   * å¨æè¯­å¥çæå¯ä»¥è¯´æ¯ mybatis æ¡æ¶éå¸¸ä¼éçä¸ä¸ªè®¾è®¡ï¼mybatis éè¿ä¼ å¥çåæ°å¼ï¼ä½¿ç¨ ognl æ¥å¨æå°æé  sql è¯­å¥ï¼ä½¿å¾ mybatis æå¾å¼ºççµæ´»æ§åæ©å±æ§ã\n   * åæ°æ å°æçæ¯å¯¹äº java æ°æ®ç±»åå jdbc æ°æ®ç±»åä¹é´çè½¬æ¢ï¼è¿éæåæ¬ä¸¤ä¸ªè¿ç¨ï¼æ¥è¯¢é¶æ®µï¼æä»¬è¦å° java ç±»åçæ°æ®ï¼è½¬æ¢æ jdbc ç±»åçæ°æ®ï¼éè¿ preparedstatement.setxxx() æ¥è®¾å¼ï¼å¦ä¸ä¸ªå°±æ¯å¯¹ resultset æ¥è¯¢ç»æéç jdbctype æ°æ®è½¬æ¢æ java æ°æ®ç±»åã\n * æ§è¡ sql è¯­å¥ä»¥åå¤çååºç»æé resultset\n   * å¨æ sql è¯­å¥çæä¹åï¼mybatis å°æ§è¡ sql è¯­å¥ï¼å¹¶å°å¯è½è¿åçç»æéè½¬æ¢æ list<e> åè¡¨ã\n   * mybatis å¨å¯¹ç»æéçå¤çä¸­ï¼æ¯æç»æéå³ç³»ä¸å¯¹å¤åå¤å¯¹ä¸çè½¬æ¢ï¼å¹¶ä¸æä¸¤ç§æ¯ææ¹å¼ï¼ä¸ç§ä¸ºåµå¥æ¥è¯¢è¯­å¥çæ¥è¯¢ï¼è¿æä¸ç§æ¯åµå¥ç»æéçæ¥è¯¢ã\n\n\n# æ¡æ¶æ¯æå±\n\n * äºå¡ç®¡çæºå¶ - mybatis å°äºå¡æ½è±¡æäº transaction æ¥å£ãmybatis çäºå¡ç®¡çåä¸ºä¸¤ç§å½¢å¼ï¼\n   \n   * ä½¿ç¨ jdbc çäºå¡ç®¡çæºå¶ï¼å³å©ç¨ java.sql.connection å¯¹è±¡å®æå¯¹äºå¡çæäº¤ï¼commitï¼ãåæ»ï¼rollbackï¼ãå³é­ï¼closeï¼ç­ã\n   * ä½¿ç¨ managed çäºå¡ç®¡çæºå¶ï¼mybatis èªèº«ä¸ä¼å»å®ç°äºå¡ç®¡çï¼èæ¯è®©ç¨åºçå®¹å¨å¦ï¼jbossï¼weblogicï¼æ¥å®ç°å¯¹äºå¡çç®¡çã\n\n * è¿æ¥æ± ç®¡ç\n\n * sql è¯­å¥çéç½® - æ¯æä¸¤ç§æ¹å¼ï¼\n   \n   * xml éç½®\n   * æ³¨è§£éç½®\n\n * ç¼å­æºå¶ - mybatis éç¨ä¸¤çº§ç¼å­ç»æ\n   \n   * ä¸çº§ç¼å­æ¯ session ä¼è¯çº§å«çç¼å­ - ä¸çº§ç¼å­åè¢«ç§°ä¹ä¸ºæ¬å°ç¼å­ãä¸è¬èè¨ï¼ä¸ä¸ª sqlsession å¯¹è±¡ä¼ä½¿ç¨ä¸ä¸ª executor å¯¹è±¡æ¥å®æä¼è¯æä½ï¼executor å¯¹è±¡ä¼ç»´æ¤ä¸ä¸ª cache ç¼å­ï¼ä»¥æé«æ¥è¯¢æ§è½ã\n     * ä¸çº§ç¼å­ççå½å¨ææ¯ session ä¼è¯çº§å«çã\n   * äºçº§ç¼å­æ¯ application åºç¨çº§å«çç¼å­ - ç¨æ·éç½®äº "cacheenabled=true"ï¼æä¼å¼å¯äºçº§ç¼å­ã\n     * å¦æå¼å¯äºäºçº§ç¼å­ï¼sqlsession ä¼åä½¿ç¨ cachingexecutor å¯¹è±¡æ¥å¤çæ¥è¯¢è¯·æ±ãcachingexecutor ä¼å¨äºçº§ç¼å­ä¸­æ¥çæ¯å¦æå¹éçæ°æ®ï¼å¦æå¹éï¼åç´æ¥è¿åç¼å­ç»æï¼å¦æç¼å­ä¸­æ²¡æï¼åäº¤ç»çæ­£ç executor å¯¹è±¡æ¥å®ææ¥è¯¢ï¼ä¹å cachingexecutor ä¼å°çæ­£ executor è¿åçæ¥è¯¢ç»ææ¾ç½®å°ç¼å­ä¸­ï¼ç¶åå¨è¿åç»ç¨æ·ã\n     * äºçº§ç¼å­ççå½å¨ææ¯åºç¨çº§å«çã\n\n\n\n\n# sqlsession åé¨å·¥ä½æºå¶\n\nä»åæï¼æä»¬å·²ç»äºè§£äºï¼mybatis å°è£äºå¯¹æ°æ®åºçè®¿é®ï¼æå¯¹æ°æ®åºçä¼è¯åäºå¡æ§å¶æ¾å°äº sqlsession å¯¹è±¡ä¸­ãé£ä¹å·ä½æ¯å¦ä½å·¥ä½çå¢ï¼æ¥ä¸æ¥ï¼æä»¬éè¿æºç è§£è¯»æ¥è¿è¡åæã\n\n\n\nsqlsession å¯¹äº insertãupdateãdeleteãselect çåé¨å¤çæºå¶åºæ¬ä¸å¤§åå°å¼ãæä»¥ï¼æ¥ä¸æ¥ï¼æä¼ä»¥ä¸æ¬¡å®æ´ç select æ¥è¯¢æµç¨ä¸ºä¾è®²è§£ sqlsession åé¨çå·¥ä½æºå¶ãç¸ä¿¡è¯»èå¦æçè§£äº select çå¤çæµç¨ï¼å¯¹äºå¶ä» crud æä½ä¹è½åå°ä¸éç¾éã\n\n\n# sqlsession å­ç»ä»¶\n\nåé¢çåå®¹å·²ç»ä»ç»äºï¼sqlsession æ¯ mybatis çé¡¶å±æ¥å£ï¼å®æä¾äºæææ§è¡è¯­å¥ï¼è·åæ å°å¨åç®¡çäºå¡ç­æ¹æ³ã\n\nå®éä¸ï¼sqlsession æ¯éè¿èåå¤ä¸ªå­ç»ä»¶ï¼è®©æ¯ä¸ªå­ç»ä»¶è´è´£åèªåè½çæ¹å¼ï¼å®ç°äºä»»å¡çä¸åã\n\nå¨äºè§£åä¸ªå­ç»ä»¶å·¥ä½æºå¶åï¼åè®©æä»¬ç®åè®¤è¯ä¸ä¸ sqlsession çæ ¸å¿å­ç»ä»¶ã\n\n# executor\n\nexecutor å³æ§è¡å¨ï¼å®è´è´£çæå¨æ sql ä»¥åç®¡çç¼å­ã\n\n\n\n * executor å³æ§è¡å¨æ¥å£ã\n * baseexecutor æ¯ executor çæ½è±¡ç±»ï¼å®éç¨äºæ¨¡æ¿æ¹æ³è®¾è®¡æ¨¡å¼ï¼åç½®äºä¸äºå±æ§æ¹æ³ï¼èå°å®å¶åæ¹æ³çç»å­ç±»å»å®ç°ã\n * simpleexecutor æ¯æç®åçæ§è¡å¨ãå®åªä¼ç´æ¥æ§è¡ sqlï¼ä¸ä¼åé¢å¤çäºã\n * batchexecutor æ¯æ¹å¤çæ§è¡å¨ãå®çä½ç¨æ¯éè¿æ¹å¤çæ¥ä¼åæ§è½ãå¼å¾æ³¨æçæ¯ï¼æ¹éæ´æ°æä½ï¼ç±äºåé¨æç¼å­æºå¶ï¼ä½¿ç¨å®åéè¦è°ç¨ flushstatements æ¥æ¸é¤ç¼å­ã\n * reuseexecutor æ¯å¯éç¨çæ§è¡å¨ãéç¨çå¯¹è±¡æ¯ statementï¼ä¹å°±æ¯è¯´ï¼è¯¥æ§è¡å¨ä¼ç¼å­åä¸ä¸ª sql ç statementï¼é¿åéå¤åå»º statementãå¶åé¨çå®ç°æ¯éè¿ä¸ä¸ª hashmap æ¥ç»´æ¤ statement å¯¹è±¡çãç±äºå½å map åªå¨è¯¥ session ä¸­ææï¼æä»¥ä½¿ç¨å®åéè¦è°ç¨ flushstatements æ¥æ¸é¤ mapã\n * cachingexecutor æ¯ç¼å­æ§è¡å¨ãå®åªå¨å¯ç¨äºçº§ç¼å­æ¶æä¼ç¨å°ã\n\n# statementhandler\n\nstatementhandler å¯¹è±¡è´è´£è®¾ç½® statement å¯¹è±¡ä¸­çæ¥è¯¢åæ°ãå¤ç jdbc è¿åç resultsetï¼å° resultset å å·¥ä¸º list éåè¿åã\n\nstatementhandler çå®¶ææåï¼\n\n\n\n * statementhandler æ¯æ¥å£ï¼\n * basestatementhandler æ¯å®ç° statementhandler çæ½è±¡ç±»ï¼åç½®ä¸äºå±æ§æ¹æ³ï¼\n * simplestatementhandler è´è´£å¤ç statementï¼\n * preparedstatementhandler è´è´£å¤ç preparedstatementï¼\n * callablestatementhandler è´è´£å¤ç callablestatementã\n * routingstatementhandler è´è´£ä»£ç statementhandler å·ä½å­ç±»ï¼æ ¹æ® statement ç±»åï¼éæ©å®ä¾å simplestatementhandlerãpreparedstatementhandlerãcallablestatementhandlerã\n\n# parameterhandler\n\nparameterhandler è´è´£å°ä¼ å¥ç java å¯¹è±¡è½¬æ¢ jdbc ç±»åå¯¹è±¡ï¼å¹¶ä¸º preparedstatement çå¨æ sql å¡«åæ°å¼ã\n\nparameterhandler åªæä¸ä¸ªå·ä½å®ç°ç±»ï¼å³ defaultparameterhandlerã\n\n# resultsethandler\n\nresultsethandler è´è´£ä¸¤ä»¶äºï¼\n\n * å¤ç statement æ§è¡åäº§ççç»æéï¼çæç»æåè¡¨\n * å¤çå­å¨è¿ç¨æ§è¡åçè¾åºåæ°\n\nresultsethandler åªæä¸ä¸ªå·ä½å®ç°ç±»ï¼å³ defaultresultsethandlerã\n\n# typehandler\n\ntypehandler è´è´£å° java å¯¹è±¡ç±»åå jdbc ç±»åè¿è¡ç¸äºè½¬æ¢ã\n\n\n# sqlsession å mapper\n\nåæ¥åå¿ä¸ä¸ mybatis å®æ´ç¤ºä¾ç« èç æµè¯ç¨åºé¨åçä»£ç ã\n\nmybatisdemo.java æä»¶ä¸­çä»£ç çæ®µï¼\n\n// 2. åå»ºä¸ä¸ª sqlsession å®ä¾ï¼è¿è¡æ°æ®åºæä½\nsqlsession sqlsession = factory.opensession();\n\n// 3. mapper æ å°å¹¶æ§è¡\nlong params = 1l;\nlist<user> list = sqlsession.selectlist("io.github.dunwu.spring.orm.mapper.usermapper.selectbyprimarykey", params);\nfor (user user : list) {\n    system.out.println("user name: " + user.getname());\n}\n\n\nç¤ºä¾ä»£ç ä¸­ï¼ç» sqlsession å¯¹è±¡çä¼ éä¸ä¸ªéç½®ç sql è¯­å¥ç statement id ååæ°ï¼ç¶åè¿åç»æ\n\nio.github.dunwu.spring.orm.mapper.usermapper.selectbyprimarykey æ¯éç½®å¨ usermapper.xml ç statement idï¼params æ¯ sql åæ°ã\n\nusermapper.xml æä»¶ä¸­çä»£ç çæ®µï¼\n\n  <select id="selectbyprimarykey" parametertype="java.lang.long" resultmap="baseresultmap">\n    select id, name, age, address, email\n    from user\n    where id = #{id,jdbctype=bigint}\n  </select>\n\n\nmybatis éè¿æ¹æ³çå¨éå®åï¼å° sqlsession å mapper ç¸äºæ å°èµ·æ¥ã\n\n\n# sqlsession å executor\n\norg.apache.ibatis.session.defaults.defaultsqlsession ä¸­ selectlist æ¹æ³çæºç ï¼\n\n@override\npublic <e> list<e> selectlist(string statement) {\n  return this.selectlist(statement, null);\n}\n\n@override\npublic <e> list<e> selectlist(string statement, object parameter) {\n  return this.selectlist(statement, parameter, rowbounds.default);\n}\n\n@override\npublic <e> list<e> selectlist(string statement, object parameter, rowbounds rowbounds) {\n  try {\n    // 1. æ ¹æ® statement idï¼å¨éç½®å¯¹è±¡ configuration ä¸­æ¥æ¾åéç½®æä»¶ç¸å¯¹åºç mappedstatement\n    mappedstatement ms = configuration.getmappedstatement(statement);\n    // 2. å° sql è¯­å¥äº¤ç±æ§è¡å¨ executor å¤ç\n    return executor.query(ms, wrapcollection(parameter), rowbounds, executor.no_result_handler);\n  } catch (exception e) {\n    throw exceptionfactory.wrapexception("error querying database.  cause: " + e, e);\n  } finally {\n    errorcontext.instance().reset();\n  }\n}\n\n\nè¯´æï¼\n\nmybatis ææçéç½®ä¿¡æ¯é½ç»´æå¨ configuration å¯¹è±¡ä¹ä¸­ãä¸­ç»´æ¤äºä¸ä¸ª map<string, mappedstatement> å¯¹è±¡ãå¶ä¸­ï¼key ä¸º mapper æ¹æ³çå¨éå®åï¼å¯¹äºæ¬ä¾èè¨ï¼key å°±æ¯ io.github.dunwu.spring.orm.mapper.usermapper.selectbyprimarykey ï¼ï¼value ä¸º mappedstatement å¯¹è±¡ãæä»¥ï¼ä¼ å¥ statement id å°±å¯ä»¥ä» map ä¸­æ¾å°å¯¹åºç mappedstatementã\n\nmappedstatement ç»´æ¤äºä¸ä¸ª mapper æ¹æ³çåæ°æ®ä¿¡æ¯ï¼å¶æ°æ®ç»ç»å¯ä»¥åèä¸é¢ç debug æªå¾ï¼\n\n\n\n> å°ç»ï¼\n> \n> éè¿ "sqlsession å mapper" ä»¥å "sqlsession å executor" è¿ä¸¤èï¼æä»¬å·²ç»ç¥éï¼\n> \n> sqlsession çèè½æ¯ï¼æ ¹æ® statement id, å¨ configuration ä¸­è·åå°å¯¹åºç mappedstatement å¯¹è±¡ï¼ç¶åè°ç¨ executor æ¥æ§è¡å·ä½çæä½ã\n\n\n# executor å·¥ä½æµç¨\n\nç»§ç»­ä¸ä¸èçæµç¨ï¼sqlsession å° sql è¯­å¥äº¤ç±æ§è¡å¨ executor å¤çãexecutor ååäºåªäºäºå¿å¢ï¼\n\nï¼1ï¼æ§è¡å¨æ¥è¯¢å¥å£\n\npublic <e> list<e> query(mappedstatement ms, object parameter, rowbounds rowbounds, resulthandler resulthandler) throws sqlexception {\n\t// 1. æ ¹æ®ä¼ åï¼å¨æçæéè¦æ§è¡ç sql è¯­å¥ï¼ç¨ boundsql å¯¹è±¡è¡¨ç¤º\n    boundsql boundsql = ms.getboundsql(parameter);\n    // 2. æ ¹æ®ä¼ åï¼åå»ºä¸ä¸ªç¼å­key\n    cachekey key = createcachekey(ms, parameter, rowbounds, boundsql);\n    return query(ms, parameter, rowbounds, resulthandler, key, boundsql);\n }\n\n\næ§è¡å¨æ¥è¯¢å¥å£ä¸»è¦åä¸¤ä»¶äºï¼\n\n * çæå¨æ sqlï¼æ ¹æ®ä¼ åï¼å¨æçæéè¦æ§è¡ç sql è¯­å¥ï¼ç¨ boundsql å¯¹è±¡è¡¨ç¤ºã\n * ç®¡çç¼å­ï¼æ ¹æ®ä¼ åï¼åå»ºä¸ä¸ªç¼å­ keyã\n\nï¼2ï¼æ§è¡å¨æ¥è¯¢ç¬¬äºå¥å£\n\n  @suppresswarnings("unchecked")\n  @override\n  public <e> list<e> query(mappedstatement ms, object parameter, rowbounds rowbounds, resulthandler resulthandler, cachekey key, boundsql boundsql) throws sqlexception {\n    // ç¥\n    list<e> list;\n    try {\n      querystack++;\n      list = resulthandler == null ? (list<e>) localcache.getobject(key) : null;\n      // 3. ç¼å­ä¸­æå¼ï¼åç´æ¥ä»ç¼å­ä¸­åæ°æ®ï¼å¦åï¼æ¥è¯¢æ°æ®åº\n      if (list != null) {\n        handlelocallycachedoutputparameters(ms, key, parameter, boundsql);\n      } else {\n        list = queryfromdatabase(ms, parameter, rowbounds, resulthandler, key, boundsql);\n      }\n    } finally {\n      querystack--;\n    }\n    // ç¥\n    return list;\n  }\n\n\nå®éæ¥è¯¢æ¹æ³ä¸»è¦çèè½æ¯å¤æ­ç¼å­ key æ¯å¦è½å½ä¸­ç¼å­ï¼\n\n * å½ä¸­ï¼åå°ç¼å­ä¸­æ°æ®è¿åï¼\n * ä¸å½ä¸­ï¼åæ¥è¯¢æ°æ®åºï¼\n\nï¼3ï¼æ¥è¯¢æ°æ®åº\n\n  private <e> list<e> queryfromdatabase(mappedstatement ms, object parameter, rowbounds rowbounds, resulthandler resulthandler, cachekey key, boundsql boundsql) throws sqlexception {\n    list<e> list;\n    localcache.putobject(key, execution_placeholder);\n    try {\n      // 4. æ§è¡æ¥è¯¢ï¼è·å list ç»æï¼å¹¶å°æ¥è¯¢çç»ææ´æ°æ¬å°ç¼å­ä¸­\n      list = doquery(ms, parameter, rowbounds, resulthandler, boundsql);\n    } finally {\n      localcache.removeobject(key);\n    }\n    localcache.putobject(key, list);\n    if (ms.getstatementtype() == statementtype.callable) {\n      localoutputparametercache.putobject(key, parameter);\n    }\n    return list;\n  }\n\n\nqueryfromdatabase æ¹æ³çèè´£æ¯è°ç¨ doqueryï¼åæ°æ®åºåèµ·æ¥è¯¢ï¼å¹¶å°è¿åçç»ææ´æ°å°æ¬å°ç¼å­ã\n\nï¼4ï¼å®éæ¥è¯¢æ¹æ³\n\nsimpleexecutor ç±»ç doquery()æ¹æ³å®ç°\n\n  @override\n  public <e> list<e> doquery(mappedstatement ms, object parameter, rowbounds rowbounds, resulthandler resulthandler, boundsql boundsql) throws sqlexception {\n    statement stmt = null;\n    try {\n      configuration configuration = ms.getconfiguration();\n      // 5. æ ¹æ®æ¢æçåæ°ï¼åå»ºstatementhandlerå¯¹è±¡æ¥æ§è¡æ¥è¯¢æä½\n      statementhandler handler = configuration.newstatementhandler(wrapper, ms, parameter, rowbounds, resulthandler, boundsql);\n      // 6. åå»ºjava.sql.statementå¯¹è±¡ï¼ä¼ éç»statementhandlerå¯¹è±¡\n      stmt = preparestatement(handler, ms.getstatementlog());\n      // 7. è°ç¨statementhandler.query()æ¹æ³ï¼è¿ålistç»æ\n      return handler.query(stmt, resulthandler);\n    } finally {\n      closestatement(stmt);\n    }\n  }\n\n\nä¸è¿°ç executor.query()æ¹æ³å ç»è½¬æï¼æåä¼åå»ºä¸ä¸ª statementhandler å¯¹è±¡ï¼ç¶åå°å¿è¦çåæ°ä¼ éç» statementhandlerï¼ä½¿ç¨ statementhandler æ¥å®æå¯¹æ°æ®åºçæ¥è¯¢ï¼æç»è¿å list ç»æéã ä»ä¸é¢çä»£ç ä¸­æä»¬å¯ä»¥çåºï¼executor çåè½åä½ç¨æ¯ï¼\n\n 1. æ ¹æ®ä¼ éçåæ°ï¼å®æ sql è¯­å¥çå¨æè§£æï¼çæ boundsql å¯¹è±¡ï¼ä¾ statementhandler ä½¿ç¨ï¼\n\n 2. ä¸ºæ¥è¯¢åå»ºç¼å­ï¼ä»¥æé«æ§è½\n\n 3. åå»º jdbc ç statement è¿æ¥å¯¹è±¡ï¼ä¼ éç» statementhandler å¯¹è±¡ï¼è¿å list æ¥è¯¢ç»æã\n\npreparestatement() æ¹æ³çå®ç°ï¼\n\n  private statement preparestatement(statementhandler handler, log statementlog) throws sqlexception {\n    statement stmt;\n    connection connection = getconnection(statementlog);\n    stmt = handler.prepare(connection, transaction.gettimeout());\n    //å¯¹åå»ºçstatementå¯¹è±¡è®¾ç½®åæ°ï¼å³è®¾ç½®sql è¯­å¥ä¸­ ? è®¾ç½®ä¸ºæå®çåæ°\n    handler.parameterize(stmt);\n    return stmt;\n  }\n\n\nå¯¹äº jdbc ç preparedstatement ç±»åçå¯¹è±¡ï¼åå»ºçè¿ç¨ä¸­ï¼æä»¬ä½¿ç¨çæ¯ sql è¯­å¥å­ç¬¦ä¸²ä¼åå« è¥å¹²ä¸ª? å ä½ç¬¦ï¼æä»¬å¶ååå¯¹å ä½ç¬¦è¿è¡è®¾å¼ã\n\n\n# statementhandler å·¥ä½æµç¨\n\nstatementhandler æä¸ä¸ªå­ç±» routingstatementhandlerï¼å®è´è´£ä»£çå¶ä» statementhandler å­ç±»çå·¥ä½ã\n\nå®ä¼æ ¹æ®éç½®ç statement ç±»åï¼éæ©å®ä¾åç¸åºç statementhandlerï¼ç¶åç±å¶ä»£çå¯¹è±¡å®æå·¥ä½ã\n\nãæºç ãroutingstatementhandler\n\npublic routingstatementhandler(executor executor, mappedstatement ms, object parameter, rowbounds rowbounds, resulthandler resulthandler, boundsql boundsql) {\n\n  switch (ms.getstatementtype()) {\n    case statement:\n      delegate = new simplestatementhandler(executor, ms, parameter, rowbounds, resulthandler, boundsql);\n      break;\n    case prepared:\n      delegate = new preparedstatementhandler(executor, ms, parameter, rowbounds, resulthandler, boundsql);\n      break;\n    case callable:\n      delegate = new callablestatementhandler(executor, ms, parameter, rowbounds, resulthandler, boundsql);\n      break;\n    default:\n      throw new executorexception("unknown statement type: " + ms.getstatementtype());\n  }\n\n}\n\n\nãæºç ãroutingstatementhandler ç parameterize æ¹æ³æºç \n\nãæºç ãpreparedstatementhandler ç parameterize æ¹æ³æºç \n\nstatementhandler ä½¿ç¨ parameterhandler å¯¹è±¡æ¥å®æå¯¹ statement çèµå¼ã\n\n@override\npublic void parameterize(statement statement) throws sqlexception {\n  // ä½¿ç¨ parameterhandler å¯¹è±¡æ¥å®æå¯¹ statement çè®¾å¼\n  parameterhandler.setparameters((preparedstatement) statement);\n}\n\n\nãæºç ãstatementhandler ç query æ¹æ³æºç \n\nstatementhandler ä½¿ç¨ resultsethandler å¯¹è±¡æ¥å®æå¯¹ resultset çå¤çã\n\n@override\npublic <e> list<e> query(statement statement, resulthandler resulthandler) throws sqlexception {\n  preparedstatement ps = (preparedstatement) statement;\n  ps.execute();\n  // ä½¿ç¨resulthandleræ¥å¤çresultset\n  return resultsethandler.handleresultsets(ps);\n}\n\n\n\n# parameterhandler å·¥ä½æµç¨\n\nãæºç ãdefaultparameterhandler ç setparameters æ¹æ³\n\n  @override\n  public void setparameters(preparedstatement ps) {\n\t// parametermappings æ¯å¯¹å ä½ç¬¦ #{} å¯¹åºåæ°çå°è£\n    list<parametermapping> parametermappings = boundsql.getparametermappings();\n    if (parametermappings != null) {\n      for (int i = 0; i < parametermappings.size(); i++) {\n        parametermapping parametermapping = parametermappings.get(i);\n        // ä¸å¤çå­å¨è¿ç¨ä¸­çåæ°\n        if (parametermapping.getmode() != parametermode.out) {\n          object value;\n          string propertyname = parametermapping.getproperty();\n          if (boundsql.hasadditionalparameter(propertyname)) { // issue #448 ask first for additional params\n            // è·åå¯¹åºçå®éæ°å¼\n            value = boundsql.getadditionalparameter(propertyname);\n          } else if (parameterobject == null) {\n            value = null;\n          } else if (typehandlerregistry.hastypehandler(parameterobject.getclass())) {\n            value = parameterobject;\n          } else {\n            // è·åå¯¹è±¡ä¸­ç¸åºçå±æ§ææ¥æ¾ map å¯¹è±¡ä¸­çå¼\n            metaobject metaobject = configuration.newmetaobject(parameterobject);\n            value = metaobject.getvalue(propertyname);\n          }\n\n          typehandler typehandler = parametermapping.gettypehandler();\n          jdbctype jdbctype = parametermapping.getjdbctype();\n          if (value == null && jdbctype == null) {\n            jdbctype = configuration.getjdbctypefornull();\n          }\n          try {\n            // éè¿ typehandler å° java å¯¹è±¡åæ°è½¬ä¸º jdbc ç±»åçåæ°\n            // ç¶åï¼å°æ°å¼å¨æç»å®å° preparedstaement ä¸­\n            typehandler.setparameter(ps, i + 1, value, jdbctype);\n          } catch (typeexception | sqlexception e) {\n            throw new typeexception("could not set parameters for mapping: " + parametermapping + ". cause: " + e, e);\n          }\n        }\n      }\n    }\n  }\n\n\n\n# resultsethandler å·¥ä½æµç¨\n\nresultsethandler çå®ç°å¯ä»¥æ¦æ¬ä¸ºï¼å° statement æ§è¡åçç»æéï¼æç§ mapper æä»¶ä¸­éç½®ç resulttype æ resultmap æ¥è½¬æ¢æå¯¹åºç javabean å¯¹è±¡ï¼æåå°ç»æè¿åã\n\nãæºç ãdefaultresultsethandler ç handleresultsets æ¹æ³\n\nhandleresultsets æ¹æ³æ¯ defaultresultsethandler çæå³é®æ¹æ³ãå¶å®ç°å¦ä¸ï¼\n\n@override\npublic list<object> handleresultsets(statement stmt) throws sqlexception {\n  errorcontext.instance().activity("handling results").object(mappedstatement.getid());\n\n  final list<object> multipleresults = new arraylist<>();\n\n  int resultsetcount = 0;\n  // ç¬¬ä¸ä¸ªç»æé\n  resultsetwrapper rsw = getfirstresultset(stmt);\n  list<resultmap> resultmaps = mappedstatement.getresultmaps();\n  // å¤æ­ç»æéçæ°é\n  int resultmapcount = resultmaps.size();\n  validateresultmapscount(rsw, resultmapcount);\n  // éåå¤çç»æé\n  while (rsw != null && resultmapcount > resultsetcount) {\n    resultmap resultmap = resultmaps.get(resultsetcount);\n    handleresultset(rsw, resultmap, multipleresults, null);\n    rsw = getnextresultset(stmt);\n    cleanupafterhandlingresultset();\n    resultsetcount++;\n  }\n\n  string[] resultsets = mappedstatement.getresultsets();\n  if (resultsets != null) {\n    while (rsw != null && resultsetcount < resultsets.length) {\n      resultmapping parentmapping = nextresultmaps.get(resultsets[resultsetcount]);\n      if (parentmapping != null) {\n        string nestedresultmapid = parentmapping.getnestedresultmapid();\n        resultmap resultmap = configuration.getresultmap(nestedresultmapid);\n        handleresultset(rsw, resultmap, null, parentmapping);\n      }\n      rsw = getnextresultset(stmt);\n      cleanupafterhandlingresultset();\n      resultsetcount++;\n    }\n  }\n\n  return collapsesingleresultlist(multipleresults);\n}\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * mybatis github\n   * mybatis å®ç½\n * æç« \n   * æ·±å¥çè§£ mybatis åç\n   * mybatis æºç ä¸­ææ³¨é\n   * mybatis ä¸­å¼ºå¤§ç resultmap',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java ORM æ¡æ¶",frontmatter:{title:"Java ORM æ¡æ¶",categories:["ç¼ç¨","Java","æ¡æ¶","ORM"],tags:["Java","æ¡æ¶","ORM"],abbrlink:"2f780626",date:"2022-02-17T22:34:30.000Z",hidden:!0,permalink:"/pages/e873e1/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/11.ORM/",relativePath:"13.æ¡æ¶/11.ORM/README.md",key:"v-58178384",path:"/pages/e873e1/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:18},{level:3,title:"Mybatis å¿«éå¥é¨",slug:"mybatis-å¿«éå¥é¨",normalizedTitle:"mybatis å¿«éå¥é¨",charIndex:155},{level:3,title:"Mybatis åç",slug:"mybatis-åç",normalizedTitle:"mybatis åç",charIndex:172},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:187},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:608}],headersStr:"ð åå®¹ Mybatis å¿«éå¥é¨ Mybatis åç ð èµæ ðª ä¼ é",content:"# Java ORM æ¡æ¶\n\n\n# ð åå®¹\n\n> Mybatis çåèº«å°±æ¯ iBatis ï¼æ¯ä¸æ¬¾ä¼ç§çæä¹å±æ¡æ¶ï¼å®æ¯æèªå®ä¹ SQLãå­å¨è¿ç¨ä»¥åé«çº§æ å°ãæ¬æä»¥ä¸ä¸ª Mybatis å®æ´ç¤ºä¾ä¸ºåå¥ç¹ï¼ç»å Mybatis åºå±æºç åæï¼å¾æå¹¶èçè®²è§£ Mybatis çæ ¸å¿å·¥ä½æºå¶ã\n\n\n\n\n# Mybatis å¿«éå¥é¨\n\n\n# Mybatis åç\n\n\n# ð èµæ\n\n * å®æ¹\n   * Mybatis Github\n   * Mybatis å®ç½\n   * MyBatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * MyBatis å®æ¹éæ Springï¼mybatis-springï¼\n   * Mybatis å®æ¹éæ Spring Bootï¼mybatis-spring-bootï¼\n * æ©å±æä»¶\n   * MyBatis-Plus - CRUD æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * Mapper - CRUD æ©å±æä»¶\n   * Mybatis-PageHelper - Mybatis éç¨åé¡µæä»¶\n * æç« \n   * æ·±å¥çè§£ mybatis åç\n   * mybatis æºç ä¸­ææ³¨é\n   * MyBatis Generator è¯¦è§£\n   * Mybatis å¸¸è§é¢è¯é¢\n   * Mybatis ä¸­å¼ºå¤§ç resultMap\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java orm æ¡æ¶\n\n\n# ð åå®¹\n\n> mybatis çåèº«å°±æ¯ ibatis ï¼æ¯ä¸æ¬¾ä¼ç§çæä¹å±æ¡æ¶ï¼å®æ¯æèªå®ä¹ sqlãå­å¨è¿ç¨ä»¥åé«çº§æ å°ãæ¬æä»¥ä¸ä¸ª mybatis å®æ´ç¤ºä¾ä¸ºåå¥ç¹ï¼ç»å mybatis åºå±æºç åæï¼å¾æå¹¶èçè®²è§£ mybatis çæ ¸å¿å·¥ä½æºå¶ã\n\n\n\n\n# mybatis å¿«éå¥é¨\n\n\n# mybatis åç\n\n\n# ð èµæ\n\n * å®æ¹\n   * mybatis github\n   * mybatis å®ç½\n   * mybatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * mybatis å®æ¹éæ springï¼mybatis-springï¼\n   * mybatis å®æ¹éæ spring bootï¼mybatis-spring-bootï¼\n * æ©å±æä»¶\n   * mybatis-plus - crud æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * mapper - crud æ©å±æä»¶\n   * mybatis-pagehelper - mybatis éç¨åé¡µæä»¶\n * æç« \n   * æ·±å¥çè§£ mybatis åç\n   * mybatis æºç ä¸­ææ³¨é\n   * mybatis generator è¯¦è§£\n   * mybatis å¸¸è§é¢è¯é¢\n   * mybatis ä¸­å¼ºå¤§ç resultmap\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Shiro å¿«éå¥é¨",frontmatter:{title:"Shiro å¿«éå¥é¨",categories:["ç¼ç¨","Java","æ¡æ¶","å®å¨"],tags:["Java","æ¡æ¶","å®å¨","Shiro"],abbrlink:"1c025fc",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/cd25bf/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/12.%E5%AE%89%E5%85%A8/01.Shiro.html",relativePath:"13.æ¡æ¶/12.å®å¨/01.Shiro.md",key:"v-7f048411",path:"/pages/cd25bf/",headers:[{level:2,title:"ä¸ãShiro ç®ä»",slug:"ä¸ãshiro-ç®ä»",normalizedTitle:"ä¸ãshiro ç®ä»",charIndex:53},{level:3,title:"Shiro ç¹æ§",slug:"shiro-ç¹æ§",normalizedTitle:"shiro ç¹æ§",charIndex:68},{level:3,title:"Shiro æ¶ææ¦è¿°",slug:"shiro-æ¶ææ¦è¿°",normalizedTitle:"shiro æ¶ææ¦è¿°",charIndex:722},{level:3,title:"SecurityManager",slug:"securitymanager",normalizedTitle:"securitymanager",charIndex:1074},{level:2,title:"äºãShiro è®¤è¯",slug:"äºãshiro-è®¤è¯",normalizedTitle:"äºãshiro è®¤è¯",charIndex:1836},{level:3,title:"è®¤è¯ Subject",slug:"è®¤è¯-subject",normalizedTitle:"è®¤è¯ subject",charIndex:1851},{level:3,title:"Remembered å Authenticated",slug:"remembered-å-authenticated",normalizedTitle:"remembered å authenticated",charIndex:2612},{level:3,title:"ç»åº",slug:"ç»åº",normalizedTitle:"ç»åº",charIndex:2920},{level:3,title:"è®¤è¯æµç¨",slug:"è®¤è¯æµç¨",normalizedTitle:"è®¤è¯æµç¨",charIndex:3009},{level:3,title:"è®¤è¯ç­ç¥",slug:"è®¤è¯ç­ç¥",normalizedTitle:"è®¤è¯ç­ç¥",charIndex:1568},{level:2,title:"ä¸ãShiro ææ",slug:"ä¸ãshiro-ææ",normalizedTitle:"ä¸ãshiro ææ",charIndex:4637},{level:3,title:"ææåç´ ",slug:"ææåç´ ",normalizedTitle:"ææåç´ ",charIndex:4700},{level:4,title:"æé",slug:"æé",normalizedTitle:"æé",charIndex:164},{level:4,title:"è§è²",slug:"è§è²",normalizedTitle:"è§è²",charIndex:196},{level:4,title:"ç¨æ·",slug:"ç¨æ·",normalizedTitle:"ç¨æ·",charIndex:112},{level:3,title:"åºäºè§è²çææ",slug:"åºäºè§è²çææ",normalizedTitle:"åºäºè§è²çææ",charIndex:5062},{level:3,title:"åºäºæéçææ",slug:"åºäºæéçææ",normalizedTitle:"åºäºæéçææ",charIndex:5499},{level:3,title:"åºäºæ³¨è§£çææ",slug:"åºäºæ³¨è§£çææ",normalizedTitle:"åºäºæ³¨è§£çææ",charIndex:6273},{level:4,title:"@RequiresAuthentication",slug:"requiresauthentication",normalizedTitle:"@requiresauthentication",charIndex:6316},{level:4,title:"@RequiresGuest",slug:"requiresguest",normalizedTitle:"@requiresguest",charIndex:6586},{level:3,title:"æææµç¨",slug:"æææµç¨",normalizedTitle:"æææµç¨",charIndex:6660},{level:2,title:"åãShiro ä¼è¯ç®¡ç",slug:"åãshiro-ä¼è¯ç®¡ç",normalizedTitle:"åãshiro ä¼è¯ç®¡ç",charIndex:7342},{level:3,title:"ä¼è¯è¶æ¶",slug:"ä¼è¯è¶æ¶",normalizedTitle:"ä¼è¯è¶æ¶",charIndex:7644},{level:3,title:"ä¼è¯çå¬",slug:"ä¼è¯çå¬",normalizedTitle:"ä¼è¯çå¬",charIndex:7749},{level:3,title:"ä¼è¯å­å¨",slug:"ä¼è¯å­å¨",normalizedTitle:"ä¼è¯å­å¨",charIndex:8382},{level:2,title:"äºãRealm",slug:"äºãrealm",normalizedTitle:"äºãrealm",charIndex:8568},{level:3,title:"è®¤è¯ä»¤ç",slug:"è®¤è¯ä»¤ç",normalizedTitle:"è®¤è¯ä»¤ç",charIndex:8688},{level:3,title:"å å¯",slug:"å å¯",normalizedTitle:"å å¯",charIndex:38},{level:2,title:"å­ãéç½®",slug:"å­ãéç½®",normalizedTitle:"å­ãéç½®",charIndex:10293},{level:3,title:"è¿æ»¤é¾",slug:"è¿æ»¤é¾",normalizedTitle:"è¿æ»¤é¾",charIndex:10302},{level:3,title:"RememberMe",slug:"rememberme",normalizedTitle:"rememberme",charIndex:2115},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:11360}],headersStr:"ä¸ãShiro ç®ä» Shiro ç¹æ§ Shiro æ¶ææ¦è¿° SecurityManager äºãShiro è®¤è¯ è®¤è¯ Subject Remembered å Authenticated ç»åº è®¤è¯æµç¨ è®¤è¯ç­ç¥ ä¸ãShiro ææ ææåç´  æé è§è² ç¨æ· åºäºè§è²çææ åºäºæéçææ åºäºæ³¨è§£çææ @RequiresAuthentication @RequiresGuest æææµç¨ åãShiro ä¼è¯ç®¡ç ä¼è¯è¶æ¶ ä¼è¯çå¬ ä¼è¯å­å¨ äºãRealm è®¤è¯ä»¤ç å å¯ å­ãéç½® è¿æ»¤é¾ RememberMe åèèµæ",content:'# Shiro å¿«éå¥é¨\n\n> Shiro æ¯ä¸ä¸ªå®å¨æ¡æ¶ï¼å·æè®¤è¯ãææãå å¯ãä¼è¯ç®¡çåè½ã\n\n\n# ä¸ãShiro ç®ä»\n\n\n# Shiro ç¹æ§\n\n\n\næ ¸å¿åè½ï¼\n\n * Authentication - è®¤è¯ãéªè¯ç¨æ·æ¯ä¸æ¯æ¥æç¸åºçèº«ä»½ã\n * Authorization - ææãéªè¯æä¸ªå·²è®¤è¯çç¨æ·æ¯å¦æ¥ææä¸ªæéï¼å³å¤æ­ç¨æ·æ¯å¦è½åäºæï¼å¸¸è§çå¦ï¼éªè¯æä¸ªç¨æ·æ¯å¦æ¥ææä¸ªè§è²ãæèç»ç²åº¦çéªè¯æä¸ªç¨æ·å¯¹æä¸ªèµæºæ¯å¦å·ææä¸ªæéã\n * Session Manager - ä¼è¯ç®¡çãå³ç¨æ·ç»å½åå°±æ¯ä¸æ¬¡ä¼è¯ï¼å¨æ²¡æéåºä¹åï¼å®çææä¿¡æ¯é½å¨ä¼è¯ä¸­ãä¼è¯å¯ä»¥æ¯æ®é JavaSE ç¯å¢çï¼ä¹å¯ä»¥æ¯å¦ Web ç¯å¢çã\n * Cryptography - å å¯ãä¿æ¤æ°æ®çå®å¨æ§ï¼å¦å¯ç å å¯å­å¨å°æ°æ®åºï¼èä¸æ¯ææå­å¨ã\n\nè¾å©åè½ï¼\n\n * Web Support - Web æ¯æãå¯ä»¥éå¸¸å®¹æçéæå° Web ç¯å¢ï¼\n * Caching - ç¼å­ãæ¯å¦ç¨æ·ç»å½åï¼å¶ç¨æ·ä¿¡æ¯ãæ¥æçè§è² / æéä¸å¿æ¯æ¬¡å»æ¥ï¼è¿æ ·å¯ä»¥æé«æçï¼\n * Concurrency - å¹¶åãShiro æ¯æå¤çº¿ç¨åºç¨çå¹¶åéªè¯ï¼å³å¦å¨ä¸ä¸ªçº¿ç¨ä¸­å¼å¯å¦ä¸ä¸ªçº¿ç¨ï¼è½ææéèªå¨ä¼ æ­è¿å»ï¼\n * Testing - æµè¯ãæä¾æµè¯æ¯æï¼\n * Run As - è¿è¡æ¹å¼ãåè®¸ä¸ä¸ªç¨æ·åè£ä¸ºå¦ä¸ä¸ªç¨æ·ï¼å¦æä»ä»¬åè®¸ï¼çèº«ä»½è¿è¡è®¿é®ï¼\n * Remember Me - è®°ä½æãå³ä¸æ¬¡ç»å½åï¼ä¸æ¬¡åè®¿é®åç»å½ã\n\n> ð æ³¨æï¼Shiro ä¸ä¼å»ç»´æ¤ç¨æ·ãç»´æ¤æéï¼è¿äºéè¦æä»¬èªå·±å»æä¾ï¼ç¶åéè¿ç¸åºçæ¥å£æ³¨å¥ç» Shiro å³å¯ã\n\n\n# Shiro æ¶ææ¦è¿°\n\n\n\n * Subject - ä¸»é¢ãå®ä»£è¡¨å½åç¨æ·ï¼Subject å¯ä»¥æ¯ä¸ä¸ªäººï¼ä½ä¹å¯ä»¥æ¯ç¬¬ä¸æ¹æå¡ãå®æ¤è¿ç¨å¸æ·ãæ¶éå®æ¤ä»»å¡æèå¶å®ââå½ååè½¯ä»¶äº¤äºçä»»ä½äºä»¶ãSubject æ¯ Shiro çå¥å£ã\n   \n   * Principals æ¯ Subject çâè¯å«å±æ§âãPrincipals å¯ä»¥æ¯ä»»ä½å¯ä»¥è¯å« Subject çä¸è¥¿ï¼ä¾å¦åå­ï¼å§æ°ï¼ï¼å§æ°ï¼å§æ°æå§æ°ï¼ï¼ç¨æ·åï¼ç¤¾ä¼ä¿é©å·ç­ãå½ç¶ï¼Principals å¨åºç¨ç¨åºä¸­æå¥½æ¯æä¸çã\n   * Credentials éå¸¸æ¯ä»ç± Subject ç¥éçç§å¯å¼ï¼ç¨ä½ä»ä»¬å®éä¸âæ¥æâæä¸»å¼ èº«ä»½çä½è¯ å­æ®çä¸äºå¸¸è§ç¤ºä¾æ¯å¯ç ï¼çç©ç¹å¾æ°æ®ï¼ä¾å¦æçº¹åè§ç½èæ«æï¼ä»¥å X.509 è¯ä¹¦ã\n\n * SecurityManager - å®å¨ç®¡çãå®æ¯ Shiro çæ ¸å¿ï¼ææä¸å®å¨æå³çæä½ï¼è®¤è¯ãææãåä¼è¯ãç¼å­çç®¡çï¼é½ä¸ SecurityManager äº¤äºï¼ä¸å®ç®¡ççææ Subjectã\n\n * Realm - åãç¨äºè®¿é®å®å¨ç¸å³æ°æ®ï¼å¯ä»¥è§ä¸ºåºç¨èªèº«çæ°æ®æºï¼éè¦å¼åèèªå·±å®ç°ãShiro ä¼éè¿ Realm è·åå®å¨æ°æ®ï¼å¦ç¨æ·ãè§è²ãæéï¼ï¼å°±æ¯è¯´ SecurityManager è¦éªè¯ç¨æ·èº«ä»½ï¼é£ä¹å®éè¦ä» Realm è·åç¸åºçç¨æ·è¿è¡æ¯è¾ä»¥ç¡®å®ç¨æ·èº«ä»½æ¯å¦åæ³ï¼ä¹éè¦ä» Realm å¾å°ç¨æ·ç¸åºçè§è²/æéè¿è¡éªè¯ç¨æ·æ¯å¦è½è¿è¡æä½ï¼å¯ä»¥æ Realm çæ DataSourceï¼å³å®å¨æ°æ®æºã\n\n\n# SecurityManager\n\nSecurityManager æ¯ Shiro æ¡æ¶æ ¸å¿ä¸­çæ ¸å¿ï¼å®ç¸å½äº Shiro çæ»ææ¥ï¼è´è´£è°åº¦ææè¡ä¸ºï¼åæ¬ï¼è®¤è¯ãææãè·åå®å¨æ°æ®ï¼è°ç¨ Realmï¼ãä¼è¯ç®¡çç­ã\n\n\n\nSecurityManager èåäºä»¥ä¸ç»ä»¶ï¼\n\n * Authenticator - è®¤è¯å¨ï¼è´è´£è®¤è¯ãå¦æç¨æ·éè¦å®å¶è®¤è¯ç­ç¥ï¼å¯ä»¥å®ç°æ­¤æ¥å£ã\n * Authorizer - ææå¨ï¼è´è´£æéæ§å¶ãç¨æ¥å³å®ä¸»ä½æ¯å¦ææéè¿è¡ç¸åºçæä½ï¼å³æ§å¶çç¨æ·è½è®¿é®åºç¨ä¸­çåªäºåè½ï¼\n * SessionManager - ä¼è¯ç®¡çå¨ãShiro æ½è±¡äºä¸ä¸ªèªå·±ç Session æ¥ç®¡çä¸»ä½ä¸åºç¨ä¹é´äº¤äºçæ°æ®ã\n * SessionDAO - ä¼è¯ DAO ç¨äºå­å¨ä¼è¯ï¼éè¦ç¨æ·èªå·±å®ç°ã\n * CacheManager - ç¼å­æ§å¶å¨ãç¨äºç®¡çå¦ç¨æ·ãè§è²ãæéç­ä¿¡æ¯çç¼å­ã\n * Cryptography - å¯ç å¨ãç¨äºå¯¹æ°æ®å å¯ãè§£å¯ã\n\n\n# äºãShiro è®¤è¯\n\n\n# è®¤è¯ Subject\n\néªè¯ Subject çè¿ç¨å¯ä»¥ææå°åä¸ºä¸ä¸ªä¸åçæ­¥éª¤ï¼\n\nï¼1ï¼æ¶é Subject æäº¤ç Principals å Credentials\n\n//Example using most common scenario of username/password pair:\nUsernamePasswordToken token = new UsernamePasswordToken(username, password);\n\n//"Remember Me" built-in:\ntoken.setRememberMe(true);\n\n\nï¼2ï¼æäº¤ Principals å Credentials ä»¥è¿è¡èº«ä»½éªè¯ã\n\nSubject currentUser = SecurityUtils.getSubject();\n\ncurrentUser.login(token);\n\n\nï¼3ï¼å¦ææäº¤æåï¼ååè®¸è®¿é®ï¼å¦åéè¯èº«ä»½éªè¯æé»æ­¢è®¿é®ã\n\ntry {\n    currentUser.login(token);\n} catch ( UnknownAccountException uae ) { ...\n} catch ( IncorrectCredentialsException ice ) { ...\n} catch ( LockedAccountException lae ) { ...\n} catch ( ExcessiveAttemptsException eae ) { ...\n} ... catch your own ...\n} catch ( AuthenticationException ae ) {\n    //unexpected error?\n}\n\n\n\n# Remembered å Authenticated\n\n * Remembered - è®°ä½æãè¢«è®°ä½ç Subject ä¸æ¯å¿åçï¼å¹¶ä¸å·æå·²ç¥çèº«ä»½ï¼å³ subject.getPrincipals() æ¯éç©ºçï¼ã ä½æ¯ï¼å¨ååçä¼è¯æé´ï¼éè¿ååçèº«ä»½éªè¯ä¼è®°ä½æ­¤èº«ä»½ã å¦æ subject.isRemembered() è¿å trueï¼åè®¤ä¸ºè¯¥ä¸»é¢å·²è¢«è®°ä½ã\n * Authenticated - å·²è®¤è¯ãå·²è®¤è¯ç Subject æ¯å¨å½åä¼è¯æé´å·²æåè®¤è¯ç Subjectã å¦æ subject.isAuthenticated() è¿å trueï¼åè®¤ä¸ºè¯¥ Subject å·²éè¿èº«ä»½éªè¯ã\n\n\n# ç»åº\n\nå½ Subject ä¸åºç¨ç¨åºå®æäº¤äºåï¼å¯ä»¥è°ç¨ subject.logout() ç»åºï¼å³æ¾å¼æææ è¯ä¿¡æ¯ã\n\ncurrentUser.logout();\n\n\n\n# è®¤è¯æµç¨\n\n\n\n 1. åºç¨ç¨åºä»£ç è°ç¨ Subject.login æ¹æ³ï¼ä¼ å¥æé ç AuthenticationToken å®ä¾ï¼è¯¥å®ä¾ä»£è¡¨æç»ç¨æ·ç Principals å Credentialsã\n\n 2. Subject å®ä¾ï¼éå¸¸æ¯ DelegatingSubjectï¼æå­ç±»ï¼ï¼éè¿è°ç¨ securityManager.loginï¼tokenï¼å§æåºç¨ç¨åºç SecurityManagerï¼å¨æ­¤å¤å¼å§å®éçèº«ä»½éªè¯å·¥ä½ã\n\n 3. SecurityManager æ¥æ¶ä»¤çï¼å¹¶éè¿è°ç¨ authenticator.authenticateï¼tokenï¼æ¥ç®åå°å§æ´¾ç»å¶åé¨ Authenticator å®ä¾ãè¿å ä¹æ»æ¯ä¸ä¸ª ModularRealmAuthenticator å®ä¾ï¼å®æ¯æå¨èº«ä»½éªè¯æé´åè°ä¸ä¸ªæå¤ä¸ª Realm å®ä¾ã\n\n 4. å¦æä¸ºè¯¥åºç¨ç¨åºéç½®äºå¤ä¸ª Realmï¼å ModularRealmAuthenticator å®ä¾å°å©ç¨å¶éç½®ç AuthenticationStrategy åèµ·å¤åéªè¯å°è¯ãå¨è°ç¨é¢åè¿è¡èº«ä»½éªè¯ä¹åï¼æé´åä¹åï¼å°è°ç¨ AuthenticationStrategy ä»¥ä½¿å¶å¯¹æ¯ä¸ªé¢åçç»æååºååºã\n\n 5. è¯·å¨è¯¢æ¯ä¸ªå·²éç½®ç Realmï¼ä»¥æ¥çå¶æ¯å¦æ¯ææäº¤ç AuthenticationTokenã å¦ææ¯è¿æ ·ï¼å°ä½¿ç¨æäº¤çä»¤çè°ç¨æ¯æ Realm ç getAuthenticationInfo æ¹æ³ã getAuthenticationInfo æ¹æ³ææå°è¡¨ç¤ºå¯¹è¯¥ç¹å® Realm çåä¸ªèº«ä»½éªè¯å°è¯ã\n\n\n# è®¤è¯ç­ç¥\n\nå½ä¸ºä¸ä¸ªåºç¨ç¨åºéç½®ä¸¤ä¸ªæå¤ä¸ªé¢åæ¶ï¼ModularRealmAuthenticator ä¾èµäºåé¨ AuthenticationStrategy ç»ä»¶æ¥ç¡®å®è®¤è¯å°è¯æåæå¤±è´¥çæ¡ä»¶ã\n\nä¾å¦ï¼å¦æåªæä¸ä¸ª Realm æåå°å¯¹ AuthenticationToken è¿è¡èº«ä»½éªè¯ï¼èææå¶ä» Realm é½å¤±è´¥äºï¼é£ä¹è¯¥èº«ä»½éªè¯å°è¯æ¯å¦è¢«è§ä¸ºæåï¼è¿æ¯å¿é¡»ææé¢åé½æåè¿è¡èº«ä»½éªè¯æè½å°æ´ä½å°è¯è§ä¸ºæåï¼æèï¼å¦ææä¸ªé¢åæåéè¿èº«ä»½éªè¯ï¼æ¯å¦æå¿è¦è¿ä¸æ­¥å¨è¯¢å¶ä»é¢åï¼ AuthenticationStrategy æ ¹æ®åºç¨ç¨åºçéæ±ååºéå½çå³å®ã\n\nAuthenticationStrategy æ¯æ ç¶æç»ä»¶ï¼å¨å°è¯è¿è¡èº«ä»½éªè¯æ¶ä¼è¢«æ¥è¯¢ 4 æ¬¡ï¼è¿ 4 ç§äº¤äºæéçä»»ä½å¿è¦ç¶æé½å°ä½ä¸ºæ¹æ³åæ°ç»åºï¼ï¼\n\n * å¨ä»»ä½é¢åè¢«è°ç¨ä¹å\n * å¨è°ç¨åä¸ª Realm ç getAuthenticationInfo æ¹æ³ä¹å\n * å¨è°ç¨åä¸ª Realm ç getAuthenticationInfo æ¹æ³ä¹å\n * å¨ææé¢åé½è¢«è°ç¨ä¹å\n\nAuthenticationStrategy è¿è´è´£æ±æ»æ¯ä¸ªæå Realm çç»æï¼å¹¶å°å®ä»¬âæç»âæåä¸ª AuthenticationInfo è¡¨ç¤ºå½¢å¼ãæç»çèå AuthenticationInfo å®ä¾æ¯ Authenticator å®ä¾è¿åçç»æï¼ä¹æ¯ Shiro ç¨æ¥è¡¨ç¤ºä¸»ä½çæç»èº«ä»½ï¼ä¹ç§°ä¸ºå§æäººï¼çä¸è¥¿ã\n\nAUTHENTICATIONSTRATEGY         æè¿°\nAtLeastOneSuccessfulStrategy   åªè¦æä¸ä¸ª Realm æåè®¤è¯ï¼åæ´ä¸ªå°è¯é½è¢«è§ä¸ºæåã\nFirstSuccessfulStrategy        ä»ä½¿ç¨ä»ç¬¬ä¸ä¸ªæåéè¿èº«ä»½éªè¯ç Realm è¿åçä¿¡æ¯ï¼ææå¶ä» Realm å°è¢«å¿½ç¥ã\nAllSuccessfulStrategy          åªæææ Realm æåè®¤è¯ï¼åæ´ä¸ªå°è¯æè¢«è§ä¸ºæåã\n\n> ð æ´å¤è®¤è¯ç»èå¯ä»¥åèï¼Apache Shiro Authentication\n\n\n# ä¸ãShiro ææ\n\nææï¼ä¹ç§°ä¸ºè®¿é®æ§å¶ï¼æ¯ç®¡çå¯¹èµæºçè®¿é®çè¿ç¨ã æ¢å¥è¯è¯´ï¼æ§å¶è°ææè®¿é®åºç¨ç¨åºä¸­çåå®¹ã\n\n\n# ææåç´ \n\næææä¸ä¸ªæ ¸å¿è¦ç´ ï¼æéãè§è²åç¨æ·ã\n\n# æé\n\næéç¤ºä¾ï¼\n\n * æå¼ä¸ä¸ªæä»¶\n * æ¥ç /user/list web é¡µé¢\n * æ¥è¯¢è®°å½\n * å é¤ä¸æ¡è®°å½\n * ...\n\nå¤§å¤æ°èµæºé½æ¯æä¸è¬ç CRUD æä½ãé¤æ­¤ä»¥å¤ï¼å¯¹äºä¸äºç¹å®çèµæºï¼ä»»ä½ææä¹çè¡ä¸ºé½æ¯å¯ä»¥çãåºæ¬çè®¾è®¡æè·¯æ¯ï¼æéæ§å¶ï¼è³å°æ¯åºäºèµæºåè¡ä¸ºã\n\n# è§è²\n\nè§è²æ¯ä¸ä¸ªå½åå®ä½ï¼éå¸¸ä»£è¡¨ä¸ç»è¡ä¸ºæèè´£ãè¿äºè¡ä¸ºä¼è½¬åä¸ºï¼è°å¯ä»¥å¨åºç¨ç¨åºä¸­æ§è¡åªäºè¡ä¸ºï¼è°ä¸å¯ä»¥å¨ç¨åºä¸­æ§è¡åªäºè¡ä¸ºï¼\n\nè§è²éå¸¸æ¯åéç»ç¨æ·å¸æ·çï¼å æ­¤éè¿å³èï¼ç¨æ·å¯ä»¥è·å¾èªèº«è§è²æèµäºçæéã\n\n# ç¨æ·\n\nç¨æ·æ¬è´¨ä¸æ¯åºç¨ç¨åºçâç¨æ·âã\n\nç¨æ·ï¼å³ Shiro ç Subjectï¼éè¿ä¸è§è²æç´æ¥æéçå³èå¨åºç¨ç¨åºä¸­æ§è¡æäºè¡ä¸ºã\n\n\n# åºäºè§è²çææ\n\nå¦ææææ¯åºäºè§è²èµäºæéçæ°æ®æ¨¡åï¼ç¼ç¨æ¨¡å¼å¦ä¸ï¼\n\nãç¤ºä¾ä¸ã\n\nSubject currentUser = SecurityUtils.getSubject();\n\nif (currentUser.hasRole("administrator")) {\n    //show the admin button\n} else {\n    //don\'t show the button?  Grey it out?\n}\n\n\nãç¤ºä¾äºã\n\nSubject currentUser = SecurityUtils.getSubject();\n\n// æ£æ¥å½å Subject æ¯å¦ææç§æé\n// å¦ææï¼ç´æ¥è·³è¿ï¼å¦ææ²¡æï¼Shiro ä¼æåº AuthorizationException\ncurrentUser.checkRole("bankTeller");\nopenBankAccount();\n\n\n> æç¤ºï¼æ¹å¼äºç¸æ¯æ¹å¼ä¸ï¼ä»£ç æ´ç®æ´\n\n\n# åºäºæéçææ\n\næ´å¥½çææç­ç¥éå¸¸æ¯åºäºæéçææãåºäºæéçææï¼ç±äºå®ååºç¨ç¨åºçåå§åè½ï¼éå¯¹å·ä½èµæºä¸çè¡ä¸ºï¼ç´§å¯ç¸å³ï¼æä»¥åºäºæéçæææºä»£ç ä¼å¨åè½æ´æ¹æ¶åæ­¥æ´æ¹ï¼èä¸æ¯å¨å®å¨ç­ç¥åçæ´æ¹æ¶ï¼ã è¿æå³çä¸ç±»ä¼¼çåºäºè§è²çææä»£ç ç¸æ¯ï¼ä¿®æ¹ä»£ç çå½±åé¢è¦å°å¾å¤ã\n\nãç¤ºä¾ãåºäºå¯¹è±¡çæéæ£æ¥\n\nPermission printPermission = new PrinterPermission("laserjet4400n", "print");\n\nSubject currentUser = SecurityUtils.getSubject();\n\nif (currentUser.isPermitted(printPermission)) {\n    //show the Print button\n} else {\n    //don\'t show the button?  Grey it out?\n}\n\n\nå¨å¯¹è±¡ä¸­å­å¨æéæ§å¶ä¿¡æ¯ï¼ä½è¿ç§æ¹å¼è¾ä¸ºç¹é\n\nãç¤ºä¾ãå­ç¬¦ä¸²å®ä¹æéæ§å¶ä¿¡æ¯\n\nSubject currentUser = SecurityUtils.getSubject();\n\nif (currentUser.isPermitted("printer:print:laserjet4400n")) {\n    //show the Print button\n} else {\n    //don\'t show the button?  Grey it out?\n}\n\n\nä½¿ç¨ : åéï¼è¡¨ç¤ºèµæºç±»åãè¡ä¸ºãèµæº IDï¼Shiro æä¾äºé»è®¤å®ç°ï¼ org.apache.shiro.authz.permission.WildcardPermissionã\n\nè¿ç§æéæ§å¶æ¹å¼çå¥½å¤å¨äºï¼è½»éãçµæ´»ã\n\n\n# åºäºæ³¨è§£çææ\n\nShiro æä¾äºä¸äºç¨äºææçæ³¨è§£ï¼æ¥è¿ä¸æ­¥ç®åææä»£ç ã\n\n# @RequiresAuthentication\n\n@RequiresAuthentication æ³¨è§£è¦æ±å½å Subject å¿é¡»æ¯å·²è®¤è¯ç¨æ·æå¯ä»¥è®¿é®è¢«ä¿®é¥°çæ¹æ³ã\n\nãç¤ºä¾ã\n\n@RequiresAuthentication\npublic void updateAccount(Account userAccount) {\n    //this method will only be invoked by a\n    //Subject that is guaranteed authenticated\n    ...\n}\n\n\n# @RequiresGuest\n\n@RequiresGuest æ³¨è§£è¦æ±å½å Subject çè§è²æ¯ guest æå¯ä»¥è®¿é®è¢«ä¿®é¥°çæ¹æ³ã\n\n\n# æææµç¨\n\n\n\n 1. åºç¨ç¨åºææ¡æ¶ä»£ç è°ç¨ä»»ä½ Subject ç hasRole*ï¼checkRole*ï¼isPermitted* æ checkPermission* æ¹æ³ï¼å¹¶ä¼ å¥æéçæéæè§è²ã\n\n 2. Subject å®ä¾ï¼éå¸¸æ¯ DelegatingSubjectï¼æå­ç±»ï¼ï¼éè¿è°ç¨ securityManager å ä¹ç¸åçåèª hasRole*ï¼checkRole*ï¼isPermitted* æ checkPermission* æ¹æ³æ¥å§æ SecurityManager ï¼å®ç°äº org.apache.shiro.authz.Authorizer æ¥å£ï¼å¤çææã\n\n 3. SecurityManager éè¿è°ç¨ææèåèªç hasRole*ï¼checkRole*ï¼isPermitted* æ checkPermission* æ¹æ³æ¥ä¸­ç»§/å§æå¶åé¨ç org.apache.shiro.authz.Authorizer å®ä¾ãé»è®¤æåµä¸ï¼authorizer å®ä¾æ¯ ModularRealmAuthorizer å®ä¾ï¼è¯¥å®ä¾æ¯æå¨ä»»ä½æææä½æé´åè°ä¸ä¸ªæå¤ä¸ª Realm å®ä¾ã\n\n 4. æ£æ¥æ¯ä¸ªå·²éç½®ç Realmï¼ä»¥æ¥çå¶æ¯å¦å®ç°ç¸åç Authorizer æ¥å£ãå¦ææ¯è¿æ ·ï¼åå°è°ç¨ Realm åèªç hasRole*ï¼checkRole*ï¼isPermitted* æ checkPermission* æ¹æ³ã\n\n> ð æ´å¤ææç»èå¯ä»¥åèï¼Apache Shiro Authorization\n\n\n# åãShiro ä¼è¯ç®¡ç\n\nShiro æä¾äºä¸å¥ç¬ç¹çä¼è¯ç®¡çæ¹æ¡ï¼å¶ Session å¯ä»¥ä½¿ç¨ Java SE ç¨åºï¼ä¹å¯ä»¥ä½¿ç¨äº Java Web ç¨åºã\n\nå¨ Shiro ä¸­ï¼SessionManager è´è´£ç®¡çåºç¨ææ Subject çä¼è¯ï¼å¦ï¼åå»ºãå é¤ãå¤±æãéªè¯ç­ã\n\nãç¤ºä¾ãä¼è¯ä½¿ç¨ç¤ºä¾\n\nSubject currentUser = SecurityUtils.getSubject();\n\nSession session = currentUser.getSession();\nsession.setAttribute( "someKey", someValue);\n\n\n\n# ä¼è¯è¶æ¶\n\né»è®¤æåµä¸ï¼Shiro ä¸­çä¼è¯æææä¸º 30 åéï¼è¶æ¶åï¼è¯¥ä¼è¯å°è¢« Shiro è§ä¸ºæ æã\n\nå¯ä»¥éè¿ globalSessionTimeout æ¹æ³è®¾ç½® Shiro ä¼è¯è¶æ¶æ¶é´ã\n\n\n# ä¼è¯çå¬\n\nShiro æä¾äº SessionListener æ¥å£ï¼æ SessionListenerAdapter æ¥å£ï¼ï¼ç¨äºçå¬éè¦çä¼è¯äºä»¶ï¼å¹¶åè®¸ä½¿ç¨èå¨äºä»¶è§¦åæ¶åå®å¶åå¤çã\n\nãç¤ºä¾ã\n\npublic class ShiroSessionListener implements SessionListener {\n\n    private final Logger log = LoggerFactory.getLogger(this.getClass());\n\n    private final AtomicInteger sessionCount = new AtomicInteger(0);\n\n    @Override\n    public void onStart(Session session) {\n        sessionCount.incrementAndGet();\n    }\n\n    @Override\n    public void onStop(Session session) {\n        sessionCount.decrementAndGet();\n    }\n\n    @Override\n    public void onExpiration(Session session) {\n        sessionCount.decrementAndGet();\n    }\n}\n\n\n\n# ä¼è¯å­å¨\n\nå¤§å¤æ°æåµä¸ï¼åºç¨éè¦ä¿å­ä¼è¯ä¿¡æ¯ï¼ä»¥ä¾¿å¨ç¨åå¯ä»¥ä½¿ç¨å®ã\n\nShiro æä¾äº SessionManager æ¥å£ï¼è´è´£å°éå¯¹ä¼è¯ç CRUD æä½å§æ´¾ç»åé¨ç»ä»¶ SessionDAOï¼è¯¥ç»ä»¶åæ äºæ°æ®è®¿é®å¯¹è±¡ï¼DAOï¼è®¾è®¡æ¨¡å¼ã\n\n> ð æ³¨æï¼ç±äºä¼è¯éå¸¸å·ææ¶ææ§ï¼æä»¥ä¸è¬ä¼è¯å¤©ç¶éåå­å¨äºç¼å­ä¸­ãå­å¨äº Redis ä¸­æ¯ä¸ä¸ªä¸éçéæ©ã\n\n\n# äºãRealm\n\nRealm æ¯ Shiro è®¿é®ç¨åºå®å¨ç¸å³æ°æ®ï¼å¦ï¼ç¨æ·ãè§è²ãæéï¼çæ¥å£ã\n\nRealm æ¯æå¼åèèªå·±å®ç°çï¼å¼åèå¯ä»¥éè¿å®ç° Realm æ¥å£ï¼æ¥å¥åºç¨çæ°æ®æºï¼å¦ï¼JDBCãæä»¶ãNosql ç­ç­ã\n\n\n# è®¤è¯ä»¤ç\n\nShiro æ¯æèº«ä»½éªè¯ä»¤çãå¨å¨è¯¢ Realm è¿è¡è®¤è¯å°è¯ä¹åï¼å°è°ç¨å¶æ¯ææ¹æ³ã å¦æè¿åå¼ä¸º trueï¼åä»ä¼è°ç¨å¶ getAuthenticationInfo(token) æ¹æ³ãéå¸¸ï¼Realm ä¼æ£æ¥ææäº¤ä»¤ççç±»åï¼æ¥å£æç±»ï¼ï¼ä»¥æ¥çå¶æ¯å¦å¯ä»¥å¤çå®ã\n\nä»¤çè®¤è¯å¤çæµç¨å¦ä¸ï¼\n\n 1. æ£æ¥ç¨äºæ è¯ principal çä»¤çï¼å¸æ·æ è¯ä¿¡æ¯ï¼ã\n 2. æ ¹æ® principalï¼å¨æ°æ®æºä¸­æ¥æ¾ç¸åºçå¸æ·æ°æ®ã\n 3. ç¡®ä¿ä»¤çæä¾çå­è¯ä¸æ°æ®å­å¨ä¸­å­å¨çå­è¯å¹éã\n 4. å¦æ credentials å¹éï¼åè¿å AuthenticationInfo å®ä¾ã\n 5. å¦æ credentials ä¸å¹éï¼åæåº AuthenticationException å¼å¸¸ã\n\n\n# å å¯\n\néè¿åæï¼å¯ä»¥äºè§£ï¼Shiro éè¦éè¿ä¸å¯¹ principal å credentials æ¥ç¡®è®¤èº«ä»½æ¯å¦å¹éï¼å³è®¤è¯ï¼ã\n\nä¸è¬æ¥è¯´ï¼æçè½¯ä»¶æ¯ä¸åè®¸å­å¨è´¦æ·ãå¯ç è¿äºæææ°æ®æ¶ï¼ä½¿ç¨ææå­å¨ãæä»¥ï¼éå¸¸è¦å°å¯ç å å¯åå­å¨ã\n\nShiro æä¾äºä¸äºå å¯å¨ï¼å¶ææ³å°±æ¯ç¨ MD5ãSHA è¿ç§æ°å­ç­¾åç®æ³ï¼å  Saltï¼ç¶åè½¬ä¸º Base64 å­ç¬¦ä¸²ãä¸ºäºé¿åè¢«æ´åç ´è§£ï¼Shiro ä½¿ç¨å¤æ¬¡å å¯çæ¹å¼è·å¾æç»ç credentials å­ç¬¦ä¸²ã\n\nãç¤ºä¾ãShiro å å¯å¯ç ç¤ºä¾\n\nimport org.apache.shiro.crypto.hash.Sha256Hash;\nimport org.apache.shiro.crypto.RandomNumberGenerator;\nimport org.apache.shiro.crypto.SecureRandomNumberGenerator;\n...\n\n//We\'ll use a Random Number Generator to generate salts.  This\n//is much more secure than using a username as a salt or not\n//having a salt at all.  Shiro makes this easy.\n//\n//Note that a normal app would reference an attribute rather\n//than create a new RNG every time:\nRandomNumberGenerator rng = new SecureRandomNumberGenerator();\nObject salt = rng.nextBytes();\n\n//Now hash the plain-text password with the random salt and multiple\n//iterations and then Base64-encode the value (requires less space than Hex):\nString hashedPasswordBase64 = new Sha256Hash(plainTextPassword, salt, 1024).toBase64();\n\nUser user = new User(username, hashedPasswordBase64);\n//save the salt with the new account.  The HashedCredentialsMatcher\n//will need it later when handling login attempts:\nuser.setPasswordSalt(salt);\nuserDAO.create(user);\n\n\n\n# å­ãéç½®\n\n\n# è¿æ»¤é¾\n\nè¿è¡ Web åºç¨ç¨åºæ¶ï¼Shiro å°åå»ºä¸äºæç¨çé»è®¤ Filter å®ä¾ã\n\nFILTER NAME         CLASS\nanon                org.apache.shiro.web.filter.authc.AnonymousFilter\nauthc               org.apache.shiro.web.filter.authc.FormAuthenticationFilter\nauthcBasic          org.apache.shiro.web.filter.authc.BasicHttpAuthenticationFilter\nlogout              org.apache.shiro.web.filter.authc.LogoutFilter\nnoSessionCreation   org.apache.shiro.web.filter.session.NoSessionCreationFilter\nperms               org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter\nport                org.apache.shiro.web.filter.authz.PortFilter\nrest                org.apache.shiro.web.filter.authz.HttpMethodPermissionFilter\nroles               org.apache.shiro.web.filter.authz.RolesAuthorizationFilter\nssl                 org.apache.shiro.web.filter.authz.SslFilter\nuser                org.apache.shiro.web.filter.authc.UserFilter\n\n\n# RememberMe\n\nUsernamePasswordToken token = new UsernamePasswordToken(username, password);\ntoken.setRememberMe(true);\nSecurityUtils.getSubject().login(token);\n\n\n\n# åèèµæ\n\n * Shiro å®æ¹ææ¡£\n * è·æå­¦ Shiro\n * The New RBAC: Resource-Based Access Control',normalizedContent:'# shiro å¿«éå¥é¨\n\n> shiro æ¯ä¸ä¸ªå®å¨æ¡æ¶ï¼å·æè®¤è¯ãææãå å¯ãä¼è¯ç®¡çåè½ã\n\n\n# ä¸ãshiro ç®ä»\n\n\n# shiro ç¹æ§\n\n\n\næ ¸å¿åè½ï¼\n\n * authentication - è®¤è¯ãéªè¯ç¨æ·æ¯ä¸æ¯æ¥æç¸åºçèº«ä»½ã\n * authorization - ææãéªè¯æä¸ªå·²è®¤è¯çç¨æ·æ¯å¦æ¥ææä¸ªæéï¼å³å¤æ­ç¨æ·æ¯å¦è½åäºæï¼å¸¸è§çå¦ï¼éªè¯æä¸ªç¨æ·æ¯å¦æ¥ææä¸ªè§è²ãæèç»ç²åº¦çéªè¯æä¸ªç¨æ·å¯¹æä¸ªèµæºæ¯å¦å·ææä¸ªæéã\n * session manager - ä¼è¯ç®¡çãå³ç¨æ·ç»å½åå°±æ¯ä¸æ¬¡ä¼è¯ï¼å¨æ²¡æéåºä¹åï¼å®çææä¿¡æ¯é½å¨ä¼è¯ä¸­ãä¼è¯å¯ä»¥æ¯æ®é javase ç¯å¢çï¼ä¹å¯ä»¥æ¯å¦ web ç¯å¢çã\n * cryptography - å å¯ãä¿æ¤æ°æ®çå®å¨æ§ï¼å¦å¯ç å å¯å­å¨å°æ°æ®åºï¼èä¸æ¯ææå­å¨ã\n\nè¾å©åè½ï¼\n\n * web support - web æ¯æãå¯ä»¥éå¸¸å®¹æçéæå° web ç¯å¢ï¼\n * caching - ç¼å­ãæ¯å¦ç¨æ·ç»å½åï¼å¶ç¨æ·ä¿¡æ¯ãæ¥æçè§è² / æéä¸å¿æ¯æ¬¡å»æ¥ï¼è¿æ ·å¯ä»¥æé«æçï¼\n * concurrency - å¹¶åãshiro æ¯æå¤çº¿ç¨åºç¨çå¹¶åéªè¯ï¼å³å¦å¨ä¸ä¸ªçº¿ç¨ä¸­å¼å¯å¦ä¸ä¸ªçº¿ç¨ï¼è½ææéèªå¨ä¼ æ­è¿å»ï¼\n * testing - æµè¯ãæä¾æµè¯æ¯æï¼\n * run as - è¿è¡æ¹å¼ãåè®¸ä¸ä¸ªç¨æ·åè£ä¸ºå¦ä¸ä¸ªç¨æ·ï¼å¦æä»ä»¬åè®¸ï¼çèº«ä»½è¿è¡è®¿é®ï¼\n * remember me - è®°ä½æãå³ä¸æ¬¡ç»å½åï¼ä¸æ¬¡åè®¿é®åç»å½ã\n\n> ð æ³¨æï¼shiro ä¸ä¼å»ç»´æ¤ç¨æ·ãç»´æ¤æéï¼è¿äºéè¦æä»¬èªå·±å»æä¾ï¼ç¶åéè¿ç¸åºçæ¥å£æ³¨å¥ç» shiro å³å¯ã\n\n\n# shiro æ¶ææ¦è¿°\n\n\n\n * subject - ä¸»é¢ãå®ä»£è¡¨å½åç¨æ·ï¼subject å¯ä»¥æ¯ä¸ä¸ªäººï¼ä½ä¹å¯ä»¥æ¯ç¬¬ä¸æ¹æå¡ãå®æ¤è¿ç¨å¸æ·ãæ¶éå®æ¤ä»»å¡æèå¶å®ââå½ååè½¯ä»¶äº¤äºçä»»ä½äºä»¶ãsubject æ¯ shiro çå¥å£ã\n   \n   * principals æ¯ subject çâè¯å«å±æ§âãprincipals å¯ä»¥æ¯ä»»ä½å¯ä»¥è¯å« subject çä¸è¥¿ï¼ä¾å¦åå­ï¼å§æ°ï¼ï¼å§æ°ï¼å§æ°æå§æ°ï¼ï¼ç¨æ·åï¼ç¤¾ä¼ä¿é©å·ç­ãå½ç¶ï¼principals å¨åºç¨ç¨åºä¸­æå¥½æ¯æä¸çã\n   * credentials éå¸¸æ¯ä»ç± subject ç¥éçç§å¯å¼ï¼ç¨ä½ä»ä»¬å®éä¸âæ¥æâæä¸»å¼ èº«ä»½çä½è¯ å­æ®çä¸äºå¸¸è§ç¤ºä¾æ¯å¯ç ï¼çç©ç¹å¾æ°æ®ï¼ä¾å¦æçº¹åè§ç½èæ«æï¼ä»¥å x.509 è¯ä¹¦ã\n\n * securitymanager - å®å¨ç®¡çãå®æ¯ shiro çæ ¸å¿ï¼ææä¸å®å¨æå³çæä½ï¼è®¤è¯ãææãåä¼è¯ãç¼å­çç®¡çï¼é½ä¸ securitymanager äº¤äºï¼ä¸å®ç®¡ççææ subjectã\n\n * realm - åãç¨äºè®¿é®å®å¨ç¸å³æ°æ®ï¼å¯ä»¥è§ä¸ºåºç¨èªèº«çæ°æ®æºï¼éè¦å¼åèèªå·±å®ç°ãshiro ä¼éè¿ realm è·åå®å¨æ°æ®ï¼å¦ç¨æ·ãè§è²ãæéï¼ï¼å°±æ¯è¯´ securitymanager è¦éªè¯ç¨æ·èº«ä»½ï¼é£ä¹å®éè¦ä» realm è·åç¸åºçç¨æ·è¿è¡æ¯è¾ä»¥ç¡®å®ç¨æ·èº«ä»½æ¯å¦åæ³ï¼ä¹éè¦ä» realm å¾å°ç¨æ·ç¸åºçè§è²/æéè¿è¡éªè¯ç¨æ·æ¯å¦è½è¿è¡æä½ï¼å¯ä»¥æ realm çæ datasourceï¼å³å®å¨æ°æ®æºã\n\n\n# securitymanager\n\nsecuritymanager æ¯ shiro æ¡æ¶æ ¸å¿ä¸­çæ ¸å¿ï¼å®ç¸å½äº shiro çæ»ææ¥ï¼è´è´£è°åº¦ææè¡ä¸ºï¼åæ¬ï¼è®¤è¯ãææãè·åå®å¨æ°æ®ï¼è°ç¨ realmï¼ãä¼è¯ç®¡çç­ã\n\n\n\nsecuritymanager èåäºä»¥ä¸ç»ä»¶ï¼\n\n * authenticator - è®¤è¯å¨ï¼è´è´£è®¤è¯ãå¦æç¨æ·éè¦å®å¶è®¤è¯ç­ç¥ï¼å¯ä»¥å®ç°æ­¤æ¥å£ã\n * authorizer - ææå¨ï¼è´è´£æéæ§å¶ãç¨æ¥å³å®ä¸»ä½æ¯å¦ææéè¿è¡ç¸åºçæä½ï¼å³æ§å¶çç¨æ·è½è®¿é®åºç¨ä¸­çåªäºåè½ï¼\n * sessionmanager - ä¼è¯ç®¡çå¨ãshiro æ½è±¡äºä¸ä¸ªèªå·±ç session æ¥ç®¡çä¸»ä½ä¸åºç¨ä¹é´äº¤äºçæ°æ®ã\n * sessiondao - ä¼è¯ dao ç¨äºå­å¨ä¼è¯ï¼éè¦ç¨æ·èªå·±å®ç°ã\n * cachemanager - ç¼å­æ§å¶å¨ãç¨äºç®¡çå¦ç¨æ·ãè§è²ãæéç­ä¿¡æ¯çç¼å­ã\n * cryptography - å¯ç å¨ãç¨äºå¯¹æ°æ®å å¯ãè§£å¯ã\n\n\n# äºãshiro è®¤è¯\n\n\n# è®¤è¯ subject\n\néªè¯ subject çè¿ç¨å¯ä»¥ææå°åä¸ºä¸ä¸ªä¸åçæ­¥éª¤ï¼\n\nï¼1ï¼æ¶é subject æäº¤ç principals å credentials\n\n//example using most common scenario of username/password pair:\nusernamepasswordtoken token = new usernamepasswordtoken(username, password);\n\n//"remember me" built-in:\ntoken.setrememberme(true);\n\n\nï¼2ï¼æäº¤ principals å credentials ä»¥è¿è¡èº«ä»½éªè¯ã\n\nsubject currentuser = securityutils.getsubject();\n\ncurrentuser.login(token);\n\n\nï¼3ï¼å¦ææäº¤æåï¼ååè®¸è®¿é®ï¼å¦åéè¯èº«ä»½éªè¯æé»æ­¢è®¿é®ã\n\ntry {\n    currentuser.login(token);\n} catch ( unknownaccountexception uae ) { ...\n} catch ( incorrectcredentialsexception ice ) { ...\n} catch ( lockedaccountexception lae ) { ...\n} catch ( excessiveattemptsexception eae ) { ...\n} ... catch your own ...\n} catch ( authenticationexception ae ) {\n    //unexpected error?\n}\n\n\n\n# remembered å authenticated\n\n * remembered - è®°ä½æãè¢«è®°ä½ç subject ä¸æ¯å¿åçï¼å¹¶ä¸å·æå·²ç¥çèº«ä»½ï¼å³ subject.getprincipals() æ¯éç©ºçï¼ã ä½æ¯ï¼å¨ååçä¼è¯æé´ï¼éè¿ååçèº«ä»½éªè¯ä¼è®°ä½æ­¤èº«ä»½ã å¦æ subject.isremembered() è¿å trueï¼åè®¤ä¸ºè¯¥ä¸»é¢å·²è¢«è®°ä½ã\n * authenticated - å·²è®¤è¯ãå·²è®¤è¯ç subject æ¯å¨å½åä¼è¯æé´å·²æåè®¤è¯ç subjectã å¦æ subject.isauthenticated() è¿å trueï¼åè®¤ä¸ºè¯¥ subject å·²éè¿èº«ä»½éªè¯ã\n\n\n# ç»åº\n\nå½ subject ä¸åºç¨ç¨åºå®æäº¤äºåï¼å¯ä»¥è°ç¨ subject.logout() ç»åºï¼å³æ¾å¼æææ è¯ä¿¡æ¯ã\n\ncurrentuser.logout();\n\n\n\n# è®¤è¯æµç¨\n\n\n\n 1. åºç¨ç¨åºä»£ç è°ç¨ subject.login æ¹æ³ï¼ä¼ å¥æé ç authenticationtoken å®ä¾ï¼è¯¥å®ä¾ä»£è¡¨æç»ç¨æ·ç principals å credentialsã\n\n 2. subject å®ä¾ï¼éå¸¸æ¯ delegatingsubjectï¼æå­ç±»ï¼ï¼éè¿è°ç¨ securitymanager.loginï¼tokenï¼å§æåºç¨ç¨åºç securitymanagerï¼å¨æ­¤å¤å¼å§å®éçèº«ä»½éªè¯å·¥ä½ã\n\n 3. securitymanager æ¥æ¶ä»¤çï¼å¹¶éè¿è°ç¨ authenticator.authenticateï¼tokenï¼æ¥ç®åå°å§æ´¾ç»å¶åé¨ authenticator å®ä¾ãè¿å ä¹æ»æ¯ä¸ä¸ª modularrealmauthenticator å®ä¾ï¼å®æ¯æå¨èº«ä»½éªè¯æé´åè°ä¸ä¸ªæå¤ä¸ª realm å®ä¾ã\n\n 4. å¦æä¸ºè¯¥åºç¨ç¨åºéç½®äºå¤ä¸ª realmï¼å modularrealmauthenticator å®ä¾å°å©ç¨å¶éç½®ç authenticationstrategy åèµ·å¤åéªè¯å°è¯ãå¨è°ç¨é¢åè¿è¡èº«ä»½éªè¯ä¹åï¼æé´åä¹åï¼å°è°ç¨ authenticationstrategy ä»¥ä½¿å¶å¯¹æ¯ä¸ªé¢åçç»æååºååºã\n\n 5. è¯·å¨è¯¢æ¯ä¸ªå·²éç½®ç realmï¼ä»¥æ¥çå¶æ¯å¦æ¯ææäº¤ç authenticationtokenã å¦ææ¯è¿æ ·ï¼å°ä½¿ç¨æäº¤çä»¤çè°ç¨æ¯æ realm ç getauthenticationinfo æ¹æ³ã getauthenticationinfo æ¹æ³ææå°è¡¨ç¤ºå¯¹è¯¥ç¹å® realm çåä¸ªèº«ä»½éªè¯å°è¯ã\n\n\n# è®¤è¯ç­ç¥\n\nå½ä¸ºä¸ä¸ªåºç¨ç¨åºéç½®ä¸¤ä¸ªæå¤ä¸ªé¢åæ¶ï¼modularrealmauthenticator ä¾èµäºåé¨ authenticationstrategy ç»ä»¶æ¥ç¡®å®è®¤è¯å°è¯æåæå¤±è´¥çæ¡ä»¶ã\n\nä¾å¦ï¼å¦æåªæä¸ä¸ª realm æåå°å¯¹ authenticationtoken è¿è¡èº«ä»½éªè¯ï¼èææå¶ä» realm é½å¤±è´¥äºï¼é£ä¹è¯¥èº«ä»½éªè¯å°è¯æ¯å¦è¢«è§ä¸ºæåï¼è¿æ¯å¿é¡»ææé¢åé½æåè¿è¡èº«ä»½éªè¯æè½å°æ´ä½å°è¯è§ä¸ºæåï¼æèï¼å¦ææä¸ªé¢åæåéè¿èº«ä»½éªè¯ï¼æ¯å¦æå¿è¦è¿ä¸æ­¥å¨è¯¢å¶ä»é¢åï¼ authenticationstrategy æ ¹æ®åºç¨ç¨åºçéæ±ååºéå½çå³å®ã\n\nauthenticationstrategy æ¯æ ç¶æç»ä»¶ï¼å¨å°è¯è¿è¡èº«ä»½éªè¯æ¶ä¼è¢«æ¥è¯¢ 4 æ¬¡ï¼è¿ 4 ç§äº¤äºæéçä»»ä½å¿è¦ç¶æé½å°ä½ä¸ºæ¹æ³åæ°ç»åºï¼ï¼\n\n * å¨ä»»ä½é¢åè¢«è°ç¨ä¹å\n * å¨è°ç¨åä¸ª realm ç getauthenticationinfo æ¹æ³ä¹å\n * å¨è°ç¨åä¸ª realm ç getauthenticationinfo æ¹æ³ä¹å\n * å¨ææé¢åé½è¢«è°ç¨ä¹å\n\nauthenticationstrategy è¿è´è´£æ±æ»æ¯ä¸ªæå realm çç»æï¼å¹¶å°å®ä»¬âæç»âæåä¸ª authenticationinfo è¡¨ç¤ºå½¢å¼ãæç»çèå authenticationinfo å®ä¾æ¯ authenticator å®ä¾è¿åçç»æï¼ä¹æ¯ shiro ç¨æ¥è¡¨ç¤ºä¸»ä½çæç»èº«ä»½ï¼ä¹ç§°ä¸ºå§æäººï¼çä¸è¥¿ã\n\nauthenticationstrategy         æè¿°\natleastonesuccessfulstrategy   åªè¦æä¸ä¸ª realm æåè®¤è¯ï¼åæ´ä¸ªå°è¯é½è¢«è§ä¸ºæåã\nfirstsuccessfulstrategy        ä»ä½¿ç¨ä»ç¬¬ä¸ä¸ªæåéè¿èº«ä»½éªè¯ç realm è¿åçä¿¡æ¯ï¼ææå¶ä» realm å°è¢«å¿½ç¥ã\nallsuccessfulstrategy          åªæææ realm æåè®¤è¯ï¼åæ´ä¸ªå°è¯æè¢«è§ä¸ºæåã\n\n> ð æ´å¤è®¤è¯ç»èå¯ä»¥åèï¼apache shiro authentication\n\n\n# ä¸ãshiro ææ\n\nææï¼ä¹ç§°ä¸ºè®¿é®æ§å¶ï¼æ¯ç®¡çå¯¹èµæºçè®¿é®çè¿ç¨ã æ¢å¥è¯è¯´ï¼æ§å¶è°ææè®¿é®åºç¨ç¨åºä¸­çåå®¹ã\n\n\n# ææåç´ \n\næææä¸ä¸ªæ ¸å¿è¦ç´ ï¼æéãè§è²åç¨æ·ã\n\n# æé\n\næéç¤ºä¾ï¼\n\n * æå¼ä¸ä¸ªæä»¶\n * æ¥ç /user/list web é¡µé¢\n * æ¥è¯¢è®°å½\n * å é¤ä¸æ¡è®°å½\n * ...\n\nå¤§å¤æ°èµæºé½æ¯æä¸è¬ç crud æä½ãé¤æ­¤ä»¥å¤ï¼å¯¹äºä¸äºç¹å®çèµæºï¼ä»»ä½ææä¹çè¡ä¸ºé½æ¯å¯ä»¥çãåºæ¬çè®¾è®¡æè·¯æ¯ï¼æéæ§å¶ï¼è³å°æ¯åºäºèµæºåè¡ä¸ºã\n\n# è§è²\n\nè§è²æ¯ä¸ä¸ªå½åå®ä½ï¼éå¸¸ä»£è¡¨ä¸ç»è¡ä¸ºæèè´£ãè¿äºè¡ä¸ºä¼è½¬åä¸ºï¼è°å¯ä»¥å¨åºç¨ç¨åºä¸­æ§è¡åªäºè¡ä¸ºï¼è°ä¸å¯ä»¥å¨ç¨åºä¸­æ§è¡åªäºè¡ä¸ºï¼\n\nè§è²éå¸¸æ¯åéç»ç¨æ·å¸æ·çï¼å æ­¤éè¿å³èï¼ç¨æ·å¯ä»¥è·å¾èªèº«è§è²æèµäºçæéã\n\n# ç¨æ·\n\nç¨æ·æ¬è´¨ä¸æ¯åºç¨ç¨åºçâç¨æ·âã\n\nç¨æ·ï¼å³ shiro ç subjectï¼éè¿ä¸è§è²æç´æ¥æéçå³èå¨åºç¨ç¨åºä¸­æ§è¡æäºè¡ä¸ºã\n\n\n# åºäºè§è²çææ\n\nå¦ææææ¯åºäºè§è²èµäºæéçæ°æ®æ¨¡åï¼ç¼ç¨æ¨¡å¼å¦ä¸ï¼\n\nãç¤ºä¾ä¸ã\n\nsubject currentuser = securityutils.getsubject();\n\nif (currentuser.hasrole("administrator")) {\n    //show the admin button\n} else {\n    //don\'t show the button?  grey it out?\n}\n\n\nãç¤ºä¾äºã\n\nsubject currentuser = securityutils.getsubject();\n\n// æ£æ¥å½å subject æ¯å¦ææç§æé\n// å¦ææï¼ç´æ¥è·³è¿ï¼å¦ææ²¡æï¼shiro ä¼æåº authorizationexception\ncurrentuser.checkrole("bankteller");\nopenbankaccount();\n\n\n> æç¤ºï¼æ¹å¼äºç¸æ¯æ¹å¼ä¸ï¼ä»£ç æ´ç®æ´\n\n\n# åºäºæéçææ\n\næ´å¥½çææç­ç¥éå¸¸æ¯åºäºæéçææãåºäºæéçææï¼ç±äºå®ååºç¨ç¨åºçåå§åè½ï¼éå¯¹å·ä½èµæºä¸çè¡ä¸ºï¼ç´§å¯ç¸å³ï¼æä»¥åºäºæéçæææºä»£ç ä¼å¨åè½æ´æ¹æ¶åæ­¥æ´æ¹ï¼èä¸æ¯å¨å®å¨ç­ç¥åçæ´æ¹æ¶ï¼ã è¿æå³çä¸ç±»ä¼¼çåºäºè§è²çææä»£ç ç¸æ¯ï¼ä¿®æ¹ä»£ç çå½±åé¢è¦å°å¾å¤ã\n\nãç¤ºä¾ãåºäºå¯¹è±¡çæéæ£æ¥\n\npermission printpermission = new printerpermission("laserjet4400n", "print");\n\nsubject currentuser = securityutils.getsubject();\n\nif (currentuser.ispermitted(printpermission)) {\n    //show the print button\n} else {\n    //don\'t show the button?  grey it out?\n}\n\n\nå¨å¯¹è±¡ä¸­å­å¨æéæ§å¶ä¿¡æ¯ï¼ä½è¿ç§æ¹å¼è¾ä¸ºç¹é\n\nãç¤ºä¾ãå­ç¬¦ä¸²å®ä¹æéæ§å¶ä¿¡æ¯\n\nsubject currentuser = securityutils.getsubject();\n\nif (currentuser.ispermitted("printer:print:laserjet4400n")) {\n    //show the print button\n} else {\n    //don\'t show the button?  grey it out?\n}\n\n\nä½¿ç¨ : åéï¼è¡¨ç¤ºèµæºç±»åãè¡ä¸ºãèµæº idï¼shiro æä¾äºé»è®¤å®ç°ï¼ org.apache.shiro.authz.permission.wildcardpermissionã\n\nè¿ç§æéæ§å¶æ¹å¼çå¥½å¤å¨äºï¼è½»éãçµæ´»ã\n\n\n# åºäºæ³¨è§£çææ\n\nshiro æä¾äºä¸äºç¨äºææçæ³¨è§£ï¼æ¥è¿ä¸æ­¥ç®åææä»£ç ã\n\n# @requiresauthentication\n\n@requiresauthentication æ³¨è§£è¦æ±å½å subject å¿é¡»æ¯å·²è®¤è¯ç¨æ·æå¯ä»¥è®¿é®è¢«ä¿®é¥°çæ¹æ³ã\n\nãç¤ºä¾ã\n\n@requiresauthentication\npublic void updateaccount(account useraccount) {\n    //this method will only be invoked by a\n    //subject that is guaranteed authenticated\n    ...\n}\n\n\n# @requiresguest\n\n@requiresguest æ³¨è§£è¦æ±å½å subject çè§è²æ¯ guest æå¯ä»¥è®¿é®è¢«ä¿®é¥°çæ¹æ³ã\n\n\n# æææµç¨\n\n\n\n 1. åºç¨ç¨åºææ¡æ¶ä»£ç è°ç¨ä»»ä½ subject ç hasrole*ï¼checkrole*ï¼ispermitted* æ checkpermission* æ¹æ³ï¼å¹¶ä¼ å¥æéçæéæè§è²ã\n\n 2. subject å®ä¾ï¼éå¸¸æ¯ delegatingsubjectï¼æå­ç±»ï¼ï¼éè¿è°ç¨ securitymanager å ä¹ç¸åçåèª hasrole*ï¼checkrole*ï¼ispermitted* æ checkpermission* æ¹æ³æ¥å§æ securitymanager ï¼å®ç°äº org.apache.shiro.authz.authorizer æ¥å£ï¼å¤çææã\n\n 3. securitymanager éè¿è°ç¨ææèåèªç hasrole*ï¼checkrole*ï¼ispermitted* æ checkpermission* æ¹æ³æ¥ä¸­ç»§/å§æå¶åé¨ç org.apache.shiro.authz.authorizer å®ä¾ãé»è®¤æåµä¸ï¼authorizer å®ä¾æ¯ modularrealmauthorizer å®ä¾ï¼è¯¥å®ä¾æ¯æå¨ä»»ä½æææä½æé´åè°ä¸ä¸ªæå¤ä¸ª realm å®ä¾ã\n\n 4. æ£æ¥æ¯ä¸ªå·²éç½®ç realmï¼ä»¥æ¥çå¶æ¯å¦å®ç°ç¸åç authorizer æ¥å£ãå¦ææ¯è¿æ ·ï¼åå°è°ç¨ realm åèªç hasrole*ï¼checkrole*ï¼ispermitted* æ checkpermission* æ¹æ³ã\n\n> ð æ´å¤ææç»èå¯ä»¥åèï¼apache shiro authorization\n\n\n# åãshiro ä¼è¯ç®¡ç\n\nshiro æä¾äºä¸å¥ç¬ç¹çä¼è¯ç®¡çæ¹æ¡ï¼å¶ session å¯ä»¥ä½¿ç¨ java se ç¨åºï¼ä¹å¯ä»¥ä½¿ç¨äº java web ç¨åºã\n\nå¨ shiro ä¸­ï¼sessionmanager è´è´£ç®¡çåºç¨ææ subject çä¼è¯ï¼å¦ï¼åå»ºãå é¤ãå¤±æãéªè¯ç­ã\n\nãç¤ºä¾ãä¼è¯ä½¿ç¨ç¤ºä¾\n\nsubject currentuser = securityutils.getsubject();\n\nsession session = currentuser.getsession();\nsession.setattribute( "somekey", somevalue);\n\n\n\n# ä¼è¯è¶æ¶\n\né»è®¤æåµä¸ï¼shiro ä¸­çä¼è¯æææä¸º 30 åéï¼è¶æ¶åï¼è¯¥ä¼è¯å°è¢« shiro è§ä¸ºæ æã\n\nå¯ä»¥éè¿ globalsessiontimeout æ¹æ³è®¾ç½® shiro ä¼è¯è¶æ¶æ¶é´ã\n\n\n# ä¼è¯çå¬\n\nshiro æä¾äº sessionlistener æ¥å£ï¼æ sessionlisteneradapter æ¥å£ï¼ï¼ç¨äºçå¬éè¦çä¼è¯äºä»¶ï¼å¹¶åè®¸ä½¿ç¨èå¨äºä»¶è§¦åæ¶åå®å¶åå¤çã\n\nãç¤ºä¾ã\n\npublic class shirosessionlistener implements sessionlistener {\n\n    private final logger log = loggerfactory.getlogger(this.getclass());\n\n    private final atomicinteger sessioncount = new atomicinteger(0);\n\n    @override\n    public void onstart(session session) {\n        sessioncount.incrementandget();\n    }\n\n    @override\n    public void onstop(session session) {\n        sessioncount.decrementandget();\n    }\n\n    @override\n    public void onexpiration(session session) {\n        sessioncount.decrementandget();\n    }\n}\n\n\n\n# ä¼è¯å­å¨\n\nå¤§å¤æ°æåµä¸ï¼åºç¨éè¦ä¿å­ä¼è¯ä¿¡æ¯ï¼ä»¥ä¾¿å¨ç¨åå¯ä»¥ä½¿ç¨å®ã\n\nshiro æä¾äº sessionmanager æ¥å£ï¼è´è´£å°éå¯¹ä¼è¯ç crud æä½å§æ´¾ç»åé¨ç»ä»¶ sessiondaoï¼è¯¥ç»ä»¶åæ äºæ°æ®è®¿é®å¯¹è±¡ï¼daoï¼è®¾è®¡æ¨¡å¼ã\n\n> ð æ³¨æï¼ç±äºä¼è¯éå¸¸å·ææ¶ææ§ï¼æä»¥ä¸è¬ä¼è¯å¤©ç¶éåå­å¨äºç¼å­ä¸­ãå­å¨äº redis ä¸­æ¯ä¸ä¸ªä¸éçéæ©ã\n\n\n# äºãrealm\n\nrealm æ¯ shiro è®¿é®ç¨åºå®å¨ç¸å³æ°æ®ï¼å¦ï¼ç¨æ·ãè§è²ãæéï¼çæ¥å£ã\n\nrealm æ¯æå¼åèèªå·±å®ç°çï¼å¼åèå¯ä»¥éè¿å®ç° realm æ¥å£ï¼æ¥å¥åºç¨çæ°æ®æºï¼å¦ï¼jdbcãæä»¶ãnosql ç­ç­ã\n\n\n# è®¤è¯ä»¤ç\n\nshiro æ¯æèº«ä»½éªè¯ä»¤çãå¨å¨è¯¢ realm è¿è¡è®¤è¯å°è¯ä¹åï¼å°è°ç¨å¶æ¯ææ¹æ³ã å¦æè¿åå¼ä¸º trueï¼åä»ä¼è°ç¨å¶ getauthenticationinfo(token) æ¹æ³ãéå¸¸ï¼realm ä¼æ£æ¥ææäº¤ä»¤ççç±»åï¼æ¥å£æç±»ï¼ï¼ä»¥æ¥çå¶æ¯å¦å¯ä»¥å¤çå®ã\n\nä»¤çè®¤è¯å¤çæµç¨å¦ä¸ï¼\n\n 1. æ£æ¥ç¨äºæ è¯ principal çä»¤çï¼å¸æ·æ è¯ä¿¡æ¯ï¼ã\n 2. æ ¹æ® principalï¼å¨æ°æ®æºä¸­æ¥æ¾ç¸åºçå¸æ·æ°æ®ã\n 3. ç¡®ä¿ä»¤çæä¾çå­è¯ä¸æ°æ®å­å¨ä¸­å­å¨çå­è¯å¹éã\n 4. å¦æ credentials å¹éï¼åè¿å authenticationinfo å®ä¾ã\n 5. å¦æ credentials ä¸å¹éï¼åæåº authenticationexception å¼å¸¸ã\n\n\n# å å¯\n\néè¿åæï¼å¯ä»¥äºè§£ï¼shiro éè¦éè¿ä¸å¯¹ principal å credentials æ¥ç¡®è®¤èº«ä»½æ¯å¦å¹éï¼å³è®¤è¯ï¼ã\n\nä¸è¬æ¥è¯´ï¼æçè½¯ä»¶æ¯ä¸åè®¸å­å¨è´¦æ·ãå¯ç è¿äºæææ°æ®æ¶ï¼ä½¿ç¨ææå­å¨ãæä»¥ï¼éå¸¸è¦å°å¯ç å å¯åå­å¨ã\n\nshiro æä¾äºä¸äºå å¯å¨ï¼å¶ææ³å°±æ¯ç¨ md5ãsha è¿ç§æ°å­ç­¾åç®æ³ï¼å  saltï¼ç¶åè½¬ä¸º base64 å­ç¬¦ä¸²ãä¸ºäºé¿åè¢«æ´åç ´è§£ï¼shiro ä½¿ç¨å¤æ¬¡å å¯çæ¹å¼è·å¾æç»ç credentials å­ç¬¦ä¸²ã\n\nãç¤ºä¾ãshiro å å¯å¯ç ç¤ºä¾\n\nimport org.apache.shiro.crypto.hash.sha256hash;\nimport org.apache.shiro.crypto.randomnumbergenerator;\nimport org.apache.shiro.crypto.securerandomnumbergenerator;\n...\n\n//we\'ll use a random number generator to generate salts.  this\n//is much more secure than using a username as a salt or not\n//having a salt at all.  shiro makes this easy.\n//\n//note that a normal app would reference an attribute rather\n//than create a new rng every time:\nrandomnumbergenerator rng = new securerandomnumbergenerator();\nobject salt = rng.nextbytes();\n\n//now hash the plain-text password with the random salt and multiple\n//iterations and then base64-encode the value (requires less space than hex):\nstring hashedpasswordbase64 = new sha256hash(plaintextpassword, salt, 1024).tobase64();\n\nuser user = new user(username, hashedpasswordbase64);\n//save the salt with the new account.  the hashedcredentialsmatcher\n//will need it later when handling login attempts:\nuser.setpasswordsalt(salt);\nuserdao.create(user);\n\n\n\n# å­ãéç½®\n\n\n# è¿æ»¤é¾\n\nè¿è¡ web åºç¨ç¨åºæ¶ï¼shiro å°åå»ºä¸äºæç¨çé»è®¤ filter å®ä¾ã\n\nfilter name         class\nanon                org.apache.shiro.web.filter.authc.anonymousfilter\nauthc               org.apache.shiro.web.filter.authc.formauthenticationfilter\nauthcbasic          org.apache.shiro.web.filter.authc.basichttpauthenticationfilter\nlogout              org.apache.shiro.web.filter.authc.logoutfilter\nnosessioncreation   org.apache.shiro.web.filter.session.nosessioncreationfilter\nperms               org.apache.shiro.web.filter.authz.permissionsauthorizationfilter\nport                org.apache.shiro.web.filter.authz.portfilter\nrest                org.apache.shiro.web.filter.authz.httpmethodpermissionfilter\nroles               org.apache.shiro.web.filter.authz.rolesauthorizationfilter\nssl                 org.apache.shiro.web.filter.authz.sslfilter\nuser                org.apache.shiro.web.filter.authc.userfilter\n\n\n# rememberme\n\nusernamepasswordtoken token = new usernamepasswordtoken(username, password);\ntoken.setrememberme(true);\nsecurityutils.getsubject().login(token);\n\n\n\n# åèèµæ\n\n * shiro å®æ¹ææ¡£\n * è·æå­¦ shiro\n * the new rbac: resource-based access control',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Spring Security å¿«éå¥é¨",frontmatter:{title:"Spring Security å¿«éå¥é¨",categories:["ç¼ç¨","Java","æ¡æ¶","å®å¨"],tags:["Java","æ¡æ¶","å®å¨","SpringSecurity"],abbrlink:"a750524a",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/a6cc5f/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/12.%E5%AE%89%E5%85%A8/02.SpringSecurity.html",relativePath:"13.æ¡æ¶/12.å®å¨/02.SpringSecurity.md",key:"v-1fe197ae",path:"/pages/a6cc5f/",headers:[{level:2,title:"å¿«éå¼å§",slug:"å¿«éå¼å§",normalizedTitle:"å¿«éå¼å§",charIndex:27},{level:2,title:"æ ¸å¿ API",slug:"æ ¸å¿-api",normalizedTitle:"æ ¸å¿ api",charIndex:67},{level:2,title:"è®¾è®¡åç",slug:"è®¾è®¡åç",normalizedTitle:"è®¾è®¡åç",charIndex:78},{level:2,title:"è®¤è¯",slug:"è®¤è¯",normalizedTitle:"è®¤è¯",charIndex:1374},{level:3,title:"æ°æ®æ¨¡å",slug:"æ°æ®æ¨¡å",normalizedTitle:"æ°æ®æ¨¡å",charIndex:1381},{level:3,title:"è®¤è¯åºæ¬æµç¨",slug:"è®¤è¯åºæ¬æµç¨",normalizedTitle:"è®¤è¯åºæ¬æµç¨",charIndex:1968},{level:3,title:"ç¨æ·å/å¯ç è®¤è¯",slug:"ç¨æ·å-å¯ç è®¤è¯",normalizedTitle:"ç¨æ·å/å¯ç è®¤è¯",charIndex:2894},{level:4,title:"è¡¨åè®¤è¯",slug:"è¡¨åè®¤è¯",normalizedTitle:"è¡¨åè®¤è¯",charIndex:2994},{level:4,title:"åºæ¬è®¤è¯",slug:"åºæ¬è®¤è¯",normalizedTitle:"åºæ¬è®¤è¯",charIndex:2927},{level:4,title:"åå­è®¤è¯",slug:"åå­è®¤è¯",normalizedTitle:"åå­è®¤è¯",charIndex:3231},{level:4,title:"JDBC è®¤è¯",slug:"jdbc-è®¤è¯",normalizedTitle:"jdbc è®¤è¯",charIndex:3823},{level:4,title:"UserDetailsService",slug:"userdetailsservice",normalizedTitle:"userdetailsservice",charIndex:2964},{level:4,title:"PasswordEncoder",slug:"passwordencoder",normalizedTitle:"passwordencoder",charIndex:3480},{level:3,title:"Remember-Me",slug:"remember-me",normalizedTitle:"remember-me",charIndex:5442},{level:2,title:"Spring Boot éæ",slug:"spring-boot-éæ",normalizedTitle:"spring boot éæ",charIndex:5458},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:5759}],headersStr:"å¿«éå¼å§ æ ¸å¿ API è®¾è®¡åç è®¤è¯ æ°æ®æ¨¡å è®¤è¯åºæ¬æµç¨ ç¨æ·å/å¯ç è®¤è¯ è¡¨åè®¤è¯ åºæ¬è®¤è¯ åå­è®¤è¯ JDBC è®¤è¯ UserDetailsService PasswordEncoder Remember-Me Spring Boot éæ åèèµæ",content:'# Spring Security å¿«éå¥é¨\n\n\n# å¿«éå¼å§\n\nåèï¼Securing a Web Application\n\n\n# æ ¸å¿ API\n\n\n# è®¾è®¡åç\n\nSpring Security å¯¹äº Servlet çæ¯æåºäºè¿æ»¤é¾ï¼FilterChainï¼å®ç°ã\n\nSpring æä¾äºä¸ä¸ªåä¸º DelegatingFilterProxy ç Filter å®ç°ï¼è¯¥å®ç°åè®¸å¨ Servlet å®¹å¨ççå½å¨æå Spring ç ApplicationContext ä¹é´è¿è¡æ¡¥æ¥ã Servlet å®¹å¨åè®¸ä½¿ç¨å¶èªå·±çæ åæ³¨å Filtersï¼ä½å®ä¸äºè§£ Spring å®ä¹ç Beanã DelegatingFilterProxy å¯ä»¥éè¿æ åç Servlet å®¹å¨æºå¶è¿è¡æ³¨åï¼ä½æ¯å¯ä»¥å°ææå·¥ä½å§æç»å®ç° Filter ç Spring Beanã\n\npublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) {\n    // Lazily get Filter that was registered as a Spring Bean\n    // For the example in DelegatingFilterProxy delegate is an instance of Bean Filter0\n    Filter delegate = getFilterBean(someBeanName);\n    // delegate work to the Spring Bean\n    delegate.doFilter(request, response);\n}\n\n\nFilterChainProxy ä½¿ç¨ SecurityFilterChain ç¡®å®åºå¯¹æ­¤è¯·æ±è°ç¨åªäº Spring Security è¿æ»¤å¨ã\n\nSecurityFilterChain ä¸­çå®å¨è¿æ»¤å¨éå¸¸æ¯ Beanï¼ä½å®ä»¬æ¯ä½¿ç¨ FilterChainProxy èä¸æ¯ DelegatingFilterProxy æ³¨åçã\n\nå®éä¸ï¼FilterChainProxy å¯ç¨äºç¡®å®åºä½¿ç¨åªä¸ª SecurityFilterChainãå¦ææ¨çåºç¨ç¨åºå¯ä»¥ä¸ºä¸åçæ¨¡åæä¾å®å¨ç¬ç«çéç½®ã\n\n\n\nExceptionTranslationFilter å¯ä»¥å° AccessDeniedException å AuthenticationException è½¬æ¢ä¸º HTTP ååºã\n\n\n\næ ¸å¿æºç ï¼\n\ntry {\n    filterChain.doFilter(request, response);\n} catch (AccessDeniedException | AuthenticationException e) {\n    if (!authenticated || e instanceof AuthenticationException) {\n        startAuthentication();\n    } else {\n        accessDenied();\n    }\n}\n\n\n\n# è®¤è¯\n\n\n# æ°æ®æ¨¡å\n\nSpring Security æ¡æ¶ä¸­çè®¤è¯æ°æ®æ¨¡åå¦ä¸ï¼\n\n\n\n * Authentication - è®¤è¯ä¿¡æ¯å®ä½ã\n   * principal - ç¨æ·æ è¯ãå¦ï¼ç¨æ·åãè´¦æ·åç­ãéå¸¸æ¯ UserDetails çå®ä¾ï¼åé¢è¯¦ç»è®²è§£ï¼ã\n   * credentials - è®¤è¯å­è¯ãå¦ï¼å¯ç ç­ã\n   * authorities - ææä¿¡æ¯ãå¦ï¼ç¨æ·çè§è²ãæéç­ä¿¡æ¯ã\n * SecurityContext - å®å¨ä¸ä¸æãåå«ä¸ä¸ª Authentication å¯¹è±¡ã\n * SecurityContextHolder - å®å¨ä¸ä¸æææèãç¨äºå­å¨è®¤è¯ä¿¡æ¯ã\n\nãç¤ºä¾ãæ³¨åè®¤è¯ä¿¡æ¯\n\nSecurityContext context = SecurityContextHolder.createEmptyContext();\nAuthentication authentication =\n    new TestingAuthenticationToken("username", "password", "ROLE_USER");\ncontext.setAuthentication(authentication);\nSecurityContextHolder.setContext(context);\n\n\nãç¤ºä¾ãè®¿é®è®¤è¯ä¿¡æ¯\n\n\n# è®¤è¯åºæ¬æµç¨\n\nAbstractAuthenticationProcessingFilter ç¨ä½éªè¯ç¨æ·å­æ®çåºæ¬è¿æ»¤å¨ã å¨å¯¹å­è¯è¿è¡èº«ä»½éªè¯ä¹åï¼Spring Security éå¸¸ä½¿ç¨ AuthenticationEntryPoint è¯·æ±å­è¯ã\n\n\n\n * ï¼1ï¼å½ç¨æ·æäº¤å¶å­æ®æ¶ï¼AbstractAuthenticationProcessingFilter ä»è¦éªè¯ç HttpServletRequest åå»ºä¸ä¸ª Authenticationãåå»ºçèº«ä»½éªè¯ç±»ååå³äº AbstractAuthenticationProcessingFilter çå­ç±»ãä¾å¦ï¼UsernamePasswordAuthenticationFilter æ ¹æ®å¨ HttpServletRequest ä¸­æäº¤çç¨æ·ååå¯ç æ¥åå»º UsernamePasswordAuthenticationTokenã\n * ï¼2ï¼æ¥ä¸æ¥ï¼å°èº«ä»½éªè¯ä¼ éå° AuthenticationManager è¿è¡èº«ä»½éªè¯ã\n * ï¼3ï¼å¦æèº«ä»½éªè¯å¤±è´¥ï¼åè®¤è¯å¤±è´¥\n   * æ¸é¤ SecurityContextHolderã\n   * è°ç¨ RememberMeServices.loginFailãå¦ææ²¡æéç½® remember meï¼åä¸ºç©ºã\n   * è°ç¨ AuthenticationFailureHandlerã\n * ï¼4ï¼å¦æèº«ä»½éªè¯æåï¼åè®¤è¯æåã\n   * å¦ææ¯æ°çç»å½ï¼åéç¥ SessionAuthenticationStrategyã\n   * èº«ä»½éªè¯æ¯å¨ SecurityContextHolder ä¸è®¾ç½®çãä¹åï¼SecurityContextPersistenceFilter å° SecurityContext ä¿å­å° HttpSession ä¸­ã\n   * è°ç¨ RememberMeServices.loginSuccessãå¦ææ²¡æéç½® remember meï¼åä¸ºç©ºã\n   * ApplicationEventPublisher åå¸ä¸ä¸ª InteractiveAuthenticationSuccessEventã\n\n\n# ç¨æ·å/å¯ç è®¤è¯\n\nè¯»åç¨æ·ååå¯ç çæ¹å¼ï¼\n\n * è¡¨å\n * åºæ¬è®¤è¯\n * æ°å­è®¤è¯\n\nå­å¨æºå¶\n\n * åå­\n * JDBC\n * UserDetailsService\n * LDAP\n\n# è¡¨åè®¤è¯\n\nspring security æ¯æéè¿ä» html è¡¨åè·åç»å½æ¶æäº¤çç¨æ·åãå¯ç ã\n\n\n\nä¸æ¦ï¼ç»å½ä¿¡æ¯è¢«æäº¤ï¼UsernamePasswordAuthenticationFilter å°±ä¼éªè¯ç¨æ·ååå¯ç ã\n\n\n\n# åºæ¬è®¤è¯\n\nprotected void configure(HttpSecurity http) {\n    http\n        // ...\n        .httpBasic(withDefaults());\n}\n\n\n# åå­è®¤è¯\n\nInMemoryUserDetailsManager å®ç°äº UserDetailsService ï¼æä¾äºåºæ¬çç¨æ·åãå¯ç è®¤è¯ï¼å¶è®¤è¯æ°æ®å­å¨å¨åå­ä¸­ã\n\n@Bean\npublic UserDetailsService users() {\n    // The builder will ensure the passwords are encoded before saving in memory\n    UserBuilder users = User.withDefaultPasswordEncoder();\n    UserDetails user = users\n        .username("user")\n        .password("password")\n        .roles("USER")\n        .build();\n    UserDetails user = users\n        .username("admin")\n        .password("password")\n        .roles("USER", "ADMIN")\n        .build();\n    return new InMemoryUserDetailsManager(user, admin);\n}\n\n\n# JDBC è®¤è¯\n\nJdbcUserDetailsManager å®ç°äº UserDetailsService ï¼æä¾äºåºæ¬çç¨æ·åãå¯ç è®¤è¯ï¼å¶è®¤è¯æ°æ®å­å¨å¨å³ç³»åæ°æ®åºä¸­ï¼éè¿ JDBC æ¹å¼è®¿é®ã\n\n@Bean\nUserDetailsManager users(DataSource dataSource) {\n    UserDetails user = User.builder()\n        .username("user")\n        .password("{bcrypt}$2a$10$GRLdNijSQMUvl/au9ofL.eDwmoohzzS7.rmNSJZ.0FxO/BTk76klW")\n        .roles("USER")\n        .build();\n    UserDetails admin = User.builder()\n        .username("admin")\n        .password("{bcrypt}$2a$10$GRLdNijSQMUvl/au9ofL.eDwmoohzzS7.rmNSJZ.0FxO/BTk76klW")\n        .roles("USER", "ADMIN")\n        .build();\n    JdbcUserDetailsManager users = new JdbcUserDetailsManager(dataSource);\n    users.createUser()\n}\n\n\nåºæ¬ç scheamï¼\n\ncreate table users(\n    username varchar_ignorecase(50) not null primary key,\n    password varchar_ignorecase(50) not null,\n    enabled boolean not null\n);\n\ncreate table authorities (\n    username varchar_ignorecase(50) not null,\n    authority varchar_ignorecase(50) not null,\n    constraint fk_authorities_users foreign key(username) references users(username)\n);\ncreate unique index ix_auth_username on authorities (username,authority);\n\n\n# UserDetailsService\n\nUserDetails ç± UserDetailsService è¿åã DaoAuthenticationProvider éªè¯ UserDetailsï¼ç¶åè¿åèº«ä»½éªè¯ï¼è¯¥èº«ä»½éªè¯çä¸»ä½æ¯å·²éç½®ç UserDetailsService è¿åç UserDetailsã\n\nDaoAuthenticationProvider ä½¿ç¨ UserDetailsService æ£ç´¢ç¨æ·åï¼å¯ç åå¶ä»ç¨äºä½¿ç¨ç¨æ·ååå¯ç è¿è¡èº«ä»½éªè¯çå±æ§ã Spring Security æä¾ UserDetailsService çåå­ä¸­å JDBC å®ç°ã\n\næ¨å¯ä»¥éè¿å°èªå®ä¹ UserDetailsService å¬å¼ä¸º bean æ¥å®ä¹èªå®ä¹èº«ä»½éªè¯ã\n\n# PasswordEncoder\n\nSpring Security ç servlet æ¯æéè¿ä¸ PasswordEncoder éææ¥å®å¨å°å­å¨å¯ç ã å¯ä»¥éè¿å¬å¼ä¸ä¸ª PasswordEncoder Bean æ¥å®å¶ Spring Security ä½¿ç¨ç PasswordEncoder å®ç°ã\n\n\n\n\n# Remember-Me\n\n\n# Spring Boot éæ\n\n@EnableWebSecurity å @Configuration æ³¨è§£ä¸èµ·ä½¿ç¨, æ³¨è§£ WebSecurityConfigurer ç±»åçç±»ã\n\næèå©ç¨@EnableWebSecurityæ³¨è§£ç»§æ¿ WebSecurityConfigurerAdapter çç±»ï¼è¿æ ·å°±ææäº Spring Security çéç½®ã\n\n * configure(WebSecurity)ï¼éè¿éè½½è¯¥æ¹æ³ï¼å¯éç½® Spring Security ç Filter é¾ã\n * configure(HttpSecurity)ï¼éè¿éè½½è¯¥æ¹æ³ï¼å¯éç½®å¦ä½éè¿æ¦æªå¨ä¿æ¤è¯·æ±ã\n\n\n# åèèµæ\n\n * Spring Security Architecture\n * Securing a Web Application',normalizedContent:'# spring security å¿«éå¥é¨\n\n\n# å¿«éå¼å§\n\nåèï¼securing a web application\n\n\n# æ ¸å¿ api\n\n\n# è®¾è®¡åç\n\nspring security å¯¹äº servlet çæ¯æåºäºè¿æ»¤é¾ï¼filterchainï¼å®ç°ã\n\nspring æä¾äºä¸ä¸ªåä¸º delegatingfilterproxy ç filter å®ç°ï¼è¯¥å®ç°åè®¸å¨ servlet å®¹å¨ççå½å¨æå spring ç applicationcontext ä¹é´è¿è¡æ¡¥æ¥ã servlet å®¹å¨åè®¸ä½¿ç¨å¶èªå·±çæ åæ³¨å filtersï¼ä½å®ä¸äºè§£ spring å®ä¹ç beanã delegatingfilterproxy å¯ä»¥éè¿æ åç servlet å®¹å¨æºå¶è¿è¡æ³¨åï¼ä½æ¯å¯ä»¥å°ææå·¥ä½å§æç»å®ç° filter ç spring beanã\n\npublic void dofilter(servletrequest request, servletresponse response, filterchain chain) {\n    // lazily get filter that was registered as a spring bean\n    // for the example in delegatingfilterproxy delegate is an instance of bean filter0\n    filter delegate = getfilterbean(somebeanname);\n    // delegate work to the spring bean\n    delegate.dofilter(request, response);\n}\n\n\nfilterchainproxy ä½¿ç¨ securityfilterchain ç¡®å®åºå¯¹æ­¤è¯·æ±è°ç¨åªäº spring security è¿æ»¤å¨ã\n\nsecurityfilterchain ä¸­çå®å¨è¿æ»¤å¨éå¸¸æ¯ beanï¼ä½å®ä»¬æ¯ä½¿ç¨ filterchainproxy èä¸æ¯ delegatingfilterproxy æ³¨åçã\n\nå®éä¸ï¼filterchainproxy å¯ç¨äºç¡®å®åºä½¿ç¨åªä¸ª securityfilterchainãå¦ææ¨çåºç¨ç¨åºå¯ä»¥ä¸ºä¸åçæ¨¡åæä¾å®å¨ç¬ç«çéç½®ã\n\n\n\nexceptiontranslationfilter å¯ä»¥å° accessdeniedexception å authenticationexception è½¬æ¢ä¸º http ååºã\n\n\n\næ ¸å¿æºç ï¼\n\ntry {\n    filterchain.dofilter(request, response);\n} catch (accessdeniedexception | authenticationexception e) {\n    if (!authenticated || e instanceof authenticationexception) {\n        startauthentication();\n    } else {\n        accessdenied();\n    }\n}\n\n\n\n# è®¤è¯\n\n\n# æ°æ®æ¨¡å\n\nspring security æ¡æ¶ä¸­çè®¤è¯æ°æ®æ¨¡åå¦ä¸ï¼\n\n\n\n * authentication - è®¤è¯ä¿¡æ¯å®ä½ã\n   * principal - ç¨æ·æ è¯ãå¦ï¼ç¨æ·åãè´¦æ·åç­ãéå¸¸æ¯ userdetails çå®ä¾ï¼åé¢è¯¦ç»è®²è§£ï¼ã\n   * credentials - è®¤è¯å­è¯ãå¦ï¼å¯ç ç­ã\n   * authorities - ææä¿¡æ¯ãå¦ï¼ç¨æ·çè§è²ãæéç­ä¿¡æ¯ã\n * securitycontext - å®å¨ä¸ä¸æãåå«ä¸ä¸ª authentication å¯¹è±¡ã\n * securitycontextholder - å®å¨ä¸ä¸æææèãç¨äºå­å¨è®¤è¯ä¿¡æ¯ã\n\nãç¤ºä¾ãæ³¨åè®¤è¯ä¿¡æ¯\n\nsecuritycontext context = securitycontextholder.createemptycontext();\nauthentication authentication =\n    new testingauthenticationtoken("username", "password", "role_user");\ncontext.setauthentication(authentication);\nsecuritycontextholder.setcontext(context);\n\n\nãç¤ºä¾ãè®¿é®è®¤è¯ä¿¡æ¯\n\n\n# è®¤è¯åºæ¬æµç¨\n\nabstractauthenticationprocessingfilter ç¨ä½éªè¯ç¨æ·å­æ®çåºæ¬è¿æ»¤å¨ã å¨å¯¹å­è¯è¿è¡èº«ä»½éªè¯ä¹åï¼spring security éå¸¸ä½¿ç¨ authenticationentrypoint è¯·æ±å­è¯ã\n\n\n\n * ï¼1ï¼å½ç¨æ·æäº¤å¶å­æ®æ¶ï¼abstractauthenticationprocessingfilter ä»è¦éªè¯ç httpservletrequest åå»ºä¸ä¸ª authenticationãåå»ºçèº«ä»½éªè¯ç±»ååå³äº abstractauthenticationprocessingfilter çå­ç±»ãä¾å¦ï¼usernamepasswordauthenticationfilter æ ¹æ®å¨ httpservletrequest ä¸­æäº¤çç¨æ·ååå¯ç æ¥åå»º usernamepasswordauthenticationtokenã\n * ï¼2ï¼æ¥ä¸æ¥ï¼å°èº«ä»½éªè¯ä¼ éå° authenticationmanager è¿è¡èº«ä»½éªè¯ã\n * ï¼3ï¼å¦æèº«ä»½éªè¯å¤±è´¥ï¼åè®¤è¯å¤±è´¥\n   * æ¸é¤ securitycontextholderã\n   * è°ç¨ remembermeservices.loginfailãå¦ææ²¡æéç½® remember meï¼åä¸ºç©ºã\n   * è°ç¨ authenticationfailurehandlerã\n * ï¼4ï¼å¦æèº«ä»½éªè¯æåï¼åè®¤è¯æåã\n   * å¦ææ¯æ°çç»å½ï¼åéç¥ sessionauthenticationstrategyã\n   * èº«ä»½éªè¯æ¯å¨ securitycontextholder ä¸è®¾ç½®çãä¹åï¼securitycontextpersistencefilter å° securitycontext ä¿å­å° httpsession ä¸­ã\n   * è°ç¨ remembermeservices.loginsuccessãå¦ææ²¡æéç½® remember meï¼åä¸ºç©ºã\n   * applicationeventpublisher åå¸ä¸ä¸ª interactiveauthenticationsuccesseventã\n\n\n# ç¨æ·å/å¯ç è®¤è¯\n\nè¯»åç¨æ·ååå¯ç çæ¹å¼ï¼\n\n * è¡¨å\n * åºæ¬è®¤è¯\n * æ°å­è®¤è¯\n\nå­å¨æºå¶\n\n * åå­\n * jdbc\n * userdetailsservice\n * ldap\n\n# è¡¨åè®¤è¯\n\nspring security æ¯æéè¿ä» html è¡¨åè·åç»å½æ¶æäº¤çç¨æ·åãå¯ç ã\n\n\n\nä¸æ¦ï¼ç»å½ä¿¡æ¯è¢«æäº¤ï¼usernamepasswordauthenticationfilter å°±ä¼éªè¯ç¨æ·ååå¯ç ã\n\n\n\n# åºæ¬è®¤è¯\n\nprotected void configure(httpsecurity http) {\n    http\n        // ...\n        .httpbasic(withdefaults());\n}\n\n\n# åå­è®¤è¯\n\ninmemoryuserdetailsmanager å®ç°äº userdetailsservice ï¼æä¾äºåºæ¬çç¨æ·åãå¯ç è®¤è¯ï¼å¶è®¤è¯æ°æ®å­å¨å¨åå­ä¸­ã\n\n@bean\npublic userdetailsservice users() {\n    // the builder will ensure the passwords are encoded before saving in memory\n    userbuilder users = user.withdefaultpasswordencoder();\n    userdetails user = users\n        .username("user")\n        .password("password")\n        .roles("user")\n        .build();\n    userdetails user = users\n        .username("admin")\n        .password("password")\n        .roles("user", "admin")\n        .build();\n    return new inmemoryuserdetailsmanager(user, admin);\n}\n\n\n# jdbc è®¤è¯\n\njdbcuserdetailsmanager å®ç°äº userdetailsservice ï¼æä¾äºåºæ¬çç¨æ·åãå¯ç è®¤è¯ï¼å¶è®¤è¯æ°æ®å­å¨å¨å³ç³»åæ°æ®åºä¸­ï¼éè¿ jdbc æ¹å¼è®¿é®ã\n\n@bean\nuserdetailsmanager users(datasource datasource) {\n    userdetails user = user.builder()\n        .username("user")\n        .password("{bcrypt}$2a$10$grldnijsqmuvl/au9ofl.edwmoohzzs7.rmnsjz.0fxo/btk76klw")\n        .roles("user")\n        .build();\n    userdetails admin = user.builder()\n        .username("admin")\n        .password("{bcrypt}$2a$10$grldnijsqmuvl/au9ofl.edwmoohzzs7.rmnsjz.0fxo/btk76klw")\n        .roles("user", "admin")\n        .build();\n    jdbcuserdetailsmanager users = new jdbcuserdetailsmanager(datasource);\n    users.createuser()\n}\n\n\nåºæ¬ç scheamï¼\n\ncreate table users(\n    username varchar_ignorecase(50) not null primary key,\n    password varchar_ignorecase(50) not null,\n    enabled boolean not null\n);\n\ncreate table authorities (\n    username varchar_ignorecase(50) not null,\n    authority varchar_ignorecase(50) not null,\n    constraint fk_authorities_users foreign key(username) references users(username)\n);\ncreate unique index ix_auth_username on authorities (username,authority);\n\n\n# userdetailsservice\n\nuserdetails ç± userdetailsservice è¿åã daoauthenticationprovider éªè¯ userdetailsï¼ç¶åè¿åèº«ä»½éªè¯ï¼è¯¥èº«ä»½éªè¯çä¸»ä½æ¯å·²éç½®ç userdetailsservice è¿åç userdetailsã\n\ndaoauthenticationprovider ä½¿ç¨ userdetailsservice æ£ç´¢ç¨æ·åï¼å¯ç åå¶ä»ç¨äºä½¿ç¨ç¨æ·ååå¯ç è¿è¡èº«ä»½éªè¯çå±æ§ã spring security æä¾ userdetailsservice çåå­ä¸­å jdbc å®ç°ã\n\næ¨å¯ä»¥éè¿å°èªå®ä¹ userdetailsservice å¬å¼ä¸º bean æ¥å®ä¹èªå®ä¹èº«ä»½éªè¯ã\n\n# passwordencoder\n\nspring security ç servlet æ¯æéè¿ä¸ passwordencoder éææ¥å®å¨å°å­å¨å¯ç ã å¯ä»¥éè¿å¬å¼ä¸ä¸ª passwordencoder bean æ¥å®å¶ spring security ä½¿ç¨ç passwordencoder å®ç°ã\n\n\n\n\n# remember-me\n\n\n# spring boot éæ\n\n@enablewebsecurity å @configuration æ³¨è§£ä¸èµ·ä½¿ç¨, æ³¨è§£ websecurityconfigurer ç±»åçç±»ã\n\næèå©ç¨@enablewebsecurityæ³¨è§£ç»§æ¿ websecurityconfigureradapter çç±»ï¼è¿æ ·å°±ææäº spring security çéç½®ã\n\n * configure(websecurity)ï¼éè¿éè½½è¯¥æ¹æ³ï¼å¯éç½® spring security ç filter é¾ã\n * configure(httpsecurity)ï¼éè¿éè½½è¯¥æ¹æ³ï¼å¯éç½®å¦ä½éè¿æ¦æªå¨ä¿æ¤è¯·æ±ã\n\n\n# åèèµæ\n\n * spring security architecture\n * securing a web application',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Netty å¿«éå¥é¨",frontmatter:{title:"Netty å¿«éå¥é¨",categories:["ç¼ç¨","Java","æ¡æ¶","IO"],tags:["Java","IO","Netty"],abbrlink:"ddaa8ce6",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/520c52/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/13.IO/01.Netty.html",relativePath:"13.æ¡æ¶/13.IO/01.Netty.md",key:"v-31a4aa1d",path:"/pages/520c52/",headers:[{level:2,title:"Netty ç®ä»",slug:"netty-ç®ä»",normalizedTitle:"netty ç®ä»",charIndex:17},{level:3,title:"Netty çç¹æ§",slug:"netty-çç¹æ§",normalizedTitle:"netty çç¹æ§",charIndex:83},{level:2,title:"æ ¸å¿ç»ä»¶",slug:"æ ¸å¿ç»ä»¶",normalizedTitle:"æ ¸å¿ç»ä»¶",charIndex:290},{level:2,title:"é«æ§è½",slug:"é«æ§è½",normalizedTitle:"é«æ§è½",charIndex:921},{level:2,title:"é¶æ·è´",slug:"é¶æ·è´",normalizedTitle:"é¶æ·è´",charIndex:213},{level:3,title:"ä¼ ç»æä¹çæ·è´",slug:"ä¼ ç»æä¹çæ·è´",normalizedTitle:"ä¼ ç»æä¹çæ·è´",charIndex:1132},{level:3,title:"é¶æ·è´çæ¦å¿µ",slug:"é¶æ·è´çæ¦å¿µ",normalizedTitle:"é¶æ·è´çæ¦å¿µ",charIndex:1353},{level:3,title:"Netty ä¸­çé¶æ·è´",slug:"netty-ä¸­çé¶æ·è´",normalizedTitle:"netty ä¸­çé¶æ·è´",charIndex:1572},{level:2,title:"Netty æµç¨",slug:"netty-æµç¨",normalizedTitle:"netty æµç¨",charIndex:2117},{level:2,title:"åºç¨",slug:"åºç¨",normalizedTitle:"åºç¨",charIndex:2130},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:3672}],headersStr:"Netty ç®ä» Netty çç¹æ§ æ ¸å¿ç»ä»¶ é«æ§è½ é¶æ·è´ ä¼ ç»æä¹çæ·è´ é¶æ·è´çæ¦å¿µ Netty ä¸­çé¶æ·è´ Netty æµç¨ åºç¨ åèèµæ",content:'# Netty å¿«éå¥é¨\n\n\n# Netty ç®ä»\n\n> Netty æ¯ä¸æ¬¾åºäº NIOï¼Nonblocking I/Oï¼éé»å¡ IOï¼å¼åçç½ç»éä¿¡æ¡æ¶ã\n\n\n# Netty çç¹æ§\n\n * é«å¹¶åï¼Netty æ¯ä¸æ¬¾åºäº NIOï¼Nonblocking IOï¼éé»å¡ IOï¼å¼åçç½ç»éä¿¡æ¡æ¶ï¼å¯¹æ¯äº BIOï¼Blocking I/Oï¼é»å¡ IOï¼ï¼ä»çå¹¶åæ§è½å¾å°äºå¾å¤§æé«ã\n * ä¼ è¾å¿«ï¼Netty çä¼ è¾ä¾èµäºåå­é¶æ·è´ç¹æ§ï¼å°½éåå°ä¸å¿è¦çåå­æ·è´ï¼å®ç°äºæ´é«æççä¼ è¾ã\n * å°è£å¥½ï¼Netty å°è£äº NIO æä½çå¾å¤ç»èï¼æä¾äºæäºä½¿ç¨è°ç¨æ¥å£ã\n\n\n# æ ¸å¿ç»ä»¶\n\n * Channelï¼Netty ç½ç»æä½æ½è±¡ç±»ï¼å®é¤äºåæ¬åºæ¬ç I/O æä½ï¼å¦ bindãconnectãreadãwrite ç­ã\n * EventLoopï¼ä¸»è¦æ¯éå Channel å¤ç I/O æä½ï¼ç¨æ¥å¤çè¿æ¥ççå½å¨æä¸­æåççäºæã\n * ChannelFutureï¼Netty æ¡æ¶ä¸­ææç I/O æä½é½ä¸ºå¼æ­¥çï¼å æ­¤æä»¬éè¦ ChannelFuture ç addListener()æ³¨åä¸ä¸ª ChannelFutureListener çå¬äºä»¶ï¼å½æä½æ§è¡æåæèå¤±è´¥æ¶ï¼çå¬å°±ä¼èªå¨è§¦åè¿åç»æã\n * ChannelHandlerï¼åå½äºææå¤çå¥ç«ååºç«æ°æ®çé»è¾å®¹å¨ãChannelHandler ä¸»è¦ç¨æ¥å¤çåç§äºä»¶ï¼è¿éçäºä»¶å¾å¹¿æ³ï¼æ¯å¦å¯ä»¥æ¯è¿æ¥ãæ°æ®æ¥æ¶ãå¼å¸¸ãæ°æ®è½¬æ¢ç­ã\n * ChannelPipelineï¼ä¸º ChannelHandler é¾æä¾äºå®¹å¨ï¼å½ channel åå»ºæ¶ï¼å°±ä¼è¢«èªå¨åéå°å®ä¸å±ç ChannelPipelineï¼è¿ä¸ªå³èæ¯æ°¸ä¹æ§çã\n\nNetty æä¸¤ç§åéæ¶æ¯çæ¹å¼ï¼\n\n * ç´æ¥åå¥ Channel ä¸­ï¼æ¶æ¯ä» ChannelPipeline å½ä¸­å°¾é¨å¼å§ç§»å¨ï¼\n * åå¥å ChannelHandler ç»å®ç ChannelHandlerContext ä¸­ï¼æ¶æ¯ä» ChannelPipeline ä¸­çä¸ä¸ä¸ª ChannelHandler ä¸­ç§»å¨ã\n\n\n# é«æ§è½\n\nNetty é«æ§è½è¡¨ç°å¨åªäºæ¹é¢ï¼\n\n * NIO çº¿ç¨æ¨¡åï¼åæ­¥éé»å¡ï¼ç¨æå°çèµæºåæ´å¤çäºã\n * åå­é¶æ·è´ï¼å°½éåå°ä¸å¿è¦çåå­æ·è´ï¼å®ç°äºæ´é«æççä¼ è¾ã\n * åå­æ± è®¾è®¡ï¼ç³è¯·çåå­å¯ä»¥éç¨ï¼ä¸»è¦æç´æ¥åå­ãåé¨å®ç°æ¯ç¨ä¸é¢äºåæ¥æ¾æ ç®¡çåå­åéæåµã\n * ä¸²å½¢åå¤çè¯»åï¼é¿åä½¿ç¨éå¸¦æ¥çæ§è½å¼éã\n * é«æ§è½åºåååè®®ï¼æ¯æ protobuf ç­é«æ§è½åºåååè®®ã\n\n\n# é¶æ·è´\n\n\n# ä¼ ç»æä¹çæ·è´\n\næ¯å¨åéæ°æ®çæ¶åï¼ä¼ ç»çå®ç°æ¹å¼æ¯ï¼\n\nFile.read(bytes)\n\nSocket.send(bytes)\n\nè¿ç§æ¹å¼éè¦åæ¬¡æ°æ®æ·è´ååæ¬¡ä¸ä¸æåæ¢ï¼\n\n 1. æ°æ®ä»ç£çè¯»åå°åæ ¸ç read buffer\n\n 2. æ°æ®ä»åæ ¸ç¼å²åºæ·è´å°ç¨æ·ç¼å²åº\n\n 3. æ°æ®ä»ç¨æ·ç¼å²åºæ·è´å°åæ ¸ç socket buffer\n\n 4. æ°æ®ä»åæ ¸ç socket buffer æ·è´å°ç½å¡æ¥å£ï¼ç¡¬ä»¶ï¼çç¼å²åº\n\n\n# é¶æ·è´çæ¦å¿µ\n\nææ¾ä¸é¢çç¬¬äºæ­¥åç¬¬ä¸æ­¥æ¯éå¿è¦çï¼éè¿ java ç FileChannel.transferTo æ¹æ³ï¼å¯ä»¥é¿åä¸é¢ä¸¤æ¬¡å¤ä½çæ·è´ï¼å½ç¶è¿éè¦åºå±æä½ç³»ç»æ¯æï¼\n\n * è°ç¨ transferToï¼æ°æ®ä»æä»¶ç± DMA å¼ææ·è´å°åæ ¸ read buffer\n * æ¥ç DMA ä»åæ ¸ read buffer å°æ°æ®æ·è´å°ç½å¡æ¥å£ buffer\n\nä¸é¢çä¸¤æ¬¡æä½é½ä¸éè¦ CPU åä¸ï¼æä»¥å°±è¾¾å°äºé¶æ·è´ã\n\n\n# Netty ä¸­çé¶æ·è´\n\nä¸»è¦ä½ç°å¨ä¸ä¸ªæ¹é¢ï¼\n\nbytebuffer\n\nNetty åéåæ¥æ¶æ¶æ¯ä¸»è¦ä½¿ç¨ bytebufferï¼bytebuffer ä½¿ç¨å¯¹å¤åå­ï¼DirectMemoryï¼ç´æ¥è¿è¡ Socket è¯»åã\n\nåå ï¼å¦æä½¿ç¨ä¼ ç»çå åå­è¿è¡ Socket è¯»åï¼JVM ä¼å°å åå­ buffer æ·è´ä¸ä»½å°ç´æ¥åå­ä¸­ç¶åååå¥ socketï¼å¤äºä¸æ¬¡ç¼å²åºçåå­æ·è´ãDirectMemory ä¸­å¯ä»¥ç´æ¥éè¿ DMA åéå°ç½å¡æ¥å£\n\nComposite Buffers\n\nä¼ ç»ç ByteBufferï¼å¦æéè¦å°ä¸¤ä¸ª ByteBuffer ä¸­çæ°æ®ç»åå°ä¸èµ·ï¼æä»¬éè¦é¦ååå»ºä¸ä¸ª size=size1+size2 å¤§å°çæ°çæ°ç»ï¼ç¶åå°ä¸¤ä¸ªæ°ç»ä¸­çæ°æ®æ·è´å°æ°çæ°ç»ä¸­ãä½æ¯ä½¿ç¨ Netty æä¾çç»å ByteBufï¼å°±å¯ä»¥é¿åè¿æ ·çæä½ï¼å ä¸º CompositeByteBuf å¹¶æ²¡æçæ­£å°å¤ä¸ª Buffer ç»åèµ·æ¥ï¼èæ¯ä¿å­äºå®ä»¬çå¼ç¨ï¼ä»èé¿åäºæ°æ®çæ·è´ï¼å®ç°äºé¶æ·è´ã\n\nå¯¹äº FileChannel.transferTo çä½¿ç¨\n\nNetty ä¸­ä½¿ç¨äº FileChannel ç transferTo æ¹æ³ï¼è¯¥æ¹æ³ä¾èµäºæä½ç³»ç»å®ç°é¶æ·è´ã\n\n\n# Netty æµç¨\n\n\n# åºç¨\n\n> Netty æ¯ä¸ä¸ªå¹¿æ³ä½¿ç¨ç Java ç½ç»ç¼ç¨æ¡æ¶ãå¾å¤èåè½¯ä»¶é½ä½¿ç¨äºå®ï¼å¦ï¼DubboãCassandraãElasticsearchãVert.x ç­ã\n\næäº Nettyï¼ä½ å¯ä»¥å®ç°èªå·±ç HTTP æå¡å¨ï¼FTP æå¡å¨ï¼UDP æå¡å¨ï¼RPC æå¡å¨ï¼WebSocket æå¡å¨ï¼Redis ç Proxy æå¡å¨ï¼MySQL ç Proxy æå¡å¨ç­ç­ã\n\npublic class NettyOioServer {\n\n    public void server(int port) throws Exception {\n        final ByteBuf buf = Unpooled.unreleasableBuffer(\n                Unpooled.copiedBuffer("Hi!\\r\\n", Charset.forName("UTF-8")));\n        EventLoopGroup group = new OioEventLoopGroup();\n        try {\n            ServerBootstrap b = new ServerBootstrap();        //1\n\n            b.group(group)                                    //2\n             .channel(OioServerSocketChannel.class)\n             .localAddress(new InetSocketAddress(port))\n             .childHandler(new ChannelInitializer<SocketChannel>() {//3\n                 @Override\n                 public void initChannel(SocketChannel ch)\n                     throws Exception {\n                     ch.pipeline().addLast(new ChannelInboundHandlerAdapter() {            //4\n                         @Override\n                         public void channelActive(ChannelHandlerContext ctx) throws Exception {\n                             ctx.writeAndFlush(buf.duplicate()).addListener(ChannelFutureListener.CLOSE);//5\n                         }\n                     });\n                 }\n             });\n            ChannelFuture f = b.bind().sync();  //6\n            f.channel().closeFuture().sync();\n        } finally {\n            group.shutdownGracefully().sync();        //7\n        }\n    }\n}\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * Netty å®ç½\n   * Netty Github\n * æç« \n   * Netty å¥é¨æç¨ââè®¤è¯ Netty\n   * å½»åºçè§£ Nettyï¼è¿ä¸ç¯æç« å°±å¤äº\n   * Java 200+ é¢è¯é¢è¡¥å â¡ Netty æ¨¡å',normalizedContent:'# netty å¿«éå¥é¨\n\n\n# netty ç®ä»\n\n> netty æ¯ä¸æ¬¾åºäº nioï¼nonblocking i/oï¼éé»å¡ ioï¼å¼åçç½ç»éä¿¡æ¡æ¶ã\n\n\n# netty çç¹æ§\n\n * é«å¹¶åï¼netty æ¯ä¸æ¬¾åºäº nioï¼nonblocking ioï¼éé»å¡ ioï¼å¼åçç½ç»éä¿¡æ¡æ¶ï¼å¯¹æ¯äº bioï¼blocking i/oï¼é»å¡ ioï¼ï¼ä»çå¹¶åæ§è½å¾å°äºå¾å¤§æé«ã\n * ä¼ è¾å¿«ï¼netty çä¼ è¾ä¾èµäºåå­é¶æ·è´ç¹æ§ï¼å°½éåå°ä¸å¿è¦çåå­æ·è´ï¼å®ç°äºæ´é«æççä¼ è¾ã\n * å°è£å¥½ï¼netty å°è£äº nio æä½çå¾å¤ç»èï¼æä¾äºæäºä½¿ç¨è°ç¨æ¥å£ã\n\n\n# æ ¸å¿ç»ä»¶\n\n * channelï¼netty ç½ç»æä½æ½è±¡ç±»ï¼å®é¤äºåæ¬åºæ¬ç i/o æä½ï¼å¦ bindãconnectãreadãwrite ç­ã\n * eventloopï¼ä¸»è¦æ¯éå channel å¤ç i/o æä½ï¼ç¨æ¥å¤çè¿æ¥ççå½å¨æä¸­æåççäºæã\n * channelfutureï¼netty æ¡æ¶ä¸­ææç i/o æä½é½ä¸ºå¼æ­¥çï¼å æ­¤æä»¬éè¦ channelfuture ç addlistener()æ³¨åä¸ä¸ª channelfuturelistener çå¬äºä»¶ï¼å½æä½æ§è¡æåæèå¤±è´¥æ¶ï¼çå¬å°±ä¼èªå¨è§¦åè¿åç»æã\n * channelhandlerï¼åå½äºææå¤çå¥ç«ååºç«æ°æ®çé»è¾å®¹å¨ãchannelhandler ä¸»è¦ç¨æ¥å¤çåç§äºä»¶ï¼è¿éçäºä»¶å¾å¹¿æ³ï¼æ¯å¦å¯ä»¥æ¯è¿æ¥ãæ°æ®æ¥æ¶ãå¼å¸¸ãæ°æ®è½¬æ¢ç­ã\n * channelpipelineï¼ä¸º channelhandler é¾æä¾äºå®¹å¨ï¼å½ channel åå»ºæ¶ï¼å°±ä¼è¢«èªå¨åéå°å®ä¸å±ç channelpipelineï¼è¿ä¸ªå³èæ¯æ°¸ä¹æ§çã\n\nnetty æä¸¤ç§åéæ¶æ¯çæ¹å¼ï¼\n\n * ç´æ¥åå¥ channel ä¸­ï¼æ¶æ¯ä» channelpipeline å½ä¸­å°¾é¨å¼å§ç§»å¨ï¼\n * åå¥å channelhandler ç»å®ç channelhandlercontext ä¸­ï¼æ¶æ¯ä» channelpipeline ä¸­çä¸ä¸ä¸ª channelhandler ä¸­ç§»å¨ã\n\n\n# é«æ§è½\n\nnetty é«æ§è½è¡¨ç°å¨åªäºæ¹é¢ï¼\n\n * nio çº¿ç¨æ¨¡åï¼åæ­¥éé»å¡ï¼ç¨æå°çèµæºåæ´å¤çäºã\n * åå­é¶æ·è´ï¼å°½éåå°ä¸å¿è¦çåå­æ·è´ï¼å®ç°äºæ´é«æççä¼ è¾ã\n * åå­æ± è®¾è®¡ï¼ç³è¯·çåå­å¯ä»¥éç¨ï¼ä¸»è¦æç´æ¥åå­ãåé¨å®ç°æ¯ç¨ä¸é¢äºåæ¥æ¾æ ç®¡çåå­åéæåµã\n * ä¸²å½¢åå¤çè¯»åï¼é¿åä½¿ç¨éå¸¦æ¥çæ§è½å¼éã\n * é«æ§è½åºåååè®®ï¼æ¯æ protobuf ç­é«æ§è½åºåååè®®ã\n\n\n# é¶æ·è´\n\n\n# ä¼ ç»æä¹çæ·è´\n\næ¯å¨åéæ°æ®çæ¶åï¼ä¼ ç»çå®ç°æ¹å¼æ¯ï¼\n\nfile.read(bytes)\n\nsocket.send(bytes)\n\nè¿ç§æ¹å¼éè¦åæ¬¡æ°æ®æ·è´ååæ¬¡ä¸ä¸æåæ¢ï¼\n\n 1. æ°æ®ä»ç£çè¯»åå°åæ ¸ç read buffer\n\n 2. æ°æ®ä»åæ ¸ç¼å²åºæ·è´å°ç¨æ·ç¼å²åº\n\n 3. æ°æ®ä»ç¨æ·ç¼å²åºæ·è´å°åæ ¸ç socket buffer\n\n 4. æ°æ®ä»åæ ¸ç socket buffer æ·è´å°ç½å¡æ¥å£ï¼ç¡¬ä»¶ï¼çç¼å²åº\n\n\n# é¶æ·è´çæ¦å¿µ\n\nææ¾ä¸é¢çç¬¬äºæ­¥åç¬¬ä¸æ­¥æ¯éå¿è¦çï¼éè¿ java ç filechannel.transferto æ¹æ³ï¼å¯ä»¥é¿åä¸é¢ä¸¤æ¬¡å¤ä½çæ·è´ï¼å½ç¶è¿éè¦åºå±æä½ç³»ç»æ¯æï¼\n\n * è°ç¨ transfertoï¼æ°æ®ä»æä»¶ç± dma å¼ææ·è´å°åæ ¸ read buffer\n * æ¥ç dma ä»åæ ¸ read buffer å°æ°æ®æ·è´å°ç½å¡æ¥å£ buffer\n\nä¸é¢çä¸¤æ¬¡æä½é½ä¸éè¦ cpu åä¸ï¼æä»¥å°±è¾¾å°äºé¶æ·è´ã\n\n\n# netty ä¸­çé¶æ·è´\n\nä¸»è¦ä½ç°å¨ä¸ä¸ªæ¹é¢ï¼\n\nbytebuffer\n\nnetty åéåæ¥æ¶æ¶æ¯ä¸»è¦ä½¿ç¨ bytebufferï¼bytebuffer ä½¿ç¨å¯¹å¤åå­ï¼directmemoryï¼ç´æ¥è¿è¡ socket è¯»åã\n\nåå ï¼å¦æä½¿ç¨ä¼ ç»çå åå­è¿è¡ socket è¯»åï¼jvm ä¼å°å åå­ buffer æ·è´ä¸ä»½å°ç´æ¥åå­ä¸­ç¶åååå¥ socketï¼å¤äºä¸æ¬¡ç¼å²åºçåå­æ·è´ãdirectmemory ä¸­å¯ä»¥ç´æ¥éè¿ dma åéå°ç½å¡æ¥å£\n\ncomposite buffers\n\nä¼ ç»ç bytebufferï¼å¦æéè¦å°ä¸¤ä¸ª bytebuffer ä¸­çæ°æ®ç»åå°ä¸èµ·ï¼æä»¬éè¦é¦ååå»ºä¸ä¸ª size=size1+size2 å¤§å°çæ°çæ°ç»ï¼ç¶åå°ä¸¤ä¸ªæ°ç»ä¸­çæ°æ®æ·è´å°æ°çæ°ç»ä¸­ãä½æ¯ä½¿ç¨ netty æä¾çç»å bytebufï¼å°±å¯ä»¥é¿åè¿æ ·çæä½ï¼å ä¸º compositebytebuf å¹¶æ²¡æçæ­£å°å¤ä¸ª buffer ç»åèµ·æ¥ï¼èæ¯ä¿å­äºå®ä»¬çå¼ç¨ï¼ä»èé¿åäºæ°æ®çæ·è´ï¼å®ç°äºé¶æ·è´ã\n\nå¯¹äº filechannel.transferto çä½¿ç¨\n\nnetty ä¸­ä½¿ç¨äº filechannel ç transferto æ¹æ³ï¼è¯¥æ¹æ³ä¾èµäºæä½ç³»ç»å®ç°é¶æ·è´ã\n\n\n# netty æµç¨\n\n\n# åºç¨\n\n> netty æ¯ä¸ä¸ªå¹¿æ³ä½¿ç¨ç java ç½ç»ç¼ç¨æ¡æ¶ãå¾å¤èåè½¯ä»¶é½ä½¿ç¨äºå®ï¼å¦ï¼dubboãcassandraãelasticsearchãvert.x ç­ã\n\næäº nettyï¼ä½ å¯ä»¥å®ç°èªå·±ç http æå¡å¨ï¼ftp æå¡å¨ï¼udp æå¡å¨ï¼rpc æå¡å¨ï¼websocket æå¡å¨ï¼redis ç proxy æå¡å¨ï¼mysql ç proxy æå¡å¨ç­ç­ã\n\npublic class nettyoioserver {\n\n    public void server(int port) throws exception {\n        final bytebuf buf = unpooled.unreleasablebuffer(\n                unpooled.copiedbuffer("hi!\\r\\n", charset.forname("utf-8")));\n        eventloopgroup group = new oioeventloopgroup();\n        try {\n            serverbootstrap b = new serverbootstrap();        //1\n\n            b.group(group)                                    //2\n             .channel(oioserversocketchannel.class)\n             .localaddress(new inetsocketaddress(port))\n             .childhandler(new channelinitializer<socketchannel>() {//3\n                 @override\n                 public void initchannel(socketchannel ch)\n                     throws exception {\n                     ch.pipeline().addlast(new channelinboundhandleradapter() {            //4\n                         @override\n                         public void channelactive(channelhandlercontext ctx) throws exception {\n                             ctx.writeandflush(buf.duplicate()).addlistener(channelfuturelistener.close);//5\n                         }\n                     });\n                 }\n             });\n            channelfuture f = b.bind().sync();  //6\n            f.channel().closefuture().sync();\n        } finally {\n            group.shutdowngracefully().sync();        //7\n        }\n    }\n}\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * netty å®ç½\n   * netty github\n * æç« \n   * netty å¥é¨æç¨ââè®¤è¯ netty\n   * å½»åºçè§£ nettyï¼è¿ä¸ç¯æç« å°±å¤äº\n   * java 200+ é¢è¯é¢è¡¥å â¡ netty æ¨¡å',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Dubbo å¿«éå¥é¨",frontmatter:{title:"Dubbo å¿«éå¥é¨",categories:["ç¼ç¨","Java","æ¡æ¶","å¾®æå¡"],tags:["Java","æ¡æ¶","å¾®æå¡","Dubbo"],abbrlink:"37e41c9c",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/e79b77/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/14.%E5%BE%AE%E6%9C%8D%E5%8A%A1/01.Dubbo.html",relativePath:"13.æ¡æ¶/14.å¾®æå¡/01.Dubbo.md",key:"v-03cb9ec2",path:"/pages/e79b77/",headers:[{level:2,title:"ä¸ãDubbo ç®ä»",slug:"ä¸ãdubbo-ç®ä»",normalizedTitle:"ä¸ãdubbo ç®ä»",charIndex:105},{level:3,title:"RPC åçç®ä»",slug:"rpc-åçç®ä»",normalizedTitle:"rpc åçç®ä»",charIndex:221},{level:4,title:"ä»ä¹æ¯ RPC",slug:"ä»ä¹æ¯-rpc",normalizedTitle:"ä»ä¹æ¯ rpc",charIndex:233},{level:4,title:"RPC å·¥ä½æµç¨",slug:"rpc-å·¥ä½æµç¨",normalizedTitle:"rpc å·¥ä½æµç¨",charIndex:430},{level:3,title:"ä¸ºä»ä¹éè¦ Dubbo",slug:"ä¸ºä»ä¹éè¦-dubbo",normalizedTitle:"ä¸ºä»ä¹éè¦ dubbo",charIndex:731},{level:2,title:"äºãQuickStart",slug:"äºãquickstart",normalizedTitle:"äºãquickstart",charIndex:1169},{level:2,title:"ä¸ãDubbo éç½®",slug:"ä¸ãdubbo-éç½®",normalizedTitle:"ä¸ãdubbo éç½®",charIndex:4295},{level:3,title:"éç½®æ¹å¼",slug:"éç½®æ¹å¼",normalizedTitle:"éç½®æ¹å¼",charIndex:4536},{level:4,title:"xml éç½®",slug:"xml-éç½®",normalizedTitle:"xml éç½®",charIndex:4562},{level:4,title:"properties éç½®",slug:"properties-éç½®",normalizedTitle:"properties éç½®",charIndex:4572},{level:3,title:"éç½®é¡¹",slug:"éç½®é¡¹",normalizedTitle:"éç½®é¡¹",charIndex:4370},{level:4,title:"éç½®ä¹é´çå³ç³»",slug:"éç½®ä¹é´çå³ç³»",normalizedTitle:"éç½®ä¹é´çå³ç³»",charIndex:7091},{level:4,title:"éç½®è¦çå³ç³»",slug:"éç½®è¦çå³ç³»",normalizedTitle:"éç½®è¦çå³ç³»",charIndex:7104},{level:2,title:"åãDubbo æ¶æ",slug:"åãdubbo-æ¶æ",normalizedTitle:"åãdubbo æ¶æ",charIndex:7634},{level:3,title:"Dubbo æ ¸å¿ç»ä»¶",slug:"dubbo-æ ¸å¿ç»ä»¶",normalizedTitle:"dubbo æ ¸å¿ç»ä»¶",charIndex:7649},{level:3,title:"Dubbo æ¶æå±æ¬¡",slug:"dubbo-æ¶æå±æ¬¡",normalizedTitle:"dubbo æ¶æå±æ¬¡",charIndex:8513},{level:4,title:"åå±è¯´æ",slug:"åå±è¯´æ",normalizedTitle:"åå±è¯´æ",charIndex:8818},{level:4,title:"åå±å³ç³»è¯´æ",slug:"åå±å³ç³»è¯´æ",normalizedTitle:"åå±å³ç³»è¯´æ",charIndex:9786},{level:2,title:"äºãæå¡åç°",slug:"äºãæå¡åç°",normalizedTitle:"äºãæå¡åç°",charIndex:10646},{level:3,title:"å¯å¨æ¶æ£æ¥",slug:"å¯å¨æ¶æ£æ¥",normalizedTitle:"å¯å¨æ¶æ£æ¥",charIndex:11375},{level:2,title:"å­ãDubbo åè®®",slug:"å­ãdubbo-åè®®",normalizedTitle:"å­ãdubbo åè®®",charIndex:11507},{level:3,title:"dubbo åè®®",slug:"dubbo-åè®®",normalizedTitle:"dubbo åè®®",charIndex:5458},{level:3,title:"rmi åè®®",slug:"rmi-åè®®",normalizedTitle:"rmi åè®®",charIndex:11857},{level:3,title:"hessian åè®®",slug:"hessian-åè®®",normalizedTitle:"hessian åè®®",charIndex:11996},{level:3,title:"thrift åè®®",slug:"thrift-åè®®",normalizedTitle:"thrift åè®®",charIndex:12250},{level:3,title:"http åè®®",slug:"http-åè®®",normalizedTitle:"http åè®®",charIndex:12439},{level:3,title:"webservice åè®®",slug:"webservice-åè®®",normalizedTitle:"webservice åè®®",charIndex:12521},{level:3,title:"rest åè®®",slug:"rest-åè®®",normalizedTitle:"rest åè®®",charIndex:12778},{level:3,title:"memcached åè®®",slug:"memcached-åè®®",normalizedTitle:"memcached åè®®",charIndex:12875},{level:3,title:"redis åè®®",slug:"redis-åè®®",normalizedTitle:"redis åè®®",charIndex:12918},{level:2,title:"ä¸ãéç¾¤å®¹é",slug:"ä¸ãéç¾¤å®¹é",normalizedTitle:"ä¸ãéç¾¤å®¹é",charIndex:13149},{level:2,title:"å«ãè´è½½åè¡¡",slug:"å«ãè´è½½åè¡¡",normalizedTitle:"å«ãè´è½½åè¡¡",charIndex:13679},{level:4,title:"Random",slug:"random",normalizedTitle:"random",charIndex:13722},{level:4,title:"RoundRobin",slug:"roundrobin",normalizedTitle:"roundrobin",charIndex:14296},{level:4,title:"LeastActive",slug:"leastactive",normalizedTitle:"leastactive",charIndex:14399},{level:4,title:"ConsistentHash",slug:"consistenthash",normalizedTitle:"consistenthash",charIndex:14485},{level:2,title:"ä¹ãDubbo æå¡æ²»ç",slug:"ä¹ãdubbo-æå¡æ²»ç",normalizedTitle:"ä¹ãdubbo æå¡æ²»ç",charIndex:14799},{level:3,title:"æå¡æ²»çç®ä»",slug:"æå¡æ²»çç®ä»",normalizedTitle:"æå¡æ²»çç®ä»",charIndex:14816},{level:4,title:"è°ç¨é¾è·¯",slug:"è°ç¨é¾è·¯",normalizedTitle:"è°ç¨é¾è·¯",charIndex:879},{level:4,title:"æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡",slug:"æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡",normalizedTitle:"æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡",charIndex:984},{level:4,title:"å¶ä»",slug:"å¶ä»",normalizedTitle:"å¶ä»",charIndex:15417},{level:3,title:"è·¯ç±è§å",slug:"è·¯ç±è§å",normalizedTitle:"è·¯ç±è§å",charIndex:15922},{level:3,title:"æå¡éçº§",slug:"æå¡éçº§",normalizedTitle:"æå¡éçº§",charIndex:17010},{level:3,title:"è®¿é®æ§å¶",slug:"è®¿é®æ§å¶",normalizedTitle:"è®¿é®æ§å¶",charIndex:19757},{level:4,title:"ç´è¿",slug:"ç´è¿",normalizedTitle:"ç´è¿",charIndex:8352},{level:4,title:"åªè®¢é",slug:"åªè®¢é",normalizedTitle:"åªè®¢é",charIndex:20427},{level:4,title:"åªæ³¨å",slug:"åªæ³¨å",normalizedTitle:"åªæ³¨å",charIndex:20706},{level:4,title:"éææå¡",slug:"éææå¡",normalizedTitle:"éææå¡",charIndex:21132},{level:3,title:"å¨æéç½®",slug:"å¨æéç½®",normalizedTitle:"å¨æéç½®",charIndex:7262},{level:2,title:"åãå¤çæ¬",slug:"åãå¤çæ¬",normalizedTitle:"åãå¤çæ¬",charIndex:22741},{level:2,title:"åä¸ãDubbo SPI",slug:"åä¸ãdubbo-spi",normalizedTitle:"åä¸ãdubbo spi",charIndex:23343},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:23776}],headersStr:"ä¸ãDubbo ç®ä» RPC åçç®ä» ä»ä¹æ¯ RPC RPC å·¥ä½æµç¨ ä¸ºä»ä¹éè¦ Dubbo äºãQuickStart ä¸ãDubbo éç½® éç½®æ¹å¼ xml éç½® properties éç½® éç½®é¡¹ éç½®ä¹é´çå³ç³» éç½®è¦çå³ç³» åãDubbo æ¶æ Dubbo æ ¸å¿ç»ä»¶ Dubbo æ¶æå±æ¬¡ åå±è¯´æ åå±å³ç³»è¯´æ äºãæå¡åç° å¯å¨æ¶æ£æ¥ å­ãDubbo åè®® dubbo åè®® rmi åè®® hessian åè®® thrift åè®® http åè®® webservice åè®® rest åè®® memcached åè®® redis åè®® ä¸ãéç¾¤å®¹é å«ãè´è½½åè¡¡ Random RoundRobin LeastActive ConsistentHash ä¹ãDubbo æå¡æ²»ç æå¡æ²»çç®ä» è°ç¨é¾è·¯ æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡ å¶ä» è·¯ç±è§å æå¡éçº§ è®¿é®æ§å¶ ç´è¿ åªè®¢é åªæ³¨å éææå¡ å¨æéç½® åãå¤çæ¬ åä¸ãDubbo SPI åèèµæ",content:'# Dubbo å¿«éå¥é¨\n\n> Apache Dubbo æ¯ä¸æ¬¾é«æ§è½ãè½»éçº§çå¼æº Java RPC æ¡æ¶ï¼å®æä¾äºä¸å¤§æ ¸å¿è½åï¼é¢åæ¥å£çè¿ç¨æ¹æ³è°ç¨ï¼æºè½å®¹éåè´è½½åè¡¡ï¼ä»¥åæå¡èªå¨æ³¨åååç°ã\n\n\n# ä¸ãDubbo ç®ä»\n\nApache Dubbo æ¯ä¸æ¬¾é«æ§è½ãè½»éçº§çå¼æº Java RPC æ¡æ¶ã\n\nDubbo æä¾äºä¸å¤§æ ¸å¿è½åï¼\n\n * é¢åæ¥å£çè¿ç¨æ¹æ³è°ç¨\n * æºè½å®¹éåè´è½½åè¡¡\n * æå¡èªå¨æ³¨åååç°\n\n\n# RPC åçç®ä»\n\n# ä»ä¹æ¯ RPC\n\nRPCï¼Remote Procedure Callï¼ï¼å³è¿ç¨è¿ç¨è°ç¨ï¼å®æ¯ä¸ç§éè¿ç½ç»ä»è¿ç¨è®¡ç®æºç¨åºä¸è¯·æ±æå¡ï¼èä¸éè¦äºè§£åºå±ç½ç»ææ¯çåè®®ãæ¯å¦ä¸¤ä¸ªä¸åçæå¡ AãB é¨ç½²å¨ä¸¤å°ä¸åçæºå¨ä¸ï¼é£ä¹æå¡ A å¦ææ³è¦è°ç¨æå¡ B ä¸­çæä¸ªæ¹æ³è¯¥æä¹åå¢ï¼ä½¿ç¨ HTTP è¯·æ± å½ç¶å¯ä»¥ï¼ä½æ¯å¯è½ä¼æ¯è¾æ¢èä¸ä¸äºä¼ååçå¹¶ä¸å¥½ã RPC çåºç°å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ã\n\n# RPC å·¥ä½æµç¨\n\n\n\n 1. æå¡æ¶è´¹æ¹ï¼clientï¼è°ç¨ä»¥æ¬å°è°ç¨æ¹å¼è°ç¨æå¡ï¼\n 2. client stub æ¥æ¶å°è°ç¨åè´è´£å°æ¹æ³ãåæ°ç­ç»è£æè½å¤è¿è¡ç½ç»ä¼ è¾çæ¶æ¯ä½ï¼\n 3. client stub æ¾å°æå¡å°åï¼å¹¶å°æ¶æ¯åéå°æå¡ç«¯ï¼\n 4. server stub æ¶å°æ¶æ¯åè¿è¡è§£ç ï¼\n 5. server stub æ ¹æ®è§£ç ç»æè°ç¨æ¬å°çæå¡ï¼\n 6. æ¬å°æå¡æ§è¡å¹¶å°ç»æè¿åç» server stubï¼\n 7. server stub å°è¿åç»ææåææ¶æ¯å¹¶åéè³æ¶è´¹æ¹ï¼\n 8. client stub æ¥æ¶å°æ¶æ¯ï¼å¹¶è¿è¡è§£ç ï¼\n 9. æå¡æ¶è´¹æ¹å¾å°æç»ç»æã\n\n\n# ä¸ºä»ä¹éè¦ Dubbo\n\nå¦æä½ è¦å¼ååå¸å¼ç¨åºï¼ä½ ä¹å¯ä»¥ç´æ¥åºäº HTTP æ¥å£è¿è¡éä¿¡ï¼ä½æ¯ä¸ºä»ä¹è¦ç¨ Dubbo å¢ï¼\n\næè§å¾ä¸»è¦å¯ä»¥ä» Dubbo æä¾çä¸é¢åç¹ç¹æ§æ¥è¯´ä¸ºä»ä¹è¦ç¨ Dubboï¼\n\n 1. è´è½½åè¡¡ââåä¸ä¸ªæå¡é¨ç½²å¨ä¸åçæºå¨æ¶è¯¥è°ç¨é£ä¸å°æºå¨ä¸çæå¡ã\n 2. æå¡è°ç¨é¾è·¯ââéçç³»ç»çåå±ï¼æå¡è¶æ¥è¶å¤ï¼æå¡é´ä¾èµå³ç³»åå¾éè¸ªå¤æï¼çè³åä¸æ¸åªä¸ªåºç¨è¦å¨åªä¸ªåºç¨ä¹åå¯å¨ï¼æ¶æå¸é½ä¸è½å®æ´çæè¿°åºç¨çæ¶æå³ç³»ãDubbo å¯ä»¥ä¸ºæä»¬è§£å³æå¡ä¹é´äºç¸æ¯å¦ä½è°ç¨çã\n 3. æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡ãèµæºè°åº¦åæ²»çââåºäºè®¿é®ååå®æ¶ç®¡çéç¾¤å®¹éï¼æé«éç¾¤å©ç¨çã\n 4. æå¡æ²»çââæä¸ªæå¡ææä¹åè°ç¨å¤ç¨æå¡ã\n\nå¦å¤ï¼Dubbo é¤äºè½å¤åºç¨å¨åå¸å¼ç³»ç»ä¸­ï¼ä¹å¯ä»¥åºç¨å¨ç°å¨æ¯è¾ç«çå¾®æå¡ç³»ç»ä¸­ãä¸è¿ï¼ç±äº Spring Cloud å¨å¾®æå¡ä¸­åºç¨æ´å å¹¿æ³ï¼æä»¥ï¼æè§å¾ä¸è¬æä»¬æ Dubbo çè¯ï¼å¤§é¨åæ¯åå¸å¼ç³»ç»çæåµã\n\n\n# äºãQuickStart\n\nï¼1ï¼æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>dubbo</artifactId>\n    <version>${dubbo.version}</version>\n</dependency>\n\n\nï¼2ï¼å®ä¹ Provider\n\npackage com.alibaba.dubbo.demo;\n\npublic interface DemoService {\n    String sayHello(String name);\n}\n\n\nï¼3ï¼å®ç° Provider\n\npackage com.alibaba.dubbo.demo.provider;\nimport com.alibaba.dubbo.demo.DemoService;\n\npublic class DemoServiceImpl implements DemoService {\n    public String sayHello(String name) {\n        return "Hello " + name;\n    }\n}\n\n\nï¼4ï¼éç½® Provider\n\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-provider"/>\n    <dubbo:registry address="multicast://224.5.6.7:1234"/>\n    <dubbo:protocol name="dubbo" port="20880"/>\n    <dubbo:service interface="com.alibaba.dubbo.demo.DemoService" ref="demoService"/>\n    <bean id="demoService" class="com.alibaba.dubbo.demo.provider.DemoServiceImpl"/>\n</beans>\n\n\nï¼5ï¼å¯å¨ Provider\n\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Provider {\n    public static void main(String[] args) throws Exception {\n        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\n                new String[] {"META-INF/spring/dubbo-demo-provider.xml"});\n        context.start();\n        // press any key to exit\n        System.in.read();\n    }\n}\n\n\nï¼6ï¼éç½® Consumer\n\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-consumer"/>\n    <dubbo:registry address="multicast://224.5.6.7:1234"/>\n    <dubbo:reference id="demoService" interface="com.alibaba.dubbo.demo.DemoService"/>\n</beans>\n\n\nï¼7ï¼å¯å¨ Consumer\n\nimport com.alibaba.dubbo.demo.DemoService;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Consumer {\n    public static void main(String[] args) throws Exception {\n        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\n                new String[]{"META-INF/spring/dubbo-demo-consumer.xml"});\n        context.start();\n        // obtain proxy object for remote invocation\n        DemoService demoService = (DemoService) context.getBean("demoService");\n        // execute remote invocation\n        String hello = demoService.sayHello("world");\n        // show the result\n        System.out.println(hello);\n    }\n}\n\n\n\n# ä¸ãDubbo éç½®\n\nDubbo ææéç½®æç»é½å°è½¬æ¢ä¸º URL è¡¨ç¤ºï¼å¹¶ç±æå¡æä¾æ¹çæï¼ç»æ³¨åä¸­å¿ä¼ éç»æ¶è´¹æ¹ï¼åå±æ§å¯¹åº URL çåæ°ï¼åè§éç½®é¡¹ä¸è§è¡¨ä¸­ç "å¯¹åº URL åæ°" åã\n\nåªæ groupï¼interfaceï¼version æ¯æå¡çå¹éæ¡ä»¶ï¼ä¸èå³å®æ¯ä¸æ¯åä¸ä¸ªæå¡ï¼å¶å®éç½®é¡¹åä¸ºè°ä¼åæ²»çåæ°ã\n\nURL æ ¼å¼ï¼protocol://username:password@host:port/path?key=value&key=value\n\n\n# éç½®æ¹å¼\n\nDubbo æ¯æå¤ç§éç½®æ¹å¼ï¼\n\n * xml éç½®\n * properties éç½®\n * API éç½®\n * æ³¨è§£éç½®\n\nå¦æåæ¶å­å¨å¤ç§éç½®æ¹å¼ï¼éµå¾ªä»¥ä¸è¦çç­ç¥ï¼\n\n * JVM å¯å¨ -D åæ°ä¼åï¼è¿æ ·å¯ä»¥ä½¿ç¨æ·å¨é¨ç½²åå¯å¨æ¶è¿è¡åæ°éåï¼æ¯å¦å¨å¯å¨æ¶éæ¹ååè®®çç«¯å£ã\n * XML æ¬¡ä¹ï¼å¦æå¨ XML ä¸­æéç½®ï¼å dubbo.properties ä¸­çç¸åºéç½®é¡¹æ æã\n * Properties æåï¼ç¸å½äºç¼ºçå¼ï¼åªæ XML æ²¡æéç½®æ¶ï¼dubbo.properties çç¸åºéç½®é¡¹æä¼çæï¼éå¸¸ç¨äºå±äº«å¬å±éç½®ï¼æ¯å¦åºç¨åã\n\n\n\n# xml éç½®\n\nç¤ºä¾ï¼\n\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"\n    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd">\n    \x3c!-- æä¾æ¹åºç¨ä¿¡æ¯ï¼ç¨äºè®¡ç®ä¾èµå³ç³» --\x3e\n    <dubbo:application name="hello-world-app"  />\n    \x3c!-- ä½¿ç¨ multicast å¹¿æ­æ³¨åä¸­å¿æ´é²æå¡å°å --\x3e\n    <dubbo:registry address="multicast://224.5.6.7:1234" />\n    \x3c!-- ç¨ dubbo åè®®å¨ 20880 ç«¯å£æ´é²æå¡ --\x3e\n    <dubbo:protocol name="dubbo" port="20880" />\n    \x3c!-- å£°æéè¦æ´é²çæå¡æ¥å£ --\x3e\n    <dubbo:service interface="com.alibaba.dubbo.demo.DemoService" ref="demoServiceLocal" />\n    \x3c!-- åæ¬å° bean ä¸æ ·å®ç°æå¡ --\x3e\n    <bean id="demoService" class="com.alibaba.dubbo.demo.provider.DemoServiceImpl" />\n\n    \x3c!-- çæè¿ç¨æå¡ä»£çï¼å¯ä»¥åæ¬å° bean ä¸æ ·ä½¿ç¨ demoService --\x3e\n    <dubbo:reference id="demoServiceRemote" interface="com.alibaba.dubbo.demo.DemoService" />\n</beans>\n\n\nDubbo ä¼æä»¥ä¸éç½®é¡¹è§£ææä¸é¢ç URL æ ¼å¼ï¼\n\ndubbo://host-ip:20880/com.alibaba.dubbo.demo.DemoService\n\n\nç¶ååºäºæ©å±ç¹èªéåºæºå¶ï¼éè¿ URL ç dubbo:// åè®®å¤´è¯å«ï¼å°±ä¼è°ç¨ DubboProtocol ç export() æ¹æ³ï¼æå¼æå¡ç«¯å£ 20880ï¼å°±å¯ä»¥ææå¡ demoService æ´é²å° 20880 ç«¯å£äºã\n\n# properties éç½®\n\nç¤ºä¾ï¼\n\ndubbo.application.name=foo\ndubbo.application.owner=bar\ndubbo.registry.address=10.20.153.10:9090\n\n\n\n# éç½®é¡¹\n\nææéç½®é¡¹åä¸ºä¸å¤§ç±»ï¼\n\n * æå¡åç°ï¼è¡¨ç¤ºè¯¥éç½®é¡¹ç¨äºæå¡çæ³¨åä¸åç°ï¼ç®çæ¯è®©æ¶è´¹æ¹æ¾å°æä¾æ¹ã\n * æå¡æ²»çï¼è¡¨ç¤ºè¯¥éç½®é¡¹ç¨äºæ²»çæå¡é´çå³ç³»ï¼æä¸ºå¼åæµè¯æä¾ä¾¿å©æ¡ä»¶ã\n * æ§è½è°ä¼ï¼è¡¨ç¤ºè¯¥éç½®é¡¹ç¨äºè°ä¼æ§è½ï¼ä¸åçéé¡¹å¯¹æ§è½ä¼äº§çå½±åã\n\néç½®é¡¹æ¸åï¼\n\næ ç­¾                  ç¨é       è§£é\ndubbo:service       æå¡éç½®     ç¨äºæ´é²ä¸ä¸ªæå¡ï¼å®ä¹æå¡çåä¿¡æ¯ï¼ä¸ä¸ªæå¡å¯ä»¥ç¨å¤ä¸ªåè®®æ´é²ï¼ä¸ä¸ªæå¡ä¹å¯ä»¥æ³¨åå°å¤ä¸ªæ³¨åä¸­å¿\ndubbo:reference     å¼ç¨éç½®     ç¨äºåå»ºä¸ä¸ªè¿ç¨æå¡ä»£çï¼ä¸ä¸ªå¼ç¨å¯ä»¥æåå¤ä¸ªæ³¨åä¸­å¿\ndubbo:protocol      åè®®éç½®     ç¨äºéç½®æä¾æå¡çåè®®ä¿¡æ¯ï¼åè®®ç±æä¾æ¹æå®ï¼æ¶è´¹æ¹è¢«å¨æ¥å\ndubbo:application   åºç¨éç½®     ç¨äºéç½®å½ååºç¨ä¿¡æ¯ï¼ä¸ç®¡è¯¥åºç¨æ¯æä¾èè¿æ¯æ¶è´¹è\ndubbo:module        æ¨¡åéç½®     ç¨äºéç½®å½åæ¨¡åä¿¡æ¯ï¼å¯é\ndubbo:registry      æ³¨åä¸­å¿éç½®   ç¨äºéç½®è¿æ¥æ³¨åä¸­å¿ç¸å³ä¿¡æ¯\ndubbo:monitor       çæ§ä¸­å¿éç½®   ç¨äºéç½®è¿æ¥çæ§ä¸­å¿ç¸å³ä¿¡æ¯ï¼å¯é\ndubbo:provider      æä¾æ¹éç½®    å½ ProtocolConfig å ServiceConfig æå±æ§æ²¡æéç½®æ¶ï¼éç¨æ­¤ç¼ºçå¼ï¼å¯é\ndubbo:consumer      æ¶è´¹æ¹éç½®    å½ ReferenceConfig æå±æ§æ²¡æéç½®æ¶ï¼éç¨æ­¤ç¼ºçå¼ï¼å¯é\ndubbo:method        æ¹æ³éç½®     ç¨äº ServiceConfig å ReferenceConfig æå®æ¹æ³çº§çéç½®ä¿¡æ¯\ndubbo:argument      åæ°éç½®     ç¨äºæå®æ¹æ³åæ°éç½®\n\n> è¯¦ç»éç½®è¯´æè¯·åèï¼å®æ¹éç½®\n\n# éç½®ä¹é´çå³ç³»\n\n\n\n# éç½®è¦çå³ç³»\n\nä»¥ timeout ä¸ºä¾ï¼æ¾ç¤ºäºéç½®çæ¥æ¾é¡ºåºï¼å¶å® retries, loadbalance, actives ç­ç±»ä¼¼ï¼\n\n * æ¹æ³çº§ä¼åï¼æ¥å£çº§æ¬¡ä¹ï¼å¨å±éç½®åæ¬¡ä¹ã\n * å¦æçº§å«ä¸æ ·ï¼åæ¶è´¹æ¹ä¼åï¼æä¾æ¹æ¬¡ä¹ã\n\nå¶ä¸­ï¼æå¡æä¾æ¹éç½®ï¼éè¿ URL ç»ç±æ³¨åä¸­å¿ä¼ éç»æ¶è´¹æ¹ã\n\n\n### å¨æéç½®ä¸­å¿\n\néç½®ä¸­å¿ï¼v2.7.0ï¼å¨ Dubbo ä¸­æ¿æä¸¤ä¸ªèè´£ï¼\n\n 1. å¤é¨åéç½®ãå¯å¨éç½®çéä¸­å¼å­å¨ ï¼ç®åçè§£ä¸º dubbo.properties çå¤é¨åå­å¨ï¼ã\n 2. æå¡æ²»çãæå¡æ²»çè§åçå­å¨ä¸éç¥ã\n\nå¯ç¨å¨æéç½®ï¼\n\n<dubbo:config-center address="zookeeper://127.0.0.1:2181"/>\n\n\næè\n\ndubbo.config-center.address=zookeeper://127.0.0.1:2181\n\n\næè\n\nConfigCenterConfig configCenter = new ConfigCenterConfig();\nconfigCenter.setAddress("zookeeper://127.0.0.1:2181");\n\n\n\n# åãDubbo æ¶æ\n\n\n# Dubbo æ ¸å¿ç»ä»¶\n\n\n\nèç¹è§è²ï¼\n\nèç¹          è§è²è¯´æ\nProvider    æ´é²æå¡çæå¡æä¾æ¹\nConsumer    è°ç¨è¿ç¨æå¡çæå¡æ¶è´¹æ¹\nRegistry    æå¡æ³¨åä¸åç°çæ³¨åä¸­å¿\nMonitor     ç»è®¡æå¡çè°ç¨æ¬¡æ°åè°ç¨æ¶é´ççæ§ä¸­å¿\nContainer   æå¡è¿è¡å®¹å¨\n\nè°ç¨å³ç³»ï¼\n\n 1. æå¡å®¹å¨è´è´£å¯å¨ï¼å è½½ï¼è¿è¡æå¡æä¾èã\n 2. æå¡æä¾èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿æ³¨åèªå·±æä¾çæå¡ã\n 3. æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿è®¢éèªå·±æéçæå¡ã\n 4. æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æ¶è´¹èï¼å¦ææåæ´ï¼æ³¨åä¸­å¿å°åºäºé¿è¿æ¥æ¨éåæ´æ°æ®ç»æ¶è´¹èã\n 5. æå¡æ¶è´¹èï¼ä»æä¾èå°ååè¡¨ä¸­ï¼åºäºè½¯è´è½½åè¡¡ç®æ³ï¼éä¸å°æä¾èè¿è¡è°ç¨ï¼å¦æè°ç¨å¤±è´¥ï¼åéå¦ä¸å°è°ç¨ã\n 6. æå¡æ¶è´¹èåæä¾èï¼å¨åå­ä¸­ç´¯è®¡è°ç¨æ¬¡æ°åè°ç¨æ¶é´ï¼å®æ¶æ¯åéåéä¸æ¬¡ç»è®¡æ°æ®å°çæ§ä¸­å¿ã\n\néè¦ç¥è¯ç¹æ»ç»ï¼\n\n * æ³¨åä¸­å¿è´è´£æå¡å°åçæ³¨åä¸æ¥æ¾ï¼ç¸å½äºç®å½æå¡ï¼æå¡æä¾èåæ¶è´¹èåªå¨å¯å¨æ¶ä¸æ³¨åä¸­å¿äº¤äºï¼æ³¨åä¸­å¿ä¸è½¬åè¯·æ±ï¼ååè¾å°\n * çæ§ä¸­å¿è´è´£ç»è®¡åæå¡è°ç¨æ¬¡æ°ï¼è°ç¨æ¶é´ç­ï¼ç»è®¡åå¨åå­æ±æ»åæ¯åéä¸æ¬¡åéå°çæ§ä¸­å¿æå¡å¨ï¼å¹¶ä»¥æ¥è¡¨å±ç¤º\n * æ³¨åä¸­å¿ï¼æå¡æä¾èï¼æå¡æ¶è´¹èä¸èä¹é´åä¸ºé¿è¿æ¥ï¼çæ§ä¸­å¿é¤å¤\n * æ³¨åä¸­å¿éè¿é¿è¿æ¥æç¥æå¡æä¾èçå­å¨ï¼æå¡æä¾èå®æºï¼æ³¨åä¸­å¿å°ç«å³æ¨éäºä»¶éç¥æ¶è´¹è\n * æ³¨åä¸­å¿åçæ§ä¸­å¿å¨é¨å®æºï¼ä¸å½±åå·²è¿è¡çæä¾èåæ¶è´¹èï¼æ¶è´¹èå¨æ¬å°ç¼å­äºæä¾èåè¡¨\n * æ³¨åä¸­å¿åçæ§ä¸­å¿é½æ¯å¯éçï¼æå¡æ¶è´¹èå¯ä»¥ç´è¿æå¡æä¾è\n * æå¡æä¾èæ ç¶æï¼ä»»æä¸å°å®æåï¼ä¸å½±åä½¿ç¨\n * æå¡æä¾èå¨é¨å®æåï¼æå¡æ¶è´¹èåºç¨å°æ æ³ä½¿ç¨ï¼å¹¶æ éæ¬¡éè¿ç­å¾æå¡æä¾èæ¢å¤\n\n> é®ï¼æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼\n> \n> ç­ï¼å¯ä»¥ï¼å ä¸ºåå¼å§åå§åçæ¶åï¼æ¶è´¹èä¼å°æä¾èçå°åç­ä¿¡æ¯æåå°æ¬å°ç¼å­ï¼æä»¥æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡ã\n\n\n# Dubbo æ¶æå±æ¬¡\n\n\n\nå¾ä¾è¯´æï¼\n\n * å¾ä¸­å·¦è¾¹æ·¡èèæ¯çä¸ºæå¡æ¶è´¹æ¹ä½¿ç¨çæ¥å£ï¼å³è¾¹æ·¡ç»¿è²èæ¯çä¸ºæå¡æä¾æ¹ä½¿ç¨çæ¥å£ï¼ä½äºä¸­è½´çº¿ä¸çä¸ºåæ¹é½ç¨å°çæ¥å£ã\n * å¾ä¸­ä»ä¸è³ä¸åä¸ºåå±ï¼åå±åä¸ºååä¾èµï¼å³è¾¹çé»è²ç®­å¤´ä»£è¡¨å±ä¹é´çä¾èµå³ç³»ï¼æ¯ä¸å±é½å¯ä»¥å¥ç¦»ä¸å±è¢«å¤ç¨ï¼å¶ä¸­ï¼Service å Config å±ä¸º APIï¼å¶å®åå±åä¸º SPIã\n * å¾ä¸­ç»¿è²å°åçä¸ºæ©å±æ¥å£ï¼èè²å°åä¸ºå®ç°ç±»ï¼å¾ä¸­åªæ¾ç¤ºç¨äºå³èåå±çå®ç°ç±»ã\n * å¾ä¸­èè²èçº¿ä¸ºåå§åè¿ç¨ï¼å³å¯å¨æ¶ç»è£é¾ï¼çº¢è²å®çº¿ä¸ºæ¹æ³è°ç¨è¿ç¨ï¼å³è¿è¡æ¶è°æ¶é¾ï¼ç´«è²ä¸è§ç®­å¤´ä¸ºç»§æ¿ï¼å¯ä»¥æå­ç±»çä½ç¶ç±»çåä¸ä¸ªèç¹ï¼çº¿ä¸çæå­ä¸ºè°ç¨çæ¹æ³ã\n\n# åå±è¯´æ\n\n * config éç½®å±ï¼å¯¹å¤éç½®æ¥å£ï¼ä»¥ ServiceConfig, ReferenceConfig ä¸ºä¸­å¿ï¼å¯ä»¥ç´æ¥åå§åéç½®ç±»ï¼ä¹å¯ä»¥éè¿ spring è§£æéç½®çæéç½®ç±»\n * proxy æå¡ä»£çå±ï¼æå¡æ¥å£éæä»£çï¼çææå¡çå®¢æ·ç«¯ Stub åæå¡å¨ç«¯ Skeleton, ä»¥ ServiceProxy ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º ProxyFactory\n * registry æ³¨åä¸­å¿å±ï¼å°è£æå¡å°åçæ³¨åä¸åç°ï¼ä»¥æå¡ URL ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º RegistryFactory, Registry, RegistryService\n * cluster è·¯ç±å±ï¼å°è£å¤ä¸ªæä¾èçè·¯ç±åè´è½½åè¡¡ï¼å¹¶æ¡¥æ¥æ³¨åä¸­å¿ï¼ä»¥ Invoker ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º Cluster, Directory, Router, LoadBalance\n * monitor çæ§å±ï¼RPC è°ç¨æ¬¡æ°åè°ç¨æ¶é´çæ§ï¼ä»¥ Statistics ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º MonitorFactory, Monitor, MonitorService\n * protocol è¿ç¨è°ç¨å±ï¼å°è£ RPC è°ç¨ï¼ä»¥ Invocation, Result ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º Protocol, Invoker, Exporter\n * exchange ä¿¡æ¯äº¤æ¢å±ï¼å°è£è¯·æ±ååºæ¨¡å¼ï¼åæ­¥è½¬å¼æ­¥ï¼ä»¥ Request, Response ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º Exchanger, ExchangeChannel, ExchangeClient, ExchangeServer\n * transport ç½ç»ä¼ è¾å±ï¼æ½è±¡ mina å netty ä¸ºç»ä¸æ¥å£ï¼ä»¥ Message ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º Channel, Transporter, Client, Server, Codec\n * serialize æ°æ®åºååå±ï¼å¯å¤ç¨çä¸äºå·¥å·ï¼æ©å±æ¥å£ä¸º Serialization, ObjectInput, ObjectOutput, ThreadPool\n * serialize æ°æ®åºååå±ï¼å¯å¤ç¨çä¸äºå·¥å·ï¼æ©å±æ¥å£ä¸º Serialization, ObjectInput, ObjectOutput, ThreadPool\n\n# åå±å³ç³»è¯´æ\n\n * å¨ RPC ä¸­ï¼Protocol æ¯æ ¸å¿å±ï¼ä¹å°±æ¯åªè¦æ Protocol + Invoker + Exporter å°±å¯ä»¥å®æééæç RPC è°ç¨ï¼ç¶åå¨ Invoker çä¸»è¿ç¨ä¸ Filter æ¦æªç¹ã\n * å¾ä¸­ç Consumer å Provider æ¯æ½è±¡æ¦å¿µï¼åªæ¯æ³è®©çå¾èæ´ç´è§çäºè§£åªäºç±»åå±äºå®¢æ·ç«¯ä¸æå¡å¨ç«¯ï¼ä¸ç¨ Client å Server çåå æ¯ Dubbo å¨å¾å¤åºæ¯ä¸é½ä½¿ç¨ Provider, Consumer, Registry, Monitor ååé»è¾ææ®èç¹ï¼ä¿æç»ä¸æ¦å¿µã\n * è Cluster æ¯å¤å´æ¦å¿µï¼æä»¥ Cluster çç®çæ¯å°å¤ä¸ª Invoker ä¼ªè£æä¸ä¸ª Invokerï¼è¿æ ·å¶å®äººåªè¦å³æ³¨ Protocol å± Invoker å³å¯ï¼å ä¸ Cluster æèå»æ Cluster å¯¹å¶å®å±é½ä¸ä¼é æå½±åï¼å ä¸ºåªæä¸ä¸ªæä¾èæ¶ï¼æ¯ä¸éè¦ Cluster çã\n * Proxy å±å°è£äºæææ¥å£çéæåä»£çï¼èå¨å¶å®å±é½ä»¥ Invoker ä¸ºä¸­å¿ï¼åªæå°äºæ´é²ç»ç¨æ·ä½¿ç¨æ¶ï¼æç¨ Proxy å° Invoker è½¬ææ¥å£ï¼æå°æ¥å£å®ç°è½¬æ Invokerï¼ä¹å°±æ¯å»æ Proxy å± RPC æ¯å¯ä»¥ Run çï¼åªæ¯ä¸é£ä¹éæï¼ä¸é£ä¹çèµ·æ¥åè°æ¬å°æå¡ä¸æ ·è°è¿ç¨æå¡ã\n * è Remoting å®ç°æ¯ Dubbo åè®®çå®ç°ï¼å¦æä½ éæ© RMI åè®®ï¼æ´ä¸ª Remoting é½ä¸ä¼ç¨ä¸ï¼Remoting åé¨ååä¸º Transport ä¼ è¾å±å Exchange ä¿¡æ¯äº¤æ¢å±ï¼Transport å±åªè´è´£ååæ¶æ¯ä¼ è¾ï¼æ¯å¯¹ Mina, Netty, Grizzly çæ½è±¡ï¼å®ä¹å¯ä»¥æ©å± UDP ä¼ è¾ï¼è Exchange å±æ¯å¨ä¼ è¾å±ä¹ä¸å°è£äº Request-Response è¯­ä¹ã\n * Registry å Monitor å®éä¸ä¸ç®ä¸å±ï¼èæ¯ä¸ä¸ªç¬ç«çèç¹ï¼åªæ¯ä¸ºäºå¨å±æ¦è§ï¼ç¨å±çæ¹å¼ç»å¨ä¸èµ·ã\n\n\n# äºãæå¡åç°\n\næå¡æä¾èæ³¨åæå¡çè¿ç¨ï¼\n\nDubbo éç½®é¡¹ dubbo://registry å£°æäºæ³¨åä¸­å¿çå°åï¼Dubbo ä¼æä»¥ä¸éç½®é¡¹è§£ææç±»ä¼¼ä¸é¢ç URL æ ¼å¼ï¼\n\nregistry://multicast://224.5.6.7:1234/com.alibaba.dubbo.registry.RegistryService?export=URL.encode("dubbo://host-ip:20880/com.alibaba.dubbo.demo.DemoService")\n\n\nç¶ååºäºæ©å±ç¹èªéåºæºå¶ï¼éè¿ URL çâregistry://âåè®®å¤´è¯å«ï¼å°±ä¼è°ç¨ RegistryProtocol ç export() æ¹æ³ï¼å° export åæ°ä¸­çæä¾è URLï¼æ³¨åå°æ³¨åä¸­å¿ã\n\næå¡æ¶è´¹èåç°æå¡çè¿ç¨ï¼\n\nDubbo éç½®é¡¹ dubbo://registry å£°æäºæ³¨åä¸­å¿çå°åï¼è·æå¡æ³¨åçåçç±»ä¼¼ï¼Dubbo ä¹ä¼æä»¥ä¸éç½®é¡¹è§£ææä¸é¢ç URL æ ¼å¼ï¼\n\nregistry://multicast://224.5.6.7:1234/com.alibaba.dubbo.registry.RegistryService?refer=URL.encode("consummer://host-ip/com.alibaba.dubbo.demo.DemoService")\n\n\nç¶ååºäºæ©å±ç¹èªéåºæºå¶ï¼éè¿ URL çâregistry://âåè®®å¤´è¯å«ï¼å°±ä¼è°ç¨ RegistryProtocol ç refer() æ¹æ³ï¼åºäº refer åæ°ä¸­çæ¡ä»¶ï¼æ¥è¯¢æå¡ demoService çå°åã\n\n\n# å¯å¨æ¶æ£æ¥\n\nDubbo ç¼ºçä¼å¨å¯å¨æ¶æ£æ¥ä¾èµçæå¡æ¯å¦å¯ç¨ï¼ä¸å¯ç¨æ¶ä¼æåºå¼å¸¸ï¼é»æ­¢ Spring åå§åå®æï¼ä»¥ä¾¿ä¸çº¿æ¶ï¼è½åæ©åç°é®é¢ï¼é»è®¤ check="true"ã\n\nå¯ä»¥éè¿ xmlãpropertiesã-D åæ°ä¸ç§æ¹å¼è®¾ç½®ãå¯å¨æ¶æ£æ¥\n\n\n# å­ãDubbo åè®®\n\nDubbo æ¯æå¤ç§éä¿¡åè®®ï¼ä¸åçåè®®éå¯¹ä¸åçåºååæ¹å¼ã\n\n\n# dubbo åè®®\n\ndubbo åè®®æ¯ Dubbo çé»è®¤éä¿¡åè®®ï¼éç¨åä¸é¿è¿æ¥å NIO å¼æ­¥éä¿¡ï¼åºäº hessian ä½ä¸ºåºåååè®®ã\n\ndubbo åè®®éåäºå°æ°æ®éå¤§å¹¶åçæå¡è°ç¨ï¼ä»¥åæå¡æ¶è´¹èæºå¨æ°è¿å¤§äºæå¡æä¾èæºå¨æ°çæåµãåä¹ï¼Dubbo ç¼ºçåè®®ä¸éåä¼ éå¤§æ°æ®éçæå¡ï¼æ¯å¦ä¼ æä»¶ï¼ä¼ è§é¢ç­ï¼é¤éè¯·æ±éå¾ä½ã\n\nä¸ºäºè¦æ¯æé«å¹¶ååºæ¯ï¼ä¸è¬æ¯æå¡æä¾èå°±å å°æºå¨ï¼ä½æ¯æå¡æ¶è´¹èæä¸ç¾å°ï¼å¯è½æ¯å¤©è°ç¨éè¾¾å°ä¸äº¿æ¬¡ï¼æ­¤æ¶ç¨é¿è¿æ¥æ¯æåéçï¼å°±æ¯è·æ¯ä¸ªæå¡æ¶è´¹èç»´æä¸ä¸ªé¿è¿æ¥å°±å¯ä»¥ï¼å¯è½æ»å±å°± 100 ä¸ªè¿æ¥ãç¶ååé¢ç´æ¥åºäºé¿è¿æ¥ NIO å¼æ­¥éä¿¡ï¼å¯ä»¥æ¯æé«å¹¶åè¯·æ±ã\n\n\n# rmi åè®®\n\nrmi - éç¨ JDK æ åç java.rmi.* å®ç°ï¼éç¨é»å¡å¼ç­è¿æ¥å JDK æ ååºååæ¹å¼ã\n\næ³¨æï¼å¦ææ­£å¨ä½¿ç¨ RMI æä¾æå¡ç»å¤é¨è®¿é®ï¼åæ¶åºç¨éä¾èµäºèç common-collections åçæåµä¸ï¼å­å¨ååºååå®å¨é£é©ã\n\n\n# hessian åè®®\n\nhessian åè®®ç¨äºéæ Hessian çæå¡ï¼Hessian åºå±éç¨ Http éè®¯ï¼éç¨ Servlet æ´é²æå¡ï¼Dubbo ç¼ºçååµ Jetty ä½ä¸ºæå¡å¨å®ç°ã\n\nDubbo ç Hessian åè®®å¯ä»¥ååç Hessian æå¡äºæä½ï¼å³ï¼\n\n * æä¾èç¨ Dubbo ç Hessian åè®®æ´é²æå¡ï¼æ¶è´¹èç´æ¥ç¨æ å Hessian æ¥å£è°ç¨\n * æèæä¾æ¹ç¨æ å Hessian æ´é²æå¡ï¼æ¶è´¹æ¹ç¨ Dubbo ç Hessian åè®®è°ç¨ã\n\n\n# thrift åè®®\n\nå½å dubbo æ¯æç thrift åè®®æ¯å¯¹ thrift åçåè®®çæ©å±ï¼å¨åçåè®®çåºç¡ä¸æ·»å äºä¸äºé¢å¤çå¤´ä¿¡æ¯ï¼æ¯å¦ service nameï¼magic number ç­ã\n\nä½¿ç¨ dubbo thrift åè®®åæ ·éè¦ä½¿ç¨ thrift ç idl compiler ç¼è¯çæç¸åºç java ä»£ç ï¼åç»­çæ¬ä¸­ä¼å¨è¿æ¹é¢åä¸äºå¢å¼ºã\n\n\n# http åè®®\n\nhttp åè®®åºäº HTTP è¡¨åçè¿ç¨è°ç¨åè®®ï¼éç¨ Spring ç HttpInvoker å®ç°ã\n\nä½¿ç¨ JSON åºååæ¹å¼ã\n\n\n# webservice åè®®\n\nåºäº WebService çè¿ç¨è°ç¨åè®®ï¼åºäº Apache CXF ç frontend-simple å transports-http å®ç°ã\n\nä½¿ç¨ SOAP åºååæ¹å¼ã\n\nå¯ä»¥ååç WebService æå¡äºæä½ï¼å³ï¼\n\n * æä¾èç¨ Dubbo ç WebService åè®®æ´é²æå¡ï¼æ¶è´¹èç´æ¥ç¨æ å WebService æ¥å£è°ç¨ï¼\n * æèæä¾æ¹ç¨æ å WebService æ´é²æå¡ï¼æ¶è´¹æ¹ç¨ Dubbo ç WebService åè®®è°ç¨ã\n\n\n# rest åè®®\n\nåºäºæ åç Java REST APIââJAX-RS 2.0ï¼Java API for RESTful Web Services çç®åï¼å®ç°ç REST è°ç¨æ¯æ\n\n\n# memcached åè®®\n\nåºäº memcached å®ç°ç RPC åè®®ã\n\n\n# redis åè®®\n\nåºäº redis å®ç°ç RPC åè®®ã\n\n> å¨ç°å®ä¸çä¸­ï¼åºååæå¤ç§æ¹å¼ã\n> \n> JDK èªèº«æä¾çåºååæ¹å¼ï¼æçä¸é«ï¼ä½æ¯ Java ç¨åºä½¿ç¨æå¤ã\n> \n> å¦ææ³è¦è¾å¥½çå¯è¯»æ§ï¼å¯ä»¥ä½¿ç¨ JSON ï¼å¸¸è§åºæï¼jacksonãgsonãfastjsonï¼æ SOAP ï¼å³ xml å½¢å¼ï¼\n> \n> å¦ææ³è¦æ´å¥½çæ§è½ï¼å¯ä»¥ä½¿ç¨ thriftãprotobufãhessian\n> \n> æ³æ·±å¥äºè§£å¯ä»¥åèï¼åºåå\n\n\n# ä¸ãéç¾¤å®¹é\n\nå¨éç¾¤è°ç¨å¤±è´¥æ¶ï¼Dubbo æä¾äºå¤ç§å®¹éæ¹æ¡ï¼ç¼ºçä¸º failover éè¯ã\n\n\n * Failover - å¤±è´¥èªå¨åæ¢ï¼å½åºç°å¤±è´¥ï¼éè¯å¶å®æå¡å¨ãéå¸¸ç¨äºè¯»æä½ï¼ä½éè¯ä¼å¸¦æ¥æ´é¿å»¶è¿ãå¯éè¿ retries="2" æ¥è®¾ç½®éè¯æ¬¡æ°(ä¸å«ç¬¬ä¸æ¬¡)ã\n * Failfast - å¿«éå¤±è´¥ï¼åªåèµ·ä¸æ¬¡è°ç¨ï¼å¤±è´¥ç«å³æ¥éãéå¸¸ç¨äºéå¹ç­æ§çåæä½ï¼æ¯å¦æ°å¢è®°å½ã\n * Failsafe - å¤±è´¥å®å¨ï¼åºç°å¼å¸¸æ¶ï¼ç´æ¥å¿½ç¥ãéå¸¸ç¨äºåå¥å®¡è®¡æ¥å¿ç­æä½ã\n * Failback - å¤±è´¥èªå¨æ¢å¤ï¼åå°è®°å½å¤±è´¥è¯·æ±ï¼å®æ¶éåãéå¸¸ç¨äºæ¶æ¯éç¥æä½ã\n * Forking - å¹¶è¡è°ç¨å¤ä¸ªæå¡å¨ï¼åªè¦ä¸ä¸ªæåå³è¿åãéå¸¸ç¨äºå®æ¶æ§è¦æ±è¾é«çè¯»æä½ï¼ä½éè¦æµªè´¹æ´å¤æå¡èµæºãå¯éè¿ forks="2" æ¥è®¾ç½®æå¤§å¹¶è¡æ°ã\n * Broadcast - å¹¿æ­è°ç¨æææä¾èï¼éä¸ªè°ç¨ï¼ä»»æä¸å°æ¥éåæ¥éãéå¸¸ç¨äºéç¥æææä¾èæ´æ°ç¼å­ææ¥å¿ç­æ¬å°èµæºä¿¡æ¯ã\n\néç¾¤å®¹ééç½®ç¤ºä¾ï¼\n\n<dubbo:service cluster="failsafe" />\n<dubbo:reference cluster="failsafe" />\n\n\n\n# å«ãè´è½½åè¡¡\n\nDubbo æä¾äºå¤ç§è´è½½åè¡¡ï¼LoadBalanceï¼ç­ç¥ï¼ç¼ºçä¸º Random éæºè°ç¨ã\n\nDubbo çè´è½½åè¡¡éç½®å¯ä»¥ç»ç²åº¦å°æå¡ãæ¹æ³çº§å«ï¼ä¸ dubbo:service å dubbo:reference åå¯éç½®ã\n\n\x3c!-- æå¡ç«¯æå¡çº§å« --\x3e\n<dubbo:service interface="..." loadbalance="roundrobin" />\n\x3c!-- å®¢æ·ç«¯æå¡çº§å« --\x3e\n<dubbo:reference interface="..." loadbalance="roundrobin" />\n\x3c!-- æå¡ç«¯æ¹æ³çº§å« --\x3e\n<dubbo:service interface="...">\n    <dubbo:method name="..." loadbalance="roundrobin"/>\n</dubbo:service>\n\x3c!-- å®¢æ·ç«¯æ¹æ³çº§å« --\x3e\n<dubbo:reference interface="...">\n    <dubbo:method name="..." loadbalance="roundrobin"/>\n</dubbo:reference>\n\n\n# Random\n\n * éæºï¼ææéè®¾ç½®éæºæ¦çã\n * å¨ä¸ä¸ªæªé¢ä¸ç¢°æçæ¦çé«ï¼ä½è°ç¨éè¶å¤§åå¸è¶ååï¼èä¸ææ¦çä½¿ç¨æéåä¹æ¯è¾ååï¼æå©äºå¨æè°æ´æä¾èæéã\n\n# RoundRobin\n\n * è½®è¯¢ï¼æå¬çº¦åçæéè®¾ç½®è½®è¯¢æ¯çã\n * å­å¨æ¢çæä¾èç´¯ç§¯è¯·æ±çé®é¢ï¼æ¯å¦ï¼ç¬¬äºå°æºå¨å¾æ¢ï¼ä½æ²¡æï¼å½è¯·æ±è°å°ç¬¬äºå°æ¶å°±å¡å¨é£ï¼ä¹èä¹ä¹ï¼ææè¯·æ±é½å¡å¨è°å°ç¬¬äºå°ä¸ã\n\n# LeastActive\n\n * æå°æ´»è·è°ç¨æ°ï¼ç¸åæ´»è·æ°çéæºï¼æ´»è·æ°æè°ç¨ååè®¡æ°å·®ã\n * ä½¿æ¢çæä¾èæ¶å°æ´å°è¯·æ±ï¼å ä¸ºè¶æ¢çæä¾èçè°ç¨ååè®¡æ°å·®ä¼è¶å¤§ã\n\n# ConsistentHash\n\n * ä¸è´æ§ Hashï¼ç¸ååæ°çè¯·æ±æ»æ¯åå°åä¸æä¾èã\n * å½æä¸å°æä¾èææ¶ï¼åæ¬åå¾è¯¥æä¾èçè¯·æ±ï¼åºäºèæèç¹ï¼å¹³æå°å¶å®æä¾èï¼ä¸ä¼å¼èµ·å§çåå¨ã\n * ç®æ³åè§ï¼http://en.wikipedia.org/wiki/Consistent_hashing\n * ç¼ºçåªå¯¹ç¬¬ä¸ä¸ªåæ° Hashï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.arguments" value="0,1" />\n * ç¼ºçç¨ 160 ä»½èæèç¹ï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.nodes" value="320" />\n\n\n# ä¹ãDubbo æå¡æ²»ç\n\n\n# æå¡æ²»çç®ä»\n\n * å½æå¡è¶æ¥è¶å¤æ¶ï¼æå¡ URL éç½®ç®¡çåå¾éå¸¸å°é¾ï¼F5 ç¡¬ä»¶è´è½½åè¡¡å¨çåç¹ååä¹è¶æ¥è¶å¤§ã\n * å½è¿ä¸æ­¥åå±ï¼æå¡é´ä¾èµå³ç³»åå¾éè¸ªå¤æï¼çè³åä¸æ¸åªä¸ªåºç¨è¦å¨åªä¸ªåºç¨ä¹åå¯å¨ï¼æ¶æå¸é½ä¸è½å®æ´çæè¿°åºç¨çæ¶æå³ç³»ã\n * æ¥çï¼æå¡çè°ç¨éè¶æ¥è¶å¤§ï¼æå¡çå®¹éé®é¢å°±æ´é²åºæ¥ï¼è¿ä¸ªæå¡éè¦å¤å°æºå¨æ¯æï¼ä»ä¹æ¶åè¯¥å æºå¨ï¼\n\nä»¥ä¸é®é¢å¯ä»¥å½çº³ä¸ºæå¡æ²»çé®é¢ï¼è¿ä¹æ¯ Dubbo çæ ¸å¿åè½ã\n\n# è°ç¨é¾è·¯\n\nä¸ä¸ªå¾®æå¡æ¶æï¼å¾å¾ç±å¤§éåå¸å¼æå¡ç»æãé£ä¹è¿äºæå¡ä¹é´äºç¸æ¯å¦ä½è°ç¨çï¼è°ç¨é¾è·¯æ¯å¥ï¼è¯´å®è¯ï¼å ä¹å°åé¢æ²¡äººæçæ¸æ¥äºï¼å ä¸ºæå¡å®å¨å¤ªå¤äºï¼å¯è½å ç¾ä¸ªçè³å åä¸ªæå¡ã\n\né£å°±éè¦åºäº dubbo åçåå¸å¼ç³»ç»ä¸­ï¼å¯¹åä¸ªæå¡ä¹é´çè°ç¨èªå¨è®°å½ä¸æ¥ï¼ç¶åèªå¨å°åä¸ªæå¡ä¹é´çä¾èµå³ç³»åè°ç¨é¾è·¯çæåºæ¥ï¼åæä¸å¼ å¾ï¼æ¾ç¤ºåºæ¥ï¼å¤§å®¶æå¯ä»¥çå°å¯¹å§ã\n\n# æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡\n\néè¦èªå¨ç»è®¡åä¸ªæ¥å£åæå¡ä¹é´çè°ç¨æ¬¡æ°ä»¥åè®¿é®å»¶æ¶ï¼èä¸è¦åæä¸¤ä¸ªçº§å«ã\n\n * ä¸ä¸ªçº§å«æ¯æ¥å£ç²åº¦ï¼å°±æ¯æ¯ä¸ªæå¡çæ¯ä¸ªæ¥å£æ¯å¤©è¢«è°ç¨å¤å°æ¬¡ï¼TP50/TP90/TP99ï¼ä¸ä¸ªæ¡£æ¬¡çè¯·æ±å»¶æ¶åå«æ¯å¤å°ï¼\n * ç¬¬äºä¸ªçº§å«æ¯ä»æºå¤´å¥å£å¼å§ï¼ä¸ä¸ªå®æ´çè¯·æ±é¾è·¯ç»è¿å åä¸ªæå¡ä¹åï¼å®æä¸æ¬¡è¯·æ±ï¼æ¯å¤©å¨é¾è·¯èµ°å¤å°æ¬¡ï¼å¨é¾è·¯è¯·æ±å»¶æ¶ç TP50/TP90/TP99ï¼åå«æ¯å¤å°ã\n\n# å¶ä»\n\n * æå¡åå±ï¼é¿åå¾ªç¯ä¾èµï¼\n * è°ç¨é¾è·¯å¤±è´¥çæ§åæ¥è­¦\n * æå¡é´æ\n * æ¯ä¸ªæå¡çå¯ç¨æ§ççæ§ï¼æ¥å£è°ç¨æåçï¼å ä¸ª 9ï¼99.99%ï¼99.9%ï¼99%ï¼\n\næè°å¤±è´¥éè¯ï¼å°±æ¯ consumer è°ç¨ provider è¦æ¯å¤±è´¥äºï¼æ¯å¦æå¼å¸¸äºï¼æ­¤æ¶åºè¯¥æ¯å¯ä»¥éè¯çï¼æèè°ç¨è¶æ¶äºä¹å¯ä»¥éè¯ãéç½®å¦ä¸ï¼\n\n<dubbo:reference id="xxxx" interface="xx" check="true" async="false" retries="3" timeout="2000"/>\n\n\nä¸¾ä¸ªæ å­ã\n\næä¸ªæå¡çæ¥å£ï¼è¦èè´¹ 5sï¼ä½ è¿è¾¹ä¸è½å¹²ç­çï¼ä½ è¿è¾¹éç½®äº timeout ä¹åï¼æç­å¾ 2sï¼è¿æ²¡è¿åï¼æç´æ¥å°±æ¤äºï¼ä¸è½å¹²ç­ä½ ã\n\nå¯ä»¥ç»åä½ ä»¬å¬å¸å·ä½çåºæ¯æ¥è¯´è¯´ä½ æ¯æä¹è®¾ç½®è¿äºåæ°çï¼\n\n * timeoutï¼ä¸è¬è®¾ç½®ä¸º 200msï¼æä»¬è®¤ä¸ºä¸è½è¶è¿ 200ms è¿æ²¡è¿åã\n * retriesï¼è®¾ç½® retriesï¼ä¸è¬æ¯å¨è¯»è¯·æ±çæ¶åï¼æ¯å¦ä½ è¦æ¥è¯¢ä¸ªæ°æ®ï¼ä½ å¯ä»¥è®¾ç½®ä¸ª retriesï¼å¦æç¬¬ä¸æ¬¡æ²¡è¯»å°ï¼æ¥éï¼éè¯æå®çæ¬¡æ°ï¼å°è¯åæ¬¡è¯»åã\n\n\n# è·¯ç±è§å\n\nè·¯ç±è§åå³å®ä¸æ¬¡ dubbo æå¡è°ç¨çç®æ æå¡å¨ï¼åä¸ºæ¡ä»¶è·¯ç±è§ååèæ¬è·¯ç±è§åï¼å¹¶ä¸æ¯æå¯æ©å±ã\n\nåæ³¨åä¸­å¿åå¥è·¯ç±è§åçæä½éå¸¸ç±çæ§ä¸­å¿ææ²»çä¸­å¿çé¡µé¢å®æã\n\nRegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();\nRegistry registry = registryFactory.getRegistry(URL.valueOf("zookeeper://10.20.153.10:2181"));\nregistry.register(URL.valueOf("condition://0.0.0.0/com.foo.BarService?category=routers&dynamic=false&rule=" + URL.encode("host = 10.20.153.10 => host = 10.20.153.11") + "));\n\n\n * condition:// - è¡¨ç¤ºè·¯ç±è§åçç±»åï¼æ¯ææ¡ä»¶è·¯ç±è§ååèæ¬è·¯ç±è§åï¼å¯æ©å±ï¼å¿å¡«ã\n * 0.0.0.0 - è¡¨ç¤ºå¯¹ææ IP å°åçæï¼å¦æåªæ³å¯¹æä¸ª IP ççæï¼è¯·å¡«å¥å·ä½ IPï¼å¿å¡«ã\n * com.foo.BarService - è¡¨ç¤ºåªå¯¹æå®æå¡çæï¼å¿å¡«ã\n * category=routers - è¡¨ç¤ºè¯¥æ°æ®ä¸ºå¨æéç½®ç±»åï¼å¿å¡«ã\n * dynamic=false - è¡¨ç¤ºè¯¥æ°æ®ä¸ºæä¹æ°æ®ï¼å½æ³¨åæ¹éåºæ¶ï¼æ°æ®ä¾ç¶ä¿å­å¨æ³¨åä¸­å¿ï¼å¿å¡«ã\n * enabled=true - è¦çè§åæ¯å¦çæï¼å¯ä¸å¡«ï¼ç¼ºççæã\n * force=false - å½è·¯ç±ç»æä¸ºç©ºæ¶ï¼æ¯å¦å¼ºå¶æ§è¡ï¼å¦æä¸å¼ºå¶æ§è¡ï¼è·¯ç±ç»æä¸ºç©ºçè·¯ç±è§åå°èªå¨å¤±æï¼å¯ä¸å¡«ï¼ç¼ºçä¸º flaseã\n * runtime=false - æ¯å¦å¨æ¯æ¬¡è°ç¨æ¶æ§è¡è·¯ç±è§åï¼å¦ååªå¨æä¾èå°ååè¡¨åæ´æ¶é¢åæ§è¡å¹¶ç¼å­ç»æï¼è°ç¨æ¶ç´æ¥ä»ç¼å­ä¸­è·åè·¯ç±ç»æãå¦æç¨äºåæ°è·¯ç±ï¼å¿é¡»è®¾ä¸º trueï¼éè¦æ³¨æè®¾ç½®ä¼å½±åè°ç¨çæ§è½ï¼å¯ä¸å¡«ï¼ç¼ºçä¸º flaseã\n * priority=1 - è·¯ç±è§åçä¼åçº§ï¼ç¨äºæåºï¼ä¼åçº§è¶å¤§è¶é åæ§è¡ï¼å¯ä¸å¡«ï¼ç¼ºçä¸º 0ã\n * rule=URL.encode("host = 10.20.153.10 => host = 10.20.153.11") - è¡¨ç¤ºè·¯ç±è§åçåå®¹ï¼å¿å¡«ã\n\n\n# æå¡éçº§\n\nå¯ä»¥éè¿æå¡éçº§åè½ä¸´æ¶å±è½æä¸ªåºéçéå³é®æå¡ï¼å¹¶å®ä¹éçº§åçè¿åç­ç¥ã\n\nåæ³¨åä¸­å¿åå¥å¨æéç½®è¦çè§åï¼\n\nRegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();\nRegistry registry = registryFactory.getRegistry(URL.valueOf("zookeeper://10.20.153.10:2181"));\nregistry.register(URL.valueOf("override://0.0.0.0/com.foo.BarService?category=configurators&dynamic=false&application=foo&mock=force:return+null"));\n\n\nå¶ä¸­ï¼\n\nmock=force:return+null è¡¨ç¤ºæ¶è´¹æ¹å¯¹è¯¥æå¡çæ¹æ³è°ç¨é½ç´æ¥è¿å null å¼ï¼ä¸åèµ·è¿ç¨è°ç¨ãç¨æ¥å±è½ä¸éè¦æå¡ä¸å¯ç¨æ¶å¯¹è°ç¨æ¹çå½±åã è¿å¯ä»¥æ¹ä¸º mock=fail:return+null è¡¨ç¤ºæ¶è´¹æ¹å¯¹è¯¥æå¡çæ¹æ³è°ç¨å¨å¤±è´¥åï¼åè¿å null å¼ï¼ä¸æå¼å¸¸ãç¨æ¥å®¹å¿ä¸éè¦æå¡ä¸ç¨³å®æ¶å¯¹è°ç¨æ¹çå½±åã\n\næ¯å¦è¯´æå¡ A è°ç¨æå¡ Bï¼ç»ææå¡ B ææäºï¼æå¡ A éè¯å æ¬¡è°ç¨æå¡ Bï¼è¿æ¯ä¸è¡ï¼é£ä¹ç´æ¥éçº§ï¼èµ°ä¸ä¸ªå¤ç¨çé»è¾ï¼ç»ç¨æ·è¿åååºã\n\nä¸¾ä¸ªä¾å­ï¼æä»¬ææ¥å£ HelloServiceãHelloServiceImpl æè¯¥æ¥å£çå·ä½å®ç°ã\n\npublic interface HelloService {\n   void sayHello();\n}\n\npublic class HelloServiceImpl implements HelloService {\n    public void sayHello() {\n        System.out.println("hello world......");\n    }\n}\n\n\nDubbo éç½®ï¼\n\n\x3c!-- provider éç½® --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n    xsi:schemaLocation="http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n\n    <dubbo:application name="dubbo-provider" />\n    <dubbo:registry address="zookeeper://127.0.0.1:2181" />\n    <dubbo:protocol name="dubbo" port="20880" />\n    <dubbo:service interface="com.zhss.service.HelloService" ref="helloServiceImpl" timeout="10000" />\n    <bean id="helloServiceImpl" class="com.zhss.service.HelloServiceImpl" />\n\n</beans>\n\n\x3c!-- consumer éç½® --\x3e\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n    xsi:schemaLocation="http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n\n    <dubbo:application name="dubbo-consumer"  />\n\n    <dubbo:registry address="zookeeper://127.0.0.1:2181" />\n\n    <dubbo:reference id="fooService" interface="com.test.service.FooService"  timeout="10000" check="false" mock="return null">\n    </dubbo:reference>\n\n</beans>\n\n\næä»¬è°ç¨æ¥å£å¤±è´¥çæ¶åï¼å¯ä»¥éè¿ mock ç»ä¸è¿å nullã\n\nmock çå¼ä¹å¯ä»¥ä¿®æ¹ä¸º trueï¼ç¶ååè·æ¥å£åä¸ä¸ªè·¯å¾ä¸å®ç°ä¸ä¸ª Mock ç±»ï¼å½åè§åæ¯ âæ¥å£åç§°+Mockâ åç¼ãç¶åå¨ Mock ç±»éå®ç°èªå·±çéçº§é»è¾ã\n\npublic class HelloServiceMock implements HelloService {\n    public void sayHello() {\n        // éçº§é»è¾\n    }\n}\n\n\n\n# è®¿é®æ§å¶\n\n# ç´è¿\n\nå¨å¼ååæµè¯ç¯å¢ä¸ï¼ç»å¸¸éè¦ç»è¿æ³¨åä¸­å¿ï¼åªæµè¯æå®æå¡æä¾èï¼è¿æ¶åå¯è½éè¦ç¹å¯¹ç¹ç´è¿ï¼ç¹å¯¹ç¹ç´èæ¹å¼ï¼å°ä»¥æå¡æ¥å£ä¸ºåä½ï¼å¿½ç¥æ³¨åä¸­å¿çæä¾èåè¡¨ï¼A æ¥å£éç½®ç¹å¯¹ç¹ï¼ä¸å½±å B æ¥å£ä»æ³¨åä¸­å¿è·ååè¡¨ã\n\n\n\néç½®æ¹å¼ï¼\n\nï¼1ï¼éè¿ XML éç½®\n\nå¦ææ¯çº¿ä¸éæ±éè¦ç¹å¯¹ç¹ï¼å¯å¨ dubbo:reference ä¸­éç½® url æåæä¾èï¼å°ç»è¿æ³¨åä¸­å¿ï¼å¤ä¸ªå°åç¨åå·éå¼ï¼éç½®å¦ä¸ï¼\n\n<dubbo:reference id="xxxService" interface="com.alibaba.xxx.XxxService" url="dubbo://localhost:20890" />\n\n\nï¼2ï¼éè¿ -D åæ°æå®\n\nå¨ JVM å¯å¨åæ°ä¸­å å¥-D åæ°æ å°æå¡å°åï¼\n\njava -Dcom.alibaba.xxx.XxxService=dubbo://localhost:20890\n\n\nï¼3ï¼éè¿æä»¶æ å° å¦ææå¡æ¯è¾å¤ï¼ä¹å¯ä»¥ç¨æä»¶æ å°ï¼ç¨ -Ddubbo.resolve.file æå®æ å°æä»¶è·¯å¾ï¼æ­¤éç½®ä¼åçº§é«äº dubbo:reference ä¸­çéç½®ï¼\n\njava -Ddubbo.resolve.file=xxx.properties\n\n\nç¶åå¨æ å°æä»¶ xxx.properties ä¸­å å¥éç½®ï¼å¶ä¸­ key ä¸ºæå¡åï¼value ä¸ºæå¡æä¾è URLï¼\n\ncom.alibaba.xxx.XxxService=dubbo://localhost:20890\n\n\n# åªè®¢é\n\nä¸ºæ¹ä¾¿å¼åæµè¯ï¼ç»å¸¸ä¼å¨çº¿ä¸å±ç¨ä¸ä¸ªæææå¡å¯ç¨çæ³¨åä¸­å¿ï¼è¿æ¶ï¼å¦æä¸ä¸ªæ­£å¨å¼åä¸­çæå¡æä¾èæ³¨åï¼å¯è½ä¼å½±åæ¶è´¹èä¸è½æ­£å¸¸è¿è¡ã\n\nå¯ä»¥è®©æå¡æä¾èå¼åæ¹ï¼åªè®¢éæå¡(å¼åçæå¡å¯è½ä¾èµå¶å®æå¡)ï¼èä¸æ³¨åæ­£å¨å¼åçæå¡ï¼éè¿ç´è¿æµè¯æ­£å¨å¼åçæå¡ã\n\nç¦ç¨æ³¨åéç½®ï¼\n\n<dubbo:registry address="10.20.153.10:9090" register="false" />\n\n\næè\n\n<dubbo:registry address="10.20.153.10:9090?register=false" />\n\n\n# åªæ³¨å\n\nå¦ææä¸¤ä¸ªéåç¯å¢ï¼ä¸¤ä¸ªæ³¨åä¸­å¿ï¼æä¸ä¸ªæå¡åªå¨å¶ä¸­ä¸ä¸ªæ³¨åä¸­å¿æé¨ç½²ï¼å¦ä¸ä¸ªæ³¨åä¸­å¿è¿æ²¡æ¥å¾åé¨ç½²ï¼èä¸¤ä¸ªæ³¨åä¸­å¿çå¶å®åºç¨é½éè¦ä¾èµæ­¤æå¡ãè¿ä¸ªæ¶åï¼å¯ä»¥è®©æå¡æä¾èæ¹åªæ³¨åæå¡å°å¦ä¸æ³¨åä¸­å¿ï¼èä¸ä»å¦ä¸æ³¨åä¸­å¿è®¢éæå¡ã\n\nç¦ç¨è®¢ééç½®\n\n<dubbo:registry id="hzRegistry" address="10.20.153.10:9090" />\n<dubbo:registry id="qdRegistry" address="10.20.141.150:9090" subscribe="false" />\n\n\næè\n\n<dubbo:registry id="hzRegistry" address="10.20.153.10:9090" />\n<dubbo:registry id="qdRegistry" address="10.20.141.150:9090?subscribe=false" />\n\n\n# éææå¡\n\nææ¶åå¸æäººå·¥ç®¡çæå¡æä¾èçä¸çº¿åä¸çº¿ï¼æ­¤æ¶éå°æ³¨åä¸­å¿æ è¯ä¸ºéå¨æç®¡çæ¨¡å¼ã\n\n<dubbo:registry address="10.20.141.150:9090" dynamic="false" />\n\n\næè\n\n<dubbo:registry address="10.20.141.150:9090?dynamic=false" />\n\n\næå¡æä¾èåæ¬¡æ³¨åæ¶ä¸ºç¦ç¨ç¶æï¼éäººå·¥å¯ç¨ãæ­çº¿æ¶ï¼å°ä¸ä¼è¢«èªå¨å é¤ï¼éäººå·¥ç¦ç¨ã\n\n\n# å¨æéç½®\n\nåæ³¨åä¸­å¿åå¥å¨æéç½®è¦çè§åãè¯¥åè½éå¸¸ç±çæ§ä¸­å¿ææ²»çä¸­å¿çé¡µé¢å®æã\n\nRegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();\nRegistry registry = registryFactory.getRegistry(URL.valueOf("zookeeper://10.20.153.10:2181"));\nregistry.register(URL.valueOf("override://0.0.0.0/com.foo.BarService?category=configurators&dynamic=false&application=foo&timeout=1000"));\n\n\nå¶ä¸­ï¼\n\n * override:// - è¡¨ç¤ºæ°æ®éç¨è¦çæ¹å¼ï¼æ¯æ override å absentï¼å¯æ©å±ï¼å¿å¡«ã\n * 0.0.0.0 - è¡¨ç¤ºå¯¹ææ IP å°åçæï¼å¦æåªæ³è¦çæä¸ª IP çæ°æ®ï¼è¯·å¡«å¥å·ä½ IPï¼å¿å¡«ã\n * com.foo.BarService - è¡¨ç¤ºåªå¯¹æå®æå¡çæï¼å¿å¡«ã\n * category=configurators - è¡¨ç¤ºè¯¥æ°æ®ä¸ºå¨æéç½®ç±»åï¼å¿å¡«ã\n * dynamic=false - è¡¨ç¤ºè¯¥æ°æ®ä¸ºæä¹æ°æ®ï¼å½æ³¨åæ¹éåºæ¶ï¼æ°æ®ä¾ç¶ä¿å­å¨æ³¨åä¸­å¿ï¼å¿å¡«ã\n * enabled=true - è¦çè§åæ¯å¦çæï¼å¯ä¸å¡«ï¼ç¼ºççæã\n * application=foo - è¡¨ç¤ºåªå¯¹æå®åºç¨çæï¼å¯ä¸å¡«ï¼è¡¨ç¤ºå¯¹ææåºç¨çæã\n * timeout=1000 - è¡¨ç¤ºå°æ»¡è¶³ä»¥ä¸æ¡ä»¶ç timeout åæ°çå¼è¦çä¸º 1000ãå¦ææ³è¦çå¶å®åæ°ï¼ç´æ¥å å¨ override ç URL åæ°ä¸ã\n\nç¤ºä¾ï¼\n\n * ç¦ç¨æä¾èï¼(éå¸¸ç¨äºä¸´æ¶è¸¢é¤æå°æä¾èæºå¨ï¼ç¸ä¼¼çï¼ç¦æ­¢æ¶è´¹èè®¿é®è¯·ä½¿ç¨è·¯ç±è§å)\n\noverride://10.20.153.10/com.foo.BarService?category=configurators&dynamic=false&disbaled=true\n\n\n * è°æ´æéï¼(éå¸¸ç¨äºå®¹éè¯ä¼°ï¼ç¼ºçæéä¸º 100)\n\noverride://10.20.153.10/com.foo.BarService?category=configurators&dynamic=false&weight=200\n\n\n * è°æ´è´è½½åè¡¡ç­ç¥ï¼(ç¼ºçè´è½½åè¡¡ç­ç¥ä¸º random)\n\noverride://10.20.153.10/com.foo.BarService?category=configurators&dynamic=false&loadbalance=leastactive\n\n\n * æå¡éçº§ï¼(éå¸¸ç¨äºä¸´æ¶å±è½æä¸ªåºéçéå³é®æå¡)\n\noverride://0.0.0.0/com.foo.BarService?category=configurators&dynamic=false&application=foo&mock=force:return+null\n\n\n\n# åãå¤çæ¬\n\nå½ä¸ä¸ªæ¥å£å®ç°ï¼åºç°ä¸å¼å®¹åçº§æ¶ï¼å¯ä»¥ç¨çæ¬å·è¿æ¸¡ï¼çæ¬å·ä¸åçæå¡ç¸äºé´ä¸å¼ç¨ã\n\nå¯ä»¥æç§ä»¥ä¸çæ­¥éª¤è¿è¡çæ¬è¿ç§»ï¼\n\n 1. å¨ä½ååæ¶é´æ®µï¼ååçº§ä¸åæä¾èä¸ºæ°çæ¬\n 2. åå°æææ¶è´¹èåçº§ä¸ºæ°çæ¬\n 3. ç¶åå°å©ä¸çä¸åæä¾èåçº§ä¸ºæ°çæ¬\n\nèçæ¬æå¡æä¾èéç½®ï¼\n\n<dubbo:service interface="com.foo.BarService" version="1.0.0" />\n\n\næ°çæ¬æå¡æä¾èéç½®ï¼\n\n<dubbo:service interface="com.foo.BarService" version="2.0.0" />\n\n\nèçæ¬æå¡æ¶è´¹èéç½®ï¼\n\n<dubbo:reference id="barService" interface="com.foo.BarService" version="1.0.0" />\n\n\næ°çæ¬æå¡æ¶è´¹èéç½®ï¼\n\n<dubbo:reference id="barService" interface="com.foo.BarService" version="2.0.0" />\n\n\nå¦æä¸éè¦åºåçæ¬ï¼å¯ä»¥æç§ä»¥ä¸çæ¹å¼éç½® [1]ï¼\n\n<dubbo:reference id="barService" interface="com.foo.BarService" version="*" />\n\n\n\n# åä¸ãDubbo SPI\n\nSPI å¨ç§°ä¸º Service Provider Interfaceï¼æ¯ä¸ç§æå¡åç°æºå¶ãSPI çæ¬è´¨æ¯å°æ¥å£å®ç°ç±»çå¨éå®åéç½®å¨æä»¶ä¸­ï¼å¹¶ç±æå¡å è½½å¨è¯»åéç½®æä»¶ï¼å è½½å®ç°ç±»ãè¿æ ·å¯ä»¥å¨è¿è¡æ¶ï¼å¨æä¸ºæ¥å£æ¿æ¢å®ç°ç±»ãæ­£å æ­¤ç¹æ§ï¼æä»¬å¯ä»¥å¾å®¹æçéè¿ SPI æºå¶ä¸ºæä»¬çç¨åºæä¾æå±åè½ãSPI æºå¶å¨ç¬¬ä¸æ¹æ¡æ¶ä¸­ä¹ææåºç¨ï¼æ¯å¦ Dubbo å°±æ¯éè¿ SPI æºå¶å è½½ææçç»ä»¶ãä¸è¿ï¼Dubbo å¹¶æªä½¿ç¨ Java åçç SPI æºå¶ï¼èæ¯å¯¹å¶è¿è¡äºå¢å¼ºï¼ä½¿å¶è½å¤æ´å¥½çæ»¡è¶³éæ±ãå¨ Dubbo ä¸­ï¼SPI æ¯ä¸ä¸ªéå¸¸éè¦çæ¨¡åãåºäº SPIï¼æä»¬å¯ä»¥å¾å®¹æçå¯¹ Dubbo è¿è¡æå±ã\n\nDubbo SPI çç¸å³é»è¾è¢«å°è£å¨äº ExtensionLoader ç±»ä¸­ï¼éè¿ ExtensionLoaderï¼æä»¬å¯ä»¥å è½½æå®çå®ç°ç±»ãDubbo SPI æéçéç½®æä»¶éæ¾ç½®å¨ META-INF/dubbo è·¯å¾ä¸ã\n\n\n# åèèµæ\n\n * å®æ¹\n   * Dubbo Github\n   * Dubbo å®æ¹ææ¡£\n   * ç®¡çåæå\n * æç« \n   * å¦ä½åºäº Dubbo è¿è¡æå¡æ²»çãæå¡éçº§ãå¤±è´¥éè¯ä»¥åè¶æ¶éè¯ï¼',normalizedContent:'# dubbo å¿«éå¥é¨\n\n> apache dubbo æ¯ä¸æ¬¾é«æ§è½ãè½»éçº§çå¼æº java rpc æ¡æ¶ï¼å®æä¾äºä¸å¤§æ ¸å¿è½åï¼é¢åæ¥å£çè¿ç¨æ¹æ³è°ç¨ï¼æºè½å®¹éåè´è½½åè¡¡ï¼ä»¥åæå¡èªå¨æ³¨åååç°ã\n\n\n# ä¸ãdubbo ç®ä»\n\napache dubbo æ¯ä¸æ¬¾é«æ§è½ãè½»éçº§çå¼æº java rpc æ¡æ¶ã\n\ndubbo æä¾äºä¸å¤§æ ¸å¿è½åï¼\n\n * é¢åæ¥å£çè¿ç¨æ¹æ³è°ç¨\n * æºè½å®¹éåè´è½½åè¡¡\n * æå¡èªå¨æ³¨åååç°\n\n\n# rpc åçç®ä»\n\n# ä»ä¹æ¯ rpc\n\nrpcï¼remote procedure callï¼ï¼å³è¿ç¨è¿ç¨è°ç¨ï¼å®æ¯ä¸ç§éè¿ç½ç»ä»è¿ç¨è®¡ç®æºç¨åºä¸è¯·æ±æå¡ï¼èä¸éè¦äºè§£åºå±ç½ç»ææ¯çåè®®ãæ¯å¦ä¸¤ä¸ªä¸åçæå¡ aãb é¨ç½²å¨ä¸¤å°ä¸åçæºå¨ä¸ï¼é£ä¹æå¡ a å¦ææ³è¦è°ç¨æå¡ b ä¸­çæä¸ªæ¹æ³è¯¥æä¹åå¢ï¼ä½¿ç¨ http è¯·æ± å½ç¶å¯ä»¥ï¼ä½æ¯å¯è½ä¼æ¯è¾æ¢èä¸ä¸äºä¼ååçå¹¶ä¸å¥½ã rpc çåºç°å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ã\n\n# rpc å·¥ä½æµç¨\n\n\n\n 1. æå¡æ¶è´¹æ¹ï¼clientï¼è°ç¨ä»¥æ¬å°è°ç¨æ¹å¼è°ç¨æå¡ï¼\n 2. client stub æ¥æ¶å°è°ç¨åè´è´£å°æ¹æ³ãåæ°ç­ç»è£æè½å¤è¿è¡ç½ç»ä¼ è¾çæ¶æ¯ä½ï¼\n 3. client stub æ¾å°æå¡å°åï¼å¹¶å°æ¶æ¯åéå°æå¡ç«¯ï¼\n 4. server stub æ¶å°æ¶æ¯åè¿è¡è§£ç ï¼\n 5. server stub æ ¹æ®è§£ç ç»æè°ç¨æ¬å°çæå¡ï¼\n 6. æ¬å°æå¡æ§è¡å¹¶å°ç»æè¿åç» server stubï¼\n 7. server stub å°è¿åç»ææåææ¶æ¯å¹¶åéè³æ¶è´¹æ¹ï¼\n 8. client stub æ¥æ¶å°æ¶æ¯ï¼å¹¶è¿è¡è§£ç ï¼\n 9. æå¡æ¶è´¹æ¹å¾å°æç»ç»æã\n\n\n# ä¸ºä»ä¹éè¦ dubbo\n\nå¦æä½ è¦å¼ååå¸å¼ç¨åºï¼ä½ ä¹å¯ä»¥ç´æ¥åºäº http æ¥å£è¿è¡éä¿¡ï¼ä½æ¯ä¸ºä»ä¹è¦ç¨ dubbo å¢ï¼\n\næè§å¾ä¸»è¦å¯ä»¥ä» dubbo æä¾çä¸é¢åç¹ç¹æ§æ¥è¯´ä¸ºä»ä¹è¦ç¨ dubboï¼\n\n 1. è´è½½åè¡¡ââåä¸ä¸ªæå¡é¨ç½²å¨ä¸åçæºå¨æ¶è¯¥è°ç¨é£ä¸å°æºå¨ä¸çæå¡ã\n 2. æå¡è°ç¨é¾è·¯ââéçç³»ç»çåå±ï¼æå¡è¶æ¥è¶å¤ï¼æå¡é´ä¾èµå³ç³»åå¾éè¸ªå¤æï¼çè³åä¸æ¸åªä¸ªåºç¨è¦å¨åªä¸ªåºç¨ä¹åå¯å¨ï¼æ¶æå¸é½ä¸è½å®æ´çæè¿°åºç¨çæ¶æå³ç³»ãdubbo å¯ä»¥ä¸ºæä»¬è§£å³æå¡ä¹é´äºç¸æ¯å¦ä½è°ç¨çã\n 3. æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡ãèµæºè°åº¦åæ²»çââåºäºè®¿é®ååå®æ¶ç®¡çéç¾¤å®¹éï¼æé«éç¾¤å©ç¨çã\n 4. æå¡æ²»çââæä¸ªæå¡ææä¹åè°ç¨å¤ç¨æå¡ã\n\nå¦å¤ï¼dubbo é¤äºè½å¤åºç¨å¨åå¸å¼ç³»ç»ä¸­ï¼ä¹å¯ä»¥åºç¨å¨ç°å¨æ¯è¾ç«çå¾®æå¡ç³»ç»ä¸­ãä¸è¿ï¼ç±äº spring cloud å¨å¾®æå¡ä¸­åºç¨æ´å å¹¿æ³ï¼æä»¥ï¼æè§å¾ä¸è¬æä»¬æ dubbo çè¯ï¼å¤§é¨åæ¯åå¸å¼ç³»ç»çæåµã\n\n\n# äºãquickstart\n\nï¼1ï¼æ·»å  maven ä¾èµ\n\n<dependency>\n    <groupid>com.alibaba</groupid>\n    <artifactid>dubbo</artifactid>\n    <version>${dubbo.version}</version>\n</dependency>\n\n\nï¼2ï¼å®ä¹ provider\n\npackage com.alibaba.dubbo.demo;\n\npublic interface demoservice {\n    string sayhello(string name);\n}\n\n\nï¼3ï¼å®ç° provider\n\npackage com.alibaba.dubbo.demo.provider;\nimport com.alibaba.dubbo.demo.demoservice;\n\npublic class demoserviceimpl implements demoservice {\n    public string sayhello(string name) {\n        return "hello " + name;\n    }\n}\n\n\nï¼4ï¼éç½® provider\n\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n       xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n       xsi:schemalocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-provider"/>\n    <dubbo:registry address="multicast://224.5.6.7:1234"/>\n    <dubbo:protocol name="dubbo" port="20880"/>\n    <dubbo:service interface="com.alibaba.dubbo.demo.demoservice" ref="demoservice"/>\n    <bean id="demoservice" class="com.alibaba.dubbo.demo.provider.demoserviceimpl"/>\n</beans>\n\n\nï¼5ï¼å¯å¨ provider\n\nimport org.springframework.context.support.classpathxmlapplicationcontext;\n\npublic class provider {\n    public static void main(string[] args) throws exception {\n        classpathxmlapplicationcontext context = new classpathxmlapplicationcontext(\n                new string[] {"meta-inf/spring/dubbo-demo-provider.xml"});\n        context.start();\n        // press any key to exit\n        system.in.read();\n    }\n}\n\n\nï¼6ï¼éç½® consumer\n\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n       xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n       xsi:schemalocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-consumer"/>\n    <dubbo:registry address="multicast://224.5.6.7:1234"/>\n    <dubbo:reference id="demoservice" interface="com.alibaba.dubbo.demo.demoservice"/>\n</beans>\n\n\nï¼7ï¼å¯å¨ consumer\n\nimport com.alibaba.dubbo.demo.demoservice;\nimport org.springframework.context.support.classpathxmlapplicationcontext;\n\npublic class consumer {\n    public static void main(string[] args) throws exception {\n        classpathxmlapplicationcontext context = new classpathxmlapplicationcontext(\n                new string[]{"meta-inf/spring/dubbo-demo-consumer.xml"});\n        context.start();\n        // obtain proxy object for remote invocation\n        demoservice demoservice = (demoservice) context.getbean("demoservice");\n        // execute remote invocation\n        string hello = demoservice.sayhello("world");\n        // show the result\n        system.out.println(hello);\n    }\n}\n\n\n\n# ä¸ãdubbo éç½®\n\ndubbo ææéç½®æç»é½å°è½¬æ¢ä¸º url è¡¨ç¤ºï¼å¹¶ç±æå¡æä¾æ¹çæï¼ç»æ³¨åä¸­å¿ä¼ éç»æ¶è´¹æ¹ï¼åå±æ§å¯¹åº url çåæ°ï¼åè§éç½®é¡¹ä¸è§è¡¨ä¸­ç "å¯¹åº url åæ°" åã\n\nåªæ groupï¼interfaceï¼version æ¯æå¡çå¹éæ¡ä»¶ï¼ä¸èå³å®æ¯ä¸æ¯åä¸ä¸ªæå¡ï¼å¶å®éç½®é¡¹åä¸ºè°ä¼åæ²»çåæ°ã\n\nurl æ ¼å¼ï¼protocol://username:password@host:port/path?key=value&key=value\n\n\n# éç½®æ¹å¼\n\ndubbo æ¯æå¤ç§éç½®æ¹å¼ï¼\n\n * xml éç½®\n * properties éç½®\n * api éç½®\n * æ³¨è§£éç½®\n\nå¦æåæ¶å­å¨å¤ç§éç½®æ¹å¼ï¼éµå¾ªä»¥ä¸è¦çç­ç¥ï¼\n\n * jvm å¯å¨ -d åæ°ä¼åï¼è¿æ ·å¯ä»¥ä½¿ç¨æ·å¨é¨ç½²åå¯å¨æ¶è¿è¡åæ°éåï¼æ¯å¦å¨å¯å¨æ¶éæ¹ååè®®çç«¯å£ã\n * xml æ¬¡ä¹ï¼å¦æå¨ xml ä¸­æéç½®ï¼å dubbo.properties ä¸­çç¸åºéç½®é¡¹æ æã\n * properties æåï¼ç¸å½äºç¼ºçå¼ï¼åªæ xml æ²¡æéç½®æ¶ï¼dubbo.properties çç¸åºéç½®é¡¹æä¼çæï¼éå¸¸ç¨äºå±äº«å¬å±éç½®ï¼æ¯å¦åºç¨åã\n\n\n\n# xml éç½®\n\nç¤ºä¾ï¼\n\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n    xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"\n    xsi:schemalocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd">\n    \x3c!-- æä¾æ¹åºç¨ä¿¡æ¯ï¼ç¨äºè®¡ç®ä¾èµå³ç³» --\x3e\n    <dubbo:application name="hello-world-app"  />\n    \x3c!-- ä½¿ç¨ multicast å¹¿æ­æ³¨åä¸­å¿æ´é²æå¡å°å --\x3e\n    <dubbo:registry address="multicast://224.5.6.7:1234" />\n    \x3c!-- ç¨ dubbo åè®®å¨ 20880 ç«¯å£æ´é²æå¡ --\x3e\n    <dubbo:protocol name="dubbo" port="20880" />\n    \x3c!-- å£°æéè¦æ´é²çæå¡æ¥å£ --\x3e\n    <dubbo:service interface="com.alibaba.dubbo.demo.demoservice" ref="demoservicelocal" />\n    \x3c!-- åæ¬å° bean ä¸æ ·å®ç°æå¡ --\x3e\n    <bean id="demoservice" class="com.alibaba.dubbo.demo.provider.demoserviceimpl" />\n\n    \x3c!-- çæè¿ç¨æå¡ä»£çï¼å¯ä»¥åæ¬å° bean ä¸æ ·ä½¿ç¨ demoservice --\x3e\n    <dubbo:reference id="demoserviceremote" interface="com.alibaba.dubbo.demo.demoservice" />\n</beans>\n\n\ndubbo ä¼æä»¥ä¸éç½®é¡¹è§£ææä¸é¢ç url æ ¼å¼ï¼\n\ndubbo://host-ip:20880/com.alibaba.dubbo.demo.demoservice\n\n\nç¶ååºäºæ©å±ç¹èªéåºæºå¶ï¼éè¿ url ç dubbo:// åè®®å¤´è¯å«ï¼å°±ä¼è°ç¨ dubboprotocol ç export() æ¹æ³ï¼æå¼æå¡ç«¯å£ 20880ï¼å°±å¯ä»¥ææå¡ demoservice æ´é²å° 20880 ç«¯å£äºã\n\n# properties éç½®\n\nç¤ºä¾ï¼\n\ndubbo.application.name=foo\ndubbo.application.owner=bar\ndubbo.registry.address=10.20.153.10:9090\n\n\n\n# éç½®é¡¹\n\nææéç½®é¡¹åä¸ºä¸å¤§ç±»ï¼\n\n * æå¡åç°ï¼è¡¨ç¤ºè¯¥éç½®é¡¹ç¨äºæå¡çæ³¨åä¸åç°ï¼ç®çæ¯è®©æ¶è´¹æ¹æ¾å°æä¾æ¹ã\n * æå¡æ²»çï¼è¡¨ç¤ºè¯¥éç½®é¡¹ç¨äºæ²»çæå¡é´çå³ç³»ï¼æä¸ºå¼åæµè¯æä¾ä¾¿å©æ¡ä»¶ã\n * æ§è½è°ä¼ï¼è¡¨ç¤ºè¯¥éç½®é¡¹ç¨äºè°ä¼æ§è½ï¼ä¸åçéé¡¹å¯¹æ§è½ä¼äº§çå½±åã\n\néç½®é¡¹æ¸åï¼\n\næ ç­¾                  ç¨é       è§£é\ndubbo:service       æå¡éç½®     ç¨äºæ´é²ä¸ä¸ªæå¡ï¼å®ä¹æå¡çåä¿¡æ¯ï¼ä¸ä¸ªæå¡å¯ä»¥ç¨å¤ä¸ªåè®®æ´é²ï¼ä¸ä¸ªæå¡ä¹å¯ä»¥æ³¨åå°å¤ä¸ªæ³¨åä¸­å¿\ndubbo:reference     å¼ç¨éç½®     ç¨äºåå»ºä¸ä¸ªè¿ç¨æå¡ä»£çï¼ä¸ä¸ªå¼ç¨å¯ä»¥æåå¤ä¸ªæ³¨åä¸­å¿\ndubbo:protocol      åè®®éç½®     ç¨äºéç½®æä¾æå¡çåè®®ä¿¡æ¯ï¼åè®®ç±æä¾æ¹æå®ï¼æ¶è´¹æ¹è¢«å¨æ¥å\ndubbo:application   åºç¨éç½®     ç¨äºéç½®å½ååºç¨ä¿¡æ¯ï¼ä¸ç®¡è¯¥åºç¨æ¯æä¾èè¿æ¯æ¶è´¹è\ndubbo:module        æ¨¡åéç½®     ç¨äºéç½®å½åæ¨¡åä¿¡æ¯ï¼å¯é\ndubbo:registry      æ³¨åä¸­å¿éç½®   ç¨äºéç½®è¿æ¥æ³¨åä¸­å¿ç¸å³ä¿¡æ¯\ndubbo:monitor       çæ§ä¸­å¿éç½®   ç¨äºéç½®è¿æ¥çæ§ä¸­å¿ç¸å³ä¿¡æ¯ï¼å¯é\ndubbo:provider      æä¾æ¹éç½®    å½ protocolconfig å serviceconfig æå±æ§æ²¡æéç½®æ¶ï¼éç¨æ­¤ç¼ºçå¼ï¼å¯é\ndubbo:consumer      æ¶è´¹æ¹éç½®    å½ referenceconfig æå±æ§æ²¡æéç½®æ¶ï¼éç¨æ­¤ç¼ºçå¼ï¼å¯é\ndubbo:method        æ¹æ³éç½®     ç¨äº serviceconfig å referenceconfig æå®æ¹æ³çº§çéç½®ä¿¡æ¯\ndubbo:argument      åæ°éç½®     ç¨äºæå®æ¹æ³åæ°éç½®\n\n> è¯¦ç»éç½®è¯´æè¯·åèï¼å®æ¹éç½®\n\n# éç½®ä¹é´çå³ç³»\n\n\n\n# éç½®è¦çå³ç³»\n\nä»¥ timeout ä¸ºä¾ï¼æ¾ç¤ºäºéç½®çæ¥æ¾é¡ºåºï¼å¶å® retries, loadbalance, actives ç­ç±»ä¼¼ï¼\n\n * æ¹æ³çº§ä¼åï¼æ¥å£çº§æ¬¡ä¹ï¼å¨å±éç½®åæ¬¡ä¹ã\n * å¦æçº§å«ä¸æ ·ï¼åæ¶è´¹æ¹ä¼åï¼æä¾æ¹æ¬¡ä¹ã\n\nå¶ä¸­ï¼æå¡æä¾æ¹éç½®ï¼éè¿ url ç»ç±æ³¨åä¸­å¿ä¼ éç»æ¶è´¹æ¹ã\n\n\n### å¨æéç½®ä¸­å¿\n\néç½®ä¸­å¿ï¼v2.7.0ï¼å¨ dubbo ä¸­æ¿æä¸¤ä¸ªèè´£ï¼\n\n 1. å¤é¨åéç½®ãå¯å¨éç½®çéä¸­å¼å­å¨ ï¼ç®åçè§£ä¸º dubbo.properties çå¤é¨åå­å¨ï¼ã\n 2. æå¡æ²»çãæå¡æ²»çè§åçå­å¨ä¸éç¥ã\n\nå¯ç¨å¨æéç½®ï¼\n\n<dubbo:config-center address="zookeeper://127.0.0.1:2181"/>\n\n\næè\n\ndubbo.config-center.address=zookeeper://127.0.0.1:2181\n\n\næè\n\nconfigcenterconfig configcenter = new configcenterconfig();\nconfigcenter.setaddress("zookeeper://127.0.0.1:2181");\n\n\n\n# åãdubbo æ¶æ\n\n\n# dubbo æ ¸å¿ç»ä»¶\n\n\n\nèç¹è§è²ï¼\n\nèç¹          è§è²è¯´æ\nprovider    æ´é²æå¡çæå¡æä¾æ¹\nconsumer    è°ç¨è¿ç¨æå¡çæå¡æ¶è´¹æ¹\nregistry    æå¡æ³¨åä¸åç°çæ³¨åä¸­å¿\nmonitor     ç»è®¡æå¡çè°ç¨æ¬¡æ°åè°ç¨æ¶é´ççæ§ä¸­å¿\ncontainer   æå¡è¿è¡å®¹å¨\n\nè°ç¨å³ç³»ï¼\n\n 1. æå¡å®¹å¨è´è´£å¯å¨ï¼å è½½ï¼è¿è¡æå¡æä¾èã\n 2. æå¡æä¾èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿æ³¨åèªå·±æä¾çæå¡ã\n 3. æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿è®¢éèªå·±æéçæå¡ã\n 4. æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æ¶è´¹èï¼å¦ææåæ´ï¼æ³¨åä¸­å¿å°åºäºé¿è¿æ¥æ¨éåæ´æ°æ®ç»æ¶è´¹èã\n 5. æå¡æ¶è´¹èï¼ä»æä¾èå°ååè¡¨ä¸­ï¼åºäºè½¯è´è½½åè¡¡ç®æ³ï¼éä¸å°æä¾èè¿è¡è°ç¨ï¼å¦æè°ç¨å¤±è´¥ï¼åéå¦ä¸å°è°ç¨ã\n 6. æå¡æ¶è´¹èåæä¾èï¼å¨åå­ä¸­ç´¯è®¡è°ç¨æ¬¡æ°åè°ç¨æ¶é´ï¼å®æ¶æ¯åéåéä¸æ¬¡ç»è®¡æ°æ®å°çæ§ä¸­å¿ã\n\néè¦ç¥è¯ç¹æ»ç»ï¼\n\n * æ³¨åä¸­å¿è´è´£æå¡å°åçæ³¨åä¸æ¥æ¾ï¼ç¸å½äºç®å½æå¡ï¼æå¡æä¾èåæ¶è´¹èåªå¨å¯å¨æ¶ä¸æ³¨åä¸­å¿äº¤äºï¼æ³¨åä¸­å¿ä¸è½¬åè¯·æ±ï¼ååè¾å°\n * çæ§ä¸­å¿è´è´£ç»è®¡åæå¡è°ç¨æ¬¡æ°ï¼è°ç¨æ¶é´ç­ï¼ç»è®¡åå¨åå­æ±æ»åæ¯åéä¸æ¬¡åéå°çæ§ä¸­å¿æå¡å¨ï¼å¹¶ä»¥æ¥è¡¨å±ç¤º\n * æ³¨åä¸­å¿ï¼æå¡æä¾èï¼æå¡æ¶è´¹èä¸èä¹é´åä¸ºé¿è¿æ¥ï¼çæ§ä¸­å¿é¤å¤\n * æ³¨åä¸­å¿éè¿é¿è¿æ¥æç¥æå¡æä¾èçå­å¨ï¼æå¡æä¾èå®æºï¼æ³¨åä¸­å¿å°ç«å³æ¨éäºä»¶éç¥æ¶è´¹è\n * æ³¨åä¸­å¿åçæ§ä¸­å¿å¨é¨å®æºï¼ä¸å½±åå·²è¿è¡çæä¾èåæ¶è´¹èï¼æ¶è´¹èå¨æ¬å°ç¼å­äºæä¾èåè¡¨\n * æ³¨åä¸­å¿åçæ§ä¸­å¿é½æ¯å¯éçï¼æå¡æ¶è´¹èå¯ä»¥ç´è¿æå¡æä¾è\n * æå¡æä¾èæ ç¶æï¼ä»»æä¸å°å®æåï¼ä¸å½±åä½¿ç¨\n * æå¡æä¾èå¨é¨å®æåï¼æå¡æ¶è´¹èåºç¨å°æ æ³ä½¿ç¨ï¼å¹¶æ éæ¬¡éè¿ç­å¾æå¡æä¾èæ¢å¤\n\n> é®ï¼æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼\n> \n> ç­ï¼å¯ä»¥ï¼å ä¸ºåå¼å§åå§åçæ¶åï¼æ¶è´¹èä¼å°æä¾èçå°åç­ä¿¡æ¯æåå°æ¬å°ç¼å­ï¼æä»¥æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡ã\n\n\n# dubbo æ¶æå±æ¬¡\n\n\n\nå¾ä¾è¯´æï¼\n\n * å¾ä¸­å·¦è¾¹æ·¡èèæ¯çä¸ºæå¡æ¶è´¹æ¹ä½¿ç¨çæ¥å£ï¼å³è¾¹æ·¡ç»¿è²èæ¯çä¸ºæå¡æä¾æ¹ä½¿ç¨çæ¥å£ï¼ä½äºä¸­è½´çº¿ä¸çä¸ºåæ¹é½ç¨å°çæ¥å£ã\n * å¾ä¸­ä»ä¸è³ä¸åä¸ºåå±ï¼åå±åä¸ºååä¾èµï¼å³è¾¹çé»è²ç®­å¤´ä»£è¡¨å±ä¹é´çä¾èµå³ç³»ï¼æ¯ä¸å±é½å¯ä»¥å¥ç¦»ä¸å±è¢«å¤ç¨ï¼å¶ä¸­ï¼service å config å±ä¸º apiï¼å¶å®åå±åä¸º spiã\n * å¾ä¸­ç»¿è²å°åçä¸ºæ©å±æ¥å£ï¼èè²å°åä¸ºå®ç°ç±»ï¼å¾ä¸­åªæ¾ç¤ºç¨äºå³èåå±çå®ç°ç±»ã\n * å¾ä¸­èè²èçº¿ä¸ºåå§åè¿ç¨ï¼å³å¯å¨æ¶ç»è£é¾ï¼çº¢è²å®çº¿ä¸ºæ¹æ³è°ç¨è¿ç¨ï¼å³è¿è¡æ¶è°æ¶é¾ï¼ç´«è²ä¸è§ç®­å¤´ä¸ºç»§æ¿ï¼å¯ä»¥æå­ç±»çä½ç¶ç±»çåä¸ä¸ªèç¹ï¼çº¿ä¸çæå­ä¸ºè°ç¨çæ¹æ³ã\n\n# åå±è¯´æ\n\n * config éç½®å±ï¼å¯¹å¤éç½®æ¥å£ï¼ä»¥ serviceconfig, referenceconfig ä¸ºä¸­å¿ï¼å¯ä»¥ç´æ¥åå§åéç½®ç±»ï¼ä¹å¯ä»¥éè¿ spring è§£æéç½®çæéç½®ç±»\n * proxy æå¡ä»£çå±ï¼æå¡æ¥å£éæä»£çï¼çææå¡çå®¢æ·ç«¯ stub åæå¡å¨ç«¯ skeleton, ä»¥ serviceproxy ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º proxyfactory\n * registry æ³¨åä¸­å¿å±ï¼å°è£æå¡å°åçæ³¨åä¸åç°ï¼ä»¥æå¡ url ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º registryfactory, registry, registryservice\n * cluster è·¯ç±å±ï¼å°è£å¤ä¸ªæä¾èçè·¯ç±åè´è½½åè¡¡ï¼å¹¶æ¡¥æ¥æ³¨åä¸­å¿ï¼ä»¥ invoker ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º cluster, directory, router, loadbalance\n * monitor çæ§å±ï¼rpc è°ç¨æ¬¡æ°åè°ç¨æ¶é´çæ§ï¼ä»¥ statistics ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º monitorfactory, monitor, monitorservice\n * protocol è¿ç¨è°ç¨å±ï¼å°è£ rpc è°ç¨ï¼ä»¥ invocation, result ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º protocol, invoker, exporter\n * exchange ä¿¡æ¯äº¤æ¢å±ï¼å°è£è¯·æ±ååºæ¨¡å¼ï¼åæ­¥è½¬å¼æ­¥ï¼ä»¥ request, response ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º exchanger, exchangechannel, exchangeclient, exchangeserver\n * transport ç½ç»ä¼ è¾å±ï¼æ½è±¡ mina å netty ä¸ºç»ä¸æ¥å£ï¼ä»¥ message ä¸ºä¸­å¿ï¼æ©å±æ¥å£ä¸º channel, transporter, client, server, codec\n * serialize æ°æ®åºååå±ï¼å¯å¤ç¨çä¸äºå·¥å·ï¼æ©å±æ¥å£ä¸º serialization, objectinput, objectoutput, threadpool\n * serialize æ°æ®åºååå±ï¼å¯å¤ç¨çä¸äºå·¥å·ï¼æ©å±æ¥å£ä¸º serialization, objectinput, objectoutput, threadpool\n\n# åå±å³ç³»è¯´æ\n\n * å¨ rpc ä¸­ï¼protocol æ¯æ ¸å¿å±ï¼ä¹å°±æ¯åªè¦æ protocol + invoker + exporter å°±å¯ä»¥å®æééæç rpc è°ç¨ï¼ç¶åå¨ invoker çä¸»è¿ç¨ä¸ filter æ¦æªç¹ã\n * å¾ä¸­ç consumer å provider æ¯æ½è±¡æ¦å¿µï¼åªæ¯æ³è®©çå¾èæ´ç´è§çäºè§£åªäºç±»åå±äºå®¢æ·ç«¯ä¸æå¡å¨ç«¯ï¼ä¸ç¨ client å server çåå æ¯ dubbo å¨å¾å¤åºæ¯ä¸é½ä½¿ç¨ provider, consumer, registry, monitor ååé»è¾ææ®èç¹ï¼ä¿æç»ä¸æ¦å¿µã\n * è cluster æ¯å¤å´æ¦å¿µï¼æä»¥ cluster çç®çæ¯å°å¤ä¸ª invoker ä¼ªè£æä¸ä¸ª invokerï¼è¿æ ·å¶å®äººåªè¦å³æ³¨ protocol å± invoker å³å¯ï¼å ä¸ cluster æèå»æ cluster å¯¹å¶å®å±é½ä¸ä¼é æå½±åï¼å ä¸ºåªæä¸ä¸ªæä¾èæ¶ï¼æ¯ä¸éè¦ cluster çã\n * proxy å±å°è£äºæææ¥å£çéæåä»£çï¼èå¨å¶å®å±é½ä»¥ invoker ä¸ºä¸­å¿ï¼åªæå°äºæ´é²ç»ç¨æ·ä½¿ç¨æ¶ï¼æç¨ proxy å° invoker è½¬ææ¥å£ï¼æå°æ¥å£å®ç°è½¬æ invokerï¼ä¹å°±æ¯å»æ proxy å± rpc æ¯å¯ä»¥ run çï¼åªæ¯ä¸é£ä¹éæï¼ä¸é£ä¹çèµ·æ¥åè°æ¬å°æå¡ä¸æ ·è°è¿ç¨æå¡ã\n * è remoting å®ç°æ¯ dubbo åè®®çå®ç°ï¼å¦æä½ éæ© rmi åè®®ï¼æ´ä¸ª remoting é½ä¸ä¼ç¨ä¸ï¼remoting åé¨ååä¸º transport ä¼ è¾å±å exchange ä¿¡æ¯äº¤æ¢å±ï¼transport å±åªè´è´£ååæ¶æ¯ä¼ è¾ï¼æ¯å¯¹ mina, netty, grizzly çæ½è±¡ï¼å®ä¹å¯ä»¥æ©å± udp ä¼ è¾ï¼è exchange å±æ¯å¨ä¼ è¾å±ä¹ä¸å°è£äº request-response è¯­ä¹ã\n * registry å monitor å®éä¸ä¸ç®ä¸å±ï¼èæ¯ä¸ä¸ªç¬ç«çèç¹ï¼åªæ¯ä¸ºäºå¨å±æ¦è§ï¼ç¨å±çæ¹å¼ç»å¨ä¸èµ·ã\n\n\n# äºãæå¡åç°\n\næå¡æä¾èæ³¨åæå¡çè¿ç¨ï¼\n\ndubbo éç½®é¡¹ dubbo://registry å£°æäºæ³¨åä¸­å¿çå°åï¼dubbo ä¼æä»¥ä¸éç½®é¡¹è§£ææç±»ä¼¼ä¸é¢ç url æ ¼å¼ï¼\n\nregistry://multicast://224.5.6.7:1234/com.alibaba.dubbo.registry.registryservice?export=url.encode("dubbo://host-ip:20880/com.alibaba.dubbo.demo.demoservice")\n\n\nç¶ååºäºæ©å±ç¹èªéåºæºå¶ï¼éè¿ url çâregistry://âåè®®å¤´è¯å«ï¼å°±ä¼è°ç¨ registryprotocol ç export() æ¹æ³ï¼å° export åæ°ä¸­çæä¾è urlï¼æ³¨åå°æ³¨åä¸­å¿ã\n\næå¡æ¶è´¹èåç°æå¡çè¿ç¨ï¼\n\ndubbo éç½®é¡¹ dubbo://registry å£°æäºæ³¨åä¸­å¿çå°åï¼è·æå¡æ³¨åçåçç±»ä¼¼ï¼dubbo ä¹ä¼æä»¥ä¸éç½®é¡¹è§£ææä¸é¢ç url æ ¼å¼ï¼\n\nregistry://multicast://224.5.6.7:1234/com.alibaba.dubbo.registry.registryservice?refer=url.encode("consummer://host-ip/com.alibaba.dubbo.demo.demoservice")\n\n\nç¶ååºäºæ©å±ç¹èªéåºæºå¶ï¼éè¿ url çâregistry://âåè®®å¤´è¯å«ï¼å°±ä¼è°ç¨ registryprotocol ç refer() æ¹æ³ï¼åºäº refer åæ°ä¸­çæ¡ä»¶ï¼æ¥è¯¢æå¡ demoservice çå°åã\n\n\n# å¯å¨æ¶æ£æ¥\n\ndubbo ç¼ºçä¼å¨å¯å¨æ¶æ£æ¥ä¾èµçæå¡æ¯å¦å¯ç¨ï¼ä¸å¯ç¨æ¶ä¼æåºå¼å¸¸ï¼é»æ­¢ spring åå§åå®æï¼ä»¥ä¾¿ä¸çº¿æ¶ï¼è½åæ©åç°é®é¢ï¼é»è®¤ check="true"ã\n\nå¯ä»¥éè¿ xmlãpropertiesã-d åæ°ä¸ç§æ¹å¼è®¾ç½®ãå¯å¨æ¶æ£æ¥\n\n\n# å­ãdubbo åè®®\n\ndubbo æ¯æå¤ç§éä¿¡åè®®ï¼ä¸åçåè®®éå¯¹ä¸åçåºååæ¹å¼ã\n\n\n# dubbo åè®®\n\ndubbo åè®®æ¯ dubbo çé»è®¤éä¿¡åè®®ï¼éç¨åä¸é¿è¿æ¥å nio å¼æ­¥éä¿¡ï¼åºäº hessian ä½ä¸ºåºåååè®®ã\n\ndubbo åè®®éåäºå°æ°æ®éå¤§å¹¶åçæå¡è°ç¨ï¼ä»¥åæå¡æ¶è´¹èæºå¨æ°è¿å¤§äºæå¡æä¾èæºå¨æ°çæåµãåä¹ï¼dubbo ç¼ºçåè®®ä¸éåä¼ éå¤§æ°æ®éçæå¡ï¼æ¯å¦ä¼ æä»¶ï¼ä¼ è§é¢ç­ï¼é¤éè¯·æ±éå¾ä½ã\n\nä¸ºäºè¦æ¯æé«å¹¶ååºæ¯ï¼ä¸è¬æ¯æå¡æä¾èå°±å å°æºå¨ï¼ä½æ¯æå¡æ¶è´¹èæä¸ç¾å°ï¼å¯è½æ¯å¤©è°ç¨éè¾¾å°ä¸äº¿æ¬¡ï¼æ­¤æ¶ç¨é¿è¿æ¥æ¯æåéçï¼å°±æ¯è·æ¯ä¸ªæå¡æ¶è´¹èç»´æä¸ä¸ªé¿è¿æ¥å°±å¯ä»¥ï¼å¯è½æ»å±å°± 100 ä¸ªè¿æ¥ãç¶ååé¢ç´æ¥åºäºé¿è¿æ¥ nio å¼æ­¥éä¿¡ï¼å¯ä»¥æ¯æé«å¹¶åè¯·æ±ã\n\n\n# rmi åè®®\n\nrmi - éç¨ jdk æ åç java.rmi.* å®ç°ï¼éç¨é»å¡å¼ç­è¿æ¥å jdk æ ååºååæ¹å¼ã\n\næ³¨æï¼å¦ææ­£å¨ä½¿ç¨ rmi æä¾æå¡ç»å¤é¨è®¿é®ï¼åæ¶åºç¨éä¾èµäºèç common-collections åçæåµä¸ï¼å­å¨ååºååå®å¨é£é©ã\n\n\n# hessian åè®®\n\nhessian åè®®ç¨äºéæ hessian çæå¡ï¼hessian åºå±éç¨ http éè®¯ï¼éç¨ servlet æ´é²æå¡ï¼dubbo ç¼ºçååµ jetty ä½ä¸ºæå¡å¨å®ç°ã\n\ndubbo ç hessian åè®®å¯ä»¥ååç hessian æå¡äºæä½ï¼å³ï¼\n\n * æä¾èç¨ dubbo ç hessian åè®®æ´é²æå¡ï¼æ¶è´¹èç´æ¥ç¨æ å hessian æ¥å£è°ç¨\n * æèæä¾æ¹ç¨æ å hessian æ´é²æå¡ï¼æ¶è´¹æ¹ç¨ dubbo ç hessian åè®®è°ç¨ã\n\n\n# thrift åè®®\n\nå½å dubbo æ¯æç thrift åè®®æ¯å¯¹ thrift åçåè®®çæ©å±ï¼å¨åçåè®®çåºç¡ä¸æ·»å äºä¸äºé¢å¤çå¤´ä¿¡æ¯ï¼æ¯å¦ service nameï¼magic number ç­ã\n\nä½¿ç¨ dubbo thrift åè®®åæ ·éè¦ä½¿ç¨ thrift ç idl compiler ç¼è¯çæç¸åºç java ä»£ç ï¼åç»­çæ¬ä¸­ä¼å¨è¿æ¹é¢åä¸äºå¢å¼ºã\n\n\n# http åè®®\n\nhttp åè®®åºäº http è¡¨åçè¿ç¨è°ç¨åè®®ï¼éç¨ spring ç httpinvoker å®ç°ã\n\nä½¿ç¨ json åºååæ¹å¼ã\n\n\n# webservice åè®®\n\nåºäº webservice çè¿ç¨è°ç¨åè®®ï¼åºäº apache cxf ç frontend-simple å transports-http å®ç°ã\n\nä½¿ç¨ soap åºååæ¹å¼ã\n\nå¯ä»¥ååç webservice æå¡äºæä½ï¼å³ï¼\n\n * æä¾èç¨ dubbo ç webservice åè®®æ´é²æå¡ï¼æ¶è´¹èç´æ¥ç¨æ å webservice æ¥å£è°ç¨ï¼\n * æèæä¾æ¹ç¨æ å webservice æ´é²æå¡ï¼æ¶è´¹æ¹ç¨ dubbo ç webservice åè®®è°ç¨ã\n\n\n# rest åè®®\n\nåºäºæ åç java rest apiââjax-rs 2.0ï¼java api for restful web services çç®åï¼å®ç°ç rest è°ç¨æ¯æ\n\n\n# memcached åè®®\n\nåºäº memcached å®ç°ç rpc åè®®ã\n\n\n# redis åè®®\n\nåºäº redis å®ç°ç rpc åè®®ã\n\n> å¨ç°å®ä¸çä¸­ï¼åºååæå¤ç§æ¹å¼ã\n> \n> jdk èªèº«æä¾çåºååæ¹å¼ï¼æçä¸é«ï¼ä½æ¯ java ç¨åºä½¿ç¨æå¤ã\n> \n> å¦ææ³è¦è¾å¥½çå¯è¯»æ§ï¼å¯ä»¥ä½¿ç¨ json ï¼å¸¸è§åºæï¼jacksonãgsonãfastjsonï¼æ soap ï¼å³ xml å½¢å¼ï¼\n> \n> å¦ææ³è¦æ´å¥½çæ§è½ï¼å¯ä»¥ä½¿ç¨ thriftãprotobufãhessian\n> \n> æ³æ·±å¥äºè§£å¯ä»¥åèï¼åºåå\n\n\n# ä¸ãéç¾¤å®¹é\n\nå¨éç¾¤è°ç¨å¤±è´¥æ¶ï¼dubbo æä¾äºå¤ç§å®¹éæ¹æ¡ï¼ç¼ºçä¸º failover éè¯ã\n\n\n * failover - å¤±è´¥èªå¨åæ¢ï¼å½åºç°å¤±è´¥ï¼éè¯å¶å®æå¡å¨ãéå¸¸ç¨äºè¯»æä½ï¼ä½éè¯ä¼å¸¦æ¥æ´é¿å»¶è¿ãå¯éè¿ retries="2" æ¥è®¾ç½®éè¯æ¬¡æ°(ä¸å«ç¬¬ä¸æ¬¡)ã\n * failfast - å¿«éå¤±è´¥ï¼åªåèµ·ä¸æ¬¡è°ç¨ï¼å¤±è´¥ç«å³æ¥éãéå¸¸ç¨äºéå¹ç­æ§çåæä½ï¼æ¯å¦æ°å¢è®°å½ã\n * failsafe - å¤±è´¥å®å¨ï¼åºç°å¼å¸¸æ¶ï¼ç´æ¥å¿½ç¥ãéå¸¸ç¨äºåå¥å®¡è®¡æ¥å¿ç­æä½ã\n * failback - å¤±è´¥èªå¨æ¢å¤ï¼åå°è®°å½å¤±è´¥è¯·æ±ï¼å®æ¶éåãéå¸¸ç¨äºæ¶æ¯éç¥æä½ã\n * forking - å¹¶è¡è°ç¨å¤ä¸ªæå¡å¨ï¼åªè¦ä¸ä¸ªæåå³è¿åãéå¸¸ç¨äºå®æ¶æ§è¦æ±è¾é«çè¯»æä½ï¼ä½éè¦æµªè´¹æ´å¤æå¡èµæºãå¯éè¿ forks="2" æ¥è®¾ç½®æå¤§å¹¶è¡æ°ã\n * broadcast - å¹¿æ­è°ç¨æææä¾èï¼éä¸ªè°ç¨ï¼ä»»æä¸å°æ¥éåæ¥éãéå¸¸ç¨äºéç¥æææä¾èæ´æ°ç¼å­ææ¥å¿ç­æ¬å°èµæºä¿¡æ¯ã\n\néç¾¤å®¹ééç½®ç¤ºä¾ï¼\n\n<dubbo:service cluster="failsafe" />\n<dubbo:reference cluster="failsafe" />\n\n\n\n# å«ãè´è½½åè¡¡\n\ndubbo æä¾äºå¤ç§è´è½½åè¡¡ï¼loadbalanceï¼ç­ç¥ï¼ç¼ºçä¸º random éæºè°ç¨ã\n\ndubbo çè´è½½åè¡¡éç½®å¯ä»¥ç»ç²åº¦å°æå¡ãæ¹æ³çº§å«ï¼ä¸ dubbo:service å dubbo:reference åå¯éç½®ã\n\n\x3c!-- æå¡ç«¯æå¡çº§å« --\x3e\n<dubbo:service interface="..." loadbalance="roundrobin" />\n\x3c!-- å®¢æ·ç«¯æå¡çº§å« --\x3e\n<dubbo:reference interface="..." loadbalance="roundrobin" />\n\x3c!-- æå¡ç«¯æ¹æ³çº§å« --\x3e\n<dubbo:service interface="...">\n    <dubbo:method name="..." loadbalance="roundrobin"/>\n</dubbo:service>\n\x3c!-- å®¢æ·ç«¯æ¹æ³çº§å« --\x3e\n<dubbo:reference interface="...">\n    <dubbo:method name="..." loadbalance="roundrobin"/>\n</dubbo:reference>\n\n\n# random\n\n * éæºï¼ææéè®¾ç½®éæºæ¦çã\n * å¨ä¸ä¸ªæªé¢ä¸ç¢°æçæ¦çé«ï¼ä½è°ç¨éè¶å¤§åå¸è¶ååï¼èä¸ææ¦çä½¿ç¨æéåä¹æ¯è¾ååï¼æå©äºå¨æè°æ´æä¾èæéã\n\n# roundrobin\n\n * è½®è¯¢ï¼æå¬çº¦åçæéè®¾ç½®è½®è¯¢æ¯çã\n * å­å¨æ¢çæä¾èç´¯ç§¯è¯·æ±çé®é¢ï¼æ¯å¦ï¼ç¬¬äºå°æºå¨å¾æ¢ï¼ä½æ²¡æï¼å½è¯·æ±è°å°ç¬¬äºå°æ¶å°±å¡å¨é£ï¼ä¹èä¹ä¹ï¼ææè¯·æ±é½å¡å¨è°å°ç¬¬äºå°ä¸ã\n\n# leastactive\n\n * æå°æ´»è·è°ç¨æ°ï¼ç¸åæ´»è·æ°çéæºï¼æ´»è·æ°æè°ç¨ååè®¡æ°å·®ã\n * ä½¿æ¢çæä¾èæ¶å°æ´å°è¯·æ±ï¼å ä¸ºè¶æ¢çæä¾èçè°ç¨ååè®¡æ°å·®ä¼è¶å¤§ã\n\n# consistenthash\n\n * ä¸è´æ§ hashï¼ç¸ååæ°çè¯·æ±æ»æ¯åå°åä¸æä¾èã\n * å½æä¸å°æä¾èææ¶ï¼åæ¬åå¾è¯¥æä¾èçè¯·æ±ï¼åºäºèæèç¹ï¼å¹³æå°å¶å®æä¾èï¼ä¸ä¼å¼èµ·å§çåå¨ã\n * ç®æ³åè§ï¼http://en.wikipedia.org/wiki/consistent_hashing\n * ç¼ºçåªå¯¹ç¬¬ä¸ä¸ªåæ° hashï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.arguments" value="0,1" />\n * ç¼ºçç¨ 160 ä»½èæèç¹ï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.nodes" value="320" />\n\n\n# ä¹ãdubbo æå¡æ²»ç\n\n\n# æå¡æ²»çç®ä»\n\n * å½æå¡è¶æ¥è¶å¤æ¶ï¼æå¡ url éç½®ç®¡çåå¾éå¸¸å°é¾ï¼f5 ç¡¬ä»¶è´è½½åè¡¡å¨çåç¹ååä¹è¶æ¥è¶å¤§ã\n * å½è¿ä¸æ­¥åå±ï¼æå¡é´ä¾èµå³ç³»åå¾éè¸ªå¤æï¼çè³åä¸æ¸åªä¸ªåºç¨è¦å¨åªä¸ªåºç¨ä¹åå¯å¨ï¼æ¶æå¸é½ä¸è½å®æ´çæè¿°åºç¨çæ¶æå³ç³»ã\n * æ¥çï¼æå¡çè°ç¨éè¶æ¥è¶å¤§ï¼æå¡çå®¹éé®é¢å°±æ´é²åºæ¥ï¼è¿ä¸ªæå¡éè¦å¤å°æºå¨æ¯æï¼ä»ä¹æ¶åè¯¥å æºå¨ï¼\n\nä»¥ä¸é®é¢å¯ä»¥å½çº³ä¸ºæå¡æ²»çé®é¢ï¼è¿ä¹æ¯ dubbo çæ ¸å¿åè½ã\n\n# è°ç¨é¾è·¯\n\nä¸ä¸ªå¾®æå¡æ¶æï¼å¾å¾ç±å¤§éåå¸å¼æå¡ç»æãé£ä¹è¿äºæå¡ä¹é´äºç¸æ¯å¦ä½è°ç¨çï¼è°ç¨é¾è·¯æ¯å¥ï¼è¯´å®è¯ï¼å ä¹å°åé¢æ²¡äººæçæ¸æ¥äºï¼å ä¸ºæå¡å®å¨å¤ªå¤äºï¼å¯è½å ç¾ä¸ªçè³å åä¸ªæå¡ã\n\né£å°±éè¦åºäº dubbo åçåå¸å¼ç³»ç»ä¸­ï¼å¯¹åä¸ªæå¡ä¹é´çè°ç¨èªå¨è®°å½ä¸æ¥ï¼ç¶åèªå¨å°åä¸ªæå¡ä¹é´çä¾èµå³ç³»åè°ç¨é¾è·¯çæåºæ¥ï¼åæä¸å¼ å¾ï¼æ¾ç¤ºåºæ¥ï¼å¤§å®¶æå¯ä»¥çå°å¯¹å§ã\n\n# æå¡è®¿é®ååä»¥åæ¶é¿ç»è®¡\n\néè¦èªå¨ç»è®¡åä¸ªæ¥å£åæå¡ä¹é´çè°ç¨æ¬¡æ°ä»¥åè®¿é®å»¶æ¶ï¼èä¸è¦åæä¸¤ä¸ªçº§å«ã\n\n * ä¸ä¸ªçº§å«æ¯æ¥å£ç²åº¦ï¼å°±æ¯æ¯ä¸ªæå¡çæ¯ä¸ªæ¥å£æ¯å¤©è¢«è°ç¨å¤å°æ¬¡ï¼tp50/tp90/tp99ï¼ä¸ä¸ªæ¡£æ¬¡çè¯·æ±å»¶æ¶åå«æ¯å¤å°ï¼\n * ç¬¬äºä¸ªçº§å«æ¯ä»æºå¤´å¥å£å¼å§ï¼ä¸ä¸ªå®æ´çè¯·æ±é¾è·¯ç»è¿å åä¸ªæå¡ä¹åï¼å®æä¸æ¬¡è¯·æ±ï¼æ¯å¤©å¨é¾è·¯èµ°å¤å°æ¬¡ï¼å¨é¾è·¯è¯·æ±å»¶æ¶ç tp50/tp90/tp99ï¼åå«æ¯å¤å°ã\n\n# å¶ä»\n\n * æå¡åå±ï¼é¿åå¾ªç¯ä¾èµï¼\n * è°ç¨é¾è·¯å¤±è´¥çæ§åæ¥è­¦\n * æå¡é´æ\n * æ¯ä¸ªæå¡çå¯ç¨æ§ççæ§ï¼æ¥å£è°ç¨æåçï¼å ä¸ª 9ï¼99.99%ï¼99.9%ï¼99%ï¼\n\næè°å¤±è´¥éè¯ï¼å°±æ¯ consumer è°ç¨ provider è¦æ¯å¤±è´¥äºï¼æ¯å¦æå¼å¸¸äºï¼æ­¤æ¶åºè¯¥æ¯å¯ä»¥éè¯çï¼æèè°ç¨è¶æ¶äºä¹å¯ä»¥éè¯ãéç½®å¦ä¸ï¼\n\n<dubbo:reference id="xxxx" interface="xx" check="true" async="false" retries="3" timeout="2000"/>\n\n\nä¸¾ä¸ªæ å­ã\n\næä¸ªæå¡çæ¥å£ï¼è¦èè´¹ 5sï¼ä½ è¿è¾¹ä¸è½å¹²ç­çï¼ä½ è¿è¾¹éç½®äº timeout ä¹åï¼æç­å¾ 2sï¼è¿æ²¡è¿åï¼æç´æ¥å°±æ¤äºï¼ä¸è½å¹²ç­ä½ ã\n\nå¯ä»¥ç»åä½ ä»¬å¬å¸å·ä½çåºæ¯æ¥è¯´è¯´ä½ æ¯æä¹è®¾ç½®è¿äºåæ°çï¼\n\n * timeoutï¼ä¸è¬è®¾ç½®ä¸º 200msï¼æä»¬è®¤ä¸ºä¸è½è¶è¿ 200ms è¿æ²¡è¿åã\n * retriesï¼è®¾ç½® retriesï¼ä¸è¬æ¯å¨è¯»è¯·æ±çæ¶åï¼æ¯å¦ä½ è¦æ¥è¯¢ä¸ªæ°æ®ï¼ä½ å¯ä»¥è®¾ç½®ä¸ª retriesï¼å¦æç¬¬ä¸æ¬¡æ²¡è¯»å°ï¼æ¥éï¼éè¯æå®çæ¬¡æ°ï¼å°è¯åæ¬¡è¯»åã\n\n\n# è·¯ç±è§å\n\nè·¯ç±è§åå³å®ä¸æ¬¡ dubbo æå¡è°ç¨çç®æ æå¡å¨ï¼åä¸ºæ¡ä»¶è·¯ç±è§ååèæ¬è·¯ç±è§åï¼å¹¶ä¸æ¯æå¯æ©å±ã\n\nåæ³¨åä¸­å¿åå¥è·¯ç±è§åçæä½éå¸¸ç±çæ§ä¸­å¿ææ²»çä¸­å¿çé¡µé¢å®æã\n\nregistryfactory registryfactory = extensionloader.getextensionloader(registryfactory.class).getadaptiveextension();\nregistry registry = registryfactory.getregistry(url.valueof("zookeeper://10.20.153.10:2181"));\nregistry.register(url.valueof("condition://0.0.0.0/com.foo.barservice?category=routers&dynamic=false&rule=" + url.encode("host = 10.20.153.10 => host = 10.20.153.11") + "));\n\n\n * condition:// - è¡¨ç¤ºè·¯ç±è§åçç±»åï¼æ¯ææ¡ä»¶è·¯ç±è§ååèæ¬è·¯ç±è§åï¼å¯æ©å±ï¼å¿å¡«ã\n * 0.0.0.0 - è¡¨ç¤ºå¯¹ææ ip å°åçæï¼å¦æåªæ³å¯¹æä¸ª ip ççæï¼è¯·å¡«å¥å·ä½ ipï¼å¿å¡«ã\n * com.foo.barservice - è¡¨ç¤ºåªå¯¹æå®æå¡çæï¼å¿å¡«ã\n * category=routers - è¡¨ç¤ºè¯¥æ°æ®ä¸ºå¨æéç½®ç±»åï¼å¿å¡«ã\n * dynamic=false - è¡¨ç¤ºè¯¥æ°æ®ä¸ºæä¹æ°æ®ï¼å½æ³¨åæ¹éåºæ¶ï¼æ°æ®ä¾ç¶ä¿å­å¨æ³¨åä¸­å¿ï¼å¿å¡«ã\n * enabled=true - è¦çè§åæ¯å¦çæï¼å¯ä¸å¡«ï¼ç¼ºççæã\n * force=false - å½è·¯ç±ç»æä¸ºç©ºæ¶ï¼æ¯å¦å¼ºå¶æ§è¡ï¼å¦æä¸å¼ºå¶æ§è¡ï¼è·¯ç±ç»æä¸ºç©ºçè·¯ç±è§åå°èªå¨å¤±æï¼å¯ä¸å¡«ï¼ç¼ºçä¸º flaseã\n * runtime=false - æ¯å¦å¨æ¯æ¬¡è°ç¨æ¶æ§è¡è·¯ç±è§åï¼å¦ååªå¨æä¾èå°ååè¡¨åæ´æ¶é¢åæ§è¡å¹¶ç¼å­ç»æï¼è°ç¨æ¶ç´æ¥ä»ç¼å­ä¸­è·åè·¯ç±ç»æãå¦æç¨äºåæ°è·¯ç±ï¼å¿é¡»è®¾ä¸º trueï¼éè¦æ³¨æè®¾ç½®ä¼å½±åè°ç¨çæ§è½ï¼å¯ä¸å¡«ï¼ç¼ºçä¸º flaseã\n * priority=1 - è·¯ç±è§åçä¼åçº§ï¼ç¨äºæåºï¼ä¼åçº§è¶å¤§è¶é åæ§è¡ï¼å¯ä¸å¡«ï¼ç¼ºçä¸º 0ã\n * rule=url.encode("host = 10.20.153.10 => host = 10.20.153.11") - è¡¨ç¤ºè·¯ç±è§åçåå®¹ï¼å¿å¡«ã\n\n\n# æå¡éçº§\n\nå¯ä»¥éè¿æå¡éçº§åè½ä¸´æ¶å±è½æä¸ªåºéçéå³é®æå¡ï¼å¹¶å®ä¹éçº§åçè¿åç­ç¥ã\n\nåæ³¨åä¸­å¿åå¥å¨æéç½®è¦çè§åï¼\n\nregistryfactory registryfactory = extensionloader.getextensionloader(registryfactory.class).getadaptiveextension();\nregistry registry = registryfactory.getregistry(url.valueof("zookeeper://10.20.153.10:2181"));\nregistry.register(url.valueof("override://0.0.0.0/com.foo.barservice?category=configurators&dynamic=false&application=foo&mock=force:return+null"));\n\n\nå¶ä¸­ï¼\n\nmock=force:return+null è¡¨ç¤ºæ¶è´¹æ¹å¯¹è¯¥æå¡çæ¹æ³è°ç¨é½ç´æ¥è¿å null å¼ï¼ä¸åèµ·è¿ç¨è°ç¨ãç¨æ¥å±è½ä¸éè¦æå¡ä¸å¯ç¨æ¶å¯¹è°ç¨æ¹çå½±åã è¿å¯ä»¥æ¹ä¸º mock=fail:return+null è¡¨ç¤ºæ¶è´¹æ¹å¯¹è¯¥æå¡çæ¹æ³è°ç¨å¨å¤±è´¥åï¼åè¿å null å¼ï¼ä¸æå¼å¸¸ãç¨æ¥å®¹å¿ä¸éè¦æå¡ä¸ç¨³å®æ¶å¯¹è°ç¨æ¹çå½±åã\n\næ¯å¦è¯´æå¡ a è°ç¨æå¡ bï¼ç»ææå¡ b ææäºï¼æå¡ a éè¯å æ¬¡è°ç¨æå¡ bï¼è¿æ¯ä¸è¡ï¼é£ä¹ç´æ¥éçº§ï¼èµ°ä¸ä¸ªå¤ç¨çé»è¾ï¼ç»ç¨æ·è¿åååºã\n\nä¸¾ä¸ªä¾å­ï¼æä»¬ææ¥å£ helloserviceãhelloserviceimpl æè¯¥æ¥å£çå·ä½å®ç°ã\n\npublic interface helloservice {\n   void sayhello();\n}\n\npublic class helloserviceimpl implements helloservice {\n    public void sayhello() {\n        system.out.println("hello world......");\n    }\n}\n\n\ndubbo éç½®ï¼\n\n\x3c!-- provider éç½® --\x3e\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/xmlschema-instance" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n    xsi:schemalocation="http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n\n    <dubbo:application name="dubbo-provider" />\n    <dubbo:registry address="zookeeper://127.0.0.1:2181" />\n    <dubbo:protocol name="dubbo" port="20880" />\n    <dubbo:service interface="com.zhss.service.helloservice" ref="helloserviceimpl" timeout="10000" />\n    <bean id="helloserviceimpl" class="com.zhss.service.helloserviceimpl" />\n\n</beans>\n\n\x3c!-- consumer éç½® --\x3e\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n    xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n    xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"\n    xsi:schemalocation="http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd">\n\n    <dubbo:application name="dubbo-consumer"  />\n\n    <dubbo:registry address="zookeeper://127.0.0.1:2181" />\n\n    <dubbo:reference id="fooservice" interface="com.test.service.fooservice"  timeout="10000" check="false" mock="return null">\n    </dubbo:reference>\n\n</beans>\n\n\næä»¬è°ç¨æ¥å£å¤±è´¥çæ¶åï¼å¯ä»¥éè¿ mock ç»ä¸è¿å nullã\n\nmock çå¼ä¹å¯ä»¥ä¿®æ¹ä¸º trueï¼ç¶ååè·æ¥å£åä¸ä¸ªè·¯å¾ä¸å®ç°ä¸ä¸ª mock ç±»ï¼å½åè§åæ¯ âæ¥å£åç§°+mockâ åç¼ãç¶åå¨ mock ç±»éå®ç°èªå·±çéçº§é»è¾ã\n\npublic class helloservicemock implements helloservice {\n    public void sayhello() {\n        // éçº§é»è¾\n    }\n}\n\n\n\n# è®¿é®æ§å¶\n\n# ç´è¿\n\nå¨å¼ååæµè¯ç¯å¢ä¸ï¼ç»å¸¸éè¦ç»è¿æ³¨åä¸­å¿ï¼åªæµè¯æå®æå¡æä¾èï¼è¿æ¶åå¯è½éè¦ç¹å¯¹ç¹ç´è¿ï¼ç¹å¯¹ç¹ç´èæ¹å¼ï¼å°ä»¥æå¡æ¥å£ä¸ºåä½ï¼å¿½ç¥æ³¨åä¸­å¿çæä¾èåè¡¨ï¼a æ¥å£éç½®ç¹å¯¹ç¹ï¼ä¸å½±å b æ¥å£ä»æ³¨åä¸­å¿è·ååè¡¨ã\n\n\n\néç½®æ¹å¼ï¼\n\nï¼1ï¼éè¿ xml éç½®\n\nå¦ææ¯çº¿ä¸éæ±éè¦ç¹å¯¹ç¹ï¼å¯å¨ dubbo:reference ä¸­éç½® url æåæä¾èï¼å°ç»è¿æ³¨åä¸­å¿ï¼å¤ä¸ªå°åç¨åå·éå¼ï¼éç½®å¦ä¸ï¼\n\n<dubbo:reference id="xxxservice" interface="com.alibaba.xxx.xxxservice" url="dubbo://localhost:20890" />\n\n\nï¼2ï¼éè¿ -d åæ°æå®\n\nå¨ jvm å¯å¨åæ°ä¸­å å¥-d åæ°æ å°æå¡å°åï¼\n\njava -dcom.alibaba.xxx.xxxservice=dubbo://localhost:20890\n\n\nï¼3ï¼éè¿æä»¶æ å° å¦ææå¡æ¯è¾å¤ï¼ä¹å¯ä»¥ç¨æä»¶æ å°ï¼ç¨ -ddubbo.resolve.file æå®æ å°æä»¶è·¯å¾ï¼æ­¤éç½®ä¼åçº§é«äº dubbo:reference ä¸­çéç½®ï¼\n\njava -ddubbo.resolve.file=xxx.properties\n\n\nç¶åå¨æ å°æä»¶ xxx.properties ä¸­å å¥éç½®ï¼å¶ä¸­ key ä¸ºæå¡åï¼value ä¸ºæå¡æä¾è urlï¼\n\ncom.alibaba.xxx.xxxservice=dubbo://localhost:20890\n\n\n# åªè®¢é\n\nä¸ºæ¹ä¾¿å¼åæµè¯ï¼ç»å¸¸ä¼å¨çº¿ä¸å±ç¨ä¸ä¸ªæææå¡å¯ç¨çæ³¨åä¸­å¿ï¼è¿æ¶ï¼å¦æä¸ä¸ªæ­£å¨å¼åä¸­çæå¡æä¾èæ³¨åï¼å¯è½ä¼å½±åæ¶è´¹èä¸è½æ­£å¸¸è¿è¡ã\n\nå¯ä»¥è®©æå¡æä¾èå¼åæ¹ï¼åªè®¢éæå¡(å¼åçæå¡å¯è½ä¾èµå¶å®æå¡)ï¼èä¸æ³¨åæ­£å¨å¼åçæå¡ï¼éè¿ç´è¿æµè¯æ­£å¨å¼åçæå¡ã\n\nç¦ç¨æ³¨åéç½®ï¼\n\n<dubbo:registry address="10.20.153.10:9090" register="false" />\n\n\næè\n\n<dubbo:registry address="10.20.153.10:9090?register=false" />\n\n\n# åªæ³¨å\n\nå¦ææä¸¤ä¸ªéåç¯å¢ï¼ä¸¤ä¸ªæ³¨åä¸­å¿ï¼æä¸ä¸ªæå¡åªå¨å¶ä¸­ä¸ä¸ªæ³¨åä¸­å¿æé¨ç½²ï¼å¦ä¸ä¸ªæ³¨åä¸­å¿è¿æ²¡æ¥å¾åé¨ç½²ï¼èä¸¤ä¸ªæ³¨åä¸­å¿çå¶å®åºç¨é½éè¦ä¾èµæ­¤æå¡ãè¿ä¸ªæ¶åï¼å¯ä»¥è®©æå¡æä¾èæ¹åªæ³¨åæå¡å°å¦ä¸æ³¨åä¸­å¿ï¼èä¸ä»å¦ä¸æ³¨åä¸­å¿è®¢éæå¡ã\n\nç¦ç¨è®¢ééç½®\n\n<dubbo:registry id="hzregistry" address="10.20.153.10:9090" />\n<dubbo:registry id="qdregistry" address="10.20.141.150:9090" subscribe="false" />\n\n\næè\n\n<dubbo:registry id="hzregistry" address="10.20.153.10:9090" />\n<dubbo:registry id="qdregistry" address="10.20.141.150:9090?subscribe=false" />\n\n\n# éææå¡\n\nææ¶åå¸æäººå·¥ç®¡çæå¡æä¾èçä¸çº¿åä¸çº¿ï¼æ­¤æ¶éå°æ³¨åä¸­å¿æ è¯ä¸ºéå¨æç®¡çæ¨¡å¼ã\n\n<dubbo:registry address="10.20.141.150:9090" dynamic="false" />\n\n\næè\n\n<dubbo:registry address="10.20.141.150:9090?dynamic=false" />\n\n\næå¡æä¾èåæ¬¡æ³¨åæ¶ä¸ºç¦ç¨ç¶æï¼éäººå·¥å¯ç¨ãæ­çº¿æ¶ï¼å°ä¸ä¼è¢«èªå¨å é¤ï¼éäººå·¥ç¦ç¨ã\n\n\n# å¨æéç½®\n\nåæ³¨åä¸­å¿åå¥å¨æéç½®è¦çè§åãè¯¥åè½éå¸¸ç±çæ§ä¸­å¿ææ²»çä¸­å¿çé¡µé¢å®æã\n\nregistryfactory registryfactory = extensionloader.getextensionloader(registryfactory.class).getadaptiveextension();\nregistry registry = registryfactory.getregistry(url.valueof("zookeeper://10.20.153.10:2181"));\nregistry.register(url.valueof("override://0.0.0.0/com.foo.barservice?category=configurators&dynamic=false&application=foo&timeout=1000"));\n\n\nå¶ä¸­ï¼\n\n * override:// - è¡¨ç¤ºæ°æ®éç¨è¦çæ¹å¼ï¼æ¯æ override å absentï¼å¯æ©å±ï¼å¿å¡«ã\n * 0.0.0.0 - è¡¨ç¤ºå¯¹ææ ip å°åçæï¼å¦æåªæ³è¦çæä¸ª ip çæ°æ®ï¼è¯·å¡«å¥å·ä½ ipï¼å¿å¡«ã\n * com.foo.barservice - è¡¨ç¤ºåªå¯¹æå®æå¡çæï¼å¿å¡«ã\n * category=configurators - è¡¨ç¤ºè¯¥æ°æ®ä¸ºå¨æéç½®ç±»åï¼å¿å¡«ã\n * dynamic=false - è¡¨ç¤ºè¯¥æ°æ®ä¸ºæä¹æ°æ®ï¼å½æ³¨åæ¹éåºæ¶ï¼æ°æ®ä¾ç¶ä¿å­å¨æ³¨åä¸­å¿ï¼å¿å¡«ã\n * enabled=true - è¦çè§åæ¯å¦çæï¼å¯ä¸å¡«ï¼ç¼ºççæã\n * application=foo - è¡¨ç¤ºåªå¯¹æå®åºç¨çæï¼å¯ä¸å¡«ï¼è¡¨ç¤ºå¯¹ææåºç¨çæã\n * timeout=1000 - è¡¨ç¤ºå°æ»¡è¶³ä»¥ä¸æ¡ä»¶ç timeout åæ°çå¼è¦çä¸º 1000ãå¦ææ³è¦çå¶å®åæ°ï¼ç´æ¥å å¨ override ç url åæ°ä¸ã\n\nç¤ºä¾ï¼\n\n * ç¦ç¨æä¾èï¼(éå¸¸ç¨äºä¸´æ¶è¸¢é¤æå°æä¾èæºå¨ï¼ç¸ä¼¼çï¼ç¦æ­¢æ¶è´¹èè®¿é®è¯·ä½¿ç¨è·¯ç±è§å)\n\noverride://10.20.153.10/com.foo.barservice?category=configurators&dynamic=false&disbaled=true\n\n\n * è°æ´æéï¼(éå¸¸ç¨äºå®¹éè¯ä¼°ï¼ç¼ºçæéä¸º 100)\n\noverride://10.20.153.10/com.foo.barservice?category=configurators&dynamic=false&weight=200\n\n\n * è°æ´è´è½½åè¡¡ç­ç¥ï¼(ç¼ºçè´è½½åè¡¡ç­ç¥ä¸º random)\n\noverride://10.20.153.10/com.foo.barservice?category=configurators&dynamic=false&loadbalance=leastactive\n\n\n * æå¡éçº§ï¼(éå¸¸ç¨äºä¸´æ¶å±è½æä¸ªåºéçéå³é®æå¡)\n\noverride://0.0.0.0/com.foo.barservice?category=configurators&dynamic=false&application=foo&mock=force:return+null\n\n\n\n# åãå¤çæ¬\n\nå½ä¸ä¸ªæ¥å£å®ç°ï¼åºç°ä¸å¼å®¹åçº§æ¶ï¼å¯ä»¥ç¨çæ¬å·è¿æ¸¡ï¼çæ¬å·ä¸åçæå¡ç¸äºé´ä¸å¼ç¨ã\n\nå¯ä»¥æç§ä»¥ä¸çæ­¥éª¤è¿è¡çæ¬è¿ç§»ï¼\n\n 1. å¨ä½ååæ¶é´æ®µï¼ååçº§ä¸åæä¾èä¸ºæ°çæ¬\n 2. åå°æææ¶è´¹èåçº§ä¸ºæ°çæ¬\n 3. ç¶åå°å©ä¸çä¸åæä¾èåçº§ä¸ºæ°çæ¬\n\nèçæ¬æå¡æä¾èéç½®ï¼\n\n<dubbo:service interface="com.foo.barservice" version="1.0.0" />\n\n\næ°çæ¬æå¡æä¾èéç½®ï¼\n\n<dubbo:service interface="com.foo.barservice" version="2.0.0" />\n\n\nèçæ¬æå¡æ¶è´¹èéç½®ï¼\n\n<dubbo:reference id="barservice" interface="com.foo.barservice" version="1.0.0" />\n\n\næ°çæ¬æå¡æ¶è´¹èéç½®ï¼\n\n<dubbo:reference id="barservice" interface="com.foo.barservice" version="2.0.0" />\n\n\nå¦æä¸éè¦åºåçæ¬ï¼å¯ä»¥æç§ä»¥ä¸çæ¹å¼éç½® [1]ï¼\n\n<dubbo:reference id="barservice" interface="com.foo.barservice" version="*" />\n\n\n\n# åä¸ãdubbo spi\n\nspi å¨ç§°ä¸º service provider interfaceï¼æ¯ä¸ç§æå¡åç°æºå¶ãspi çæ¬è´¨æ¯å°æ¥å£å®ç°ç±»çå¨éå®åéç½®å¨æä»¶ä¸­ï¼å¹¶ç±æå¡å è½½å¨è¯»åéç½®æä»¶ï¼å è½½å®ç°ç±»ãè¿æ ·å¯ä»¥å¨è¿è¡æ¶ï¼å¨æä¸ºæ¥å£æ¿æ¢å®ç°ç±»ãæ­£å æ­¤ç¹æ§ï¼æä»¬å¯ä»¥å¾å®¹æçéè¿ spi æºå¶ä¸ºæä»¬çç¨åºæä¾æå±åè½ãspi æºå¶å¨ç¬¬ä¸æ¹æ¡æ¶ä¸­ä¹ææåºç¨ï¼æ¯å¦ dubbo å°±æ¯éè¿ spi æºå¶å è½½ææçç»ä»¶ãä¸è¿ï¼dubbo å¹¶æªä½¿ç¨ java åçç spi æºå¶ï¼èæ¯å¯¹å¶è¿è¡äºå¢å¼ºï¼ä½¿å¶è½å¤æ´å¥½çæ»¡è¶³éæ±ãå¨ dubbo ä¸­ï¼spi æ¯ä¸ä¸ªéå¸¸éè¦çæ¨¡åãåºäº spiï¼æä»¬å¯ä»¥å¾å®¹æçå¯¹ dubbo è¿è¡æå±ã\n\ndubbo spi çç¸å³é»è¾è¢«å°è£å¨äº extensionloader ç±»ä¸­ï¼éè¿ extensionloaderï¼æä»¬å¯ä»¥å è½½æå®çå®ç°ç±»ãdubbo spi æéçéç½®æä»¶éæ¾ç½®å¨ meta-inf/dubbo è·¯å¾ä¸ã\n\n\n# åèèµæ\n\n * å®æ¹\n   * dubbo github\n   * dubbo å®æ¹ææ¡£\n   * ç®¡çåæå\n * æç« \n   * å¦ä½åºäº dubbo è¿è¡æå¡æ²»çãæå¡éçº§ãå¤±è´¥éè¯ä»¥åè¶æ¶éè¯ï¼',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java æ¡æ¶",frontmatter:{title:"Java æ¡æ¶",categories:["ç¼ç¨","Java","æ¡æ¶"],tags:["Java","æ¡æ¶"],abbrlink:"b3f7d0e8",date:"2022-02-18T08:53:11.000Z",hidden:!0,permalink:"/pages/fd4995/"},regularPath:"/13.%E6%A1%86%E6%9E%B6/",relativePath:"13.æ¡æ¶/README.md",key:"v-448a2646",path:"/pages/fd4995/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:14},{level:3,title:"Spring",slug:"spring",normalizedTitle:"spring",charIndex:24},{level:3,title:"Spring Boot",slug:"spring-boot",normalizedTitle:"spring boot",charIndex:72},{level:3,title:"ORM",slug:"orm",normalizedTitle:"orm",charIndex:129},{level:3,title:"å®å¨",slug:"å®å¨",normalizedTitle:"å®å¨",charIndex:168},{level:3,title:"IO",slug:"io",normalizedTitle:"io",charIndex:404},{level:3,title:"å¾®æå¡",slug:"å¾®æå¡",normalizedTitle:"å¾®æå¡",charIndex:421},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:439},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:737}],headersStr:"ð åå®¹ Spring Spring Boot ORM å®å¨ IO å¾®æå¡ ð èµæ ðª ä¼ é",content:"# Java æ¡æ¶\n\n\n# ð åå®¹\n\n\n# Spring\n\nð spring-tutorial æ¯ä¸ä¸ª Spring å®ææç¨ã\n\n\n# Spring Boot\n\nð Spring Boot æç¨ æ¯ä¸ä¸ª Spring Boot å®ææç¨ã\n\n\n# ORM\n\n * Mybatis å¿«éå¥é¨\n * Mybatis åç\n\n\n# å®å¨\n\n> Java é¢åæ¯è¾æµè¡çå®å¨æ¡æ¶å°±æ¯ shiro å spring-securityã\n> \n> shiro æ´ä¸ºç®åãè½»ä¾¿ï¼å®¹æçè§£ï¼è½æ»¡è¶³å¤§å¤æ°åºæ¬å®å¨åºæ¯ä¸çéè¦ã\n> \n> spring-security åè½æ´ä¸°å¯ï¼ä¹æ¯ shiro æ´å¤æãå¼å¾ä¸æçæ¯ç±äº spring-security æ¯ spring å¢éå¼åï¼æä»¥éæ spring å spring-boot æ¡æ¶æ´å®¹æã\n\n * Shiro\n * SpringSecurity\n\n\n# IO\n\n * Netty\n\n\n# å¾®æå¡\n\n * Dubbo\n\n\n# ð èµæ\n\n * Mybatis\n   * Mybatis Github\n   * Mybatis å®ç½\n   * MyBatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * MyBatis å®æ¹éæ Springï¼mybatis-springï¼\n   * Mybatis å®æ¹éæ Spring Bootï¼mybatis-spring-bootï¼\n   * MyBatis-Plus - CRUD æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * Mapper - CRUD æ©å±æä»¶\n   * Mybatis-PageHelper - Mybatis éç¨åé¡µæä»¶\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java æ¡æ¶\n\n\n# ð åå®¹\n\n\n# spring\n\nð spring-tutorial æ¯ä¸ä¸ª spring å®ææç¨ã\n\n\n# spring boot\n\nð spring boot æç¨ æ¯ä¸ä¸ª spring boot å®ææç¨ã\n\n\n# orm\n\n * mybatis å¿«éå¥é¨\n * mybatis åç\n\n\n# å®å¨\n\n> java é¢åæ¯è¾æµè¡çå®å¨æ¡æ¶å°±æ¯ shiro å spring-securityã\n> \n> shiro æ´ä¸ºç®åãè½»ä¾¿ï¼å®¹æçè§£ï¼è½æ»¡è¶³å¤§å¤æ°åºæ¬å®å¨åºæ¯ä¸çéè¦ã\n> \n> spring-security åè½æ´ä¸°å¯ï¼ä¹æ¯ shiro æ´å¤æãå¼å¾ä¸æçæ¯ç±äº spring-security æ¯ spring å¢éå¼åï¼æä»¥éæ spring å spring-boot æ¡æ¶æ´å®¹æã\n\n * shiro\n * springsecurity\n\n\n# io\n\n * netty\n\n\n# å¾®æå¡\n\n * dubbo\n\n\n# ð èµæ\n\n * mybatis\n   * mybatis github\n   * mybatis å®ç½\n   * mybatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * mybatis å®æ¹éæ springï¼mybatis-springï¼\n   * mybatis å®æ¹éæ spring bootï¼mybatis-spring-bootï¼\n   * mybatis-plus - crud æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * mapper - crud æ©å±æä»¶\n   * mybatis-pagehelper - mybatis éç¨åé¡µæä»¶\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"æ¶æ¯éåé¢è¯",frontmatter:{title:"æ¶æ¯éåé¢è¯",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","MQ"],tags:["Java","ä¸­é´ä»¶","MQ","é¢è¯"],abbrlink:"82d4fac9",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/5a6cf3/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.MQ/01.%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E9%9D%A2%E8%AF%95.html",relativePath:"14.ä¸­é´ä»¶/01.MQ/01.æ¶æ¯éåé¢è¯.md",key:"v-6aa69b5a",path:"/pages/5a6cf3/",headers:[{level:2,title:"ä¸ºä»ä¹ä½¿ç¨æ¶æ¯éåï¼",slug:"ä¸ºä»ä¹ä½¿ç¨æ¶æ¯éå",normalizedTitle:"ä¸ºä»ä¹ä½¿ç¨æ¶æ¯éåï¼",charIndex:18},{level:3,title:"è§£è¦",slug:"è§£è¦",normalizedTitle:"è§£è¦",charIndex:33},{level:3,title:"å¼æ­¥",slug:"å¼æ­¥",normalizedTitle:"å¼æ­¥",charIndex:565},{level:3,title:"åå³°",slug:"åå³°",normalizedTitle:"åå³°",charIndex:1017},{level:2,title:"æ¶æ¯éåæä»ä¹ä¼ç¼ºç¹",slug:"æ¶æ¯éåæä»ä¹ä¼ç¼ºç¹",normalizedTitle:"æ¶æ¯éåæä»ä¹ä¼ç¼ºç¹",charIndex:1652},{level:2,title:"KafkaãActiveMQãRabbitMQãRocketMQ æä»ä¹ä¼ç¼ºç¹ï¼",slug:"kafkaãactivemqãrabbitmqãrocketmq-æä»ä¹ä¼ç¼ºç¹",normalizedTitle:"kafkaãactivemqãrabbitmqãrocketmq æä»ä¹ä¼ç¼ºç¹ï¼",charIndex:2149},{level:2,title:"å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼",slug:"å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨",normalizedTitle:"å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼",charIndex:3976},{level:3,title:"RabbitMQ çé«å¯ç¨æ§",slug:"rabbitmq-çé«å¯ç¨æ§",normalizedTitle:"rabbitmq çé«å¯ç¨æ§",charIndex:3994},{level:4,title:"åæºæ¨¡å¼",slug:"åæºæ¨¡å¼",normalizedTitle:"åæºæ¨¡å¼",charIndex:4101},{level:4,title:"æ®ééç¾¤æ¨¡å¼ï¼æ é«å¯ç¨æ§ï¼",slug:"æ®ééç¾¤æ¨¡å¼-æ é«å¯ç¨æ§",normalizedTitle:"æ®ééç¾¤æ¨¡å¼ï¼æ é«å¯ç¨æ§ï¼",charIndex:4179},{level:4,title:"éåéç¾¤æ¨¡å¼ï¼é«å¯ç¨æ§ï¼",slug:"éåéç¾¤æ¨¡å¼-é«å¯ç¨æ§",normalizedTitle:"éåéç¾¤æ¨¡å¼ï¼é«å¯ç¨æ§ï¼",charIndex:4689},{level:3,title:"Kafka çé«å¯ç¨æ§",slug:"kafka-çé«å¯ç¨æ§",normalizedTitle:"kafka çé«å¯ç¨æ§",charIndex:5307},{level:2,title:"å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ï¼ï¼å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ï¼",slug:"å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹-å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§",normalizedTitle:"å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ï¼ï¼å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ï¼",charIndex:6781},{level:2,title:"å¦ä½ä¿è¯æ¶æ¯çå¯é æ§ä¼ è¾ï¼ï¼å¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ï¼",slug:"å¦ä½ä¿è¯æ¶æ¯çå¯é æ§ä¼ è¾-å¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢",normalizedTitle:"å¦ä½ä¿è¯æ¶æ¯çå¯é æ§ä¼ è¾ï¼ï¼å¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ï¼",charIndex:8332},{level:3,title:"RabbitMQ",slug:"rabbitmq",normalizedTitle:"rabbitmq",charIndex:2164},{level:4,title:"çäº§èå¼ä¸¢äºæ°æ®",slug:"çäº§èå¼ä¸¢äºæ°æ®",normalizedTitle:"çäº§èå¼ä¸¢äºæ°æ®",charIndex:8434},{level:4,title:"RabbitMQ å¼ä¸¢äºæ°æ®",slug:"rabbitmq-å¼ä¸¢äºæ°æ®",normalizedTitle:"rabbitmq å¼ä¸¢äºæ°æ®",charIndex:9297},{level:4,title:"æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®",slug:"æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®",normalizedTitle:"æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®",charIndex:9933},{level:3,title:"Kafka",slug:"kafka",normalizedTitle:"kafka",charIndex:2149},{level:4,title:"æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®",slug:"æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®-2",normalizedTitle:"æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®",charIndex:9933},{level:4,title:"Kafka å¼ä¸¢äºæ°æ®",slug:"kafka-å¼ä¸¢äºæ°æ®",normalizedTitle:"kafka å¼ä¸¢äºæ°æ®",charIndex:10672},{level:4,title:"çäº§èä¼ä¸ä¼å¼ä¸¢æ°æ®ï¼",slug:"çäº§èä¼ä¸ä¼å¼ä¸¢æ°æ®",normalizedTitle:"çäº§èä¼ä¸ä¼å¼ä¸¢æ°æ®ï¼",charIndex:11391},{level:2,title:"å¦ä½ä¿è¯æ¶æ¯çé¡ºåºæ§ï¼",slug:"å¦ä½ä¿è¯æ¶æ¯çé¡ºåºæ§",normalizedTitle:"å¦ä½ä¿è¯æ¶æ¯çé¡ºåºæ§ï¼",charIndex:11518},{level:3,title:"è§£å³æ¹æ¡",slug:"è§£å³æ¹æ¡",normalizedTitle:"è§£å³æ¹æ¡",charIndex:12413},{level:4,title:"RabbitMQ",slug:"rabbitmq-2",normalizedTitle:"rabbitmq",charIndex:2164},{level:4,title:"Kafka",slug:"kafka-2",normalizedTitle:"kafka",charIndex:2149},{level:2,title:"å¦ä½è§£å³æ¶æ¯éåçå»¶æ¶ä»¥åè¿æå¤±æé®é¢ï¼æ¶æ¯éåæ»¡äºä»¥åè¯¥æä¹å¤çï¼æå ç¾ä¸æ¶æ¯æç»­ç§¯åå å°æ¶ï¼è¯´è¯´æä¹è§£å³ï¼",slug:"å¦ä½è§£å³æ¶æ¯éåçå»¶æ¶ä»¥åè¿æå¤±æé®é¢-æ¶æ¯éåæ»¡äºä»¥åè¯¥æä¹å¤ç-æå ç¾ä¸æ¶æ¯æç»­ç§¯åå å°æ¶-è¯´è¯´æä¹è§£å³",normalizedTitle:"å¦ä½è§£å³æ¶æ¯éåçå»¶æ¶ä»¥åè¿æå¤±æé®é¢ï¼æ¶æ¯éåæ»¡äºä»¥åè¯¥æä¹å¤çï¼æå ç¾ä¸æ¶æ¯æç»­ç§¯åå å°æ¶ï¼è¯´è¯´æä¹è§£å³ï¼",charIndex:12598},{level:3,title:"é¢è¯é¢åæ",slug:"é¢è¯é¢åæ",normalizedTitle:"é¢è¯é¢åæ",charIndex:12932},{level:3,title:"å¤§éæ¶æ¯å¨ mq éç§¯åäºå ä¸ªå°æ¶äºè¿æ²¡è§£å³",slug:"å¤§éæ¶æ¯å¨-mq-éç§¯åäºå ä¸ªå°æ¶äºè¿æ²¡è§£å³",normalizedTitle:"å¤§éæ¶æ¯å¨ mq éç§¯åäºå ä¸ªå°æ¶äºè¿æ²¡è§£å³",charIndex:13007},{level:3,title:"mq ä¸­çæ¶æ¯è¿æå¤±æäº",slug:"mq-ä¸­çæ¶æ¯è¿æå¤±æäº",normalizedTitle:"mq ä¸­çæ¶æ¯è¿æå¤±æäº",charIndex:13663},{level:3,title:"mq é½å¿«åæ»¡äº",slug:"mq-é½å¿«åæ»¡äº",normalizedTitle:"mq é½å¿«åæ»¡äº",charIndex:14121},{level:2,title:"å¦æè®©ä½ åä¸ä¸ªæ¶æ¯éåï¼è¯¥å¦ä½è¿è¡æ¶æè®¾è®¡åï¼è¯´ä¸ä¸ä½ çæè·¯ã",slug:"å¦æè®©ä½ åä¸ä¸ªæ¶æ¯éå-è¯¥å¦ä½è¿è¡æ¶æè®¾è®¡å-è¯´ä¸ä¸ä½ çæè·¯ã",normalizedTitle:"å¦æè®©ä½ åä¸ä¸ªæ¶æ¯éåï¼è¯¥å¦ä½è¿è¡æ¶æè®¾è®¡åï¼è¯´ä¸ä¸ä½ çæè·¯ã",charIndex:14265},{level:3,title:"é¢è¯å®å¿çåæ",slug:"é¢è¯å®å¿çåæ",normalizedTitle:"é¢è¯å®å¿çåæ",charIndex:14301},{level:3,title:"é¢è¯é¢åæ",slug:"é¢è¯é¢åæ-2",normalizedTitle:"é¢è¯é¢åæ",charIndex:12932}],headersStr:"ä¸ºä»ä¹ä½¿ç¨æ¶æ¯éåï¼ è§£è¦ å¼æ­¥ åå³° æ¶æ¯éåæä»ä¹ä¼ç¼ºç¹ KafkaãActiveMQãRabbitMQãRocketMQ æä»ä¹ä¼ç¼ºç¹ï¼ å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼ RabbitMQ çé«å¯ç¨æ§ åæºæ¨¡å¼ æ®ééç¾¤æ¨¡å¼ï¼æ é«å¯ç¨æ§ï¼ éåéç¾¤æ¨¡å¼ï¼é«å¯ç¨æ§ï¼ Kafka çé«å¯ç¨æ§ å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ï¼ï¼å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ï¼ å¦ä½ä¿è¯æ¶æ¯çå¯é æ§ä¼ è¾ï¼ï¼å¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ï¼ RabbitMQ çäº§èå¼ä¸¢äºæ°æ® RabbitMQ å¼ä¸¢äºæ°æ® æ¶è´¹ç«¯å¼ä¸¢äºæ°æ® Kafka æ¶è´¹ç«¯å¼ä¸¢äºæ°æ® Kafka å¼ä¸¢äºæ°æ® çäº§èä¼ä¸ä¼å¼ä¸¢æ°æ®ï¼ å¦ä½ä¿è¯æ¶æ¯çé¡ºåºæ§ï¼ è§£å³æ¹æ¡ RabbitMQ Kafka å¦ä½è§£å³æ¶æ¯éåçå»¶æ¶ä»¥åè¿æå¤±æé®é¢ï¼æ¶æ¯éåæ»¡äºä»¥åè¯¥æä¹å¤çï¼æå ç¾ä¸æ¶æ¯æç»­ç§¯åå å°æ¶ï¼è¯´è¯´æä¹è§£å³ï¼ é¢è¯é¢åæ å¤§éæ¶æ¯å¨ mq éç§¯åäºå ä¸ªå°æ¶äºè¿æ²¡è§£å³ mq ä¸­çæ¶æ¯è¿æå¤±æäº mq é½å¿«åæ»¡äº å¦æè®©ä½ åä¸ä¸ªæ¶æ¯éåï¼è¯¥å¦ä½è¿è¡æ¶æè®¾è®¡åï¼è¯´ä¸ä¸ä½ çæè·¯ã é¢è¯å®å¿çåæ é¢è¯é¢åæ",content:"# æ¶æ¯éåé¢è¯å¤ºå½è¿ç¯é®\n\n\n# ä¸ºä»ä¹ä½¿ç¨æ¶æ¯éåï¼\n\n\n# è§£è¦\n\nçè¿ä¹ä¸ªåºæ¯ãA ç³»ç»åéæ°æ®å° BCD ä¸ä¸ªç³»ç»ï¼éè¿æ¥å£è°ç¨åéãå¦æ E ç³»ç»ä¹è¦è¿ä¸ªæ°æ®å¢ï¼é£å¦æ C ç³»ç»ç°å¨ä¸éè¦äºå¢ï¼A ç³»ç»è´è´£äººå ä¹å´©æº......\n\n\n\nå¨è¿ä¸ªåºæ¯ä¸­ï¼A ç³»ç»è·å¶å®åç§ä¹±ä¸å«ç³çç³»ç»ä¸¥éè¦åï¼A ç³»ç»äº§çä¸æ¡æ¯è¾å³é®çæ°æ®ï¼å¾å¤ç³»ç»é½éè¦ A ç³»ç»å°è¿ä¸ªæ°æ®åéè¿æ¥ãA ç³»ç»è¦æ¶æ¶å»å»èè BCDE åä¸ªç³»ç»å¦ææäºè¯¥ååï¼è¦ä¸è¦éåï¼è¦ä¸è¦ææ¶æ¯å­èµ·æ¥ï¼å¤´åé½ç½äºåï¼\n\nå¦æä½¿ç¨ MQï¼A ç³»ç»äº§çä¸æ¡æ°æ®ï¼åéå° MQ éé¢å»ï¼åªä¸ªç³»ç»éè¦æ°æ®èªå·±å» MQ éé¢æ¶è´¹ãå¦ææ°ç³»ç»éè¦æ°æ®ï¼ç´æ¥ä» MQ éæ¶è´¹å³å¯ï¼å¦ææä¸ªç³»ç»ä¸éè¦è¿æ¡æ°æ®äºï¼å°±åæ¶å¯¹ MQ æ¶æ¯çæ¶è´¹å³å¯ãè¿æ ·ä¸æ¥ï¼A ç³»ç»åæ ¹å¿ä¸éè¦å»èèè¦ç»è°åéæ°æ®ï¼ä¸éè¦ç»´æ¤è¿ä¸ªä»£ç ï¼ä¹ä¸éè¦èèäººå®¶æ¯å¦è°ç¨æåãå¤±è´¥è¶æ¶ç­æåµã\n\n\n\næ»ç»ï¼éè¿ä¸ä¸ª MQï¼Pub/Sub åå¸è®¢éæ¶æ¯è¿ä¹ä¸ä¸ªæ¨¡åï¼A ç³»ç»å°±è·å¶å®ç³»ç»å½»åºè§£è¦äºã\n\né¢è¯æå·§ï¼ä½ éè¦å»èèä¸ä¸ä½ è´è´£çç³»ç»ä¸­æ¯å¦æç±»ä¼¼çåºæ¯ï¼å°±æ¯ä¸ä¸ªç³»ç»æèä¸ä¸ªæ¨¡åï¼è°ç¨äºå¤ä¸ªç³»ç»æèæ¨¡åï¼äºç¸ä¹é´çè°ç¨å¾å¤æï¼ç»´æ¤èµ·æ¥å¾éº»ç¦ãä½æ¯å¶å®è¿ä¸ªè°ç¨æ¯ä¸éè¦ç´æ¥åæ­¥è°ç¨æ¥å£çï¼å¦æç¨ MQ ç»å®å¼æ­¥åè§£è¦ï¼ä¹æ¯å¯ä»¥çï¼ä½ å°±éè¦å»èèå¨ä½ çé¡¹ç®éï¼æ¯ä¸æ¯å¯ä»¥è¿ç¨è¿ä¸ª MQ å»è¿è¡ç³»ç»çè§£è¦ãå¨ç®åä¸­ä½ç°åºæ¥è¿åä¸è¥¿ï¼ç¨ MQ ä½è§£è¦ã\n\n\n# å¼æ­¥\n\nåæ¥çä¸ä¸ªåºæ¯ï¼A ç³»ç»æ¥æ¶ä¸ä¸ªè¯·æ±ï¼éè¦å¨èªå·±æ¬å°ååºï¼è¿éè¦å¨ BCD ä¸ä¸ªç³»ç»ååºï¼èªå·±æ¬å°ååºè¦ 3msï¼BCD ä¸ä¸ªç³»ç»åå«ååºè¦ 300msã450msã200msãæç»è¯·æ±æ»å»¶æ¶æ¯ 3 + 300 + 450 + 200 = 953msï¼æ¥è¿ 1sï¼ç¨æ·æè§æä¸ªä»ä¹ä¸è¥¿ï¼æ¢æ­»äºæ¢æ­»äºãç¨æ·éè¿æµè§å¨åèµ·è¯·æ±ï¼ç­å¾ä¸ª 1sï¼è¿å ä¹æ¯ä¸å¯æ¥åçã\n\n\n\nä¸è¬äºèç½ç±»çä¼ä¸ï¼å¯¹äºç¨æ·ç´æ¥çæä½ï¼ä¸è¬è¦æ±æ¯æ¯ä¸ªè¯·æ±é½å¿é¡»å¨ 200 ms ä»¥åå®æï¼å¯¹ç¨æ·å ä¹æ¯æ æç¥çã\n\nå¦æä½¿ç¨ MQï¼é£ä¹ A ç³»ç»è¿ç»­åé 3 æ¡æ¶æ¯å° MQ éåä¸­ï¼åå¦èæ¶ 5msï¼A ç³»ç»ä»æ¥åä¸ä¸ªè¯·æ±å°è¿åååºç»ç¨æ·ï¼æ»æ¶é¿æ¯ 3 + 5 = 8msï¼å¯¹äºç¨æ·èè¨ï¼å¶å®æè§ä¸å°±æ¯ç¹ä¸ªæé®ï¼8ms ä»¥åå°±ç´æ¥è¿åäºï¼ç½ï¼ç½ç«åå¾çå¥½ï¼çå¿«ï¼\n\n\n\n\n# åå³°\n\næ¯å¤© 0:00 å° 12:00ï¼A ç³»ç»é£å¹³æµªéï¼æ¯ç§å¹¶åè¯·æ±æ°éå°± 50 ä¸ªãç»ææ¯æ¬¡ä¸å° 12:00 ~ 13:00 ï¼æ¯ç§å¹¶åè¯·æ±æ°éçªç¶ä¼æ´å¢å° 5k+ æ¡ãä½æ¯ç³»ç»æ¯ç´æ¥åºäº MySQL çï¼å¤§éçè¯·æ±æ¶å¥ MySQLï¼æ¯ç§éå¯¹ MySQL æ§è¡çº¦ 5k æ¡ SQLã\n\nä¸è¬ç MySQLï¼æå°æ¯ç§ 2k ä¸ªè¯·æ±å°±å·®ä¸å¤äºï¼å¦ææ¯ç§è¯·æ±å° 5k çè¯ï¼å¯è½å°±ç´æ¥æ MySQL ç»ææ­»äºï¼å¯¼è´ç³»ç»å´©æºï¼ç¨æ·ä¹å°±æ²¡æ³åä½¿ç¨ç³»ç»äºã\n\nä½æ¯é«å³°æä¸è¿ï¼å°äºä¸åçæ¶åï¼å°±æäºä½å³°æï¼å¯è½ä¹å°± 1w çç¨æ·åæ¶å¨ç½ç«ä¸æä½ï¼æ¯ç§ä¸­çè¯·æ±æ°éå¯è½ä¹å°± 50 ä¸ªè¯·æ±ï¼å¯¹æ´ä¸ªç³»ç»å ä¹æ²¡æä»»ä½çååã\n\n\n\nå¦æä½¿ç¨ MQï¼æ¯ç§ 5k ä¸ªè¯·æ±åå¥ MQï¼A ç³»ç»æ¯ç§éæå¤å¤ç 2k ä¸ªè¯·æ±ï¼å ä¸º MySQL æ¯ç§éæå¤å¤ç 2k ä¸ªãA ç³»ç»ä» MQ ä¸­æ¢æ¢æåè¯·æ±ï¼æ¯ç§éå°±æå 2k ä¸ªè¯·æ±ï¼ä¸è¦è¶è¿èªå·±æ¯ç§è½å¤ççæå¤§è¯·æ±æ°éå°± okï¼è¿æ ·ä¸æ¥ï¼åªææ¯é«å³°æçæ¶åï¼A ç³»ç»ä¹ç»å¯¹ä¸ä¼ææãè MQ æ¯ç§é 5k ä¸ªè¯·æ±è¿æ¥ï¼å°± 2k ä¸ªè¯·æ±åºå»ï¼ç»æå°±å¯¼è´å¨ä¸­åé«å³°æï¼1 ä¸ªå°æ¶ï¼ï¼å¯è½æå åä¸çè³å ç¾ä¸çè¯·æ±ç§¯åå¨ MQ ä¸­ã\n\n\n\nè¿ä¸ªç­æçé«å³°æç§¯åæ¯ ok çï¼å ä¸ºé«å³°æè¿äºä¹åï¼æ¯ç§éå°± 50 ä¸ªè¯·æ±è¿ MQï¼ä½æ¯ A ç³»ç»ä¾ç¶ä¼æç§æ¯ç§ 2k ä¸ªè¯·æ±çéåº¦å¨å¤çãæä»¥è¯´ï¼åªè¦é«å³°æä¸è¿ï¼A ç³»ç»å°±ä¼å¿«éå°ç§¯åçæ¶æ¯ç»è§£å³æã\n\n\n# æ¶æ¯éåæä»ä¹ä¼ç¼ºç¹\n\nä¼ç¹ä¸é¢å·²ç»è¯´äºï¼å°±æ¯å¨ç¹æ®åºæ¯ä¸æå¶å¯¹åºçå¥½å¤ï¼è§£è¦ãå¼æ­¥ãåå³°ã\n\nç¼ºç¹æä»¥ä¸å ä¸ªï¼\n\n * ç³»ç»å¯ç¨æ§éä½ ç³»ç»å¼å¥çå¤é¨ä¾èµè¶å¤ï¼è¶å®¹æææãæ¬æ¥ä½ å°±æ¯ A ç³»ç»è°ç¨ BCD ä¸ä¸ªç³»ç»çæ¥å£å°±å¥½äºï¼äºº ABCD åä¸ªç³»ç»å¥½å¥½çï¼æ²¡å¥é®é¢ï¼ä½ åå ä¸ª MQ è¿æ¥ï¼ä¸ä¸ MQ æäºåæ´ï¼MQ ä¸æï¼æ´å¥ç³»ç»å´©æºçï¼ä½ ä¸å°±å®äºï¼å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼å¯ä»¥ç¹å»è¿éæ¥çã\n * ç³»ç»å¤æåº¦æé« ç¡¬ççå ä¸ª MQ è¿æ¥ï¼ä½ æä¹ä¿è¯æ¶æ¯æ²¡æéå¤æ¶è´¹ï¼æä¹å¤çæ¶æ¯ä¸¢å¤±çæåµï¼æä¹ä¿è¯æ¶æ¯ä¼ éçé¡ºåºæ§ï¼å¤´å¤§å¤´å¤§ï¼é®é¢ä¸å¤§å ï¼çè¦ä¸å·²ã\n * ä¸è´æ§é®é¢ A ç³»ç»å¤çå®äºç´æ¥è¿åæåäºï¼äººé½ä»¥ä¸ºä½ è¿ä¸ªè¯·æ±å°±æåäºï¼ä½æ¯é®é¢æ¯ï¼è¦æ¯ BCD ä¸ä¸ªç³»ç»é£éï¼BD ä¸¤ä¸ªç³»ç»ååºæåäºï¼ç»æ C ç³»ç»ååºå¤±è´¥äºï¼åæ´ï¼ä½ è¿æ°æ®å°±ä¸ä¸è´äºã\n\næä»¥æ¶æ¯éåå®éæ¯ä¸ç§éå¸¸å¤æçæ¶æï¼ä½ å¼å¥å®æå¾å¤å¥½å¤ï¼ä½æ¯ä¹å¾éå¯¹å®å¸¦æ¥çåå¤ååç§é¢å¤çææ¯æ¹æ¡åæ¶ææ¥è§é¿æï¼åå¥½ä¹åï¼ä½ ä¼åç°ï¼å¦åï¼ç³»ç»å¤æåº¦æåäºä¸ä¸ªæ°éçº§ï¼ä¹è®¸æ¯å¤æäº 10 åãä½æ¯å³é®æ¶å»ï¼ç¨ï¼è¿æ¯å¾ç¨çã\n\n\n# KafkaãActiveMQãRabbitMQãRocketMQ æä»ä¹ä¼ç¼ºç¹ï¼\n\nç¹æ§                ACTIVEMQ                     RABBITMQ                        ROCKETMQ                                      KAFKA\nåæºååé             ä¸çº§ï¼æ¯ RocketMQãKafka ä½ä¸ä¸ªæ°éçº§   å ActiveMQ                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡å®æ¶æ°æ®è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ RocketMQ   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼Kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ RabbitMQ çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å ActiveMQ                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å RocketMQ\nåè½æ¯æ              MQ é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   MQ åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç MQ åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸è¬çä¸å¡ç³»ç»è¦å¼å¥ MQï¼ææ©å¤§å®¶é½ç¨ ActiveMQï¼ä½æ¯ç°å¨ç¡®å®å¤§å®¶ç¨çä¸å¤äºï¼æ²¡ç»è¿å¤§è§æ¨¡ååéåºæ¯çéªè¯ï¼ç¤¾åºä¹ä¸æ¯å¾æ´»è·ï¼æä»¥å¤§å®¶è¿æ¯ç®äºå§ï¼æä¸ªäººä¸æ¨èç¨è¿ä¸ªäºï¼\n * åæ¥å¤§å®¶å¼å§ç¨ RabbitMQï¼ä½æ¯ç¡®å® erlang è¯­è¨é»æ­¢äºå¤§éç Java å·¥ç¨å¸å»æ·±å¥ç ç©¶åææ§å®ï¼å¯¹å¬å¸èè¨ï¼å ä¹å¤äºä¸å¯æ§çç¶æï¼ä½æ¯ç¡®å®äººå®¶æ¯å¼æºçï¼æ¯è¾ç¨³å®çæ¯æï¼æ´»è·åº¦ä¹é«ï¼\n * ä¸è¿ç°å¨ç¡®å®è¶æ¥è¶å¤çå¬å¸ä¼å»ç¨ RocketMQï¼ç¡®å®å¾ä¸éï¼æ¯ç«æ¯é¿éåºåï¼ä½ç¤¾åºå¯è½æçªç¶é»æçé£é©ï¼ç®å RocketMQ å·²æç» Apacheï¼ä½ GitHub ä¸çæ´»è·åº¦å¶å®ä¸ç®é«ï¼å¯¹èªå·±å¬å¸ææ¯å®åæç»å¯¹èªä¿¡çï¼æ¨èç¨ RocketMQï¼å¦ååå»èèå®å®ç¨ RabbitMQ å§ï¼äººå®¶ææ´»è·çå¼æºç¤¾åºï¼ç»å¯¹ä¸ä¼é»ã\n * æä»¥ä¸­å°åå¬å¸ï¼ææ¯å®åè¾ä¸ºä¸è¬ï¼ææ¯ææä¸æ¯ç¹å«é«ï¼ç¨ RabbitMQ æ¯ä¸éçéæ©ï¼å¤§åå¬å¸ï¼åºç¡æ¶æç åå®åè¾å¼ºï¼ç¨ RocketMQ æ¯å¾å¥½çéæ©ã\n * å¦ææ¯å¤§æ°æ®é¢åçå®æ¶è®¡ç®ãæ¥å¿ééç­åºæ¯ï¼ç¨ Kafka æ¯ä¸åæ åçï¼ç»å¯¹æ²¡é®é¢ï¼ç¤¾åºæ´»è·åº¦å¾é«ï¼ç»å¯¹ä¸ä¼é»ï¼ä½åµå ä¹æ¯å¨ä¸çè¿ä¸ªé¢åçäºå®æ§è§èã\n\n\n# å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼\n\n\n# RabbitMQ çé«å¯ç¨æ§\n\nRabbitMQ æ¯æ¯è¾æä»£è¡¨æ§çï¼å ä¸ºæ¯åºäºä¸»ä»ï¼éåå¸å¼ï¼åé«å¯ç¨æ§çï¼æä»¬å°±ä»¥ RabbitMQ ä¸ºä¾å­è®²è§£ç¬¬ä¸ç§ MQ çé«å¯ç¨æ§æä¹å®ç°ã\n\nRabbitMQ æä¸ç§æ¨¡å¼ï¼åæºæ¨¡å¼ãæ®ééç¾¤æ¨¡å¼ãéåéç¾¤æ¨¡å¼ã\n\n# åæºæ¨¡å¼\n\nåæºæ¨¡å¼ï¼å°±æ¯ Demo çº§å«çï¼ä¸è¬å°±æ¯ä½ æ¬å°å¯å¨äºç©ç©å¿ç ðï¼æ²¡äººçäº§ç¨åæºæ¨¡å¼ã\n\n# æ®ééç¾¤æ¨¡å¼ï¼æ é«å¯ç¨æ§ï¼\n\næ®ééç¾¤æ¨¡å¼ï¼ææå°±æ¯å¨å¤å°æºå¨ä¸å¯å¨å¤ä¸ª RabbitMQ å®ä¾ï¼æ¯ä¸ªæºå¨å¯å¨ä¸ä¸ªãä½ åå»ºç queueï¼åªä¼æ¾å¨ä¸ä¸ª RabbitMQ å®ä¾ä¸ï¼ä½æ¯æ¯ä¸ªå®ä¾é½åæ­¥ queue çåæ°æ®ï¼åæ°æ®å¯ä»¥è®¤ä¸ºæ¯ queue çä¸äºéç½®ä¿¡æ¯ï¼éè¿åæ°æ®ï¼å¯ä»¥æ¾å° queue æå¨å®ä¾ï¼ãä½ æ¶è´¹çæ¶åï¼å®éä¸å¦æè¿æ¥å°äºå¦å¤ä¸ä¸ªå®ä¾ï¼é£ä¹é£ä¸ªå®ä¾ä¼ä» queue æå¨å®ä¾ä¸æåæ°æ®è¿æ¥ã\n\n\n\nè¿ç§æ¹å¼ç¡®å®å¾éº»ç¦ï¼ä¹ä¸æä¹å¥½ï¼æ²¡åå°æè°çåå¸å¼ï¼å°±æ¯ä¸ªæ®ééç¾¤ãå ä¸ºè¿å¯¼è´ä½ è¦ä¹æ¶è´¹èæ¯æ¬¡éæºè¿æ¥ä¸ä¸ªå®ä¾ç¶åæåæ°æ®ï¼è¦ä¹åºå®è¿æ¥é£ä¸ª queue æå¨å®ä¾æ¶è´¹æ°æ®ï¼åèææ°æ®æåçå¼éï¼åèå¯¼è´åå®ä¾æ§è½ç¶é¢ã\n\nèä¸å¦æé£ä¸ªæ¾ queue çå®ä¾å®æºäºï¼ä¼å¯¼è´æ¥ä¸æ¥å¶ä»å®ä¾å°±æ æ³ä»é£ä¸ªå®ä¾æåï¼å¦æä½ å¼å¯äºæ¶æ¯æä¹åï¼è®© RabbitMQ è½å°å­å¨æ¶æ¯çè¯ï¼æ¶æ¯ä¸ä¸å®ä¼ä¸¢ï¼å¾ç­è¿ä¸ªå®ä¾æ¢å¤äºï¼ç¶åæå¯ä»¥ç»§ç»­ä»è¿ä¸ª queue æåæ°æ®ã\n\næä»¥è¿ä¸ªäºå¿å°±æ¯è¾å°´å°¬äºï¼è¿å°±æ²¡æä»ä¹æè°çé«å¯ç¨æ§ï¼è¿æ¹æ¡ä¸»è¦æ¯æé«ååéçï¼å°±æ¯è¯´è®©éç¾¤ä¸­å¤ä¸ªèç¹æ¥æå¡æä¸ª queue çè¯»åæä½ã\n\n# éåéç¾¤æ¨¡å¼ï¼é«å¯ç¨æ§ï¼\n\nè¿ç§æ¨¡å¼ï¼ææ¯æè°ç RabbitMQ çé«å¯ç¨æ¨¡å¼ãè·æ®ééç¾¤æ¨¡å¼ä¸ä¸æ ·çæ¯ï¼å¨éåéç¾¤æ¨¡å¼ä¸ï¼ä½ åå»ºç queueï¼æ è®ºåæ°æ®è¿æ¯ queue éçæ¶æ¯é½ä¼å­å¨äºå¤ä¸ªå®ä¾ä¸ï¼å°±æ¯è¯´ï¼æ¯ä¸ª RabbitMQ èç¹é½æè¿ä¸ª queue çä¸ä¸ªå®æ´éåï¼åå« queue çå¨é¨æ°æ®çææãç¶åæ¯æ¬¡ä½ åæ¶æ¯å° queue çæ¶åï¼é½ä¼èªå¨ææ¶æ¯åæ­¥å°å¤ä¸ªå®ä¾ç queue ä¸ã\n\n\n\né£ä¹å¦ä½å¼å¯è¿ä¸ªéåéç¾¤æ¨¡å¼å¢ï¼å¶å®å¾ç®åï¼RabbitMQ æå¾å¥½çç®¡çæ§å¶å°ï¼å°±æ¯å¨åå°æ°å¢ä¸ä¸ªç­ç¥ï¼è¿ä¸ªç­ç¥æ¯éåéç¾¤æ¨¡å¼çç­ç¥ï¼æå®çæ¶åæ¯å¯ä»¥è¦æ±æ°æ®åæ­¥å°ææèç¹çï¼ä¹å¯ä»¥è¦æ±åæ­¥å°æå®æ°éçèç¹ï¼åæ¬¡åå»º queue çæ¶åï¼åºç¨è¿ä¸ªç­ç¥ï¼å°±ä¼èªå¨å°æ°æ®åæ­¥å°å¶ä»çèç¹ä¸å»äºã\n\nè¿æ ·çè¯ï¼å¥½å¤å¨äºï¼ä½ ä»»ä½ä¸ä¸ªæºå¨å®æºäºï¼æ²¡äºå¿ï¼å¶å®æºå¨ï¼èç¹ï¼è¿åå«äºè¿ä¸ª queue çå®æ´æ°æ®ï¼å«ç consumer é½å¯ä»¥å°å¶å®èç¹ä¸å»æ¶è´¹æ°æ®ãåå¤å¨äºï¼ç¬¬ä¸ï¼è¿ä¸ªæ§è½å¼éä¹å¤ªå¤§äºå§ï¼æ¶æ¯éè¦åæ­¥å°æææºå¨ä¸ï¼å¯¼è´ç½ç»å¸¦å®½åååæ¶èå¾éï¼ç¬¬äºï¼è¿ä¹ç©å¿ï¼ä¸æ¯åå¸å¼çï¼å°±æ²¡ææ©å±æ§å¯è¨äºï¼å¦ææä¸ª queue è´è½½å¾éï¼ä½ å æºå¨ï¼æ°å¢çæºå¨ä¹åå«äºè¿ä¸ª queue çæææ°æ®ï¼å¹¶æ²¡æåæ³çº¿æ§æ©å±ä½ ç queueãä½ æ³ï¼å¦æè¿ä¸ª queue çæ°æ®éå¾å¤§ï¼å¤§å°è¿ä¸ªæºå¨ä¸çå®¹éæ æ³å®¹çº³äºï¼æ­¤æ¶è¯¥æä¹åå¢ï¼\n\n\n# Kafka çé«å¯ç¨æ§\n\nKafka ä¸ä¸ªæåºæ¬çæ¶æè®¤è¯ï¼ç±å¤ä¸ª broker ç»æï¼æ¯ä¸ª broker æ¯ä¸ä¸ªèç¹ï¼ä½ åå»ºä¸ä¸ª topicï¼è¿ä¸ª topic å¯ä»¥ååä¸ºå¤ä¸ª partitionï¼æ¯ä¸ª partition å¯ä»¥å­å¨äºä¸åç broker ä¸ï¼æ¯ä¸ª partition å°±æ¾ä¸é¨åæ°æ®ã\n\nè¿å°±æ¯å¤©ç¶çåå¸å¼æ¶æ¯éåï¼å°±æ¯è¯´ä¸ä¸ª topic çæ°æ®ï¼æ¯åæ£æ¾å¨å¤ä¸ªæºå¨ä¸çï¼æ¯ä¸ªæºå¨å°±æ¾ä¸é¨åæ°æ®ã\n\nå®éä¸ RabbmitMQ ä¹ç±»çï¼å¹¶ä¸æ¯åå¸å¼æ¶æ¯éåï¼å®å°±æ¯ä¼ ç»çæ¶æ¯éåï¼åªä¸è¿æä¾äºä¸äºéç¾¤ãHA(High Availability, é«å¯ç¨æ§) çæºå¶èå·²ï¼å ä¸ºæ è®ºæä¹ç©å¿ï¼RabbitMQ ä¸ä¸ª queue çæ°æ®é½æ¯æ¾å¨ä¸ä¸ªèç¹éçï¼éåéç¾¤ä¸ï¼ä¹æ¯æ¯ä¸ªèç¹é½æ¾è¿ä¸ª queue çå®æ´æ°æ®ã\n\nKafka 0.8 ä»¥åï¼æ¯æ²¡æ HA æºå¶çï¼å°±æ¯ä»»ä½ä¸ä¸ª broker å®æºäºï¼é£ä¸ª broker ä¸ç partition å°±åºäºï¼æ²¡æ³åä¹æ²¡æ³è¯»ï¼æ²¡æä»ä¹é«å¯ç¨æ§å¯è¨ã\n\næ¯å¦è¯´ï¼æä»¬åè®¾åå»ºäºä¸ä¸ª topicï¼æå®å¶ partition æ°éæ¯ 3 ä¸ªï¼åå«å¨ä¸å°æºå¨ä¸ãä½æ¯ï¼å¦æç¬¬äºå°æºå¨å®æºäºï¼ä¼å¯¼è´è¿ä¸ª topic ç 1/3 çæ°æ®å°±ä¸¢äºï¼å æ­¤è¿ä¸ªæ¯åä¸å°é«å¯ç¨çã\n\n\n\nKafka 0.8 ä»¥åï¼æä¾äº HA æºå¶ï¼å°±æ¯ replicaï¼å¤å¶åï¼ å¯æ¬æºå¶ãæ¯ä¸ª partition çæ°æ®é½ä¼åæ­¥å°å¶å®æºå¨ä¸ï¼å½¢æèªå·±çå¤ä¸ª replica å¯æ¬ãææ replica ä¼éä¸¾ä¸ä¸ª leader åºæ¥ï¼é£ä¹çäº§åæ¶è´¹é½è·è¿ä¸ª leader æäº¤éï¼ç¶åå¶ä» replica å°±æ¯ followerãåçæ¶åï¼leader ä¼è´è´£ææ°æ®åæ­¥å°ææ follower ä¸å»ï¼è¯»çæ¶åå°±ç´æ¥è¯» leader ä¸çæ°æ®å³å¯ãåªè½è¯»å leaderï¼å¾ç®åï¼è¦æ¯ä½ å¯ä»¥éæè¯»åæ¯ä¸ª followerï¼é£ä¹å°±è¦ care æ°æ®ä¸è´æ§çé®é¢ï¼ç³»ç»å¤æåº¦å¤ªé«ï¼å¾å®¹æåºé®é¢ãKafka ä¼ååå°å°ä¸ä¸ª partition çææ replica åå¸å¨ä¸åçæºå¨ä¸ï¼è¿æ ·æå¯ä»¥æé«å®¹éæ§ã\n\n\n\nè¿ä¹æï¼å°±ææè°çé«å¯ç¨æ§äºï¼å ä¸ºå¦ææä¸ª broker å®æºäºï¼æ²¡äºå¿ï¼é£ä¸ª broker ä¸é¢ç partition å¨å¶ä»æºå¨ä¸é½æå¯æ¬çãå¦æè¿ä¸ªå®æºç broker ä¸é¢ææä¸ª partition ç leaderï¼é£ä¹æ­¤æ¶ä¼ä» follower ä¸­éæ°éä¸¾ä¸ä¸ªæ°ç leader åºæ¥ï¼å¤§å®¶ç»§ç»­è¯»åé£ä¸ªæ°ç leader å³å¯ãè¿å°±ææè°çé«å¯ç¨æ§äºã\n\nåæ°æ®çæ¶åï¼çäº§èå°±å leaderï¼ç¶å leader å°æ°æ®è½å°åæ¬å°ç£çï¼æ¥çå¶ä» follower èªå·±ä¸»å¨ä» leader æ¥ pull æ°æ®ãä¸æ¦ææ follower åæ­¥å¥½æ°æ®äºï¼å°±ä¼åé ack ç» leaderï¼leader æ¶å°ææ follower ç ack ä¹åï¼å°±ä¼è¿ååæåçæ¶æ¯ç»çäº§èãï¼å½ç¶ï¼è¿åªæ¯å¶ä¸­ä¸ç§æ¨¡å¼ï¼è¿å¯ä»¥éå½è°æ´è¿ä¸ªè¡ä¸ºï¼\n\næ¶è´¹çæ¶åï¼åªä¼ä» leader å»è¯»ï¼ä½æ¯åªæå½ä¸ä¸ªæ¶æ¯å·²ç»è¢«ææ follower é½åæ­¥æåè¿å ack çæ¶åï¼è¿ä¸ªæ¶æ¯æä¼è¢«æ¶è´¹èè¯»å°ã\n\nçå°è¿éï¼ç¸ä¿¡ä½ å¤§è´æç½äº Kafka æ¯å¦ä½ä¿è¯é«å¯ç¨æºå¶çäºï¼å¯¹å§ï¼ä¸è³äºä¸æ æç¥ï¼ç°åºè¿è½ç»é¢è¯å®ç»ç»å¾ãè¦æ¯éä¸é¢è¯å®ç¡®å®æ¯ Kafka é«æï¼æ·±æäºé®ï¼é£ä½ åªè½è¯´ä¸å¥½ææï¼å¤ªæ·±å¥çä½ æ²¡ç ç©¶è¿ã\n\n\n# å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ï¼ï¼å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ï¼\n\né¦åï¼æ¯å¦ RabbitMQãRocketMQãKafkaï¼é½æå¯è½ä¼åºç°æ¶æ¯éå¤æ¶è´¹çé®é¢ï¼æ­£å¸¸ãå ä¸ºè¿é®é¢éå¸¸ä¸æ¯ MQ èªå·±ä¿è¯çï¼æ¯ç±æä»¬å¼åæ¥ä¿è¯çãæä¸ä¸ª Kafka æ¥ä¸¾ä¸ªä¾å­ï¼è¯´è¯´æä¹éå¤æ¶è´¹å§ã\n\nKafka å®éä¸æä¸ª offset çæ¦å¿µï¼å°±æ¯æ¯ä¸ªæ¶æ¯åè¿å»ï¼é½æä¸ä¸ª offsetï¼ä»£è¡¨æ¶æ¯çåºå·ï¼ç¶å consumer æ¶è´¹äºæ°æ®ä¹åï¼æ¯éä¸æ®µæ¶é´ï¼å®æ¶å®æï¼ï¼ä¼æèªå·±æ¶è´¹è¿çæ¶æ¯ç offset æäº¤ä¸ä¸ï¼è¡¨ç¤ºâæå·²ç»æ¶è´¹è¿äºï¼ä¸æ¬¡æè¦æ¯éå¯å¥çï¼ä½ å°±è®©æç»§ç»­ä»ä¸æ¬¡æ¶è´¹å°ç offset æ¥ç»§ç»­æ¶è´¹å§âã\n\nä½æ¯å¡äºæ»ææå¤ï¼æ¯å¦æä»¬ä¹åçäº§ç»å¸¸éå°çï¼å°±æ¯ä½ ææ¶åéå¯ç³»ç»ï¼çä½ æä¹éå¯äºï¼å¦æç¢°å°ç¹çæ¥çï¼ç´æ¥ kill è¿ç¨äºï¼åéå¯ãè¿ä¼å¯¼è´ consumer æäºæ¶æ¯å¤çäºï¼ä½æ¯æ²¡æ¥å¾åæäº¤ offsetï¼å°´å°¬äºãéå¯ä¹åï¼å°æ°æ¶æ¯ä¼åæ¬¡æ¶è´¹ä¸æ¬¡ã\n\nä¸¾ä¸ªæ å­ã\n\næè¿ä¹ä¸ªåºæ¯ãæ°æ® 1/2/3 ä¾æ¬¡è¿å¥ kafkaï¼kafka ä¼ç»è¿ä¸æ¡æ°æ®æ¯æ¡åéä¸ä¸ª offsetï¼ä»£è¡¨è¿æ¡æ°æ®çåºå·ï¼æä»¬å°±åè®¾åéç offset ä¾æ¬¡æ¯ 152/153/154ãæ¶è´¹èä» kafka å»æ¶è´¹çæ¶åï¼ä¹æ¯æç§è¿ä¸ªé¡ºåºå»æ¶è´¹ãåå¦å½æ¶è´¹èæ¶è´¹äº offset=153 çè¿æ¡æ°æ®ï¼ååå¤å»æäº¤ offset å° zookeeperï¼æ­¤æ¶æ¶è´¹èè¿ç¨è¢«éå¯äºãé£ä¹æ­¤æ¶æ¶è´¹è¿çæ°æ® 1/2 ç offset å¹¶æ²¡ææäº¤ï¼kafka ä¹å°±ä¸ç¥éä½ å·²ç»æ¶è´¹äº offset=153 è¿æ¡æ°æ®ãé£ä¹éå¯ä¹åï¼æ¶è´¹èä¼æ¾ kafka è¯´ï¼å¿ï¼å¥å¿ä»¬ï¼ä½ ç»ææ¥çæä¸æ¬¡ææ¶è´¹å°çé£ä¸ªå°æ¹åé¢çæ°æ®ç»§ç»­ç»æä¼ éè¿æ¥ãç±äºä¹åç offset æ²¡ææäº¤æåï¼é£ä¹æ°æ® 1/2 ä¼åæ¬¡ä¼ è¿æ¥ï¼å¦ææ­¤æ¶æ¶è´¹èæ²¡æå»éçè¯ï¼é£ä¹å°±ä¼å¯¼è´éå¤æ¶è´¹ã\n\n\n\nå¦ææ¶è´¹èå¹²çäºå¿æ¯æ¿ä¸æ¡æ°æ®å°±å¾æ°æ®åºéåä¸æ¡ï¼ä¼å¯¼è´è¯´ï¼ä½ å¯è½å°±ææ°æ® 1/2 å¨æ°æ®åºéæå¥äº 2 æ¬¡ï¼é£ä¹æ°æ®å°±éå¦ã\n\nå¶å®éå¤æ¶è´¹ä¸å¯æï¼å¯æçæ¯ä½ æ²¡èèå°éå¤æ¶è´¹ä¹åï¼æä¹ä¿è¯å¹ç­æ§ã\n\nä¸¾ä¸ªä¾å­å§ãåè®¾ä½ æä¸ªç³»ç»ï¼æ¶è´¹ä¸æ¡æ¶æ¯å°±å¾æ°æ®åºéæå¥ä¸æ¡æ°æ®ï¼è¦æ¯ä½ ä¸ä¸ªæ¶æ¯éå¤ä¸¤æ¬¡ï¼ä½ ä¸å°±æå¥äºä¸¤æ¡ï¼è¿æ°æ®ä¸å°±éäºï¼ä½æ¯ä½ è¦æ¯æ¶è´¹å°ç¬¬äºæ¬¡çæ¶åï¼èªå·±å¤æ­ä¸ä¸æ¯å¦å·²ç»æ¶è´¹è¿äºï¼è¥æ¯å°±ç´æ¥æäºï¼è¿æ ·ä¸å°±ä¿çäºä¸æ¡æ°æ®ï¼ä»èä¿è¯äºæ°æ®çæ­£ç¡®æ§ã\n\nä¸æ¡æ°æ®éå¤åºç°ä¸¤æ¬¡ï¼æ°æ®åºéå°±åªæä¸æ¡æ°æ®ï¼è¿å°±ä¿è¯äºç³»ç»çå¹ç­æ§ã\n\nå¹ç­æ§ï¼éä¿ç¹è¯´ï¼å°±ä¸ä¸ªæ°æ®ï¼æèä¸ä¸ªè¯·æ±ï¼ç»ä½ éå¤æ¥å¤æ¬¡ï¼ä½ å¾ç¡®ä¿å¯¹åºçæ°æ®æ¯ä¸ä¼æ¹åçï¼ä¸è½åºéã\n\næä»¥ç¬¬äºä¸ªé®é¢æ¥äºï¼æä¹ä¿è¯æ¶æ¯éåæ¶è´¹çå¹ç­æ§ï¼\n\nå¶å®è¿æ¯å¾ç»åä¸å¡æ¥æèï¼æè¿éç»å ä¸ªæè·¯ï¼\n\n * æ¯å¦ä½ æ¿ä¸ªæ°æ®è¦ååºï¼ä½ åæ ¹æ®ä¸»é®æ¥ä¸ä¸ï¼å¦æè¿æ°æ®é½æäºï¼ä½ å°±å«æå¥äºï¼update ä¸ä¸å¥½å§ã\n * æ¯å¦ä½ æ¯å Redisï¼é£æ²¡é®é¢äºï¼åæ­£æ¯æ¬¡é½æ¯ setï¼å¤©ç¶å¹ç­æ§ã\n * æ¯å¦ä½ ä¸æ¯ä¸é¢ä¸¤ä¸ªåºæ¯ï¼é£åçç¨å¾®å¤æä¸ç¹ï¼ä½ éè¦è®©çäº§èåéæ¯æ¡æ°æ®çæ¶åï¼éé¢å ä¸ä¸ªå¨å±å¯ä¸ç idï¼ç±»ä¼¼è®¢å id ä¹ç±»çä¸è¥¿ï¼ç¶åä½ è¿éæ¶è´¹å°äºä¹åï¼åæ ¹æ®è¿ä¸ª id å»æ¯å¦ Redis éæ¥ä¸ä¸ï¼ä¹åæ¶è´¹è¿åï¼å¦ææ²¡ææ¶è´¹è¿ï¼ä½ å°±å¤çï¼ç¶åè¿ä¸ª id å Redisãå¦ææ¶è´¹è¿äºï¼é£ä½ å°±å«å¤çäºï¼ä¿è¯å«éå¤å¤çç¸åçæ¶æ¯å³å¯ã\n * æ¯å¦åºäºæ°æ®åºçå¯ä¸é®æ¥ä¿è¯éå¤æ°æ®ä¸ä¼éå¤æå¥å¤æ¡ãå ä¸ºæå¯ä¸é®çº¦æäºï¼éå¤æ°æ®æå¥åªä¼æ¥éï¼ä¸ä¼å¯¼è´æ°æ®åºä¸­åºç°èæ°æ®ã\n\n\n\nå½ç¶ï¼å¦ä½ä¿è¯ MQ çæ¶è´¹æ¯å¹ç­æ§çï¼éè¦ç»åå·ä½çä¸å¡æ¥çã\n\n\n# å¦ä½ä¿è¯æ¶æ¯çå¯é æ§ä¼ è¾ï¼ï¼å¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ï¼\n\næ°æ®çä¸¢å¤±é®é¢ï¼å¯è½åºç°å¨çäº§èãMQãæ¶è´¹èä¸­ï¼å±ä»¬ä» RabbitMQ å Kafka åå«æ¥åæä¸ä¸å§ã\n\n\n# RabbitMQ\n\n\n\n# çäº§èå¼ä¸¢äºæ°æ®\n\nçäº§èå°æ°æ®åéå° RabbitMQ çæ¶åï¼å¯è½æ°æ®å°±å¨åè·¯ç»æä¸¢äºï¼å ä¸ºç½ç»é®é¢å¥çï¼é½æå¯è½ã\n\næ­¤æ¶å¯ä»¥éæ©ç¨ RabbitMQ æä¾çäºå¡åè½ï¼å°±æ¯çäº§èåéæ°æ®ä¹åå¼å¯ RabbitMQ äºå¡channel.txSelectï¼ç¶ååéæ¶æ¯ï¼å¦ææ¶æ¯æ²¡ææåè¢« RabbitMQ æ¥æ¶å°ï¼é£ä¹çäº§èä¼æ¶å°å¼å¸¸æ¥éï¼æ­¤æ¶å°±å¯ä»¥åæ»äºå¡channel.txRollbackï¼ç¶åéè¯åéæ¶æ¯ï¼å¦ææ¶å°äºæ¶æ¯ï¼é£ä¹å¯ä»¥æäº¤äºå¡channel.txCommitã\n\n// å¼å¯äºå¡\nchannel.txSelect\ntry {\n    // è¿éåéæ¶æ¯\n} catch (Exception e) {\n    channel.txRollback\n\n    // è¿éåæ¬¡éåè¿æ¡æ¶æ¯\n}\n\n// æäº¤äºå¡\nchannel.txCommit\n\n\nä½æ¯é®é¢æ¯ï¼RabbitMQ äºå¡æºå¶ï¼åæ­¥ï¼ä¸æï¼åºæ¬ä¸ååéä¼ä¸æ¥ï¼å ä¸ºå¤ªèæ§è½ã\n\næä»¥ä¸è¬æ¥è¯´ï¼å¦æä½ è¦ç¡®ä¿è¯´å RabbitMQ çæ¶æ¯å«ä¸¢ï¼å¯ä»¥å¼å¯ confirm æ¨¡å¼ï¼å¨çäº§èé£éè®¾ç½®å¼å¯ confirmæ¨¡å¼ä¹åï¼ä½ æ¯æ¬¡åçæ¶æ¯é½ä¼åéä¸ä¸ªå¯ä¸ç idï¼ç¶åå¦æåå¥äº RabbitMQ ä¸­ï¼RabbitMQ ä¼ç»ä½ åä¼ ä¸ä¸ª ack æ¶æ¯ï¼åè¯ä½ è¯´è¿ä¸ªæ¶æ¯ ok äºãå¦æ RabbitMQ æ²¡è½å¤çè¿ä¸ªæ¶æ¯ï¼ä¼åè°ä½ çä¸ä¸ª nack æ¥å£ï¼åè¯ä½ è¿ä¸ªæ¶æ¯æ¥æ¶å¤±è´¥ï¼ä½ å¯ä»¥éè¯ãèä¸ä½ å¯ä»¥ç»åè¿ä¸ªæºå¶èªå·±å¨åå­éç»´æ¤æ¯ä¸ªæ¶æ¯ id çç¶æï¼å¦æè¶è¿ä¸å®æ¶é´è¿æ²¡æ¥æ¶å°è¿ä¸ªæ¶æ¯çåè°ï¼é£ä¹ä½ å¯ä»¥éåã\n\näºå¡æºå¶å confirm æºå¶æå¤§çä¸åå¨äºï¼äºå¡æºå¶æ¯åæ­¥çï¼ä½ æäº¤ä¸ä¸ªäºå¡ä¹åä¼é»å¡å¨é£å¿ï¼ä½æ¯ confirm æºå¶æ¯å¼æ­¥çï¼ä½ åéä¸ªæ¶æ¯ä¹åå°±å¯ä»¥åéä¸ä¸ä¸ªæ¶æ¯ï¼ç¶åé£ä¸ªæ¶æ¯ RabbitMQ æ¥æ¶äºä¹åä¼å¼æ­¥åè°ä½ çä¸ä¸ªæ¥å£éç¥ä½ è¿ä¸ªæ¶æ¯æ¥æ¶å°äºã\n\næä»¥ä¸è¬å¨çäº§èè¿åé¿åæ°æ®ä¸¢å¤±ï¼é½æ¯ç¨ confirm æºå¶çã\n\n# RabbitMQ å¼ä¸¢äºæ°æ®\n\nå°±æ¯ RabbitMQ èªå·±å¼ä¸¢äºæ°æ®ï¼è¿ä¸ªä½ å¿é¡»å¼å¯ RabbitMQ çæä¹åï¼å°±æ¯æ¶æ¯åå¥ä¹åä¼æä¹åå°ç£çï¼åªææ¯ RabbitMQ èªå·±æäºï¼æ¢å¤ä¹åä¼èªå¨è¯»åä¹åå­å¨çæ°æ®ï¼ä¸è¬æ°æ®ä¸ä¼ä¸¢ãé¤éæå¶ç½è§çæ¯ï¼RabbitMQ è¿æ²¡æä¹åï¼èªå·±å°±æäºï¼å¯è½å¯¼è´å°éæ°æ®ä¸¢å¤±ï¼ä½æ¯è¿ä¸ªæ¦çè¾å°ã\n\nè®¾ç½®æä¹åæä¸¤ä¸ªæ­¥éª¤ï¼\n\n * åå»º queue çæ¶åå°å¶è®¾ç½®ä¸ºæä¹å è¿æ ·å°±å¯ä»¥ä¿è¯ RabbitMQ æä¹å queue çåæ°æ®ï¼ä½æ¯å®æ¯ä¸ä¼æä¹å queue éçæ°æ®çã\n * ç¬¬äºä¸ªæ¯åéæ¶æ¯çæ¶åå°æ¶æ¯ç deliveryMode è®¾ç½®ä¸º 2 å°±æ¯å°æ¶æ¯è®¾ç½®ä¸ºæä¹åçï¼æ­¤æ¶ RabbitMQ å°±ä¼å°æ¶æ¯æä¹åå°ç£çä¸å»ã\n\nå¿é¡»è¦åæ¶è®¾ç½®è¿ä¸¤ä¸ªæä¹åæè¡ï¼RabbitMQ åªææ¯æäºï¼åæ¬¡éå¯ï¼ä¹ä¼ä»ç£çä¸éå¯æ¢å¤ queueï¼æ¢å¤è¿ä¸ª queue éçæ°æ®ã\n\næ³¨æï¼åªææ¯ä½ ç» RabbitMQ å¼å¯äºæä¹åæºå¶ï¼ä¹æä¸ç§å¯è½ï¼å°±æ¯è¿ä¸ªæ¶æ¯åå°äº RabbitMQ ä¸­ï¼ä½æ¯è¿æ²¡æ¥å¾åæä¹åå°ç£çä¸ï¼ç»æä¸å·§ï¼æ­¤æ¶ RabbitMQ æäºï¼å°±ä¼å¯¼è´åå­éçä¸ç¹ç¹æ°æ®ä¸¢å¤±ã\n\næä»¥ï¼æä¹åå¯ä»¥è·çäº§èé£è¾¹ç confirm æºå¶éåèµ·æ¥ï¼åªææ¶æ¯è¢«æä¹åå°ç£çä¹åï¼æä¼éç¥çäº§è ack äºï¼æä»¥åªææ¯å¨æä¹åå°ç£çä¹åï¼RabbitMQ æäºï¼æ°æ®ä¸¢äºï¼çäº§èæ¶ä¸å° ackï¼ä½ ä¹æ¯å¯ä»¥èªå·±éåçã\n\n# æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®\n\nRabbitMQ å¦æä¸¢å¤±äºæ°æ®ï¼ä¸»è¦æ¯å ä¸ºä½ æ¶è´¹çæ¶åï¼åæ¶è´¹å°ï¼è¿æ²¡å¤çï¼ç»æè¿ç¨æäºï¼æ¯å¦éå¯äºï¼é£ä¹å°±å°´å°¬äºï¼RabbitMQ è®¤ä¸ºä½ é½æ¶è´¹äºï¼è¿æ°æ®å°±ä¸¢äºã\n\nè¿ä¸ªæ¶åå¾ç¨ RabbitMQ æä¾ç ack æºå¶ï¼ç®åæ¥è¯´ï¼å°±æ¯ä½ å¿é¡»å³é­ RabbitMQ çèªå¨ ackï¼å¯ä»¥éè¿ä¸ä¸ª api æ¥è°ç¨å°±è¡ï¼ç¶åæ¯æ¬¡ä½ èªå·±ä»£ç éç¡®ä¿å¤çå®çæ¶åï¼åå¨ç¨åºé ack ä¸æãè¿æ ·çè¯ï¼å¦æä½ è¿æ²¡å¤çå®ï¼ä¸å°±æ²¡æ ack äºï¼é£ RabbitMQ å°±è®¤ä¸ºä½ è¿æ²¡å¤çå®ï¼è¿ä¸ªæ¶å RabbitMQ ä¼æè¿ä¸ªæ¶è´¹åéç»å«ç consumer å»å¤çï¼æ¶æ¯æ¯ä¸ä¼ä¸¢çã\n\n\n\n\n# Kafka\n\n# æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®\n\nå¯ä¸å¯è½å¯¼è´æ¶è´¹èå¼ä¸¢æ°æ®çæåµï¼å°±æ¯è¯´ï¼ä½ æ¶è´¹å°äºè¿ä¸ªæ¶æ¯ï¼ç¶åæ¶è´¹èé£è¾¹èªå¨æäº¤äº offsetï¼è®© Kafka ä»¥ä¸ºä½ å·²ç»æ¶è´¹å¥½äºè¿ä¸ªæ¶æ¯ï¼ä½å¶å®ä½ æååå¤å¤çè¿ä¸ªæ¶æ¯ï¼ä½ è¿æ²¡å¤çï¼ä½ èªå·±å°±æäºï¼æ­¤æ¶è¿æ¡æ¶æ¯å°±ä¸¢å¯ã\n\nè¿ä¸æ¯è· RabbitMQ å·®ä¸å¤åï¼å¤§å®¶é½ç¥é Kafka ä¼èªå¨æäº¤ offsetï¼é£ä¹åªè¦å³é­èªå¨æäº¤ offsetï¼å¨å¤çå®ä¹åèªå·±æå¨æäº¤ offsetï¼å°±å¯ä»¥ä¿è¯æ°æ®ä¸ä¼ä¸¢ãä½æ¯æ­¤æ¶ç¡®å®è¿æ¯å¯è½ä¼æéå¤æ¶è´¹ï¼æ¯å¦ä½ åå¤çå®ï¼è¿æ²¡æäº¤ offsetï¼ç»æèªå·±æäºï¼æ­¤æ¶è¯å®ä¼éå¤æ¶è´¹ä¸æ¬¡ï¼èªå·±ä¿è¯å¹ç­æ§å°±å¥½äºã\n\nçäº§ç¯å¢ç¢°å°çä¸ä¸ªé®é¢ï¼å°±æ¯è¯´æä»¬ç Kafka æ¶è´¹èæ¶è´¹å°äºæ°æ®ä¹åæ¯åå°ä¸ä¸ªåå­ç queue éåç¼å²ä¸ä¸ï¼ç»ææçæ¶åï¼ä½ åææ¶æ¯åå¥åå­ queueï¼ç¶åæ¶è´¹èä¼èªå¨æäº¤ offsetãç¶åæ­¤æ¶æä»¬éå¯äºç³»ç»ï¼å°±ä¼å¯¼è´åå­ queue éè¿æ²¡æ¥å¾åå¤ççæ°æ®å°±ä¸¢å¤±äºã\n\n# Kafka å¼ä¸¢äºæ°æ®\n\nè¿åæ¯è¾å¸¸è§çä¸ä¸ªåºæ¯ï¼å°±æ¯ Kafka æä¸ª broker å®æºï¼ç¶åéæ°éä¸¾ partition ç leaderãå¤§å®¶æ³æ³ï¼è¦æ¯æ­¤æ¶å¶ä»ç follower åå¥½è¿æäºæ°æ®æ²¡æåæ­¥ï¼ç»ææ­¤æ¶ leader æäºï¼ç¶åéä¸¾æä¸ª follower æ leader ä¹åï¼ä¸å°±å°äºä¸äºæ°æ®ï¼è¿å°±ä¸¢äºä¸äºæ°æ®åã\n\nçäº§ç¯å¢ä¹éå°è¿ï¼æä»¬ä¹æ¯ï¼ä¹å Kafka ç leader æºå¨å®æºäºï¼å° follower åæ¢ä¸º leader ä¹åï¼å°±ä¼åç°è¯´è¿ä¸ªæ°æ®å°±ä¸¢äºã\n\næä»¥æ­¤æ¶ä¸è¬æ¯è¦æ±èµ·ç è®¾ç½®å¦ä¸ 4 ä¸ªåæ°ï¼\n\n * ç» topic è®¾ç½® replication.factor åæ°ï¼è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¦æ±æ¯ä¸ª partition å¿é¡»æè³å° 2 ä¸ªå¯æ¬ã\n * å¨ Kafka æå¡ç«¯è®¾ç½® min.insync.replicas åæ°ï¼è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¿ä¸ªæ¯è¦æ±ä¸ä¸ª leader è³å°æç¥å°æè³å°ä¸ä¸ª follower è¿è·èªå·±ä¿æèç³»ï¼æ²¡æéï¼è¿æ ·æè½ç¡®ä¿ leader æäºè¿æä¸ä¸ª follower å§ã\n * å¨ producer ç«¯è®¾ç½® acks=allï¼è¿ä¸ªæ¯è¦æ±æ¯æ¡æ°æ®ï¼å¿é¡»æ¯åå¥ææ replica ä¹åï¼æè½è®¤ä¸ºæ¯åæåäºã\n * å¨ producer ç«¯è®¾ç½® retries=MAXï¼å¾å¤§å¾å¤§å¾å¤§çä¸ä¸ªå¼ï¼æ éæ¬¡éè¯çææï¼ï¼è¿ä¸ªæ¯è¦æ±ä¸æ¦åå¥å¤±è´¥ï¼å°±æ ééè¯ï¼å¡å¨è¿éäºã\n\næä»¬çäº§ç¯å¢å°±æ¯æç§ä¸è¿°è¦æ±éç½®çï¼è¿æ ·éç½®ä¹åï¼è³å°å¨ Kafka broker ç«¯å°±å¯ä»¥ä¿è¯å¨ leader æå¨ broker åçæéï¼è¿è¡ leader åæ¢æ¶ï¼æ°æ®ä¸ä¼ä¸¢å¤±ã\n\n# çäº§èä¼ä¸ä¼å¼ä¸¢æ°æ®ï¼\n\nå¦ææç§ä¸è¿°çæè·¯è®¾ç½®äº acks=allï¼ä¸å®ä¸ä¼ä¸¢ï¼è¦æ±æ¯ï¼ä½ ç leader æ¥æ¶å°æ¶æ¯ï¼ææç follower é½åæ­¥å°äºæ¶æ¯ä¹åï¼æè®¤ä¸ºæ¬æ¬¡åæåäºãå¦ææ²¡æ»¡è¶³è¿ä¸ªæ¡ä»¶ï¼çäº§èä¼èªå¨ä¸æ­çéè¯ï¼éè¯æ éæ¬¡ã\n\n\n# å¦ä½ä¿è¯æ¶æ¯çé¡ºåºæ§ï¼\n\næä¸¾ä¸ªä¾å­ï¼æä»¬ä»¥ååè¿ä¸ä¸ª mysql binlog åæ­¥çç³»ç»ï¼ååè¿æ¯éå¸¸å¤§çï¼æ¥åæ­¥æ°æ®è¦è¾¾å°ä¸äº¿ï¼å°±æ¯è¯´æ°æ®ä»ä¸ä¸ª mysql åºåå°ä¸å¨å°åæ­¥å°å¦ä¸ä¸ª mysql åºéé¢å»ï¼mysql -> mysqlï¼ãå¸¸è§çä¸ç¹å¨äºè¯´æ¯å¦å¤§æ°æ® teamï¼å°±éè¦åæ­¥ä¸ä¸ª mysql åºè¿æ¥ï¼å¯¹å¬å¸çä¸å¡ç³»ç»çæ°æ®ååç§å¤æçæä½ã\n\nä½ å¨ mysql éå¢å æ¹ä¸æ¡æ°æ®ï¼å¯¹åºåºæ¥äºå¢å æ¹ 3 æ¡ binlog æ¥å¿ï¼æ¥çè¿ä¸æ¡ binlog åéå° MQ éé¢ï¼åæ¶è´¹åºæ¥ä¾æ¬¡æ§è¡ï¼èµ·ç å¾ä¿è¯äººå®¶æ¯æç§é¡ºåºæ¥çå§ï¼ä¸ç¶æ¬æ¥æ¯ï¼å¢å ãä¿®æ¹ãå é¤ï¼ä½ æ¥æ¯æ¢äºé¡ºåºç»æ§è¡æå é¤ãä¿®æ¹ãå¢å ï¼ä¸å¨éäºä¹ã\n\næ¬æ¥è¿ä¸ªæ°æ®åæ­¥è¿æ¥ï¼åºè¯¥æåè¿ä¸ªæ°æ®è¢«å é¤äºï¼ç»æä½ æéäºè¿ä¸ªé¡ºåºï¼æåè¿ä¸ªæ°æ®ä¿çä¸æ¥äºï¼æ°æ®åæ­¥å°±åºéäºã\n\nåççé¡ºåºä¼éä¹±çä¿©åºæ¯ï¼\n\n * RabbitMQï¼ä¸ä¸ª queueï¼å¤ä¸ª consumerãæ¯å¦ï¼çäº§èå RabbitMQ éåéäºä¸æ¡æ°æ®ï¼é¡ºåºä¾æ¬¡æ¯ data1/data2/data3ï¼åå¥çæ¯ RabbitMQ çä¸ä¸ªåå­éåãæä¸ä¸ªæ¶è´¹èåå«ä» MQ ä¸­æ¶è´¹è¿ä¸æ¡æ°æ®ä¸­çä¸æ¡ï¼ç»ææ¶è´¹è 2 åæ§è¡å®æä½ï¼æ data2 å­å¥æ°æ®åºï¼ç¶åæ¯ data1/data3ãè¿ä¸ææ¾ä¹±äºã\n\n\n\n * Kafkaï¼æ¯å¦è¯´æä»¬å»ºäºä¸ä¸ª topicï¼æä¸ä¸ª partitionãçäº§èå¨åçæ¶åï¼å¶å®å¯ä»¥æå®ä¸ä¸ª keyï¼æ¯å¦è¯´æä»¬æå®äºæä¸ªè®¢å id ä½ä¸º keyï¼é£ä¹è¿ä¸ªè®¢åç¸å³çæ°æ®ï¼ä¸å®ä¼è¢«ååå°åä¸ä¸ª partition ä¸­å»ï¼èä¸è¿ä¸ª partition ä¸­çæ°æ®ä¸å®æ¯æé¡ºåºçã æ¶è´¹èä» partition ä¸­ååºæ¥æ°æ®çæ¶åï¼ä¹ä¸å®æ¯æé¡ºåºçãå°è¿éï¼é¡ºåºè¿æ¯ ok çï¼æ²¡æéä¹±ãæ¥çï¼æä»¬å¨æ¶è´¹èéå¯è½ä¼æå¤ä¸ªçº¿ç¨æ¥å¹¶åå¤çæ¶æ¯ãå ä¸ºå¦ææ¶è´¹èæ¯åçº¿ç¨æ¶è´¹å¤çï¼èå¤çæ¯è¾èæ¶çè¯ï¼æ¯å¦å¤çä¸æ¡æ¶æ¯èæ¶å å msï¼é£ä¹ 1 ç§éåªè½å¤çå åæ¡æ¶æ¯ï¼è¿ååéå¤ªä½äºãèå¤ä¸ªçº¿ç¨å¹¶åè·çè¯ï¼é¡ºåºå¯è½å°±ä¹±æäºã\n\n\n\n\n# è§£å³æ¹æ¡\n\n# RabbitMQ\n\n\n\n# Kafka\n\n * ä¸ä¸ª topicï¼ä¸ä¸ª partitionï¼ä¸ä¸ª consumerï¼åé¨åçº¿ç¨æ¶è´¹ï¼åçº¿ç¨ååéå¤ªä½ï¼ä¸è¬ä¸ä¼ç¨è¿ä¸ªã\n * å N ä¸ªåå­ queueï¼å·æç¸å key çæ°æ®é½å°åä¸ä¸ªåå­ queueï¼ç¶åå¯¹äº N ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨åå«æ¶è´¹ä¸ä¸ªåå­ queue å³å¯ï¼è¿æ ·å°±è½ä¿è¯é¡ºåºæ§ã\n\n\n\n\n# å¦ä½è§£å³æ¶æ¯éåçå»¶æ¶ä»¥åè¿æå¤±æé®é¢ï¼æ¶æ¯éåæ»¡äºä»¥åè¯¥æä¹å¤çï¼æå ç¾ä¸æ¶æ¯æç»­ç§¯åå å°æ¶ï¼è¯´è¯´æä¹è§£å³ï¼\n\nä½ çè¿é®æ³ï¼å¶å®æ¬è´¨éå¯¹çåºæ¯ï¼é½æ¯è¯´ï¼å¯è½ä½ çæ¶è´¹ç«¯åºäºé®é¢ï¼ä¸æ¶è´¹äºï¼æèæ¶è´¹çéåº¦æå¶æ¢ãæ¥çå°±åç¹äºï¼å¯è½ä½ çæ¶æ¯éåéç¾¤çç£çé½å¿«åæ»¡äºï¼é½æ²¡äººæ¶è´¹ï¼è¿ä¸ªæ¶åæä¹åï¼æèæ¯è¿æ´ä¸ªå°±ç§¯åäºå ä¸ªå°æ¶ï¼ä½ è¿ä¸ªæ¶åæä¹åï¼æèæ¯ä½ ç§¯åçæ¶é´å¤ªé¿äºï¼å¯¼è´æ¯å¦ RabbitMQ è®¾ç½®äºæ¶æ¯è¿ææ¶é´åå°±æ²¡äºæä¹åï¼\n\næä»¥å°±è¿äºå¿ï¼å¶å®çº¿ä¸æºå¸¸è§çï¼ä¸è¬ä¸åºï¼ä¸åºå°±æ¯å¤§ caseãä¸è¬å¸¸è§äºï¼ä¸¾ä¸ªä¾å­ï¼æ¶è´¹ç«¯æ¯æ¬¡æ¶è´¹ä¹åè¦å mysqlï¼ç»æ mysql æäºï¼æ¶è´¹ç«¯ hang é£å¿äºï¼ä¸å¨äºï¼æèæ¯æ¶è´¹ç«¯åºäºä¸ªä»ä¹å²å­ï¼å¯¼è´æ¶è´¹éåº¦æå¶æ¢ã\n\n\n# é¢è¯é¢åæ\n\nå³äºè¿ä¸ªäºå¿ï¼æä»¬ä¸ä¸ªä¸ä¸ªæ¥æ¢³çå§ï¼ååè®¾ä¸ä¸ªåºæ¯ï¼æä»¬ç°å¨æ¶è´¹ç«¯åºæéäºï¼ç¶åå¤§éæ¶æ¯å¨ mq éç§¯åï¼ç°å¨åºäºæäºï¼æäºã\n\n\n# å¤§éæ¶æ¯å¨ mq éç§¯åäºå ä¸ªå°æ¶äºè¿æ²¡è§£å³\n\nå åä¸æ¡æ°æ®å¨ MQ éç§¯åäºä¸å«ä¸ªå°æ¶ï¼ä»ä¸å 4 ç¹å¤ï¼ç§¯åå°äºæä¸ 11 ç¹å¤ãè¿ä¸ªæ¯æä»¬çå®éå°è¿çä¸ä¸ªåºæ¯ï¼ç¡®å®æ¯çº¿ä¸æéäºï¼è¿ä¸ªæ¶åè¦ä¸ç¶å°±æ¯ä¿®å¤ consumer çé®é¢ï¼è®©å®æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå»å»çç­å¾å ä¸ªå°æ¶æ¶è´¹å®æ¯ãè¿ä¸ªè¯å®ä¸è½å¨é¢è¯çæ¶åè¯´å§ã\n\nä¸ä¸ªæ¶è´¹èä¸ç§æ¯ 1000 æ¡ï¼ä¸ç§ 3 ä¸ªæ¶è´¹èæ¯ 3000 æ¡ï¼ä¸åéå°±æ¯ 18 ä¸æ¡ãæä»¥å¦æä½ ç§¯åäºå ç¾ä¸å°ä¸åä¸çæ°æ®ï¼å³ä½¿æ¶è´¹èæ¢å¤äºï¼ä¹éè¦å¤§æ¦ 1 å°æ¶çæ¶é´æè½æ¢å¤è¿æ¥ã\n\nä¸è¬è¿ä¸ªæ¶åï¼åªè½ä¸´æ¶ç´§æ¥æ©å®¹äºï¼å·ä½æä½æ­¥éª¤åæè·¯å¦ä¸ï¼\n\n * åä¿®å¤ consumer çé®é¢ï¼ç¡®ä¿å¶æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå°ç°æ consumer é½åæã\n * æ°å»ºä¸ä¸ª topicï¼partition æ¯åæ¥ç 10 åï¼ä¸´æ¶å»ºç«å¥½åå 10 åç queue æ°éã\n * ç¶ååä¸ä¸ªä¸´æ¶çååæ°æ®ç consumer ç¨åºï¼è¿ä¸ªç¨åºé¨ç½²ä¸å»æ¶è´¹ç§¯åçæ°æ®ï¼æ¶è´¹ä¹åä¸åèæ¶çå¤çï¼ç´æ¥ååè½®è¯¢åå¥ä¸´æ¶å»ºç«å¥½ç 10 åæ°éç queueã\n * æ¥çä¸´æ¶å¾ç¨ 10 åçæºå¨æ¥é¨ç½² consumerï¼æ¯ä¸æ¹ consumer æ¶è´¹ä¸ä¸ªä¸´æ¶ queue çæ°æ®ãè¿ç§åæ³ç¸å½äºæ¯ä¸´æ¶å° queue èµæºå consumer èµæºæ©å¤§ 10 åï¼ä»¥æ­£å¸¸ç 10 åéåº¦æ¥æ¶è´¹æ°æ®ã\n * ç­å¿«éæ¶è´¹å®ç§¯åæ°æ®ä¹åï¼å¾æ¢å¤ååé¨ç½²çæ¶æï¼éæ°ç¨ååç consumer æºå¨æ¥æ¶è´¹æ¶æ¯ã\n\n\n# mq ä¸­çæ¶æ¯è¿æå¤±æäº\n\nåè®¾ä½ ç¨çæ¯ RabbitMQï¼RabbtiMQ æ¯å¯ä»¥è®¾ç½®è¿ææ¶é´çï¼ä¹å°±æ¯ TTLãå¦ææ¶æ¯å¨ queue ä¸­ç§¯åè¶è¿ä¸å®çæ¶é´å°±ä¼è¢« RabbitMQ ç»æ¸çæï¼è¿ä¸ªæ°æ®å°±æ²¡äºãé£è¿å°±æ¯ç¬¬äºä¸ªåäºãè¿å°±ä¸æ¯è¯´æ°æ®ä¼å¤§éç§¯åå¨ mq éï¼èæ¯å¤§éçæ°æ®ä¼ç´æ¥æä¸¢ã\n\nè¿ä¸ªæåµä¸ï¼å°±ä¸æ¯è¯´è¦å¢å  consumer æ¶è´¹ç§¯åçæ¶æ¯ï¼å ä¸ºå®éä¸æ²¡å¥ç§¯åï¼èæ¯ä¸¢äºå¤§éçæ¶æ¯ãæä»¬å¯ä»¥éåä¸ä¸ªæ¹æ¡ï¼å°±æ¯æ¹ééå¯¼ï¼è¿ä¸ªæä»¬ä¹åçº¿ä¸ä¹æç±»ä¼¼çåºæ¯å¹²è¿ãå°±æ¯å¤§éç§¯åçæ¶åï¼æä»¬å½æ¶å°±ç´æ¥ä¸¢å¼æ°æ®äºï¼ç¶åç­è¿äºé«å³°æä»¥åï¼æ¯å¦å¤§å®¶ä¸èµ·ååå¡ç¬å¤å°æä¸ 12 ç¹ä»¥åï¼ç¨æ·é½ç¡è§äºãè¿ä¸ªæ¶åæä»¬å°±å¼å§åç¨åºï¼å°ä¸¢å¤±çé£æ¹æ°æ®ï¼åä¸ªä¸´æ¶ç¨åºï¼ä¸ç¹ä¸ç¹çæ¥åºæ¥ï¼ç¶åéæ°çå¥ mq éé¢å»ï¼æç½å¤©ä¸¢çæ°æ®ç»ä»è¡¥åæ¥ãä¹åªè½æ¯è¿æ ·äºã\n\nåè®¾ 1 ä¸ä¸ªè®¢åç§¯åå¨ mq éé¢ï¼æ²¡æå¤çï¼å¶ä¸­ 1000 ä¸ªè®¢åé½ä¸¢äºï¼ä½ åªè½æå¨åç¨åºæé£ 1000 ä¸ªè®¢åç»æ¥åºæ¥ï¼æå¨åå° mq éå»åè¡¥ä¸æ¬¡ã\n\n\n# mq é½å¿«åæ»¡äº\n\nå¦ææ¶æ¯ç§¯åå¨ mq éï¼ä½ å¾é¿æ¶é´é½æ²¡æå¤çæï¼æ­¤æ¶å¯¼è´ mq é½å¿«åæ»¡äºï¼ååï¼è¿ä¸ªè¿æå«çåæ³åï¼æ²¡æï¼è°è®©ä½ ç¬¬ä¸ä¸ªæ¹æ¡æ§è¡çå¤ªæ¢äºï¼ä½ ä¸´æ¶åç¨åºï¼æ¥å¥æ°æ®æ¥æ¶è´¹ï¼æ¶è´¹ä¸ä¸ªä¸¢å¼ä¸ä¸ªï¼é½ä¸è¦äºï¼å¿«éæ¶è´¹æææçæ¶æ¯ãç¶åèµ°ç¬¬äºä¸ªæ¹æ¡ï¼å°äºæä¸åè¡¥æ°æ®å§ã\n\n\n# å¦æè®©ä½ åä¸ä¸ªæ¶æ¯éåï¼è¯¥å¦ä½è¿è¡æ¶æè®¾è®¡åï¼è¯´ä¸ä¸ä½ çæè·¯ã\n\n\n# é¢è¯å®å¿çåæ\n\nå¶å®èå°è¿ä¸ªé®é¢ï¼ä¸è¬é¢è¯å®è¦èå¯ä¸¤åï¼\n\n * ä½ ææ²¡æå¯¹æä¸ä¸ªæ¶æ¯éååè¿è¾ä¸ºæ·±å¥çåççäºè§£ï¼æèä»æ´ä½äºè§£ææ¡ä½ä¸ä¸ªæ¶æ¯éåçæ¶æåçã\n * ççä½ çè®¾è®¡è½åï¼ç»ä½ ä¸ä¸ªå¸¸è§çç³»ç»ï¼å°±æ¯æ¶æ¯éåç³»ç»ï¼ççä½ è½ä¸è½ä»å¨å±ææ¡ä¸ä¸æ´ä½æ¶æè®¾è®¡ï¼ç»åºä¸äºå³é®ç¹åºæ¥ã\n\nè¯´å®è¯ï¼é®ç±»ä¼¼é®é¢çæ¶åï¼å¤§é¨åäººåºæ¬é½ä¼èï¼å ä¸ºå¹³æ¶ä»æ¥æ²¡ææèè¿ç±»ä¼¼çé®é¢ï¼å¤§å¤æ°äººå°±æ¯å¹³æ¶åå¤´ç¨ï¼ä»æ¥ä¸å»æèèåçä¸äºä¸è¥¿ãç±»ä¼¼çé®é¢ï¼æ¯å¦ï¼å¦æè®©ä½ æ¥è®¾è®¡ä¸ä¸ª Spring æ¡æ¶ä½ ä¼æä¹åï¼å¦æè®©ä½ æ¥è®¾è®¡ä¸ä¸ª Dubbo æ¡æ¶ä½ ä¼æä¹åï¼å¦æè®©ä½ æ¥è®¾è®¡ä¸ä¸ª MyBatis æ¡æ¶ä½ ä¼æä¹åï¼\n\n\n# é¢è¯é¢åæ\n\nå¶å®åç­è¿ç±»é®é¢ï¼è¯´ç½äºï¼ä¸æ±ä½ çè¿é£ææ¯çæºç ï¼èµ·ç ä½ è¦å¤§æ¦ç¥éé£ä¸ªææ¯çåºæ¬åçãæ ¸å¿ç»æé¨åãåºæ¬æ¶æææï¼ç¶ååç§ä¸äºå¼æºçææ¯æä¸ä¸ªç³»ç»è®¾è®¡åºæ¥çæè·¯è¯´ä¸ä¸å°±å¥½ã\n\næ¯å¦è¯´è¿ä¸ªæ¶æ¯éåç³»ç»ï¼æä»¬ä»ä»¥ä¸å ä¸ªè§åº¦æ¥èèä¸ä¸ï¼\n\n * é¦åè¿ä¸ª mq å¾æ¯æå¯ä¼¸ç¼©æ§å§ï¼å°±æ¯éè¦çæ¶åå¿«éæ©å®¹ï¼å°±å¯ä»¥å¢å ååéåå®¹éï¼é£æä¹æï¼è®¾è®¡ä¸ªåå¸å¼çç³»ç»åï¼åç§ä¸ä¸ kafka çè®¾è®¡çå¿µï¼broker -> topic -> partitionï¼æ¯ä¸ª partition æ¾ä¸ä¸ªæºå¨ï¼å°±å­ä¸é¨åæ°æ®ãå¦æç°å¨èµæºä¸å¤äºï¼ç®ååï¼ç» topic å¢å  partitionï¼ç¶ååæ°æ®è¿ç§»ï¼å¢å æºå¨ï¼ä¸å°±å¯ä»¥å­æ¾æ´å¤æ°æ®ï¼æä¾æ´é«çååéäºï¼\n * å¶æ¬¡ä½ å¾èèä¸ä¸è¿ä¸ª mq çæ°æ®è¦ä¸è¦è½å°ç£çå§ï¼é£è¯å®è¦äºï¼è½ç£çæè½ä¿è¯å«è¿ç¨æäºæ°æ®å°±ä¸¢äºãé£è½ç£ççæ¶åæä¹è½åï¼é¡ºåºåï¼è¿æ ·å°±æ²¡æç£çéæºè¯»åçå¯»åå¼éï¼ç£çé¡ºåºè¯»åçæ§è½æ¯å¾é«çï¼è¿å°±æ¯ kafka çæè·¯ã\n * å¶æ¬¡ä½ èèä¸ä¸ä½ ç mq çå¯ç¨æ§åï¼è¿ä¸ªäºå¿ï¼å·ä½åèä¹åå¯ç¨æ§é£ä¸ªç¯èè®²è§£ç kafka çé«å¯ç¨ä¿éæºå¶ãå¤å¯æ¬ -> leader & follower -> broker æäºéæ°éä¸¾ leader å³å¯å¯¹å¤æå¡ã\n * è½ä¸è½æ¯ææ°æ® 0 ä¸¢å¤±åï¼å¯ä»¥çï¼åèæä»¬ä¹åè¯´çé£ä¸ª kafka æ°æ®é¶ä¸¢å¤±æ¹æ¡ã\n\nmq è¯å®æ¯å¾å¤æçï¼é¢è¯å®é®ä½ è¿ä¸ªé®é¢ï¼å¶å®æ¯ä¸ªå¼æ¾é¢ï¼ä»å°±æ¯ççä½ ææ²¡æä»æ¶æè§åº¦æ´ä½ææåè®¾è®¡çæç»´ä»¥åè½åãç¡®å®è¿ä¸ªé®é¢å¯ä»¥å·æä¸å¤§æ¹äººï¼å ä¸ºå¤§é¨åäººå¹³æ¶ä¸æèè¿äºä¸è¥¿ã",normalizedContent:"# æ¶æ¯éåé¢è¯å¤ºå½è¿ç¯é®\n\n\n# ä¸ºä»ä¹ä½¿ç¨æ¶æ¯éåï¼\n\n\n# è§£è¦\n\nçè¿ä¹ä¸ªåºæ¯ãa ç³»ç»åéæ°æ®å° bcd ä¸ä¸ªç³»ç»ï¼éè¿æ¥å£è°ç¨åéãå¦æ e ç³»ç»ä¹è¦è¿ä¸ªæ°æ®å¢ï¼é£å¦æ c ç³»ç»ç°å¨ä¸éè¦äºå¢ï¼a ç³»ç»è´è´£äººå ä¹å´©æº......\n\n\n\nå¨è¿ä¸ªåºæ¯ä¸­ï¼a ç³»ç»è·å¶å®åç§ä¹±ä¸å«ç³çç³»ç»ä¸¥éè¦åï¼a ç³»ç»äº§çä¸æ¡æ¯è¾å³é®çæ°æ®ï¼å¾å¤ç³»ç»é½éè¦ a ç³»ç»å°è¿ä¸ªæ°æ®åéè¿æ¥ãa ç³»ç»è¦æ¶æ¶å»å»èè bcde åä¸ªç³»ç»å¦ææäºè¯¥ååï¼è¦ä¸è¦éåï¼è¦ä¸è¦ææ¶æ¯å­èµ·æ¥ï¼å¤´åé½ç½äºåï¼\n\nå¦æä½¿ç¨ mqï¼a ç³»ç»äº§çä¸æ¡æ°æ®ï¼åéå° mq éé¢å»ï¼åªä¸ªç³»ç»éè¦æ°æ®èªå·±å» mq éé¢æ¶è´¹ãå¦ææ°ç³»ç»éè¦æ°æ®ï¼ç´æ¥ä» mq éæ¶è´¹å³å¯ï¼å¦ææä¸ªç³»ç»ä¸éè¦è¿æ¡æ°æ®äºï¼å°±åæ¶å¯¹ mq æ¶æ¯çæ¶è´¹å³å¯ãè¿æ ·ä¸æ¥ï¼a ç³»ç»åæ ¹å¿ä¸éè¦å»èèè¦ç»è°åéæ°æ®ï¼ä¸éè¦ç»´æ¤è¿ä¸ªä»£ç ï¼ä¹ä¸éè¦èèäººå®¶æ¯å¦è°ç¨æåãå¤±è´¥è¶æ¶ç­æåµã\n\n\n\næ»ç»ï¼éè¿ä¸ä¸ª mqï¼pub/sub åå¸è®¢éæ¶æ¯è¿ä¹ä¸ä¸ªæ¨¡åï¼a ç³»ç»å°±è·å¶å®ç³»ç»å½»åºè§£è¦äºã\n\né¢è¯æå·§ï¼ä½ éè¦å»èèä¸ä¸ä½ è´è´£çç³»ç»ä¸­æ¯å¦æç±»ä¼¼çåºæ¯ï¼å°±æ¯ä¸ä¸ªç³»ç»æèä¸ä¸ªæ¨¡åï¼è°ç¨äºå¤ä¸ªç³»ç»æèæ¨¡åï¼äºç¸ä¹é´çè°ç¨å¾å¤æï¼ç»´æ¤èµ·æ¥å¾éº»ç¦ãä½æ¯å¶å®è¿ä¸ªè°ç¨æ¯ä¸éè¦ç´æ¥åæ­¥è°ç¨æ¥å£çï¼å¦æç¨ mq ç»å®å¼æ­¥åè§£è¦ï¼ä¹æ¯å¯ä»¥çï¼ä½ å°±éè¦å»èèå¨ä½ çé¡¹ç®éï¼æ¯ä¸æ¯å¯ä»¥è¿ç¨è¿ä¸ª mq å»è¿è¡ç³»ç»çè§£è¦ãå¨ç®åä¸­ä½ç°åºæ¥è¿åä¸è¥¿ï¼ç¨ mq ä½è§£è¦ã\n\n\n# å¼æ­¥\n\nåæ¥çä¸ä¸ªåºæ¯ï¼a ç³»ç»æ¥æ¶ä¸ä¸ªè¯·æ±ï¼éè¦å¨èªå·±æ¬å°ååºï¼è¿éè¦å¨ bcd ä¸ä¸ªç³»ç»ååºï¼èªå·±æ¬å°ååºè¦ 3msï¼bcd ä¸ä¸ªç³»ç»åå«ååºè¦ 300msã450msã200msãæç»è¯·æ±æ»å»¶æ¶æ¯ 3 + 300 + 450 + 200 = 953msï¼æ¥è¿ 1sï¼ç¨æ·æè§æä¸ªä»ä¹ä¸è¥¿ï¼æ¢æ­»äºæ¢æ­»äºãç¨æ·éè¿æµè§å¨åèµ·è¯·æ±ï¼ç­å¾ä¸ª 1sï¼è¿å ä¹æ¯ä¸å¯æ¥åçã\n\n\n\nä¸è¬äºèç½ç±»çä¼ä¸ï¼å¯¹äºç¨æ·ç´æ¥çæä½ï¼ä¸è¬è¦æ±æ¯æ¯ä¸ªè¯·æ±é½å¿é¡»å¨ 200 ms ä»¥åå®æï¼å¯¹ç¨æ·å ä¹æ¯æ æç¥çã\n\nå¦æä½¿ç¨ mqï¼é£ä¹ a ç³»ç»è¿ç»­åé 3 æ¡æ¶æ¯å° mq éåä¸­ï¼åå¦èæ¶ 5msï¼a ç³»ç»ä»æ¥åä¸ä¸ªè¯·æ±å°è¿åååºç»ç¨æ·ï¼æ»æ¶é¿æ¯ 3 + 5 = 8msï¼å¯¹äºç¨æ·èè¨ï¼å¶å®æè§ä¸å°±æ¯ç¹ä¸ªæé®ï¼8ms ä»¥åå°±ç´æ¥è¿åäºï¼ç½ï¼ç½ç«åå¾çå¥½ï¼çå¿«ï¼\n\n\n\n\n# åå³°\n\næ¯å¤© 0:00 å° 12:00ï¼a ç³»ç»é£å¹³æµªéï¼æ¯ç§å¹¶åè¯·æ±æ°éå°± 50 ä¸ªãç»ææ¯æ¬¡ä¸å° 12:00 ~ 13:00 ï¼æ¯ç§å¹¶åè¯·æ±æ°éçªç¶ä¼æ´å¢å° 5k+ æ¡ãä½æ¯ç³»ç»æ¯ç´æ¥åºäº mysql çï¼å¤§éçè¯·æ±æ¶å¥ mysqlï¼æ¯ç§éå¯¹ mysql æ§è¡çº¦ 5k æ¡ sqlã\n\nä¸è¬ç mysqlï¼æå°æ¯ç§ 2k ä¸ªè¯·æ±å°±å·®ä¸å¤äºï¼å¦ææ¯ç§è¯·æ±å° 5k çè¯ï¼å¯è½å°±ç´æ¥æ mysql ç»ææ­»äºï¼å¯¼è´ç³»ç»å´©æºï¼ç¨æ·ä¹å°±æ²¡æ³åä½¿ç¨ç³»ç»äºã\n\nä½æ¯é«å³°æä¸è¿ï¼å°äºä¸åçæ¶åï¼å°±æäºä½å³°æï¼å¯è½ä¹å°± 1w çç¨æ·åæ¶å¨ç½ç«ä¸æä½ï¼æ¯ç§ä¸­çè¯·æ±æ°éå¯è½ä¹å°± 50 ä¸ªè¯·æ±ï¼å¯¹æ´ä¸ªç³»ç»å ä¹æ²¡æä»»ä½çååã\n\n\n\nå¦æä½¿ç¨ mqï¼æ¯ç§ 5k ä¸ªè¯·æ±åå¥ mqï¼a ç³»ç»æ¯ç§éæå¤å¤ç 2k ä¸ªè¯·æ±ï¼å ä¸º mysql æ¯ç§éæå¤å¤ç 2k ä¸ªãa ç³»ç»ä» mq ä¸­æ¢æ¢æåè¯·æ±ï¼æ¯ç§éå°±æå 2k ä¸ªè¯·æ±ï¼ä¸è¦è¶è¿èªå·±æ¯ç§è½å¤ççæå¤§è¯·æ±æ°éå°± okï¼è¿æ ·ä¸æ¥ï¼åªææ¯é«å³°æçæ¶åï¼a ç³»ç»ä¹ç»å¯¹ä¸ä¼ææãè mq æ¯ç§é 5k ä¸ªè¯·æ±è¿æ¥ï¼å°± 2k ä¸ªè¯·æ±åºå»ï¼ç»æå°±å¯¼è´å¨ä¸­åé«å³°æï¼1 ä¸ªå°æ¶ï¼ï¼å¯è½æå åä¸çè³å ç¾ä¸çè¯·æ±ç§¯åå¨ mq ä¸­ã\n\n\n\nè¿ä¸ªç­æçé«å³°æç§¯åæ¯ ok çï¼å ä¸ºé«å³°æè¿äºä¹åï¼æ¯ç§éå°± 50 ä¸ªè¯·æ±è¿ mqï¼ä½æ¯ a ç³»ç»ä¾ç¶ä¼æç§æ¯ç§ 2k ä¸ªè¯·æ±çéåº¦å¨å¤çãæä»¥è¯´ï¼åªè¦é«å³°æä¸è¿ï¼a ç³»ç»å°±ä¼å¿«éå°ç§¯åçæ¶æ¯ç»è§£å³æã\n\n\n# æ¶æ¯éåæä»ä¹ä¼ç¼ºç¹\n\nä¼ç¹ä¸é¢å·²ç»è¯´äºï¼å°±æ¯å¨ç¹æ®åºæ¯ä¸æå¶å¯¹åºçå¥½å¤ï¼è§£è¦ãå¼æ­¥ãåå³°ã\n\nç¼ºç¹æä»¥ä¸å ä¸ªï¼\n\n * ç³»ç»å¯ç¨æ§éä½ ç³»ç»å¼å¥çå¤é¨ä¾èµè¶å¤ï¼è¶å®¹æææãæ¬æ¥ä½ å°±æ¯ a ç³»ç»è°ç¨ bcd ä¸ä¸ªç³»ç»çæ¥å£å°±å¥½äºï¼äºº abcd åä¸ªç³»ç»å¥½å¥½çï¼æ²¡å¥é®é¢ï¼ä½ åå ä¸ª mq è¿æ¥ï¼ä¸ä¸ mq æäºåæ´ï¼mq ä¸æï¼æ´å¥ç³»ç»å´©æºçï¼ä½ ä¸å°±å®äºï¼å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼å¯ä»¥ç¹å»è¿éæ¥çã\n * ç³»ç»å¤æåº¦æé« ç¡¬ççå ä¸ª mq è¿æ¥ï¼ä½ æä¹ä¿è¯æ¶æ¯æ²¡æéå¤æ¶è´¹ï¼æä¹å¤çæ¶æ¯ä¸¢å¤±çæåµï¼æä¹ä¿è¯æ¶æ¯ä¼ éçé¡ºåºæ§ï¼å¤´å¤§å¤´å¤§ï¼é®é¢ä¸å¤§å ï¼çè¦ä¸å·²ã\n * ä¸è´æ§é®é¢ a ç³»ç»å¤çå®äºç´æ¥è¿åæåäºï¼äººé½ä»¥ä¸ºä½ è¿ä¸ªè¯·æ±å°±æåäºï¼ä½æ¯é®é¢æ¯ï¼è¦æ¯ bcd ä¸ä¸ªç³»ç»é£éï¼bd ä¸¤ä¸ªç³»ç»ååºæåäºï¼ç»æ c ç³»ç»ååºå¤±è´¥äºï¼åæ´ï¼ä½ è¿æ°æ®å°±ä¸ä¸è´äºã\n\næä»¥æ¶æ¯éåå®éæ¯ä¸ç§éå¸¸å¤æçæ¶æï¼ä½ å¼å¥å®æå¾å¤å¥½å¤ï¼ä½æ¯ä¹å¾éå¯¹å®å¸¦æ¥çåå¤ååç§é¢å¤çææ¯æ¹æ¡åæ¶ææ¥è§é¿æï¼åå¥½ä¹åï¼ä½ ä¼åç°ï¼å¦åï¼ç³»ç»å¤æåº¦æåäºä¸ä¸ªæ°éçº§ï¼ä¹è®¸æ¯å¤æäº 10 åãä½æ¯å³é®æ¶å»ï¼ç¨ï¼è¿æ¯å¾ç¨çã\n\n\n# kafkaãactivemqãrabbitmqãrocketmq æä»ä¹ä¼ç¼ºç¹ï¼\n\nç¹æ§                activemq                     rabbitmq                        rocketmq                                      kafka\nåæºååé             ä¸çº§ï¼æ¯ rocketmqãkafka ä½ä¸ä¸ªæ°éçº§   å activemq                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡å®æ¶æ°æ®è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ rocketmq   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ rabbitmq çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å activemq                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å rocketmq\nåè½æ¯æ              mq é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   mq åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç mq åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸è¬çä¸å¡ç³»ç»è¦å¼å¥ mqï¼ææ©å¤§å®¶é½ç¨ activemqï¼ä½æ¯ç°å¨ç¡®å®å¤§å®¶ç¨çä¸å¤äºï¼æ²¡ç»è¿å¤§è§æ¨¡ååéåºæ¯çéªè¯ï¼ç¤¾åºä¹ä¸æ¯å¾æ´»è·ï¼æä»¥å¤§å®¶è¿æ¯ç®äºå§ï¼æä¸ªäººä¸æ¨èç¨è¿ä¸ªäºï¼\n * åæ¥å¤§å®¶å¼å§ç¨ rabbitmqï¼ä½æ¯ç¡®å® erlang è¯­è¨é»æ­¢äºå¤§éç java å·¥ç¨å¸å»æ·±å¥ç ç©¶åææ§å®ï¼å¯¹å¬å¸èè¨ï¼å ä¹å¤äºä¸å¯æ§çç¶æï¼ä½æ¯ç¡®å®äººå®¶æ¯å¼æºçï¼æ¯è¾ç¨³å®çæ¯æï¼æ´»è·åº¦ä¹é«ï¼\n * ä¸è¿ç°å¨ç¡®å®è¶æ¥è¶å¤çå¬å¸ä¼å»ç¨ rocketmqï¼ç¡®å®å¾ä¸éï¼æ¯ç«æ¯é¿éåºåï¼ä½ç¤¾åºå¯è½æçªç¶é»æçé£é©ï¼ç®å rocketmq å·²æç» apacheï¼ä½ github ä¸çæ´»è·åº¦å¶å®ä¸ç®é«ï¼å¯¹èªå·±å¬å¸ææ¯å®åæç»å¯¹èªä¿¡çï¼æ¨èç¨ rocketmqï¼å¦ååå»èèå®å®ç¨ rabbitmq å§ï¼äººå®¶ææ´»è·çå¼æºç¤¾åºï¼ç»å¯¹ä¸ä¼é»ã\n * æä»¥ä¸­å°åå¬å¸ï¼ææ¯å®åè¾ä¸ºä¸è¬ï¼ææ¯ææä¸æ¯ç¹å«é«ï¼ç¨ rabbitmq æ¯ä¸éçéæ©ï¼å¤§åå¬å¸ï¼åºç¡æ¶æç åå®åè¾å¼ºï¼ç¨ rocketmq æ¯å¾å¥½çéæ©ã\n * å¦ææ¯å¤§æ°æ®é¢åçå®æ¶è®¡ç®ãæ¥å¿ééç­åºæ¯ï¼ç¨ kafka æ¯ä¸åæ åçï¼ç»å¯¹æ²¡é®é¢ï¼ç¤¾åºæ´»è·åº¦å¾é«ï¼ç»å¯¹ä¸ä¼é»ï¼ä½åµå ä¹æ¯å¨ä¸çè¿ä¸ªé¢åçäºå®æ§è§èã\n\n\n# å¦ä½ä¿è¯æ¶æ¯éåçé«å¯ç¨ï¼\n\n\n# rabbitmq çé«å¯ç¨æ§\n\nrabbitmq æ¯æ¯è¾æä»£è¡¨æ§çï¼å ä¸ºæ¯åºäºä¸»ä»ï¼éåå¸å¼ï¼åé«å¯ç¨æ§çï¼æä»¬å°±ä»¥ rabbitmq ä¸ºä¾å­è®²è§£ç¬¬ä¸ç§ mq çé«å¯ç¨æ§æä¹å®ç°ã\n\nrabbitmq æä¸ç§æ¨¡å¼ï¼åæºæ¨¡å¼ãæ®ééç¾¤æ¨¡å¼ãéåéç¾¤æ¨¡å¼ã\n\n# åæºæ¨¡å¼\n\nåæºæ¨¡å¼ï¼å°±æ¯ demo çº§å«çï¼ä¸è¬å°±æ¯ä½ æ¬å°å¯å¨äºç©ç©å¿ç ðï¼æ²¡äººçäº§ç¨åæºæ¨¡å¼ã\n\n# æ®ééç¾¤æ¨¡å¼ï¼æ é«å¯ç¨æ§ï¼\n\næ®ééç¾¤æ¨¡å¼ï¼ææå°±æ¯å¨å¤å°æºå¨ä¸å¯å¨å¤ä¸ª rabbitmq å®ä¾ï¼æ¯ä¸ªæºå¨å¯å¨ä¸ä¸ªãä½ åå»ºç queueï¼åªä¼æ¾å¨ä¸ä¸ª rabbitmq å®ä¾ä¸ï¼ä½æ¯æ¯ä¸ªå®ä¾é½åæ­¥ queue çåæ°æ®ï¼åæ°æ®å¯ä»¥è®¤ä¸ºæ¯ queue çä¸äºéç½®ä¿¡æ¯ï¼éè¿åæ°æ®ï¼å¯ä»¥æ¾å° queue æå¨å®ä¾ï¼ãä½ æ¶è´¹çæ¶åï¼å®éä¸å¦æè¿æ¥å°äºå¦å¤ä¸ä¸ªå®ä¾ï¼é£ä¹é£ä¸ªå®ä¾ä¼ä» queue æå¨å®ä¾ä¸æåæ°æ®è¿æ¥ã\n\n\n\nè¿ç§æ¹å¼ç¡®å®å¾éº»ç¦ï¼ä¹ä¸æä¹å¥½ï¼æ²¡åå°æè°çåå¸å¼ï¼å°±æ¯ä¸ªæ®ééç¾¤ãå ä¸ºè¿å¯¼è´ä½ è¦ä¹æ¶è´¹èæ¯æ¬¡éæºè¿æ¥ä¸ä¸ªå®ä¾ç¶åæåæ°æ®ï¼è¦ä¹åºå®è¿æ¥é£ä¸ª queue æå¨å®ä¾æ¶è´¹æ°æ®ï¼åèææ°æ®æåçå¼éï¼åèå¯¼è´åå®ä¾æ§è½ç¶é¢ã\n\nèä¸å¦æé£ä¸ªæ¾ queue çå®ä¾å®æºäºï¼ä¼å¯¼è´æ¥ä¸æ¥å¶ä»å®ä¾å°±æ æ³ä»é£ä¸ªå®ä¾æåï¼å¦æä½ å¼å¯äºæ¶æ¯æä¹åï¼è®© rabbitmq è½å°å­å¨æ¶æ¯çè¯ï¼æ¶æ¯ä¸ä¸å®ä¼ä¸¢ï¼å¾ç­è¿ä¸ªå®ä¾æ¢å¤äºï¼ç¶åæå¯ä»¥ç»§ç»­ä»è¿ä¸ª queue æåæ°æ®ã\n\næä»¥è¿ä¸ªäºå¿å°±æ¯è¾å°´å°¬äºï¼è¿å°±æ²¡æä»ä¹æè°çé«å¯ç¨æ§ï¼è¿æ¹æ¡ä¸»è¦æ¯æé«ååéçï¼å°±æ¯è¯´è®©éç¾¤ä¸­å¤ä¸ªèç¹æ¥æå¡æä¸ª queue çè¯»åæä½ã\n\n# éåéç¾¤æ¨¡å¼ï¼é«å¯ç¨æ§ï¼\n\nè¿ç§æ¨¡å¼ï¼ææ¯æè°ç rabbitmq çé«å¯ç¨æ¨¡å¼ãè·æ®ééç¾¤æ¨¡å¼ä¸ä¸æ ·çæ¯ï¼å¨éåéç¾¤æ¨¡å¼ä¸ï¼ä½ åå»ºç queueï¼æ è®ºåæ°æ®è¿æ¯ queue éçæ¶æ¯é½ä¼å­å¨äºå¤ä¸ªå®ä¾ä¸ï¼å°±æ¯è¯´ï¼æ¯ä¸ª rabbitmq èç¹é½æè¿ä¸ª queue çä¸ä¸ªå®æ´éåï¼åå« queue çå¨é¨æ°æ®çææãç¶åæ¯æ¬¡ä½ åæ¶æ¯å° queue çæ¶åï¼é½ä¼èªå¨ææ¶æ¯åæ­¥å°å¤ä¸ªå®ä¾ç queue ä¸ã\n\n\n\né£ä¹å¦ä½å¼å¯è¿ä¸ªéåéç¾¤æ¨¡å¼å¢ï¼å¶å®å¾ç®åï¼rabbitmq æå¾å¥½çç®¡çæ§å¶å°ï¼å°±æ¯å¨åå°æ°å¢ä¸ä¸ªç­ç¥ï¼è¿ä¸ªç­ç¥æ¯éåéç¾¤æ¨¡å¼çç­ç¥ï¼æå®çæ¶åæ¯å¯ä»¥è¦æ±æ°æ®åæ­¥å°ææèç¹çï¼ä¹å¯ä»¥è¦æ±åæ­¥å°æå®æ°éçèç¹ï¼åæ¬¡åå»º queue çæ¶åï¼åºç¨è¿ä¸ªç­ç¥ï¼å°±ä¼èªå¨å°æ°æ®åæ­¥å°å¶ä»çèç¹ä¸å»äºã\n\nè¿æ ·çè¯ï¼å¥½å¤å¨äºï¼ä½ ä»»ä½ä¸ä¸ªæºå¨å®æºäºï¼æ²¡äºå¿ï¼å¶å®æºå¨ï¼èç¹ï¼è¿åå«äºè¿ä¸ª queue çå®æ´æ°æ®ï¼å«ç consumer é½å¯ä»¥å°å¶å®èç¹ä¸å»æ¶è´¹æ°æ®ãåå¤å¨äºï¼ç¬¬ä¸ï¼è¿ä¸ªæ§è½å¼éä¹å¤ªå¤§äºå§ï¼æ¶æ¯éè¦åæ­¥å°æææºå¨ä¸ï¼å¯¼è´ç½ç»å¸¦å®½åååæ¶èå¾éï¼ç¬¬äºï¼è¿ä¹ç©å¿ï¼ä¸æ¯åå¸å¼çï¼å°±æ²¡ææ©å±æ§å¯è¨äºï¼å¦ææä¸ª queue è´è½½å¾éï¼ä½ å æºå¨ï¼æ°å¢çæºå¨ä¹åå«äºè¿ä¸ª queue çæææ°æ®ï¼å¹¶æ²¡æåæ³çº¿æ§æ©å±ä½ ç queueãä½ æ³ï¼å¦æè¿ä¸ª queue çæ°æ®éå¾å¤§ï¼å¤§å°è¿ä¸ªæºå¨ä¸çå®¹éæ æ³å®¹çº³äºï¼æ­¤æ¶è¯¥æä¹åå¢ï¼\n\n\n# kafka çé«å¯ç¨æ§\n\nkafka ä¸ä¸ªæåºæ¬çæ¶æè®¤è¯ï¼ç±å¤ä¸ª broker ç»æï¼æ¯ä¸ª broker æ¯ä¸ä¸ªèç¹ï¼ä½ åå»ºä¸ä¸ª topicï¼è¿ä¸ª topic å¯ä»¥ååä¸ºå¤ä¸ª partitionï¼æ¯ä¸ª partition å¯ä»¥å­å¨äºä¸åç broker ä¸ï¼æ¯ä¸ª partition å°±æ¾ä¸é¨åæ°æ®ã\n\nè¿å°±æ¯å¤©ç¶çåå¸å¼æ¶æ¯éåï¼å°±æ¯è¯´ä¸ä¸ª topic çæ°æ®ï¼æ¯åæ£æ¾å¨å¤ä¸ªæºå¨ä¸çï¼æ¯ä¸ªæºå¨å°±æ¾ä¸é¨åæ°æ®ã\n\nå®éä¸ rabbmitmq ä¹ç±»çï¼å¹¶ä¸æ¯åå¸å¼æ¶æ¯éåï¼å®å°±æ¯ä¼ ç»çæ¶æ¯éåï¼åªä¸è¿æä¾äºä¸äºéç¾¤ãha(high availability, é«å¯ç¨æ§) çæºå¶èå·²ï¼å ä¸ºæ è®ºæä¹ç©å¿ï¼rabbitmq ä¸ä¸ª queue çæ°æ®é½æ¯æ¾å¨ä¸ä¸ªèç¹éçï¼éåéç¾¤ä¸ï¼ä¹æ¯æ¯ä¸ªèç¹é½æ¾è¿ä¸ª queue çå®æ´æ°æ®ã\n\nkafka 0.8 ä»¥åï¼æ¯æ²¡æ ha æºå¶çï¼å°±æ¯ä»»ä½ä¸ä¸ª broker å®æºäºï¼é£ä¸ª broker ä¸ç partition å°±åºäºï¼æ²¡æ³åä¹æ²¡æ³è¯»ï¼æ²¡æä»ä¹é«å¯ç¨æ§å¯è¨ã\n\næ¯å¦è¯´ï¼æä»¬åè®¾åå»ºäºä¸ä¸ª topicï¼æå®å¶ partition æ°éæ¯ 3 ä¸ªï¼åå«å¨ä¸å°æºå¨ä¸ãä½æ¯ï¼å¦æç¬¬äºå°æºå¨å®æºäºï¼ä¼å¯¼è´è¿ä¸ª topic ç 1/3 çæ°æ®å°±ä¸¢äºï¼å æ­¤è¿ä¸ªæ¯åä¸å°é«å¯ç¨çã\n\n\n\nkafka 0.8 ä»¥åï¼æä¾äº ha æºå¶ï¼å°±æ¯ replicaï¼å¤å¶åï¼ å¯æ¬æºå¶ãæ¯ä¸ª partition çæ°æ®é½ä¼åæ­¥å°å¶å®æºå¨ä¸ï¼å½¢æèªå·±çå¤ä¸ª replica å¯æ¬ãææ replica ä¼éä¸¾ä¸ä¸ª leader åºæ¥ï¼é£ä¹çäº§åæ¶è´¹é½è·è¿ä¸ª leader æäº¤éï¼ç¶åå¶ä» replica å°±æ¯ followerãåçæ¶åï¼leader ä¼è´è´£ææ°æ®åæ­¥å°ææ follower ä¸å»ï¼è¯»çæ¶åå°±ç´æ¥è¯» leader ä¸çæ°æ®å³å¯ãåªè½è¯»å leaderï¼å¾ç®åï¼è¦æ¯ä½ å¯ä»¥éæè¯»åæ¯ä¸ª followerï¼é£ä¹å°±è¦ care æ°æ®ä¸è´æ§çé®é¢ï¼ç³»ç»å¤æåº¦å¤ªé«ï¼å¾å®¹æåºé®é¢ãkafka ä¼ååå°å°ä¸ä¸ª partition çææ replica åå¸å¨ä¸åçæºå¨ä¸ï¼è¿æ ·æå¯ä»¥æé«å®¹éæ§ã\n\n\n\nè¿ä¹æï¼å°±ææè°çé«å¯ç¨æ§äºï¼å ä¸ºå¦ææä¸ª broker å®æºäºï¼æ²¡äºå¿ï¼é£ä¸ª broker ä¸é¢ç partition å¨å¶ä»æºå¨ä¸é½æå¯æ¬çãå¦æè¿ä¸ªå®æºç broker ä¸é¢ææä¸ª partition ç leaderï¼é£ä¹æ­¤æ¶ä¼ä» follower ä¸­éæ°éä¸¾ä¸ä¸ªæ°ç leader åºæ¥ï¼å¤§å®¶ç»§ç»­è¯»åé£ä¸ªæ°ç leader å³å¯ãè¿å°±ææè°çé«å¯ç¨æ§äºã\n\nåæ°æ®çæ¶åï¼çäº§èå°±å leaderï¼ç¶å leader å°æ°æ®è½å°åæ¬å°ç£çï¼æ¥çå¶ä» follower èªå·±ä¸»å¨ä» leader æ¥ pull æ°æ®ãä¸æ¦ææ follower åæ­¥å¥½æ°æ®äºï¼å°±ä¼åé ack ç» leaderï¼leader æ¶å°ææ follower ç ack ä¹åï¼å°±ä¼è¿ååæåçæ¶æ¯ç»çäº§èãï¼å½ç¶ï¼è¿åªæ¯å¶ä¸­ä¸ç§æ¨¡å¼ï¼è¿å¯ä»¥éå½è°æ´è¿ä¸ªè¡ä¸ºï¼\n\næ¶è´¹çæ¶åï¼åªä¼ä» leader å»è¯»ï¼ä½æ¯åªæå½ä¸ä¸ªæ¶æ¯å·²ç»è¢«ææ follower é½åæ­¥æåè¿å ack çæ¶åï¼è¿ä¸ªæ¶æ¯æä¼è¢«æ¶è´¹èè¯»å°ã\n\nçå°è¿éï¼ç¸ä¿¡ä½ å¤§è´æç½äº kafka æ¯å¦ä½ä¿è¯é«å¯ç¨æºå¶çäºï¼å¯¹å§ï¼ä¸è³äºä¸æ æç¥ï¼ç°åºè¿è½ç»é¢è¯å®ç»ç»å¾ãè¦æ¯éä¸é¢è¯å®ç¡®å®æ¯ kafka é«æï¼æ·±æäºé®ï¼é£ä½ åªè½è¯´ä¸å¥½ææï¼å¤ªæ·±å¥çä½ æ²¡ç ç©¶è¿ã\n\n\n# å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ï¼ï¼å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ï¼\n\né¦åï¼æ¯å¦ rabbitmqãrocketmqãkafkaï¼é½æå¯è½ä¼åºç°æ¶æ¯éå¤æ¶è´¹çé®é¢ï¼æ­£å¸¸ãå ä¸ºè¿é®é¢éå¸¸ä¸æ¯ mq èªå·±ä¿è¯çï¼æ¯ç±æä»¬å¼åæ¥ä¿è¯çãæä¸ä¸ª kafka æ¥ä¸¾ä¸ªä¾å­ï¼è¯´è¯´æä¹éå¤æ¶è´¹å§ã\n\nkafka å®éä¸æä¸ª offset çæ¦å¿µï¼å°±æ¯æ¯ä¸ªæ¶æ¯åè¿å»ï¼é½æä¸ä¸ª offsetï¼ä»£è¡¨æ¶æ¯çåºå·ï¼ç¶å consumer æ¶è´¹äºæ°æ®ä¹åï¼æ¯éä¸æ®µæ¶é´ï¼å®æ¶å®æï¼ï¼ä¼æèªå·±æ¶è´¹è¿çæ¶æ¯ç offset æäº¤ä¸ä¸ï¼è¡¨ç¤ºâæå·²ç»æ¶è´¹è¿äºï¼ä¸æ¬¡æè¦æ¯éå¯å¥çï¼ä½ å°±è®©æç»§ç»­ä»ä¸æ¬¡æ¶è´¹å°ç offset æ¥ç»§ç»­æ¶è´¹å§âã\n\nä½æ¯å¡äºæ»ææå¤ï¼æ¯å¦æä»¬ä¹åçäº§ç»å¸¸éå°çï¼å°±æ¯ä½ ææ¶åéå¯ç³»ç»ï¼çä½ æä¹éå¯äºï¼å¦æç¢°å°ç¹çæ¥çï¼ç´æ¥ kill è¿ç¨äºï¼åéå¯ãè¿ä¼å¯¼è´ consumer æäºæ¶æ¯å¤çäºï¼ä½æ¯æ²¡æ¥å¾åæäº¤ offsetï¼å°´å°¬äºãéå¯ä¹åï¼å°æ°æ¶æ¯ä¼åæ¬¡æ¶è´¹ä¸æ¬¡ã\n\nä¸¾ä¸ªæ å­ã\n\næè¿ä¹ä¸ªåºæ¯ãæ°æ® 1/2/3 ä¾æ¬¡è¿å¥ kafkaï¼kafka ä¼ç»è¿ä¸æ¡æ°æ®æ¯æ¡åéä¸ä¸ª offsetï¼ä»£è¡¨è¿æ¡æ°æ®çåºå·ï¼æä»¬å°±åè®¾åéç offset ä¾æ¬¡æ¯ 152/153/154ãæ¶è´¹èä» kafka å»æ¶è´¹çæ¶åï¼ä¹æ¯æç§è¿ä¸ªé¡ºåºå»æ¶è´¹ãåå¦å½æ¶è´¹èæ¶è´¹äº offset=153 çè¿æ¡æ°æ®ï¼ååå¤å»æäº¤ offset å° zookeeperï¼æ­¤æ¶æ¶è´¹èè¿ç¨è¢«éå¯äºãé£ä¹æ­¤æ¶æ¶è´¹è¿çæ°æ® 1/2 ç offset å¹¶æ²¡ææäº¤ï¼kafka ä¹å°±ä¸ç¥éä½ å·²ç»æ¶è´¹äº offset=153 è¿æ¡æ°æ®ãé£ä¹éå¯ä¹åï¼æ¶è´¹èä¼æ¾ kafka è¯´ï¼å¿ï¼å¥å¿ä»¬ï¼ä½ ç»ææ¥çæä¸æ¬¡ææ¶è´¹å°çé£ä¸ªå°æ¹åé¢çæ°æ®ç»§ç»­ç»æä¼ éè¿æ¥ãç±äºä¹åç offset æ²¡ææäº¤æåï¼é£ä¹æ°æ® 1/2 ä¼åæ¬¡ä¼ è¿æ¥ï¼å¦ææ­¤æ¶æ¶è´¹èæ²¡æå»éçè¯ï¼é£ä¹å°±ä¼å¯¼è´éå¤æ¶è´¹ã\n\n\n\nå¦ææ¶è´¹èå¹²çäºå¿æ¯æ¿ä¸æ¡æ°æ®å°±å¾æ°æ®åºéåä¸æ¡ï¼ä¼å¯¼è´è¯´ï¼ä½ å¯è½å°±ææ°æ® 1/2 å¨æ°æ®åºéæå¥äº 2 æ¬¡ï¼é£ä¹æ°æ®å°±éå¦ã\n\nå¶å®éå¤æ¶è´¹ä¸å¯æï¼å¯æçæ¯ä½ æ²¡èèå°éå¤æ¶è´¹ä¹åï¼æä¹ä¿è¯å¹ç­æ§ã\n\nä¸¾ä¸ªä¾å­å§ãåè®¾ä½ æä¸ªç³»ç»ï¼æ¶è´¹ä¸æ¡æ¶æ¯å°±å¾æ°æ®åºéæå¥ä¸æ¡æ°æ®ï¼è¦æ¯ä½ ä¸ä¸ªæ¶æ¯éå¤ä¸¤æ¬¡ï¼ä½ ä¸å°±æå¥äºä¸¤æ¡ï¼è¿æ°æ®ä¸å°±éäºï¼ä½æ¯ä½ è¦æ¯æ¶è´¹å°ç¬¬äºæ¬¡çæ¶åï¼èªå·±å¤æ­ä¸ä¸æ¯å¦å·²ç»æ¶è´¹è¿äºï¼è¥æ¯å°±ç´æ¥æäºï¼è¿æ ·ä¸å°±ä¿çäºä¸æ¡æ°æ®ï¼ä»èä¿è¯äºæ°æ®çæ­£ç¡®æ§ã\n\nä¸æ¡æ°æ®éå¤åºç°ä¸¤æ¬¡ï¼æ°æ®åºéå°±åªæä¸æ¡æ°æ®ï¼è¿å°±ä¿è¯äºç³»ç»çå¹ç­æ§ã\n\nå¹ç­æ§ï¼éä¿ç¹è¯´ï¼å°±ä¸ä¸ªæ°æ®ï¼æèä¸ä¸ªè¯·æ±ï¼ç»ä½ éå¤æ¥å¤æ¬¡ï¼ä½ å¾ç¡®ä¿å¯¹åºçæ°æ®æ¯ä¸ä¼æ¹åçï¼ä¸è½åºéã\n\næä»¥ç¬¬äºä¸ªé®é¢æ¥äºï¼æä¹ä¿è¯æ¶æ¯éåæ¶è´¹çå¹ç­æ§ï¼\n\nå¶å®è¿æ¯å¾ç»åä¸å¡æ¥æèï¼æè¿éç»å ä¸ªæè·¯ï¼\n\n * æ¯å¦ä½ æ¿ä¸ªæ°æ®è¦ååºï¼ä½ åæ ¹æ®ä¸»é®æ¥ä¸ä¸ï¼å¦æè¿æ°æ®é½æäºï¼ä½ å°±å«æå¥äºï¼update ä¸ä¸å¥½å§ã\n * æ¯å¦ä½ æ¯å redisï¼é£æ²¡é®é¢äºï¼åæ­£æ¯æ¬¡é½æ¯ setï¼å¤©ç¶å¹ç­æ§ã\n * æ¯å¦ä½ ä¸æ¯ä¸é¢ä¸¤ä¸ªåºæ¯ï¼é£åçç¨å¾®å¤æä¸ç¹ï¼ä½ éè¦è®©çäº§èåéæ¯æ¡æ°æ®çæ¶åï¼éé¢å ä¸ä¸ªå¨å±å¯ä¸ç idï¼ç±»ä¼¼è®¢å id ä¹ç±»çä¸è¥¿ï¼ç¶åä½ è¿éæ¶è´¹å°äºä¹åï¼åæ ¹æ®è¿ä¸ª id å»æ¯å¦ redis éæ¥ä¸ä¸ï¼ä¹åæ¶è´¹è¿åï¼å¦ææ²¡ææ¶è´¹è¿ï¼ä½ å°±å¤çï¼ç¶åè¿ä¸ª id å redisãå¦ææ¶è´¹è¿äºï¼é£ä½ å°±å«å¤çäºï¼ä¿è¯å«éå¤å¤çç¸åçæ¶æ¯å³å¯ã\n * æ¯å¦åºäºæ°æ®åºçå¯ä¸é®æ¥ä¿è¯éå¤æ°æ®ä¸ä¼éå¤æå¥å¤æ¡ãå ä¸ºæå¯ä¸é®çº¦æäºï¼éå¤æ°æ®æå¥åªä¼æ¥éï¼ä¸ä¼å¯¼è´æ°æ®åºä¸­åºç°èæ°æ®ã\n\n\n\nå½ç¶ï¼å¦ä½ä¿è¯ mq çæ¶è´¹æ¯å¹ç­æ§çï¼éè¦ç»åå·ä½çä¸å¡æ¥çã\n\n\n# å¦ä½ä¿è¯æ¶æ¯çå¯é æ§ä¼ è¾ï¼ï¼å¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ï¼\n\næ°æ®çä¸¢å¤±é®é¢ï¼å¯è½åºç°å¨çäº§èãmqãæ¶è´¹èä¸­ï¼å±ä»¬ä» rabbitmq å kafka åå«æ¥åæä¸ä¸å§ã\n\n\n# rabbitmq\n\n\n\n# çäº§èå¼ä¸¢äºæ°æ®\n\nçäº§èå°æ°æ®åéå° rabbitmq çæ¶åï¼å¯è½æ°æ®å°±å¨åè·¯ç»æä¸¢äºï¼å ä¸ºç½ç»é®é¢å¥çï¼é½æå¯è½ã\n\næ­¤æ¶å¯ä»¥éæ©ç¨ rabbitmq æä¾çäºå¡åè½ï¼å°±æ¯çäº§èåéæ°æ®ä¹åå¼å¯ rabbitmq äºå¡channel.txselectï¼ç¶ååéæ¶æ¯ï¼å¦ææ¶æ¯æ²¡ææåè¢« rabbitmq æ¥æ¶å°ï¼é£ä¹çäº§èä¼æ¶å°å¼å¸¸æ¥éï¼æ­¤æ¶å°±å¯ä»¥åæ»äºå¡channel.txrollbackï¼ç¶åéè¯åéæ¶æ¯ï¼å¦ææ¶å°äºæ¶æ¯ï¼é£ä¹å¯ä»¥æäº¤äºå¡channel.txcommitã\n\n// å¼å¯äºå¡\nchannel.txselect\ntry {\n    // è¿éåéæ¶æ¯\n} catch (exception e) {\n    channel.txrollback\n\n    // è¿éåæ¬¡éåè¿æ¡æ¶æ¯\n}\n\n// æäº¤äºå¡\nchannel.txcommit\n\n\nä½æ¯é®é¢æ¯ï¼rabbitmq äºå¡æºå¶ï¼åæ­¥ï¼ä¸æï¼åºæ¬ä¸ååéä¼ä¸æ¥ï¼å ä¸ºå¤ªèæ§è½ã\n\næä»¥ä¸è¬æ¥è¯´ï¼å¦æä½ è¦ç¡®ä¿è¯´å rabbitmq çæ¶æ¯å«ä¸¢ï¼å¯ä»¥å¼å¯ confirm æ¨¡å¼ï¼å¨çäº§èé£éè®¾ç½®å¼å¯ confirmæ¨¡å¼ä¹åï¼ä½ æ¯æ¬¡åçæ¶æ¯é½ä¼åéä¸ä¸ªå¯ä¸ç idï¼ç¶åå¦æåå¥äº rabbitmq ä¸­ï¼rabbitmq ä¼ç»ä½ åä¼ ä¸ä¸ª ack æ¶æ¯ï¼åè¯ä½ è¯´è¿ä¸ªæ¶æ¯ ok äºãå¦æ rabbitmq æ²¡è½å¤çè¿ä¸ªæ¶æ¯ï¼ä¼åè°ä½ çä¸ä¸ª nack æ¥å£ï¼åè¯ä½ è¿ä¸ªæ¶æ¯æ¥æ¶å¤±è´¥ï¼ä½ å¯ä»¥éè¯ãèä¸ä½ å¯ä»¥ç»åè¿ä¸ªæºå¶èªå·±å¨åå­éç»´æ¤æ¯ä¸ªæ¶æ¯ id çç¶æï¼å¦æè¶è¿ä¸å®æ¶é´è¿æ²¡æ¥æ¶å°è¿ä¸ªæ¶æ¯çåè°ï¼é£ä¹ä½ å¯ä»¥éåã\n\näºå¡æºå¶å confirm æºå¶æå¤§çä¸åå¨äºï¼äºå¡æºå¶æ¯åæ­¥çï¼ä½ æäº¤ä¸ä¸ªäºå¡ä¹åä¼é»å¡å¨é£å¿ï¼ä½æ¯ confirm æºå¶æ¯å¼æ­¥çï¼ä½ åéä¸ªæ¶æ¯ä¹åå°±å¯ä»¥åéä¸ä¸ä¸ªæ¶æ¯ï¼ç¶åé£ä¸ªæ¶æ¯ rabbitmq æ¥æ¶äºä¹åä¼å¼æ­¥åè°ä½ çä¸ä¸ªæ¥å£éç¥ä½ è¿ä¸ªæ¶æ¯æ¥æ¶å°äºã\n\næä»¥ä¸è¬å¨çäº§èè¿åé¿åæ°æ®ä¸¢å¤±ï¼é½æ¯ç¨ confirm æºå¶çã\n\n# rabbitmq å¼ä¸¢äºæ°æ®\n\nå°±æ¯ rabbitmq èªå·±å¼ä¸¢äºæ°æ®ï¼è¿ä¸ªä½ å¿é¡»å¼å¯ rabbitmq çæä¹åï¼å°±æ¯æ¶æ¯åå¥ä¹åä¼æä¹åå°ç£çï¼åªææ¯ rabbitmq èªå·±æäºï¼æ¢å¤ä¹åä¼èªå¨è¯»åä¹åå­å¨çæ°æ®ï¼ä¸è¬æ°æ®ä¸ä¼ä¸¢ãé¤éæå¶ç½è§çæ¯ï¼rabbitmq è¿æ²¡æä¹åï¼èªå·±å°±æäºï¼å¯è½å¯¼è´å°éæ°æ®ä¸¢å¤±ï¼ä½æ¯è¿ä¸ªæ¦çè¾å°ã\n\nè®¾ç½®æä¹åæä¸¤ä¸ªæ­¥éª¤ï¼\n\n * åå»º queue çæ¶åå°å¶è®¾ç½®ä¸ºæä¹å è¿æ ·å°±å¯ä»¥ä¿è¯ rabbitmq æä¹å queue çåæ°æ®ï¼ä½æ¯å®æ¯ä¸ä¼æä¹å queue éçæ°æ®çã\n * ç¬¬äºä¸ªæ¯åéæ¶æ¯çæ¶åå°æ¶æ¯ç deliverymode è®¾ç½®ä¸º 2 å°±æ¯å°æ¶æ¯è®¾ç½®ä¸ºæä¹åçï¼æ­¤æ¶ rabbitmq å°±ä¼å°æ¶æ¯æä¹åå°ç£çä¸å»ã\n\nå¿é¡»è¦åæ¶è®¾ç½®è¿ä¸¤ä¸ªæä¹åæè¡ï¼rabbitmq åªææ¯æäºï¼åæ¬¡éå¯ï¼ä¹ä¼ä»ç£çä¸éå¯æ¢å¤ queueï¼æ¢å¤è¿ä¸ª queue éçæ°æ®ã\n\næ³¨æï¼åªææ¯ä½ ç» rabbitmq å¼å¯äºæä¹åæºå¶ï¼ä¹æä¸ç§å¯è½ï¼å°±æ¯è¿ä¸ªæ¶æ¯åå°äº rabbitmq ä¸­ï¼ä½æ¯è¿æ²¡æ¥å¾åæä¹åå°ç£çä¸ï¼ç»æä¸å·§ï¼æ­¤æ¶ rabbitmq æäºï¼å°±ä¼å¯¼è´åå­éçä¸ç¹ç¹æ°æ®ä¸¢å¤±ã\n\næä»¥ï¼æä¹åå¯ä»¥è·çäº§èé£è¾¹ç confirm æºå¶éåèµ·æ¥ï¼åªææ¶æ¯è¢«æä¹åå°ç£çä¹åï¼æä¼éç¥çäº§è ack äºï¼æä»¥åªææ¯å¨æä¹åå°ç£çä¹åï¼rabbitmq æäºï¼æ°æ®ä¸¢äºï¼çäº§èæ¶ä¸å° ackï¼ä½ ä¹æ¯å¯ä»¥èªå·±éåçã\n\n# æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®\n\nrabbitmq å¦æä¸¢å¤±äºæ°æ®ï¼ä¸»è¦æ¯å ä¸ºä½ æ¶è´¹çæ¶åï¼åæ¶è´¹å°ï¼è¿æ²¡å¤çï¼ç»æè¿ç¨æäºï¼æ¯å¦éå¯äºï¼é£ä¹å°±å°´å°¬äºï¼rabbitmq è®¤ä¸ºä½ é½æ¶è´¹äºï¼è¿æ°æ®å°±ä¸¢äºã\n\nè¿ä¸ªæ¶åå¾ç¨ rabbitmq æä¾ç ack æºå¶ï¼ç®åæ¥è¯´ï¼å°±æ¯ä½ å¿é¡»å³é­ rabbitmq çèªå¨ ackï¼å¯ä»¥éè¿ä¸ä¸ª api æ¥è°ç¨å°±è¡ï¼ç¶åæ¯æ¬¡ä½ èªå·±ä»£ç éç¡®ä¿å¤çå®çæ¶åï¼åå¨ç¨åºé ack ä¸æãè¿æ ·çè¯ï¼å¦æä½ è¿æ²¡å¤çå®ï¼ä¸å°±æ²¡æ ack äºï¼é£ rabbitmq å°±è®¤ä¸ºä½ è¿æ²¡å¤çå®ï¼è¿ä¸ªæ¶å rabbitmq ä¼æè¿ä¸ªæ¶è´¹åéç»å«ç consumer å»å¤çï¼æ¶æ¯æ¯ä¸ä¼ä¸¢çã\n\n\n\n\n# kafka\n\n# æ¶è´¹ç«¯å¼ä¸¢äºæ°æ®\n\nå¯ä¸å¯è½å¯¼è´æ¶è´¹èå¼ä¸¢æ°æ®çæåµï¼å°±æ¯è¯´ï¼ä½ æ¶è´¹å°äºè¿ä¸ªæ¶æ¯ï¼ç¶åæ¶è´¹èé£è¾¹èªå¨æäº¤äº offsetï¼è®© kafka ä»¥ä¸ºä½ å·²ç»æ¶è´¹å¥½äºè¿ä¸ªæ¶æ¯ï¼ä½å¶å®ä½ æååå¤å¤çè¿ä¸ªæ¶æ¯ï¼ä½ è¿æ²¡å¤çï¼ä½ èªå·±å°±æäºï¼æ­¤æ¶è¿æ¡æ¶æ¯å°±ä¸¢å¯ã\n\nè¿ä¸æ¯è· rabbitmq å·®ä¸å¤åï¼å¤§å®¶é½ç¥é kafka ä¼èªå¨æäº¤ offsetï¼é£ä¹åªè¦å³é­èªå¨æäº¤ offsetï¼å¨å¤çå®ä¹åèªå·±æå¨æäº¤ offsetï¼å°±å¯ä»¥ä¿è¯æ°æ®ä¸ä¼ä¸¢ãä½æ¯æ­¤æ¶ç¡®å®è¿æ¯å¯è½ä¼æéå¤æ¶è´¹ï¼æ¯å¦ä½ åå¤çå®ï¼è¿æ²¡æäº¤ offsetï¼ç»æèªå·±æäºï¼æ­¤æ¶è¯å®ä¼éå¤æ¶è´¹ä¸æ¬¡ï¼èªå·±ä¿è¯å¹ç­æ§å°±å¥½äºã\n\nçäº§ç¯å¢ç¢°å°çä¸ä¸ªé®é¢ï¼å°±æ¯è¯´æä»¬ç kafka æ¶è´¹èæ¶è´¹å°äºæ°æ®ä¹åæ¯åå°ä¸ä¸ªåå­ç queue éåç¼å²ä¸ä¸ï¼ç»ææçæ¶åï¼ä½ åææ¶æ¯åå¥åå­ queueï¼ç¶åæ¶è´¹èä¼èªå¨æäº¤ offsetãç¶åæ­¤æ¶æä»¬éå¯äºç³»ç»ï¼å°±ä¼å¯¼è´åå­ queue éè¿æ²¡æ¥å¾åå¤ççæ°æ®å°±ä¸¢å¤±äºã\n\n# kafka å¼ä¸¢äºæ°æ®\n\nè¿åæ¯è¾å¸¸è§çä¸ä¸ªåºæ¯ï¼å°±æ¯ kafka æä¸ª broker å®æºï¼ç¶åéæ°éä¸¾ partition ç leaderãå¤§å®¶æ³æ³ï¼è¦æ¯æ­¤æ¶å¶ä»ç follower åå¥½è¿æäºæ°æ®æ²¡æåæ­¥ï¼ç»ææ­¤æ¶ leader æäºï¼ç¶åéä¸¾æä¸ª follower æ leader ä¹åï¼ä¸å°±å°äºä¸äºæ°æ®ï¼è¿å°±ä¸¢äºä¸äºæ°æ®åã\n\nçäº§ç¯å¢ä¹éå°è¿ï¼æä»¬ä¹æ¯ï¼ä¹å kafka ç leader æºå¨å®æºäºï¼å° follower åæ¢ä¸º leader ä¹åï¼å°±ä¼åç°è¯´è¿ä¸ªæ°æ®å°±ä¸¢äºã\n\næä»¥æ­¤æ¶ä¸è¬æ¯è¦æ±èµ·ç è®¾ç½®å¦ä¸ 4 ä¸ªåæ°ï¼\n\n * ç» topic è®¾ç½® replication.factor åæ°ï¼è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¦æ±æ¯ä¸ª partition å¿é¡»æè³å° 2 ä¸ªå¯æ¬ã\n * å¨ kafka æå¡ç«¯è®¾ç½® min.insync.replicas åæ°ï¼è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¿ä¸ªæ¯è¦æ±ä¸ä¸ª leader è³å°æç¥å°æè³å°ä¸ä¸ª follower è¿è·èªå·±ä¿æèç³»ï¼æ²¡æéï¼è¿æ ·æè½ç¡®ä¿ leader æäºè¿æä¸ä¸ª follower å§ã\n * å¨ producer ç«¯è®¾ç½® acks=allï¼è¿ä¸ªæ¯è¦æ±æ¯æ¡æ°æ®ï¼å¿é¡»æ¯åå¥ææ replica ä¹åï¼æè½è®¤ä¸ºæ¯åæåäºã\n * å¨ producer ç«¯è®¾ç½® retries=maxï¼å¾å¤§å¾å¤§å¾å¤§çä¸ä¸ªå¼ï¼æ éæ¬¡éè¯çææï¼ï¼è¿ä¸ªæ¯è¦æ±ä¸æ¦åå¥å¤±è´¥ï¼å°±æ ééè¯ï¼å¡å¨è¿éäºã\n\næä»¬çäº§ç¯å¢å°±æ¯æç§ä¸è¿°è¦æ±éç½®çï¼è¿æ ·éç½®ä¹åï¼è³å°å¨ kafka broker ç«¯å°±å¯ä»¥ä¿è¯å¨ leader æå¨ broker åçæéï¼è¿è¡ leader åæ¢æ¶ï¼æ°æ®ä¸ä¼ä¸¢å¤±ã\n\n# çäº§èä¼ä¸ä¼å¼ä¸¢æ°æ®ï¼\n\nå¦ææç§ä¸è¿°çæè·¯è®¾ç½®äº acks=allï¼ä¸å®ä¸ä¼ä¸¢ï¼è¦æ±æ¯ï¼ä½ ç leader æ¥æ¶å°æ¶æ¯ï¼ææç follower é½åæ­¥å°äºæ¶æ¯ä¹åï¼æè®¤ä¸ºæ¬æ¬¡åæåäºãå¦ææ²¡æ»¡è¶³è¿ä¸ªæ¡ä»¶ï¼çäº§èä¼èªå¨ä¸æ­çéè¯ï¼éè¯æ éæ¬¡ã\n\n\n# å¦ä½ä¿è¯æ¶æ¯çé¡ºåºæ§ï¼\n\næä¸¾ä¸ªä¾å­ï¼æä»¬ä»¥ååè¿ä¸ä¸ª mysql binlog åæ­¥çç³»ç»ï¼ååè¿æ¯éå¸¸å¤§çï¼æ¥åæ­¥æ°æ®è¦è¾¾å°ä¸äº¿ï¼å°±æ¯è¯´æ°æ®ä»ä¸ä¸ª mysql åºåå°ä¸å¨å°åæ­¥å°å¦ä¸ä¸ª mysql åºéé¢å»ï¼mysql -> mysqlï¼ãå¸¸è§çä¸ç¹å¨äºè¯´æ¯å¦å¤§æ°æ® teamï¼å°±éè¦åæ­¥ä¸ä¸ª mysql åºè¿æ¥ï¼å¯¹å¬å¸çä¸å¡ç³»ç»çæ°æ®ååç§å¤æçæä½ã\n\nä½ å¨ mysql éå¢å æ¹ä¸æ¡æ°æ®ï¼å¯¹åºåºæ¥äºå¢å æ¹ 3 æ¡ binlog æ¥å¿ï¼æ¥çè¿ä¸æ¡ binlog åéå° mq éé¢ï¼åæ¶è´¹åºæ¥ä¾æ¬¡æ§è¡ï¼èµ·ç å¾ä¿è¯äººå®¶æ¯æç§é¡ºåºæ¥çå§ï¼ä¸ç¶æ¬æ¥æ¯ï¼å¢å ãä¿®æ¹ãå é¤ï¼ä½ æ¥æ¯æ¢äºé¡ºåºç»æ§è¡æå é¤ãä¿®æ¹ãå¢å ï¼ä¸å¨éäºä¹ã\n\næ¬æ¥è¿ä¸ªæ°æ®åæ­¥è¿æ¥ï¼åºè¯¥æåè¿ä¸ªæ°æ®è¢«å é¤äºï¼ç»æä½ æéäºè¿ä¸ªé¡ºåºï¼æåè¿ä¸ªæ°æ®ä¿çä¸æ¥äºï¼æ°æ®åæ­¥å°±åºéäºã\n\nåççé¡ºåºä¼éä¹±çä¿©åºæ¯ï¼\n\n * rabbitmqï¼ä¸ä¸ª queueï¼å¤ä¸ª consumerãæ¯å¦ï¼çäº§èå rabbitmq éåéäºä¸æ¡æ°æ®ï¼é¡ºåºä¾æ¬¡æ¯ data1/data2/data3ï¼åå¥çæ¯ rabbitmq çä¸ä¸ªåå­éåãæä¸ä¸ªæ¶è´¹èåå«ä» mq ä¸­æ¶è´¹è¿ä¸æ¡æ°æ®ä¸­çä¸æ¡ï¼ç»ææ¶è´¹è 2 åæ§è¡å®æä½ï¼æ data2 å­å¥æ°æ®åºï¼ç¶åæ¯ data1/data3ãè¿ä¸ææ¾ä¹±äºã\n\n\n\n * kafkaï¼æ¯å¦è¯´æä»¬å»ºäºä¸ä¸ª topicï¼æä¸ä¸ª partitionãçäº§èå¨åçæ¶åï¼å¶å®å¯ä»¥æå®ä¸ä¸ª keyï¼æ¯å¦è¯´æä»¬æå®äºæä¸ªè®¢å id ä½ä¸º keyï¼é£ä¹è¿ä¸ªè®¢åç¸å³çæ°æ®ï¼ä¸å®ä¼è¢«ååå°åä¸ä¸ª partition ä¸­å»ï¼èä¸è¿ä¸ª partition ä¸­çæ°æ®ä¸å®æ¯æé¡ºåºçã æ¶è´¹èä» partition ä¸­ååºæ¥æ°æ®çæ¶åï¼ä¹ä¸å®æ¯æé¡ºåºçãå°è¿éï¼é¡ºåºè¿æ¯ ok çï¼æ²¡æéä¹±ãæ¥çï¼æä»¬å¨æ¶è´¹èéå¯è½ä¼æå¤ä¸ªçº¿ç¨æ¥å¹¶åå¤çæ¶æ¯ãå ä¸ºå¦ææ¶è´¹èæ¯åçº¿ç¨æ¶è´¹å¤çï¼èå¤çæ¯è¾èæ¶çè¯ï¼æ¯å¦å¤çä¸æ¡æ¶æ¯èæ¶å å msï¼é£ä¹ 1 ç§éåªè½å¤çå åæ¡æ¶æ¯ï¼è¿ååéå¤ªä½äºãèå¤ä¸ªçº¿ç¨å¹¶åè·çè¯ï¼é¡ºåºå¯è½å°±ä¹±æäºã\n\n\n\n\n# è§£å³æ¹æ¡\n\n# rabbitmq\n\n\n\n# kafka\n\n * ä¸ä¸ª topicï¼ä¸ä¸ª partitionï¼ä¸ä¸ª consumerï¼åé¨åçº¿ç¨æ¶è´¹ï¼åçº¿ç¨ååéå¤ªä½ï¼ä¸è¬ä¸ä¼ç¨è¿ä¸ªã\n * å n ä¸ªåå­ queueï¼å·æç¸å key çæ°æ®é½å°åä¸ä¸ªåå­ queueï¼ç¶åå¯¹äº n ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨åå«æ¶è´¹ä¸ä¸ªåå­ queue å³å¯ï¼è¿æ ·å°±è½ä¿è¯é¡ºåºæ§ã\n\n\n\n\n# å¦ä½è§£å³æ¶æ¯éåçå»¶æ¶ä»¥åè¿æå¤±æé®é¢ï¼æ¶æ¯éåæ»¡äºä»¥åè¯¥æä¹å¤çï¼æå ç¾ä¸æ¶æ¯æç»­ç§¯åå å°æ¶ï¼è¯´è¯´æä¹è§£å³ï¼\n\nä½ çè¿é®æ³ï¼å¶å®æ¬è´¨éå¯¹çåºæ¯ï¼é½æ¯è¯´ï¼å¯è½ä½ çæ¶è´¹ç«¯åºäºé®é¢ï¼ä¸æ¶è´¹äºï¼æèæ¶è´¹çéåº¦æå¶æ¢ãæ¥çå°±åç¹äºï¼å¯è½ä½ çæ¶æ¯éåéç¾¤çç£çé½å¿«åæ»¡äºï¼é½æ²¡äººæ¶è´¹ï¼è¿ä¸ªæ¶åæä¹åï¼æèæ¯è¿æ´ä¸ªå°±ç§¯åäºå ä¸ªå°æ¶ï¼ä½ è¿ä¸ªæ¶åæä¹åï¼æèæ¯ä½ ç§¯åçæ¶é´å¤ªé¿äºï¼å¯¼è´æ¯å¦ rabbitmq è®¾ç½®äºæ¶æ¯è¿ææ¶é´åå°±æ²¡äºæä¹åï¼\n\næä»¥å°±è¿äºå¿ï¼å¶å®çº¿ä¸æºå¸¸è§çï¼ä¸è¬ä¸åºï¼ä¸åºå°±æ¯å¤§ caseãä¸è¬å¸¸è§äºï¼ä¸¾ä¸ªä¾å­ï¼æ¶è´¹ç«¯æ¯æ¬¡æ¶è´¹ä¹åè¦å mysqlï¼ç»æ mysql æäºï¼æ¶è´¹ç«¯ hang é£å¿äºï¼ä¸å¨äºï¼æèæ¯æ¶è´¹ç«¯åºäºä¸ªä»ä¹å²å­ï¼å¯¼è´æ¶è´¹éåº¦æå¶æ¢ã\n\n\n# é¢è¯é¢åæ\n\nå³äºè¿ä¸ªäºå¿ï¼æä»¬ä¸ä¸ªä¸ä¸ªæ¥æ¢³çå§ï¼ååè®¾ä¸ä¸ªåºæ¯ï¼æä»¬ç°å¨æ¶è´¹ç«¯åºæéäºï¼ç¶åå¤§éæ¶æ¯å¨ mq éç§¯åï¼ç°å¨åºäºæäºï¼æäºã\n\n\n# å¤§éæ¶æ¯å¨ mq éç§¯åäºå ä¸ªå°æ¶äºè¿æ²¡è§£å³\n\nå åä¸æ¡æ°æ®å¨ mq éç§¯åäºä¸å«ä¸ªå°æ¶ï¼ä»ä¸å 4 ç¹å¤ï¼ç§¯åå°äºæä¸ 11 ç¹å¤ãè¿ä¸ªæ¯æä»¬çå®éå°è¿çä¸ä¸ªåºæ¯ï¼ç¡®å®æ¯çº¿ä¸æéäºï¼è¿ä¸ªæ¶åè¦ä¸ç¶å°±æ¯ä¿®å¤ consumer çé®é¢ï¼è®©å®æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå»å»çç­å¾å ä¸ªå°æ¶æ¶è´¹å®æ¯ãè¿ä¸ªè¯å®ä¸è½å¨é¢è¯çæ¶åè¯´å§ã\n\nä¸ä¸ªæ¶è´¹èä¸ç§æ¯ 1000 æ¡ï¼ä¸ç§ 3 ä¸ªæ¶è´¹èæ¯ 3000 æ¡ï¼ä¸åéå°±æ¯ 18 ä¸æ¡ãæä»¥å¦æä½ ç§¯åäºå ç¾ä¸å°ä¸åä¸çæ°æ®ï¼å³ä½¿æ¶è´¹èæ¢å¤äºï¼ä¹éè¦å¤§æ¦ 1 å°æ¶çæ¶é´æè½æ¢å¤è¿æ¥ã\n\nä¸è¬è¿ä¸ªæ¶åï¼åªè½ä¸´æ¶ç´§æ¥æ©å®¹äºï¼å·ä½æä½æ­¥éª¤åæè·¯å¦ä¸ï¼\n\n * åä¿®å¤ consumer çé®é¢ï¼ç¡®ä¿å¶æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå°ç°æ consumer é½åæã\n * æ°å»ºä¸ä¸ª topicï¼partition æ¯åæ¥ç 10 åï¼ä¸´æ¶å»ºç«å¥½åå 10 åç queue æ°éã\n * ç¶ååä¸ä¸ªä¸´æ¶çååæ°æ®ç consumer ç¨åºï¼è¿ä¸ªç¨åºé¨ç½²ä¸å»æ¶è´¹ç§¯åçæ°æ®ï¼æ¶è´¹ä¹åä¸åèæ¶çå¤çï¼ç´æ¥ååè½®è¯¢åå¥ä¸´æ¶å»ºç«å¥½ç 10 åæ°éç queueã\n * æ¥çä¸´æ¶å¾ç¨ 10 åçæºå¨æ¥é¨ç½² consumerï¼æ¯ä¸æ¹ consumer æ¶è´¹ä¸ä¸ªä¸´æ¶ queue çæ°æ®ãè¿ç§åæ³ç¸å½äºæ¯ä¸´æ¶å° queue èµæºå consumer èµæºæ©å¤§ 10 åï¼ä»¥æ­£å¸¸ç 10 åéåº¦æ¥æ¶è´¹æ°æ®ã\n * ç­å¿«éæ¶è´¹å®ç§¯åæ°æ®ä¹åï¼å¾æ¢å¤ååé¨ç½²çæ¶æï¼éæ°ç¨ååç consumer æºå¨æ¥æ¶è´¹æ¶æ¯ã\n\n\n# mq ä¸­çæ¶æ¯è¿æå¤±æäº\n\nåè®¾ä½ ç¨çæ¯ rabbitmqï¼rabbtimq æ¯å¯ä»¥è®¾ç½®è¿ææ¶é´çï¼ä¹å°±æ¯ ttlãå¦ææ¶æ¯å¨ queue ä¸­ç§¯åè¶è¿ä¸å®çæ¶é´å°±ä¼è¢« rabbitmq ç»æ¸çæï¼è¿ä¸ªæ°æ®å°±æ²¡äºãé£è¿å°±æ¯ç¬¬äºä¸ªåäºãè¿å°±ä¸æ¯è¯´æ°æ®ä¼å¤§éç§¯åå¨ mq éï¼èæ¯å¤§éçæ°æ®ä¼ç´æ¥æä¸¢ã\n\nè¿ä¸ªæåµä¸ï¼å°±ä¸æ¯è¯´è¦å¢å  consumer æ¶è´¹ç§¯åçæ¶æ¯ï¼å ä¸ºå®éä¸æ²¡å¥ç§¯åï¼èæ¯ä¸¢äºå¤§éçæ¶æ¯ãæä»¬å¯ä»¥éåä¸ä¸ªæ¹æ¡ï¼å°±æ¯æ¹ééå¯¼ï¼è¿ä¸ªæä»¬ä¹åçº¿ä¸ä¹æç±»ä¼¼çåºæ¯å¹²è¿ãå°±æ¯å¤§éç§¯åçæ¶åï¼æä»¬å½æ¶å°±ç´æ¥ä¸¢å¼æ°æ®äºï¼ç¶åç­è¿äºé«å³°æä»¥åï¼æ¯å¦å¤§å®¶ä¸èµ·ååå¡ç¬å¤å°æä¸ 12 ç¹ä»¥åï¼ç¨æ·é½ç¡è§äºãè¿ä¸ªæ¶åæä»¬å°±å¼å§åç¨åºï¼å°ä¸¢å¤±çé£æ¹æ°æ®ï¼åä¸ªä¸´æ¶ç¨åºï¼ä¸ç¹ä¸ç¹çæ¥åºæ¥ï¼ç¶åéæ°çå¥ mq éé¢å»ï¼æç½å¤©ä¸¢çæ°æ®ç»ä»è¡¥åæ¥ãä¹åªè½æ¯è¿æ ·äºã\n\nåè®¾ 1 ä¸ä¸ªè®¢åç§¯åå¨ mq éé¢ï¼æ²¡æå¤çï¼å¶ä¸­ 1000 ä¸ªè®¢åé½ä¸¢äºï¼ä½ åªè½æå¨åç¨åºæé£ 1000 ä¸ªè®¢åç»æ¥åºæ¥ï¼æå¨åå° mq éå»åè¡¥ä¸æ¬¡ã\n\n\n# mq é½å¿«åæ»¡äº\n\nå¦ææ¶æ¯ç§¯åå¨ mq éï¼ä½ å¾é¿æ¶é´é½æ²¡æå¤çæï¼æ­¤æ¶å¯¼è´ mq é½å¿«åæ»¡äºï¼ååï¼è¿ä¸ªè¿æå«çåæ³åï¼æ²¡æï¼è°è®©ä½ ç¬¬ä¸ä¸ªæ¹æ¡æ§è¡çå¤ªæ¢äºï¼ä½ ä¸´æ¶åç¨åºï¼æ¥å¥æ°æ®æ¥æ¶è´¹ï¼æ¶è´¹ä¸ä¸ªä¸¢å¼ä¸ä¸ªï¼é½ä¸è¦äºï¼å¿«éæ¶è´¹æææçæ¶æ¯ãç¶åèµ°ç¬¬äºä¸ªæ¹æ¡ï¼å°äºæä¸åè¡¥æ°æ®å§ã\n\n\n# å¦æè®©ä½ åä¸ä¸ªæ¶æ¯éåï¼è¯¥å¦ä½è¿è¡æ¶æè®¾è®¡åï¼è¯´ä¸ä¸ä½ çæè·¯ã\n\n\n# é¢è¯å®å¿çåæ\n\nå¶å®èå°è¿ä¸ªé®é¢ï¼ä¸è¬é¢è¯å®è¦èå¯ä¸¤åï¼\n\n * ä½ ææ²¡æå¯¹æä¸ä¸ªæ¶æ¯éååè¿è¾ä¸ºæ·±å¥çåççäºè§£ï¼æèä»æ´ä½äºè§£ææ¡ä½ä¸ä¸ªæ¶æ¯éåçæ¶æåçã\n * ççä½ çè®¾è®¡è½åï¼ç»ä½ ä¸ä¸ªå¸¸è§çç³»ç»ï¼å°±æ¯æ¶æ¯éåç³»ç»ï¼ççä½ è½ä¸è½ä»å¨å±ææ¡ä¸ä¸æ´ä½æ¶æè®¾è®¡ï¼ç»åºä¸äºå³é®ç¹åºæ¥ã\n\nè¯´å®è¯ï¼é®ç±»ä¼¼é®é¢çæ¶åï¼å¤§é¨åäººåºæ¬é½ä¼èï¼å ä¸ºå¹³æ¶ä»æ¥æ²¡ææèè¿ç±»ä¼¼çé®é¢ï¼å¤§å¤æ°äººå°±æ¯å¹³æ¶åå¤´ç¨ï¼ä»æ¥ä¸å»æèèåçä¸äºä¸è¥¿ãç±»ä¼¼çé®é¢ï¼æ¯å¦ï¼å¦æè®©ä½ æ¥è®¾è®¡ä¸ä¸ª spring æ¡æ¶ä½ ä¼æä¹åï¼å¦æè®©ä½ æ¥è®¾è®¡ä¸ä¸ª dubbo æ¡æ¶ä½ ä¼æä¹åï¼å¦æè®©ä½ æ¥è®¾è®¡ä¸ä¸ª mybatis æ¡æ¶ä½ ä¼æä¹åï¼\n\n\n# é¢è¯é¢åæ\n\nå¶å®åç­è¿ç±»é®é¢ï¼è¯´ç½äºï¼ä¸æ±ä½ çè¿é£ææ¯çæºç ï¼èµ·ç ä½ è¦å¤§æ¦ç¥éé£ä¸ªææ¯çåºæ¬åçãæ ¸å¿ç»æé¨åãåºæ¬æ¶æææï¼ç¶ååç§ä¸äºå¼æºçææ¯æä¸ä¸ªç³»ç»è®¾è®¡åºæ¥çæè·¯è¯´ä¸ä¸å°±å¥½ã\n\næ¯å¦è¯´è¿ä¸ªæ¶æ¯éåç³»ç»ï¼æä»¬ä»ä»¥ä¸å ä¸ªè§åº¦æ¥èèä¸ä¸ï¼\n\n * é¦åè¿ä¸ª mq å¾æ¯æå¯ä¼¸ç¼©æ§å§ï¼å°±æ¯éè¦çæ¶åå¿«éæ©å®¹ï¼å°±å¯ä»¥å¢å ååéåå®¹éï¼é£æä¹æï¼è®¾è®¡ä¸ªåå¸å¼çç³»ç»åï¼åç§ä¸ä¸ kafka çè®¾è®¡çå¿µï¼broker -> topic -> partitionï¼æ¯ä¸ª partition æ¾ä¸ä¸ªæºå¨ï¼å°±å­ä¸é¨åæ°æ®ãå¦æç°å¨èµæºä¸å¤äºï¼ç®ååï¼ç» topic å¢å  partitionï¼ç¶ååæ°æ®è¿ç§»ï¼å¢å æºå¨ï¼ä¸å°±å¯ä»¥å­æ¾æ´å¤æ°æ®ï¼æä¾æ´é«çååéäºï¼\n * å¶æ¬¡ä½ å¾èèä¸ä¸è¿ä¸ª mq çæ°æ®è¦ä¸è¦è½å°ç£çå§ï¼é£è¯å®è¦äºï¼è½ç£çæè½ä¿è¯å«è¿ç¨æäºæ°æ®å°±ä¸¢äºãé£è½ç£ççæ¶åæä¹è½åï¼é¡ºåºåï¼è¿æ ·å°±æ²¡æç£çéæºè¯»åçå¯»åå¼éï¼ç£çé¡ºåºè¯»åçæ§è½æ¯å¾é«çï¼è¿å°±æ¯ kafka çæè·¯ã\n * å¶æ¬¡ä½ èèä¸ä¸ä½ ç mq çå¯ç¨æ§åï¼è¿ä¸ªäºå¿ï¼å·ä½åèä¹åå¯ç¨æ§é£ä¸ªç¯èè®²è§£ç kafka çé«å¯ç¨ä¿éæºå¶ãå¤å¯æ¬ -> leader & follower -> broker æäºéæ°éä¸¾ leader å³å¯å¯¹å¤æå¡ã\n * è½ä¸è½æ¯ææ°æ® 0 ä¸¢å¤±åï¼å¯ä»¥çï¼åèæä»¬ä¹åè¯´çé£ä¸ª kafka æ°æ®é¶ä¸¢å¤±æ¹æ¡ã\n\nmq è¯å®æ¯å¾å¤æçï¼é¢è¯å®é®ä½ è¿ä¸ªé®é¢ï¼å¶å®æ¯ä¸ªå¼æ¾é¢ï¼ä»å°±æ¯ççä½ ææ²¡æä»æ¶æè§åº¦æ´ä½ææåè®¾è®¡çæç»´ä»¥åè½åãç¡®å®è¿ä¸ªé®é¢å¯ä»¥å·æä¸å¤§æ¹äººï¼å ä¸ºå¤§é¨åäººå¹³æ¶ä¸æèè¿äºä¸è¥¿ã",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"æ¶æ¯éååºæ¬åç",frontmatter:{title:"æ¶æ¯éååºæ¬åç",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","MQ"],tags:["Java","ä¸­é´ä»¶","MQ"],abbrlink:"2d0902c8",date:"2019-07-05T15:11:00.000Z",permalink:"/pages/055069/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.MQ/02.%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86.html",relativePath:"14.ä¸­é´ä»¶/01.MQ/02.æ¶æ¯éååºæ¬åç.md",key:"v-6140a136",path:"/pages/055069/",headers:[{level:2,title:"MQ çç®ä»",slug:"mq-çç®ä»",normalizedTitle:"mq çç®ä»",charIndex:259},{level:3,title:"ä»ä¹æ¯ MQ",slug:"ä»ä¹æ¯-mq",normalizedTitle:"ä»ä¹æ¯ mq",charIndex:270},{level:3,title:"MQ éä¿¡æ¨¡å",slug:"mq-éä¿¡æ¨¡å",normalizedTitle:"mq éä¿¡æ¨¡å",charIndex:718},{level:2,title:"MQ çåºç¨",slug:"mq-çåºç¨",normalizedTitle:"mq çåºç¨",charIndex:1482},{level:3,title:"å¼æ­¥å¤ç",slug:"å¼æ­¥å¤ç",normalizedTitle:"å¼æ­¥å¤ç",charIndex:69},{level:3,title:"ç³»ç»è§£è¦",slug:"ç³»ç»è§£è¦",normalizedTitle:"ç³»ç»è§£è¦",charIndex:1924},{level:3,title:"æµéåå³°",slug:"æµéåå³°",normalizedTitle:"æµéåå³°",charIndex:2250},{level:3,title:"ä¼ è¾ç¼å²",slug:"ä¼ è¾ç¼å²",normalizedTitle:"ä¼ è¾ç¼å²",charIndex:2802},{level:3,title:"æç»ä¸è´æ§",slug:"æç»ä¸è´æ§",normalizedTitle:"æç»ä¸è´æ§",charIndex:102},{level:3,title:"ç³»ç»é´éä¿¡",slug:"ç³»ç»é´éä¿¡",normalizedTitle:"ç³»ç»é´éä¿¡",charIndex:3381},{level:2,title:"MQ çé®é¢",slug:"mq-çé®é¢",normalizedTitle:"mq çé®é¢",charIndex:3518},{level:3,title:"éå¤æ¶è´¹",slug:"éå¤æ¶è´¹",normalizedTitle:"éå¤æ¶è´¹",charIndex:3702},{level:4,title:"éå¤æ¶è´¹é®é¢åå ",slug:"éå¤æ¶è´¹é®é¢åå ",normalizedTitle:"éå¤æ¶è´¹é®é¢åå ",charIndex:3949},{level:4,title:"éå¤æ¶è´¹è§£å³æ¹æ¡",slug:"éå¤æ¶è´¹è§£å³æ¹æ¡",normalizedTitle:"éå¤æ¶è´¹è§£å³æ¹æ¡",charIndex:4299},{level:3,title:"æ¶æ¯ä¸¢å¤±",slug:"æ¶æ¯ä¸¢å¤±",normalizedTitle:"æ¶æ¯ä¸¢å¤±",charIndex:3718},{level:4,title:"æ¶è´¹æ¹ä¸¢å¤±æ°æ®",slug:"æ¶è´¹æ¹ä¸¢å¤±æ°æ®",normalizedTitle:"æ¶è´¹æ¹ä¸¢å¤±æ°æ®",charIndex:4706},{level:4,title:"Kafka Server ä¸¢å¤±æ°æ®",slug:"kafka-server-ä¸¢å¤±æ°æ®",normalizedTitle:"kafka server ä¸¢å¤±æ°æ®",charIndex:4941},{level:4,title:"çäº§æ¹ä¸¢å¤±æ°æ®",slug:"çäº§æ¹ä¸¢å¤±æ°æ®",normalizedTitle:"çäº§æ¹ä¸¢å¤±æ°æ®",charIndex:4717},{level:3,title:"æ¶æ¯çé¡ºåºæ§",slug:"æ¶æ¯çé¡ºåºæ§",normalizedTitle:"æ¶æ¯çé¡ºåºæ§",charIndex:3740},{level:3,title:"æ¶æ¯ç§¯å",slug:"æ¶æ¯ç§¯å",normalizedTitle:"æ¶æ¯ç§¯å",charIndex:3760},{level:2,title:"MQ çé«å¯ç¨",slug:"mq-çé«å¯ç¨",normalizedTitle:"mq çé«å¯ç¨",charIndex:3651},{level:3,title:"Kafka çé«å¯ç¨",slug:"kafka-çé«å¯ç¨",normalizedTitle:"kafka çé«å¯ç¨",charIndex:6598},{level:4,title:"Kafka çæ ¸å¿æ¦å¿µ",slug:"kafka-çæ ¸å¿æ¦å¿µ",normalizedTitle:"kafka çæ ¸å¿æ¦å¿µ",charIndex:6612},{level:4,title:"Kafka çå¯æ¬æºå¶",slug:"kafka-çå¯æ¬æºå¶",normalizedTitle:"kafka çå¯æ¬æºå¶",charIndex:7089},{level:4,title:"Kafka éä¸¾ Leader",slug:"kafka-éä¸¾-leader",normalizedTitle:"kafka éä¸¾ leader",charIndex:7750},{level:2,title:"ä¸»æµ MQ",slug:"ä¸»æµ-mq",normalizedTitle:"ä¸»æµ mq",charIndex:7880},{level:3,title:"ActiveMQ",slug:"activemq",normalizedTitle:"activemq",charIndex:168},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8035},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8678},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹",normalizedTitle:"(c) ä¼ç¹",charIndex:8767},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹",normalizedTitle:"(d) ç¼ºç¹",charIndex:9157},{level:3,title:"RabbitMQ",slug:"rabbitmq",normalizedTitle:"rabbitmq",charIndex:150},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§-2",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8035},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢-2",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8678},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹-2",normalizedTitle:"(c) ä¼ç¹",charIndex:8767},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹-2",normalizedTitle:"(d) ç¼ºç¹",charIndex:9157},{level:3,title:"RocketMQ",slug:"rocketmq",normalizedTitle:"rocketmq",charIndex:159},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§-3",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8035},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢-3",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8678},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹-3",normalizedTitle:"(c) ä¼ç¹",charIndex:8767},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹-3",normalizedTitle:"(d) ç¼ºç¹",charIndex:9157},{level:3,title:"Kafka",slug:"kafka",normalizedTitle:"kafka",charIndex:144},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§-4",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8035},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢-4",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8678},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹-4",normalizedTitle:"(c) ä¼ç¹",charIndex:8767},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹-4",normalizedTitle:"(d) ç¼ºç¹",charIndex:9157},{level:3,title:"MQ çææ¯éå",slug:"mq-çææ¯éå",normalizedTitle:"mq çææ¯éå",charIndex:12543},{level:2,title:"JMS",slug:"jms",normalizedTitle:"jms",charIndex:7938},{level:3,title:"æ¶æ¯æ¨¡å",slug:"æ¶æ¯æ¨¡å",normalizedTitle:"æ¶æ¯æ¨¡å",charIndex:14568},{level:4,title:"P2P æ¨¡å¼",slug:"p2p-æ¨¡å¼",normalizedTitle:"p2p æ¨¡å¼",charIndex:14650},{level:4,title:"Pub/sub æ¨¡å¼",slug:"pub-sub-æ¨¡å¼",normalizedTitle:"pub/sub æ¨¡å¼",charIndex:14940},{level:3,title:"æ¶æ¯æ¶è´¹",slug:"æ¶æ¯æ¶è´¹",normalizedTitle:"æ¶æ¯æ¶è´¹",charIndex:3905},{level:3,title:"JMS ç¼ç¨æ¨¡å",slug:"jms-ç¼ç¨æ¨¡å",normalizedTitle:"jms ç¼ç¨æ¨¡å",charIndex:15621},{level:4,title:"ConnectionFactory",slug:"connectionfactory",normalizedTitle:"connectionfactory",charIndex:15633},{level:4,title:"Destination",slug:"destination",normalizedTitle:"destination",charIndex:879},{level:4,title:"Connection",slug:"connection",normalizedTitle:"connection",charIndex:15633},{level:4,title:"Session",slug:"session",normalizedTitle:"session",charIndex:16089},{level:4,title:"æ¶æ¯ççäº§è",slug:"æ¶æ¯ççäº§è",normalizedTitle:"æ¶æ¯ççäº§è",charIndex:16329},{level:4,title:"æ¶æ¯æ¶è´¹è",slug:"æ¶æ¯æ¶è´¹è",normalizedTitle:"æ¶æ¯æ¶è´¹è",charIndex:15827},{level:4,title:"MessageListener",slug:"messagelistener",normalizedTitle:"messagelistener",charIndex:16670},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:16791}],headersStr:"MQ çç®ä» ä»ä¹æ¯ MQ MQ éä¿¡æ¨¡å MQ çåºç¨ å¼æ­¥å¤ç ç³»ç»è§£è¦ æµéåå³° ä¼ è¾ç¼å² æç»ä¸è´æ§ ç³»ç»é´éä¿¡ MQ çé®é¢ éå¤æ¶è´¹ éå¤æ¶è´¹é®é¢åå  éå¤æ¶è´¹è§£å³æ¹æ¡ æ¶æ¯ä¸¢å¤± æ¶è´¹æ¹ä¸¢å¤±æ°æ® Kafka Server ä¸¢å¤±æ°æ® çäº§æ¹ä¸¢å¤±æ°æ® æ¶æ¯çé¡ºåºæ§ æ¶æ¯ç§¯å MQ çé«å¯ç¨ Kafka çé«å¯ç¨ Kafka çæ ¸å¿æ¦å¿µ Kafka çå¯æ¬æºå¶ Kafka éä¸¾ Leader ä¸»æµ MQ ActiveMQ (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ RabbitMQ (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ RocketMQ (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ Kafka (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ MQ çææ¯éå JMS æ¶æ¯æ¨¡å P2P æ¨¡å¼ Pub/sub æ¨¡å¼ æ¶æ¯æ¶è´¹ JMS ç¼ç¨æ¨¡å ConnectionFactory Destination Connection Session æ¶æ¯ççäº§è æ¶æ¯æ¶è´¹è MessageListener åèèµæ",content:'# æ¶æ¯éååºæ¬åç\n\n> æ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³å¼æ­¥å¤çãåºç¨é´è¦åï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> ç®åä¸»æµç MQ æï¼KafkaãRabbitMQãRocketMQãActiveMQï¼èé¨åæ°æ®åºå¦ RedisãMySQL ä»¥å phxsql ä¹å¯å®ç°æ¶æ¯éåçåè½ã\n> \n> æ³¨æï¼ä¸ºäºç®ä¾¿ï¼ä¸æä¸­é¤äºæç« æ é¢ï¼ä¸å¾ä½¿ç¨ MQ ç®ç§°ã\n\n\n# MQ çç®ä»\n\n\n# ä»ä¹æ¯ MQ\n\næ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n\næ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n\nMQ æ¯æ¶è´¹-çäº§èæ¨¡åçä¸ä¸ªå¸åçä»£è¡¨ï¼ä¸ç«¯å¾æ¶æ¯éåä¸­ä¸æ­åå¥æ¶æ¯ï¼èå¦ä¸ç«¯åå¯ä»¥è¯»åéåä¸­çæ¶æ¯ãæ¶æ¯åå¸èåªç®¡ææ¶æ¯åå¸å° MQ ä¸­èä¸ç¨ç®¡è°æ¥åï¼æ¶æ¯ä½¿ç¨èåªç®¡ä» MQ ä¸­åæ¶æ¯èä¸ç®¡æ¯è°åå¸çãè¿æ ·åå¸èåä½¿ç¨èé½ä¸ç¨ç¥éå¯¹æ¹çå­å¨ã\n\nMQ çæ°æ®å¯é©»çå¨åå­æç£çä¸ï¼ç´å°å®ä»¬è¢«åºç¨ç¨åºè¯»åãéè¿ MQï¼åºç¨ç¨åºå¯ç¬ç«å°æ§è¡ï¼å®ä»¬ä¸éè¦ç¥éå½¼æ­¤çä½ç½®ï¼ä¸éè¦ç­å¾æ¥æ¶ç¨åºæ¥æ¶æ­¤æ¶æ¯ãå¨åå¸å¼è®¡ç®ç¯å¢ä¸­ï¼ä¸ºäºéæåå¸å¼åºç¨ï¼å¼åèéè¦å¯¹å¼æç½ç»ç¯å¢ä¸çåå¸å¼åºç¨æä¾ææçéä¿¡ææ®µãä¸ºäºç®¡çéè¦å±äº«çä¿¡æ¯ï¼å¯¹åºç¨æä¾å¬å±çä¿¡æ¯äº¤æ¢æºå¶æ¯éè¦çã\n\nç®åä¸»æµç MQ æï¼KafkaãRabbitMQãRocketMQãActiveMQã\n\n\n# MQ éä¿¡æ¨¡å\n\nMQ éä¿¡æ¨¡åå¤§è´æä»¥ä¸ç±»åï¼\n\n * ç¹å¯¹ç¹ - ç¹å¯¹ç¹æ¹å¼æ¯æä¸ºä¼ ç»åå¸¸è§çéè®¯æ¹å¼ï¼å®æ¯æä¸å¯¹ä¸ãä¸å¯¹å¤ãå¤å¯¹å¤ãå¤å¯¹ä¸ç­å¤ç§éç½®æ¹å¼ï¼æ¯ææ ç¶ãç½ç¶ç­å¤ç§ææç»æã\n * å¤ç¹å¹¿æ­ - MQ éç¨äºä¸åç±»åçåºç¨ãå¶ä¸­éè¦çï¼ä¹æ¯æ­£å¨åå±ä¸­çæ¯"å¤ç¹å¹¿æ­"åºç¨ï¼å³è½å¤å°æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ (Destination List)ãå¯ä»¥ä½¿ç¨ä¸æ¡ MQ æä»¤å°åä¸æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ï¼å¹¶ç¡®ä¿ä¸ºæ¯ä¸ç«ç¹å¯é å°æä¾ä¿¡æ¯ãMQ ä¸ä»æä¾äºå¤ç¹å¹¿æ­çåè½ï¼èä¸è¿æ¥ææºè½æ¶æ¯åååè½ï¼å¨å°ä¸æ¡æ¶æ¯åéå°åä¸ç³»ç»ä¸çå¤ä¸ªç¨æ·æ¶ï¼MQ å°æ¶æ¯çä¸ä¸ªå¤å¶çæ¬åè¯¥ç³»ç»ä¸æ¥æ¶èçåååéå°ç®æ  MQ ç³»ç»ãç®æ  MQ ç³»ç»å¨æ¬å°å¤å¶è¿äºæ¶æ¯ï¼å¹¶å°å®ä»¬åéå°ååä¸çéåï¼ä»èå°½å¯è½åå°ç½ç»çä¼ è¾éã\n * åå¸/è®¢é (Publish/Subscribe) - åå¸/è®¢éæ¨¡å¼ä½¿æ¶æ¯çååå¯ä»¥çªç ´ç®çéåå°çä½ç½®çéå¶ï¼ä½¿æ¶æ¯æç§ç¹å®çä¸»é¢çè³åå®¹è¿è¡ååï¼ç¨æ·æåºç¨ç¨åºå¯ä»¥æ ¹æ®ä¸»é¢æåå®¹æ¥æ¶å°æéè¦çæ¶æ¯ãåå¸/è®¢éæ¨¡å¼ä½¿å¾åéèåæ¥æ¶èä¹é´çè¦åå³ç³»åå¾æ´ä¸ºæ¾æ£ï¼åéèä¸å¿å³å¿æ¥æ¶èçç®çå°åï¼èæ¥æ¶èä¹ä¸å¿å³å¿æ¶æ¯çåéå°åï¼èåªæ¯æ ¹æ®æ¶æ¯çä¸»é¢è¿è¡æ¶æ¯çæ¶åã\n * éç¾¤ (Cluster) - ä¸ºäºç®åç¹å¯¹ç¹éè®¯æ¨¡å¼ä¸­çç³»ç»éç½®ï¼MQ æä¾ Cluster(éç¾¤) çè§£å³æ¹æ¡ãéç¾¤ç±»ä¼¼äºä¸ä¸ªå (Domain)ï¼éç¾¤åé¨çéåç®¡çå¨ä¹é´éè®¯æ¶ï¼ä¸éè¦ä¸¤ä¸¤ä¹é´å»ºç«æ¶æ¯ééï¼èæ¯éç¨éç¾¤ (Cluster) ééä¸å¶å®æåéè®¯ï¼ä»èå¤§å¤§ç®åäºç³»ç»éç½®ãæ­¤å¤ï¼éç¾¤ä¸­çéåç®¡çå¨ä¹é´è½å¤èªå¨è¿è¡è´è½½åè¡¡ï¼å½æä¸éåç®¡çå¨åºç°æéæ¶ï¼å¶å®éåç®¡çå¨å¯ä»¥æ¥ç®¡å®çå·¥ä½ï¼ä»èå¤§å¤§æé«ç³»ç»çé«å¯é æ§ã\n\n\n# MQ çåºç¨\n\n\n# å¼æ­¥å¤ç\n\n> MQ å¯ä»¥å°ç³»ç»é´çå¤çæµç¨å¼æ­¥åï¼åå°ç­å¾ååºçæ¶é´ï¼ä»èæé«æ´ä½å¹¶åååéã\n> \n> ä¸è¬ï¼MQ å¼æ­¥å¤çåºç¨äºéæ ¸å¿æµç¨ï¼ä¾å¦ï¼ç­ä¿¡/é®ä»¶éç¥ãæ°æ®æ¨éãä¸æ¥æ°æ®å°çæ§ä¸­å¿/æ¥å¿ä¸­å¿ç­ã\n\nåè®¾è¿æ ·ä¸ä¸ªåºæ¯ï¼ç¨æ·åç³»ç» A åèµ·è¯·æ±ï¼ç³»ç» A å¤çè®¡ç®åªéè¦ 10 msï¼ç¶åéç¥ç³»ç» BCD ååºï¼ç³»ç» BCD ååºèæ¶åå«ä¸ºï¼100msã200msã300msãæç»æ»èæ¶ä¸ºï¼ 10+100ms+200ms+300ms=610msãæ­¤å¤ï¼å ä¸è¯·æ±åååºçç½ç»ä¼ è¾æ¶é´ï¼ä»ç¨æ·è§åº¦çï¼å¯è½è¦ç­å¾å°è¿ 1s æè½å¾å°ç»æã\n\n\n\nå¦æä½¿ç¨ MQï¼ç³»ç» A æ¥å°è¯·æ±åï¼èæ¶ 10ms å¤çè®¡ç®ï¼ç¶ååç³»ç» BCD è¿ç»­åéæ¶æ¯ï¼åè®¾èæ¶ 5msãé£ä¹ è¿ä¸è¿ç¨çæ»èæ¶ä¸º 3ms + 5ms = 8msï¼è¿ç¸æ¯äº 610 msï¼å¤§å¤§ç¼©ç­äºååºæ¶é´ãè³äºç³»ç» BCD çååºæä½ï¼åªè¦èªè¡æ¶è´¹ MQ åå¤çå³å¯ï¼ç¨æ·æ éå³æ³¨ã\n\n\n\n\n# ç³»ç»è§£è¦\n\n> éè¿ MQï¼å¯ä»¥æ¶é¤ç³»ç»é´çå¼ºè¦åãå®çå¥½å¤å¨äºï¼\n> \n>  * æ¶æ¯çæ¶è´¹èç³»ç»å¯ä»¥éæå¢å ï¼æ éä¿®æ¹çäº§èç³»ç»çä»£ç ã\n>  * çäº§èç³»ç»ãæ¶è´¹èç³»ç»å½¼æ­¤ä¸ä¼å½±åå¯¹æ¹çæµç¨ã\n>    * å¦æçäº§èç³»ç»å®æºï¼æ¶è´¹èç³»ç»æ¶ä¸å°æ¶æ¯ï¼å°±ä¸ä¼æä¸ä¸æ­¥çå¨ä½ã\n>    * å¦ææ¶è´¹èç³»ç»å®æºï¼çäº§èç³»ç»è®©ç¶å¯ä»¥æ­£å¸¸åéæ¶æ¯ï¼ä¸å½±åæµç¨ã\n\nä¸åç³»ç»å¦æè¦å»ºç«éä¿¡ï¼ä¼ ç»çåæ³æ¯ï¼è°ç¨æ¥å£ã\n\nå¦æéè¦åæ°çç³»ç»å»ºç«éä¿¡æå é¤å·²å»ºç«çéä¿¡ï¼é½éè¦ä¿®æ¹ä»£ç ï¼è¿ç§æ¹æ¡æ¾ç¶è¦ååº¦å¾é«ã\n\n\n\nå¦æä½¿ç¨ MQï¼ç³»ç»é´çéä¿¡åªéè¦éè¿åå¸/è®¢éï¼Pub/Subï¼æ¨¡åå³å¯ï¼å½¼æ­¤æ²¡æç´æ¥èç³»ï¼ä¹å°±ä¸éè¦ç¸äºæç¥ï¼ä»èè¾¾å° è§£è¦ã\n\n\n\n\n# æµéåå³°\n\n> å½ ä¸ä¸æ¸¸ç³»ç» å¤çè½åå­å¨å·®è·çæ¶åï¼å©ç¨ MQ åä¸ä¸ª âæ¼æâ æ¨¡åï¼è¿è¡ æµæ§ãæ MQ å½æå¯é ç æ¶æ¯æå­å°ï¼è¿è¡ä¸å®ç¨åº¦ç æ¶æ¯å ç§¯ï¼å¨ä¸æ¸¸æè½åå¤ççæ¶åï¼ååéæ¶æ¯ã\n> \n> MQ çæµéåå³°å¸¸ç¨äºé«å¹¶ååºæ¯ï¼ä¾å¦ï¼ç§æãå¢æ¢ç­ä¸å¡åºæ¯ï¼ï¼å®æ¯ç¼è§£ç¬æ¶æ´å¢æµéçæ ¸å¿ææ®µä¹ä¸ã\n> \n> å¦ææ²¡æ MQï¼ä¸¤ä¸ªç³»ç»ä¹é´éè¿ ååãæ»å¨çªå£ãéæµ/éçº§/çæ­ ç­å¤æçæ¹æ¡ä¹è½å®ç° æµæ§ãä½ ç³»ç»å¤ææ§ ææ°çº§å¢é¿ï¼å¿å¿å¨ä¸æ¸¸æèä¸æ¸¸åå­å¨ï¼å¹¶ä¸è¦å¤ç å®æ¶ãæ¥å¡ ç­ä¸ç³»åé®é¢ãèä¸æ¯å½æ å¤çè½åæå·®è· çæ¶åï¼é½éè¦ åç¬ å¼åä¸å¥é»è¾æ¥ç»´æ¤è¿å¥é»è¾ã\n\nåè®¾æä¸ªç³»ç»è¯»åæ°æ®åºçç¨³å®æ§è½ä¸ºæ¯ç§å¤ç 1000 æ¡æ°æ®ãå¹³å¸¸æåµä¸ï¼è¿è¿è¾¾ä¸å°è¿ä¹å¤§çå¤çéãåè®¾ï¼å ä¸ºå ä¸ºåæ´»å¨ï¼ç³»ç»çç¬æ¶è¯·æ±éå§å¢ï¼è¾¾å°æ¯ç§ 10000 ä¸ªå¹¶åè¯·æ±ï¼æ°æ®åºæ ¹æ¬æ¿åä¸äºï¼å¯è½ç´æ¥å°±ææ°æ®åºç»æ´å´©æºäºï¼è¿æ ·ç³»ç»æå¡å°±ä¸å¯ç¨äºã\n\n\n\nå¦æä½¿ç¨ MQï¼æ¯ç§åå¥ 10000 æ¡è¯·æ±ï¼ä½æ¯ç³»ç» A æ¯ç§åªä» MQ ä¸­æ¶è´¹ 1000 æ¡è¯·æ±ï¼ç¶ååå¥æ°æ®åºãè¿æ ·ï¼å°±ä¸ä¼è¶è¿æ°æ®åºçæ¿åè½åï¼èæ¯æè¯·æ±ç§¯åå¨ MQ ä¸­ãåªè¦é«å³°æä¸è¿ï¼ç³»ç» A å°±ä¼å¾å¿«æç§¯åçæ¶æ¯ç»å¤çæã\n\n\n\n\n# ä¼ è¾ç¼å²\n\nï¼1ï¼MQ å¸¸è¢«ç¨äºåæµ·éæ°æ®çä¼ è¾ç¼å²ã\n\nä¾å¦ï¼Kafka å¸¸è¢«ç¨äºåä¸ºåç§æ¥å¿æ°æ®ãééæ°æ®çæ°æ®ä¸­è½¬ãç¶åï¼Kafka å°æ°æ®è½¬åç» LogstashãElasticsearch ä¸­ï¼ç¶ååºäº Elasticsearch æ¥åæ¥å¿ä¸­å¿ï¼æä¾æ£ç´¢ãèåãåææ¥å¿çè½åãå¼åèå¯ä»¥éè¿ Kibana éæ Elasticsearch æ°æ®è¿è¡å¯è§åå±ç¤ºï¼æèªè¡è¿è¡å®å¶åå¼åã\n\n\n\nï¼2ï¼MQ ä¹å¯ä»¥è¢«ç¨äºæµå¼å¤çã\n\nä¾å¦ï¼Kafka å ä¹å·²ç»æ¯æµè®¡ç®çæ°æ®ééç«¯çæ åç»ä»¶ãèæµè®¡ç®éè¿å®æ¶æ°æ®å¤çè½åï¼æä¾äºæ´ä¸ºå¿«æ·çèåè®¡ç®è½åï¼è¢«å¤§éåºç¨äºé¾è·¯çæ§ãå®æ¶çæ§ãå®æ¶æ°ä»ãå®æ¶å¤§å±ãé£æ§ãæ¨èç­åºç¨é¢åã\n\n\n# æç»ä¸è´æ§\n\næç»ä¸è´æ§ ä¸æ¯ æ¶æ¯éå çå¿å¤ç¹æ§ï¼ä½ç¡®å®å¯ä»¥ä¾é  æ¶æ¯éå æ¥å æç»ä¸è´æ§ çäºæã\n\n * ååæ¶æ¯åæä½ï¼ç¡®ä¿æä½å®æååä¿®æ¹æ¶æ¯ç¶æãå®æ¶ä»»å¡è¡¥å¿æºå¶ å®ç°æ¶æ¯ å¯é åéæ¥æ¶ãä¸å¡æä½çå¯é æ§è¡ï¼è¦æ³¨æ æ¶æ¯éå¤ ä¸ å¹ç­è®¾è®¡ã\n * ææä¸ä¿è¯ 100% ä¸ä¸¢æ¶æ¯ çæ¶æ¯éåï¼çè®ºä¸æ æ³å®ç° æç»ä¸è´æ§ã\n\n> å Kafka ä¸ç±»çè®¾è®¡ï¼å¨è®¾è®¡å±é¢ä¸å°±æ ä¸¢æ¶æ¯ çå¯è½ï¼æ¯å¦ å®æ¶å·çï¼å¦ææçµå°±ä¼ä¸¢æ¶æ¯ï¼ãåªæåªä¸¢ååä¹ä¸çæ¶æ¯ï¼ä¸å¡ä¹å¿é¡»ç¨å¶ä»çææ®µæ¥ä¿è¯ç»ææ­£ç¡®ã\n\n\n# ç³»ç»é´éä¿¡\n\næ¶æ¯éåä¸è¬é½åç½®äº é«æçéä¿¡æºå¶ï¼å æ­¤ä¹å¯ä»¥ç¨äºåçº¯ç æ¶æ¯éè®¯ï¼æ¯å¦å®ç° ç¹å¯¹ç¹æ¶æ¯éå æè èå¤©å®¤ ç­ã\n\nçäº§è/æ¶è´¹è æ¨¡å¼ï¼åªéè¦å³å¿æ¶æ¯æ¯å¦ éè¾¾éåï¼è³äºè°å¸æè®¢éåéè¦æ¶è´¹ï¼æ¯ ä¸æ¸¸ çäºæï¼æ çæå¤§å°åå°äºå¼ååèè°çå·¥ä½éã\n\n\n# MQ çé®é¢\n\nä»»ä½ææ¯é½ä¼æå©æå¼ï¼MQ ç»æ´ä½ç³»ç»æ¶æå¸¦æ¥å¾å¤å¥½å¤ï¼ä½ä¹ä¼ä»åºä¸å®çä»£ä»·ã\n\nMQ ä¸»è¦å¼å¥äºä»¥ä¸é®é¢ï¼\n\n * ç³»ç»å¯ç¨æ§éä½ï¼å¼å¥äº MQ åï¼éä¿¡éè¦åºäº MQ å®æï¼å¦æ MQ å®æºï¼åæå¡ä¸å¯ç¨ãå æ­¤ï¼MQ è¦ä¿è¯æ¯é«å¯ç¨çï¼è¯¦æåèï¼MQ çé«å¯ç¨\n * ç³»ç»å¤æåº¦æé«ï¼ä½¿ç¨ MQï¼éè¦å³æ³¨ä¸äºæ°çé®é¢ï¼\n   * å¦ä½ä¿è¯æ¶æ¯æ²¡æ éå¤æ¶è´¹ï¼\n   * å¦ä½å¤ç æ¶æ¯ä¸¢å¤± çé®é¢ï¼\n   * å¦ä½ä¿è¯ä¼ é æ¶æ¯çé¡ºåºæ§ï¼\n   * å¦ä½å¤çå¤§é æ¶æ¯ç§¯å çé®é¢ï¼\n * ä¸è´æ§é®é¢ï¼åè®¾ç³»ç» A å¤çå®ç´æ¥è¿åæåçç»æç»ç¨æ·ï¼ç¨æ·è®¤ä¸ºè¯·æ±æåãä½å¦ææ­¤æ¶ï¼ç³»ç» BCD ä¸­åªè¦æä»»æä¸ä¸ªååºå¤±è´¥ï¼é£ä¹æ°æ®å°±ä¸ä¸è´äºãè¿ç§æåµå¦ä½å¤çï¼\n\nä¸é¢ï¼æä»¬éå¯¹ä»¥ä¸é®é¢æ¥ä¸ä¸åæã\n\n\n# éå¤æ¶è´¹\n\nå¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ å å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ æ¯åä¸ä¸ªé®é¢ã\n\nå¿é¡»åæç¡®äº§çéå¤æ¶è´¹çåå ï¼æè½å¯¹çä¸è¯ã\n\n# éå¤æ¶è´¹é®é¢åå \n\néå¤æ¶è´¹é®é¢éå¸¸ä¸æ¯ MQ æ¥å¤çï¼èæ¯ç±å¼åæ¥å¤ççã\n\nä»¥ Kafka ä¸¾ä¾ï¼Kafka æ¯ä¸ª Partition é½æ¯ä¸ä¸ªæåºçãä¸å¯åçè®°å½åºåï¼ä¸æ­è¿½å å°ç»æåçæäº¤æ¥å¿ä¸­ãPartition ä¸­ä¸ºæ¯æ¡è®°å½åéä¸ä¸ªè¿ç»­ç id å·ï¼ç§°ä¸ºåç§»éï¼Offsetï¼ï¼ç¨äºå¯ä¸æ è¯ Partition åçè®°å½ã\n\nKafka çå®¢æ·ç«¯å Broker é½ä¼ä¿å­ Offsetãå®¢æ·ç«¯æ¶è´¹æ¶æ¯åï¼æ¯éä¸æ®µæ¶é´ï¼å°±æå·²æ¶è´¹ç Offset æäº¤ç» Kafka Brokerï¼è¡¨ç¤ºå·²æ¶è´¹ã\n\n\n\nå¨è¿ä¸ªè¿ç¨ä¸­ï¼å¦æå®¢æ·ç«¯åºç¨æ¶è´¹æ¶æ¯åï¼å ä¸ºå®æºãéå¯ç­æåµèæ²¡ææäº¤å·²æ¶è´¹ç Offset ãå½ç³»ç»æ¢å¤åï¼ä¼ç»§ç»­æ¶è´¹æ¶æ¯ï¼ç±äº Offset æªæäº¤ï¼å°±ä¼åºç°éå¤æ¶è´¹çé®é¢ã\n\n# éå¤æ¶è´¹è§£å³æ¹æ¡\n\nåºå¯¹éå¤æ¶è´¹é®é¢ï¼éè¦å¨ä¸å¡å±é¢ï¼éè¿ å¹ç­æ§è®¾è®¡ æ¥è§£å³ã\n\nMQ éå¤æ¶è´¹ä¸å¯æï¼å¯æçæ¯æ²¡æåºå¯¹æºå¶ï¼å¯ä»¥åé´çæè·¯æï¼\n\n * å¦ææ¯åå³ç³»åæ°æ®åºï¼å¯ä»¥åæ ¹æ®ä¸»é®æ¥è¯¢ï¼å¤æ­æ°æ®æ¯å¦å·²å­å¨ï¼å­å¨åæ´æ°ï¼ä¸å­å¨åæå¥ï¼\n * å¦ææ¯å Redisï¼ç±äº set æä½å¤©ç¶å·æå¹ç­æ§ï¼æä»¥ä»ä¹é½ä¸ç¨åï¼\n * å¦ææ¯æ ¹æ®æ¶æ¯åè¾å¤æçé»è¾å¤çï¼å¯ä»¥å¨æ¶æ¯ä¸­å å¥å¨å±å¯ä¸ IDï¼ä¾å¦ï¼è®¢å ID ç­ãå¨å®¢æ·ç«¯å­å¨ä¸­ï¼MysqlãRedis ç­ï¼ä¿å­å·²æ¶è´¹æ¶æ¯ç IDãä¸æ¦æ¥åå°æ°æ¶æ¯ï¼åå¤æ­æ¶æ¯ä¸­ç ID æ¯å¦å¨å·²æ¶è´¹æ¶æ¯ ID è¡¨ä¸­å­å¨ï¼å­å¨åä¸åå¤çï¼ä¸å­å¨åå¤çã\n\nå¨å®éå¼åä¸­ï¼å¯ä»¥åèä¸é¢çä¾å­ï¼ç»åç°å®åºæ¯ï¼è®¾è®¡åççå¹ç­æ§æ¹æ¡ã\n\n\n# æ¶æ¯ä¸¢å¤±\n\nå¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ å å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ æ¯åä¸ä¸ªé®é¢ãå³æ³¨ç¹æï¼\n\n * MQ Server ä¸¢å¤±æ°æ®\n * æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n * çäº§æ¹ä¸¢å¤±æ°æ®\n\n# æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n\nå¯ä¸å¯è½å¯¼è´æ¶è´¹æ¹ä¸¢å¤±æ°æ®çæåµæ¯ï¼æ¶è´¹æ¹è®¾ç½®äºèªå¨æäº¤ Offsetãä¸æ¦è®¾ç½®äºèªå¨æäº¤ Offsetï¼æ¥åå°æ¶æ¯åå°±ä¼èªå¨æäº¤ Offset ç» Kafka ï¼Kafka å°±è®¤ä¸ºæ¶æ¯å·²è¢«æ¶è´¹ãå¦ææ­¤æ¶ï¼æ¶è´¹æ¹å°æªæ¥å¾åå¤çæ¶æ¯å°±æäºï¼é£ä¹æ¶æ¯å°±ä¸¢äºã\n\nè§£å³æ¹æ³å°±æ¯ï¼æ¶è´¹æ¹å³é­èªå¨æäº¤ Offsetï¼å¤çå®æ¶æ¯åæå¨æäº¤ Offsetãä½è¿ç§æåµä¸å¯è½ä¼åºç°éå¤æ¶è´¹çæå½¢ï¼éè¦èªè¡ä¿è¯å¹ç­æ§ã\n\n# Kafka Server ä¸¢å¤±æ°æ®\n\nå½ Kafka æä¸ª Broker å®æºï¼éè¦éæ°éä¸¾ Partition ç Leaderãè¥æ­¤æ¶å¶ä»ç Follower å°æªåæ­¥ Leader çæ°æ®ï¼é£ä¹æ°éæä¸ª Follower ä¸º Leader åï¼å°±ä¸¢å¤±äºé¨åæ°æ®ã\n\nä¸ºæ­¤ï¼ä¸è¬è¦æ±è³å°è®¾ç½® 4 ä¸ªåæ°ï¼\n\n * ç» Topic è®¾ç½® replication.factor åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¦æ±æ¯ä¸ª Partition å¿é¡»æè³å° 2 ä¸ªå¯æ¬ã\n * å¨ Kafka æå¡ç«¯è®¾ç½® min.insync.replicas åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¿æ¯è¦æ±ä¸ä¸ª Leader éè¦åè³å°ä¸ä¸ª Follower ä¿æéä¿¡ï¼è¿æ ·æè½ç¡®ä¿ Leader æäºè¿ææ¿è¡¥ã\n * å¨ Producer ç«¯è®¾ç½® acks=all - è¿æå³çï¼è¦æ±æ¯æ¡æ°æ®ï¼å¿é¡»æ¯åå¥ææ replica ä¹åï¼æè½è®¤ä¸ºåå¥æåäºã\n * å¨ Producer ç«¯è®¾ç½® retries=MAXï¼å¾å¤§å¾å¤§å¾å¤§çä¸ä¸ªå¼ï¼æ éæ¬¡éè¯çææï¼ - è¿æå³çè¦æ±ä¸æ¦åå¥å¤±è´¥ï¼å°±æ ééè¯ï¼å¡å¨è¿éäºã\n\n# çäº§æ¹ä¸¢å¤±æ°æ®\n\nå¦ææç§ä¸è¿°çæè·¯è®¾ç½®äº acks=allï¼çäº§æ¹ä¸å®ä¸ä¼ä¸¢æ°æ®ã\n\nè¦æ±æ¯ï¼ä½ ç Leader æ¥æ¶å°æ¶æ¯ï¼ææç Follower é½åæ­¥å°äºæ¶æ¯ä¹åï¼æè®¤ä¸ºæ¬çäº§æ¶æ¯æåäºãå¦ææªæ»¡è¶³è¿ä¸ªæ¡ä»¶ï¼çäº§èä¼èªå¨ä¸æ­çéè¯ï¼éè¯æ éæ¬¡ã\n\n\n# æ¶æ¯çé¡ºåºæ§\n\nè¦ä¿è¯ MQ çé¡ºåºæ§ï¼å¿å¿è¦ä»åºä¸å®çä»£ä»·ï¼æä»¥å®æ½æ¹æ¡åï¼è¦åæç¡®ä¸å¡åºæ¯æ¯ä¸æ¯æå¿è¦ä¿è¯æ¶æ¯çé¡ºåºæ§ãåªæé£äºæç¡®å¯¹æ¶æ¯å¤çé¡ºåºæè¦æ±çä¸å¡åºæ¯æå¼å¾å»ä¿è¯æ¶æ¯é¡ºåºæ§ã\n\næ¹æ¡ä¸\n\nä¸ä¸ª Topicï¼ä¸ä¸ª Partitionï¼ä¸ä¸ª Consumerï¼åé¨åçº¿ç¨æ¶è´¹ï¼åçº¿ç¨ååéå¤ªä½ï¼ä¸è¬ä¸ä¼ç¨è¿ä¸ªã\n\næ¹æ¡äº\n\n * åå¥æ°æ®å° Partition æ¶æå®ä¸ä¸ªå¨å±å¯ä¸ç IDï¼ä¾å¦è®¢å IDãåéæ¹ä¿è¯ç¸å ID çæ¶æ¯æåºçåéå°åä¸ä¸ª Partitionã\n * åºäºä¸ä¸ç¹ï¼æ¶è´¹æ¹ä» Kafka Partition ä¸­æ¶è´¹æ¶æ¯æ¶ï¼æ­¤å»ä¸å®æ¯é¡ºåºçãä½å¦ææ¶è´¹æ¹å¼ä»¥å¹¶åæ¹å¼æ¶è´¹æ¶æ¯ï¼é¡ºåºå°±å¯è½ä¼è¢«æä¹±ãä¸ºæ­¤ï¼è¿æåå°ä»¥ä¸å ç¹ï¼\n   * æ¶è´¹æ¹ç»´æ¤ N ä¸ªç¼å­éåï¼å·æç¸å ID çæ°æ®é½åå¥åä¸ä¸ªéåä¸­ï¼\n   * åå»º N ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨åªè´è´£ä»æå®çä¸ä¸ªéåä¸­åæ°æ®ã\n\n\n\n\n# æ¶æ¯ç§¯å\n\nåè®¾ä¸ä¸ª MQ æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 1000 æ¡æ¶æ¯ï¼ä¸ä¸ª MQ æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 3000 æ¡æ¶æ¯ï¼é£ä¹ä¸åéçå¤çéæ¯ 18 ä¸æ¡ãå¦æ MQ ä¸­ç§¯åäºå ç¾ä¸å°ä¸åä¸çæ°æ®ï¼å³ä½¿æ¶è´¹èæ¢å¤äºï¼ä¹éè¦å¤§æ¦å¾é¿çæ¶é´æè½æ¢å¤è¿æ¥ã\n\nå¯¹äºäº§çº¿ç¯å¢æ¥è¯´ï¼æ¼«é¿çç­å¾æ¯ä¸å¯æ¥åçï¼æä»¥é¢ä¸´è¿ç§çªå¢æ¶ï¼åªè½ä¸´æ¶ç´§æ¥æ©å®¹ä»¥åºå¯¹äºï¼å·ä½æä½æ­¥éª¤åæè·¯å¦ä¸ï¼\n\n * åä¿®å¤ Consumer çé®é¢ï¼ç¡®ä¿å¶æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå°ç°æ Consumer é½åæã\n * æ°å»ºä¸ä¸ª Topicï¼Partition æ¯åæ¥ç 10 åï¼ä¸´æ¶å»ºç«å¥½åå 10 åç Queue æ°éã\n * ç¶ååä¸ä¸ªä¸´æ¶çååæ°æ®ç Consumer ç¨åºï¼è¿ä¸ªç¨åºé¨ç½²ä¸å»æ¶è´¹ç§¯åçæ°æ®ï¼æ¶è´¹ä¹åä¸åèæ¶çå¤çï¼ç´æ¥ååè½®è¯¢åå¥ä¸´æ¶å»ºç«å¥½ç 10 åæ°éç Queueã\n * æ¥çä¸´æ¶å¾ç¨ 10 åçæºå¨æ¥é¨ç½² Consumer ï¼æ¯ä¸æ¹ Consumer æ¶è´¹ä¸ä¸ªä¸´æ¶ Queue çæ°æ®ãè¿ç§åæ³ç¸å½äºæ¯ä¸´æ¶å° Queue èµæºå Consumer èµæºæ©å¤§ 10 åï¼ä»¥æ­£å¸¸ç 10 åéåº¦æ¥æ¶è´¹æ°æ®ã\n * ç­å¿«éæ¶è´¹å®ç§¯åæ°æ®ä¹åï¼å¾æ¢å¤ååé¨ç½²çæ¶æï¼éæ°ç¨ååç consumer æºå¨æ¥æ¶è´¹æ¶æ¯ã\n\n\n# MQ çé«å¯ç¨\n\nä¸å MQ å®ç°é«å¯ç¨çåçåä¸ç¸åãå ä¸º Kafka æ¯è¾å·æä»£è¡¨æ§ï¼æä»¥è¿éä»¥ Kafka ä¸ºä¾ã\n\n\n# Kafka çé«å¯ç¨\n\n# Kafka çæ ¸å¿æ¦å¿µ\n\näºè§£ Kafkaï¼å¿é¡»åäºè§£ Kafka çæ ¸å¿æ¦å¿µï¼\n\n * Broker - Kafka éç¾¤åå«ä¸ä¸ªæå¤ä¸ªèç¹ï¼è¿ç§èç¹è¢«ç§°ä¸º Brokerã\n\n * Topic - æ¯æ¡åå¸å° Kafka éç¾¤çæ¶æ¯é½æä¸ä¸ªç±»å«ï¼è¿ä¸ªç±»å«è¢«ç§°ä¸º Topicãï¼ä¸å Topic çæ¶æ¯æ¯ç©çéç¦»çï¼åä¸ä¸ª Topic çæ¶æ¯ä¿å­å¨ä¸ä¸ªæå¤ä¸ª Broker ä¸ï¼ä½ç¨æ·åªéæå®æ¶æ¯ç Topic å³å¯çäº§ææ¶è´¹æ°æ®èä¸å¿å³å¿æ°æ®å­äºä½å¤ï¼ãå¯¹äºæ¯ä¸ä¸ª Topicï¼ Kafka éç¾¤é½ä¼ç»´æä¸ä¸ªååºæ¥å¿ã\n\n * Partition - äºæé« Kafka çååçï¼æ¯ä¸ª Topic åå«ä¸ä¸ªæå¤ä¸ª Partitionï¼æ¯ä¸ª Partition å¨ç©çä¸å¯¹åºä¸ä¸ªæä»¶å¤¹ï¼è¯¥æä»¶å¤¹ä¸å­å¨è¿ä¸ª Partition çæææ¶æ¯åç´¢å¼æä»¶ã\n   \n   * Kafka æ¥å¿çååºï¼Partitionï¼åå¸å¨ Kafka éç¾¤çèç¹ä¸ãæ¯ä¸ªèç¹å¨å¤çæ°æ®åè¯·æ±æ¶ï¼å±äº«è¿äºååºãæ¯ä¸ä¸ªååºé½ä¼å¨å·²éç½®çèç¹ä¸è¿è¡å¤ä»½ï¼ç¡®ä¿å®¹éæ§ã\n\n\n\n# Kafka çå¯æ¬æºå¶\n\nKafka æ¯å¦ä½å®ç°é«å¯ç¨çå¢ï¼\n\nKafka å¨ 0.8 ä»¥åççæ¬ä¸­ï¼å¦æä¸ä¸ª Broker å®æºäºï¼å¶ä¸é¢ç Partition é½ä¸è½ç¨äºï¼è¿èªç¶ä¸æ¯é«å¯ç¨çã\n\nä¸ºäºå®ç°é«å¯ç¨ï¼Kafka å¼å¥äºå¤å¶åè½ã\n\nç®åæ¥è¯´ï¼å°±æ¯å¯æ¬æºå¶ï¼ Replicate ï¼ã\n\næ¯ä¸ª Partition é½æä¸ä¸ª Leaderï¼é¶ä¸ªæå¤ä¸ª FollowerãLeader å Follower é½æ¯ Brokerï¼æ¯ä¸ª Broker é½ä¼æä¸ºæäºååºç Leader åæäºååºç Followerï¼å æ­¤éç¾¤çè´è½½æ¯å¹³è¡¡çã\n\n * Leader å¤çä¸åå¯¹ Partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n * è Follower åªéè¢«å¨çåæ­¥ Leader ä¸çæ°æ®ã\n\nåä¸ä¸ª Topic çä¸å Partition ä¼åå¸å¨å¤ä¸ª Broker ä¸ï¼èä¸ä¸ä¸ª Partition è¿ä¼å¨å¶ä»ç Broker ä¸é¢è¿è¡å¤ä»½ï¼Producer å¨åå¸æ¶æ¯å°æä¸ª Partition æ¶ï¼åæ¾å°è¯¥ Partition ç Leaderï¼ç¶ååè¿ä¸ª Leader æ¨éæ¶æ¯ï¼æ¯ä¸ª Follower é½ä» Leader æåæ¶æ¯ï¼æåæ¶æ¯æåä¹åï¼å Leader åéä¸ä¸ª ACK ç¡®è®¤ã\n\n\n\n> FAQ\n> \n> é®ï¼ä¸ºä»ä¹è®© Leader å¤çä¸åå¯¹å¯¹ Partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n> \n> ç­ï¼å ä¸ºå¦æåè®¸ææ Broker é½å¯ä»¥å¤çè¯»åè¯·æ±ï¼å°±å¯è½äº§çæ°æ®ä¸è´æ§é®é¢ã\n\n# Kafka éä¸¾ Leader\n\nç±ä¸æå¯ç¥ï¼Partition å¨å¤ä¸ª Broker ä¸å­å¨å¯æ¬ã\n\nå¦ææä¸ª Follower å®æºï¼å¥äºå¿æ²¡æï¼æ­£å¸¸å·¥ä½ã\n\nå¦æ Leader å®æºäºï¼ä¼ä» Follower ä¸­éæ°éä¸¾ä¸ä¸ªæ°ç Leaderã\n\n\n# ä¸»æµ MQ\n\n\n# ActiveMQ\n\nActiveMQ æ¯ç± Apache åºåï¼ActiveMQ æ¯ä¸ä¸ªå®å¨æ¯æJMS1.1 å J2EE 1.4 è§èç JMS Provider å®ç°ãå®éå¸¸å¿«éï¼æ¯æ å¤ç§è¯­è¨çå®¢æ·ç«¯ å åè®®ï¼èä¸å¯ä»¥éå¸¸å®¹æçåµå¥å°ä¼ä¸çåºç¨ç¯å¢ä¸­ï¼å¹¶æè®¸å¤é«çº§åè½ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. æä» JMS è§èï¼JMS è§èæä¾äºè¯å¥½çæ ååä¿è¯ï¼åæ¬ï¼åæ­¥ æ å¼æ­¥ çæ¶æ¯ååï¼ä¸æ¬¡åä»ä¸æ¬¡çæ¶æ¯ååï¼æ¶æ¯æ¥æ¶ å è®¢é ç­ç­ãéµä» JMS è§èçå¥½å¤å¨äºï¼ä¸è®ºä½¿ç¨ä»ä¹ JMS å®ç°æä¾èï¼è¿äºåºç¡ç¹æ§é½æ¯å¯ç¨çï¼\n 2. è¿æ¥çµæ´»æ§ï¼ActiveMQ æä¾äºå¹¿æ³ç è¿æ¥åè®®ï¼æ¯æçåè®®æï¼HTTP/Sï¼IP å¤æ­ï¼SSLï¼TCPï¼UDP ç­ç­ãå¯¹ä¼å¤åè®®çæ¯æè®© ActiveMQ æ¥æäºå¾å¥½ççµæ´»æ§ï¼\n 3. æ¯æçåè®®ç§ç±»å¤ï¼OpenWireãSTOMPãRESTãXMPPãAMQPï¼\n 4. æä¹åæä»¶åå®å¨æä»¶ï¼ActiveMQ æä¾äº å¤ç§æä¹å éæ©ãèä¸ï¼ActiveMQ çå®å¨æ§ä¹å¯ä»¥å®å¨ä¾æ®ç¨æ·éæ±è¿è¡ èªå®ä¹é´æ å ææï¼\n 5. æ¯æçå®¢æ·ç«¯è¯­è¨ç§ç±»å¤ï¼é¤äº Java ä¹å¤ï¼è¿æï¼C/C++ï¼.NETï¼Perlï¼PHPï¼Pythonï¼Rubyï¼\n 6. ä»£çéç¾¤ï¼å¤ä¸ª ActiveMQ ä»£ç å¯ä»¥ç»æä¸ä¸ª éç¾¤ æ¥æä¾æå¡ï¼\n 7. å¼å¸¸ç®åçç®¡çï¼ActiveMQ æ¯ä»¥å¼åèæç»´è¢«è®¾è®¡çãæä»¥ï¼å®å¹¶ä¸éè¦ä¸é¨çç®¡çåï¼å ä¸ºå®æä¾äºç®ååä½¿ç¨çç®¡çç¹æ§ãæå¾å¤ä¸­æ¹æ³å¯ä»¥ çæ§ ActiveMQ ä¸åå±é¢çæ°æ®ï¼åæ¬ä½¿ç¨å¨ JConsole æèå¨ ActiveMQ ç Web Console ä¸­ä½¿ç¨ JMXãéè¿å¤ç JMX çåè­¦æ¶æ¯ï¼éè¿ä½¿ç¨ å½ä»¤è¡èæ¬ï¼çè³å¯ä»¥éè¿çæ§åç§ç±»åç æ¥å¿ã\n\n# (b) é¨ç½²ç¯å¢\n\nActiveMQ å¯ä»¥è¿è¡å¨ Java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ ActiveMQ éè¦ï¼\n\n * Java JDK\n * ActiveMQ å®è£å\n\n# (c) ä¼ç¹\n\n 1. è·¨å¹³å° (JAVA ç¼åä¸å¹³å°æ å³ï¼ActiveMQ å ä¹å¯ä»¥è¿è¡å¨ä»»ä½ç JVM ä¸)ï¼\n 2. å¯ä»¥ç¨ JDBCï¼å¯ä»¥å° æ°æ®æä¹å å°æ°æ®åºãè½ç¶ä½¿ç¨ JDBC ä¼éä½ ActiveMQ çæ§è½ï¼ä½æ¯æ°æ®åºä¸ç´é½æ¯å¼åäººåæçæçå­å¨ä»è´¨ï¼\n 3. æ¯æ JMS è§èï¼æ¯æ JMS è§èæä¾ç ç»ä¸æ¥å£;\n 4. æ¯æ èªå¨éè¿ å éè¯¯éè¯æºå¶ï¼\n 5. æå®å¨æºå¶ï¼æ¯æåºäº shiroï¼jaas ç­å¤ç§ å®å¨éç½®æºå¶ï¼å¯ä»¥å¯¹ Queue/Topic è¿è¡ è®¤è¯åææï¼\n 6. çæ§å®åï¼æ¥æå®åç çæ§ï¼åæ¬ Web Consoleï¼JMXï¼Shell å½ä»¤è¡ï¼Jolokia ç RESTful APIï¼\n 7. çé¢ååï¼æä¾ç Web Console å¯ä»¥æ»¡è¶³å¤§é¨åæåµï¼è¿æå¾å¤ ç¬¬ä¸æ¹çç»ä»¶ å¯ä»¥ä½¿ç¨ï¼æ¯å¦ hawtioï¼\n\n# (d) ç¼ºç¹\n\n 1. ç¤¾åºæ´»è·åº¦ä¸å RabbitMQ é«ï¼\n 2. æ ¹æ®å¶ä»ç¨æ·åé¦ï¼ä¼åºè«åå¶å¦çé®é¢ï¼ä¼ ä¸¢å¤±æ¶æ¯ï¼\n 3. ç®åéå¿æ¾å° activemq 6.0 äº§å Apolloï¼å¯¹ 5.x çç»´æ¤è¾å°ï¼\n 4. ä¸éåç¨äº ä¸åä¸ªéå çåºç¨åºæ¯ï¼\n\n\n# RabbitMQ\n\nRabbitMQ äº 2007 å¹´åå¸ï¼æ¯ä¸ä¸ªå¨ AMQP (é«çº§æ¶æ¯éååè®®)åºç¡ä¸å®æçï¼å¯å¤ç¨çä¼ä¸æ¶æ¯ç³»ç»ï¼æ¯å½åæä¸»æµçæ¶æ¯ä¸­é´ä»¶ä¹ä¸ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¯é æ§ï¼æä¾äºå¤ç§ææ¯å¯ä»¥è®©ä½ å¨ æ§è½ å å¯é æ§ ä¹é´è¿è¡ æè¡¡ãè¿äºææ¯åæ¬ æä¹æ§æºå¶ãæéç¡®è®¤ãåå¸èè¯å® å é«å¯ç¨æ§æºå¶ï¼\n 2. çµæ´»çè·¯ç±ï¼æ¶æ¯å¨å°è¾¾éååæ¯éè¿ äº¤æ¢æº è¿è¡ è·¯ç± çãRabbitMQ ä¸ºå¸åçè·¯ç±é»è¾æä¾äº å¤ç§åç½®äº¤æ¢æº ç±»åãå¦æä½ ææ´å¤æçè·¯ç±éæ±ï¼å¯ä»¥å°è¿äºäº¤æ¢æºç»åèµ·æ¥ä½¿ç¨ï¼ä½ çè³å¯ä»¥å®ç°èªå·±çäº¤æ¢æºç±»åï¼å¹¶ä¸å½å RabbitMQ ç æä»¶ æ¥ä½¿ç¨ï¼\n 3. æ¶æ¯éç¾¤ï¼å¨ç¸åå±åç½ä¸­çå¤ä¸ª RabbitMQ æå¡å¨å¯ä»¥ èå å¨ä¸èµ·ï¼ä½ä¸ºä¸ä¸ªç¬ç«çé»è¾ä»£çæ¥ä½¿ç¨ï¼\n 4. éåé«å¯ç¨ï¼éåå¯ä»¥å¨éç¾¤ä¸­çæºå¨ä¸ è¿è¡éåï¼ä»¥ç¡®ä¿å¨ç¡¬ä»¶é®é¢ä¸è¿ä¿è¯ æ¶æ¯å®å¨ï¼\n 5. æ¯æå¤ç§åè®®ï¼æ¯æ å¤ç§æ¶æ¯éååè®®ï¼\n 6. æ¯æå¤ç§è¯­è¨ï¼ç¨ Erlang è¯­è¨ç¼åï¼æ¯æåªè¦æ¯ä½ è½æ³å°ç ææç¼ç¨è¯­è¨ï¼\n 7. ç®¡ççé¢ï¼ RabbitMQ æä¸ä¸ªæç¨ç ç¨æ·çé¢ï¼ä½¿å¾ç¨æ·å¯ä»¥ çæ§ å ç®¡ç æ¶æ¯ Broker çè®¸å¤æ¹é¢ï¼\n 8. è·è¸ªæºå¶ï¼å¦æ æ¶æ¯å¼å¸¸ï¼RabbitMQ æä¾æ¶æ¯è·è¸ªæºå¶ï¼ä½¿ç¨èå¯ä»¥æ¾åºåçäºä»ä¹ï¼\n 9. æä»¶æºå¶ï¼æä¾äºè®¸å¤ æä»¶ï¼æ¥ä»å¤æ¹é¢è¿è¡æ©å±ï¼ä¹å¯ä»¥ç¼åèªå·±çæä»¶ã\n\n# (b) é¨ç½²ç¯å¢\n\nRabbitMQ å¯ä»¥è¿è¡å¨ Erlang è¯­è¨ææ¯æçå¹³å°ä¹ä¸ï¼åæ¬ Solarisï¼BSDï¼Linuxï¼MacOSXï¼TRU64ï¼Windows ç­ãä½¿ç¨ RabbitMQ éè¦ï¼\n\n * ErLang è¯­è¨å\n * RabbitMQ å®è£å\n\n# (c) ä¼ç¹\n\n 1. ç±äº Erlang è¯­è¨çç¹æ§ï¼æ¶æ¯éåæ§è½è¾å¥½ï¼æ¯æ é«å¹¶åï¼\n 2. å¥å£®ãç¨³å®ãæç¨ãè·¨å¹³å°ãæ¯æ å¤ç§è¯­è¨ãææ¡£é½å¨ï¼\n 3. ææ¶æ¯ ç¡®è®¤æºå¶ å æä¹åæºå¶ï¼å¯é æ§é«ï¼\n 4. é«åº¦å¯å®å¶ç è·¯ç±ï¼\n 5. ç®¡ççé¢ è¾ä¸°å¯ï¼å¨äºèç½å¬å¸ä¹æè¾å¤§è§æ¨¡çåºç¨ï¼ç¤¾åºæ´»è·åº¦é«ã\n\n# (d) ç¼ºç¹\n\n 1. å°½ç®¡ç»å Erlang è¯­è¨æ¬èº«çå¹¶åä¼å¿ï¼æ§è½è¾å¥½ï¼ä½æ¯ä¸å©äºå äºæ¬¡å¼ååç»´æ¤ï¼\n 2. å®ç°äº ä»£çæ¶æï¼æå³çæ¶æ¯å¨åéå°å®¢æ·ç«¯ä¹åå¯ä»¥å¨ ä¸­å¤®èç¹ ä¸æéãæ­¤ç¹æ§ä½¿å¾ RabbitMQ æäºä½¿ç¨åé¨ç½²ï¼ä½æ¯ä½¿å¾å¶ è¿è¡éåº¦è¾æ¢ï¼å ä¸ºä¸­å¤®èç¹ å¢å äºå»¶è¿ï¼æ¶æ¯å°è£å ä¹æ¯è¾å¤§ï¼\n 3. éè¦å­¦ä¹  æ¯è¾å¤æ ç æ¥å£ååè®®ï¼å­¦ä¹ åç»´æ¤ææ¬è¾é«ã\n\n\n# RocketMQ\n\nRocketMQ åºèª é¿é çå¼æºäº§åï¼ç¨ Java è¯­è¨å®ç°ï¼å¨è®¾è®¡æ¶åèäº Kafkaï¼å¹¶ååºäºèªå·±çä¸äºæ¹è¿ï¼æ¶æ¯å¯é æ§ä¸ æ¯ Kafka æ´å¥½ãRocketMQ å¨é¿éåé¨ \b è¢«å¹¿æ³åºç¨å¨ è®¢åï¼äº¤æï¼åå¼ï¼æµè®¡ç®ï¼æ¶æ¯æ¨éï¼æ¥å¿æµå¼å¤çï¼binglog åå ç­åºæ¯ã\n\n# (a) ä¸»è¦ç¹æ§\n\n![img](data:image/svg+xml;utf8,)\n\n 1. åºäº éåæ¨¡åï¼å·æ é«æ§è½ãé«å¯é ãé«å®æ¶ãåå¸å¼ ç­ç¹ç¹ï¼\n 2. ProducerãConsumerãéå é½æ¯æ åå¸å¼ï¼\n 3. Producer åä¸äºéåè½®æµåéæ¶æ¯ï¼éåéå ç§°ä¸º TopicãConsumer å¦æå å¹¿æ­æ¶è´¹ï¼åä¸ä¸ª Consumer å®ä¾æ¶è´¹è¿ä¸ª Topic å¯¹åºç ææéåï¼å¦æå éç¾¤æ¶è´¹ï¼å å¤ä¸ª Consumer å®ä¾ å¹³åæ¶è´¹ è¿ä¸ª Topic å¯¹åºçéåéåï¼\n 4. è½å¤ä¿è¯ ä¸¥æ ¼çæ¶æ¯é¡ºåºï¼\n 5. æä¾ä¸°å¯ç æ¶æ¯æåæ¨¡å¼ï¼\n 6. é«æçè®¢éè æ°´å¹³æ©å±è½åï¼\n 7. å®æ¶ ç æ¶æ¯è®¢éæºå¶ï¼\n 8. äº¿çº§ æ¶æ¯å ç§¯ è½åï¼\n 9. è¾å°çå¤é¨ä¾èµã\n\n# (b) é¨ç½²ç¯å¢\n\nRocketMQ å¯ä»¥è¿è¡å¨ Java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ RocketMQ éè¦ï¼\n\n * Java JDK\n * å®è£ gitãMaven\n * RocketMQ å®è£å\n\n# (c) ä¼ç¹\n\n 1. åæº æ¯æ 1 ä¸ä»¥ä¸ æä¹åéåï¼\n 2. RocketMQ çæææ¶æ¯é½æ¯ æä¹åçï¼ååå¥ç³»ç» PAGECACHEï¼ç¶å å·çï¼å¯ä»¥ä¿è¯ åå­ ä¸ ç£ç é½æä¸ä»½æ°æ®ï¼è è®¿é® æ¶ï¼ç´æ¥ ä»åå­è¯»åã\n 3. æ¨¡åç®åï¼æ¥å£æç¨ï¼JMS çæ¥å£å¾å¤åºåå¹¶ä¸å¤ªå®ç¨ï¼ï¼\n 4. æ§è½éå¸¸å¥½ï¼å¯ä»¥åè®¸ å¤§éå ç§¯æ¶æ¯ å¨ Broker ä¸­ï¼\n 5. æ¯æ å¤ç§æ¶è´¹æ¨¡å¼ï¼åæ¬ éç¾¤æ¶è´¹ãå¹¿æ­æ¶è´¹ç­ï¼\n 6. åä¸ªç¯è åå¸å¼æ©å±è®¾è®¡ï¼æ¯æ ä¸»ä» å é«å¯ç¨ï¼\n 7. å¼ååº¦è¾æ´»è·ï¼çæ¬æ´æ°å¾å¿«ã\n\n# (d) ç¼ºç¹\n\n 1. æ¯æç å®¢æ·ç«¯è¯­è¨ ä¸å¤ï¼ç®åæ¯ Java å C++ï¼å¶ä¸­ C++ è¿ä¸æçï¼\n 2. RocketMQ ç¤¾åºå³æ³¨åº¦åæçåº¦ä¹ä¸ååä¸¤èï¼\n 3. æ²¡æ Web ç®¡ççé¢ï¼æä¾äºä¸ä¸ª CLI (å½ä»¤è¡çé¢) ç®¡çå·¥å·å¸¦æ¥ æ¥è¯¢ãç®¡ç å è¯æ­åç§é®é¢ï¼\n 4. æ²¡æå¨ MQ æ ¸å¿éå®ç° JMS ç­æ¥å£ï¼\n\n\n# Kafka\n\nApache Kafka æ¯ä¸ä¸ª åå¸å¼æ¶æ¯åå¸è®¢é ç³»ç»ãå®æåç± LinkedIn å¬å¸åºäºç¬ç¹çè®¾è®¡å®ç°ä¸ºä¸ä¸ª åå¸å¼çæ¥å¿æäº¤ç³»ç» (a distributed commit log)ï¼ä¹åæä¸º Apache é¡¹ç®çä¸é¨åãKafka æ§è½é«æãå¯æ©å±è¯å¥½ å¹¶ä¸ å¯æä¹åãå®ç ååºç¹æ§ï¼å¯å¤å¶ å å¯å®¹é é½æ¯å¶ä¸éçç¹æ§ã\n\n![img](data:image/svg+xml;utf8,)\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¿«éæä¹åï¼å¯ä»¥å¨ O(1) çç³»ç»å¼éä¸è¿è¡ æ¶æ¯æä¹åï¼\n 2. é«ååï¼å¨ä¸å°æ®éçæå¡å¨ä¸æ¢å¯ä»¥è¾¾å° 10W/s ç ååéçï¼\n 3. å®å¨çåå¸å¼ç³»ç»ï¼BrokerãProducer å Consumer é½åçèªå¨æ¯æ åå¸å¼ï¼èªå¨å®ç° è´è½½åè¡¡ï¼\n 4. æ¯æ åæ­¥ å å¼æ­¥ å¤å¶ä¸¤ç§ é«å¯ç¨æºå¶ï¼\n 5. æ¯æ æ°æ®æ¹éåé å æåï¼\n 6. é¶æ·è´ææ¯(zero-copy)ï¼åå° IO æä½æ­¥éª¤ï¼æé« ç³»ç»ååéï¼\n 7. æ°æ®è¿ç§»ãæ©å®¹ å¯¹ç¨æ·éæï¼\n 8. æ éåæº å³å¯æ©å±æºå¨ï¼\n 9. å¶ä»ç¹æ§ï¼ä¸°å¯ç æ¶æ¯æåæ¨¡åãé«æ è®¢éèæ°´å¹³æ©å±ãå®æ¶ç æ¶æ¯è®¢éãäº¿çº§ç æ¶æ¯å ç§¯è½åãå®æå é¤æºå¶ï¼\n\n# (b) é¨ç½²ç¯å¢\n\nä½¿ç¨ Kafka éè¦ï¼\n\n * Java JDK\n * Kafka å®è£å\n\n# (c) ä¼ç¹\n\n 1. å®¢æ·ç«¯è¯­è¨ä¸°å¯ï¼æ¯æ Javaã.NetãPHPãRubyãPythonãGo ç­å¤ç§è¯­è¨ï¼\n 2. é«æ§è½ï¼åæºåå¥ TPS çº¦å¨ 100 ä¸æ¡/ç§ï¼æ¶æ¯å¤§å° 10 ä¸ªå­èï¼\n 3. æä¾ å®å¨åå¸å¼æ¶æï¼å¹¶æ replica æºå¶ï¼æ¥æè¾é«ç å¯ç¨æ§ å å¯é æ§ï¼çè®ºä¸æ¯æ æ¶æ¯æ éå ç§¯ï¼\n 4. æ¯ææ¹éæä½ï¼\n 5. æ¶è´¹è éç¨ Pull æ¹å¼è·åæ¶æ¯ãæ¶æ¯æåºï¼éè¿æ§å¶ è½å¤ä¿è¯æææ¶æ¯è¢«æ¶è´¹ä¸ä»è¢«æ¶è´¹ ä¸æ¬¡ï¼\n 6. æä¼ç§çç¬¬ä¸æ¹ Kafka Web ç®¡ççé¢ Kafka-Managerï¼\n 7. å¨ æ¥å¿é¢å æ¯è¾æçï¼è¢«å¤å®¶å¬å¸åå¤ä¸ªå¼æºé¡¹ç®ä½¿ç¨ã\n\n# (d) ç¼ºç¹\n\n 1. Kafka åæºè¶è¿ 64 ä¸ª éå/ååº æ¶ï¼Load æ¶ä¼åçææ¾çé£é«ç°è±¡ãéå è¶å¤ï¼è´è½½ è¶é«ï¼åéæ¶æ¯ ååºæ¶é´åé¿ï¼\n 2. ä½¿ç¨ ç­è½®è¯¢æ¹å¼ï¼å®æ¶æ§ åå³äº è½®è¯¢é´éæ¶é´ï¼\n 3. æ¶è´¹å¤±è´¥ ä¸æ¯æéè¯ï¼\n 4. æ¯æ æ¶æ¯é¡ºåºï¼ä½æ¯ ä¸å°ä»£çå®æº åï¼å°±ä¼äº§ç æ¶æ¯ä¹±åºï¼\n 5. ç¤¾åºæ´æ°è¾æ¢ã\n\n\n# MQ çææ¯éå\n\nMQ çææ¯éåä¸è¬è¦èèä»¥ä¸å ç¹ï¼\n\n * æ¯å¦å¼æºï¼è¿å³å®äºè½å¦åç¨ï¼æä»¥æä¸ºéè¦ã\n * ç¤¾åºæ´»è·åº¦è¶é«è¶å¥½ï¼é«ç¤¾åºæ´»è·åº¦ï¼ä¸è¬ä¿è¯äºä½ Bug çï¼å ä¸ºå¤§é¨å Bugï¼å·²ç»æäººéå°å¹¶è§£å³äºã\n * ææ¯çæééæ§ï¼å®¢æ·ç«¯å¯¹åç§ç¼ç¨è¯­è¨çæ¯æãæ¯å¦ï¼å¦æä½¿ç¨ MQ çé½æ¯ Java åºç¨ï¼é£ä¹ ActiveMQãRabbitMQãRocketMQãKafka é½å¯ä»¥ãå¦æéè¦æ¯æå¶ä»è¯­è¨ï¼é£ä¹ RMQ æ¯è¾åéï¼å ä¸ºå®æ¯æçç¼ç¨è¯­è¨æ¯è¾ä¸°å¯ãå¦æ MQ æ¯åºç¨äºå¤§æ°æ®ææµå¼è®¡ç®ï¼é£ä¹ Kafka å ä¹æ¯æ éãå¦ææ¯åºç¨äºå¨çº¿ä¸å¡ç³»ç»ï¼é£ä¹ Kafka å°±ä¸åéäºï¼å¯ä»¥èè RabbitMQã RocketMQ å¾åéã\n * é«å¯ç¨æ§ï¼åºç¨äºçº¿ä¸çåå¥æ åã\n * æ§è½ï¼å·å¤è¶³å¤å¥½çæ§è½ï¼è½æ»¡è¶³ç»å¤§å¤æ°åºæ¯çæ§è½è¦æ±ã\n\nç¹æ§                ACTIVEMQ                     RABBITMQ                        ROCKETMQ                                      KAFKA\nåæºååé             ä¸çº§ï¼æ¯ RocketMQãKafka ä½ä¸ä¸ªæ°éçº§   å ActiveMQ                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡æµå¼è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ RocketMQ   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼Kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ RabbitMQ çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å ActiveMQ                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å RocketMQ\nåè½æ¯æ              MQ é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   MQ åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç MQ åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸å¡ç³»ç»åºæ¯ï¼å»ºè®®ä½¿ç¨ RocketMQãRabbitMQãå¦æææåºç¨é½æ¯ Javaï¼ä¼é RocketMQï¼å ä¸º RocketMQ æ¬èº«å°±æ¯ Java å¼åçï¼æä»¥æééãå¦æä¸å¡ä¸­æå¤ç§ç¼ç¨è¯­è¨çåºç¨ï¼å»ºè®®éæ© RabbitMQã\n * å¤§æ°æ®åæµå¼è®¡ç®é¢åï¼ææ¯ä½ä¸ºæ¥å¿ç¼å²ï¼å¼ºçå»ºè®®éæ© Kafkaï¼ä¸çæ åï¼ä¹ç»èéªã\n\n\n# JMS\n\næå° MQï¼å°±é¡ºä¾¿æä¸ä¸ JMS ã\n\nJMSï¼JAVA Message Serviceï¼java æ¶æ¯æå¡ï¼API æ¯ä¸ä¸ªæ¶æ¯æå¡çæ å/è§èï¼åè®¸åºç¨ç¨åºç»ä»¶åºäº JavaEE å¹³å°åå»ºãåéãæ¥æ¶åè¯»åæ¶æ¯ãå®ä½¿åå¸å¼éä¿¡è¦ååº¦æ´ä½ï¼æ¶æ¯æå¡æ´å å¯é ä»¥åå¼æ­¥æ§ã\n\nå¨ EJB æ¶æä¸­ï¼ææ¶æ¯ bean å¯ä»¥æ ç¼çä¸ JMS æ¶æ¯æå¡éæãå¨ J2EE æ¶ææ¨¡å¼ä¸­ï¼ææ¶æ¯æå¡èæ¨¡å¼ï¼ç¨äºå®ç°æ¶æ¯ä¸åºç¨ç´æ¥çè§£è¦ã\n\n\n# æ¶æ¯æ¨¡å\n\nå¨ JMS æ åä¸­ï¼æä¸¤ç§æ¶æ¯æ¨¡åï¼\n\n * P2P(Point to Point)\n * Pub/Sub(Publish/Subscribe)\n\n# P2P æ¨¡å¼\n\n\nP2P æ¨¡å¼åå«ä¸ä¸ªè§è²ï¼MQï¼Queueï¼ï¼åéè(Sender)ï¼æ¥æ¶è(Receiver)ãæ¯ä¸ªæ¶æ¯é½è¢«åéå°ä¸ä¸ªç¹å®çéåï¼æ¥æ¶èä»éåä¸­è·åæ¶æ¯ãéåä¿ççæ¶æ¯ï¼ç´å°ä»ä»¬è¢«æ¶è´¹æè¶æ¶ã\n\nP2P çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯åªæä¸ä¸ªæ¶è´¹èï¼Consumerï¼(å³ä¸æ¦è¢«æ¶è´¹ï¼æ¶æ¯å°±ä¸åå¨ MQ ä¸­)\n * åéèåæ¥æ¶èä¹é´å¨æ¶é´ä¸æ²¡æä¾èµæ§ï¼ä¹å°±æ¯è¯´å½åéèåéäºæ¶æ¯ä¹åï¼ä¸ç®¡æ¥æ¶èææ²¡ææ­£å¨è¿è¡ï¼å®ä¸ä¼å½±åå°æ¶æ¯è¢«åéå°éå\n * æ¥æ¶èå¨æåæ¥æ¶æ¶æ¯ä¹åéåéååºç­æå\n\nå¦æå¸æåéçæ¯ä¸ªæ¶æ¯é½ä¼è¢«æåå¤ççè¯ï¼é£ä¹éè¦ P2P æ¨¡å¼ã\n\n# Pub/sub æ¨¡å¼\n\n\nåå«ä¸ä¸ªè§è²ä¸»é¢ï¼Topicï¼ï¼åå¸èï¼Publisherï¼ï¼è®¢éèï¼Subscriberï¼ ãå¤ä¸ªåå¸èå°æ¶æ¯åéå° Topic,ç³»ç»å°è¿äºæ¶æ¯ä¼ éç»å¤ä¸ªè®¢éèã\n\nPub/Sub çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯å¯ä»¥æå¤ä¸ªæ¶è´¹è\n * åå¸èåè®¢éèä¹é´ææ¶é´ä¸çä¾èµæ§ãéå¯¹æä¸ªä¸»é¢ï¼Topicï¼çè®¢éèï¼å®å¿é¡»åå»ºä¸ä¸ªè®¢éèä¹åï¼æè½æ¶è´¹åå¸èçæ¶æ¯ã\n * ä¸ºäºæ¶è´¹æ¶æ¯ï¼è®¢éèå¿é¡»ä¿æè¿è¡çç¶æã\n\nä¸ºäºç¼åè¿æ ·ä¸¥æ ¼çæ¶é´ç¸å³æ§ï¼JMS åè®¸è®¢éèåå»ºä¸ä¸ªå¯æä¹åçè®¢éãè¿æ ·ï¼å³ä½¿è®¢éèæ²¡æè¢«æ¿æ´»ï¼è¿è¡ï¼ï¼å®ä¹è½æ¥æ¶å°åå¸èçæ¶æ¯ã\n\nå¦æå¸æåéçæ¶æ¯å¯ä»¥ä¸è¢«åä»»ä½å¤çãæèåªè¢«ä¸ä¸ªæ¶æ¯èå¤çãæèå¯ä»¥è¢«å¤ä¸ªæ¶è´¹èå¤ççè¯ï¼é£ä¹å¯ä»¥éç¨ Pub/Sub æ¨¡åã\n\n\n# æ¶æ¯æ¶è´¹\n\nå¨ JMS ä¸­ï¼æ¶æ¯çäº§çåæ¶è´¹é½æ¯å¼æ­¥çãå¯¹äºæ¶è´¹æ¥è¯´ï¼JMS çæ¶æ¯èå¯ä»¥éè¿ä¸¤ç§æ¹å¼æ¥æ¶è´¹æ¶æ¯ã\n\n * åæ­¥ - è®¢éèææ¥æ¶èéè¿ receive æ¹æ³æ¥æ¥æ¶æ¶æ¯ï¼receive æ¹æ³å¨æ¥æ¶å°æ¶æ¯ä¹åï¼æè¶æ¶ä¹åï¼å°ä¸ç´é»å¡ï¼\n * å¼æ­¥ - è®¢éèææ¥æ¶èå¯ä»¥æ³¨åä¸ºä¸ä¸ªæ¶æ¯çå¬å¨ãå½æ¶æ¯å°è¾¾ä¹åï¼ç³»ç»èªå¨è°ç¨çå¬å¨ç onMessage æ¹æ³ã\n\nJNDI - Java å½ååç®å½æ¥å£,æ¯ä¸ç§æ åç Java å½åç³»ç»æ¥å£ãå¯ä»¥å¨ç½ç»ä¸æ¥æ¾åè®¿é®æå¡ãéè¿æå®ä¸ä¸ªèµæºåç§°ï¼è¯¥åç§°å¯¹åºäºæ°æ®åºæå½åæå¡ä¸­çä¸ä¸ªè®°å½ï¼åæ¶è¿åèµæºè¿æ¥å»ºç«æå¿é¡»çä¿¡æ¯ã\n\nJNDI å¨ JMS ä¸­èµ·å°æ¥æ¾åè®¿é®åéç®æ ææ¶æ¯æ¥æºçä½ç¨ã\n\n\n# JMS ç¼ç¨æ¨¡å\n\n# ConnectionFactory\n\nåå»º Connection å¯¹è±¡çå·¥åï¼éå¯¹ä¸¤ç§ä¸åç jms æ¶æ¯æ¨¡åï¼åå«æ QueueConnectionFactory å TopicConnectionFactory ä¸¤ç§ãå¯ä»¥éè¿ JNDI æ¥æ¥æ¾ ConnectionFactory å¯¹è±¡ã\n\n# Destination\n\nDestination çæææ¯æ¶æ¯çäº§èçæ¶æ¯åéç®æ æèè¯´æ¶æ¯æ¶è´¹èçæ¶æ¯æ¥æºãå¯¹äºæ¶æ¯çäº§èæ¥è¯´ï¼å®ç Destination æ¯æä¸ªéåï¼Queueï¼ææä¸ªä¸»é¢ï¼Topicï¼;å¯¹äºæ¶æ¯æ¶è´¹èæ¥è¯´ï¼å®ç Destination ä¹æ¯æä¸ªéåæä¸»é¢ï¼å³æ¶æ¯æ¥æºï¼ã\n\næä»¥ï¼Destination å®éä¸å°±æ¯ä¸¤ç§ç±»åçå¯¹è±¡ï¼QueueãTopicãå¯ä»¥éè¿ JNDI æ¥æ¥æ¾ Destinationã\n\n# Connection\n\nConnection è¡¨ç¤ºå¨å®¢æ·ç«¯å JMS ç³»ç»ä¹é´å»ºç«çé¾æ¥ï¼å¯¹ TCP/IP socket çåè£ï¼ãConnection å¯ä»¥äº§çä¸ä¸ªæå¤ä¸ª Sessionãè· ConnectionFactory ä¸æ ·ï¼Connection ä¹æä¸¤ç§ç±»åï¼QueueConnection å TopicConnectionã\n\n# Session\n\nSession æ¯æä½æ¶æ¯çæ¥å£ãå¯ä»¥éè¿ session åå»ºçäº§èãæ¶è´¹èãæ¶æ¯ç­ãSession æä¾äºäºå¡çåè½ãå½éè¦ä½¿ç¨ session åé/æ¥æ¶å¤ä¸ªæ¶æ¯æ¶ï¼å¯ä»¥å°è¿äºåé/æ¥æ¶å¨ä½æ¾å°ä¸ä¸ªäºå¡ä¸­ãåæ ·ï¼ä¹å QueueSession å TopicSessionã\n\n# æ¶æ¯ççäº§è\n\næ¶æ¯çäº§èç± Session åå»ºï¼å¹¶ç¨äºå°æ¶æ¯åéå° Destinationãåæ ·ï¼æ¶æ¯çäº§èåä¸¤ç§ç±»åï¼QueueSender å TopicPublisherãå¯ä»¥è°ç¨æ¶æ¯çäº§èçæ¹æ³ï¼send æ publish æ¹æ³ï¼åéæ¶æ¯ã\n\n# æ¶æ¯æ¶è´¹è\n\næ¶æ¯æ¶è´¹èç± Session åå»ºï¼ç¨äºæ¥æ¶è¢«åéå° Destination çæ¶æ¯ãä¸¤ç§ç±»åï¼QueueReceiver å TopicSubscriberãå¯åå«éè¿ session ç createReceiver(Queue)æ createSubscriber(Topic)æ¥åå»ºãå½ç¶ï¼ä¹å¯ä»¥ session ç creatDurableSubscriber æ¹æ³æ¥åå»ºæä¹åçè®¢éèã\n\n# MessageListener\n\næ¶æ¯çå¬å¨ãå¦ææ³¨åäºæ¶æ¯çå¬å¨ï¼ä¸æ¦æ¶æ¯å°è¾¾ï¼å°èªå¨è°ç¨çå¬å¨ç onMessage æ¹æ³ãEJB ä¸­ç MDBï¼Message-Driven Beanï¼å°±æ¯ä¸ç§ MessageListenerã\n\n\n# åèèµæ\n\n * å¤§åç½ç«æ¶æç³»åï¼åå¸å¼ MQï¼ä¸ï¼\n * å¤§åç½ç«æ¶æç³»åï¼MQï¼äºï¼\n * åå¸å¼å¼æ¾ MQ(RocketMQ)çåçä¸å®è·µ\n * é¿é RocketMQ ä¼å¿å¯¹æ¯\n * advanced-java ä¹ MQ\n * æµè°æ¶æ¯éååå¸¸è§çæ¶æ¯ä¸­é´ä»¶',normalizedContent:'# æ¶æ¯éååºæ¬åç\n\n> æ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³å¼æ­¥å¤çãåºç¨é´è¦åï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> ç®åä¸»æµç mq æï¼kafkaãrabbitmqãrocketmqãactivemqï¼èé¨åæ°æ®åºå¦ redisãmysql ä»¥å phxsql ä¹å¯å®ç°æ¶æ¯éåçåè½ã\n> \n> æ³¨æï¼ä¸ºäºç®ä¾¿ï¼ä¸æä¸­é¤äºæç« æ é¢ï¼ä¸å¾ä½¿ç¨ mq ç®ç§°ã\n\n\n# mq çç®ä»\n\n\n# ä»ä¹æ¯ mq\n\næ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n\næ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n\nmq æ¯æ¶è´¹-çäº§èæ¨¡åçä¸ä¸ªå¸åçä»£è¡¨ï¼ä¸ç«¯å¾æ¶æ¯éåä¸­ä¸æ­åå¥æ¶æ¯ï¼èå¦ä¸ç«¯åå¯ä»¥è¯»åéåä¸­çæ¶æ¯ãæ¶æ¯åå¸èåªç®¡ææ¶æ¯åå¸å° mq ä¸­èä¸ç¨ç®¡è°æ¥åï¼æ¶æ¯ä½¿ç¨èåªç®¡ä» mq ä¸­åæ¶æ¯èä¸ç®¡æ¯è°åå¸çãè¿æ ·åå¸èåä½¿ç¨èé½ä¸ç¨ç¥éå¯¹æ¹çå­å¨ã\n\nmq çæ°æ®å¯é©»çå¨åå­æç£çä¸ï¼ç´å°å®ä»¬è¢«åºç¨ç¨åºè¯»åãéè¿ mqï¼åºç¨ç¨åºå¯ç¬ç«å°æ§è¡ï¼å®ä»¬ä¸éè¦ç¥éå½¼æ­¤çä½ç½®ï¼ä¸éè¦ç­å¾æ¥æ¶ç¨åºæ¥æ¶æ­¤æ¶æ¯ãå¨åå¸å¼è®¡ç®ç¯å¢ä¸­ï¼ä¸ºäºéæåå¸å¼åºç¨ï¼å¼åèéè¦å¯¹å¼æç½ç»ç¯å¢ä¸çåå¸å¼åºç¨æä¾ææçéä¿¡ææ®µãä¸ºäºç®¡çéè¦å±äº«çä¿¡æ¯ï¼å¯¹åºç¨æä¾å¬å±çä¿¡æ¯äº¤æ¢æºå¶æ¯éè¦çã\n\nç®åä¸»æµç mq æï¼kafkaãrabbitmqãrocketmqãactivemqã\n\n\n# mq éä¿¡æ¨¡å\n\nmq éä¿¡æ¨¡åå¤§è´æä»¥ä¸ç±»åï¼\n\n * ç¹å¯¹ç¹ - ç¹å¯¹ç¹æ¹å¼æ¯æä¸ºä¼ ç»åå¸¸è§çéè®¯æ¹å¼ï¼å®æ¯æä¸å¯¹ä¸ãä¸å¯¹å¤ãå¤å¯¹å¤ãå¤å¯¹ä¸ç­å¤ç§éç½®æ¹å¼ï¼æ¯ææ ç¶ãç½ç¶ç­å¤ç§ææç»æã\n * å¤ç¹å¹¿æ­ - mq éç¨äºä¸åç±»åçåºç¨ãå¶ä¸­éè¦çï¼ä¹æ¯æ­£å¨åå±ä¸­çæ¯"å¤ç¹å¹¿æ­"åºç¨ï¼å³è½å¤å°æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ (destination list)ãå¯ä»¥ä½¿ç¨ä¸æ¡ mq æä»¤å°åä¸æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ï¼å¹¶ç¡®ä¿ä¸ºæ¯ä¸ç«ç¹å¯é å°æä¾ä¿¡æ¯ãmq ä¸ä»æä¾äºå¤ç¹å¹¿æ­çåè½ï¼èä¸è¿æ¥ææºè½æ¶æ¯åååè½ï¼å¨å°ä¸æ¡æ¶æ¯åéå°åä¸ç³»ç»ä¸çå¤ä¸ªç¨æ·æ¶ï¼mq å°æ¶æ¯çä¸ä¸ªå¤å¶çæ¬åè¯¥ç³»ç»ä¸æ¥æ¶èçåååéå°ç®æ  mq ç³»ç»ãç®æ  mq ç³»ç»å¨æ¬å°å¤å¶è¿äºæ¶æ¯ï¼å¹¶å°å®ä»¬åéå°ååä¸çéåï¼ä»èå°½å¯è½åå°ç½ç»çä¼ è¾éã\n * åå¸/è®¢é (publish/subscribe) - åå¸/è®¢éæ¨¡å¼ä½¿æ¶æ¯çååå¯ä»¥çªç ´ç®çéåå°çä½ç½®çéå¶ï¼ä½¿æ¶æ¯æç§ç¹å®çä¸»é¢çè³åå®¹è¿è¡ååï¼ç¨æ·æåºç¨ç¨åºå¯ä»¥æ ¹æ®ä¸»é¢æåå®¹æ¥æ¶å°æéè¦çæ¶æ¯ãåå¸/è®¢éæ¨¡å¼ä½¿å¾åéèåæ¥æ¶èä¹é´çè¦åå³ç³»åå¾æ´ä¸ºæ¾æ£ï¼åéèä¸å¿å³å¿æ¥æ¶èçç®çå°åï¼èæ¥æ¶èä¹ä¸å¿å³å¿æ¶æ¯çåéå°åï¼èåªæ¯æ ¹æ®æ¶æ¯çä¸»é¢è¿è¡æ¶æ¯çæ¶åã\n * éç¾¤ (cluster) - ä¸ºäºç®åç¹å¯¹ç¹éè®¯æ¨¡å¼ä¸­çç³»ç»éç½®ï¼mq æä¾ cluster(éç¾¤) çè§£å³æ¹æ¡ãéç¾¤ç±»ä¼¼äºä¸ä¸ªå (domain)ï¼éç¾¤åé¨çéåç®¡çå¨ä¹é´éè®¯æ¶ï¼ä¸éè¦ä¸¤ä¸¤ä¹é´å»ºç«æ¶æ¯ééï¼èæ¯éç¨éç¾¤ (cluster) ééä¸å¶å®æåéè®¯ï¼ä»èå¤§å¤§ç®åäºç³»ç»éç½®ãæ­¤å¤ï¼éç¾¤ä¸­çéåç®¡çå¨ä¹é´è½å¤èªå¨è¿è¡è´è½½åè¡¡ï¼å½æä¸éåç®¡çå¨åºç°æéæ¶ï¼å¶å®éåç®¡çå¨å¯ä»¥æ¥ç®¡å®çå·¥ä½ï¼ä»èå¤§å¤§æé«ç³»ç»çé«å¯é æ§ã\n\n\n# mq çåºç¨\n\n\n# å¼æ­¥å¤ç\n\n> mq å¯ä»¥å°ç³»ç»é´çå¤çæµç¨å¼æ­¥åï¼åå°ç­å¾ååºçæ¶é´ï¼ä»èæé«æ´ä½å¹¶åååéã\n> \n> ä¸è¬ï¼mq å¼æ­¥å¤çåºç¨äºéæ ¸å¿æµç¨ï¼ä¾å¦ï¼ç­ä¿¡/é®ä»¶éç¥ãæ°æ®æ¨éãä¸æ¥æ°æ®å°çæ§ä¸­å¿/æ¥å¿ä¸­å¿ç­ã\n\nåè®¾è¿æ ·ä¸ä¸ªåºæ¯ï¼ç¨æ·åç³»ç» a åèµ·è¯·æ±ï¼ç³»ç» a å¤çè®¡ç®åªéè¦ 10 msï¼ç¶åéç¥ç³»ç» bcd ååºï¼ç³»ç» bcd ååºèæ¶åå«ä¸ºï¼100msã200msã300msãæç»æ»èæ¶ä¸ºï¼ 10+100ms+200ms+300ms=610msãæ­¤å¤ï¼å ä¸è¯·æ±åååºçç½ç»ä¼ è¾æ¶é´ï¼ä»ç¨æ·è§åº¦çï¼å¯è½è¦ç­å¾å°è¿ 1s æè½å¾å°ç»æã\n\n\n\nå¦æä½¿ç¨ mqï¼ç³»ç» a æ¥å°è¯·æ±åï¼èæ¶ 10ms å¤çè®¡ç®ï¼ç¶ååç³»ç» bcd è¿ç»­åéæ¶æ¯ï¼åè®¾èæ¶ 5msãé£ä¹ è¿ä¸è¿ç¨çæ»èæ¶ä¸º 3ms + 5ms = 8msï¼è¿ç¸æ¯äº 610 msï¼å¤§å¤§ç¼©ç­äºååºæ¶é´ãè³äºç³»ç» bcd çååºæä½ï¼åªè¦èªè¡æ¶è´¹ mq åå¤çå³å¯ï¼ç¨æ·æ éå³æ³¨ã\n\n\n\n\n# ç³»ç»è§£è¦\n\n> éè¿ mqï¼å¯ä»¥æ¶é¤ç³»ç»é´çå¼ºè¦åãå®çå¥½å¤å¨äºï¼\n> \n>  * æ¶æ¯çæ¶è´¹èç³»ç»å¯ä»¥éæå¢å ï¼æ éä¿®æ¹çäº§èç³»ç»çä»£ç ã\n>  * çäº§èç³»ç»ãæ¶è´¹èç³»ç»å½¼æ­¤ä¸ä¼å½±åå¯¹æ¹çæµç¨ã\n>    * å¦æçäº§èç³»ç»å®æºï¼æ¶è´¹èç³»ç»æ¶ä¸å°æ¶æ¯ï¼å°±ä¸ä¼æä¸ä¸æ­¥çå¨ä½ã\n>    * å¦ææ¶è´¹èç³»ç»å®æºï¼çäº§èç³»ç»è®©ç¶å¯ä»¥æ­£å¸¸åéæ¶æ¯ï¼ä¸å½±åæµç¨ã\n\nä¸åç³»ç»å¦æè¦å»ºç«éä¿¡ï¼ä¼ ç»çåæ³æ¯ï¼è°ç¨æ¥å£ã\n\nå¦æéè¦åæ°çç³»ç»å»ºç«éä¿¡æå é¤å·²å»ºç«çéä¿¡ï¼é½éè¦ä¿®æ¹ä»£ç ï¼è¿ç§æ¹æ¡æ¾ç¶è¦ååº¦å¾é«ã\n\n\n\nå¦æä½¿ç¨ mqï¼ç³»ç»é´çéä¿¡åªéè¦éè¿åå¸/è®¢éï¼pub/subï¼æ¨¡åå³å¯ï¼å½¼æ­¤æ²¡æç´æ¥èç³»ï¼ä¹å°±ä¸éè¦ç¸äºæç¥ï¼ä»èè¾¾å° è§£è¦ã\n\n\n\n\n# æµéåå³°\n\n> å½ ä¸ä¸æ¸¸ç³»ç» å¤çè½åå­å¨å·®è·çæ¶åï¼å©ç¨ mq åä¸ä¸ª âæ¼æâ æ¨¡åï¼è¿è¡ æµæ§ãæ mq å½æå¯é ç æ¶æ¯æå­å°ï¼è¿è¡ä¸å®ç¨åº¦ç æ¶æ¯å ç§¯ï¼å¨ä¸æ¸¸æè½åå¤ççæ¶åï¼ååéæ¶æ¯ã\n> \n> mq çæµéåå³°å¸¸ç¨äºé«å¹¶ååºæ¯ï¼ä¾å¦ï¼ç§æãå¢æ¢ç­ä¸å¡åºæ¯ï¼ï¼å®æ¯ç¼è§£ç¬æ¶æ´å¢æµéçæ ¸å¿ææ®µä¹ä¸ã\n> \n> å¦ææ²¡æ mqï¼ä¸¤ä¸ªç³»ç»ä¹é´éè¿ ååãæ»å¨çªå£ãéæµ/éçº§/çæ­ ç­å¤æçæ¹æ¡ä¹è½å®ç° æµæ§ãä½ ç³»ç»å¤ææ§ ææ°çº§å¢é¿ï¼å¿å¿å¨ä¸æ¸¸æèä¸æ¸¸åå­å¨ï¼å¹¶ä¸è¦å¤ç å®æ¶ãæ¥å¡ ç­ä¸ç³»åé®é¢ãèä¸æ¯å½æ å¤çè½åæå·®è· çæ¶åï¼é½éè¦ åç¬ å¼åä¸å¥é»è¾æ¥ç»´æ¤è¿å¥é»è¾ã\n\nåè®¾æä¸ªç³»ç»è¯»åæ°æ®åºçç¨³å®æ§è½ä¸ºæ¯ç§å¤ç 1000 æ¡æ°æ®ãå¹³å¸¸æåµä¸ï¼è¿è¿è¾¾ä¸å°è¿ä¹å¤§çå¤çéãåè®¾ï¼å ä¸ºå ä¸ºåæ´»å¨ï¼ç³»ç»çç¬æ¶è¯·æ±éå§å¢ï¼è¾¾å°æ¯ç§ 10000 ä¸ªå¹¶åè¯·æ±ï¼æ°æ®åºæ ¹æ¬æ¿åä¸äºï¼å¯è½ç´æ¥å°±ææ°æ®åºç»æ´å´©æºäºï¼è¿æ ·ç³»ç»æå¡å°±ä¸å¯ç¨äºã\n\n\n\nå¦æä½¿ç¨ mqï¼æ¯ç§åå¥ 10000 æ¡è¯·æ±ï¼ä½æ¯ç³»ç» a æ¯ç§åªä» mq ä¸­æ¶è´¹ 1000 æ¡è¯·æ±ï¼ç¶ååå¥æ°æ®åºãè¿æ ·ï¼å°±ä¸ä¼è¶è¿æ°æ®åºçæ¿åè½åï¼èæ¯æè¯·æ±ç§¯åå¨ mq ä¸­ãåªè¦é«å³°æä¸è¿ï¼ç³»ç» a å°±ä¼å¾å¿«æç§¯åçæ¶æ¯ç»å¤çæã\n\n\n\n\n# ä¼ è¾ç¼å²\n\nï¼1ï¼mq å¸¸è¢«ç¨äºåæµ·éæ°æ®çä¼ è¾ç¼å²ã\n\nä¾å¦ï¼kafka å¸¸è¢«ç¨äºåä¸ºåç§æ¥å¿æ°æ®ãééæ°æ®çæ°æ®ä¸­è½¬ãç¶åï¼kafka å°æ°æ®è½¬åç» logstashãelasticsearch ä¸­ï¼ç¶ååºäº elasticsearch æ¥åæ¥å¿ä¸­å¿ï¼æä¾æ£ç´¢ãèåãåææ¥å¿çè½åãå¼åèå¯ä»¥éè¿ kibana éæ elasticsearch æ°æ®è¿è¡å¯è§åå±ç¤ºï¼æèªè¡è¿è¡å®å¶åå¼åã\n\n\n\nï¼2ï¼mq ä¹å¯ä»¥è¢«ç¨äºæµå¼å¤çã\n\nä¾å¦ï¼kafka å ä¹å·²ç»æ¯æµè®¡ç®çæ°æ®ééç«¯çæ åç»ä»¶ãèæµè®¡ç®éè¿å®æ¶æ°æ®å¤çè½åï¼æä¾äºæ´ä¸ºå¿«æ·çèåè®¡ç®è½åï¼è¢«å¤§éåºç¨äºé¾è·¯çæ§ãå®æ¶çæ§ãå®æ¶æ°ä»ãå®æ¶å¤§å±ãé£æ§ãæ¨èç­åºç¨é¢åã\n\n\n# æç»ä¸è´æ§\n\næç»ä¸è´æ§ ä¸æ¯ æ¶æ¯éå çå¿å¤ç¹æ§ï¼ä½ç¡®å®å¯ä»¥ä¾é  æ¶æ¯éå æ¥å æç»ä¸è´æ§ çäºæã\n\n * ååæ¶æ¯åæä½ï¼ç¡®ä¿æä½å®æååä¿®æ¹æ¶æ¯ç¶æãå®æ¶ä»»å¡è¡¥å¿æºå¶ å®ç°æ¶æ¯ å¯é åéæ¥æ¶ãä¸å¡æä½çå¯é æ§è¡ï¼è¦æ³¨æ æ¶æ¯éå¤ ä¸ å¹ç­è®¾è®¡ã\n * ææä¸ä¿è¯ 100% ä¸ä¸¢æ¶æ¯ çæ¶æ¯éåï¼çè®ºä¸æ æ³å®ç° æç»ä¸è´æ§ã\n\n> å kafka ä¸ç±»çè®¾è®¡ï¼å¨è®¾è®¡å±é¢ä¸å°±æ ä¸¢æ¶æ¯ çå¯è½ï¼æ¯å¦ å®æ¶å·çï¼å¦ææçµå°±ä¼ä¸¢æ¶æ¯ï¼ãåªæåªä¸¢ååä¹ä¸çæ¶æ¯ï¼ä¸å¡ä¹å¿é¡»ç¨å¶ä»çææ®µæ¥ä¿è¯ç»ææ­£ç¡®ã\n\n\n# ç³»ç»é´éä¿¡\n\næ¶æ¯éåä¸è¬é½åç½®äº é«æçéä¿¡æºå¶ï¼å æ­¤ä¹å¯ä»¥ç¨äºåçº¯ç æ¶æ¯éè®¯ï¼æ¯å¦å®ç° ç¹å¯¹ç¹æ¶æ¯éå æè èå¤©å®¤ ç­ã\n\nçäº§è/æ¶è´¹è æ¨¡å¼ï¼åªéè¦å³å¿æ¶æ¯æ¯å¦ éè¾¾éåï¼è³äºè°å¸æè®¢éåéè¦æ¶è´¹ï¼æ¯ ä¸æ¸¸ çäºæï¼æ çæå¤§å°åå°äºå¼ååèè°çå·¥ä½éã\n\n\n# mq çé®é¢\n\nä»»ä½ææ¯é½ä¼æå©æå¼ï¼mq ç»æ´ä½ç³»ç»æ¶æå¸¦æ¥å¾å¤å¥½å¤ï¼ä½ä¹ä¼ä»åºä¸å®çä»£ä»·ã\n\nmq ä¸»è¦å¼å¥äºä»¥ä¸é®é¢ï¼\n\n * ç³»ç»å¯ç¨æ§éä½ï¼å¼å¥äº mq åï¼éä¿¡éè¦åºäº mq å®æï¼å¦æ mq å®æºï¼åæå¡ä¸å¯ç¨ãå æ­¤ï¼mq è¦ä¿è¯æ¯é«å¯ç¨çï¼è¯¦æåèï¼mq çé«å¯ç¨\n * ç³»ç»å¤æåº¦æé«ï¼ä½¿ç¨ mqï¼éè¦å³æ³¨ä¸äºæ°çé®é¢ï¼\n   * å¦ä½ä¿è¯æ¶æ¯æ²¡æ éå¤æ¶è´¹ï¼\n   * å¦ä½å¤ç æ¶æ¯ä¸¢å¤± çé®é¢ï¼\n   * å¦ä½ä¿è¯ä¼ é æ¶æ¯çé¡ºåºæ§ï¼\n   * å¦ä½å¤çå¤§é æ¶æ¯ç§¯å çé®é¢ï¼\n * ä¸è´æ§é®é¢ï¼åè®¾ç³»ç» a å¤çå®ç´æ¥è¿åæåçç»æç»ç¨æ·ï¼ç¨æ·è®¤ä¸ºè¯·æ±æåãä½å¦ææ­¤æ¶ï¼ç³»ç» bcd ä¸­åªè¦æä»»æä¸ä¸ªååºå¤±è´¥ï¼é£ä¹æ°æ®å°±ä¸ä¸è´äºãè¿ç§æåµå¦ä½å¤çï¼\n\nä¸é¢ï¼æä»¬éå¯¹ä»¥ä¸é®é¢æ¥ä¸ä¸åæã\n\n\n# éå¤æ¶è´¹\n\nå¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ å å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ æ¯åä¸ä¸ªé®é¢ã\n\nå¿é¡»åæç¡®äº§çéå¤æ¶è´¹çåå ï¼æè½å¯¹çä¸è¯ã\n\n# éå¤æ¶è´¹é®é¢åå \n\néå¤æ¶è´¹é®é¢éå¸¸ä¸æ¯ mq æ¥å¤çï¼èæ¯ç±å¼åæ¥å¤ççã\n\nä»¥ kafka ä¸¾ä¾ï¼kafka æ¯ä¸ª partition é½æ¯ä¸ä¸ªæåºçãä¸å¯åçè®°å½åºåï¼ä¸æ­è¿½å å°ç»æåçæäº¤æ¥å¿ä¸­ãpartition ä¸­ä¸ºæ¯æ¡è®°å½åéä¸ä¸ªè¿ç»­ç id å·ï¼ç§°ä¸ºåç§»éï¼offsetï¼ï¼ç¨äºå¯ä¸æ è¯ partition åçè®°å½ã\n\nkafka çå®¢æ·ç«¯å broker é½ä¼ä¿å­ offsetãå®¢æ·ç«¯æ¶è´¹æ¶æ¯åï¼æ¯éä¸æ®µæ¶é´ï¼å°±æå·²æ¶è´¹ç offset æäº¤ç» kafka brokerï¼è¡¨ç¤ºå·²æ¶è´¹ã\n\n\n\nå¨è¿ä¸ªè¿ç¨ä¸­ï¼å¦æå®¢æ·ç«¯åºç¨æ¶è´¹æ¶æ¯åï¼å ä¸ºå®æºãéå¯ç­æåµèæ²¡ææäº¤å·²æ¶è´¹ç offset ãå½ç³»ç»æ¢å¤åï¼ä¼ç»§ç»­æ¶è´¹æ¶æ¯ï¼ç±äº offset æªæäº¤ï¼å°±ä¼åºç°éå¤æ¶è´¹çé®é¢ã\n\n# éå¤æ¶è´¹è§£å³æ¹æ¡\n\nåºå¯¹éå¤æ¶è´¹é®é¢ï¼éè¦å¨ä¸å¡å±é¢ï¼éè¿ å¹ç­æ§è®¾è®¡ æ¥è§£å³ã\n\nmq éå¤æ¶è´¹ä¸å¯æï¼å¯æçæ¯æ²¡æåºå¯¹æºå¶ï¼å¯ä»¥åé´çæè·¯æï¼\n\n * å¦ææ¯åå³ç³»åæ°æ®åºï¼å¯ä»¥åæ ¹æ®ä¸»é®æ¥è¯¢ï¼å¤æ­æ°æ®æ¯å¦å·²å­å¨ï¼å­å¨åæ´æ°ï¼ä¸å­å¨åæå¥ï¼\n * å¦ææ¯å redisï¼ç±äº set æä½å¤©ç¶å·æå¹ç­æ§ï¼æä»¥ä»ä¹é½ä¸ç¨åï¼\n * å¦ææ¯æ ¹æ®æ¶æ¯åè¾å¤æçé»è¾å¤çï¼å¯ä»¥å¨æ¶æ¯ä¸­å å¥å¨å±å¯ä¸ idï¼ä¾å¦ï¼è®¢å id ç­ãå¨å®¢æ·ç«¯å­å¨ä¸­ï¼mysqlãredis ç­ï¼ä¿å­å·²æ¶è´¹æ¶æ¯ç idãä¸æ¦æ¥åå°æ°æ¶æ¯ï¼åå¤æ­æ¶æ¯ä¸­ç id æ¯å¦å¨å·²æ¶è´¹æ¶æ¯ id è¡¨ä¸­å­å¨ï¼å­å¨åä¸åå¤çï¼ä¸å­å¨åå¤çã\n\nå¨å®éå¼åä¸­ï¼å¯ä»¥åèä¸é¢çä¾å­ï¼ç»åç°å®åºæ¯ï¼è®¾è®¡åççå¹ç­æ§æ¹æ¡ã\n\n\n# æ¶æ¯ä¸¢å¤±\n\nå¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ å å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ æ¯åä¸ä¸ªé®é¢ãå³æ³¨ç¹æï¼\n\n * mq server ä¸¢å¤±æ°æ®\n * æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n * çäº§æ¹ä¸¢å¤±æ°æ®\n\n# æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n\nå¯ä¸å¯è½å¯¼è´æ¶è´¹æ¹ä¸¢å¤±æ°æ®çæåµæ¯ï¼æ¶è´¹æ¹è®¾ç½®äºèªå¨æäº¤ offsetãä¸æ¦è®¾ç½®äºèªå¨æäº¤ offsetï¼æ¥åå°æ¶æ¯åå°±ä¼èªå¨æäº¤ offset ç» kafka ï¼kafka å°±è®¤ä¸ºæ¶æ¯å·²è¢«æ¶è´¹ãå¦ææ­¤æ¶ï¼æ¶è´¹æ¹å°æªæ¥å¾åå¤çæ¶æ¯å°±æäºï¼é£ä¹æ¶æ¯å°±ä¸¢äºã\n\nè§£å³æ¹æ³å°±æ¯ï¼æ¶è´¹æ¹å³é­èªå¨æäº¤ offsetï¼å¤çå®æ¶æ¯åæå¨æäº¤ offsetãä½è¿ç§æåµä¸å¯è½ä¼åºç°éå¤æ¶è´¹çæå½¢ï¼éè¦èªè¡ä¿è¯å¹ç­æ§ã\n\n# kafka server ä¸¢å¤±æ°æ®\n\nå½ kafka æä¸ª broker å®æºï¼éè¦éæ°éä¸¾ partition ç leaderãè¥æ­¤æ¶å¶ä»ç follower å°æªåæ­¥ leader çæ°æ®ï¼é£ä¹æ°éæä¸ª follower ä¸º leader åï¼å°±ä¸¢å¤±äºé¨åæ°æ®ã\n\nä¸ºæ­¤ï¼ä¸è¬è¦æ±è³å°è®¾ç½® 4 ä¸ªåæ°ï¼\n\n * ç» topic è®¾ç½® replication.factor åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¦æ±æ¯ä¸ª partition å¿é¡»æè³å° 2 ä¸ªå¯æ¬ã\n * å¨ kafka æå¡ç«¯è®¾ç½® min.insync.replicas åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¿æ¯è¦æ±ä¸ä¸ª leader éè¦åè³å°ä¸ä¸ª follower ä¿æéä¿¡ï¼è¿æ ·æè½ç¡®ä¿ leader æäºè¿ææ¿è¡¥ã\n * å¨ producer ç«¯è®¾ç½® acks=all - è¿æå³çï¼è¦æ±æ¯æ¡æ°æ®ï¼å¿é¡»æ¯åå¥ææ replica ä¹åï¼æè½è®¤ä¸ºåå¥æåäºã\n * å¨ producer ç«¯è®¾ç½® retries=maxï¼å¾å¤§å¾å¤§å¾å¤§çä¸ä¸ªå¼ï¼æ éæ¬¡éè¯çææï¼ - è¿æå³çè¦æ±ä¸æ¦åå¥å¤±è´¥ï¼å°±æ ééè¯ï¼å¡å¨è¿éäºã\n\n# çäº§æ¹ä¸¢å¤±æ°æ®\n\nå¦ææç§ä¸è¿°çæè·¯è®¾ç½®äº acks=allï¼çäº§æ¹ä¸å®ä¸ä¼ä¸¢æ°æ®ã\n\nè¦æ±æ¯ï¼ä½ ç leader æ¥æ¶å°æ¶æ¯ï¼ææç follower é½åæ­¥å°äºæ¶æ¯ä¹åï¼æè®¤ä¸ºæ¬çäº§æ¶æ¯æåäºãå¦ææªæ»¡è¶³è¿ä¸ªæ¡ä»¶ï¼çäº§èä¼èªå¨ä¸æ­çéè¯ï¼éè¯æ éæ¬¡ã\n\n\n# æ¶æ¯çé¡ºåºæ§\n\nè¦ä¿è¯ mq çé¡ºåºæ§ï¼å¿å¿è¦ä»åºä¸å®çä»£ä»·ï¼æä»¥å®æ½æ¹æ¡åï¼è¦åæç¡®ä¸å¡åºæ¯æ¯ä¸æ¯æå¿è¦ä¿è¯æ¶æ¯çé¡ºåºæ§ãåªæé£äºæç¡®å¯¹æ¶æ¯å¤çé¡ºåºæè¦æ±çä¸å¡åºæ¯æå¼å¾å»ä¿è¯æ¶æ¯é¡ºåºæ§ã\n\næ¹æ¡ä¸\n\nä¸ä¸ª topicï¼ä¸ä¸ª partitionï¼ä¸ä¸ª consumerï¼åé¨åçº¿ç¨æ¶è´¹ï¼åçº¿ç¨ååéå¤ªä½ï¼ä¸è¬ä¸ä¼ç¨è¿ä¸ªã\n\næ¹æ¡äº\n\n * åå¥æ°æ®å° partition æ¶æå®ä¸ä¸ªå¨å±å¯ä¸ç idï¼ä¾å¦è®¢å idãåéæ¹ä¿è¯ç¸å id çæ¶æ¯æåºçåéå°åä¸ä¸ª partitionã\n * åºäºä¸ä¸ç¹ï¼æ¶è´¹æ¹ä» kafka partition ä¸­æ¶è´¹æ¶æ¯æ¶ï¼æ­¤å»ä¸å®æ¯é¡ºåºçãä½å¦ææ¶è´¹æ¹å¼ä»¥å¹¶åæ¹å¼æ¶è´¹æ¶æ¯ï¼é¡ºåºå°±å¯è½ä¼è¢«æä¹±ãä¸ºæ­¤ï¼è¿æåå°ä»¥ä¸å ç¹ï¼\n   * æ¶è´¹æ¹ç»´æ¤ n ä¸ªç¼å­éåï¼å·æç¸å id çæ°æ®é½åå¥åä¸ä¸ªéåä¸­ï¼\n   * åå»º n ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨åªè´è´£ä»æå®çä¸ä¸ªéåä¸­åæ°æ®ã\n\n\n\n\n# æ¶æ¯ç§¯å\n\nåè®¾ä¸ä¸ª mq æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 1000 æ¡æ¶æ¯ï¼ä¸ä¸ª mq æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 3000 æ¡æ¶æ¯ï¼é£ä¹ä¸åéçå¤çéæ¯ 18 ä¸æ¡ãå¦æ mq ä¸­ç§¯åäºå ç¾ä¸å°ä¸åä¸çæ°æ®ï¼å³ä½¿æ¶è´¹èæ¢å¤äºï¼ä¹éè¦å¤§æ¦å¾é¿çæ¶é´æè½æ¢å¤è¿æ¥ã\n\nå¯¹äºäº§çº¿ç¯å¢æ¥è¯´ï¼æ¼«é¿çç­å¾æ¯ä¸å¯æ¥åçï¼æä»¥é¢ä¸´è¿ç§çªå¢æ¶ï¼åªè½ä¸´æ¶ç´§æ¥æ©å®¹ä»¥åºå¯¹äºï¼å·ä½æä½æ­¥éª¤åæè·¯å¦ä¸ï¼\n\n * åä¿®å¤ consumer çé®é¢ï¼ç¡®ä¿å¶æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå°ç°æ consumer é½åæã\n * æ°å»ºä¸ä¸ª topicï¼partition æ¯åæ¥ç 10 åï¼ä¸´æ¶å»ºç«å¥½åå 10 åç queue æ°éã\n * ç¶ååä¸ä¸ªä¸´æ¶çååæ°æ®ç consumer ç¨åºï¼è¿ä¸ªç¨åºé¨ç½²ä¸å»æ¶è´¹ç§¯åçæ°æ®ï¼æ¶è´¹ä¹åä¸åèæ¶çå¤çï¼ç´æ¥ååè½®è¯¢åå¥ä¸´æ¶å»ºç«å¥½ç 10 åæ°éç queueã\n * æ¥çä¸´æ¶å¾ç¨ 10 åçæºå¨æ¥é¨ç½² consumer ï¼æ¯ä¸æ¹ consumer æ¶è´¹ä¸ä¸ªä¸´æ¶ queue çæ°æ®ãè¿ç§åæ³ç¸å½äºæ¯ä¸´æ¶å° queue èµæºå consumer èµæºæ©å¤§ 10 åï¼ä»¥æ­£å¸¸ç 10 åéåº¦æ¥æ¶è´¹æ°æ®ã\n * ç­å¿«éæ¶è´¹å®ç§¯åæ°æ®ä¹åï¼å¾æ¢å¤ååé¨ç½²çæ¶æï¼éæ°ç¨ååç consumer æºå¨æ¥æ¶è´¹æ¶æ¯ã\n\n\n# mq çé«å¯ç¨\n\nä¸å mq å®ç°é«å¯ç¨çåçåä¸ç¸åãå ä¸º kafka æ¯è¾å·æä»£è¡¨æ§ï¼æä»¥è¿éä»¥ kafka ä¸ºä¾ã\n\n\n# kafka çé«å¯ç¨\n\n# kafka çæ ¸å¿æ¦å¿µ\n\näºè§£ kafkaï¼å¿é¡»åäºè§£ kafka çæ ¸å¿æ¦å¿µï¼\n\n * broker - kafka éç¾¤åå«ä¸ä¸ªæå¤ä¸ªèç¹ï¼è¿ç§èç¹è¢«ç§°ä¸º brokerã\n\n * topic - æ¯æ¡åå¸å° kafka éç¾¤çæ¶æ¯é½æä¸ä¸ªç±»å«ï¼è¿ä¸ªç±»å«è¢«ç§°ä¸º topicãï¼ä¸å topic çæ¶æ¯æ¯ç©çéç¦»çï¼åä¸ä¸ª topic çæ¶æ¯ä¿å­å¨ä¸ä¸ªæå¤ä¸ª broker ä¸ï¼ä½ç¨æ·åªéæå®æ¶æ¯ç topic å³å¯çäº§ææ¶è´¹æ°æ®èä¸å¿å³å¿æ°æ®å­äºä½å¤ï¼ãå¯¹äºæ¯ä¸ä¸ª topicï¼ kafka éç¾¤é½ä¼ç»´æä¸ä¸ªååºæ¥å¿ã\n\n * partition - äºæé« kafka çååçï¼æ¯ä¸ª topic åå«ä¸ä¸ªæå¤ä¸ª partitionï¼æ¯ä¸ª partition å¨ç©çä¸å¯¹åºä¸ä¸ªæä»¶å¤¹ï¼è¯¥æä»¶å¤¹ä¸å­å¨è¿ä¸ª partition çæææ¶æ¯åç´¢å¼æä»¶ã\n   \n   * kafka æ¥å¿çååºï¼partitionï¼åå¸å¨ kafka éç¾¤çèç¹ä¸ãæ¯ä¸ªèç¹å¨å¤çæ°æ®åè¯·æ±æ¶ï¼å±äº«è¿äºååºãæ¯ä¸ä¸ªååºé½ä¼å¨å·²éç½®çèç¹ä¸è¿è¡å¤ä»½ï¼ç¡®ä¿å®¹éæ§ã\n\n\n\n# kafka çå¯æ¬æºå¶\n\nkafka æ¯å¦ä½å®ç°é«å¯ç¨çå¢ï¼\n\nkafka å¨ 0.8 ä»¥åççæ¬ä¸­ï¼å¦æä¸ä¸ª broker å®æºäºï¼å¶ä¸é¢ç partition é½ä¸è½ç¨äºï¼è¿èªç¶ä¸æ¯é«å¯ç¨çã\n\nä¸ºäºå®ç°é«å¯ç¨ï¼kafka å¼å¥äºå¤å¶åè½ã\n\nç®åæ¥è¯´ï¼å°±æ¯å¯æ¬æºå¶ï¼ replicate ï¼ã\n\næ¯ä¸ª partition é½æä¸ä¸ª leaderï¼é¶ä¸ªæå¤ä¸ª followerãleader å follower é½æ¯ brokerï¼æ¯ä¸ª broker é½ä¼æä¸ºæäºååºç leader åæäºååºç followerï¼å æ­¤éç¾¤çè´è½½æ¯å¹³è¡¡çã\n\n * leader å¤çä¸åå¯¹ partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n * è follower åªéè¢«å¨çåæ­¥ leader ä¸çæ°æ®ã\n\nåä¸ä¸ª topic çä¸å partition ä¼åå¸å¨å¤ä¸ª broker ä¸ï¼èä¸ä¸ä¸ª partition è¿ä¼å¨å¶ä»ç broker ä¸é¢è¿è¡å¤ä»½ï¼producer å¨åå¸æ¶æ¯å°æä¸ª partition æ¶ï¼åæ¾å°è¯¥ partition ç leaderï¼ç¶ååè¿ä¸ª leader æ¨éæ¶æ¯ï¼æ¯ä¸ª follower é½ä» leader æåæ¶æ¯ï¼æåæ¶æ¯æåä¹åï¼å leader åéä¸ä¸ª ack ç¡®è®¤ã\n\n\n\n> faq\n> \n> é®ï¼ä¸ºä»ä¹è®© leader å¤çä¸åå¯¹å¯¹ partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n> \n> ç­ï¼å ä¸ºå¦æåè®¸ææ broker é½å¯ä»¥å¤çè¯»åè¯·æ±ï¼å°±å¯è½äº§çæ°æ®ä¸è´æ§é®é¢ã\n\n# kafka éä¸¾ leader\n\nç±ä¸æå¯ç¥ï¼partition å¨å¤ä¸ª broker ä¸å­å¨å¯æ¬ã\n\nå¦ææä¸ª follower å®æºï¼å¥äºå¿æ²¡æï¼æ­£å¸¸å·¥ä½ã\n\nå¦æ leader å®æºäºï¼ä¼ä» follower ä¸­éæ°éä¸¾ä¸ä¸ªæ°ç leaderã\n\n\n# ä¸»æµ mq\n\n\n# activemq\n\nactivemq æ¯ç± apache åºåï¼activemq æ¯ä¸ä¸ªå®å¨æ¯æjms1.1 å j2ee 1.4 è§èç jms provider å®ç°ãå®éå¸¸å¿«éï¼æ¯æ å¤ç§è¯­è¨çå®¢æ·ç«¯ å åè®®ï¼èä¸å¯ä»¥éå¸¸å®¹æçåµå¥å°ä¼ä¸çåºç¨ç¯å¢ä¸­ï¼å¹¶æè®¸å¤é«çº§åè½ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. æä» jms è§èï¼jms è§èæä¾äºè¯å¥½çæ ååä¿è¯ï¼åæ¬ï¼åæ­¥ æ å¼æ­¥ çæ¶æ¯ååï¼ä¸æ¬¡åä»ä¸æ¬¡çæ¶æ¯ååï¼æ¶æ¯æ¥æ¶ å è®¢é ç­ç­ãéµä» jms è§èçå¥½å¤å¨äºï¼ä¸è®ºä½¿ç¨ä»ä¹ jms å®ç°æä¾èï¼è¿äºåºç¡ç¹æ§é½æ¯å¯ç¨çï¼\n 2. è¿æ¥çµæ´»æ§ï¼activemq æä¾äºå¹¿æ³ç è¿æ¥åè®®ï¼æ¯æçåè®®æï¼http/sï¼ip å¤æ­ï¼sslï¼tcpï¼udp ç­ç­ãå¯¹ä¼å¤åè®®çæ¯æè®© activemq æ¥æäºå¾å¥½ççµæ´»æ§ï¼\n 3. æ¯æçåè®®ç§ç±»å¤ï¼openwireãstompãrestãxmppãamqpï¼\n 4. æä¹åæä»¶åå®å¨æä»¶ï¼activemq æä¾äº å¤ç§æä¹å éæ©ãèä¸ï¼activemq çå®å¨æ§ä¹å¯ä»¥å®å¨ä¾æ®ç¨æ·éæ±è¿è¡ èªå®ä¹é´æ å ææï¼\n 5. æ¯æçå®¢æ·ç«¯è¯­è¨ç§ç±»å¤ï¼é¤äº java ä¹å¤ï¼è¿æï¼c/c++ï¼.netï¼perlï¼phpï¼pythonï¼rubyï¼\n 6. ä»£çéç¾¤ï¼å¤ä¸ª activemq ä»£ç å¯ä»¥ç»æä¸ä¸ª éç¾¤ æ¥æä¾æå¡ï¼\n 7. å¼å¸¸ç®åçç®¡çï¼activemq æ¯ä»¥å¼åèæç»´è¢«è®¾è®¡çãæä»¥ï¼å®å¹¶ä¸éè¦ä¸é¨çç®¡çåï¼å ä¸ºå®æä¾äºç®ååä½¿ç¨çç®¡çç¹æ§ãæå¾å¤ä¸­æ¹æ³å¯ä»¥ çæ§ activemq ä¸åå±é¢çæ°æ®ï¼åæ¬ä½¿ç¨å¨ jconsole æèå¨ activemq ç web console ä¸­ä½¿ç¨ jmxãéè¿å¤ç jmx çåè­¦æ¶æ¯ï¼éè¿ä½¿ç¨ å½ä»¤è¡èæ¬ï¼çè³å¯ä»¥éè¿çæ§åç§ç±»åç æ¥å¿ã\n\n# (b) é¨ç½²ç¯å¢\n\nactivemq å¯ä»¥è¿è¡å¨ java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ activemq éè¦ï¼\n\n * java jdk\n * activemq å®è£å\n\n# (c) ä¼ç¹\n\n 1. è·¨å¹³å° (java ç¼åä¸å¹³å°æ å³ï¼activemq å ä¹å¯ä»¥è¿è¡å¨ä»»ä½ç jvm ä¸)ï¼\n 2. å¯ä»¥ç¨ jdbcï¼å¯ä»¥å° æ°æ®æä¹å å°æ°æ®åºãè½ç¶ä½¿ç¨ jdbc ä¼éä½ activemq çæ§è½ï¼ä½æ¯æ°æ®åºä¸ç´é½æ¯å¼åäººåæçæçå­å¨ä»è´¨ï¼\n 3. æ¯æ jms è§èï¼æ¯æ jms è§èæä¾ç ç»ä¸æ¥å£;\n 4. æ¯æ èªå¨éè¿ å éè¯¯éè¯æºå¶ï¼\n 5. æå®å¨æºå¶ï¼æ¯æåºäº shiroï¼jaas ç­å¤ç§ å®å¨éç½®æºå¶ï¼å¯ä»¥å¯¹ queue/topic è¿è¡ è®¤è¯åææï¼\n 6. çæ§å®åï¼æ¥æå®åç çæ§ï¼åæ¬ web consoleï¼jmxï¼shell å½ä»¤è¡ï¼jolokia ç restful apiï¼\n 7. çé¢ååï¼æä¾ç web console å¯ä»¥æ»¡è¶³å¤§é¨åæåµï¼è¿æå¾å¤ ç¬¬ä¸æ¹çç»ä»¶ å¯ä»¥ä½¿ç¨ï¼æ¯å¦ hawtioï¼\n\n# (d) ç¼ºç¹\n\n 1. ç¤¾åºæ´»è·åº¦ä¸å rabbitmq é«ï¼\n 2. æ ¹æ®å¶ä»ç¨æ·åé¦ï¼ä¼åºè«åå¶å¦çé®é¢ï¼ä¼ ä¸¢å¤±æ¶æ¯ï¼\n 3. ç®åéå¿æ¾å° activemq 6.0 äº§å apolloï¼å¯¹ 5.x çç»´æ¤è¾å°ï¼\n 4. ä¸éåç¨äº ä¸åä¸ªéå çåºç¨åºæ¯ï¼\n\n\n# rabbitmq\n\nrabbitmq äº 2007 å¹´åå¸ï¼æ¯ä¸ä¸ªå¨ amqp (é«çº§æ¶æ¯éååè®®)åºç¡ä¸å®æçï¼å¯å¤ç¨çä¼ä¸æ¶æ¯ç³»ç»ï¼æ¯å½åæä¸»æµçæ¶æ¯ä¸­é´ä»¶ä¹ä¸ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¯é æ§ï¼æä¾äºå¤ç§ææ¯å¯ä»¥è®©ä½ å¨ æ§è½ å å¯é æ§ ä¹é´è¿è¡ æè¡¡ãè¿äºææ¯åæ¬ æä¹æ§æºå¶ãæéç¡®è®¤ãåå¸èè¯å® å é«å¯ç¨æ§æºå¶ï¼\n 2. çµæ´»çè·¯ç±ï¼æ¶æ¯å¨å°è¾¾éååæ¯éè¿ äº¤æ¢æº è¿è¡ è·¯ç± çãrabbitmq ä¸ºå¸åçè·¯ç±é»è¾æä¾äº å¤ç§åç½®äº¤æ¢æº ç±»åãå¦æä½ ææ´å¤æçè·¯ç±éæ±ï¼å¯ä»¥å°è¿äºäº¤æ¢æºç»åèµ·æ¥ä½¿ç¨ï¼ä½ çè³å¯ä»¥å®ç°èªå·±çäº¤æ¢æºç±»åï¼å¹¶ä¸å½å rabbitmq ç æä»¶ æ¥ä½¿ç¨ï¼\n 3. æ¶æ¯éç¾¤ï¼å¨ç¸åå±åç½ä¸­çå¤ä¸ª rabbitmq æå¡å¨å¯ä»¥ èå å¨ä¸èµ·ï¼ä½ä¸ºä¸ä¸ªç¬ç«çé»è¾ä»£çæ¥ä½¿ç¨ï¼\n 4. éåé«å¯ç¨ï¼éåå¯ä»¥å¨éç¾¤ä¸­çæºå¨ä¸ è¿è¡éåï¼ä»¥ç¡®ä¿å¨ç¡¬ä»¶é®é¢ä¸è¿ä¿è¯ æ¶æ¯å®å¨ï¼\n 5. æ¯æå¤ç§åè®®ï¼æ¯æ å¤ç§æ¶æ¯éååè®®ï¼\n 6. æ¯æå¤ç§è¯­è¨ï¼ç¨ erlang è¯­è¨ç¼åï¼æ¯æåªè¦æ¯ä½ è½æ³å°ç ææç¼ç¨è¯­è¨ï¼\n 7. ç®¡ççé¢ï¼ rabbitmq æä¸ä¸ªæç¨ç ç¨æ·çé¢ï¼ä½¿å¾ç¨æ·å¯ä»¥ çæ§ å ç®¡ç æ¶æ¯ broker çè®¸å¤æ¹é¢ï¼\n 8. è·è¸ªæºå¶ï¼å¦æ æ¶æ¯å¼å¸¸ï¼rabbitmq æä¾æ¶æ¯è·è¸ªæºå¶ï¼ä½¿ç¨èå¯ä»¥æ¾åºåçäºä»ä¹ï¼\n 9. æä»¶æºå¶ï¼æä¾äºè®¸å¤ æä»¶ï¼æ¥ä»å¤æ¹é¢è¿è¡æ©å±ï¼ä¹å¯ä»¥ç¼åèªå·±çæä»¶ã\n\n# (b) é¨ç½²ç¯å¢\n\nrabbitmq å¯ä»¥è¿è¡å¨ erlang è¯­è¨ææ¯æçå¹³å°ä¹ä¸ï¼åæ¬ solarisï¼bsdï¼linuxï¼macosxï¼tru64ï¼windows ç­ãä½¿ç¨ rabbitmq éè¦ï¼\n\n * erlang è¯­è¨å\n * rabbitmq å®è£å\n\n# (c) ä¼ç¹\n\n 1. ç±äº erlang è¯­è¨çç¹æ§ï¼æ¶æ¯éåæ§è½è¾å¥½ï¼æ¯æ é«å¹¶åï¼\n 2. å¥å£®ãç¨³å®ãæç¨ãè·¨å¹³å°ãæ¯æ å¤ç§è¯­è¨ãææ¡£é½å¨ï¼\n 3. ææ¶æ¯ ç¡®è®¤æºå¶ å æä¹åæºå¶ï¼å¯é æ§é«ï¼\n 4. é«åº¦å¯å®å¶ç è·¯ç±ï¼\n 5. ç®¡ççé¢ è¾ä¸°å¯ï¼å¨äºèç½å¬å¸ä¹æè¾å¤§è§æ¨¡çåºç¨ï¼ç¤¾åºæ´»è·åº¦é«ã\n\n# (d) ç¼ºç¹\n\n 1. å°½ç®¡ç»å erlang è¯­è¨æ¬èº«çå¹¶åä¼å¿ï¼æ§è½è¾å¥½ï¼ä½æ¯ä¸å©äºå äºæ¬¡å¼ååç»´æ¤ï¼\n 2. å®ç°äº ä»£çæ¶æï¼æå³çæ¶æ¯å¨åéå°å®¢æ·ç«¯ä¹åå¯ä»¥å¨ ä¸­å¤®èç¹ ä¸æéãæ­¤ç¹æ§ä½¿å¾ rabbitmq æäºä½¿ç¨åé¨ç½²ï¼ä½æ¯ä½¿å¾å¶ è¿è¡éåº¦è¾æ¢ï¼å ä¸ºä¸­å¤®èç¹ å¢å äºå»¶è¿ï¼æ¶æ¯å°è£å ä¹æ¯è¾å¤§ï¼\n 3. éè¦å­¦ä¹  æ¯è¾å¤æ ç æ¥å£ååè®®ï¼å­¦ä¹ åç»´æ¤ææ¬è¾é«ã\n\n\n# rocketmq\n\nrocketmq åºèª é¿é çå¼æºäº§åï¼ç¨ java è¯­è¨å®ç°ï¼å¨è®¾è®¡æ¶åèäº kafkaï¼å¹¶ååºäºèªå·±çä¸äºæ¹è¿ï¼æ¶æ¯å¯é æ§ä¸ æ¯ kafka æ´å¥½ãrocketmq å¨é¿éåé¨ \b è¢«å¹¿æ³åºç¨å¨ è®¢åï¼äº¤æï¼åå¼ï¼æµè®¡ç®ï¼æ¶æ¯æ¨éï¼æ¥å¿æµå¼å¤çï¼binglog åå ç­åºæ¯ã\n\n# (a) ä¸»è¦ç¹æ§\n\n![img](data:image/svg+xml;utf8,)\n\n 1. åºäº éåæ¨¡åï¼å·æ é«æ§è½ãé«å¯é ãé«å®æ¶ãåå¸å¼ ç­ç¹ç¹ï¼\n 2. producerãconsumerãéå é½æ¯æ åå¸å¼ï¼\n 3. producer åä¸äºéåè½®æµåéæ¶æ¯ï¼éåéå ç§°ä¸º topicãconsumer å¦æå å¹¿æ­æ¶è´¹ï¼åä¸ä¸ª consumer å®ä¾æ¶è´¹è¿ä¸ª topic å¯¹åºç ææéåï¼å¦æå éç¾¤æ¶è´¹ï¼å å¤ä¸ª consumer å®ä¾ å¹³åæ¶è´¹ è¿ä¸ª topic å¯¹åºçéåéåï¼\n 4. è½å¤ä¿è¯ ä¸¥æ ¼çæ¶æ¯é¡ºåºï¼\n 5. æä¾ä¸°å¯ç æ¶æ¯æåæ¨¡å¼ï¼\n 6. é«æçè®¢éè æ°´å¹³æ©å±è½åï¼\n 7. å®æ¶ ç æ¶æ¯è®¢éæºå¶ï¼\n 8. äº¿çº§ æ¶æ¯å ç§¯ è½åï¼\n 9. è¾å°çå¤é¨ä¾èµã\n\n# (b) é¨ç½²ç¯å¢\n\nrocketmq å¯ä»¥è¿è¡å¨ java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ rocketmq éè¦ï¼\n\n * java jdk\n * å®è£ gitãmaven\n * rocketmq å®è£å\n\n# (c) ä¼ç¹\n\n 1. åæº æ¯æ 1 ä¸ä»¥ä¸ æä¹åéåï¼\n 2. rocketmq çæææ¶æ¯é½æ¯ æä¹åçï¼ååå¥ç³»ç» pagecacheï¼ç¶å å·çï¼å¯ä»¥ä¿è¯ åå­ ä¸ ç£ç é½æä¸ä»½æ°æ®ï¼è è®¿é® æ¶ï¼ç´æ¥ ä»åå­è¯»åã\n 3. æ¨¡åç®åï¼æ¥å£æç¨ï¼jms çæ¥å£å¾å¤åºåå¹¶ä¸å¤ªå®ç¨ï¼ï¼\n 4. æ§è½éå¸¸å¥½ï¼å¯ä»¥åè®¸ å¤§éå ç§¯æ¶æ¯ å¨ broker ä¸­ï¼\n 5. æ¯æ å¤ç§æ¶è´¹æ¨¡å¼ï¼åæ¬ éç¾¤æ¶è´¹ãå¹¿æ­æ¶è´¹ç­ï¼\n 6. åä¸ªç¯è åå¸å¼æ©å±è®¾è®¡ï¼æ¯æ ä¸»ä» å é«å¯ç¨ï¼\n 7. å¼ååº¦è¾æ´»è·ï¼çæ¬æ´æ°å¾å¿«ã\n\n# (d) ç¼ºç¹\n\n 1. æ¯æç å®¢æ·ç«¯è¯­è¨ ä¸å¤ï¼ç®åæ¯ java å c++ï¼å¶ä¸­ c++ è¿ä¸æçï¼\n 2. rocketmq ç¤¾åºå³æ³¨åº¦åæçåº¦ä¹ä¸ååä¸¤èï¼\n 3. æ²¡æ web ç®¡ççé¢ï¼æä¾äºä¸ä¸ª cli (å½ä»¤è¡çé¢) ç®¡çå·¥å·å¸¦æ¥ æ¥è¯¢ãç®¡ç å è¯æ­åç§é®é¢ï¼\n 4. æ²¡æå¨ mq æ ¸å¿éå®ç° jms ç­æ¥å£ï¼\n\n\n# kafka\n\napache kafka æ¯ä¸ä¸ª åå¸å¼æ¶æ¯åå¸è®¢é ç³»ç»ãå®æåç± linkedin å¬å¸åºäºç¬ç¹çè®¾è®¡å®ç°ä¸ºä¸ä¸ª åå¸å¼çæ¥å¿æäº¤ç³»ç» (a distributed commit log)ï¼ä¹åæä¸º apache é¡¹ç®çä¸é¨åãkafka æ§è½é«æãå¯æ©å±è¯å¥½ å¹¶ä¸ å¯æä¹åãå®ç ååºç¹æ§ï¼å¯å¤å¶ å å¯å®¹é é½æ¯å¶ä¸éçç¹æ§ã\n\n![img](data:image/svg+xml;utf8,)\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¿«éæä¹åï¼å¯ä»¥å¨ o(1) çç³»ç»å¼éä¸è¿è¡ æ¶æ¯æä¹åï¼\n 2. é«ååï¼å¨ä¸å°æ®éçæå¡å¨ä¸æ¢å¯ä»¥è¾¾å° 10w/s ç ååéçï¼\n 3. å®å¨çåå¸å¼ç³»ç»ï¼brokerãproducer å consumer é½åçèªå¨æ¯æ åå¸å¼ï¼èªå¨å®ç° è´è½½åè¡¡ï¼\n 4. æ¯æ åæ­¥ å å¼æ­¥ å¤å¶ä¸¤ç§ é«å¯ç¨æºå¶ï¼\n 5. æ¯æ æ°æ®æ¹éåé å æåï¼\n 6. é¶æ·è´ææ¯(zero-copy)ï¼åå° io æä½æ­¥éª¤ï¼æé« ç³»ç»ååéï¼\n 7. æ°æ®è¿ç§»ãæ©å®¹ å¯¹ç¨æ·éæï¼\n 8. æ éåæº å³å¯æ©å±æºå¨ï¼\n 9. å¶ä»ç¹æ§ï¼ä¸°å¯ç æ¶æ¯æåæ¨¡åãé«æ è®¢éèæ°´å¹³æ©å±ãå®æ¶ç æ¶æ¯è®¢éãäº¿çº§ç æ¶æ¯å ç§¯è½åãå®æå é¤æºå¶ï¼\n\n# (b) é¨ç½²ç¯å¢\n\nä½¿ç¨ kafka éè¦ï¼\n\n * java jdk\n * kafka å®è£å\n\n# (c) ä¼ç¹\n\n 1. å®¢æ·ç«¯è¯­è¨ä¸°å¯ï¼æ¯æ javaã.netãphpãrubyãpythonãgo ç­å¤ç§è¯­è¨ï¼\n 2. é«æ§è½ï¼åæºåå¥ tps çº¦å¨ 100 ä¸æ¡/ç§ï¼æ¶æ¯å¤§å° 10 ä¸ªå­èï¼\n 3. æä¾ å®å¨åå¸å¼æ¶æï¼å¹¶æ replica æºå¶ï¼æ¥æè¾é«ç å¯ç¨æ§ å å¯é æ§ï¼çè®ºä¸æ¯æ æ¶æ¯æ éå ç§¯ï¼\n 4. æ¯ææ¹éæä½ï¼\n 5. æ¶è´¹è éç¨ pull æ¹å¼è·åæ¶æ¯ãæ¶æ¯æåºï¼éè¿æ§å¶ è½å¤ä¿è¯æææ¶æ¯è¢«æ¶è´¹ä¸ä»è¢«æ¶è´¹ ä¸æ¬¡ï¼\n 6. æä¼ç§çç¬¬ä¸æ¹ kafka web ç®¡ççé¢ kafka-managerï¼\n 7. å¨ æ¥å¿é¢å æ¯è¾æçï¼è¢«å¤å®¶å¬å¸åå¤ä¸ªå¼æºé¡¹ç®ä½¿ç¨ã\n\n# (d) ç¼ºç¹\n\n 1. kafka åæºè¶è¿ 64 ä¸ª éå/ååº æ¶ï¼load æ¶ä¼åçææ¾çé£é«ç°è±¡ãéå è¶å¤ï¼è´è½½ è¶é«ï¼åéæ¶æ¯ ååºæ¶é´åé¿ï¼\n 2. ä½¿ç¨ ç­è½®è¯¢æ¹å¼ï¼å®æ¶æ§ åå³äº è½®è¯¢é´éæ¶é´ï¼\n 3. æ¶è´¹å¤±è´¥ ä¸æ¯æéè¯ï¼\n 4. æ¯æ æ¶æ¯é¡ºåºï¼ä½æ¯ ä¸å°ä»£çå®æº åï¼å°±ä¼äº§ç æ¶æ¯ä¹±åºï¼\n 5. ç¤¾åºæ´æ°è¾æ¢ã\n\n\n# mq çææ¯éå\n\nmq çææ¯éåä¸è¬è¦èèä»¥ä¸å ç¹ï¼\n\n * æ¯å¦å¼æºï¼è¿å³å®äºè½å¦åç¨ï¼æä»¥æä¸ºéè¦ã\n * ç¤¾åºæ´»è·åº¦è¶é«è¶å¥½ï¼é«ç¤¾åºæ´»è·åº¦ï¼ä¸è¬ä¿è¯äºä½ bug çï¼å ä¸ºå¤§é¨å bugï¼å·²ç»æäººéå°å¹¶è§£å³äºã\n * ææ¯çæééæ§ï¼å®¢æ·ç«¯å¯¹åç§ç¼ç¨è¯­è¨çæ¯æãæ¯å¦ï¼å¦æä½¿ç¨ mq çé½æ¯ java åºç¨ï¼é£ä¹ activemqãrabbitmqãrocketmqãkafka é½å¯ä»¥ãå¦æéè¦æ¯æå¶ä»è¯­è¨ï¼é£ä¹ rmq æ¯è¾åéï¼å ä¸ºå®æ¯æçç¼ç¨è¯­è¨æ¯è¾ä¸°å¯ãå¦æ mq æ¯åºç¨äºå¤§æ°æ®ææµå¼è®¡ç®ï¼é£ä¹ kafka å ä¹æ¯æ éãå¦ææ¯åºç¨äºå¨çº¿ä¸å¡ç³»ç»ï¼é£ä¹ kafka å°±ä¸åéäºï¼å¯ä»¥èè rabbitmqã rocketmq å¾åéã\n * é«å¯ç¨æ§ï¼åºç¨äºçº¿ä¸çåå¥æ åã\n * æ§è½ï¼å·å¤è¶³å¤å¥½çæ§è½ï¼è½æ»¡è¶³ç»å¤§å¤æ°åºæ¯çæ§è½è¦æ±ã\n\nç¹æ§                activemq                     rabbitmq                        rocketmq                                      kafka\nåæºååé             ä¸çº§ï¼æ¯ rocketmqãkafka ä½ä¸ä¸ªæ°éçº§   å activemq                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡æµå¼è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ rocketmq   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ rabbitmq çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å activemq                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å rocketmq\nåè½æ¯æ              mq é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   mq åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç mq åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸å¡ç³»ç»åºæ¯ï¼å»ºè®®ä½¿ç¨ rocketmqãrabbitmqãå¦æææåºç¨é½æ¯ javaï¼ä¼é rocketmqï¼å ä¸º rocketmq æ¬èº«å°±æ¯ java å¼åçï¼æä»¥æééãå¦æä¸å¡ä¸­æå¤ç§ç¼ç¨è¯­è¨çåºç¨ï¼å»ºè®®éæ© rabbitmqã\n * å¤§æ°æ®åæµå¼è®¡ç®é¢åï¼ææ¯ä½ä¸ºæ¥å¿ç¼å²ï¼å¼ºçå»ºè®®éæ© kafkaï¼ä¸çæ åï¼ä¹ç»èéªã\n\n\n# jms\n\næå° mqï¼å°±é¡ºä¾¿æä¸ä¸ jms ã\n\njmsï¼java message serviceï¼java æ¶æ¯æå¡ï¼api æ¯ä¸ä¸ªæ¶æ¯æå¡çæ å/è§èï¼åè®¸åºç¨ç¨åºç»ä»¶åºäº javaee å¹³å°åå»ºãåéãæ¥æ¶åè¯»åæ¶æ¯ãå®ä½¿åå¸å¼éä¿¡è¦ååº¦æ´ä½ï¼æ¶æ¯æå¡æ´å å¯é ä»¥åå¼æ­¥æ§ã\n\nå¨ ejb æ¶æä¸­ï¼ææ¶æ¯ bean å¯ä»¥æ ç¼çä¸ jms æ¶æ¯æå¡éæãå¨ j2ee æ¶ææ¨¡å¼ä¸­ï¼ææ¶æ¯æå¡èæ¨¡å¼ï¼ç¨äºå®ç°æ¶æ¯ä¸åºç¨ç´æ¥çè§£è¦ã\n\n\n# æ¶æ¯æ¨¡å\n\nå¨ jms æ åä¸­ï¼æä¸¤ç§æ¶æ¯æ¨¡åï¼\n\n * p2p(point to point)\n * pub/sub(publish/subscribe)\n\n# p2p æ¨¡å¼\n\n\np2p æ¨¡å¼åå«ä¸ä¸ªè§è²ï¼mqï¼queueï¼ï¼åéè(sender)ï¼æ¥æ¶è(receiver)ãæ¯ä¸ªæ¶æ¯é½è¢«åéå°ä¸ä¸ªç¹å®çéåï¼æ¥æ¶èä»éåä¸­è·åæ¶æ¯ãéåä¿ççæ¶æ¯ï¼ç´å°ä»ä»¬è¢«æ¶è´¹æè¶æ¶ã\n\np2p çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯åªæä¸ä¸ªæ¶è´¹èï¼consumerï¼(å³ä¸æ¦è¢«æ¶è´¹ï¼æ¶æ¯å°±ä¸åå¨ mq ä¸­)\n * åéèåæ¥æ¶èä¹é´å¨æ¶é´ä¸æ²¡æä¾èµæ§ï¼ä¹å°±æ¯è¯´å½åéèåéäºæ¶æ¯ä¹åï¼ä¸ç®¡æ¥æ¶èææ²¡ææ­£å¨è¿è¡ï¼å®ä¸ä¼å½±åå°æ¶æ¯è¢«åéå°éå\n * æ¥æ¶èå¨æåæ¥æ¶æ¶æ¯ä¹åéåéååºç­æå\n\nå¦æå¸æåéçæ¯ä¸ªæ¶æ¯é½ä¼è¢«æåå¤ççè¯ï¼é£ä¹éè¦ p2p æ¨¡å¼ã\n\n# pub/sub æ¨¡å¼\n\n\nåå«ä¸ä¸ªè§è²ä¸»é¢ï¼topicï¼ï¼åå¸èï¼publisherï¼ï¼è®¢éèï¼subscriberï¼ ãå¤ä¸ªåå¸èå°æ¶æ¯åéå° topic,ç³»ç»å°è¿äºæ¶æ¯ä¼ éç»å¤ä¸ªè®¢éèã\n\npub/sub çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯å¯ä»¥æå¤ä¸ªæ¶è´¹è\n * åå¸èåè®¢éèä¹é´ææ¶é´ä¸çä¾èµæ§ãéå¯¹æä¸ªä¸»é¢ï¼topicï¼çè®¢éèï¼å®å¿é¡»åå»ºä¸ä¸ªè®¢éèä¹åï¼æè½æ¶è´¹åå¸èçæ¶æ¯ã\n * ä¸ºäºæ¶è´¹æ¶æ¯ï¼è®¢éèå¿é¡»ä¿æè¿è¡çç¶æã\n\nä¸ºäºç¼åè¿æ ·ä¸¥æ ¼çæ¶é´ç¸å³æ§ï¼jms åè®¸è®¢éèåå»ºä¸ä¸ªå¯æä¹åçè®¢éãè¿æ ·ï¼å³ä½¿è®¢éèæ²¡æè¢«æ¿æ´»ï¼è¿è¡ï¼ï¼å®ä¹è½æ¥æ¶å°åå¸èçæ¶æ¯ã\n\nå¦æå¸æåéçæ¶æ¯å¯ä»¥ä¸è¢«åä»»ä½å¤çãæèåªè¢«ä¸ä¸ªæ¶æ¯èå¤çãæèå¯ä»¥è¢«å¤ä¸ªæ¶è´¹èå¤ççè¯ï¼é£ä¹å¯ä»¥éç¨ pub/sub æ¨¡åã\n\n\n# æ¶æ¯æ¶è´¹\n\nå¨ jms ä¸­ï¼æ¶æ¯çäº§çåæ¶è´¹é½æ¯å¼æ­¥çãå¯¹äºæ¶è´¹æ¥è¯´ï¼jms çæ¶æ¯èå¯ä»¥éè¿ä¸¤ç§æ¹å¼æ¥æ¶è´¹æ¶æ¯ã\n\n * åæ­¥ - è®¢éèææ¥æ¶èéè¿ receive æ¹æ³æ¥æ¥æ¶æ¶æ¯ï¼receive æ¹æ³å¨æ¥æ¶å°æ¶æ¯ä¹åï¼æè¶æ¶ä¹åï¼å°ä¸ç´é»å¡ï¼\n * å¼æ­¥ - è®¢éèææ¥æ¶èå¯ä»¥æ³¨åä¸ºä¸ä¸ªæ¶æ¯çå¬å¨ãå½æ¶æ¯å°è¾¾ä¹åï¼ç³»ç»èªå¨è°ç¨çå¬å¨ç onmessage æ¹æ³ã\n\njndi - java å½ååç®å½æ¥å£,æ¯ä¸ç§æ åç java å½åç³»ç»æ¥å£ãå¯ä»¥å¨ç½ç»ä¸æ¥æ¾åè®¿é®æå¡ãéè¿æå®ä¸ä¸ªèµæºåç§°ï¼è¯¥åç§°å¯¹åºäºæ°æ®åºæå½åæå¡ä¸­çä¸ä¸ªè®°å½ï¼åæ¶è¿åèµæºè¿æ¥å»ºç«æå¿é¡»çä¿¡æ¯ã\n\njndi å¨ jms ä¸­èµ·å°æ¥æ¾åè®¿é®åéç®æ ææ¶æ¯æ¥æºçä½ç¨ã\n\n\n# jms ç¼ç¨æ¨¡å\n\n# connectionfactory\n\nåå»º connection å¯¹è±¡çå·¥åï¼éå¯¹ä¸¤ç§ä¸åç jms æ¶æ¯æ¨¡åï¼åå«æ queueconnectionfactory å topicconnectionfactory ä¸¤ç§ãå¯ä»¥éè¿ jndi æ¥æ¥æ¾ connectionfactory å¯¹è±¡ã\n\n# destination\n\ndestination çæææ¯æ¶æ¯çäº§èçæ¶æ¯åéç®æ æèè¯´æ¶æ¯æ¶è´¹èçæ¶æ¯æ¥æºãå¯¹äºæ¶æ¯çäº§èæ¥è¯´ï¼å®ç destination æ¯æä¸ªéåï¼queueï¼ææä¸ªä¸»é¢ï¼topicï¼;å¯¹äºæ¶æ¯æ¶è´¹èæ¥è¯´ï¼å®ç destination ä¹æ¯æä¸ªéåæä¸»é¢ï¼å³æ¶æ¯æ¥æºï¼ã\n\næä»¥ï¼destination å®éä¸å°±æ¯ä¸¤ç§ç±»åçå¯¹è±¡ï¼queueãtopicãå¯ä»¥éè¿ jndi æ¥æ¥æ¾ destinationã\n\n# connection\n\nconnection è¡¨ç¤ºå¨å®¢æ·ç«¯å jms ç³»ç»ä¹é´å»ºç«çé¾æ¥ï¼å¯¹ tcp/ip socket çåè£ï¼ãconnection å¯ä»¥äº§çä¸ä¸ªæå¤ä¸ª sessionãè· connectionfactory ä¸æ ·ï¼connection ä¹æä¸¤ç§ç±»åï¼queueconnection å topicconnectionã\n\n# session\n\nsession æ¯æä½æ¶æ¯çæ¥å£ãå¯ä»¥éè¿ session åå»ºçäº§èãæ¶è´¹èãæ¶æ¯ç­ãsession æä¾äºäºå¡çåè½ãå½éè¦ä½¿ç¨ session åé/æ¥æ¶å¤ä¸ªæ¶æ¯æ¶ï¼å¯ä»¥å°è¿äºåé/æ¥æ¶å¨ä½æ¾å°ä¸ä¸ªäºå¡ä¸­ãåæ ·ï¼ä¹å queuesession å topicsessionã\n\n# æ¶æ¯ççäº§è\n\næ¶æ¯çäº§èç± session åå»ºï¼å¹¶ç¨äºå°æ¶æ¯åéå° destinationãåæ ·ï¼æ¶æ¯çäº§èåä¸¤ç§ç±»åï¼queuesender å topicpublisherãå¯ä»¥è°ç¨æ¶æ¯çäº§èçæ¹æ³ï¼send æ publish æ¹æ³ï¼åéæ¶æ¯ã\n\n# æ¶æ¯æ¶è´¹è\n\næ¶æ¯æ¶è´¹èç± session åå»ºï¼ç¨äºæ¥æ¶è¢«åéå° destination çæ¶æ¯ãä¸¤ç§ç±»åï¼queuereceiver å topicsubscriberãå¯åå«éè¿ session ç createreceiver(queue)æ createsubscriber(topic)æ¥åå»ºãå½ç¶ï¼ä¹å¯ä»¥ session ç creatdurablesubscriber æ¹æ³æ¥åå»ºæä¹åçè®¢éèã\n\n# messagelistener\n\næ¶æ¯çå¬å¨ãå¦ææ³¨åäºæ¶æ¯çå¬å¨ï¼ä¸æ¦æ¶æ¯å°è¾¾ï¼å°èªå¨è°ç¨çå¬å¨ç onmessage æ¹æ³ãejb ä¸­ç mdbï¼message-driven beanï¼å°±æ¯ä¸ç§ messagelistenerã\n\n\n# åèèµæ\n\n * å¤§åç½ç«æ¶æç³»åï¼åå¸å¼ mqï¼ä¸ï¼\n * å¤§åç½ç«æ¶æç³»åï¼mqï¼äºï¼\n * åå¸å¼å¼æ¾ mq(rocketmq)çåçä¸å®è·µ\n * é¿é rocketmq ä¼å¿å¯¹æ¯\n * advanced-java ä¹ mq\n * æµè°æ¶æ¯éååå¸¸è§çæ¶æ¯ä¸­é´ä»¶',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"RocketMQ å¿«éå¥é¨",frontmatter:{title:"RocketMQ å¿«éå¥é¨",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","MQ"],tags:["Java","ä¸­é´ä»¶","MQ","RocketMQ"],abbrlink:"3e7adddd",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/f56a96/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.MQ/03.RocketMQ.html",relativePath:"14.ä¸­é´ä»¶/01.MQ/03.RocketMQ.md",key:"v-5df11448",path:"/pages/f56a96/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:20},{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:1266},{level:3,title:"ç¯å¢è¦æ±",slug:"ç¯å¢è¦æ±",normalizedTitle:"ç¯å¢è¦æ±",charIndex:1273},{level:3,title:"ä¸è½½è§£å",slug:"ä¸è½½è§£å",normalizedTitle:"ä¸è½½è§£å",charIndex:1353},{level:3,title:"å¯å¨ Name Server",slug:"å¯å¨-name-server",normalizedTitle:"å¯å¨ name server",charIndex:1526},{level:3,title:"å¯å¨ Broker",slug:"å¯å¨-broker",normalizedTitle:"å¯å¨ broker",charIndex:1648},{level:3,title:"æ¶åæ¶æ¯",slug:"æ¶åæ¶æ¯",normalizedTitle:"æ¶åæ¶æ¯",charIndex:1821},{level:3,title:"å³é­æå¡å¨",slug:"å³é­æå¡å¨",normalizedTitle:"å³é­æå¡å¨",charIndex:2196},{level:2,title:"API",slug:"api",normalizedTitle:"api",charIndex:2422},{level:3,title:"Producer",slug:"producer",normalizedTitle:"producer",charIndex:150},{level:4,title:"å¯é çåæ­¥åé",slug:"å¯é çåæ­¥åé",normalizedTitle:"å¯é çåæ­¥åé",charIndex:2660},{level:4,title:"å¯é çå¼æ­¥åé",slug:"å¯é çå¼æ­¥åé",normalizedTitle:"å¯é çå¼æ­¥åé",charIndex:2671},{level:4,title:"ååä¼ è¾",slug:"ååä¼ è¾",normalizedTitle:"ååä¼ è¾",charIndex:5083},{level:3,title:"Consumer",slug:"consumer",normalizedTitle:"consumer",charIndex:392},{level:3,title:"FAQ",slug:"faq",normalizedTitle:"faq",charIndex:7656},{level:4,title:"connect to <172.17.0.1:10909> failed",slug:"connect-to-172-17-0-1-10909-failed",normalizedTitle:"connect to &lt;172.17.0.1:10909&gt; failed",charIndex:null},{level:2,title:"æ¶æ",slug:"æ¶æ",normalizedTitle:"æ¶æ",charIndex:9309},{level:3,title:"Producer",slug:"producer-2",normalizedTitle:"producer",charIndex:150},{level:3,title:"Consumer",slug:"consumer-2",normalizedTitle:"consumer",charIndex:392},{level:3,title:"NameServer",slug:"nameserver",normalizedTitle:"nameserver",charIndex:9331},{level:3,title:"Broker",slug:"broker",normalizedTitle:"broker",charIndex:414},{level:2,title:"åç",slug:"åç",normalizedTitle:"åç",charIndex:10949},{level:3,title:"é¡ºåºæ¶æ¯",slug:"é¡ºåºæ¶æ¯",normalizedTitle:"é¡ºåºæ¶æ¯",charIndex:11050},{level:4,title:"ç¬¬ä¸ç§æ¨¡å",slug:"ç¬¬ä¸ç§æ¨¡å",normalizedTitle:"ç¬¬ä¸ç§æ¨¡å",charIndex:11058},{level:4,title:"ç¬¬äºç§æ¨¡å",slug:"ç¬¬äºç§æ¨¡å",normalizedTitle:"ç¬¬äºç§æ¨¡å",charIndex:11361},{level:3,title:"æ¶æ¯éå¤",slug:"æ¶æ¯éå¤",normalizedTitle:"æ¶æ¯éå¤",charIndex:12040},{level:3,title:"äºå¡æ¶æ¯",slug:"äºå¡æ¶æ¯",normalizedTitle:"äºå¡æ¶æ¯",charIndex:14058},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:14316}],headersStr:"ç®ä» å®è£ ç¯å¢è¦æ± ä¸è½½è§£å å¯å¨ Name Server å¯å¨ Broker æ¶åæ¶æ¯ å³é­æå¡å¨ API Producer å¯é çåæ­¥åé å¯é çå¼æ­¥åé ååä¼ è¾ Consumer FAQ connect to <172.17.0.1:10909> failed æ¶æ Producer Consumer NameServer Broker åç é¡ºåºæ¶æ¯ ç¬¬ä¸ç§æ¨¡å ç¬¬äºç§æ¨¡å æ¶æ¯éå¤ äºå¡æ¶æ¯ åèèµæ",content:'# RocketMQ å¿«éå¥é¨\n\n\n# ç®ä»\n\nRocketMQ æ¯ä¸æ¬¾å¼æºçåå¸å¼æ¶æ¯éåï¼åºäºé«å¯ç¨åå¸å¼éç¾¤ææ¯ï¼æä¾ä½å»¶æ¶çãé«å¯é çæ¶æ¯åå¸ä¸è®¢éæå¡ã\n\nRocketMQ è¢«é¿éå·´å·´æèµ ç» Apacheï¼æä¸º Apache çå­µåé¡¹ç®ã\n\n\n\nRocketMQ æä»¥ä¸æ ¸å¿æ¦å¿µï¼\n\n * Producer - å°ä¸å¡åºç¨ç¨åºç³»ç»çæçæ¶æ¯åéç»ä»£çãRocketMQ æä¾å¤ç§åéèä¾ï¼åæ­¥ï¼å¼æ­¥åååã\n   * Producer Group - å·æç¸åè§è²ç Producer ç»åå¨ä¸èµ·ãå¦æåå§ Producer å¨äºå¡ä¹åå´©æºï¼åä»£çå¯ä»¥èç³»åä¸ Producer ç»çä¸å Producer å®ä¾ä»¥æäº¤æåæ»äºå¡ãè­¦åï¼èèå°æä¾ç Producer å¨åéæ¶æ¯æ¹é¢è¶³å¤å¼ºå¤§ï¼æ¯ä¸ª Producer ç»åªåè®¸ä¸ä¸ªå®ä¾ï¼ä»¥é¿åä¸å¿è¦ççæå¨å®ä¾åå§åã\n * Consumer - Consumer ä» Broker é£éè·åæ¶æ¯å¹¶å°å¶æä¾ç»åºç¨ç¨åºãä»ç¨æ·åºç¨çè§åº¦æ¥çï¼æä¾äºä¸¤ç§ç±»åç Consumerï¼\n   * PullConsumer - PullConsumer ç§¯æå°ä» Broker é£éè·åæ¶æ¯ãä¸æ¦æåäºæ¹éæ¶æ¯ï¼ç¨æ·åºç¨ç¨åºå°±ä¼å¯å¨æ¶è´¹è¿ç¨ã\n   * PushConsumer - PushConsumer å°è£æ¶æ¯æåï¼æ¶è´¹è¿åº¦å¹¶ç»´æ¤å¶ä»åé¨å·¥ä½ï¼ä¸ºæç»ç¨æ·çä¸åè°æ¥å£ï¼è¿ä¸ªåå£ä¼å¨æ¶æ¯å°è¾¾æ¶è¢«æ§è¡ã\n   * Consumer Group - å®å¨ç¸åè§è²ç Consumer è¢«ç»åå¨ä¸èµ·å¹¶å½åä¸º Consumer GroupãConsumer Group æ¯ä¸ä¸ªå¾å¥½çæ¦å¿µï¼å¨æ¶æ¯æ¶è´¹æ¹é¢å®ç°è´è½½å¹³è¡¡åå®¹éç®æ éå¸¸å®¹æãè­¦åï¼Consumer Group ä¸­ç Consumer å®ä¾å¿é¡»å·æå®å¨ç¸åçä¸»é¢è®¢éã\n * Broker - Broker æ¯ RocketMQ çä¸»è¦ç»æé¨åãå®æ¥æ¶ä» Producer åéçæ¶æ¯ï¼å­å¨å®ä»¬å¹¶åå¤å¤çæ¥èª Consumer çæ¶è´¹è¯·æ±ãå®è¿å­å¨ä¸æ¶æ¯ç¸å³çåæ°æ®ï¼åæ¬ Consumer Groupï¼æ¶èè¿åº¦åç§»åä¸»é¢/éåä¿¡æ¯ã\n * Name Server - åå½è·¯ç±ä¿¡æ¯æä¾èãProducer/Consumer å®¢æ·æ¥æ¾ä¸»é¢ä»¥æ¥æ¾ç¸åºç Broker åè¡¨ã\n * Topic - æ¯ Producer ä¼ éæ¶æ¯å Consumer æåæ¶æ¯çç±»å«ã\n * Message - æ¯è¦ä¼ éçä¿¡æ¯ãæ¶æ¯å¿é¡»æä¸ä¸ªä¸»é¢ï¼å¯ä»¥å°å¶è§£éä¸ºæ¨è¦åéç»çé®ä»¶å°åãæ¶æ¯è¿å¯ä»¥å·æå¯é Tag åé¢å¤çé®å¼å¯¹ãä¾å¦ï¼æ¨å¯ä»¥ä¸ºæ¶æ¯è®¾ç½®ä¸å¡å¯é¥ï¼å¹¶å¨ä»£çæå¡å¨ä¸æ¥æ¾æ¶æ¯ä»¥è¯æ­å¼åæé´çé®é¢ã\n   * Message Queue - ä¸»é¢è¢«ååä¸ºä¸ä¸ªæå¤ä¸ªå­ä¸»é¢âæ¶æ¯éåâã\n   * Tag - å³å­ä¸»é¢ï¼ä¸ºç¨æ·æä¾äºé¢å¤ççµæ´»æ§ãå¯¹äº Tagï¼æ¥èªåä¸ä¸å¡æ¨¡åçå·æä¸åç®ççæ¶æ¯å¯ä»¥å·æç¸åçä¸»é¢åä¸åç Tagã\n\n\n# å®è£\n\n\n# ç¯å¢è¦æ±\n\n * æ¨è 64 ä½æä½ç³»ç»ï¼Linux/Unix/Mac\n * 64bit JDK 1.8+\n * Maven 3.2.x\n * Git\n\n\n# ä¸è½½è§£å\n\nè¿å¥å®æ¹ä¸è½½å°åï¼https://rocketmq.apache.org/dowloading/releases/ï¼éæ©åéçæ¬\n\nå»ºè®®éæ© binary çæ¬ã\n\nè§£åå°æ¬å°ï¼\n\n> unzip rocketmq-all-4.2.0-source-release.zip\n> cd rocketmq-all-4.2.0/\n\n\n\n# å¯å¨ Name Server\n\n> nohup sh bin/mqnamesrv &\n> tail -f ~/logs/rocketmqlogs/namesrv.log\nThe Name Server boot success...\n\n\n\n# å¯å¨ Broker\n\n> nohup sh bin/mqbroker -n localhost:9876 -c conf/broker.conf &\n> tail -f ~/logs/rocketmqlogs/broker.log\nThe broker[%s, 172.30.30.233:10911] boot success...\n\n\n\n# æ¶åæ¶æ¯\n\næ§è¡æ¶åæ¶æ¯æä½ä¹åï¼ä¸è®¸åè¯å®¢æ·ç«¯å½åæå¡å¨çä½ç½®ãå¨ RocketMQ ä¸­æå¤ç§æ¹æ³æ¥å®ç°è¿ä¸ªç®çãè¿éï¼æä»¬ä½¿ç¨æç®åçæ¹æ³ââè®¾ç½®ç¯å¢åé NAMESRV_ADDR ï¼\n\n> export NAMESRV_ADDR=localhost:9876\n> sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer\nSendResult [sendStatus=SEND_OK, msgId= ...\n\n> sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer\nConsumeMessageThread_%d Receive New Messages: [MessageExt...\n\n\n\n# å³é­æå¡å¨\n\n> sh bin/mqshutdown broker\nThe mqbroker(36695) is running...\nSend shutdown request to mqbroker(36695) OK\n\n> sh bin/mqshutdown namesrv\nThe mqnamesrv(36664) is running...\nSend shutdown request to mqnamesrv(36664) OK\n\n\n\n# API\n\né¦åå¨é¡¹ç®ä¸­å¼å¥ maven ä¾èµï¼\n\n<dependency>\n    <groupId>org.apache.rocketmq</groupId>\n    <artifactId>rocketmq-client</artifactId>\n    <version>4.2.0</version>\n</dependency>\n\n\n\n# Producer\n\nProducer å¨ RocketMQ ä¸­è´è´£åéæ¶æ¯ã\n\nRocketMQ æä¸ç§æ¶æ¯åéæ¹å¼ï¼\n\n * å¯é çåæ­¥åé\n * å¯é çå¼æ­¥åé\n * åé¡¹åé\n\n# å¯é çåæ­¥åé\n\nå¯é çåæ­¥ä¼ è¾ç¨äºå¹¿æ³çåºæ¯ï¼å¦éè¦çéç¥æ¶æ¯ï¼ç­ä¿¡éç¥ï¼ç­ä¿¡è¥éç³»ç»ç­ã\n\npublic class SyncProducer {\n    public static void main(String[] args) throws Exception {\n        //Instantiate with a producer group name.\n        DefaultMQProducer producer = new\n            DefaultMQProducer("please_rename_unique_group_name");\n        //Launch the instance.\n        producer.start();\n        for (int i = 0; i < 100; i++) {\n            //Create a message instance, specifying topic, tag and message body.\n            Message msg = new Message("TopicTest" /* Topic */,\n                "TagA" /* Tag */,\n                ("Hello RocketMQ " +\n                    i).getBytes(RemotingHelper.DEFAULT_CHARSET) /* Message body */\n            );\n            //Call send message to deliver message to one of brokers.\n            SendResult sendResult = producer.send(msg);\n            System.out.printf("%s%n", sendResult);\n        }\n        //Shut down once the producer instance is not longer in use.\n        producer.shutdown();\n    }\n}\n\n\n# å¯é çå¼æ­¥åé\n\nå¼æ­¥ä¼ è¾éå¸¸ç¨äºååºæ¶é´ææçä¸å¡åºæ¯ã\n\npublic class AsyncProducer {\n    public static void main(String[] args) throws Exception {\n        //Instantiate with a producer group name.\n        DefaultMQProducer producer = new DefaultMQProducer("ExampleProducerGroup");\n        //Launch the instance.\n        producer.start();\n        producer.setRetryTimesWhenSendAsyncFailed(0);\n        for (int i = 0; i < 100; i++) {\n                final int index = i;\n                //Create a message instance, specifying topic, tag and message body.\n                Message msg = new Message("TopicTest",\n                    "TagA",\n                    "OrderID188",\n                    "Hello world".getBytes(RemotingHelper.DEFAULT_CHARSET));\n                producer.send(msg, new SendCallback() {\n                    @Override\n                    public void onSuccess(SendResult sendResult) {\n                        System.out.printf("%-10d OK %s %n", index,\n                            sendResult.getMsgId());\n                    }\n                    @Override\n                    public void onException(Throwable e) {\n                        System.out.printf("%-10d Exception %s %n", index, e);\n                        e.printStackTrace();\n                    }\n                });\n        }\n        //Shut down once the producer instance is not longer in use.\n        producer.shutdown();\n    }\n}\n\n\n# ååä¼ è¾\n\nååä¼ è¾ç¨äºéè¦ä¸­ç­å¯é æ§çæåµï¼ä¾å¦æ¥å¿æ¶éã\n\npublic class OnewayProducer {\n    public static void main(String[] args) throws Exception{\n        //Instantiate with a producer group name.\n        DefaultMQProducer producer = new DefaultMQProducer("ExampleProducerGroup");\n        //Launch the instance.\n        producer.start();\n        for (int i = 0; i < 100; i++) {\n            //Create a message instance, specifying topic, tag and message body.\n            Message msg = new Message("TopicTest" /* Topic */,\n                "TagA" /* Tag */,\n                ("Hello RocketMQ " +\n                    i).getBytes(RemotingHelper.DEFAULT_CHARSET) /* Message body */\n            );\n            //Call send message to deliver message to one of brokers.\n            producer.sendOneway(msg);\n\n        }\n        //Shut down once the producer instance is not longer in use.\n        producer.shutdown();\n    }\n}\n\n\n\n# Consumer\n\nConsumer å¨ RocketMQ ä¸­è´è´£æ¥æ¶æ¶æ¯ã\n\npublic class OrderedConsumer {\n    public static void main(String[] args) throws Exception {\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer("example_group_name");\n        consumer.setNamesrvAddr(RocketConfig.HOST);\n\n        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);\n\n        consumer.subscribe("TopicTest", "TagA || TagC || TagD");\n\n        consumer.registerMessageListener(new MessageListenerOrderly() {\n\n            AtomicLong consumeTimes = new AtomicLong(0);\n\n            @Override\n            public ConsumeOrderlyStatus consumeMessage(List<MessageExt> msgs,\n                ConsumeOrderlyContext context) {\n                context.setAutoCommit(false);\n                System.out.printf(Thread.currentThread().getName() + " Receive New Messages: " + msgs + "%n");\n                this.consumeTimes.incrementAndGet();\n                if ((this.consumeTimes.get() % 2) == 0) {\n                    return ConsumeOrderlyStatus.SUCCESS;\n                } else if ((this.consumeTimes.get() % 3) == 0) {\n                    return ConsumeOrderlyStatus.ROLLBACK;\n                } else if ((this.consumeTimes.get() % 4) == 0) {\n                    return ConsumeOrderlyStatus.COMMIT;\n                } else if ((this.consumeTimes.get() % 5) == 0) {\n                    context.setSuspendCurrentQueueTimeMillis(3000);\n                    return ConsumeOrderlyStatus.SUSPEND_CURRENT_QUEUE_A_MOMENT;\n                }\n                return ConsumeOrderlyStatus.SUCCESS;\n\n            }\n        });\n\n        consumer.start();\n\n        System.out.printf("Consumer Started.%n");\n    }\n}\n\n\n\n# FAQ\n\n# connect to <172.17.0.1:10909> failed\n\nå¯å¨åï¼Producer å®¢æ·ç«¯è¿æ¥ RocketMQ æ¶æ¥éï¼\n\norg.apache.rocketmq.remoting.exception.RemotingConnectException: connect to <172.17.0.1:10909> failed\n    at org.apache.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:357)\n    at org.apache.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:343)\n    at org.apache.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:327)\n    at org.apache.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:290)\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:688)\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:901)\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:878)\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:873)\n    at org.apache.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:369)\n    at com.emrubik.uc.mdm.sync.utils.MdmInit.sendMessage(MdmInit.java:62)\n    at com.emrubik.uc.mdm.sync.utils.MdmInit.main(MdmInit.java:2149)\n\n\nåå ï¼RocketMQ é¨ç½²å¨èææºä¸ï¼åç½ ip ä¸º 10.10.30.63ï¼è¯¥èææºä¸ä¸ª docker0 ç½å¡ï¼ip ä¸º 172.17.0.1ãRocketMQ broker å¯å¨æ¶é»è®¤ä½¿ç¨äº docker0 ç½å¡ï¼Producer å®¢æ·ç«¯æ æ³è¿æ¥ 172.17.0.1ï¼é æä»¥ä¸é®é¢ã\n\nè§£å³æ¹æ¡\n\nï¼1ï¼å¹²æ docker0 ç½å¡æä¿®æ¹ç½å¡åç§°\n\nï¼2ï¼åæ brokerï¼ä¿®æ¹ broker éç½®æä»¶ï¼éå¯ brokerã\n\nä¿®æ¹ conf/broker.confï¼å¢å ä¸¤è¡æ¥æå®å¯å¨ broker ç IPï¼\n\nnamesrvAddr = 10.10.30.63:9876\nbrokerIP1 = 10.10.30.63\n\n\nå¯å¨æ¶éè¦æå®éç½®æä»¶\n\nnohup sh bin/mqbroker -n localhost:9876 -c conf/broker.conf &\n\n\n\n# æ¶æ\n\n\n\nRocketMQ ç±åé¨åç»æï¼NameServerãBrokerãProducerãConsumerãå¶ä¸­ä»»æä¸ä¸ªç»æé½å¯ä»¥æ°´å¹³æ©å±ä¸ºéç¾¤æ¨¡å¼ï¼ä»¥é¿ååç¹æéé®é¢ã\n\n\n# Producer\n\nProducers æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ãProducer éè¿ MQ çè´è½½åè¡¡æ¨¡åéæ©ç¸åºç Broker éç¾¤éåè¿è¡æ¶æ¯æéï¼æéçè¿ç¨æ¯æå¿«éå¤±è´¥å¹¶ä¸ä½å»¶è¿ã\n\n\n# Consumer\n\nConsumer æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ãæ¯æä»¥ push æ¨ï¼pull æä¸¤ç§æ¨¡å¼å¯¹æ¶æ¯è¿è¡æ¶è´¹ãåæ¶ä¹æ¯æéç¾¤æ¹å¼åå¹¿æ­æ¹å¼çæ¶è´¹ï¼å®æä¾å®æ¶æ¶æ¯è®¢éæºå¶ï¼å¯ä»¥æ»¡è¶³å¤§å¤æ°ç¨æ·çéæ±ã\n\n\n# NameServer\n\nNameServer æ¯ä¸ä¸ª Topic è·¯ç±æ³¨åä¸­å¿ï¼å¶è§è²ç±»ä¼¼ Dubbo ä¸­ç zookeeperï¼æ¯æ Broker çå¨ææ³¨åä¸åç°ãä¸»è¦åæ¬ä¸¤ä¸ªåè½ï¼\n\n * Broker ç®¡çï¼NameServer æ¥å Broker éç¾¤çæ³¨åä¿¡æ¯å¹¶ä¸ä¿å­ä¸æ¥ä½ä¸ºè·¯ç±ä¿¡æ¯çåºæ¬æ°æ®ãç¶åæä¾å¿è·³æ£æµæºå¶ï¼æ£æ¥ Broker æ¯å¦è¿å­æ´»ï¼\n * è·¯ç±ä¿¡æ¯ç®¡çï¼æ¯ä¸ª NameServer å°ä¿å­å³äº Broker éç¾¤çæ´ä¸ªè·¯ç±ä¿¡æ¯åç¨äºå®¢æ·ç«¯æ¥è¯¢çéåä¿¡æ¯ãç¶å Producer å Conumser éè¿ NameServer å°±å¯ä»¥ç¥éæ´ä¸ª Broker éç¾¤çè·¯ç±ä¿¡æ¯ï¼ä»èè¿è¡æ¶æ¯çæéåæ¶è´¹ã\n\nNameServer éå¸¸ä¹æ¯éç¾¤çæ¹å¼é¨ç½²ï¼åå®ä¾é´ç¸äºä¸è¿è¡ä¿¡æ¯éè®¯ãBroker æ¯åæ¯ä¸å° NameServer æ³¨åèªå·±çè·¯ç±ä¿¡æ¯ï¼æä»¥æ¯ä¸ä¸ª NameServer å®ä¾ä¸é¢é½ä¿å­ä¸ä»½å®æ´çè·¯ç±ä¿¡æ¯ãå½æä¸ª NameServer å æç§åå ä¸çº¿äºï¼Broker ä»ç¶å¯ä»¥åå¶å® NameServer åæ­¥å¶è·¯ç±ä¿¡æ¯ï¼ProducerãConsumer ä»ç¶å¯ä»¥å¨ææç¥ Broker çè·¯ç±çä¿¡æ¯ã\n\nNameServer æ¯ä¸ä¸ªåè½é½å¨çæå¡å¨ï¼ä¸»è¦åæ¬ä¸¤ä¸ªåè½ï¼\n\n 1. Broker ç®¡ç - NameServer æ¥åæ¥èª Broker éç¾¤çæ³¨åï¼å¹¶æä¾å¿è·³æºå¶æ¥æ£æ¥ Broker èç¹æ¯å¦å­æ´»ã\n 2. è·¯ç±ç®¡ç - æ¯ä¸ª NameServer å°ä¿å­æå³ Broker éç¾¤çå®æ´è·¯ç±ä¿¡æ¯åå®¢æ·ç«¯æ¥è¯¢çæ¥è¯¢éåã\n\nRocketMQ å®¢æ·ç«¯ï¼Producer/Consumerï¼å°ä» NameServer æ¥è¯¢éåè·¯ç±ä¿¡æ¯ã\n\nå° NameServer å°ååè¡¨æä¾ç»å®¢æ·ç«¯æåç§æ¹æ³ï¼\n\n 1. ç¼ç¨æ¹å¼ - ç±»ä¼¼ï¼producer.setNamesrvAddr("ip:port")\n 2. Java éé¡¹ - ä½¿ç¨ rocketmq.namesrv.addr åæ°\n 3. ç¯å¢åé - è®¾ç½®ç¯å¢åé NAMESRV_ADDR\n 4. HTTP ç«¯ç¹\n\n> æ´è¯¦ç»ä¿¡æ¯å¯ä»¥åèå®æ¹ææ¡£ï¼here\n\n\n# Broker\n\nBroker ä¸»è¦è´è´£æ¶æ¯çå­å¨ãæéåæ¥è¯¢ä»¥åæå¡é«å¯ç¨ä¿è¯ï¼ä¸ºäºå®ç°è¿äºåè½ï¼Broker åå«äºä»¥ä¸å ä¸ªéè¦å­æ¨¡åã\n\nBroker æå ä¸ªéè¦çå­æ¨¡åï¼\n\n * Remoting Moduleï¼æ´ä¸ª Broker çå®ä½ï¼è´è´£å¤çæ¥èª clients ç«¯çè¯·æ±ã\n * Client Managerï¼è´è´£ç®¡çå®¢æ·ç«¯(Producer/Consumer)åç»´æ¤ Consumer ç Topic è®¢éä¿¡æ¯ã\n * Store Serviceï¼æä¾æ¹ä¾¿ç®åç API æ¥å£å¤çæ¶æ¯å­å¨å°ç©çç¡¬çåæ¥è¯¢åè½ã\n * HA Serviceï¼é«å¯ç¨æå¡ï¼æä¾ Master Broker å Slave Broker ä¹é´çæ°æ®åæ­¥åè½ã\n * Index Serviceï¼æ ¹æ®ç¹å®ç Message key å¯¹æéå° Broker çæ¶æ¯è¿è¡ç´¢å¼æå¡ï¼ä»¥æä¾æ¶æ¯çå¿«éæ¥è¯¢ã\n\n\n\n\n# åç\n\nåå¸å¼æ¶æ¯ç³»ç»ä½ä¸ºå®ç°åå¸å¼ç³»ç»å¯æ©å±ãå¯ä¼¸ç¼©æ§çå³é®ç»ä»¶ï¼éè¦å·æé«ååéãé«å¯ç¨ç­ç¹ç¹ãèè°å°æ¶æ¯ç³»ç»çè®¾è®¡ï¼å°±åé¿ä¸äºä¸¤ä¸ªé®é¢ï¼\n\n 1. æ¶æ¯çé¡ºåºé®é¢\n 2. æ¶æ¯çéå¤é®é¢\n\n\n# é¡ºåºæ¶æ¯\n\n# ç¬¬ä¸ç§æ¨¡å\n\nåå¦çäº§èäº§çäº 2 æ¡æ¶æ¯ï¼M1ãM2ï¼è¦ä¿è¯è¿ä¸¤æ¡æ¶æ¯çé¡ºåºï¼åºè¯¥ææ ·åï¼ä½ èä¸­æ³å°çå¯è½æ¯è¿æ ·ï¼\n\n\n\nåå® M1 åéå° S1ï¼M2 åéå° S2ï¼å¦æè¦ä¿è¯ M1 åäº M2 è¢«æ¶è´¹ï¼é£ä¹éè¦ M1 å°è¾¾æ¶è´¹ç«¯è¢«æ¶è´¹åï¼éç¥ S2ï¼ç¶å S2 åå° M2 åéå°æ¶è´¹ç«¯ã\n\nè¿ä¸ªæ¨¡åå­å¨çé®é¢æ¯ï¼å¦æ M1 å M2 åå«åéå°ä¸¤å° Server ä¸ï¼å°±ä¸è½ä¿è¯ M1 åè¾¾å° MQ éç¾¤ï¼ä¹ä¸è½ä¿è¯ M1 è¢«åæ¶è´¹ãæ¢ä¸ªè§åº¦çï¼å¦æ M2 åäº M1 è¾¾å° MQ éç¾¤ï¼çè³ M2 è¢«æ¶è´¹åï¼M1 æè¾¾å°æ¶è´¹ç«¯ï¼è¿æ¶æ¶æ¯ä¹å°±ä¹±åºäºï¼è¯´æä»¥ä¸æ¨¡åæ¯ä¸è½ä¿è¯æ¶æ¯çé¡ºåºçã\n\n\n\n# ç¬¬äºç§æ¨¡å\n\nå¦ä½æè½å¨ MQ éç¾¤ä¿è¯æ¶æ¯çé¡ºåºï¼ä¸ç§ç®åçæ¹å¼å°±æ¯å° M1ãM2 åéå°åä¸ä¸ª Server ä¸ï¼\n\nè¿æ ·å¯ä»¥ä¿è¯ M1 åäº M2 å°è¾¾ MQServerï¼çäº§èç­å¾ M1 åéæååååé M2ï¼ï¼æ ¹æ®åè¾¾å°åè¢«æ¶è´¹çååï¼M1 ä¼åäº M2 è¢«æ¶è´¹ï¼è¿æ ·å°±ä¿è¯äºæ¶æ¯çé¡ºåºã\n\nè¿ä¸ªæ¨¡åä¹ä»ä»æ¯çè®ºä¸å¯ä»¥ä¿è¯æ¶æ¯çé¡ºåºï¼å¨å®éåºæ¯ä¸­å¯è½ä¼éå°ä¸é¢çé®é¢ï¼\n\n\n\nåªè¦å°æ¶æ¯ä»ä¸å°æå¡å¨åå¾å¦ä¸å°æå¡å¨ï¼å°±ä¼å­å¨ç½ç»å»¶è¿é®é¢ãå¦ä¸å¾æç¤ºï¼å¦æåé M1 èæ¶å¤§äºåé M2 çèæ¶ï¼é£ä¹ M2 å°±ä»å°è¢«åæ¶è´¹ï¼ä»ç¶ä¸è½ä¿è¯æ¶æ¯çé¡ºåºãå³ä½¿ M1 å M2 åæ¶å°è¾¾æ¶è´¹ç«¯ï¼ç±äºä¸æ¸æ¥æ¶è´¹ç«¯ 1 åæ¶è´¹ç«¯ 2 çè´è½½æåµï¼ä»ç¶æå¯è½åºç° M2 åäº M1 è¢«æ¶è´¹çæåµã\n\nå¦ä½è§£å³è¿ä¸ªé®é¢ï¼å° M1 å M2 åå¾åä¸ä¸ªæ¶è´¹èï¼ä¸åé M1 åï¼éè¦æ¶è´¹ç«¯ååºæååæè½åé M2ã\n\nè¿å¯è½äº§çå¦å¤çé®é¢ï¼å¦æ M1 è¢«åéå°æ¶è´¹ç«¯åï¼æ¶è´¹ç«¯ 1 æ²¡æååºï¼é£æ¯ç»§ç»­åé M2 å¢ï¼è¿æ¯éæ°åé M1ï¼ä¸è¬ä¸ºäºä¿è¯æ¶æ¯ä¸å®è¢«æ¶è´¹ï¼è¯å®ä¼éæ©éå M1 å°å¦å¤ä¸ä¸ªæ¶è´¹ç«¯ 2ï¼å°±å¦ä¸å¾æç¤ºã\n\n\n\nè¿æ ·çæ¨¡åå°±ä¸¥æ ¼ä¿è¯æ¶æ¯çé¡ºåºï¼ç»å¿çä½ ä»ç¶ä¼åç°é®é¢ï¼æ¶è´¹ç«¯ 1 æ²¡æååº Server æ¶æä¸¤ç§æåµï¼ä¸ç§æ¯ M1 ç¡®å®æ²¡æå°è¾¾(æ°æ®å¨ç½ç»ä¼ éä¸­ä¸¢å¤±)ï¼å¦å¤ä¸ç§æ¶è´¹ç«¯å·²ç»æ¶è´¹ M1 ä¸å·²ç»åéååºæ¶æ¯ï¼åªæ¯ MQ Server ç«¯æ²¡ææ¶å°ãå¦ææ¯ç¬¬äºç§æåµï¼éå M1ï¼å°±ä¼é æ M1 è¢«éå¤æ¶è´¹ãä¹å°±å¼å¥äºæä»¬è¦è¯´çç¬¬äºä¸ªé®é¢ï¼æ¶æ¯éå¤é®é¢ï¼è¿ä¸ªåæä¼è¯¦ç»è®²è§£ã\n\nåè¿å¤´æ¥çæ¶æ¯é¡ºåºé®é¢ï¼ä¸¥æ ¼çé¡ºåºæ¶æ¯éå¸¸å®¹æçè§£ï¼ä¹å¯ä»¥éè¿æä¸­ææè¿°çæ¹å¼æ¥ç®åå¤çãæ»ç»èµ·æ¥ï¼è¦å®ç°ä¸¥æ ¼çé¡ºåºæ¶æ¯ï¼ç®åä¸å¯è¡çåæ³å°±æ¯ï¼\n\nä¿è¯çäº§è - MQServer - æ¶è´¹èæ¯ä¸å¯¹ä¸å¯¹ä¸çå³ç³»ã\n\nè¿æ ·çè®¾è®¡è½ç¶ç®åæè¡ï¼ä½ä¹ä¼å­å¨ä¸äºå¾ä¸¥éçé®é¢ï¼æ¯å¦ï¼\n\n 1. å¹¶è¡åº¦å°±ä¼æä¸ºæ¶æ¯ç³»ç»çç¶é¢ï¼ååéä¸å¤ï¼\n 2. æ´å¤çå¼å¸¸å¤çï¼æ¯å¦ï¼åªè¦æ¶è´¹ç«¯åºç°é®é¢ï¼å°±ä¼å¯¼è´æ´ä¸ªå¤çæµç¨é»å¡ï¼æä»¬ä¸å¾ä¸è±è´¹æ´å¤çç²¾åæ¥è§£å³é»å¡çé®é¢ã\n\nRocketMQ çè§£å³æ¹æ¡ï¼éè¿åççè®¾è®¡æèå°é®é¢åè§£æ¥è§é¿ãå¦æç¡¬è¦ææ¶é´è±å¨è§£å³é®é¢æ¬èº«ï¼å®éä¸ä¸ä»æçä½ä¸ï¼èä¸ä¹æ¯ä¸ç§æµªè´¹ãä»è¿ä¸ªè§åº¦æ¥çæ¶æ¯çé¡ºåºé®é¢ï¼æä»¬å¯ä»¥å¾åºä¸¤ä¸ªç»è®ºï¼\n\n 1. ä¸å³æ³¨ä¹±åºçåºç¨å®éå¤§éå­å¨\n 2. éåæ åºå¹¶ä¸æå³çæ¶æ¯æ åº\n\næåæä»¬ä»æºç è§åº¦åæ RocketMQ æä¹å®ç°åéé¡ºåºæ¶æ¯ã\n\nRocketMQ éè¿è½®è¯¢ææéåçæ¹å¼æ¥ç¡®å®æ¶æ¯è¢«åéå°åªä¸ä¸ªéåï¼è´è½½åè¡¡ç­ç¥ï¼ãæ¯å¦ä¸é¢çç¤ºä¾ä¸­ï¼è®¢åå·ç¸åçæ¶æ¯ä¼è¢«åååéå°åä¸ä¸ªéåä¸­ï¼\n\n// RocketMQ éè¿ MessageQueueSelector ä¸­å®ç°çç®æ³æ¥ç¡®å®æ¶æ¯åéå°åªä¸ä¸ªéåä¸\n// RocketMQ é»è®¤æä¾äºä¸¤ç§ MessageQueueSelector å®ç°ï¼éæº/Hash\n// å½ç¶ä½ å¯ä»¥æ ¹æ®ä¸å¡å®ç°èªå·±ç MessageQueueSelector æ¥å³å®æ¶æ¯æç§ä½ç§ç­ç¥åéå°æ¶æ¯éåä¸­\nSendResult sendResult = producer.send(msg, new MessageQueueSelector() {\n    @Override\n    public MessageQueue select(List<MessageQueue> mqs, Message msg, Object arg) {\n        Integer id = (Integer) arg;\n        int index = id % mqs.size();\n        return mqs.get(index);\n    }\n}, orderId);\n\n\nå¨è·åå°è·¯ç±ä¿¡æ¯ä»¥åï¼ä¼æ ¹æ® MessageQueueSelector å®ç°çç®æ³æ¥éæ©ä¸ä¸ªéåï¼åä¸ä¸ª OrderId è·åå°çè¯å®æ¯åä¸ä¸ªéåã\n\nprivate SendResult send()  {\n    // è·åtopicè·¯ç±ä¿¡æ¯\n    TopicPublishInfo topicPublishInfo = this.tryToFindTopicPublishInfo(msg.getTopic());\n    if (topicPublishInfo != null && topicPublishInfo.ok()) {\n        MessageQueue mq = null;\n        // æ ¹æ®æä»¬çç®æ³ï¼éæ©ä¸ä¸ªåééå\n        // è¿éçarg = orderId\n        mq = selector.select(topicPublishInfo.getMessageQueueList(), msg, arg);\n        if (mq != null) {\n            return this.sendKernelImpl(msg, mq, communicationMode, sendCallback, timeout);\n        }\n    }\n}\n\n\n\n# æ¶æ¯éå¤\n\né ææ¶æ¯éå¤çæ ¹æ¬åå æ¯ï¼ç½ç»ä¸å¯è¾¾ãåªè¦éè¿ç½ç»äº¤æ¢æ°æ®ï¼å°±æ æ³é¿åè¿ä¸ªé®é¢ãæä»¥è§£å³è¿ä¸ªé®é¢çåæ³å°±æ¯ç»è¿è¿ä¸ªé®é¢ãé£ä¹é®é¢å°±åæäºï¼å¦ææ¶è´¹ç«¯æ¶å°ä¸¤æ¡ä¸æ ·çæ¶æ¯ï¼åºè¯¥ææ ·å¤çï¼\n\n 1. æ¶è´¹ç«¯å¤çæ¶æ¯çä¸å¡é»è¾ä¿æå¹ç­æ§ã\n 2. ä¿è¯æ¯æ¡æ¶æ¯é½æå¯ä¸ç¼å·ä¸ä¿è¯æ¶æ¯å¤çæåä¸å»éè¡¨çæ¥å¿åæ¶åºç°ã\n\nç¬¬ 1 æ¡å¾å¥½çè§£ï¼åªè¦ä¿æå¹ç­æ§ï¼ä¸ç®¡æ¥å¤å°æ¡éå¤æ¶æ¯ï¼æåå¤ççç»æé½ä¸æ ·ã\n\nç¬¬ 2 æ¡åçå°±æ¯å©ç¨ä¸å¼ æ¥å¿è¡¨æ¥è®°å½å·²ç»å¤çæåçæ¶æ¯ç IDï¼å¦ææ°å°çæ¶æ¯ ID å·²ç»å¨æ¥å¿è¡¨ä¸­ï¼é£ä¹å°±ä¸åå¤çè¿æ¡æ¶æ¯ã\n\nç¬¬ 1 æ¡è§£å³æ¹æ¡ï¼å¾ææ¾åºè¯¥å¨æ¶è´¹ç«¯å®ç°ï¼ä¸å±äºæ¶æ¯ç³»ç»è¦å®ç°çåè½ã\n\nç¬¬ 2 æ¡å¯ä»¥æ¶æ¯ç³»ç»å®ç°ï¼ä¹å¯ä»¥ä¸å¡ç«¯å®ç°ãæ­£å¸¸æåµä¸åºç°éå¤æ¶æ¯çæ¦çå¶å®å¾å°ï¼å¦æç±æ¶æ¯ç³»ç»æ¥å®ç°çè¯ï¼è¯å®ä¼å¯¹æ¶æ¯ç³»ç»çååéåé«å¯ç¨æå½±åï¼æä»¥æå¥½è¿æ¯ç±ä¸å¡ç«¯èªå·±å¤çæ¶æ¯éå¤çé®é¢ï¼è¿ä¹æ¯ RocketMQ ä¸è§£å³æ¶æ¯éå¤çé®é¢çåå ã\n\nRocketMQ ä¸ä¿è¯æ¶æ¯ä¸éå¤ï¼å¦æä½ çä¸å¡éè¦ä¿è¯ä¸¥æ ¼çä¸éå¤æ¶æ¯ï¼éè¦ä½ èªå·±å¨ä¸å¡ç«¯å»éã\n\n\n# äºå¡æ¶æ¯\n\nRocketMQ é¤äºæ¯ææ®éæ¶æ¯ï¼é¡ºåºæ¶æ¯ï¼å¦å¤è¿æ¯æäºå¡æ¶æ¯ã\n\nåè®¾è¿æ ·çåºæ¯ï¼\n\n\n\nå¾ä¸­æ§è¡æ¬å°äºå¡ï¼Bob è´¦æ·æ£æ¬¾ï¼ååéå¼æ­¥æ¶æ¯åºè¯¥ä¿è¯åæ¶æåæèåæ¶å¤±è´¥ï¼ä¹å°±æ¯æ£æ¬¾æåäºï¼åéæ¶æ¯ä¸å®è¦æåï¼å¦ææ£æ¬¾å¤±è´¥äºï¼å°±ä¸è½ååéæ¶æ¯ãé£é®é¢æ¯ï¼æä»¬æ¯åæ£æ¬¾è¿æ¯ååéæ¶æ¯å¢ï¼\n\n\n\nRocketMQ åå¸å¼äºå¡æ­¥éª¤ï¼\n\nåé Prepared æ¶æ¯ 2222222222222222222ï¼å¹¶æ¿å°æ¥åæ¶æ¯çå°åã æ§è¡æ¬å°äºå¡ éè¿ç¬¬ 1 æ­¥éª¤æ¿å°çå°åå»è®¿é®æ¶æ¯ï¼å¹¶ä¿®æ¹æ¶æ¯ç¶æã\n\n\n# åèèµæ\n\n * RocketMQ å®æ¹ææ¡£\n * åå¸å¼å¼æ¾æ¶æ¯ç³»ç»(RocketMQ)çåçä¸å®è·µ',normalizedContent:'# rocketmq å¿«éå¥é¨\n\n\n# ç®ä»\n\nrocketmq æ¯ä¸æ¬¾å¼æºçåå¸å¼æ¶æ¯éåï¼åºäºé«å¯ç¨åå¸å¼éç¾¤ææ¯ï¼æä¾ä½å»¶æ¶çãé«å¯é çæ¶æ¯åå¸ä¸è®¢éæå¡ã\n\nrocketmq è¢«é¿éå·´å·´æèµ ç» apacheï¼æä¸º apache çå­µåé¡¹ç®ã\n\n\n\nrocketmq æä»¥ä¸æ ¸å¿æ¦å¿µï¼\n\n * producer - å°ä¸å¡åºç¨ç¨åºç³»ç»çæçæ¶æ¯åéç»ä»£çãrocketmq æä¾å¤ç§åéèä¾ï¼åæ­¥ï¼å¼æ­¥åååã\n   * producer group - å·æç¸åè§è²ç producer ç»åå¨ä¸èµ·ãå¦æåå§ producer å¨äºå¡ä¹åå´©æºï¼åä»£çå¯ä»¥èç³»åä¸ producer ç»çä¸å producer å®ä¾ä»¥æäº¤æåæ»äºå¡ãè­¦åï¼èèå°æä¾ç producer å¨åéæ¶æ¯æ¹é¢è¶³å¤å¼ºå¤§ï¼æ¯ä¸ª producer ç»åªåè®¸ä¸ä¸ªå®ä¾ï¼ä»¥é¿åä¸å¿è¦ççæå¨å®ä¾åå§åã\n * consumer - consumer ä» broker é£éè·åæ¶æ¯å¹¶å°å¶æä¾ç»åºç¨ç¨åºãä»ç¨æ·åºç¨çè§åº¦æ¥çï¼æä¾äºä¸¤ç§ç±»åç consumerï¼\n   * pullconsumer - pullconsumer ç§¯æå°ä» broker é£éè·åæ¶æ¯ãä¸æ¦æåäºæ¹éæ¶æ¯ï¼ç¨æ·åºç¨ç¨åºå°±ä¼å¯å¨æ¶è´¹è¿ç¨ã\n   * pushconsumer - pushconsumer å°è£æ¶æ¯æåï¼æ¶è´¹è¿åº¦å¹¶ç»´æ¤å¶ä»åé¨å·¥ä½ï¼ä¸ºæç»ç¨æ·çä¸åè°æ¥å£ï¼è¿ä¸ªåå£ä¼å¨æ¶æ¯å°è¾¾æ¶è¢«æ§è¡ã\n   * consumer group - å®å¨ç¸åè§è²ç consumer è¢«ç»åå¨ä¸èµ·å¹¶å½åä¸º consumer groupãconsumer group æ¯ä¸ä¸ªå¾å¥½çæ¦å¿µï¼å¨æ¶æ¯æ¶è´¹æ¹é¢å®ç°è´è½½å¹³è¡¡åå®¹éç®æ éå¸¸å®¹æãè­¦åï¼consumer group ä¸­ç consumer å®ä¾å¿é¡»å·æå®å¨ç¸åçä¸»é¢è®¢éã\n * broker - broker æ¯ rocketmq çä¸»è¦ç»æé¨åãå®æ¥æ¶ä» producer åéçæ¶æ¯ï¼å­å¨å®ä»¬å¹¶åå¤å¤çæ¥èª consumer çæ¶è´¹è¯·æ±ãå®è¿å­å¨ä¸æ¶æ¯ç¸å³çåæ°æ®ï¼åæ¬ consumer groupï¼æ¶èè¿åº¦åç§»åä¸»é¢/éåä¿¡æ¯ã\n * name server - åå½è·¯ç±ä¿¡æ¯æä¾èãproducer/consumer å®¢æ·æ¥æ¾ä¸»é¢ä»¥æ¥æ¾ç¸åºç broker åè¡¨ã\n * topic - æ¯ producer ä¼ éæ¶æ¯å consumer æåæ¶æ¯çç±»å«ã\n * message - æ¯è¦ä¼ éçä¿¡æ¯ãæ¶æ¯å¿é¡»æä¸ä¸ªä¸»é¢ï¼å¯ä»¥å°å¶è§£éä¸ºæ¨è¦åéç»çé®ä»¶å°åãæ¶æ¯è¿å¯ä»¥å·æå¯é tag åé¢å¤çé®å¼å¯¹ãä¾å¦ï¼æ¨å¯ä»¥ä¸ºæ¶æ¯è®¾ç½®ä¸å¡å¯é¥ï¼å¹¶å¨ä»£çæå¡å¨ä¸æ¥æ¾æ¶æ¯ä»¥è¯æ­å¼åæé´çé®é¢ã\n   * message queue - ä¸»é¢è¢«ååä¸ºä¸ä¸ªæå¤ä¸ªå­ä¸»é¢âæ¶æ¯éåâã\n   * tag - å³å­ä¸»é¢ï¼ä¸ºç¨æ·æä¾äºé¢å¤ççµæ´»æ§ãå¯¹äº tagï¼æ¥èªåä¸ä¸å¡æ¨¡åçå·æä¸åç®ççæ¶æ¯å¯ä»¥å·æç¸åçä¸»é¢åä¸åç tagã\n\n\n# å®è£\n\n\n# ç¯å¢è¦æ±\n\n * æ¨è 64 ä½æä½ç³»ç»ï¼linux/unix/mac\n * 64bit jdk 1.8+\n * maven 3.2.x\n * git\n\n\n# ä¸è½½è§£å\n\nè¿å¥å®æ¹ä¸è½½å°åï¼https://rocketmq.apache.org/dowloading/releases/ï¼éæ©åéçæ¬\n\nå»ºè®®éæ© binary çæ¬ã\n\nè§£åå°æ¬å°ï¼\n\n> unzip rocketmq-all-4.2.0-source-release.zip\n> cd rocketmq-all-4.2.0/\n\n\n\n# å¯å¨ name server\n\n> nohup sh bin/mqnamesrv &\n> tail -f ~/logs/rocketmqlogs/namesrv.log\nthe name server boot success...\n\n\n\n# å¯å¨ broker\n\n> nohup sh bin/mqbroker -n localhost:9876 -c conf/broker.conf &\n> tail -f ~/logs/rocketmqlogs/broker.log\nthe broker[%s, 172.30.30.233:10911] boot success...\n\n\n\n# æ¶åæ¶æ¯\n\næ§è¡æ¶åæ¶æ¯æä½ä¹åï¼ä¸è®¸åè¯å®¢æ·ç«¯å½åæå¡å¨çä½ç½®ãå¨ rocketmq ä¸­æå¤ç§æ¹æ³æ¥å®ç°è¿ä¸ªç®çãè¿éï¼æä»¬ä½¿ç¨æç®åçæ¹æ³ââè®¾ç½®ç¯å¢åé namesrv_addr ï¼\n\n> export namesrv_addr=localhost:9876\n> sh bin/tools.sh org.apache.rocketmq.example.quickstart.producer\nsendresult [sendstatus=send_ok, msgid= ...\n\n> sh bin/tools.sh org.apache.rocketmq.example.quickstart.consumer\nconsumemessagethread_%d receive new messages: [messageext...\n\n\n\n# å³é­æå¡å¨\n\n> sh bin/mqshutdown broker\nthe mqbroker(36695) is running...\nsend shutdown request to mqbroker(36695) ok\n\n> sh bin/mqshutdown namesrv\nthe mqnamesrv(36664) is running...\nsend shutdown request to mqnamesrv(36664) ok\n\n\n\n# api\n\né¦åå¨é¡¹ç®ä¸­å¼å¥ maven ä¾èµï¼\n\n<dependency>\n    <groupid>org.apache.rocketmq</groupid>\n    <artifactid>rocketmq-client</artifactid>\n    <version>4.2.0</version>\n</dependency>\n\n\n\n# producer\n\nproducer å¨ rocketmq ä¸­è´è´£åéæ¶æ¯ã\n\nrocketmq æä¸ç§æ¶æ¯åéæ¹å¼ï¼\n\n * å¯é çåæ­¥åé\n * å¯é çå¼æ­¥åé\n * åé¡¹åé\n\n# å¯é çåæ­¥åé\n\nå¯é çåæ­¥ä¼ è¾ç¨äºå¹¿æ³çåºæ¯ï¼å¦éè¦çéç¥æ¶æ¯ï¼ç­ä¿¡éç¥ï¼ç­ä¿¡è¥éç³»ç»ç­ã\n\npublic class syncproducer {\n    public static void main(string[] args) throws exception {\n        //instantiate with a producer group name.\n        defaultmqproducer producer = new\n            defaultmqproducer("please_rename_unique_group_name");\n        //launch the instance.\n        producer.start();\n        for (int i = 0; i < 100; i++) {\n            //create a message instance, specifying topic, tag and message body.\n            message msg = new message("topictest" /* topic */,\n                "taga" /* tag */,\n                ("hello rocketmq " +\n                    i).getbytes(remotinghelper.default_charset) /* message body */\n            );\n            //call send message to deliver message to one of brokers.\n            sendresult sendresult = producer.send(msg);\n            system.out.printf("%s%n", sendresult);\n        }\n        //shut down once the producer instance is not longer in use.\n        producer.shutdown();\n    }\n}\n\n\n# å¯é çå¼æ­¥åé\n\nå¼æ­¥ä¼ è¾éå¸¸ç¨äºååºæ¶é´ææçä¸å¡åºæ¯ã\n\npublic class asyncproducer {\n    public static void main(string[] args) throws exception {\n        //instantiate with a producer group name.\n        defaultmqproducer producer = new defaultmqproducer("exampleproducergroup");\n        //launch the instance.\n        producer.start();\n        producer.setretrytimeswhensendasyncfailed(0);\n        for (int i = 0; i < 100; i++) {\n                final int index = i;\n                //create a message instance, specifying topic, tag and message body.\n                message msg = new message("topictest",\n                    "taga",\n                    "orderid188",\n                    "hello world".getbytes(remotinghelper.default_charset));\n                producer.send(msg, new sendcallback() {\n                    @override\n                    public void onsuccess(sendresult sendresult) {\n                        system.out.printf("%-10d ok %s %n", index,\n                            sendresult.getmsgid());\n                    }\n                    @override\n                    public void onexception(throwable e) {\n                        system.out.printf("%-10d exception %s %n", index, e);\n                        e.printstacktrace();\n                    }\n                });\n        }\n        //shut down once the producer instance is not longer in use.\n        producer.shutdown();\n    }\n}\n\n\n# ååä¼ è¾\n\nååä¼ è¾ç¨äºéè¦ä¸­ç­å¯é æ§çæåµï¼ä¾å¦æ¥å¿æ¶éã\n\npublic class onewayproducer {\n    public static void main(string[] args) throws exception{\n        //instantiate with a producer group name.\n        defaultmqproducer producer = new defaultmqproducer("exampleproducergroup");\n        //launch the instance.\n        producer.start();\n        for (int i = 0; i < 100; i++) {\n            //create a message instance, specifying topic, tag and message body.\n            message msg = new message("topictest" /* topic */,\n                "taga" /* tag */,\n                ("hello rocketmq " +\n                    i).getbytes(remotinghelper.default_charset) /* message body */\n            );\n            //call send message to deliver message to one of brokers.\n            producer.sendoneway(msg);\n\n        }\n        //shut down once the producer instance is not longer in use.\n        producer.shutdown();\n    }\n}\n\n\n\n# consumer\n\nconsumer å¨ rocketmq ä¸­è´è´£æ¥æ¶æ¶æ¯ã\n\npublic class orderedconsumer {\n    public static void main(string[] args) throws exception {\n        defaultmqpushconsumer consumer = new defaultmqpushconsumer("example_group_name");\n        consumer.setnamesrvaddr(rocketconfig.host);\n\n        consumer.setconsumefromwhere(consumefromwhere.consume_from_first_offset);\n\n        consumer.subscribe("topictest", "taga || tagc || tagd");\n\n        consumer.registermessagelistener(new messagelistenerorderly() {\n\n            atomiclong consumetimes = new atomiclong(0);\n\n            @override\n            public consumeorderlystatus consumemessage(list<messageext> msgs,\n                consumeorderlycontext context) {\n                context.setautocommit(false);\n                system.out.printf(thread.currentthread().getname() + " receive new messages: " + msgs + "%n");\n                this.consumetimes.incrementandget();\n                if ((this.consumetimes.get() % 2) == 0) {\n                    return consumeorderlystatus.success;\n                } else if ((this.consumetimes.get() % 3) == 0) {\n                    return consumeorderlystatus.rollback;\n                } else if ((this.consumetimes.get() % 4) == 0) {\n                    return consumeorderlystatus.commit;\n                } else if ((this.consumetimes.get() % 5) == 0) {\n                    context.setsuspendcurrentqueuetimemillis(3000);\n                    return consumeorderlystatus.suspend_current_queue_a_moment;\n                }\n                return consumeorderlystatus.success;\n\n            }\n        });\n\n        consumer.start();\n\n        system.out.printf("consumer started.%n");\n    }\n}\n\n\n\n# faq\n\n# connect to <172.17.0.1:10909> failed\n\nå¯å¨åï¼producer å®¢æ·ç«¯è¿æ¥ rocketmq æ¶æ¥éï¼\n\norg.apache.rocketmq.remoting.exception.remotingconnectexception: connect to <172.17.0.1:10909> failed\n    at org.apache.rocketmq.remoting.netty.nettyremotingclient.invokesync(nettyremotingclient.java:357)\n    at org.apache.rocketmq.client.impl.mqclientapiimpl.sendmessagesync(mqclientapiimpl.java:343)\n    at org.apache.rocketmq.client.impl.mqclientapiimpl.sendmessage(mqclientapiimpl.java:327)\n    at org.apache.rocketmq.client.impl.mqclientapiimpl.sendmessage(mqclientapiimpl.java:290)\n    at org.apache.rocketmq.client.impl.producer.defaultmqproducerimpl.sendkernelimpl(defaultmqproducerimpl.java:688)\n    at org.apache.rocketmq.client.impl.producer.defaultmqproducerimpl.sendselectimpl(defaultmqproducerimpl.java:901)\n    at org.apache.rocketmq.client.impl.producer.defaultmqproducerimpl.send(defaultmqproducerimpl.java:878)\n    at org.apache.rocketmq.client.impl.producer.defaultmqproducerimpl.send(defaultmqproducerimpl.java:873)\n    at org.apache.rocketmq.client.producer.defaultmqproducer.send(defaultmqproducer.java:369)\n    at com.emrubik.uc.mdm.sync.utils.mdminit.sendmessage(mdminit.java:62)\n    at com.emrubik.uc.mdm.sync.utils.mdminit.main(mdminit.java:2149)\n\n\nåå ï¼rocketmq é¨ç½²å¨èææºä¸ï¼åç½ ip ä¸º 10.10.30.63ï¼è¯¥èææºä¸ä¸ª docker0 ç½å¡ï¼ip ä¸º 172.17.0.1ãrocketmq broker å¯å¨æ¶é»è®¤ä½¿ç¨äº docker0 ç½å¡ï¼producer å®¢æ·ç«¯æ æ³è¿æ¥ 172.17.0.1ï¼é æä»¥ä¸é®é¢ã\n\nè§£å³æ¹æ¡\n\nï¼1ï¼å¹²æ docker0 ç½å¡æä¿®æ¹ç½å¡åç§°\n\nï¼2ï¼åæ brokerï¼ä¿®æ¹ broker éç½®æä»¶ï¼éå¯ brokerã\n\nä¿®æ¹ conf/broker.confï¼å¢å ä¸¤è¡æ¥æå®å¯å¨ broker ç ipï¼\n\nnamesrvaddr = 10.10.30.63:9876\nbrokerip1 = 10.10.30.63\n\n\nå¯å¨æ¶éè¦æå®éç½®æä»¶\n\nnohup sh bin/mqbroker -n localhost:9876 -c conf/broker.conf &\n\n\n\n# æ¶æ\n\n\n\nrocketmq ç±åé¨åç»æï¼nameserverãbrokerãproducerãconsumerãå¶ä¸­ä»»æä¸ä¸ªç»æé½å¯ä»¥æ°´å¹³æ©å±ä¸ºéç¾¤æ¨¡å¼ï¼ä»¥é¿ååç¹æéé®é¢ã\n\n\n# producer\n\nproducers æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ãproducer éè¿ mq çè´è½½åè¡¡æ¨¡åéæ©ç¸åºç broker éç¾¤éåè¿è¡æ¶æ¯æéï¼æéçè¿ç¨æ¯æå¿«éå¤±è´¥å¹¶ä¸ä½å»¶è¿ã\n\n\n# consumer\n\nconsumer æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ãæ¯æä»¥ push æ¨ï¼pull æä¸¤ç§æ¨¡å¼å¯¹æ¶æ¯è¿è¡æ¶è´¹ãåæ¶ä¹æ¯æéç¾¤æ¹å¼åå¹¿æ­æ¹å¼çæ¶è´¹ï¼å®æä¾å®æ¶æ¶æ¯è®¢éæºå¶ï¼å¯ä»¥æ»¡è¶³å¤§å¤æ°ç¨æ·çéæ±ã\n\n\n# nameserver\n\nnameserver æ¯ä¸ä¸ª topic è·¯ç±æ³¨åä¸­å¿ï¼å¶è§è²ç±»ä¼¼ dubbo ä¸­ç zookeeperï¼æ¯æ broker çå¨ææ³¨åä¸åç°ãä¸»è¦åæ¬ä¸¤ä¸ªåè½ï¼\n\n * broker ç®¡çï¼nameserver æ¥å broker éç¾¤çæ³¨åä¿¡æ¯å¹¶ä¸ä¿å­ä¸æ¥ä½ä¸ºè·¯ç±ä¿¡æ¯çåºæ¬æ°æ®ãç¶åæä¾å¿è·³æ£æµæºå¶ï¼æ£æ¥ broker æ¯å¦è¿å­æ´»ï¼\n * è·¯ç±ä¿¡æ¯ç®¡çï¼æ¯ä¸ª nameserver å°ä¿å­å³äº broker éç¾¤çæ´ä¸ªè·¯ç±ä¿¡æ¯åç¨äºå®¢æ·ç«¯æ¥è¯¢çéåä¿¡æ¯ãç¶å producer å conumser éè¿ nameserver å°±å¯ä»¥ç¥éæ´ä¸ª broker éç¾¤çè·¯ç±ä¿¡æ¯ï¼ä»èè¿è¡æ¶æ¯çæéåæ¶è´¹ã\n\nnameserver éå¸¸ä¹æ¯éç¾¤çæ¹å¼é¨ç½²ï¼åå®ä¾é´ç¸äºä¸è¿è¡ä¿¡æ¯éè®¯ãbroker æ¯åæ¯ä¸å° nameserver æ³¨åèªå·±çè·¯ç±ä¿¡æ¯ï¼æä»¥æ¯ä¸ä¸ª nameserver å®ä¾ä¸é¢é½ä¿å­ä¸ä»½å®æ´çè·¯ç±ä¿¡æ¯ãå½æä¸ª nameserver å æç§åå ä¸çº¿äºï¼broker ä»ç¶å¯ä»¥åå¶å® nameserver åæ­¥å¶è·¯ç±ä¿¡æ¯ï¼producerãconsumer ä»ç¶å¯ä»¥å¨ææç¥ broker çè·¯ç±çä¿¡æ¯ã\n\nnameserver æ¯ä¸ä¸ªåè½é½å¨çæå¡å¨ï¼ä¸»è¦åæ¬ä¸¤ä¸ªåè½ï¼\n\n 1. broker ç®¡ç - nameserver æ¥åæ¥èª broker éç¾¤çæ³¨åï¼å¹¶æä¾å¿è·³æºå¶æ¥æ£æ¥ broker èç¹æ¯å¦å­æ´»ã\n 2. è·¯ç±ç®¡ç - æ¯ä¸ª nameserver å°ä¿å­æå³ broker éç¾¤çå®æ´è·¯ç±ä¿¡æ¯åå®¢æ·ç«¯æ¥è¯¢çæ¥è¯¢éåã\n\nrocketmq å®¢æ·ç«¯ï¼producer/consumerï¼å°ä» nameserver æ¥è¯¢éåè·¯ç±ä¿¡æ¯ã\n\nå° nameserver å°ååè¡¨æä¾ç»å®¢æ·ç«¯æåç§æ¹æ³ï¼\n\n 1. ç¼ç¨æ¹å¼ - ç±»ä¼¼ï¼producer.setnamesrvaddr("ip:port")\n 2. java éé¡¹ - ä½¿ç¨ rocketmq.namesrv.addr åæ°\n 3. ç¯å¢åé - è®¾ç½®ç¯å¢åé namesrv_addr\n 4. http ç«¯ç¹\n\n> æ´è¯¦ç»ä¿¡æ¯å¯ä»¥åèå®æ¹ææ¡£ï¼here\n\n\n# broker\n\nbroker ä¸»è¦è´è´£æ¶æ¯çå­å¨ãæéåæ¥è¯¢ä»¥åæå¡é«å¯ç¨ä¿è¯ï¼ä¸ºäºå®ç°è¿äºåè½ï¼broker åå«äºä»¥ä¸å ä¸ªéè¦å­æ¨¡åã\n\nbroker æå ä¸ªéè¦çå­æ¨¡åï¼\n\n * remoting moduleï¼æ´ä¸ª broker çå®ä½ï¼è´è´£å¤çæ¥èª clients ç«¯çè¯·æ±ã\n * client managerï¼è´è´£ç®¡çå®¢æ·ç«¯(producer/consumer)åç»´æ¤ consumer ç topic è®¢éä¿¡æ¯ã\n * store serviceï¼æä¾æ¹ä¾¿ç®åç api æ¥å£å¤çæ¶æ¯å­å¨å°ç©çç¡¬çåæ¥è¯¢åè½ã\n * ha serviceï¼é«å¯ç¨æå¡ï¼æä¾ master broker å slave broker ä¹é´çæ°æ®åæ­¥åè½ã\n * index serviceï¼æ ¹æ®ç¹å®ç message key å¯¹æéå° broker çæ¶æ¯è¿è¡ç´¢å¼æå¡ï¼ä»¥æä¾æ¶æ¯çå¿«éæ¥è¯¢ã\n\n\n\n\n# åç\n\nåå¸å¼æ¶æ¯ç³»ç»ä½ä¸ºå®ç°åå¸å¼ç³»ç»å¯æ©å±ãå¯ä¼¸ç¼©æ§çå³é®ç»ä»¶ï¼éè¦å·æé«ååéãé«å¯ç¨ç­ç¹ç¹ãèè°å°æ¶æ¯ç³»ç»çè®¾è®¡ï¼å°±åé¿ä¸äºä¸¤ä¸ªé®é¢ï¼\n\n 1. æ¶æ¯çé¡ºåºé®é¢\n 2. æ¶æ¯çéå¤é®é¢\n\n\n# é¡ºåºæ¶æ¯\n\n# ç¬¬ä¸ç§æ¨¡å\n\nåå¦çäº§èäº§çäº 2 æ¡æ¶æ¯ï¼m1ãm2ï¼è¦ä¿è¯è¿ä¸¤æ¡æ¶æ¯çé¡ºåºï¼åºè¯¥ææ ·åï¼ä½ èä¸­æ³å°çå¯è½æ¯è¿æ ·ï¼\n\n\n\nåå® m1 åéå° s1ï¼m2 åéå° s2ï¼å¦æè¦ä¿è¯ m1 åäº m2 è¢«æ¶è´¹ï¼é£ä¹éè¦ m1 å°è¾¾æ¶è´¹ç«¯è¢«æ¶è´¹åï¼éç¥ s2ï¼ç¶å s2 åå° m2 åéå°æ¶è´¹ç«¯ã\n\nè¿ä¸ªæ¨¡åå­å¨çé®é¢æ¯ï¼å¦æ m1 å m2 åå«åéå°ä¸¤å° server ä¸ï¼å°±ä¸è½ä¿è¯ m1 åè¾¾å° mq éç¾¤ï¼ä¹ä¸è½ä¿è¯ m1 è¢«åæ¶è´¹ãæ¢ä¸ªè§åº¦çï¼å¦æ m2 åäº m1 è¾¾å° mq éç¾¤ï¼çè³ m2 è¢«æ¶è´¹åï¼m1 æè¾¾å°æ¶è´¹ç«¯ï¼è¿æ¶æ¶æ¯ä¹å°±ä¹±åºäºï¼è¯´æä»¥ä¸æ¨¡åæ¯ä¸è½ä¿è¯æ¶æ¯çé¡ºåºçã\n\n\n\n# ç¬¬äºç§æ¨¡å\n\nå¦ä½æè½å¨ mq éç¾¤ä¿è¯æ¶æ¯çé¡ºåºï¼ä¸ç§ç®åçæ¹å¼å°±æ¯å° m1ãm2 åéå°åä¸ä¸ª server ä¸ï¼\n\nè¿æ ·å¯ä»¥ä¿è¯ m1 åäº m2 å°è¾¾ mqserverï¼çäº§èç­å¾ m1 åéæååååé m2ï¼ï¼æ ¹æ®åè¾¾å°åè¢«æ¶è´¹çååï¼m1 ä¼åäº m2 è¢«æ¶è´¹ï¼è¿æ ·å°±ä¿è¯äºæ¶æ¯çé¡ºåºã\n\nè¿ä¸ªæ¨¡åä¹ä»ä»æ¯çè®ºä¸å¯ä»¥ä¿è¯æ¶æ¯çé¡ºåºï¼å¨å®éåºæ¯ä¸­å¯è½ä¼éå°ä¸é¢çé®é¢ï¼\n\n\n\nåªè¦å°æ¶æ¯ä»ä¸å°æå¡å¨åå¾å¦ä¸å°æå¡å¨ï¼å°±ä¼å­å¨ç½ç»å»¶è¿é®é¢ãå¦ä¸å¾æç¤ºï¼å¦æåé m1 èæ¶å¤§äºåé m2 çèæ¶ï¼é£ä¹ m2 å°±ä»å°è¢«åæ¶è´¹ï¼ä»ç¶ä¸è½ä¿è¯æ¶æ¯çé¡ºåºãå³ä½¿ m1 å m2 åæ¶å°è¾¾æ¶è´¹ç«¯ï¼ç±äºä¸æ¸æ¥æ¶è´¹ç«¯ 1 åæ¶è´¹ç«¯ 2 çè´è½½æåµï¼ä»ç¶æå¯è½åºç° m2 åäº m1 è¢«æ¶è´¹çæåµã\n\nå¦ä½è§£å³è¿ä¸ªé®é¢ï¼å° m1 å m2 åå¾åä¸ä¸ªæ¶è´¹èï¼ä¸åé m1 åï¼éè¦æ¶è´¹ç«¯ååºæååæè½åé m2ã\n\nè¿å¯è½äº§çå¦å¤çé®é¢ï¼å¦æ m1 è¢«åéå°æ¶è´¹ç«¯åï¼æ¶è´¹ç«¯ 1 æ²¡æååºï¼é£æ¯ç»§ç»­åé m2 å¢ï¼è¿æ¯éæ°åé m1ï¼ä¸è¬ä¸ºäºä¿è¯æ¶æ¯ä¸å®è¢«æ¶è´¹ï¼è¯å®ä¼éæ©éå m1 å°å¦å¤ä¸ä¸ªæ¶è´¹ç«¯ 2ï¼å°±å¦ä¸å¾æç¤ºã\n\n\n\nè¿æ ·çæ¨¡åå°±ä¸¥æ ¼ä¿è¯æ¶æ¯çé¡ºåºï¼ç»å¿çä½ ä»ç¶ä¼åç°é®é¢ï¼æ¶è´¹ç«¯ 1 æ²¡æååº server æ¶æä¸¤ç§æåµï¼ä¸ç§æ¯ m1 ç¡®å®æ²¡æå°è¾¾(æ°æ®å¨ç½ç»ä¼ éä¸­ä¸¢å¤±)ï¼å¦å¤ä¸ç§æ¶è´¹ç«¯å·²ç»æ¶è´¹ m1 ä¸å·²ç»åéååºæ¶æ¯ï¼åªæ¯ mq server ç«¯æ²¡ææ¶å°ãå¦ææ¯ç¬¬äºç§æåµï¼éå m1ï¼å°±ä¼é æ m1 è¢«éå¤æ¶è´¹ãä¹å°±å¼å¥äºæä»¬è¦è¯´çç¬¬äºä¸ªé®é¢ï¼æ¶æ¯éå¤é®é¢ï¼è¿ä¸ªåæä¼è¯¦ç»è®²è§£ã\n\nåè¿å¤´æ¥çæ¶æ¯é¡ºåºé®é¢ï¼ä¸¥æ ¼çé¡ºåºæ¶æ¯éå¸¸å®¹æçè§£ï¼ä¹å¯ä»¥éè¿æä¸­ææè¿°çæ¹å¼æ¥ç®åå¤çãæ»ç»èµ·æ¥ï¼è¦å®ç°ä¸¥æ ¼çé¡ºåºæ¶æ¯ï¼ç®åä¸å¯è¡çåæ³å°±æ¯ï¼\n\nä¿è¯çäº§è - mqserver - æ¶è´¹èæ¯ä¸å¯¹ä¸å¯¹ä¸çå³ç³»ã\n\nè¿æ ·çè®¾è®¡è½ç¶ç®åæè¡ï¼ä½ä¹ä¼å­å¨ä¸äºå¾ä¸¥éçé®é¢ï¼æ¯å¦ï¼\n\n 1. å¹¶è¡åº¦å°±ä¼æä¸ºæ¶æ¯ç³»ç»çç¶é¢ï¼ååéä¸å¤ï¼\n 2. æ´å¤çå¼å¸¸å¤çï¼æ¯å¦ï¼åªè¦æ¶è´¹ç«¯åºç°é®é¢ï¼å°±ä¼å¯¼è´æ´ä¸ªå¤çæµç¨é»å¡ï¼æä»¬ä¸å¾ä¸è±è´¹æ´å¤çç²¾åæ¥è§£å³é»å¡çé®é¢ã\n\nrocketmq çè§£å³æ¹æ¡ï¼éè¿åççè®¾è®¡æèå°é®é¢åè§£æ¥è§é¿ãå¦æç¡¬è¦ææ¶é´è±å¨è§£å³é®é¢æ¬èº«ï¼å®éä¸ä¸ä»æçä½ä¸ï¼èä¸ä¹æ¯ä¸ç§æµªè´¹ãä»è¿ä¸ªè§åº¦æ¥çæ¶æ¯çé¡ºåºé®é¢ï¼æä»¬å¯ä»¥å¾åºä¸¤ä¸ªç»è®ºï¼\n\n 1. ä¸å³æ³¨ä¹±åºçåºç¨å®éå¤§éå­å¨\n 2. éåæ åºå¹¶ä¸æå³çæ¶æ¯æ åº\n\næåæä»¬ä»æºç è§åº¦åæ rocketmq æä¹å®ç°åéé¡ºåºæ¶æ¯ã\n\nrocketmq éè¿è½®è¯¢ææéåçæ¹å¼æ¥ç¡®å®æ¶æ¯è¢«åéå°åªä¸ä¸ªéåï¼è´è½½åè¡¡ç­ç¥ï¼ãæ¯å¦ä¸é¢çç¤ºä¾ä¸­ï¼è®¢åå·ç¸åçæ¶æ¯ä¼è¢«åååéå°åä¸ä¸ªéåä¸­ï¼\n\n// rocketmq éè¿ messagequeueselector ä¸­å®ç°çç®æ³æ¥ç¡®å®æ¶æ¯åéå°åªä¸ä¸ªéåä¸\n// rocketmq é»è®¤æä¾äºä¸¤ç§ messagequeueselector å®ç°ï¼éæº/hash\n// å½ç¶ä½ å¯ä»¥æ ¹æ®ä¸å¡å®ç°èªå·±ç messagequeueselector æ¥å³å®æ¶æ¯æç§ä½ç§ç­ç¥åéå°æ¶æ¯éåä¸­\nsendresult sendresult = producer.send(msg, new messagequeueselector() {\n    @override\n    public messagequeue select(list<messagequeue> mqs, message msg, object arg) {\n        integer id = (integer) arg;\n        int index = id % mqs.size();\n        return mqs.get(index);\n    }\n}, orderid);\n\n\nå¨è·åå°è·¯ç±ä¿¡æ¯ä»¥åï¼ä¼æ ¹æ® messagequeueselector å®ç°çç®æ³æ¥éæ©ä¸ä¸ªéåï¼åä¸ä¸ª orderid è·åå°çè¯å®æ¯åä¸ä¸ªéåã\n\nprivate sendresult send()  {\n    // è·åtopicè·¯ç±ä¿¡æ¯\n    topicpublishinfo topicpublishinfo = this.trytofindtopicpublishinfo(msg.gettopic());\n    if (topicpublishinfo != null && topicpublishinfo.ok()) {\n        messagequeue mq = null;\n        // æ ¹æ®æä»¬çç®æ³ï¼éæ©ä¸ä¸ªåééå\n        // è¿éçarg = orderid\n        mq = selector.select(topicpublishinfo.getmessagequeuelist(), msg, arg);\n        if (mq != null) {\n            return this.sendkernelimpl(msg, mq, communicationmode, sendcallback, timeout);\n        }\n    }\n}\n\n\n\n# æ¶æ¯éå¤\n\né ææ¶æ¯éå¤çæ ¹æ¬åå æ¯ï¼ç½ç»ä¸å¯è¾¾ãåªè¦éè¿ç½ç»äº¤æ¢æ°æ®ï¼å°±æ æ³é¿åè¿ä¸ªé®é¢ãæä»¥è§£å³è¿ä¸ªé®é¢çåæ³å°±æ¯ç»è¿è¿ä¸ªé®é¢ãé£ä¹é®é¢å°±åæäºï¼å¦ææ¶è´¹ç«¯æ¶å°ä¸¤æ¡ä¸æ ·çæ¶æ¯ï¼åºè¯¥ææ ·å¤çï¼\n\n 1. æ¶è´¹ç«¯å¤çæ¶æ¯çä¸å¡é»è¾ä¿æå¹ç­æ§ã\n 2. ä¿è¯æ¯æ¡æ¶æ¯é½æå¯ä¸ç¼å·ä¸ä¿è¯æ¶æ¯å¤çæåä¸å»éè¡¨çæ¥å¿åæ¶åºç°ã\n\nç¬¬ 1 æ¡å¾å¥½çè§£ï¼åªè¦ä¿æå¹ç­æ§ï¼ä¸ç®¡æ¥å¤å°æ¡éå¤æ¶æ¯ï¼æåå¤ççç»æé½ä¸æ ·ã\n\nç¬¬ 2 æ¡åçå°±æ¯å©ç¨ä¸å¼ æ¥å¿è¡¨æ¥è®°å½å·²ç»å¤çæåçæ¶æ¯ç idï¼å¦ææ°å°çæ¶æ¯ id å·²ç»å¨æ¥å¿è¡¨ä¸­ï¼é£ä¹å°±ä¸åå¤çè¿æ¡æ¶æ¯ã\n\nç¬¬ 1 æ¡è§£å³æ¹æ¡ï¼å¾ææ¾åºè¯¥å¨æ¶è´¹ç«¯å®ç°ï¼ä¸å±äºæ¶æ¯ç³»ç»è¦å®ç°çåè½ã\n\nç¬¬ 2 æ¡å¯ä»¥æ¶æ¯ç³»ç»å®ç°ï¼ä¹å¯ä»¥ä¸å¡ç«¯å®ç°ãæ­£å¸¸æåµä¸åºç°éå¤æ¶æ¯çæ¦çå¶å®å¾å°ï¼å¦æç±æ¶æ¯ç³»ç»æ¥å®ç°çè¯ï¼è¯å®ä¼å¯¹æ¶æ¯ç³»ç»çååéåé«å¯ç¨æå½±åï¼æä»¥æå¥½è¿æ¯ç±ä¸å¡ç«¯èªå·±å¤çæ¶æ¯éå¤çé®é¢ï¼è¿ä¹æ¯ rocketmq ä¸è§£å³æ¶æ¯éå¤çé®é¢çåå ã\n\nrocketmq ä¸ä¿è¯æ¶æ¯ä¸éå¤ï¼å¦æä½ çä¸å¡éè¦ä¿è¯ä¸¥æ ¼çä¸éå¤æ¶æ¯ï¼éè¦ä½ èªå·±å¨ä¸å¡ç«¯å»éã\n\n\n# äºå¡æ¶æ¯\n\nrocketmq é¤äºæ¯ææ®éæ¶æ¯ï¼é¡ºåºæ¶æ¯ï¼å¦å¤è¿æ¯æäºå¡æ¶æ¯ã\n\nåè®¾è¿æ ·çåºæ¯ï¼\n\n\n\nå¾ä¸­æ§è¡æ¬å°äºå¡ï¼bob è´¦æ·æ£æ¬¾ï¼ååéå¼æ­¥æ¶æ¯åºè¯¥ä¿è¯åæ¶æåæèåæ¶å¤±è´¥ï¼ä¹å°±æ¯æ£æ¬¾æåäºï¼åéæ¶æ¯ä¸å®è¦æåï¼å¦ææ£æ¬¾å¤±è´¥äºï¼å°±ä¸è½ååéæ¶æ¯ãé£é®é¢æ¯ï¼æä»¬æ¯åæ£æ¬¾è¿æ¯ååéæ¶æ¯å¢ï¼\n\n\n\nrocketmq åå¸å¼äºå¡æ­¥éª¤ï¼\n\nåé prepared æ¶æ¯ 2222222222222222222ï¼å¹¶æ¿å°æ¥åæ¶æ¯çå°åã æ§è¡æ¬å°äºå¡ éè¿ç¬¬ 1 æ­¥éª¤æ¿å°çå°åå»è®¿é®æ¶æ¯ï¼å¹¶ä¿®æ¹æ¶æ¯ç¶æã\n\n\n# åèèµæ\n\n * rocketmq å®æ¹ææ¡£\n * åå¸å¼å¼æ¾æ¶æ¯ç³»ç»(rocketmq)çåçä¸å®è·µ',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"ActiveMQ å¿«éå¥é¨",frontmatter:{title:"ActiveMQ å¿«éå¥é¨",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","MQ"],tags:["Java","ä¸­é´ä»¶","MQ","ActiveMQ"],abbrlink:"30b5d114",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/3f7c49/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.MQ/04.ActiveMQ.html",relativePath:"14.ä¸­é´ä»¶/01.MQ/04.ActiveMQ.md",key:"v-f41b300c",path:"/pages/3f7c49/",headers:[{level:2,title:"JMS åºæ¬æ¦å¿µ",slug:"jms-åºæ¬æ¦å¿µ",normalizedTitle:"jms åºæ¬æ¦å¿µ",charIndex:20},{level:3,title:"æ¶æ¯æ¨¡å",slug:"æ¶æ¯æ¨¡å",normalizedTitle:"æ¶æ¯æ¨¡å",charIndex:184},{level:4,title:"P2P çç¹ç¹",slug:"p2p-çç¹ç¹",normalizedTitle:"p2p çç¹ç¹",charIndex:260},{level:4,title:"Pub/Sub çç¹ç¹",slug:"pub-sub-çç¹ç¹",normalizedTitle:"pub/sub çç¹ç¹",charIndex:501},{level:3,title:"JMS ç¼ç¨æ¨¡å",slug:"jms-ç¼ç¨æ¨¡å",normalizedTitle:"jms ç¼ç¨æ¨¡å",charIndex:853},{level:4,title:"ConnectionFactory",slug:"connectionfactory",normalizedTitle:"connectionfactory",charIndex:867},{level:4,title:"Connection",slug:"connection",normalizedTitle:"connection",charIndex:867},{level:4,title:"Destination",slug:"destination",normalizedTitle:"destination",charIndex:1189},{level:4,title:"Session",slug:"session",normalizedTitle:"session",charIndex:1102},{level:4,title:"MessageConsumer",slug:"messageconsumer",normalizedTitle:"messageconsumer",charIndex:1599},{level:4,title:"MessageProducer",slug:"messageproducer",normalizedTitle:"messageproducer",charIndex:1757},{level:4,title:"Message",slug:"message",normalizedTitle:"message",charIndex:51},{level:2,title:"å®è£",slug:"å®è£",normalizedTitle:"å®è£",charIndex:2702},{level:2,title:"é¡¹ç®ä¸­çåºç¨",slug:"é¡¹ç®ä¸­çåºç¨",normalizedTitle:"é¡¹ç®ä¸­çåºç¨",charIndex:3124},{level:2,title:"èµæº",slug:"èµæº",normalizedTitle:"èµæº",charIndex:7437}],headersStr:"JMS åºæ¬æ¦å¿µ æ¶æ¯æ¨¡å P2P çç¹ç¹ Pub/Sub çç¹ç¹ JMS ç¼ç¨æ¨¡å ConnectionFactory Connection Destination Session MessageConsumer MessageProducer Message å®è£ é¡¹ç®ä¸­çåºç¨ èµæº",content:'# ActiveMQ å¿«éå¥é¨\n\n\n# JMS åºæ¬æ¦å¿µ\n\nJMS å³ Java æ¶æ¯æå¡ï¼Java Message Serviceï¼APIï¼æ¯ä¸ä¸ª Java å¹³å°ä¸­å³äºé¢åæ¶æ¯ä¸­é´ä»¶ç APIãå®ç¨äºå¨ä¸¤ä¸ªåºç¨ç¨åºä¹é´ï¼æåå¸å¼ç³»ç»ä¸­åéæ¶æ¯ï¼è¿è¡å¼æ­¥éä¿¡ãJava æ¶æ¯æå¡æ¯ä¸ä¸ªä¸å·ä½å¹³å°æ å³ç APIï¼ç»å¤§å¤æ° MOM æä¾åé½å¯¹ JMS æä¾æ¯æã\n\n\n# æ¶æ¯æ¨¡å\n\nJMS æä¸¤ç§æ¶æ¯æ¨¡åï¼\n\n * Point-to-Point(P2P)\n * Publish/Subscribe(Pub/Sub)\n\n# P2P çç¹ç¹\n\n\n\nå¨ç¹å¯¹ç¹çæ¶æ¯ç³»ç»ä¸­ï¼æ¶æ¯ååç»ä¸ä¸ªåç¬çä½¿ç¨èãç¹å¯¹ç¹æ¶æ¯å¾å¾ä¸éå javax.jms.Queue ç¸å³èã\n\næ¯ä¸ªæ¶æ¯åªæä¸ä¸ªæ¶è´¹èï¼Consumerï¼(å³ä¸æ¦è¢«æ¶è´¹ï¼æ¶æ¯å°±ä¸åå¨æ¶æ¯éåä¸­)ã\n\nåéèåæ¥æ¶èä¹é´å¨æ¶é´ä¸æ²¡æä¾èµæ§ï¼ä¹å°±æ¯è¯´å½åéèåéäºæ¶æ¯ä¹åï¼ä¸ç®¡æ¥æ¶èææ²¡ææ­£å¨è¿è¡ï¼å®ä¸ä¼å½±åå°æ¶æ¯è¢«åéå°éåã\n\næ¥æ¶èå¨æåæ¥æ¶æ¶æ¯ä¹åéåéååºç­æåã\n\nå¦æä½ å¸æåéçæ¯ä¸ªæ¶æ¯é½åºè¯¥è¢«æåå¤ççè¯ï¼é£ä¹ä½ éè¦ P2P æ¨¡å¼ã\n\n# Pub/Sub çç¹ç¹\n\n\n\nåå¸/è®¢éæ¶æ¯ç³»ç»æ¯æä¸ä¸ªäºä»¶é©±å¨æ¨¡åï¼æ¶æ¯çäº§èåæ¶è´¹èé½åä¸æ¶æ¯çä¼ éãçäº§èåå¸äºä»¶ï¼èä½¿ç¨èè®¢éæå´è¶£çäºä»¶ï¼å¹¶ä½¿ç¨äºä»¶ãè¯¥ç±»åæ¶æ¯ä¸è¬ä¸ç¹å®çä¸»é¢ javax.jms.Topic å³èã\n\næ¯ä¸ªæ¶æ¯å¯ä»¥æå¤ä¸ªæ¶è´¹èã\n\nåå¸èåè®¢éèä¹é´ææ¶é´ä¸çä¾èµæ§ãéå¯¹æä¸ªä¸»é¢ï¼Topicï¼çè®¢éèï¼å®å¿é¡»åå»ºä¸ä¸ªè®¢éèä¹åï¼æè½æ¶è´¹åå¸èçæ¶æ¯ï¼èä¸ä¸ºäºæ¶è´¹æ¶æ¯ï¼è®¢éèå¿é¡»ä¿æè¿è¡çç¶æã\n\nä¸ºäºç¼åè¿æ ·ä¸¥æ ¼çæ¶é´ç¸å³æ§ï¼JMS åè®¸è®¢éèåå»ºä¸ä¸ªå¯æä¹åçè®¢éãè¿æ ·ï¼å³ä½¿è®¢éèæ²¡æè¢«æ¿æ´»ï¼è¿è¡ï¼ï¼å®ä¹è½æ¥æ¶å°åå¸èçæ¶æ¯ã\n\nå¦æä½ å¸æåéçæ¶æ¯å¯ä»¥ä¸è¢«åä»»ä½å¤çãæèè¢«ä¸ä¸ªæ¶æ¯èå¤çãæèå¯ä»¥è¢«å¤ä¸ªæ¶è´¹èå¤ççè¯ï¼é£ä¹å¯ä»¥éç¨ Pub/Sub æ¨¡åã\n\n\n# JMS ç¼ç¨æ¨¡å\n\n\n\n# ConnectionFactory\n\nåå»º Connection å¯¹è±¡çå·¥åï¼éå¯¹ä¸¤ç§ä¸åç jms æ¶æ¯æ¨¡åï¼åå«æ QueueConnectionFactory åTopicConnectionFactory ä¸¤ç§ãå¯ä»¥éè¿ JNDI æ¥æ¥æ¾ ConnectionFactory å¯¹è±¡ã\n\n# Connection\n\nConnection è¡¨ç¤ºå¨å®¢æ·ç«¯å JMS ç³»ç»ä¹é´å»ºç«çé¾æ¥ï¼å¯¹ TCP/IP socket çåè£ï¼ãConnection å¯ä»¥äº§çä¸ä¸ªæå¤ä¸ªSessionãè· ConnectionFactory ä¸æ ·ï¼Connection ä¹æä¸¤ç§ç±»åï¼QueueConnection å TopicConnectionã\n\n# Destination\n\nDestination æ¯ä¸ä¸ªåè£äºæ¶æ¯ç®æ æ è¯ç¬¦çè¢«ç®¡å¯¹è±¡ãæ¶æ¯ç®æ æ¯ææ¶æ¯åå¸åæ¥æ¶çå°ç¹ï¼æèæ¯éå Queue ï¼æèæ¯ä¸»é¢ Topic ãJMS ç®¡çååå»ºè¿äºå¯¹è±¡ï¼ç¶åç¨æ·éè¿ JNDI åç°å®ä»¬ãåè¿æ¥å·¥åä¸æ ·ï¼ç®¡çåå¯ä»¥åå»ºä¸¤ç§ç±»åçç®æ ï¼ç¹å¯¹ç¹æ¨¡åç Queueï¼ä»¥ååå¸è/è®¢éèæ¨¡åç Topicã\n\n# Session\n\nSession è¡¨ç¤ºä¸ä¸ªåçº¿ç¨çä¸ä¸æï¼ç¨äºåéåæ¥æ¶æ¶æ¯ãç±äºä¼è¯æ¯åçº¿ç¨çï¼æä»¥æ¶æ¯æ¯è¿ç»­çï¼å°±æ¯è¯´æ¶æ¯æ¯æç§åéçé¡ºåºä¸ä¸ªä¸ä¸ªæ¥æ¶çãä¼è¯çå¥½å¤æ¯å®æ¯æäºå¡ãå¦æç¨æ·éæ©äºäºå¡æ¯æï¼ä¼è¯ä¸ä¸æå°ä¿å­ä¸ç»æ¶æ¯ï¼ç´å°äºå¡è¢«æäº¤æåéè¿äºæ¶æ¯ãå¨æäº¤äºå¡ä¹åï¼ç¨æ·å¯ä»¥ä½¿ç¨åæ»æä½åæ¶è¿äºæ¶æ¯ãä¸ä¸ªä¼è¯åè®¸ç¨æ·åå»ºæ¶æ¯ï¼çäº§èæ¥åéæ¶æ¯ï¼æ¶è´¹èæ¥æ¥æ¶æ¶æ¯ãåæ ·ï¼Session ä¹å QueueSession å TopicSessionã\n\n# MessageConsumer\n\nMessageConsumer ç± Session åå»ºï¼å¹¶ç¨äºå°æ¶æ¯åéå° Destinationãæ¶è´¹èå¯ä»¥åæ­¥å°ï¼é»å¡æ¨¡å¼ï¼ï¼æï¼éé»å¡ï¼æ¥æ¶ Queue å Topic ç±»åçæ¶æ¯ãåæ ·ï¼æ¶æ¯çäº§èåä¸¤ç§ç±»åï¼QueueSender åTopicPublisherã\n\n# MessageProducer\n\nMessageProducer ç± Session åå»ºï¼ç¨äºæ¥æ¶è¢«åéå° Destination çæ¶æ¯ãMessageProducer æä¸¤ç§ç±»åï¼QueueReceiver å TopicSubscriberãå¯åå«éè¿ session ç createReceiver(Queue) æ createSubscriber(Topic) æ¥åå»ºãå½ç¶ï¼ä¹å¯ä»¥ session ç creatDurableSubscriber æ¹æ³æ¥åå»ºæä¹åçè®¢éèã\n\n# Message\n\næ¯å¨æ¶è´¹èåçäº§èä¹é´ä¼ éçå¯¹è±¡ï¼ä¹å°±æ¯è¯´ä»ä¸ä¸ªåºç¨ç¨åºä¼ éå°å¦ä¸ä¸ªåºç¨ç¨åºãä¸ä¸ªæ¶æ¯æä¸ä¸ªä¸»è¦é¨åï¼\n\n * æ¶æ¯å¤´ï¼å¿é¡»ï¼ï¼åå«ç¨äºè¯å«åä¸ºæ¶æ¯å¯»æ¾è·¯ç±çæä½è®¾ç½®ã\n * ä¸ç»æ¶æ¯å±æ§ï¼å¯éï¼ï¼åå«é¢å¤çå±æ§ï¼æ¯æå¶ä»æä¾èåç¨æ·çå¼å®¹ãå¯ä»¥åå»ºå®å¶çå­æ®µåè¿æ»¤å¨ï¼æ¶æ¯éæ©å¨ï¼ã\n * ä¸ä¸ªæ¶æ¯ä½ï¼å¯éï¼ï¼åè®¸ç¨æ·åå»ºäºç§ç±»åçæ¶æ¯ï¼ææ¬æ¶æ¯ï¼æ å°æ¶æ¯ï¼å­èæ¶æ¯ï¼æµæ¶æ¯åå¯¹è±¡æ¶æ¯ï¼ã\n\næ¶æ¯æ¥å£éå¸¸çµæ´»ï¼å¹¶æä¾äºè®¸å¤æ¹å¼æ¥å®å¶æ¶æ¯çåå®¹ã\n\nCOMMON              POINT-TO-POINT                PUBLISH-SUBSCRIBE\nConnectionFactory   QueueConnectionFactory        TopicConnectionFactory\nConnection          QueueConnection               TopicConnection\nDestination         Queue                         Topic\nSession             QueueSession                  TopicSession\nMessageProducer     QueueSender                   TopicPublisher\nMessageSender       QueueReceiver, QueueBrowser   TopicSubscriber\n\n\n# å®è£\n\nå®è£æ¡ä»¶\n\nJDK1.7 åä»¥ä¸çæ¬\n\næ¬å°éç½®äº JAVA_HOME ç¯å¢åéã\n\nä¸è½½\n\næ¯æ Windows/Unix/Linux/Cygwin\n\nActiveMQ å®æ¹ä¸è½½å°å\n\nWindows ä¸è¿è¡\n\nï¼1ï¼è§£ååç¼©åå°æ¬å°ï¼\n\nï¼2ï¼æå¼æ§å¶å°ï¼è¿å¥å®è£ç®å½ç bin ç®å½ä¸ï¼\n\ncd [activemq_install_dir]\n\n\nï¼3ï¼æ§è¡ activemq start æ¥å¯å¨ ActiveMQ\n\nbin\\activemq start\n\n\næµè¯å®è£æ¯å¦æå\n\nï¼1ï¼ActiveMQ é»è®¤çå¬ç«¯å£ä¸º 61616\n\nnetstat -an|find â61616â\n\n\nï¼2ï¼è®¿é® http://127.0.0.1:8161/admin/\n\nï¼3ï¼è¾å¥ç¨æ·åãå¯ç \n\nLogin: admin\nPasswort: admin\n\n\nï¼4ï¼ç¹å»å¯¼èªæ ç Queues èå\n\nï¼5ï¼æ·»å ä¸ä¸ªéåï¼queueï¼\n\n\n# é¡¹ç®ä¸­çåºç¨\n\nå¼å¥ä¾èµ\n\n<dependency>\n  <groupId>org.apache.activemq</groupId>\n  <artifactId>activemq-all</artifactId>\n  <version>5.14.1</version>\n</dependency>\n\n\nSender.java\n\npublic class Sender {\n    private static final int SEND_NUMBER = 4;\n\n    public static void main(String[] args) {\n        // ConnectionFactory ï¼è¿æ¥å·¥åï¼JMS ç¨å®åå»ºè¿æ¥\n        ConnectionFactory connectionFactory;\n        // Connection ï¼JMS å®¢æ·ç«¯å°JMS Provider çè¿æ¥\n        Connection connection = null;\n        // Sessionï¼ ä¸ä¸ªåéææ¥æ¶æ¶æ¯ççº¿ç¨\n        Session session;\n        // Destination ï¼æ¶æ¯çç®çå°;æ¶æ¯åéç»è°.\n        Destination destination;\n        // MessageProducerï¼æ¶æ¯åéè\n        MessageProducer producer;\n        // TextMessage message;\n        // æé ConnectionFactoryå®ä¾å¯¹è±¡ï¼æ­¤å¤éç¨ActiveMqçå®ç°jar\n        connectionFactory = new ActiveMQConnectionFactory(\n                ActiveMQConnection.DEFAULT_USER,\n                ActiveMQConnection.DEFAULT_PASSWORD,\n                "tcp://localhost:61616");\n        try {\n            // æé ä»å·¥åå¾å°è¿æ¥å¯¹è±¡\n            connection = connectionFactory.createConnection();\n            // å¯å¨\n            connection.start();\n            // è·åæä½è¿æ¥\n            session = connection.createSession(Boolean.TRUE,\n                    Session.AUTO_ACKNOWLEDGE);\n            // è·åsessionæ³¨æåæ°å¼xingbo.xu-queueæ¯ä¸ä¸ªæå¡å¨çqueueï¼é¡»å¨å¨ActiveMqçconsoleéç½®\n            destination = session.createQueue("FirstQueue");\n            // å¾å°æ¶æ¯çæèãåéèã\n            producer = session.createProducer(destination);\n            // è®¾ç½®ä¸æä¹åï¼æ­¤å¤å­¦ä¹ ï¼å®éæ ¹æ®é¡¹ç®å³å®\n            producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT);\n            // æé æ¶æ¯ï¼æ­¤å¤åæ­»ï¼é¡¹ç®å°±æ¯åæ°ï¼æèæ¹æ³è·å\n            sendMessage(session, producer);\n            session.commit();\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                if (null != connection)\n                    connection.close();\n            } catch (Throwable ignore) {\n            }\n        }\n    }\n\n    public static void sendMessage(Session session, MessageProducer producer)\n            throws Exception {\n        for (int i = 1; i <= SEND_NUMBER; i++) {\n            TextMessage message = session\n                    .createTextMessage("ActiveMq åéçæ¶æ¯" + i);\n            // åéæ¶æ¯å°ç®çå°æ¹\n            System.out.println("åéæ¶æ¯ï¼" + "ActiveMq åéçæ¶æ¯" + i);\n            producer.send(message);\n        }\n    }\n}\n\n\nReceiver.java\n\npublic class Receiver {\n    public static void main(String[] args) {\n        // ConnectionFactory ï¼è¿æ¥å·¥åï¼JMS ç¨å®åå»ºè¿æ¥\n        ConnectionFactory connectionFactory;\n        // Connection ï¼JMS å®¢æ·ç«¯å°JMS Provider çè¿æ¥\n        Connection connection = null;\n        // Sessionï¼ ä¸ä¸ªåéææ¥æ¶æ¶æ¯ççº¿ç¨\n        Session session;\n        // Destination ï¼æ¶æ¯çç®çå°;æ¶æ¯åéç»è°.\n        Destination destination;\n        // æ¶è´¹èï¼æ¶æ¯æ¥æ¶è\n        MessageConsumer consumer;\n        connectionFactory = new ActiveMQConnectionFactory(\n                ActiveMQConnection.DEFAULT_USER,\n                ActiveMQConnection.DEFAULT_PASSWORD,\n                "tcp://localhost:61616");\n        try {\n            // æé ä»å·¥åå¾å°è¿æ¥å¯¹è±¡\n            connection = connectionFactory.createConnection();\n            // å¯å¨\n            connection.start();\n            // è·åæä½è¿æ¥\n            session = connection.createSession(Boolean.FALSE,\n                    Session.AUTO_ACKNOWLEDGE);\n            // è·åsessionæ³¨æåæ°å¼xingbo.xu-queueæ¯ä¸ä¸ªæå¡å¨çqueueï¼é¡»å¨å¨ActiveMqçconsoleéç½®\n            destination = session.createQueue("FirstQueue");\n            consumer = session.createConsumer(destination);\n            while (true) {\n                //è®¾ç½®æ¥æ¶èæ¥æ¶æ¶æ¯çæ¶é´ï¼ä¸ºäºä¾¿äºæµè¯ï¼è¿éè°å®ä¸º100s\n                TextMessage message = (TextMessage) consumer.receive(100000);\n                if (null != message) {\n                    System.out.println("æ¶å°æ¶æ¯" + message.getText());\n                } else {\n                    break;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                if (null != connection)\n                    connection.close();\n            } catch (Throwable ignore) {\n            }\n        }\n    }\n}\n\n\nè¿è¡\n\nåè¿è¡ Receiver.java è¿è¡æ¶æ¯çå¬ï¼åè¿è¡ Send.java åéæ¶æ¯ã\n\nè¾åº\n\nSend çè¾åºåå®¹\n\nåéæ¶æ¯ï¼Activemq åéæ¶æ¯0\nåéæ¶æ¯ï¼Activemq åéæ¶æ¯1\nåéæ¶æ¯ï¼Activemq åéæ¶æ¯2\nåéæ¶æ¯ï¼Activemq åéæ¶æ¯3\n\n\nReceiver çè¾åºåå®¹\n\næ¶å°æ¶æ¯ActiveMQ åéæ¶æ¯0\næ¶å°æ¶æ¯ActiveMQ åéæ¶æ¯1\næ¶å°æ¶æ¯ActiveMQ åéæ¶æ¯2\næ¶å°æ¶æ¯ActiveMQ åéæ¶æ¯3\n\n\n\n# èµæº\n\n * ActiveMQ å®ç½\n * oracle å®æ¹ç jms ä»ç»',normalizedContent:'# activemq å¿«éå¥é¨\n\n\n# jms åºæ¬æ¦å¿µ\n\njms å³ java æ¶æ¯æå¡ï¼java message serviceï¼apiï¼æ¯ä¸ä¸ª java å¹³å°ä¸­å³äºé¢åæ¶æ¯ä¸­é´ä»¶ç apiãå®ç¨äºå¨ä¸¤ä¸ªåºç¨ç¨åºä¹é´ï¼æåå¸å¼ç³»ç»ä¸­åéæ¶æ¯ï¼è¿è¡å¼æ­¥éä¿¡ãjava æ¶æ¯æå¡æ¯ä¸ä¸ªä¸å·ä½å¹³å°æ å³ç apiï¼ç»å¤§å¤æ° mom æä¾åé½å¯¹ jms æä¾æ¯æã\n\n\n# æ¶æ¯æ¨¡å\n\njms æä¸¤ç§æ¶æ¯æ¨¡åï¼\n\n * point-to-point(p2p)\n * publish/subscribe(pub/sub)\n\n# p2p çç¹ç¹\n\n\n\nå¨ç¹å¯¹ç¹çæ¶æ¯ç³»ç»ä¸­ï¼æ¶æ¯ååç»ä¸ä¸ªåç¬çä½¿ç¨èãç¹å¯¹ç¹æ¶æ¯å¾å¾ä¸éå javax.jms.queue ç¸å³èã\n\næ¯ä¸ªæ¶æ¯åªæä¸ä¸ªæ¶è´¹èï¼consumerï¼(å³ä¸æ¦è¢«æ¶è´¹ï¼æ¶æ¯å°±ä¸åå¨æ¶æ¯éåä¸­)ã\n\nåéèåæ¥æ¶èä¹é´å¨æ¶é´ä¸æ²¡æä¾èµæ§ï¼ä¹å°±æ¯è¯´å½åéèåéäºæ¶æ¯ä¹åï¼ä¸ç®¡æ¥æ¶èææ²¡ææ­£å¨è¿è¡ï¼å®ä¸ä¼å½±åå°æ¶æ¯è¢«åéå°éåã\n\næ¥æ¶èå¨æåæ¥æ¶æ¶æ¯ä¹åéåéååºç­æåã\n\nå¦æä½ å¸æåéçæ¯ä¸ªæ¶æ¯é½åºè¯¥è¢«æåå¤ççè¯ï¼é£ä¹ä½ éè¦ p2p æ¨¡å¼ã\n\n# pub/sub çç¹ç¹\n\n\n\nåå¸/è®¢éæ¶æ¯ç³»ç»æ¯æä¸ä¸ªäºä»¶é©±å¨æ¨¡åï¼æ¶æ¯çäº§èåæ¶è´¹èé½åä¸æ¶æ¯çä¼ éãçäº§èåå¸äºä»¶ï¼èä½¿ç¨èè®¢éæå´è¶£çäºä»¶ï¼å¹¶ä½¿ç¨äºä»¶ãè¯¥ç±»åæ¶æ¯ä¸è¬ä¸ç¹å®çä¸»é¢ javax.jms.topic å³èã\n\næ¯ä¸ªæ¶æ¯å¯ä»¥æå¤ä¸ªæ¶è´¹èã\n\nåå¸èåè®¢éèä¹é´ææ¶é´ä¸çä¾èµæ§ãéå¯¹æä¸ªä¸»é¢ï¼topicï¼çè®¢éèï¼å®å¿é¡»åå»ºä¸ä¸ªè®¢éèä¹åï¼æè½æ¶è´¹åå¸èçæ¶æ¯ï¼èä¸ä¸ºäºæ¶è´¹æ¶æ¯ï¼è®¢éèå¿é¡»ä¿æè¿è¡çç¶æã\n\nä¸ºäºç¼åè¿æ ·ä¸¥æ ¼çæ¶é´ç¸å³æ§ï¼jms åè®¸è®¢éèåå»ºä¸ä¸ªå¯æä¹åçè®¢éãè¿æ ·ï¼å³ä½¿è®¢éèæ²¡æè¢«æ¿æ´»ï¼è¿è¡ï¼ï¼å®ä¹è½æ¥æ¶å°åå¸èçæ¶æ¯ã\n\nå¦æä½ å¸æåéçæ¶æ¯å¯ä»¥ä¸è¢«åä»»ä½å¤çãæèè¢«ä¸ä¸ªæ¶æ¯èå¤çãæèå¯ä»¥è¢«å¤ä¸ªæ¶è´¹èå¤ççè¯ï¼é£ä¹å¯ä»¥éç¨ pub/sub æ¨¡åã\n\n\n# jms ç¼ç¨æ¨¡å\n\n\n\n# connectionfactory\n\nåå»º connection å¯¹è±¡çå·¥åï¼éå¯¹ä¸¤ç§ä¸åç jms æ¶æ¯æ¨¡åï¼åå«æ queueconnectionfactory åtopicconnectionfactory ä¸¤ç§ãå¯ä»¥éè¿ jndi æ¥æ¥æ¾ connectionfactory å¯¹è±¡ã\n\n# connection\n\nconnection è¡¨ç¤ºå¨å®¢æ·ç«¯å jms ç³»ç»ä¹é´å»ºç«çé¾æ¥ï¼å¯¹ tcp/ip socket çåè£ï¼ãconnection å¯ä»¥äº§çä¸ä¸ªæå¤ä¸ªsessionãè· connectionfactory ä¸æ ·ï¼connection ä¹æä¸¤ç§ç±»åï¼queueconnection å topicconnectionã\n\n# destination\n\ndestination æ¯ä¸ä¸ªåè£äºæ¶æ¯ç®æ æ è¯ç¬¦çè¢«ç®¡å¯¹è±¡ãæ¶æ¯ç®æ æ¯ææ¶æ¯åå¸åæ¥æ¶çå°ç¹ï¼æèæ¯éå queue ï¼æèæ¯ä¸»é¢ topic ãjms ç®¡çååå»ºè¿äºå¯¹è±¡ï¼ç¶åç¨æ·éè¿ jndi åç°å®ä»¬ãåè¿æ¥å·¥åä¸æ ·ï¼ç®¡çåå¯ä»¥åå»ºä¸¤ç§ç±»åçç®æ ï¼ç¹å¯¹ç¹æ¨¡åç queueï¼ä»¥ååå¸è/è®¢éèæ¨¡åç topicã\n\n# session\n\nsession è¡¨ç¤ºä¸ä¸ªåçº¿ç¨çä¸ä¸æï¼ç¨äºåéåæ¥æ¶æ¶æ¯ãç±äºä¼è¯æ¯åçº¿ç¨çï¼æä»¥æ¶æ¯æ¯è¿ç»­çï¼å°±æ¯è¯´æ¶æ¯æ¯æç§åéçé¡ºåºä¸ä¸ªä¸ä¸ªæ¥æ¶çãä¼è¯çå¥½å¤æ¯å®æ¯æäºå¡ãå¦æç¨æ·éæ©äºäºå¡æ¯æï¼ä¼è¯ä¸ä¸æå°ä¿å­ä¸ç»æ¶æ¯ï¼ç´å°äºå¡è¢«æäº¤æåéè¿äºæ¶æ¯ãå¨æäº¤äºå¡ä¹åï¼ç¨æ·å¯ä»¥ä½¿ç¨åæ»æä½åæ¶è¿äºæ¶æ¯ãä¸ä¸ªä¼è¯åè®¸ç¨æ·åå»ºæ¶æ¯ï¼çäº§èæ¥åéæ¶æ¯ï¼æ¶è´¹èæ¥æ¥æ¶æ¶æ¯ãåæ ·ï¼session ä¹å queuesession å topicsessionã\n\n# messageconsumer\n\nmessageconsumer ç± session åå»ºï¼å¹¶ç¨äºå°æ¶æ¯åéå° destinationãæ¶è´¹èå¯ä»¥åæ­¥å°ï¼é»å¡æ¨¡å¼ï¼ï¼æï¼éé»å¡ï¼æ¥æ¶ queue å topic ç±»åçæ¶æ¯ãåæ ·ï¼æ¶æ¯çäº§èåä¸¤ç§ç±»åï¼queuesender åtopicpublisherã\n\n# messageproducer\n\nmessageproducer ç± session åå»ºï¼ç¨äºæ¥æ¶è¢«åéå° destination çæ¶æ¯ãmessageproducer æä¸¤ç§ç±»åï¼queuereceiver å topicsubscriberãå¯åå«éè¿ session ç createreceiver(queue) æ createsubscriber(topic) æ¥åå»ºãå½ç¶ï¼ä¹å¯ä»¥ session ç creatdurablesubscriber æ¹æ³æ¥åå»ºæä¹åçè®¢éèã\n\n# message\n\næ¯å¨æ¶è´¹èåçäº§èä¹é´ä¼ éçå¯¹è±¡ï¼ä¹å°±æ¯è¯´ä»ä¸ä¸ªåºç¨ç¨åºä¼ éå°å¦ä¸ä¸ªåºç¨ç¨åºãä¸ä¸ªæ¶æ¯æä¸ä¸ªä¸»è¦é¨åï¼\n\n * æ¶æ¯å¤´ï¼å¿é¡»ï¼ï¼åå«ç¨äºè¯å«åä¸ºæ¶æ¯å¯»æ¾è·¯ç±çæä½è®¾ç½®ã\n * ä¸ç»æ¶æ¯å±æ§ï¼å¯éï¼ï¼åå«é¢å¤çå±æ§ï¼æ¯æå¶ä»æä¾èåç¨æ·çå¼å®¹ãå¯ä»¥åå»ºå®å¶çå­æ®µåè¿æ»¤å¨ï¼æ¶æ¯éæ©å¨ï¼ã\n * ä¸ä¸ªæ¶æ¯ä½ï¼å¯éï¼ï¼åè®¸ç¨æ·åå»ºäºç§ç±»åçæ¶æ¯ï¼ææ¬æ¶æ¯ï¼æ å°æ¶æ¯ï¼å­èæ¶æ¯ï¼æµæ¶æ¯åå¯¹è±¡æ¶æ¯ï¼ã\n\næ¶æ¯æ¥å£éå¸¸çµæ´»ï¼å¹¶æä¾äºè®¸å¤æ¹å¼æ¥å®å¶æ¶æ¯çåå®¹ã\n\ncommon              point-to-point                publish-subscribe\nconnectionfactory   queueconnectionfactory        topicconnectionfactory\nconnection          queueconnection               topicconnection\ndestination         queue                         topic\nsession             queuesession                  topicsession\nmessageproducer     queuesender                   topicpublisher\nmessagesender       queuereceiver, queuebrowser   topicsubscriber\n\n\n# å®è£\n\nå®è£æ¡ä»¶\n\njdk1.7 åä»¥ä¸çæ¬\n\næ¬å°éç½®äº java_home ç¯å¢åéã\n\nä¸è½½\n\næ¯æ windows/unix/linux/cygwin\n\nactivemq å®æ¹ä¸è½½å°å\n\nwindows ä¸è¿è¡\n\nï¼1ï¼è§£ååç¼©åå°æ¬å°ï¼\n\nï¼2ï¼æå¼æ§å¶å°ï¼è¿å¥å®è£ç®å½ç bin ç®å½ä¸ï¼\n\ncd [activemq_install_dir]\n\n\nï¼3ï¼æ§è¡ activemq start æ¥å¯å¨ activemq\n\nbin\\activemq start\n\n\næµè¯å®è£æ¯å¦æå\n\nï¼1ï¼activemq é»è®¤çå¬ç«¯å£ä¸º 61616\n\nnetstat -an|find â61616â\n\n\nï¼2ï¼è®¿é® http://127.0.0.1:8161/admin/\n\nï¼3ï¼è¾å¥ç¨æ·åãå¯ç \n\nlogin: admin\npasswort: admin\n\n\nï¼4ï¼ç¹å»å¯¼èªæ ç queues èå\n\nï¼5ï¼æ·»å ä¸ä¸ªéåï¼queueï¼\n\n\n# é¡¹ç®ä¸­çåºç¨\n\nå¼å¥ä¾èµ\n\n<dependency>\n  <groupid>org.apache.activemq</groupid>\n  <artifactid>activemq-all</artifactid>\n  <version>5.14.1</version>\n</dependency>\n\n\nsender.java\n\npublic class sender {\n    private static final int send_number = 4;\n\n    public static void main(string[] args) {\n        // connectionfactory ï¼è¿æ¥å·¥åï¼jms ç¨å®åå»ºè¿æ¥\n        connectionfactory connectionfactory;\n        // connection ï¼jms å®¢æ·ç«¯å°jms provider çè¿æ¥\n        connection connection = null;\n        // sessionï¼ ä¸ä¸ªåéææ¥æ¶æ¶æ¯ççº¿ç¨\n        session session;\n        // destination ï¼æ¶æ¯çç®çå°;æ¶æ¯åéç»è°.\n        destination destination;\n        // messageproducerï¼æ¶æ¯åéè\n        messageproducer producer;\n        // textmessage message;\n        // æé connectionfactoryå®ä¾å¯¹è±¡ï¼æ­¤å¤éç¨activemqçå®ç°jar\n        connectionfactory = new activemqconnectionfactory(\n                activemqconnection.default_user,\n                activemqconnection.default_password,\n                "tcp://localhost:61616");\n        try {\n            // æé ä»å·¥åå¾å°è¿æ¥å¯¹è±¡\n            connection = connectionfactory.createconnection();\n            // å¯å¨\n            connection.start();\n            // è·åæä½è¿æ¥\n            session = connection.createsession(boolean.true,\n                    session.auto_acknowledge);\n            // è·åsessionæ³¨æåæ°å¼xingbo.xu-queueæ¯ä¸ä¸ªæå¡å¨çqueueï¼é¡»å¨å¨activemqçconsoleéç½®\n            destination = session.createqueue("firstqueue");\n            // å¾å°æ¶æ¯çæèãåéèã\n            producer = session.createproducer(destination);\n            // è®¾ç½®ä¸æä¹åï¼æ­¤å¤å­¦ä¹ ï¼å®éæ ¹æ®é¡¹ç®å³å®\n            producer.setdeliverymode(deliverymode.non_persistent);\n            // æé æ¶æ¯ï¼æ­¤å¤åæ­»ï¼é¡¹ç®å°±æ¯åæ°ï¼æèæ¹æ³è·å\n            sendmessage(session, producer);\n            session.commit();\n        } catch (exception e) {\n            e.printstacktrace();\n        } finally {\n            try {\n                if (null != connection)\n                    connection.close();\n            } catch (throwable ignore) {\n            }\n        }\n    }\n\n    public static void sendmessage(session session, messageproducer producer)\n            throws exception {\n        for (int i = 1; i <= send_number; i++) {\n            textmessage message = session\n                    .createtextmessage("activemq åéçæ¶æ¯" + i);\n            // åéæ¶æ¯å°ç®çå°æ¹\n            system.out.println("åéæ¶æ¯ï¼" + "activemq åéçæ¶æ¯" + i);\n            producer.send(message);\n        }\n    }\n}\n\n\nreceiver.java\n\npublic class receiver {\n    public static void main(string[] args) {\n        // connectionfactory ï¼è¿æ¥å·¥åï¼jms ç¨å®åå»ºè¿æ¥\n        connectionfactory connectionfactory;\n        // connection ï¼jms å®¢æ·ç«¯å°jms provider çè¿æ¥\n        connection connection = null;\n        // sessionï¼ ä¸ä¸ªåéææ¥æ¶æ¶æ¯ççº¿ç¨\n        session session;\n        // destination ï¼æ¶æ¯çç®çå°;æ¶æ¯åéç»è°.\n        destination destination;\n        // æ¶è´¹èï¼æ¶æ¯æ¥æ¶è\n        messageconsumer consumer;\n        connectionfactory = new activemqconnectionfactory(\n                activemqconnection.default_user,\n                activemqconnection.default_password,\n                "tcp://localhost:61616");\n        try {\n            // æé ä»å·¥åå¾å°è¿æ¥å¯¹è±¡\n            connection = connectionfactory.createconnection();\n            // å¯å¨\n            connection.start();\n            // è·åæä½è¿æ¥\n            session = connection.createsession(boolean.false,\n                    session.auto_acknowledge);\n            // è·åsessionæ³¨æåæ°å¼xingbo.xu-queueæ¯ä¸ä¸ªæå¡å¨çqueueï¼é¡»å¨å¨activemqçconsoleéç½®\n            destination = session.createqueue("firstqueue");\n            consumer = session.createconsumer(destination);\n            while (true) {\n                //è®¾ç½®æ¥æ¶èæ¥æ¶æ¶æ¯çæ¶é´ï¼ä¸ºäºä¾¿äºæµè¯ï¼è¿éè°å®ä¸º100s\n                textmessage message = (textmessage) consumer.receive(100000);\n                if (null != message) {\n                    system.out.println("æ¶å°æ¶æ¯" + message.gettext());\n                } else {\n                    break;\n                }\n            }\n        } catch (exception e) {\n            e.printstacktrace();\n        } finally {\n            try {\n                if (null != connection)\n                    connection.close();\n            } catch (throwable ignore) {\n            }\n        }\n    }\n}\n\n\nè¿è¡\n\nåè¿è¡ receiver.java è¿è¡æ¶æ¯çå¬ï¼åè¿è¡ send.java åéæ¶æ¯ã\n\nè¾åº\n\nsend çè¾åºåå®¹\n\nåéæ¶æ¯ï¼activemq åéæ¶æ¯0\nåéæ¶æ¯ï¼activemq åéæ¶æ¯1\nåéæ¶æ¯ï¼activemq åéæ¶æ¯2\nåéæ¶æ¯ï¼activemq åéæ¶æ¯3\n\n\nreceiver çè¾åºåå®¹\n\næ¶å°æ¶æ¯activemq åéæ¶æ¯0\næ¶å°æ¶æ¯activemq åéæ¶æ¯1\næ¶å°æ¶æ¯activemq åéæ¶æ¯2\næ¶å°æ¶æ¯activemq åéæ¶æ¯3\n\n\n\n# èµæº\n\n * activemq å®ç½\n * oracle å®æ¹ç jms ä»ç»',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java åæ¶æ¯éå",frontmatter:{title:"Java åæ¶æ¯éå",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","MQ"],tags:["Java","ä¸­é´ä»¶","MQ"],abbrlink:"71639a39",date:"2022-02-17T22:34:30.000Z",hidden:!0,permalink:"/pages/fc0b29/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.MQ/",relativePath:"14.ä¸­é´ä»¶/01.MQ/README.md",key:"v-2525a60d",path:"/pages/fc0b29/",headers:[{level:2,title:"åå®¹",slug:"åå®¹",normalizedTitle:"åå®¹",charIndex:196},{level:2,title:"ææ¯å¯¹æ¯",slug:"ææ¯å¯¹æ¯",normalizedTitle:"ææ¯å¯¹æ¯",charIndex:265},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:2056},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:2169}],headersStr:"åå®¹ ææ¯å¯¹æ¯ ð èµæ ðª ä¼ é",content:"# Java åæ¶æ¯éå\n\n> æ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åå¸å¼åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ åç§æ¶æ¯éåäº§åï¼å»ºè®®åäºè§£ä¸ä¸ æ¶æ¯éååºæ¬åç ï¼æå©äºçè§£æ¶æ¯éåç¹æ§çå®ç°åè®¾è®¡æè·¯ã\n\n\n# åå®¹\n\n * æ¶æ¯éåé¢è¯\n * æ¶æ¯éååºæ¬åç\n * Kafka æç¨ ð\n * RocketMQ\n * ActiveMQ\n\n\n# ææ¯å¯¹æ¯\n\nç¹æ§                ACTIVEMQ                     RABBITMQ                        ROCKETMQ                                      KAFKA\nåæºååé             ä¸çº§ï¼æ¯ RocketMQãKafka ä½ä¸ä¸ªæ°éçº§   å ActiveMQ                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡å®æ¶æ°æ®è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ RocketMQ   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼Kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ RabbitMQ çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å ActiveMQ                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å RocketMQ\nåè½æ¯æ              MQ é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   MQ åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç MQ åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸è¬çä¸å¡ç³»ç»è¦å¼å¥ MQï¼ææ©å¤§å®¶é½ç¨ ActiveMQï¼ä½æ¯ç°å¨ç¡®å®å¤§å®¶ç¨çä¸å¤äºï¼æ²¡ç»è¿å¤§è§æ¨¡ååéåºæ¯çéªè¯ï¼ç¤¾åºä¹ä¸æ¯å¾æ´»è·ï¼æä»¥å¤§å®¶è¿æ¯ç®äºå§ï¼æä¸ªäººä¸æ¨èç¨è¿ä¸ªäºï¼\n * åæ¥å¤§å®¶å¼å§ç¨ RabbitMQï¼ä½æ¯ç¡®å® erlang è¯­è¨é»æ­¢äºå¤§éç Java å·¥ç¨å¸å»æ·±å¥ç ç©¶åææ§å®ï¼å¯¹å¬å¸èè¨ï¼å ä¹å¤äºä¸å¯æ§çç¶æï¼ä½æ¯ç¡®å®äººå®¶æ¯å¼æºçï¼æ¯è¾ç¨³å®çæ¯æï¼æ´»è·åº¦ä¹é«ï¼\n * ä¸è¿ç°å¨ç¡®å®è¶æ¥è¶å¤çå¬å¸ä¼å»ç¨ RocketMQï¼ç¡®å®å¾ä¸éï¼æ¯ç«æ¯é¿éåºåï¼ä½ç¤¾åºå¯è½æçªç¶é»æçé£é©ï¼ç®å RocketMQ å·²æç» Apacheï¼ä½ GitHub ä¸çæ´»è·åº¦å¶å®ä¸ç®é«ï¼å¯¹èªå·±å¬å¸ææ¯å®åæç»å¯¹èªä¿¡çï¼æ¨èç¨ RocketMQï¼å¦ååå»èèå®å®ç¨ RabbitMQ å§ï¼äººå®¶ææ´»è·çå¼æºç¤¾åºï¼ç»å¯¹ä¸ä¼é»ã\n * æä»¥ä¸­å°åå¬å¸ï¼ææ¯å®åè¾ä¸ºä¸è¬ï¼ææ¯ææä¸æ¯ç¹å«é«ï¼ç¨ RabbitMQ æ¯ä¸éçéæ©ï¼å¤§åå¬å¸ï¼åºç¡æ¶æç åå®åè¾å¼ºï¼ç¨ RocketMQ æ¯å¾å¥½çéæ©ã\n * å¦ææ¯å¤§æ°æ®é¢åçå®æ¶è®¡ç®ãæ¥å¿ééç­åºæ¯ï¼ç¨ Kafka æ¯ä¸åæ åçï¼ç»å¯¹æ²¡é®é¢ï¼ç¤¾åºæ´»è·åº¦å¾é«ï¼ç»å¯¹ä¸ä¼é»ï¼ä½åµå ä¹æ¯å¨ä¸çè¿ä¸ªé¢åçäºå®æ§è§èã\n\n\n# ð èµæ\n\n * Kafka\n   * Kafka Github\n   * Kafka å®ç½\n   * Kafka å®æ¹ææ¡£\n   * Kafka ä¸­æææ¡£\n * ActiveMQ\n   * ActiveMQ å®ç½\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java åæ¶æ¯éå\n\n> æ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åå¸å¼åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ åç§æ¶æ¯éåäº§åï¼å»ºè®®åäºè§£ä¸ä¸ æ¶æ¯éååºæ¬åç ï¼æå©äºçè§£æ¶æ¯éåç¹æ§çå®ç°åè®¾è®¡æè·¯ã\n\n\n# åå®¹\n\n * æ¶æ¯éåé¢è¯\n * æ¶æ¯éååºæ¬åç\n * kafka æç¨ ð\n * rocketmq\n * activemq\n\n\n# ææ¯å¯¹æ¯\n\nç¹æ§                activemq                     rabbitmq                        rocketmq                                      kafka\nåæºååé             ä¸çº§ï¼æ¯ rocketmqãkafka ä½ä¸ä¸ªæ°éçº§   å activemq                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡å®æ¶æ°æ®è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ rocketmq   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ rabbitmq çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å activemq                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å rocketmq\nåè½æ¯æ              mq é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   mq åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç mq åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸è¬çä¸å¡ç³»ç»è¦å¼å¥ mqï¼ææ©å¤§å®¶é½ç¨ activemqï¼ä½æ¯ç°å¨ç¡®å®å¤§å®¶ç¨çä¸å¤äºï¼æ²¡ç»è¿å¤§è§æ¨¡ååéåºæ¯çéªè¯ï¼ç¤¾åºä¹ä¸æ¯å¾æ´»è·ï¼æä»¥å¤§å®¶è¿æ¯ç®äºå§ï¼æä¸ªäººä¸æ¨èç¨è¿ä¸ªäºï¼\n * åæ¥å¤§å®¶å¼å§ç¨ rabbitmqï¼ä½æ¯ç¡®å® erlang è¯­è¨é»æ­¢äºå¤§éç java å·¥ç¨å¸å»æ·±å¥ç ç©¶åææ§å®ï¼å¯¹å¬å¸èè¨ï¼å ä¹å¤äºä¸å¯æ§çç¶æï¼ä½æ¯ç¡®å®äººå®¶æ¯å¼æºçï¼æ¯è¾ç¨³å®çæ¯æï¼æ´»è·åº¦ä¹é«ï¼\n * ä¸è¿ç°å¨ç¡®å®è¶æ¥è¶å¤çå¬å¸ä¼å»ç¨ rocketmqï¼ç¡®å®å¾ä¸éï¼æ¯ç«æ¯é¿éåºåï¼ä½ç¤¾åºå¯è½æçªç¶é»æçé£é©ï¼ç®å rocketmq å·²æç» apacheï¼ä½ github ä¸çæ´»è·åº¦å¶å®ä¸ç®é«ï¼å¯¹èªå·±å¬å¸ææ¯å®åæç»å¯¹èªä¿¡çï¼æ¨èç¨ rocketmqï¼å¦ååå»èèå®å®ç¨ rabbitmq å§ï¼äººå®¶ææ´»è·çå¼æºç¤¾åºï¼ç»å¯¹ä¸ä¼é»ã\n * æä»¥ä¸­å°åå¬å¸ï¼ææ¯å®åè¾ä¸ºä¸è¬ï¼ææ¯ææä¸æ¯ç¹å«é«ï¼ç¨ rabbitmq æ¯ä¸éçéæ©ï¼å¤§åå¬å¸ï¼åºç¡æ¶æç åå®åè¾å¼ºï¼ç¨ rocketmq æ¯å¾å¥½çéæ©ã\n * å¦ææ¯å¤§æ°æ®é¢åçå®æ¶è®¡ç®ãæ¥å¿ééç­åºæ¯ï¼ç¨ kafka æ¯ä¸åæ åçï¼ç»å¯¹æ²¡é®é¢ï¼ç¤¾åºæ´»è·åº¦å¾é«ï¼ç»å¯¹ä¸ä¼é»ï¼ä½åµå ä¹æ¯å¨ä¸çè¿ä¸ªé¢åçäºå®æ§è§èã\n\n\n# ð èµæ\n\n * kafka\n   * kafka github\n   * kafka å®ç½\n   * kafka å®æ¹ææ¡£\n   * kafka ä¸­æææ¡£\n * activemq\n   * activemq å®ç½\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"ç¼å­å¤ºå½è¿ç¯é®",frontmatter:{title:"ç¼å­å¤ºå½è¿ç¯é®",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["Java","ä¸­é´ä»¶","ç¼å­","é¢è¯"],abbrlink:"ba1174c4",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/eb30d6/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/01.%E7%BC%93%E5%AD%98%E9%9D%A2%E8%AF%95%E9%A2%98.html",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/01.ç¼å­é¢è¯é¢.md",key:"v-fa0cf7f8",path:"/pages/eb30d6/",headers:[{level:2,title:"ä¸ºä»ä¹è¦ç¨ç¼å­ï¼",slug:"ä¸ºä»ä¹è¦ç¨ç¼å­",normalizedTitle:"ä¸ºä»ä¹è¦ç¨ç¼å­ï¼",charIndex:14},{level:3,title:"é«æ§è½",slug:"é«æ§è½",normalizedTitle:"é«æ§è½",charIndex:36},{level:3,title:"é«å¹¶å",slug:"é«å¹¶å",normalizedTitle:"é«å¹¶å",charIndex:40},{level:2,title:"ç¨äºç¼å­ä¹åä¼æä»ä¹ä¸è¯åæï¼",slug:"ç¨äºç¼å­ä¹åä¼æä»ä¹ä¸è¯åæ",normalizedTitle:"ç¨äºç¼å­ä¹åä¼æä»ä¹ä¸è¯åæï¼",charIndex:621},{level:2,title:"redis å memcached æå¥åºå«ï¼",slug:"redis-å-memcached-æå¥åºå«",normalizedTitle:"redis å memcached æå¥åºå«ï¼",charIndex:705},{level:2,title:"ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«ï¼",slug:"ä¸ºå¥-redis-åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«",normalizedTitle:"ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«ï¼",charIndex:1091},{level:3,title:"redis ççº¿ç¨æ¨¡å",slug:"redis-ççº¿ç¨æ¨¡å",normalizedTitle:"redis ççº¿ç¨æ¨¡å",charIndex:1118},{level:3,title:"ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«?",slug:"ä¸ºå¥-redis-åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«-2",normalizedTitle:"ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«?",charIndex:2392},{level:2,title:"Redis æåªäºæ°æ®ç±»å",slug:"redis-æåªäºæ°æ®ç±»å",normalizedTitle:"redis æåªäºæ°æ®ç±»å",charIndex:2542},{level:3,title:"string",slug:"string",normalizedTitle:"string",charIndex:2580},{level:3,title:"hash",slug:"hash",normalizedTitle:"hash",charIndex:2590},{level:3,title:"list",slug:"list",normalizedTitle:"list",charIndex:2598},{level:3,title:"set",slug:"set",normalizedTitle:"set",charIndex:1914},{level:3,title:"sorted set",slug:"sorted-set",normalizedTitle:"sorted set",charIndex:2613},{level:2,title:"å¦ä½ä¿è¯ redis çé«å¹¶ååé«å¯ç¨ï¼redis çä¸»ä»å¤å¶åçè½ä»ç»ä¸ä¸ä¹ï¼redis çå¨åµåçè½ä»ç»ä¸ä¸ä¹ï¼",slug:"å¦ä½ä¿è¯-redis-çé«å¹¶ååé«å¯ç¨-redis-çä¸»ä»å¤å¶åçè½ä»ç»ä¸ä¸ä¹-redis-çå¨åµåçè½ä»ç»ä¸ä¸ä¹",normalizedTitle:"å¦ä½ä¿è¯ redis çé«å¹¶ååé«å¯ç¨ï¼redis çä¸»ä»å¤å¶åçè½ä»ç»ä¸ä¸ä¹ï¼redis çå¨åµåçè½ä»ç»ä¸ä¸ä¹ï¼",charIndex:4165},{level:2,title:"redis çè¿æç­ç¥é½æåªäºï¼åå­æ·æ±°æºå¶é½æåªäºï¼æåä¸ä¸ LRU ä»£ç å®ç°ï¼",slug:"redis-çè¿æç­ç¥é½æåªäº-åå­æ·æ±°æºå¶é½æåªäº-æåä¸ä¸-lru-ä»£ç å®ç°",normalizedTitle:"redis çè¿æç­ç¥é½æåªäºï¼åå­æ·æ±°æºå¶é½æåªäºï¼æåä¸ä¸ lru ä»£ç å®ç°ï¼",charIndex:4606},{level:3,title:"redis è¿æç­ç¥",slug:"redis-è¿æç­ç¥",normalizedTitle:"redis è¿æç­ç¥",charIndex:4652},{level:3,title:"åå­æ·æ±°æºå¶",slug:"åå­æ·æ±°æºå¶",normalizedTitle:"åå­æ·æ±°æºå¶",charIndex:4622},{level:3,title:"æåä¸ä¸ª LRU ç®æ³",slug:"æåä¸ä¸ª-lru-ç®æ³",normalizedTitle:"æåä¸ä¸ª lru ç®æ³",charIndex:5659},{level:2,title:"redis éç¾¤æ¨¡å¼çå·¥ä½åçè½è¯´ä¸ä¸ä¹ï¼å¨éç¾¤æ¨¡å¼ä¸ï¼redis ç key æ¯å¦ä½å¯»åçï¼åå¸å¼å¯»åé½æåªäºç®æ³ï¼äºè§£ä¸è´æ§ hash ç®æ³åï¼",slug:"redis-éç¾¤æ¨¡å¼çå·¥ä½åçè½è¯´ä¸ä¸ä¹-å¨éç¾¤æ¨¡å¼ä¸-redis-ç-key-æ¯å¦ä½å¯»åç-åå¸å¼å¯»åé½æåªäºç®æ³-äºè§£ä¸è´æ§-hash-ç®æ³å",normalizedTitle:"redis éç¾¤æ¨¡å¼çå·¥ä½åçè½è¯´ä¸ä¸ä¹ï¼å¨éç¾¤æ¨¡å¼ä¸ï¼redis ç key æ¯å¦ä½å¯»åçï¼åå¸å¼å¯»åé½æåªäºç®æ³ï¼äºè§£ä¸è´æ§ hash ç®æ³åï¼",charIndex:6318},{level:3,title:"é¢è¯é¢åæ",slug:"é¢è¯é¢åæ",normalizedTitle:"é¢è¯é¢åæ",charIndex:7200},{level:3,title:"redis cluster ä»ç»",slug:"redis-cluster-ä»ç»",normalizedTitle:"redis cluster ä»ç»",charIndex:7210},{level:3,title:"èç¹é´çåé¨éä¿¡æºå¶",slug:"èç¹é´çåé¨éä¿¡æºå¶",normalizedTitle:"èç¹é´çåé¨éä¿¡æºå¶",charIndex:7524},{level:4,title:"åºæ¬éä¿¡åç",slug:"åºæ¬éä¿¡åç",normalizedTitle:"åºæ¬éä¿¡åç",charIndex:7538},{level:4,title:"gossip åè®®",slug:"gossip-åè®®",normalizedTitle:"gossip åè®®",charIndex:7479},{level:4,title:"ping æ¶æ¯æ·±å¥",slug:"ping-æ¶æ¯æ·±å¥",normalizedTitle:"ping æ¶æ¯æ·±å¥",charIndex:8605},{level:3,title:"åå¸å¼å¯»åç®æ³",slug:"åå¸å¼å¯»åç®æ³",normalizedTitle:"åå¸å¼å¯»åç®æ³",charIndex:8963},{level:4,title:"hash ç®æ³",slug:"hash-ç®æ³",normalizedTitle:"hash ç®æ³",charIndex:6383},{level:4,title:"ä¸è´æ§ hash ç®æ³",slug:"ä¸è´æ§-hash-ç®æ³",normalizedTitle:"ä¸è´æ§ hash ç®æ³",charIndex:6379},{level:4,title:"redis cluster ç hash slot ç®æ³",slug:"redis-cluster-ç-hash-slot-ç®æ³",normalizedTitle:"redis cluster ç hash slot ç®æ³",charIndex:9031},{level:3,title:"redis cluster çé«å¯ç¨ä¸ä¸»å¤åæ¢åç",slug:"redis-cluster-çé«å¯ç¨ä¸ä¸»å¤åæ¢åç",normalizedTitle:"redis cluster çé«å¯ç¨ä¸ä¸»å¤åæ¢åç",charIndex:10090},{level:4,title:"å¤æ­èç¹å®æº",slug:"å¤æ­èç¹å®æº",normalizedTitle:"å¤æ­èç¹å®æº",charIndex:10153},{level:4,title:"ä»èç¹è¿æ»¤",slug:"ä»èç¹è¿æ»¤",normalizedTitle:"ä»èç¹è¿æ»¤",charIndex:10399},{level:4,title:"ä»èç¹éä¸¾",slug:"ä»èç¹éä¸¾",normalizedTitle:"ä»èç¹éä¸¾",charIndex:10583},{level:4,title:"ä¸å¨åµæ¯è¾",slug:"ä¸å¨åµæ¯è¾",normalizedTitle:"ä¸å¨åµæ¯è¾",charIndex:10809},{level:2,title:"å¦ä½ä¿è¯ç¼å­ä¸æ°æ®åºçååä¸è´æ§ï¼",slug:"å¦ä½ä¿è¯ç¼å­ä¸æ°æ®åºçååä¸è´æ§",normalizedTitle:"å¦ä½ä¿è¯ç¼å­ä¸æ°æ®åºçååä¸è´æ§ï¼",charIndex:10892},{level:3,title:"Cache Aside Pattern",slug:"cache-aside-pattern",normalizedTitle:"cache aside pattern",charIndex:11081},{level:3,title:"æåçº§çç¼å­ä¸ä¸è´é®é¢åè§£å³æ¹æ¡",slug:"æåçº§çç¼å­ä¸ä¸è´é®é¢åè§£å³æ¹æ¡",normalizedTitle:"æåçº§çç¼å­ä¸ä¸è´é®é¢åè§£å³æ¹æ¡",charIndex:11879},{level:3,title:"æ¯è¾å¤æçæ°æ®ä¸ä¸è´é®é¢åæ",slug:"æ¯è¾å¤æçæ°æ®ä¸ä¸è´é®é¢åæ",normalizedTitle:"æ¯è¾å¤æçæ°æ®ä¸ä¸è´é®é¢åæ",charIndex:12055},{level:2,title:"äºè§£ä»ä¹æ¯ redis çéªå´©ãç©¿éåå»ç©¿ï¼redis å´©æºä¹åä¼æä¹æ ·ï¼ç³»ç»è¯¥å¦ä½åºå¯¹è¿ç§æåµï¼å¦ä½å¤ç redis çç©¿éï¼",slug:"äºè§£ä»ä¹æ¯-redis-çéªå´©ãç©¿éåå»ç©¿-redis-å´©æºä¹åä¼æä¹æ ·-ç³»ç»è¯¥å¦ä½åºå¯¹è¿ç§æåµ-å¦ä½å¤ç-redis-çç©¿é",normalizedTitle:"äºè§£ä»ä¹æ¯ redis çéªå´©ãç©¿éåå»ç©¿ï¼redis å´©æºä¹åä¼æä¹æ ·ï¼ç³»ç»è¯¥å¦ä½åºå¯¹è¿ç§æåµï¼å¦ä½å¤ç redis çç©¿éï¼",charIndex:14399},{level:3,title:"ç¼å­éªå´©",slug:"ç¼å­éªå´©",normalizedTitle:"ç¼å­éªå´©",charIndex:671},{level:3,title:"ç¼å­ç©¿é",slug:"ç¼å­ç©¿é",normalizedTitle:"ç¼å­ç©¿é",charIndex:676},{level:3,title:"ç¼å­å»ç©¿",slug:"ç¼å­å»ç©¿",normalizedTitle:"ç¼å­å»ç©¿",charIndex:15542},{level:2,title:"redis çå¹¶åç«äºé®é¢æ¯ä»ä¹ï¼å¦ä½è§£å³è¿ä¸ªé®é¢ï¼äºè§£ redis äºå¡ç CAS æ¹æ¡åï¼",slug:"redis-çå¹¶åç«äºé®é¢æ¯ä»ä¹-å¦ä½è§£å³è¿ä¸ªé®é¢-äºè§£-redis-äºå¡ç-cas-æ¹æ¡å",normalizedTitle:"redis çå¹¶åç«äºé®é¢æ¯ä»ä¹ï¼å¦ä½è§£å³è¿ä¸ªé®é¢ï¼äºè§£ redis äºå¡ç cas æ¹æ¡åï¼",charIndex:15743},{level:2,title:"çäº§ç¯å¢ä¸­ç redis æ¯æä¹é¨ç½²çï¼",slug:"çäº§ç¯å¢ä¸­ç-redis-æ¯æä¹é¨ç½²ç",normalizedTitle:"çäº§ç¯å¢ä¸­ç redis æ¯æä¹é¨ç½²çï¼",charIndex:16070}],headersStr:"ä¸ºä»ä¹è¦ç¨ç¼å­ï¼ é«æ§è½ é«å¹¶å ç¨äºç¼å­ä¹åä¼æä»ä¹ä¸è¯åæï¼ redis å memcached æå¥åºå«ï¼ ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«ï¼ redis ççº¿ç¨æ¨¡å ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«? Redis æåªäºæ°æ®ç±»å string hash list set sorted set å¦ä½ä¿è¯ redis çé«å¹¶ååé«å¯ç¨ï¼redis çä¸»ä»å¤å¶åçè½ä»ç»ä¸ä¸ä¹ï¼redis çå¨åµåçè½ä»ç»ä¸ä¸ä¹ï¼ redis çè¿æç­ç¥é½æåªäºï¼åå­æ·æ±°æºå¶é½æåªäºï¼æåä¸ä¸ LRU ä»£ç å®ç°ï¼ redis è¿æç­ç¥ åå­æ·æ±°æºå¶ æåä¸ä¸ª LRU ç®æ³ redis éç¾¤æ¨¡å¼çå·¥ä½åçè½è¯´ä¸ä¸ä¹ï¼å¨éç¾¤æ¨¡å¼ä¸ï¼redis ç key æ¯å¦ä½å¯»åçï¼åå¸å¼å¯»åé½æåªäºç®æ³ï¼äºè§£ä¸è´æ§ hash ç®æ³åï¼ é¢è¯é¢åæ redis cluster ä»ç» èç¹é´çåé¨éä¿¡æºå¶ åºæ¬éä¿¡åç gossip åè®® ping æ¶æ¯æ·±å¥ åå¸å¼å¯»åç®æ³ hash ç®æ³ ä¸è´æ§ hash ç®æ³ redis cluster ç hash slot ç®æ³ redis cluster çé«å¯ç¨ä¸ä¸»å¤åæ¢åç å¤æ­èç¹å®æº ä»èç¹è¿æ»¤ ä»èç¹éä¸¾ ä¸å¨åµæ¯è¾ å¦ä½ä¿è¯ç¼å­ä¸æ°æ®åºçååä¸è´æ§ï¼ Cache Aside Pattern æåçº§çç¼å­ä¸ä¸è´é®é¢åè§£å³æ¹æ¡ æ¯è¾å¤æçæ°æ®ä¸ä¸è´é®é¢åæ äºè§£ä»ä¹æ¯ redis çéªå´©ãç©¿éåå»ç©¿ï¼redis å´©æºä¹åä¼æä¹æ ·ï¼ç³»ç»è¯¥å¦ä½åºå¯¹è¿ç§æåµï¼å¦ä½å¤ç redis çç©¿éï¼ ç¼å­éªå´© ç¼å­ç©¿é ç¼å­å»ç©¿ redis çå¹¶åç«äºé®é¢æ¯ä»ä¹ï¼å¦ä½è§£å³è¿ä¸ªé®é¢ï¼äºè§£ redis äºå¡ç CAS æ¹æ¡åï¼ çäº§ç¯å¢ä¸­ç redis æ¯æä¹é¨ç½²çï¼",content:'# ç¼å­å¤ºå½è¿ç¯é®\n\n\n# ä¸ºä»ä¹è¦ç¨ç¼å­ï¼\n\nç¨ç¼å­ï¼ä¸»è¦æä¸¤ä¸ªç¨éï¼é«æ§è½ãé«å¹¶åã\n\n\n# é«æ§è½\n\nåè®¾è¿ä¹ä¸ªåºæ¯ï¼ä½ æä¸ªæä½ï¼ä¸ä¸ªè¯·æ±è¿æ¥ï¼å­å§å­å§ä½ åç§ä¹±ä¸å«ç³æä½ mysqlï¼åå¤©æ¥åºæ¥ä¸ä¸ªç»æï¼èæ¶ 600msãä½æ¯è¿ä¸ªç»æå¯è½æ¥ä¸æ¥å ä¸ªå°æ¶é½ä¸ä¼åäºï¼æèåäºä¹å¯ä»¥ä¸ç¨ç«å³åé¦ç»ç¨æ·ãé£ä¹æ­¤æ¶ååï¼\n\nç¼å­åï¼æè¾ 600ms æ¥åºæ¥çç»æï¼æç¼å­éï¼ä¸ä¸ª key å¯¹åºä¸ä¸ª valueï¼ä¸æ¬¡åæäººæ¥ï¼å«èµ° mysql æè¾ 600ms äºï¼ç´æ¥ä»ç¼å­éï¼éè¿ä¸ä¸ª key æ¥åºæ¥ä¸ä¸ª valueï¼2ms æå®ãæ§è½æå 300 åã\n\nå°±æ¯è¯´å¯¹äºä¸äºéè¦å¤ææä½èæ¶æ¥åºæ¥çç»æï¼ä¸ç¡®å®åé¢ä¸æä¹ååï¼ä½æ¯æå¾å¤è¯»è¯·æ±ï¼é£ä¹ç´æ¥å°æ¥è¯¢åºæ¥çç»ææ¾å¨ç¼å­ä¸­ï¼åé¢ç´æ¥è¯»ç¼å­å°±å¥½ã\n\n\n# é«å¹¶å\n\nmysql è¿ä¹éçæ°æ®åºï¼åæ ¹å¿è®¾è®¡ä¸æ¯è®©ä½ ç©å¿é«å¹¶åçï¼è½ç¶ä¹å¯ä»¥ç©å¿ï¼ä½æ¯å¤©ç¶æ¯æä¸å¥½ãmysql åæºæ¯æå° 2000QPS ä¹å¼å§å®¹ææ¥è­¦äºã\n\næä»¥è¦æ¯ä½ æä¸ªç³»ç»ï¼é«å³°æä¸ç§éè¿æ¥çè¯·æ±æ 1 ä¸ï¼é£ä¸ä¸ª mysql åæºç»å¯¹ä¼æ­»æãä½ è¿ä¸ªæ¶åå°±åªè½ä¸ç¼å­ï¼æå¾å¤æ°æ®æ¾ç¼å­ï¼å«æ¾ mysqlãç¼å­åè½ç®åï¼è¯´ç½äºå°±æ¯ key-value å¼æä½ï¼åæºæ¯æçå¹¶åéè½»æ¾ä¸ç§å ä¸åå ä¸ï¼æ¯æé«å¹¶å so easyãåæºæ¿è½½å¹¶åéæ¯ mysql åæºçå ååã\n\n> ç¼å­æ¯èµ°åå­çï¼åå­å¤©ç¶å°±æ¯æé«å¹¶åã\n\n\n# ç¨äºç¼å­ä¹åä¼æä»ä¹ä¸è¯åæï¼\n\nå¸¸è§çç¼å­é®é¢æä»¥ä¸å ä¸ªï¼\n\n * ç¼å­ä¸æ°æ®åºååä¸ä¸è´\n * ç¼å­éªå´©ãç¼å­ç©¿é\n * ç¼å­å¹¶åç«äº\n\nåé¢åè¯¦ç»è¯´æã\n\n\n# redis å memcached æå¥åºå«ï¼\n\nredis æ¯æå¤æçæ°æ®ç»æ\n\nredis ç¸æ¯ memcached æ¥è¯´ï¼æ¥ææ´å¤çæ°æ®ç»æï¼è½æ¯ææ´ä¸°å¯çæ°æ®æä½ãå¦æéè¦ç¼å­è½å¤æ¯ææ´å¤æçç»æåæä½ï¼ redis ä¼æ¯ä¸éçéæ©ã\n\nredis åçæ¯æéç¾¤æ¨¡å¼\n\nå¨ redis3.x çæ¬ä¸­ï¼ä¾¿è½æ¯æ cluster æ¨¡å¼ï¼è memcached æ²¡æåççéç¾¤æ¨¡å¼ï¼éè¦ä¾é å®¢æ·ç«¯æ¥å®ç°å¾éç¾¤ä¸­åçåå¥æ°æ®ã\n\næ§è½å¯¹æ¯\n\nç±äº redis åªä½¿ç¨åæ ¸ï¼è memcached å¯ä»¥ä½¿ç¨å¤æ ¸ï¼æä»¥å¹³åæ¯ä¸ä¸ªæ ¸ä¸ redis å¨å­å¨å°æ°æ®æ¶æ¯ memcached æ§è½æ´é«ãèå¨ 100k ä»¥ä¸çæ°æ®ä¸­ï¼memcached æ§è½è¦é«äº redisãè½ç¶ redis æè¿ä¹å¨å­å¨å¤§æ°æ®çæ§è½ä¸è¿è¡ä¼åï¼ä½æ¯æ¯èµ· memcachedï¼è¿æ¯ç¨æéè²ã\n\n\n# ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«ï¼\n\n\n# redis ççº¿ç¨æ¨¡å\n\nredis åé¨ä½¿ç¨æä»¶äºä»¶å¤çå¨ file event handlerï¼è¿ä¸ªæä»¶äºä»¶å¤çå¨æ¯åçº¿ç¨çï¼æä»¥ redis æå«ååçº¿ç¨çæ¨¡åãå®éç¨ IO å¤è·¯å¤ç¨æºå¶åæ¶çå¬å¤ä¸ª socketï¼å°äº§çäºä»¶ç socket åå¥åå­éåä¸­ï¼äºä»¶åæ´¾å¨æ ¹æ® socket ä¸çäºä»¶ç±»åæ¥éæ©å¯¹åºçäºä»¶å¤çå¨è¿è¡å¤çã\n\næä»¶äºä»¶å¤çå¨çç»æåå« 4 ä¸ªé¨åï¼\n\n * å¤ä¸ª socket\n * IO å¤è·¯å¤ç¨ç¨åº\n * æä»¶äºä»¶åæ´¾å¨\n * äºä»¶å¤çå¨ï¼è¿æ¥åºç­å¤çå¨ãå½ä»¤è¯·æ±å¤çå¨ãå½ä»¤åå¤å¤çå¨ï¼\n\nå¤ä¸ª socket å¯è½ä¼å¹¶åäº§çä¸åçæä½ï¼æ¯ä¸ªæä½å¯¹åºä¸åçæä»¶äºä»¶ï¼ä½æ¯ IO å¤è·¯å¤ç¨ç¨åºä¼çå¬å¤ä¸ª socketï¼ä¼å°äº§çäºä»¶ç socket æ¾å¥éåä¸­æéï¼äºä»¶åæ´¾å¨æ¯æ¬¡ä»éåä¸­ååºä¸ä¸ª socketï¼æ ¹æ® socket çäºä»¶ç±»åäº¤ç»å¯¹åºçäºä»¶å¤çå¨è¿è¡å¤çã\n\næ¥çå®¢æ·ç«¯ä¸ redis çä¸æ¬¡éä¿¡è¿ç¨ï¼\n\n\n\nè¦æç½ï¼éä¿¡æ¯éè¿ socket æ¥å®æçï¼ä¸æçåå­¦å¯ä»¥åå»çä¸ç socket ç½ç»ç¼ç¨ã\n\né¦åï¼redis æå¡ç«¯è¿ç¨åå§åçæ¶åï¼ä¼å° server socket ç AE_READABLE äºä»¶ä¸è¿æ¥åºç­å¤çå¨å³èã\n\nå®¢æ·ç«¯ socket01 å redis è¿ç¨ç server socket è¯·æ±å»ºç«è¿æ¥ï¼æ­¤æ¶ server socket ä¼äº§çä¸ä¸ª AE_READABLE äºä»¶ï¼IO å¤è·¯å¤ç¨ç¨åºçå¬å° server socket äº§ççäºä»¶åï¼å°è¯¥ socket åå¥éåä¸­ãæä»¶äºä»¶åæ´¾å¨ä»éåä¸­è·å socketï¼äº¤ç»è¿æ¥åºç­å¤çå¨ãè¿æ¥åºç­å¤çå¨ä¼åå»ºä¸ä¸ªè½ä¸å®¢æ·ç«¯éä¿¡ç socket01ï¼å¹¶å°è¯¥ socket01 ç AE_READABLE äºä»¶ä¸å½ä»¤è¯·æ±å¤çå¨å³èã\n\nåè®¾æ­¤æ¶å®¢æ·ç«¯åéäºä¸ä¸ª set key value è¯·æ±ï¼æ­¤æ¶ redis ä¸­ç socket01 ä¼äº§ç AE_READABLE äºä»¶ï¼IO å¤è·¯å¤ç¨ç¨åºå° socket01 åå¥éåï¼æ­¤æ¶äºä»¶åæ´¾å¨ä»éåä¸­è·åå° socket01 äº§çç AE_READABLE äºä»¶ï¼ç±äºåé¢ socket01 ç AE_READABLE äºä»¶å·²ç»ä¸å½ä»¤è¯·æ±å¤çå¨å³èï¼å æ­¤äºä»¶åæ´¾å¨å°äºä»¶äº¤ç»å½ä»¤è¯·æ±å¤çå¨æ¥å¤çãå½ä»¤è¯·æ±å¤çå¨è¯»å socket01 ç key value å¹¶å¨èªå·±åå­ä¸­å®æ key value çè®¾ç½®ãæä½å®æåï¼å®ä¼å° socket01 ç AE_WRITABLE äºä»¶ä¸å½ä»¤åå¤å¤çå¨å³èã\n\nå¦ææ­¤æ¶å®¢æ·ç«¯åå¤å¥½æ¥æ¶è¿åç»æäºï¼é£ä¹ redis ä¸­ç socket01 ä¼äº§çä¸ä¸ª AE_WRITABLE äºä»¶ï¼åæ ·åå¥éåä¸­ï¼äºä»¶åæ´¾å¨æ¾å°ç¸å³èçå½ä»¤åå¤å¤çå¨ï¼ç±å½ä»¤åå¤å¤çå¨å¯¹ socket01 è¾å¥æ¬æ¬¡æä½çä¸ä¸ªç»æï¼æ¯å¦ okï¼ä¹åè§£é¤ socket01 ç AE_WRITABLE äºä»¶ä¸å½ä»¤åå¤å¤çå¨çå³èã\n\nè¿æ ·ä¾¿å®æäºä¸æ¬¡éä¿¡ã\n\n\n# ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«?\n\n * çº¯åå­æä½ã\n * æ ¸å¿æ¯åºäºéé»å¡ç IO å¤è·¯å¤ç¨æºå¶ã\n * C è¯­è¨å®ç°ï¼ä¸è¬æ¥è¯´ï¼C è¯­è¨å®ç°çç¨åºâè·ç¦»âæä½ç³»ç»æ´è¿ï¼æ§è¡éåº¦ç¸å¯¹ä¼æ´å¿«ã\n * åçº¿ç¨åèé¿åäºå¤çº¿ç¨çé¢ç¹ä¸ä¸æåæ¢é®é¢ï¼é¢é²äºå¤çº¿ç¨å¯è½äº§ççç«äºé®é¢ã\n\n\n# Redis æåªäºæ°æ®ç±»å\n\nredis ä¸»è¦æä»¥ä¸å ç§æ°æ®ç±»åï¼\n\n * string\n * hash\n * list\n * set\n * sorted set\n\n\n# string\n\nè¿æ¯æç®åçç±»åï¼å°±æ¯æ®éç set å getï¼åç®åç KV ç¼å­ã\n\nset college szu\n\n\n\n# hash\n\nè¿ä¸ªæ¯ç±»ä¼¼ map çä¸ç§ç»æï¼è¿ä¸ªä¸è¬å°±æ¯å¯ä»¥å°ç»æåçæ°æ®ï¼æ¯å¦ä¸ä¸ªå¯¹è±¡ï¼åææ¯è¿ä¸ªå¯¹è±¡æ²¡åµå¥å¶ä»çå¯¹è±¡ï¼ç»ç¼å­å¨ redis éï¼ç¶åæ¯æ¬¡è¯»åç¼å­çæ¶åï¼å¯ä»¥å°±æä½ hash éçæä¸ªå­æ®µã\n\nhset person name bingo\nhset person age 20\nhset person id 1\nhget person name\nperson = {\n    "name": "bingo",\n    "age": 20,\n    "id": 1\n}\n\n\n\n# list\n\nlist æ¯æåºåè¡¨ï¼è¿ä¸ªå¯ä»¥ç©å¿åºå¾å¤è±æ ·ã\n\næ¯å¦å¯ä»¥éè¿ list å­å¨ä¸äºåè¡¨åçæ°æ®ç»æï¼ç±»ä¼¼ç²ä¸åè¡¨ãæç« çè¯è®ºåè¡¨ä¹ç±»çä¸è¥¿ã\n\næ¯å¦å¯ä»¥éè¿ lrange å½ä»¤ï¼è¯»åæä¸ªé­åºé´åçåç´ ï¼å¯ä»¥åºäº list å®ç°åé¡µæ¥è¯¢ï¼è¿ä¸ªæ¯å¾æ£çä¸ä¸ªåè½ï¼åºäº redis å®ç°ç®åçé«æ§è½åé¡µï¼å¯ä»¥åç±»ä¼¼å¾®åé£ç§ä¸æä¸æ­åé¡µçä¸è¥¿ï¼æ§è½é«ï¼å°±ä¸é¡µä¸é¡µèµ°ã\n\n# 0å¼å§ä½ç½®ï¼-1ç»æä½ç½®ï¼ç»æä½ç½®ä¸º-1æ¶ï¼è¡¨ç¤ºåè¡¨çæåä¸ä¸ªä½ç½®ï¼å³æ¥çææã\nlrange mylist 0 -1\n\n\næ¯å¦å¯ä»¥æä¸ªç®åçæ¶æ¯éåï¼ä» list å¤´æ¼è¿å»ï¼ä» list å°¾å·´é£éå¼åºæ¥ã\n\nlpush mylist 1\nlpush mylist 2\nlpush mylist 3 4 5\n\n# 1\nrpop mylist\n\n\n\n# set\n\nset æ¯æ åºéåï¼èªå¨å»éã\n\nç´æ¥åºäº set å°ç³»ç»ééè¦å»éçæ°æ®æè¿å»ï¼èªå¨å°±ç»å»éäºï¼å¦æä½ éè¦å¯¹ä¸äºæ°æ®è¿è¡å¿«éçå¨å±å»éï¼ä½ å½ç¶ä¹å¯ä»¥åºäº jvm åå­éç HashSet è¿è¡å»éï¼ä½æ¯å¦æä½ çæä¸ªç³»ç»é¨ç½²å¨å¤å°æºå¨ä¸å¢ï¼å¾åºäº redis è¿è¡å¨å±ç set å»éã\n\nå¯ä»¥åºäº set ç©å¿äº¤éãå¹¶éãå·®éçæä½ï¼æ¯å¦äº¤éå§ï¼å¯ä»¥æä¸¤ä¸ªäººçç²ä¸åè¡¨æ´ä¸ä¸ªäº¤éï¼ççä¿©äººçå±åå¥½åæ¯è°ï¼å¯¹å§ã\n\næä¸¤ä¸ªå¤§ V çç²ä¸é½æ¾å¨ä¸¤ä¸ª set ä¸­ï¼å¯¹ä¸¤ä¸ª set åäº¤éã\n\n#-------æä½ä¸ä¸ªset-------\n# æ·»å åç´ \nsadd mySet 1\n\n# æ¥çå¨é¨åç´ \nsmembers mySet\n\n# å¤æ­æ¯å¦åå«æä¸ªå¼\nsismember mySet 3\n\n# å é¤æä¸ª/äºåç´ \nsrem mySet 1\nsrem mySet 2 4\n\n# æ¥çåç´ ä¸ªæ°\nscard mySet\n\n# éæºå é¤ä¸ä¸ªåç´ \nspop mySet\n\n#-------æä½å¤ä¸ªset-------\n# å°ä¸ä¸ªsetçåç´ ç§»å¨å°å¦å¤ä¸ä¸ªset\nsmove yourSet mySet 2\n\n# æ±ä¸¤setçäº¤é\nsinter yourSet mySet\n\n# æ±ä¸¤setçå¹¶é\nsunion yourSet mySet\n\n# æ±å¨yourSetä¸­èä¸å¨mySetä¸­çåç´ \nsdiff yourSet mySet\n\n\n\n# sorted set\n\nsorted set æ¯æåºç setï¼å»éä½å¯ä»¥æåºï¼åè¿å»çæ¶åç»ä¸ä¸ªåæ°ï¼èªå¨æ ¹æ®åæ°æåºã\n\nzadd board 85 zhangsan\nzadd board 72 lisi\nzadd board 96 wangwu\nzadd board 63 zhaoliu\n\n# è·åæååä¸çç¨æ·ï¼é»è®¤æ¯ååºï¼æä»¥éè¦ rev æ¹ä¸ºéåºï¼\nzrevrange board 0 3\n\n# è·åæç¨æ·çæå\nzrank board zhaoliu\n\n\n\n# å¦ä½ä¿è¯ redis çé«å¹¶ååé«å¯ç¨ï¼redis çä¸»ä»å¤å¶åçè½ä»ç»ä¸ä¸ä¹ï¼redis çå¨åµåçè½ä»ç»ä¸ä¸ä¹ï¼\n\nå¦æä½ ç¨ redis ç¼å­ææ¯çè¯ï¼è¯å®è¦èèå¦ä½ç¨ redis æ¥å å¤å°æºå¨ï¼ä¿è¯ redis æ¯é«å¹¶åçï¼è¿æå°±æ¯å¦ä½è®© redis ä¿è¯èªå·±ä¸æ¯ææä»¥åå°±ç´æ¥æ­»æäºï¼å³ redis é«å¯ç¨ã\n\nç±äºæ­¤èåå®¹è¾å¤ï¼å æ­¤ï¼ä¼åä¸ºä¸¤ä¸ªå°èè¿è¡è®²è§£ã\n\n * redis ä¸»ä»æ¶æ\n * redis åºäºå¨åµå®ç°é«å¯ç¨\n\nredis å®ç°é«å¹¶åä¸»è¦ä¾é ä¸»ä»æ¶æï¼ä¸ä¸»å¤ä»ï¼ä¸è¬æ¥è¯´ï¼å¾å¤é¡¹ç®å¶å®å°±è¶³å¤äºï¼åä¸»ç¨æ¥åå¥æ°æ®ï¼åæºå ä¸ QPSï¼å¤ä»ç¨æ¥æ¥è¯¢æ°æ®ï¼å¤ä¸ªä»å®ä¾å¯ä»¥æä¾æ¯ç§ 10w ç QPSã\n\nå¦ææ³è¦å¨å®ç°é«å¹¶åçåæ¶ï¼å®¹çº³å¤§éçæ°æ®ï¼é£ä¹å°±éè¦ redis éç¾¤ï¼ä½¿ç¨ redis éç¾¤ä¹åï¼å¯ä»¥æä¾æ¯ç§å åä¸çè¯»åå¹¶åã\n\nredis é«å¯ç¨ï¼å¦ææ¯åä¸»ä»æ¶æé¨ç½²ï¼é£ä¹å ä¸å¨åµå°±å¯ä»¥äºï¼å°±å¯ä»¥å®ç°ï¼ä»»ä½ä¸ä¸ªå®ä¾å®æºï¼å¯ä»¥è¿è¡ä¸»å¤åæ¢ã\n\n\n# redis çè¿æç­ç¥é½æåªäºï¼åå­æ·æ±°æºå¶é½æåªäºï¼æåä¸ä¸ LRU ä»£ç å®ç°ï¼\n\n\n# redis è¿æç­ç¥\n\nredis è¿æç­ç¥æ¯ï¼å®æå é¤+æ°æ§å é¤ã\n\næè°å®æå é¤ï¼æçæ¯ redis é»è®¤æ¯æ¯é 100ms å°±éæºæ½åä¸äºè®¾ç½®äºè¿ææ¶é´ç keyï¼æ£æ¥å¶æ¯å¦è¿æï¼å¦æè¿æå°±å é¤ã\n\nåè®¾ redis éæ¾äº 10w ä¸ª keyï¼é½è®¾ç½®äºè¿ææ¶é´ï¼ä½ æ¯éå ç¾æ¯«ç§ï¼å°±æ£æ¥ 10w ä¸ª keyï¼é£ redis åºæ¬ä¸å°±æ­»äºï¼cpu è´è½½ä¼å¾é«çï¼æ¶èå¨ä½ çæ£æ¥è¿æ key ä¸äºãæ³¨æï¼è¿éå¯ä¸æ¯æ¯é 100ms å°±éåææçè®¾ç½®è¿ææ¶é´ç keyï¼é£æ ·å°±æ¯ä¸åºæ§è½ä¸çç¾é¾ãå®éä¸ redis æ¯æ¯é 100ms éæºæ½åä¸äº key æ¥æ£æ¥åå é¤çã\n\nä½æ¯é®é¢æ¯ï¼å®æå é¤å¯è½ä¼å¯¼è´å¾å¤è¿æ key å°äºæ¶é´å¹¶æ²¡æè¢«å é¤æï¼é£åæ´å¢ï¼æä»¥å°±æ¯æ°æ§å é¤äºãè¿å°±æ¯è¯´ï¼å¨ä½ è·åæä¸ª key çæ¶åï¼redis ä¼æ£æ¥ä¸ä¸ ï¼è¿ä¸ª key å¦æè®¾ç½®äºè¿ææ¶é´é£ä¹æ¯å¦è¿æäºï¼å¦æè¿æäºæ­¤æ¶å°±ä¼å é¤ï¼ä¸ä¼ç»ä½ è¿åä»»ä½ä¸è¥¿ã\n\n> è·å key çæ¶åï¼å¦ææ­¤æ¶ key å·²ç»è¿æï¼å°±å é¤ï¼ä¸ä¼è¿åä»»ä½ä¸è¥¿ã\n\nä½æ¯å®éä¸è¿è¿æ¯æé®é¢çï¼å¦æå®æå é¤æ¼æäºå¾å¤è¿æ keyï¼ç¶åä½ ä¹æ²¡åæ¶å»æ¥ï¼ä¹å°±æ²¡èµ°æ°æ§å é¤ï¼æ­¤æ¶ä¼æä¹æ ·ï¼å¦æå¤§éè¿æ key å ç§¯å¨åå­éï¼å¯¼è´ redis åå­åèå°½äºï¼åæ´ï¼\n\nç­æ¡æ¯ï¼èµ°åå­æ·æ±°æºå¶ã\n\n\n# åå­æ·æ±°æºå¶\n\nredis åå­æ·æ±°æºå¶æä»¥ä¸å ä¸ªï¼\n\n * noeviction: å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼æ°åå¥æä½ä¼æ¥éï¼è¿ä¸ªä¸è¬æ²¡äººç¨å§ï¼å®å¨æ¯å¤ªæ¶å¿äºã\n * allkeys-lruï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼ç§»é¤æè¿æå°ä½¿ç¨ç keyï¼è¿ä¸ªæ¯æå¸¸ç¨çï¼ã\n * allkeys-randomï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyï¼è¿ä¸ªä¸è¬æ²¡äººç¨å§ï¼ä¸ºå¥è¦éæºï¼è¯å®æ¯ææè¿æå°ä½¿ç¨ç key ç»å¹²æåã\n * volatile-lruï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼ç§»é¤æè¿æå°ä½¿ç¨ç keyï¼è¿ä¸ªä¸è¬ä¸å¤ªåéï¼ã\n * volatile-randomï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyã\n * volatile-ttlï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼ææ´æ©è¿ææ¶é´ç key ä¼åç§»é¤ã\n\n\n# æåä¸ä¸ª LRU ç®æ³\n\nä½ å¯ä»¥ç°åºæåæåå§ç LRU ç®æ³ï¼é£ä¸ªä»£ç éå¤ªå¤§äºï¼ä¼¼ä¹ä¸å¤ªç°å®ã\n\nä¸æ±èªå·±çº¯æå·¥ä»åºå±å¼å§æé åºèªå·±ç LRUï¼ä½æ¯èµ·ç è¦ç¥éå¦ä½å©ç¨å·²æç JDK æ°æ®ç»æå®ç°ä¸ä¸ª Java çç LRUã\n\nclass LRUCache<K, V> extends LinkedHashMap<K, V> {\n    private final int CACHE_SIZE;\n\n    /**\n     * ä¼ éè¿æ¥æå¤è½ç¼å­å¤å°æ°æ®\n     *\n     * @param cacheSize ç¼å­å¤§å°\n     */\n    public LRUCache(int cacheSize) {\n        // true è¡¨ç¤ºè®© linkedHashMap æç§è®¿é®é¡ºåºæ¥è¿è¡æåºï¼æè¿è®¿é®çæ¾å¨å¤´é¨ï¼æèè®¿é®çæ¾å¨å°¾é¨ã\n        super((int) Math.ceil(cacheSize / 0.75) + 1, 0.75f, true);\n        CACHE_SIZE = cacheSize;\n    }\n\n    @Override\n    protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {\n        // å½ mapä¸­çæ°æ®éå¤§äºæå®çç¼å­ä¸ªæ°çæ¶åï¼å°±èªå¨å é¤æèçæ°æ®ã\n        return size() > CACHE_SIZE;\n    }\n}\n\n\n\n# redis éç¾¤æ¨¡å¼çå·¥ä½åçè½è¯´ä¸ä¸ä¹ï¼å¨éç¾¤æ¨¡å¼ä¸ï¼redis ç key æ¯å¦ä½å¯»åçï¼åå¸å¼å¯»åé½æåªäºç®æ³ï¼äºè§£ä¸è´æ§ hash ç®æ³åï¼\n\nå¨åå å¹´ï¼redis å¦æè¦æå ä¸ªèç¹ï¼æ¯ä¸ªèç¹å­å¨ä¸é¨åçæ°æ®ï¼å¾åå©ä¸äºä¸­é´ä»¶æ¥å®ç°ï¼æ¯å¦è¯´æ codisï¼æè twemproxyï¼é½æãæä¸äº redis ä¸­é´ä»¶ï¼ä½ è¯»å redis ä¸­é´ä»¶ï¼redis ä¸­é´ä»¶è´è´£å°ä½ çæ°æ®åå¸å¼å­å¨å¨å¤å°æºå¨ä¸ç redis å®ä¾ä¸­ã\n\nè¿ä¸¤å¹´ï¼redis ä¸æ­å¨åå±ï¼redis ä¹ä¸æ­ææ°ççæ¬ï¼ç°å¨ç redis éç¾¤æ¨¡å¼ï¼å¯ä»¥åå°å¨å¤å°æºå¨ä¸ï¼é¨ç½²å¤ä¸ª redis å®ä¾ï¼æ¯ä¸ªå®ä¾å­å¨ä¸é¨åçæ°æ®ï¼åæ¶æ¯ä¸ª redis ä¸»å®ä¾å¯ä»¥æ redis ä»å®ä¾ï¼èªå¨ç¡®ä¿è¯´ï¼å¦æ redis ä¸»å®ä¾æäºï¼ä¼èªå¨åæ¢å° redis ä»å®ä¾ä¸æ¥ã\n\nç°å¨ redis çæ°çæ¬ï¼å¤§å®¶é½æ¯ç¨ redis cluster çï¼ä¹å°±æ¯ redis åçæ¯æç redis éç¾¤æ¨¡å¼ï¼é£ä¹é¢è¯å®è¯å®ä¼å°± redis cluster å¯¹ä½ æ¥ä¸ªå è¿ç®ãè¦æ¯ä½ æ²¡ç¨è¿ redis clusterï¼æ­£å¸¸ï¼ä»¥åå¾å¤äººç¨ codis ä¹ç±»çå®¢æ·ç«¯æ¥æ¯æéç¾¤ï¼ä½æ¯èµ·ç ä½ å¾ç ç©¶ä¸ä¸ redis cluster å§ã\n\nå¦æä½ çæ°æ®éå¾å°ï¼ä¸»è¦æ¯æ¿è½½é«å¹¶åé«æ§è½çåºæ¯ï¼æ¯å¦ä½ çç¼å­ä¸è¬å°±å ä¸ª Gï¼åæºå°±è¶³å¤äºï¼å¯ä»¥ä½¿ç¨ replicationï¼ä¸ä¸ª master å¤ä¸ª slavesï¼è¦å ä¸ª slave è·ä½ è¦æ±çè¯»ååéæå³ï¼ç¶åèªå·±æ­å»ºä¸ä¸ª sentinel éç¾¤å»ä¿è¯ redis ä¸»ä»æ¶æçé«å¯ç¨æ§ã\n\nredis clusterï¼ä¸»è¦æ¯éå¯¹æµ·éæ°æ®+é«å¹¶å+é«å¯ç¨çåºæ¯ãredis cluster æ¯æ N ä¸ª redis master nodeï¼æ¯ä¸ª master node é½å¯ä»¥æè½½å¤ä¸ª slave nodeãè¿æ ·æ´ä¸ª redis å°±å¯ä»¥æ¨ªåæ©å®¹äºãå¦æä½ è¦æ¯ææ´å¤§æ°æ®éçç¼å­ï¼é£å°±æ¨ªåæ©å®¹æ´å¤ç master èç¹ï¼æ¯ä¸ª master èç¹å°±è½å­æ¾æ´å¤çæ°æ®äºã\n\n\n# é¢è¯é¢åæ\n\n\n# redis cluster ä»ç»\n\n * èªå¨å°æ°æ®è¿è¡åçï¼æ¯ä¸ª master ä¸æ¾ä¸é¨åæ°æ®\n * æä¾åç½®çé«å¯ç¨æ¯æï¼é¨å master ä¸å¯ç¨æ¶ï¼è¿æ¯å¯ä»¥ç»§ç»­å·¥ä½ç\n\nå¨ redis cluster æ¶æä¸ï¼æ¯ä¸ª redis è¦æ¾å¼ä¸¤ä¸ªç«¯å£å·ï¼æ¯å¦ä¸ä¸ªæ¯ 6379ï¼å¦å¤ä¸ä¸ªå°±æ¯ å  1w çç«¯å£å·ï¼æ¯å¦ 16379ã\n\n16379 ç«¯å£å·æ¯ç¨æ¥è¿è¡èç¹é´éä¿¡çï¼ä¹å°±æ¯ cluster bus çä¸è¥¿ï¼cluster bus çéä¿¡ï¼ç¨æ¥è¿è¡æéæ£æµãéç½®æ´æ°ãæéè½¬ç§»ææãcluster bus ç¨äºå¦å¤ä¸ç§äºè¿å¶çåè®®ï¼gossip åè®®ï¼ç¨äºèç¹é´è¿è¡é«æçæ°æ®äº¤æ¢ï¼å ç¨æ´å°çç½ç»å¸¦å®½åå¤çæ¶é´ã\n\n\n# èç¹é´çåé¨éä¿¡æºå¶\n\n# åºæ¬éä¿¡åç\n\néç¾¤åæ°æ®çç»´æ¤æä¸¤ç§æ¹å¼ï¼éä¸­å¼ãGossip åè®®ãredis cluster èç¹é´éç¨ gossip åè®®è¿è¡éä¿¡ã\n\néä¸­å¼æ¯å°éç¾¤åæ°æ®ï¼èç¹ä¿¡æ¯ãæéç­ç­ï¼å ç§å­å¨å¨æä¸ªèç¹ä¸ãéä¸­å¼åæ°æ®éä¸­å­å¨çä¸ä¸ªå¸åä»£è¡¨ï¼å°±æ¯å¤§æ°æ®é¢åç stormãå®æ¯åå¸å¼çå¤§æ°æ®å®æ¶è®¡ç®å¼æï¼æ¯éä¸­å¼çåæ°æ®å­å¨çç»æï¼åºå±åºäº zookeeperï¼åå¸å¼åè°çä¸­é´ä»¶ï¼å¯¹ææåæ°æ®è¿è¡å­å¨ç»´æ¤ã\n\n\n\nredis ç»´æ¤éç¾¤åæ°æ®éç¨å¦ä¸ä¸ªæ¹å¼ï¼ gossip åè®®ï¼ææèç¹é½ææä¸ä»½åæ°æ®ï¼ä¸åçèç¹å¦æåºç°äºåæ°æ®çåæ´ï¼å°±ä¸æ­å°åæ°æ®åéç»å¶å®çèç¹ï¼è®©å¶å®èç¹ä¹è¿è¡åæ°æ®çåæ´ã\n\n\n\néä¸­å¼çå¥½å¤å¨äºï¼åæ°æ®çè¯»ååæ´æ°ï¼æ¶ææ§éå¸¸å¥½ï¼ä¸æ¦åæ°æ®åºç°äºåæ´ï¼å°±ç«å³æ´æ°å°éä¸­å¼çå­å¨ä¸­ï¼å¶å®èç¹è¯»åçæ¶åå°±å¯ä»¥æç¥å°ï¼ä¸å¥½å¨äºï¼ææçåæ°æ®çæ´æ°ååå¨é¨éä¸­å¨ä¸ä¸ªå°æ¹ï¼å¯è½ä¼å¯¼è´åæ°æ®çå­å¨æååã\n\ngossip å¥½å¤å¨äºï¼åæ°æ®çæ´æ°æ¯è¾åæ£ï¼ä¸æ¯éä¸­å¨ä¸ä¸ªå°æ¹ï¼æ´æ°è¯·æ±ä¼ééç»­ç»­æå°ææèç¹ä¸å»æ´æ°ï¼éä½äºååï¼ä¸å¥½å¨äºï¼åæ°æ®çæ´æ°æå»¶æ¶ï¼å¯è½å¯¼è´éç¾¤ä¸­çä¸äºæä½ä¼æä¸äºæ»åã\n\n * 10000 ç«¯å£ï¼æ¯ä¸ªèç¹é½æä¸ä¸ªä¸é¨ç¨äºèç¹é´éä¿¡çç«¯å£ï¼å°±æ¯èªå·±æä¾æå¡çç«¯å£å·+10000ï¼æ¯å¦ 7001ï¼é£ä¹ç¨äºèç¹é´éä¿¡çå°±æ¯ 17001 ç«¯å£ãæ¯ä¸ªèç¹æ¯éä¸æ®µæ¶é´é½ä¼å¾å¦å¤å ä¸ªèç¹åé ping æ¶æ¯ï¼åæ¶å¶å®å ä¸ªèç¹æ¥æ¶å° ping ä¹åè¿å pongã\n * äº¤æ¢çä¿¡æ¯ï¼ä¿¡æ¯åæ¬æéä¿¡æ¯ï¼èç¹çå¢å åå é¤ï¼hash slot ä¿¡æ¯ç­ç­ã\n\n# gossip åè®®\n\ngossip åè®®åå«å¤ç§æ¶æ¯ï¼åå« ping,pong,meet,fail ç­ç­ã\n\n * meetï¼æä¸ªèç¹åé meet ç»æ°å å¥çèç¹ï¼è®©æ°èç¹å å¥éç¾¤ä¸­ï¼ç¶åæ°èç¹å°±ä¼å¼å§ä¸å¶å®èç¹è¿è¡éä¿¡ã\n\nredis-trib.rb add-node\n\n\nå¶å®åé¨å°±æ¯åéäºä¸ä¸ª gossip meet æ¶æ¯ç»æ°å å¥çèç¹ï¼éç¥é£ä¸ªèç¹å»å å¥æä»¬çéç¾¤ã\n\n * pingï¼æ¯ä¸ªèç¹é½ä¼é¢ç¹ç»å¶å®èç¹åé pingï¼å¶ä¸­åå«èªå·±çç¶æè¿æèªå·±ç»´æ¤çéç¾¤åæ°æ®ï¼äºç¸éè¿ ping äº¤æ¢åæ°æ®ã\n * pongï¼è¿å ping å meeetï¼åå«èªå·±çç¶æåå¶å®ä¿¡æ¯ï¼ä¹ç¨äºä¿¡æ¯å¹¿æ­åæ´æ°ã\n * failï¼æä¸ªèç¹å¤æ­å¦ä¸ä¸ªèç¹ fail ä¹åï¼å°±åé fail ç»å¶å®èç¹ï¼éç¥å¶å®èç¹è¯´ï¼æä¸ªèç¹å®æºå¦ã\n\n# ping æ¶æ¯æ·±å¥\n\nping æ¶è¦æºå¸¦ä¸äºåæ°æ®ï¼å¦æå¾é¢ç¹ï¼å¯è½ä¼å éç½ç»è´æã\n\næ¯ä¸ªèç¹æ¯ç§ä¼æ§è¡ 10 æ¬¡ pingï¼æ¯æ¬¡ä¼éæ© 5 ä¸ªæä¹æ²¡æéä¿¡çå¶å®èç¹ãå½ç¶å¦æåç°æä¸ªèç¹éä¿¡å»¶æ¶è¾¾å°äº cluster_node_timeout / 2ï¼é£ä¹ç«å³åé pingï¼é¿åæ°æ®äº¤æ¢å»¶æ¶è¿é¿ï¼è½åçæ¶é´å¤ªé¿äºãæ¯å¦è¯´ï¼ä¸¤ä¸ªèç¹ä¹é´é½ 10 åéæ²¡æäº¤æ¢æ°æ®äºï¼é£ä¹æ´ä¸ªéç¾¤å¤äºä¸¥éçåæ°æ®ä¸ä¸è´çæåµï¼å°±ä¼æé®é¢ãæä»¥ cluster_node_timeout å¯ä»¥è°èï¼å¦æè°å¾æ¯è¾å¤§ï¼é£ä¹ä¼éä½ ping çé¢çã\n\næ¯æ¬¡ pingï¼ä¼å¸¦ä¸èªå·±èç¹çä¿¡æ¯ï¼è¿æå°±æ¯å¸¦ä¸ 1/10 å¶å®èç¹çä¿¡æ¯ï¼åéåºå»ï¼è¿è¡äº¤æ¢ãè³å°åå« 3 ä¸ªå¶å®èç¹çä¿¡æ¯ï¼æå¤åå« æ»èç¹æ°å 2 ä¸ªå¶å®èç¹çä¿¡æ¯ã\n\n\n# åå¸å¼å¯»åç®æ³\n\n * hash ç®æ³ï¼å¤§éç¼å­éå»ºï¼\n * ä¸è´æ§ hash ç®æ³ï¼èªå¨ç¼å­è¿ç§»ï¼+ èæèç¹ï¼èªå¨è´è½½åè¡¡ï¼\n * redis cluster ç hash slot ç®æ³\n\n# hash ç®æ³\n\næ¥äºä¸ä¸ª keyï¼é¦åè®¡ç® hash å¼ï¼ç¶åå¯¹èç¹æ°åæ¨¡ãç¶åæå¨ä¸åç master èç¹ä¸ãä¸æ¦æä¸ä¸ª master èç¹å®æºï¼ææè¯·æ±è¿æ¥ï¼é½ä¼åºäºææ°çå©ä½ master èç¹æ°å»åæ¨¡ï¼å°è¯å»åæ°æ®ãè¿ä¼å¯¼è´å¤§é¨åçè¯·æ±è¿æ¥ï¼å¨é¨æ æ³æ¿å°ææçç¼å­ï¼å¯¼è´å¤§éçæµéæ¶å¥æ°æ®åºã\n\n\n\n# ä¸è´æ§ hash ç®æ³\n\nä¸è´æ§ hash ç®æ³å°æ´ä¸ª hash å¼ç©ºé´ç»ç»æä¸ä¸ªèæçåç¯ï¼æ´ä¸ªç©ºé´æé¡ºæ¶éæ¹åç»ç»ï¼ä¸ä¸æ­¥å°åä¸ª master èç¹ï¼ä½¿ç¨æå¡å¨ç ip æä¸»æºåï¼è¿è¡ hashãè¿æ ·å°±è½ç¡®å®æ¯ä¸ªèç¹å¨å¶åå¸ç¯ä¸çä½ç½®ã\n\næ¥äºä¸ä¸ª keyï¼é¦åè®¡ç® hash å¼ï¼å¹¶ç¡®å®æ­¤æ°æ®å¨ç¯ä¸çä½ç½®ï¼ä»æ­¤ä½ç½®æ²¿ç¯é¡ºæ¶éâè¡èµ°âï¼éå°çç¬¬ä¸ä¸ª master èç¹å°±æ¯ key æå¨ä½ç½®ã\n\nå¨ä¸è´æ§åå¸ç®æ³ä¸­ï¼å¦æä¸ä¸ªèç¹æäºï¼åå½±åçæ°æ®ä»ä»æ¯æ­¤èç¹å°ç¯ç©ºé´åä¸ä¸ªèç¹ï¼æ²¿çéæ¶éæ¹åè¡èµ°éå°çç¬¬ä¸ä¸ªèç¹ï¼ä¹é´çæ°æ®ï¼å¶å®ä¸åå½±åãå¢å ä¸ä¸ªèç¹ä¹åçã\n\nçé¹ï¼ä¸è´æ§åå¸ç®æ³å¨èç¹å¤ªå°æ¶ï¼å®¹æå ä¸ºèç¹åå¸ä¸ååèé æç¼å­ç­ç¹çé®é¢ãä¸ºäºè§£å³è¿ç§ç­ç¹é®é¢ï¼ä¸è´æ§ hash ç®æ³å¼å¥äºèæèç¹æºå¶ï¼å³å¯¹æ¯ä¸ä¸ªèç¹è®¡ç®å¤ä¸ª hashï¼æ¯ä¸ªè®¡ç®ç»æä½ç½®é½æ¾ç½®ä¸ä¸ªèæèç¹ãè¿æ ·å°±å®ç°äºæ°æ®çåååå¸ï¼è´è½½åè¡¡ã\n\n\n\n# redis cluster ç hash slot ç®æ³\n\nredis cluster æåºå®ç 16384 ä¸ª hash slotï¼å¯¹æ¯ä¸ª key è®¡ç® CRC16 å¼ï¼ç¶åå¯¹ 16384 åæ¨¡ï¼å¯ä»¥è·å key å¯¹åºç hash slotã\n\nredis cluster ä¸­æ¯ä¸ª master é½ä¼ææé¨å slotï¼æ¯å¦æ 3 ä¸ª masterï¼é£ä¹å¯è½æ¯ä¸ª master ææ 5000 å¤ä¸ª hash slotãhash slot è®© node çå¢å åç§»é¤å¾ç®åï¼å¢å ä¸ä¸ª masterï¼å°±å°å¶ä» master ç hash slot ç§»å¨é¨åè¿å»ï¼åå°ä¸ä¸ª masterï¼å°±å°å®ç hash slot ç§»å¨å°å¶ä» master ä¸å»ãç§»å¨ hash slot çææ¬æ¯éå¸¸ä½çãå®¢æ·ç«¯ç apiï¼å¯ä»¥å¯¹æå®çæ°æ®ï¼è®©ä»ä»¬èµ°åä¸ä¸ª hash slotï¼éè¿ hash tag æ¥å®ç°ã\n\nä»»ä½ä¸å°æºå¨å®æºï¼å¦å¤ä¸¤ä¸ªèç¹ï¼ä¸å½±åçãå ä¸º key æ¾çæ¯ hash slotï¼ä¸æ¯æºå¨ã\n\n\n\n\n# redis cluster çé«å¯ç¨ä¸ä¸»å¤åæ¢åç\n\nredis cluster çé«å¯ç¨çåçï¼å ä¹è·å¨åµæ¯ç±»ä¼¼çã\n\n# å¤æ­èç¹å®æº\n\nå¦æä¸ä¸ªèç¹è®¤ä¸ºå¦å¤ä¸ä¸ªèç¹å®æºï¼é£ä¹å°±æ¯ pfailï¼ä¸»è§å®æºãå¦æå¤ä¸ªèç¹é½è®¤ä¸ºå¦å¤ä¸ä¸ªèç¹å®æºäºï¼é£ä¹å°±æ¯ failï¼å®¢è§å®æºï¼è·å¨åµçåçå ä¹ä¸æ ·ï¼sdownï¼odownã\n\nå¨ cluster-node-timeout åï¼æä¸ªèç¹ä¸ç´æ²¡æè¿å pongï¼é£ä¹å°±è¢«è®¤ä¸º pfailã\n\nå¦æä¸ä¸ªèç¹è®¤ä¸ºæä¸ªèç¹ pfail äºï¼é£ä¹ä¼å¨ gossip ping æ¶æ¯ä¸­ï¼ping ç»å¶ä»èç¹ï¼å¦æè¶è¿åæ°çèç¹é½è®¤ä¸º pfail äºï¼é£ä¹å°±ä¼åæ failã\n\n# ä»èç¹è¿æ»¤\n\nå¯¹å®æºç master nodeï¼ä»å¶ææç slave node ä¸­ï¼éæ©ä¸ä¸ªåæ¢æ master nodeã\n\næ£æ¥æ¯ä¸ª slave node ä¸ master node æ­å¼è¿æ¥çæ¶é´ï¼å¦æè¶è¿äº cluster-node-timeout * cluster-slave-validity-factorï¼é£ä¹å°±æ²¡æèµæ ¼åæ¢æ masterã\n\n# ä»èç¹éä¸¾\n\næ¯ä¸ªä»èç¹ï¼é½æ ¹æ®èªå·±å¯¹ master å¤å¶æ°æ®ç offsetï¼æ¥è®¾ç½®ä¸ä¸ªéä¸¾æ¶é´ï¼offset è¶å¤§ï¼å¤å¶æ°æ®è¶å¤ï¼çä»èç¹ï¼éä¸¾æ¶é´è¶é åï¼ä¼åè¿è¡éä¸¾ã\n\nææç master node å¼å§ slave éä¸¾æç¥¨ï¼ç»è¦è¿è¡éä¸¾ç slave è¿è¡æç¥¨ï¼å¦æå¤§é¨å master nodeï¼N/2 + 1ï¼é½æç¥¨ç»äºæä¸ªä»èç¹ï¼é£ä¹éä¸¾éè¿ï¼é£ä¸ªä»èç¹å¯ä»¥åæ¢æ masterã\n\nä»èç¹æ§è¡ä¸»å¤åæ¢ï¼ä»èç¹åæ¢ä¸ºä¸»èç¹ã\n\n# ä¸å¨åµæ¯è¾\n\næ´ä¸ªæµç¨è·å¨åµç¸æ¯ï¼éå¸¸ç±»ä¼¼ï¼æä»¥è¯´ï¼redis cluster åè½å¼ºå¤§ï¼ç´æ¥éæäº replication å sentinel çåè½ã\n\n\n# å¦ä½ä¿è¯ç¼å­ä¸æ°æ®åºçååä¸è´æ§ï¼\n\nä¸è¬æ¥è¯´ï¼å¦æåè®¸ç¼å­å¯ä»¥ç¨å¾®çè·æ°æ®åºå¶å°æä¸ä¸è´çæåµï¼ä¹å°±æ¯è¯´å¦æä½ çç³»ç»ä¸æ¯ä¸¥æ ¼è¦æ± âç¼å­+æ°æ®åºâ å¿é¡»ä¿æä¸è´æ§çè¯ï¼æå¥½ä¸è¦åè¿ä¸ªæ¹æ¡ï¼å³ï¼è¯»è¯·æ±ååè¯·æ±ä¸²è¡åï¼ä¸²å°ä¸ä¸ªåå­éåéå»ã\n\nä¸²è¡åå¯ä»¥ä¿è¯ä¸å®ä¸ä¼åºç°ä¸ä¸è´çæåµï¼ä½æ¯å®ä¹ä¼å¯¼è´ç³»ç»çååéå¤§å¹åº¦éä½ï¼ç¨æ¯æ­£å¸¸æåµä¸å¤å åçæºå¨å»æ¯æçº¿ä¸çä¸ä¸ªè¯·æ±ã\n\n\n# Cache Aside Pattern\n\næç»å¸çç¼å­+æ°æ®åºè¯»åçæ¨¡å¼ï¼å°±æ¯ Cache Aside Patternã\n\n * è¯»çæ¶åï¼åè¯»ç¼å­ï¼ç¼å­æ²¡æçè¯ï¼å°±è¯»æ°æ®åºï¼ç¶åååºæ°æ®åæ¾å¥ç¼å­ï¼åæ¶è¿åååºã\n * æ´æ°çæ¶åï¼åæ´æ°æ°æ®åºï¼ç¶ååå é¤ç¼å­ã\n\nä¸ºä»ä¹æ¯å é¤ç¼å­ï¼èä¸æ¯æ´æ°ç¼å­ï¼\n\nåå å¾ç®åï¼å¾å¤æ¶åï¼å¨å¤æç¹çç¼å­åºæ¯ï¼ç¼å­ä¸ååæ¯æ°æ®åºä¸­ç´æ¥ååºæ¥çå¼ã\n\næ¯å¦å¯è½æ´æ°äºæä¸ªè¡¨çä¸ä¸ªå­æ®µï¼ç¶åå¶å¯¹åºçç¼å­ï¼æ¯éè¦æ¥è¯¢å¦å¤ä¸¤ä¸ªè¡¨çæ°æ®å¹¶è¿è¡è¿ç®ï¼æè½è®¡ç®åºç¼å­ææ°çå¼çã\n\nå¦å¤æ´æ°ç¼å­çä»£ä»·ææ¶åæ¯å¾é«çãæ¯ä¸æ¯è¯´ï¼æ¯æ¬¡ä¿®æ¹æ°æ®åºçæ¶åï¼é½ä¸å®è¦å°å¶å¯¹åºçç¼å­æ´æ°ä¸ä»½ï¼ä¹è®¸æçåºæ¯æ¯è¿æ ·ï¼ä½æ¯å¯¹äºæ¯è¾å¤æçç¼å­æ°æ®è®¡ç®çåºæ¯ï¼å°±ä¸æ¯è¿æ ·äºãå¦æä½ é¢ç¹ä¿®æ¹ä¸ä¸ªç¼å­æ¶åçå¤ä¸ªè¡¨ï¼ç¼å­ä¹é¢ç¹æ´æ°ãä½æ¯é®é¢å¨äºï¼è¿ä¸ªç¼å­å°åºä¼ä¸ä¼è¢«é¢ç¹è®¿é®å°ï¼\n\nä¸¾ä¸ªæ å­ï¼ä¸ä¸ªç¼å­æ¶åçè¡¨çå­æ®µï¼å¨ 1 åéåå°±ä¿®æ¹äº 20 æ¬¡ï¼æèæ¯ 100 æ¬¡ï¼é£ä¹ç¼å­æ´æ° 20 æ¬¡ã100 æ¬¡ï¼ä½æ¯è¿ä¸ªç¼å­å¨ 1 åéååªè¢«è¯»åäº 1 æ¬¡ï¼æå¤§éçå·æ°æ®ãå®éä¸ï¼å¦æä½ åªæ¯å é¤ç¼å­çè¯ï¼é£ä¹å¨ 1 åéåï¼è¿ä¸ªç¼å­ä¸è¿å°±éæ°è®¡ç®ä¸æ¬¡èå·²ï¼å¼éå¤§å¹åº¦éä½ãç¨å°ç¼å­æå»ç®ç¼å­ã\n\nå¶å®å é¤ç¼å­ï¼èä¸æ¯æ´æ°ç¼å­ï¼å°±æ¯ä¸ä¸ª lazy è®¡ç®çææ³ï¼ä¸è¦æ¯æ¬¡é½éæ°åå¤æçè®¡ç®ï¼ä¸ç®¡å®ä¼ä¸ä¼ç¨å°ï¼èæ¯è®©å®å°éè¦è¢«ä½¿ç¨çæ¶ååéæ°è®¡ç®ãå mybatisï¼hibernateï¼é½ææå è½½ææ³ãæ¥è¯¢ä¸ä¸ªé¨é¨ï¼é¨é¨å¸¦äºä¸ä¸ªåå·¥ç listï¼æ²¡æå¿è¦è¯´æ¯æ¬¡æ¥è¯¢é¨é¨ï¼é½éé¢ç 1000 ä¸ªåå·¥çæ°æ®ä¹åæ¶æ¥åºæ¥åã80% çæåµï¼æ¥è¿ä¸ªé¨é¨ï¼å°±åªæ¯è¦è®¿é®è¿ä¸ªé¨é¨çä¿¡æ¯å°±å¯ä»¥äºãåæ¥é¨é¨ï¼åæ¶è¦è®¿é®éé¢çåå·¥ï¼é£ä¹è¿ä¸ªæ¶ååªæå¨ä½ è¦è®¿é®éé¢çåå·¥çæ¶åï¼æä¼å»æ°æ®åºéé¢æ¥è¯¢ 1000 ä¸ªåå·¥ã\n\n\n# æåçº§çç¼å­ä¸ä¸è´é®é¢åè§£å³æ¹æ¡\n\né®é¢ï¼åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ãå¦æå é¤ç¼å­å¤±è´¥äºï¼é£ä¹ä¼å¯¼è´æ°æ®åºä¸­æ¯æ°æ°æ®ï¼ç¼å­ä¸­æ¯æ§æ°æ®ï¼æ°æ®å°±åºç°äºä¸ä¸è´ã\n\n\n\nè§£å³æè·¯ï¼åå é¤ç¼å­ï¼åæ´æ°æ°æ®åºãå¦ææ°æ®åºæ´æ°å¤±è´¥äºï¼é£ä¹æ°æ®åºä¸­æ¯æ§æ°æ®ï¼ç¼å­ä¸­æ¯ç©ºçï¼é£ä¹æ°æ®ä¸ä¼ä¸ä¸è´ãå ä¸ºè¯»çæ¶åç¼å­æ²¡æï¼æä»¥å»è¯»äºæ°æ®åºä¸­çæ§æ°æ®ï¼ç¶åæ´æ°å°ç¼å­ä¸­ã\n\n\n# æ¯è¾å¤æçæ°æ®ä¸ä¸è´é®é¢åæ\n\næ°æ®åçäºåæ´ï¼åå é¤äºç¼å­ï¼ç¶åè¦å»ä¿®æ¹æ°æ®åºï¼æ­¤æ¶è¿æ²¡ä¿®æ¹ãä¸ä¸ªè¯·æ±è¿æ¥ï¼å»è¯»ç¼å­ï¼åç°ç¼å­ç©ºäºï¼å»æ¥è¯¢æ°æ®åºï¼æ¥å°äºä¿®æ¹åçæ§æ°æ®ï¼æ¾å°äºç¼å­ä¸­ãéåæ°æ®åæ´çç¨åºå®æäºæ°æ®åºçä¿®æ¹ãå®äºï¼æ°æ®åºåç¼å­ä¸­çæ°æ®ä¸ä¸æ ·äº...\n\nä¸ºä»ä¹ä¸äº¿æµéé«å¹¶ååºæ¯ä¸ï¼ç¼å­ä¼åºç°è¿ä¸ªé®é¢ï¼\n\nåªæå¨å¯¹ä¸ä¸ªæ°æ®å¨å¹¶åçè¿è¡è¯»åçæ¶åï¼æå¯è½ä¼åºç°è¿ç§é®é¢ãå¶å®å¦æè¯´ä½ çå¹¶åéå¾ä½çè¯ï¼ç¹å«æ¯è¯»å¹¶åå¾ä½ï¼æ¯å¤©è®¿é®éå°± 1 ä¸æ¬¡ï¼é£ä¹å¾å°çæåµä¸ï¼ä¼åºç°åææè¿°çé£ç§ä¸ä¸è´çåºæ¯ãä½æ¯é®é¢æ¯ï¼å¦ææ¯å¤©çæ¯ä¸äº¿çæµéï¼æ¯ç§å¹¶åè¯»æ¯å ä¸ï¼æ¯ç§åªè¦ææ°æ®æ´æ°çè¯·æ±ï¼å°±å¯è½ä¼åºç°ä¸è¿°çæ°æ®åº+ç¼å­ä¸ä¸è´çæåµã\n\nè§£å³æ¹æ¡å¦ä¸ï¼\n\næ´æ°æ°æ®çæ¶åï¼æ ¹æ®æ°æ®çå¯ä¸æ è¯ï¼å°æä½è·¯ç±ä¹åï¼åéå°ä¸ä¸ª jvm åé¨éåä¸­ãè¯»åæ°æ®çæ¶åï¼å¦æåç°æ°æ®ä¸å¨ç¼å­ä¸­ï¼é£ä¹å°éæ°è¯»åæ°æ®+æ´æ°ç¼å­çæä½ï¼æ ¹æ®å¯ä¸æ è¯è·¯ç±ä¹åï¼ä¹åéåä¸ä¸ª jvm åé¨éåä¸­ã\n\nä¸ä¸ªéåå¯¹åºä¸ä¸ªå·¥ä½çº¿ç¨ï¼æ¯ä¸ªå·¥ä½çº¿ç¨ä¸²è¡æ¿å°å¯¹åºçæä½ï¼ç¶åä¸æ¡ä¸æ¡çæ§è¡ãè¿æ ·çè¯ï¼ä¸ä¸ªæ°æ®åæ´çæä½ï¼åå é¤ç¼å­ï¼ç¶ååå»æ´æ°æ°æ®åºï¼ä½æ¯è¿æ²¡å®ææ´æ°ãæ­¤æ¶å¦æä¸ä¸ªè¯»è¯·æ±è¿æ¥ï¼æ²¡æè¯»å°ç¼å­ï¼é£ä¹å¯ä»¥åå°ç¼å­æ´æ°çè¯·æ±åéå°éåä¸­ï¼æ­¤æ¶ä¼å¨éåä¸­ç§¯åï¼ç¶ååæ­¥ç­å¾ç¼å­æ´æ°å®æã\n\nè¿éæä¸ä¸ªä¼åç¹ï¼ä¸ä¸ªéåä¸­ï¼å¶å®å¤ä¸ªæ´æ°ç¼å­è¯·æ±ä¸²å¨ä¸èµ·æ¯æ²¡æä¹çï¼å æ­¤å¯ä»¥åè¿æ»¤ï¼å¦æåç°éåä¸­å·²ç»æä¸ä¸ªæ´æ°ç¼å­çè¯·æ±äºï¼é£ä¹å°±ä¸ç¨åæ¾ä¸ªæ´æ°è¯·æ±æä½è¿å»äºï¼ç´æ¥ç­å¾åé¢çæ´æ°æä½è¯·æ±å®æå³å¯ã\n\nå¾é£ä¸ªéåå¯¹åºçå·¥ä½çº¿ç¨å®æäºä¸ä¸ä¸ªæä½çæ°æ®åºçä¿®æ¹ä¹åï¼æä¼å»æ§è¡ä¸ä¸ä¸ªæä½ï¼ä¹å°±æ¯ç¼å­æ´æ°çæä½ï¼æ­¤æ¶ä¼ä»æ°æ®åºä¸­è¯»åææ°çå¼ï¼ç¶ååå¥ç¼å­ä¸­ã\n\nå¦æè¯·æ±è¿å¨ç­å¾æ¶é´èå´åï¼ä¸æ­è½®è¯¢åç°å¯ä»¥åå°å¼äºï¼é£ä¹å°±ç´æ¥è¿åï¼å¦æè¯·æ±ç­å¾çæ¶é´è¶è¿ä¸å®æ¶é¿ï¼é£ä¹è¿ä¸æ¬¡ç´æ¥ä»æ°æ®åºä¸­è¯»åå½åçæ§å¼ã\n\né«å¹¶åçåºæ¯ä¸ï¼è¯¥è§£å³æ¹æ¡è¦æ³¨æçé®é¢ï¼\n\n * è¯»è¯·æ±é¿æ¶é»å¡\n\nç±äºè¯»è¯·æ±è¿è¡äºéå¸¸è½»åº¦çå¼æ­¥åï¼æä»¥ä¸å®è¦æ³¨æè¯»è¶æ¶çé®é¢ï¼æ¯ä¸ªè¯»è¯·æ±å¿é¡»å¨è¶æ¶æ¶é´èå´åè¿åã\n\nè¯¥è§£å³æ¹æ¡ï¼æå¤§çé£é©ç¹å¨äºè¯´ï¼å¯è½æ°æ®æ´æ°å¾é¢ç¹ï¼å¯¼è´éåä¸­ç§¯åäºå¤§éæ´æ°æä½å¨éé¢ï¼ç¶åè¯»è¯·æ±ä¼åçå¤§éçè¶æ¶ï¼æåå¯¼è´å¤§éçè¯·æ±ç´æ¥èµ°æ°æ®åºãå¡å¿éè¿ä¸äºæ¨¡æçå®çæµè¯ï¼ççæ´æ°æ°æ®çé¢çæ¯ææ ·çã\n\nå¦å¤ä¸ç¹ï¼å ä¸ºä¸ä¸ªéåä¸­ï¼å¯è½ä¼ç§¯åéå¯¹å¤ä¸ªæ°æ®é¡¹çæ´æ°æä½ï¼å æ­¤éè¦æ ¹æ®èªå·±çä¸å¡æåµè¿è¡æµè¯ï¼å¯è½éè¦é¨ç½²å¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡åæä¸äºæ°æ®çæ´æ°æä½ãå¦æä¸ä¸ªåå­éåéå±ç¶ä¼æ¤å 100 ä¸ªååçåºå­ä¿®æ¹æä½ï¼æ¯éåºå­ä¿®æ¹æä½è¦èè´¹ 10ms å»å®æï¼é£ä¹æåä¸ä¸ªååçè¯»è¯·æ±ï¼å¯è½ç­å¾ 10 * 100 = 1000ms = 1s åï¼æè½å¾å°æ°æ®ï¼è¿ä¸ªæ¶åå°±å¯¼è´è¯»è¯·æ±çé¿æ¶é»å¡ã\n\nä¸å®è¦åæ ¹æ®å®éä¸å¡ç³»ç»çè¿è¡æåµï¼å»è¿è¡ä¸äºååæµè¯ï¼åæ¨¡æçº¿ä¸ç¯å¢ï¼å»ççæç¹å¿çæ¶åï¼åå­éåå¯è½ä¼æ¤åå¤å°æ´æ°æä½ï¼å¯è½ä¼å¯¼è´æåä¸ä¸ªæ´æ°æä½å¯¹åºçè¯»è¯·æ±ï¼ä¼ hang å¤å°æ¶é´ï¼å¦æè¯»è¯·æ±å¨ 200ms è¿åï¼å¦æä½ è®¡ç®è¿åï¼åªææ¯æç¹å¿çæ¶åï¼ç§¯å 10 ä¸ªæ´æ°æä½ï¼æå¤ç­å¾ 200msï¼é£è¿å¯ä»¥çã\n\nå¦æä¸ä¸ªåå­éåä¸­å¯è½ç§¯åçæ´æ°æä½ç¹å«å¤ï¼é£ä¹ä½ å°±è¦å æºå¨ï¼è®©æ¯ä¸ªæºå¨ä¸é¨ç½²çæå¡å®ä¾å¤çæ´å°çæ°æ®ï¼é£ä¹æ¯ä¸ªåå­éåä¸­ç§¯åçæ´æ°æä½å°±ä¼è¶å°ã\n\nå¶å®æ ¹æ®ä¹åçé¡¹ç®ç»éªï¼ä¸è¬æ¥è¯´ï¼æ°æ®çåé¢çæ¯å¾ä½çï¼å æ­¤å®éä¸æ­£å¸¸æ¥è¯´ï¼å¨éåä¸­ç§¯åçæ´æ°æä½åºè¯¥æ¯å¾å°çãåè¿ç§éå¯¹è¯»é«å¹¶åãè¯»ç¼å­æ¶æçé¡¹ç®ï¼ä¸è¬æ¥è¯´åè¯·æ±æ¯éå¸¸å°çï¼æ¯ç§ç QPS è½å°å ç¾å°±ä¸éäºã\n\næä»¬æ¥å®éç²ç¥æµç®ä¸ä¸ã\n\nå¦æä¸ç§æ 500 çåæä½ï¼å¦æåæ 5 ä¸ªæ¶é´çï¼æ¯ 200ms å°± 100 ä¸ªåæä½ï¼æ¾å° 20 ä¸ªåå­éåä¸­ï¼æ¯ä¸ªåå­éåï¼å¯è½å°±ç§¯å 5 ä¸ªåæä½ãæ¯ä¸ªåæä½æ§è½æµè¯åï¼ä¸è¬æ¯å¨ 20ms å·¦å³å°±å®æï¼é£ä¹éå¯¹æ¯ä¸ªåå­éåçæ°æ®çè¯»è¯·æ±ï¼ä¹å°±æå¤ hang ä¸ä¼å¿ï¼200ms ä»¥åè¯å®è½è¿åäºã\n\nç»è¿åæç®åçæµç®ï¼æä»¬ç¥éï¼åæºæ¯æçå QPS å¨å ç¾æ¯æ²¡é®é¢çï¼å¦æå QPS æ©å¤§äº 10 åï¼é£ä¹å°±æ©å®¹æºå¨ï¼æ©å®¹ 10 åçæºå¨ï¼æ¯ä¸ªæºå¨ 20 ä¸ªéåã\n\n * è¯»è¯·æ±å¹¶åéè¿é«\n\nè¿éè¿å¿é¡»åå¥½ååæµè¯ï¼ç¡®ä¿æ°å·§ç¢°ä¸ä¸è¿°æåµçæ¶åï¼è¿æä¸ä¸ªé£é©ï¼å°±æ¯çªç¶é´å¤§éè¯»è¯·æ±ä¼å¨å åæ¯«ç§çå»¶æ¶ hang å¨æå¡ä¸ï¼çæå¡è½ä¸è½æçä½ï¼éè¦å¤å°æºå¨æè½æä½æå¤§çæéæåµçå³°å¼ã\n\nä½æ¯å ä¸ºå¹¶ä¸æ¯ææçæ°æ®é½å¨åä¸æ¶é´æ´æ°ï¼ç¼å­ä¹ä¸ä¼åä¸æ¶é´å¤±æï¼æä»¥æ¯æ¬¡å¯è½ä¹å°±æ¯å°æ°æ°æ®çç¼å­å¤±æäºï¼ç¶åé£äºæ°æ®å¯¹åºçè¯»è¯·æ±è¿æ¥ï¼å¹¶åéåºè¯¥ä¹ä¸ä¼ç¹å«å¤§ã\n\n * å¤æå¡å®ä¾é¨ç½²çè¯·æ±è·¯ç±\n\nå¯è½è¿ä¸ªæå¡é¨ç½²äºå¤ä¸ªå®ä¾ï¼é£ä¹å¿é¡»ä¿è¯è¯´ï¼æ§è¡æ°æ®æ´æ°æä½ï¼ä»¥åæ§è¡ç¼å­æ´æ°æä½çè¯·æ±ï¼é½éè¿ Nginx æå¡å¨è·¯ç±å°ç¸åçæå¡å®ä¾ä¸ã\n\næ¯å¦è¯´ï¼å¯¹åä¸ä¸ªååçè¯»åè¯·æ±ï¼å¨é¨è·¯ç±å°åä¸å°æºå¨ä¸ãå¯ä»¥èªå·±å»åæå¡é´çæç§æä¸ªè¯·æ±åæ°ç hash è·¯ç±ï¼ä¹å¯ä»¥ç¨ Nginx ç hash è·¯ç±åè½ç­ç­ã\n\n * ç­ç¹ååçè·¯ç±é®é¢ï¼å¯¼è´è¯·æ±çå¾æ\n\nä¸ä¸æä¸ªååçè¯»åè¯·æ±ç¹å«é«ï¼å¨é¨æå°ç¸åçæºå¨çç¸åçéåéé¢å»äºï¼å¯è½ä¼é ææå°æºå¨çååè¿å¤§ãå°±æ¯è¯´ï¼å ä¸ºåªæå¨ååæ°æ®æ´æ°çæ¶åæä¼æ¸ç©ºç¼å­ï¼ç¶åæä¼å¯¼è´è¯»åå¹¶åï¼æä»¥å¶å®è¦æ ¹æ®ä¸å¡ç³»ç»å»çï¼å¦ææ´æ°é¢çä¸æ¯å¤ªé«çè¯ï¼è¿ä¸ªé®é¢çå½±åå¹¶ä¸æ¯ç¹å«å¤§ï¼ä½æ¯çç¡®å¯è½æäºæºå¨çè´è½½ä¼é«ä¸äºã\n\n\n# äºè§£ä»ä¹æ¯ redis çéªå´©ãç©¿éåå»ç©¿ï¼redis å´©æºä¹åä¼æä¹æ ·ï¼ç³»ç»è¯¥å¦ä½åºå¯¹è¿ç§æåµï¼å¦ä½å¤ç redis çç©¿éï¼\n\n\n# ç¼å­éªå´©\n\nå¯¹äºç³»ç» Aï¼åè®¾æ¯å¤©é«å³°ææ¯ç§ 5000 ä¸ªè¯·æ±ï¼æ¬æ¥ç¼å­å¨é«å³°æå¯ä»¥æä½æ¯ç§ 4000 ä¸ªè¯·æ±ï¼ä½æ¯ç¼å­æºå¨æå¤åçäºå¨çå®æºãç¼å­æäºï¼æ­¤æ¶ 1 ç§ 5000 ä¸ªè¯·æ±å¨é¨è½æ°æ®åºï¼æ°æ®åºå¿ç¶æä¸ä½ï¼å®ä¼æ¥ä¸ä¸è­¦ï¼ç¶åå°±æäºãæ­¤æ¶ï¼å¦ææ²¡æéç¨ä»ä¹ç¹å«çæ¹æ¡æ¥å¤çè¿ä¸ªæéï¼DBA å¾çæ¥ï¼éå¯æ°æ®åºï¼ä½æ¯æ°æ®åºç«é©¬åè¢«æ°çæµéç»ææ­»äºã\n\nè¿å°±æ¯ç¼å­éªå´©ã\n\n\n\nå¤§çº¦å¨ 3 å¹´åï¼å½åæ¯è¾ç¥åçä¸ä¸ªäºèç½å¬å¸ï¼æ¾å ä¸ºç¼å­äºæï¼å¯¼è´éªå´©ï¼åå°ç³»ç»å¨é¨å´©æºï¼äºæä»å½å¤©ä¸åæç»­å°æä¸åæ¨ 3~4 ç¹ï¼å¬å¸æå¤±äºå åä¸ã\n\nç¼å­éªå´©çäºåäºä¸­äºåçè§£å³æ¹æ¡å¦ä¸ã\n\n * äºåï¼redis é«å¯ç¨ï¼ä¸»ä»+å¨åµï¼redis clusterï¼é¿åå¨çå´©æºã\n * äºä¸­ï¼æ¬å° ehcache ç¼å­ + hystrix éæµ&éçº§ï¼é¿å MySQL è¢«ææ­»ã\n * äºåï¼redis æä¹åï¼ä¸æ¦éå¯ï¼èªå¨ä»ç£çä¸å è½½æ°æ®ï¼å¿«éæ¢å¤ç¼å­æ°æ®ã\n\n\n\nç¨æ·åéä¸ä¸ªè¯·æ±ï¼ç³»ç» A æ¶å°è¯·æ±åï¼åæ¥æ¬å° ehcache ç¼å­ï¼å¦ææ²¡æ¥å°åæ¥ redisãå¦æ ehcache å redis é½æ²¡æï¼åæ¥æ°æ®åºï¼å°æ°æ®åºä¸­çç»æï¼åå¥ ehcache å redis ä¸­ã\n\néæµç»ä»¶ï¼å¯ä»¥è®¾ç½®æ¯ç§çè¯·æ±ï¼æå¤å°è½éè¿ç»ä»¶ï¼å©ä½çæªéè¿çè¯·æ±ï¼æä¹åï¼èµ°éçº§ï¼å¯ä»¥è¿åä¸äºé»è®¤çå¼ï¼æèåææç¤ºï¼æèç©ºç½çå¼ã\n\nå¥½å¤ï¼\n\n * æ°æ®åºç»å¯¹ä¸ä¼æ­»ï¼éæµç»ä»¶ç¡®ä¿äºæ¯ç§åªæå¤å°ä¸ªè¯·æ±è½éè¿ã\n * åªè¦æ°æ®åºä¸æ­»ï¼å°±æ¯è¯´ï¼å¯¹ç¨æ·æ¥è¯´ï¼2/5 çè¯·æ±é½æ¯å¯ä»¥è¢«å¤ççã\n * åªè¦æ 2/5 çè¯·æ±å¯ä»¥è¢«å¤çï¼å°±æå³çä½ çç³»ç»æ²¡æ­»ï¼å¯¹ç¨æ·æ¥è¯´ï¼å¯è½å°±æ¯ç¹å»å æ¬¡å·ä¸åºæ¥é¡µé¢ï¼ä½æ¯å¤ç¹å æ¬¡ï¼å°±å¯ä»¥å·åºæ¥ä¸æ¬¡ã\n\n\n# ç¼å­ç©¿é\n\nå¯¹äºç³»ç» Aï¼åè®¾ä¸ç§ 5000 ä¸ªè¯·æ±ï¼ç»æå¶ä¸­ 4000 ä¸ªè¯·æ±æ¯é»å®¢ååºçæ¶ææ»å»ã\n\né»å®¢ååºçé£ 4000 ä¸ªæ»å»ï¼ç¼å­ä¸­æ¥ä¸å°ï¼æ¯æ¬¡ä½ å»æ°æ®åºéæ¥ï¼ä¹æ¥ä¸å°ã\n\nä¸¾ä¸ªæ å­ãæ°æ®åº id æ¯ä» 1 å¼å§çï¼ç»æé»å®¢åè¿æ¥çè¯·æ± id å¨é¨é½æ¯è´æ°ãè¿æ ·çè¯ï¼ç¼å­ä¸­ä¸ä¼æï¼è¯·æ±æ¯æ¬¡é½âè§ç¼å­äºæ ç©âï¼ç´æ¥æ¥è¯¢æ°æ®åºãè¿ç§æ¶ææ»å»åºæ¯çç¼å­ç©¿éå°±ä¼ç´æ¥ææ°æ®åºç»ææ­»ã\n\n\n\nè§£å³æ¹å¼å¾ç®åï¼æ¯æ¬¡ç³»ç» A ä»æ°æ®åºä¸­åªè¦æ²¡æ¥å°ï¼å°±åä¸ä¸ªç©ºå¼å°ç¼å­éå»ï¼æ¯å¦ set -999 UNKNOWNãç¶åè®¾ç½®ä¸ä¸ªè¿ææ¶é´ï¼è¿æ ·çè¯ï¼ä¸æ¬¡æç¸åç key æ¥è®¿é®çæ¶åï¼å¨ç¼å­å¤±æä¹åï¼é½å¯ä»¥ç´æ¥ä»ç¼å­ä¸­åæ°æ®ã\n\n\n# ç¼å­å»ç©¿\n\nç¼å­å»ç©¿ï¼å°±æ¯è¯´æä¸ª key éå¸¸ç­ç¹ï¼è®¿é®éå¸¸é¢ç¹ï¼å¤äºéä¸­å¼é«å¹¶åè®¿é®çæåµï¼å½è¿ä¸ª key å¨å¤±æçç¬é´ï¼å¤§éçè¯·æ±å°±å»ç©¿äºç¼å­ï¼ç´æ¥è¯·æ±æ°æ®åºï¼å°±åæ¯å¨ä¸éå±éä¸å¿å¼äºä¸ä¸ªæ´ã\n\nè§£å³æ¹å¼ä¹å¾ç®åï¼å¯ä»¥å°ç­ç¹æ°æ®è®¾ç½®ä¸ºæ°¸è¿ä¸è¿æï¼æèåºäº redis or zookeeper å®ç°äºæ¥éï¼ç­å¾ç¬¬ä¸ä¸ªè¯·æ±æå»ºå®ç¼å­ä¹åï¼åéæ¾éï¼è¿èå¶å®è¯·æ±æè½éè¿è¯¥ key è®¿é®æ°æ®ã\n\n\n# redis çå¹¶åç«äºé®é¢æ¯ä»ä¹ï¼å¦ä½è§£å³è¿ä¸ªé®é¢ï¼äºè§£ redis äºå¡ç CAS æ¹æ¡åï¼\n\næä¸ªæ¶å»ï¼å¤ä¸ªç³»ç»å®ä¾é½å»æ´æ°æä¸ª keyãå¯ä»¥åºäº zookeeper å®ç°åå¸å¼éãæ¯ä¸ªç³»ç»éè¿ zookeeper è·ååå¸å¼éï¼ç¡®ä¿åä¸æ¶é´ï¼åªè½æä¸ä¸ªç³»ç»å®ä¾å¨æä½æä¸ª keyï¼å«äººé½ä¸åè®¸è¯»ååã\n\n\n\nä½ è¦åå¥ç¼å­çæ°æ®ï¼é½æ¯ä» mysql éæ¥åºæ¥çï¼é½å¾åå¥ mysql ä¸­ï¼åå¥ mysql ä¸­çæ¶åå¿é¡»ä¿å­ä¸ä¸ªæ¶é´æ³ï¼ä» mysql æ¥åºæ¥çæ¶åï¼æ¶é´æ³ä¹æ¥åºæ¥ã\n\næ¯æ¬¡è¦åä¹åï¼åå¤æ­ä¸ä¸å½åè¿ä¸ª value çæ¶é´æ³æ¯å¦æ¯ç¼å­éç value çæ¶é´æ³è¦æ°ãå¦ææ¯çè¯ï¼é£ä¹å¯ä»¥åï¼å¦åï¼å°±ä¸è½ç¨æ§çæ°æ®è¦çæ°çæ°æ®ã\n\n\n# çäº§ç¯å¢ä¸­ç redis æ¯æä¹é¨ç½²çï¼\n\nredis clusterï¼10 å°æºå¨ï¼5 å°æºå¨é¨ç½²äº redis ä¸»å®ä¾ï¼å¦å¤ 5 å°æºå¨é¨ç½²äº redis çä»å®ä¾ï¼æ¯ä¸ªä¸»å®ä¾æäºä¸ä¸ªä»å®ä¾ï¼5 ä¸ªèç¹å¯¹å¤æä¾è¯»åæå¡ï¼æ¯ä¸ªèç¹çè¯»åé«å³° qps å¯è½å¯ä»¥è¾¾å°æ¯ç§ 5 ä¸ï¼5 å°æºå¨æå¤æ¯ 25 ä¸è¯»åè¯·æ±/sã\n\næºå¨æ¯ä»ä¹éç½®ï¼32G åå­+ 8 æ ¸ CPU + 1T ç£çï¼ä½æ¯åéç» redis è¿ç¨çæ¯ 10g åå­ï¼ä¸è¬çº¿ä¸çäº§ç¯å¢ï¼redis çåå­å°½éä¸è¦è¶è¿ 10gï¼è¶è¿ 10g å¯è½ä¼æé®é¢ã\n\n5 å°æºå¨å¯¹å¤æä¾è¯»åï¼ä¸å±æ 50g åå­ã\n\nå ä¸ºæ¯ä¸ªä¸»å®ä¾é½æäºä¸ä¸ªä»å®ä¾ï¼æä»¥æ¯é«å¯ç¨çï¼ä»»ä½ä¸ä¸ªä¸»å®ä¾å®æºï¼é½ä¼èªå¨æéè¿ç§»ï¼redis ä»å®ä¾ä¼èªå¨åæä¸»å®ä¾ç»§ç»­æä¾è¯»åæå¡ã\n\nä½ å¾åå­éåçæ¯ä»ä¹æ°æ®ï¼æ¯æ¡æ°æ®çå¤§å°æ¯å¤å°ï¼ååæ°æ®ï¼æ¯æ¡æ°æ®æ¯ 10kbã100 æ¡æ°æ®æ¯ 1mbï¼10 ä¸æ¡æ°æ®æ¯ 1gãå¸¸é©»åå­çæ¯ 200 ä¸æ¡ååæ°æ®ï¼å ç¨åå­æ¯ 20gï¼ä»ä»ä¸å°æ»åå­ç 50%ãç®åé«å³°ææ¯ç§å°±æ¯ 3500 å·¦å³çè¯·æ±éã\n\nå¶å®å¤§åçå¬å¸ï¼ä¼æåºç¡æ¶æç team è´è´£ç¼å­éç¾¤çè¿ç»´ã',normalizedContent:'# ç¼å­å¤ºå½è¿ç¯é®\n\n\n# ä¸ºä»ä¹è¦ç¨ç¼å­ï¼\n\nç¨ç¼å­ï¼ä¸»è¦æä¸¤ä¸ªç¨éï¼é«æ§è½ãé«å¹¶åã\n\n\n# é«æ§è½\n\nåè®¾è¿ä¹ä¸ªåºæ¯ï¼ä½ æä¸ªæä½ï¼ä¸ä¸ªè¯·æ±è¿æ¥ï¼å­å§å­å§ä½ åç§ä¹±ä¸å«ç³æä½ mysqlï¼åå¤©æ¥åºæ¥ä¸ä¸ªç»æï¼èæ¶ 600msãä½æ¯è¿ä¸ªç»æå¯è½æ¥ä¸æ¥å ä¸ªå°æ¶é½ä¸ä¼åäºï¼æèåäºä¹å¯ä»¥ä¸ç¨ç«å³åé¦ç»ç¨æ·ãé£ä¹æ­¤æ¶ååï¼\n\nç¼å­åï¼æè¾ 600ms æ¥åºæ¥çç»æï¼æç¼å­éï¼ä¸ä¸ª key å¯¹åºä¸ä¸ª valueï¼ä¸æ¬¡åæäººæ¥ï¼å«èµ° mysql æè¾ 600ms äºï¼ç´æ¥ä»ç¼å­éï¼éè¿ä¸ä¸ª key æ¥åºæ¥ä¸ä¸ª valueï¼2ms æå®ãæ§è½æå 300 åã\n\nå°±æ¯è¯´å¯¹äºä¸äºéè¦å¤ææä½èæ¶æ¥åºæ¥çç»æï¼ä¸ç¡®å®åé¢ä¸æä¹ååï¼ä½æ¯æå¾å¤è¯»è¯·æ±ï¼é£ä¹ç´æ¥å°æ¥è¯¢åºæ¥çç»ææ¾å¨ç¼å­ä¸­ï¼åé¢ç´æ¥è¯»ç¼å­å°±å¥½ã\n\n\n# é«å¹¶å\n\nmysql è¿ä¹éçæ°æ®åºï¼åæ ¹å¿è®¾è®¡ä¸æ¯è®©ä½ ç©å¿é«å¹¶åçï¼è½ç¶ä¹å¯ä»¥ç©å¿ï¼ä½æ¯å¤©ç¶æ¯æä¸å¥½ãmysql åæºæ¯æå° 2000qps ä¹å¼å§å®¹ææ¥è­¦äºã\n\næä»¥è¦æ¯ä½ æä¸ªç³»ç»ï¼é«å³°æä¸ç§éè¿æ¥çè¯·æ±æ 1 ä¸ï¼é£ä¸ä¸ª mysql åæºç»å¯¹ä¼æ­»æãä½ è¿ä¸ªæ¶åå°±åªè½ä¸ç¼å­ï¼æå¾å¤æ°æ®æ¾ç¼å­ï¼å«æ¾ mysqlãç¼å­åè½ç®åï¼è¯´ç½äºå°±æ¯ key-value å¼æä½ï¼åæºæ¯æçå¹¶åéè½»æ¾ä¸ç§å ä¸åå ä¸ï¼æ¯æé«å¹¶å so easyãåæºæ¿è½½å¹¶åéæ¯ mysql åæºçå ååã\n\n> ç¼å­æ¯èµ°åå­çï¼åå­å¤©ç¶å°±æ¯æé«å¹¶åã\n\n\n# ç¨äºç¼å­ä¹åä¼æä»ä¹ä¸è¯åæï¼\n\nå¸¸è§çç¼å­é®é¢æä»¥ä¸å ä¸ªï¼\n\n * ç¼å­ä¸æ°æ®åºååä¸ä¸è´\n * ç¼å­éªå´©ãç¼å­ç©¿é\n * ç¼å­å¹¶åç«äº\n\nåé¢åè¯¦ç»è¯´æã\n\n\n# redis å memcached æå¥åºå«ï¼\n\nredis æ¯æå¤æçæ°æ®ç»æ\n\nredis ç¸æ¯ memcached æ¥è¯´ï¼æ¥ææ´å¤çæ°æ®ç»æï¼è½æ¯ææ´ä¸°å¯çæ°æ®æä½ãå¦æéè¦ç¼å­è½å¤æ¯ææ´å¤æçç»æåæä½ï¼ redis ä¼æ¯ä¸éçéæ©ã\n\nredis åçæ¯æéç¾¤æ¨¡å¼\n\nå¨ redis3.x çæ¬ä¸­ï¼ä¾¿è½æ¯æ cluster æ¨¡å¼ï¼è memcached æ²¡æåççéç¾¤æ¨¡å¼ï¼éè¦ä¾é å®¢æ·ç«¯æ¥å®ç°å¾éç¾¤ä¸­åçåå¥æ°æ®ã\n\næ§è½å¯¹æ¯\n\nç±äº redis åªä½¿ç¨åæ ¸ï¼è memcached å¯ä»¥ä½¿ç¨å¤æ ¸ï¼æä»¥å¹³åæ¯ä¸ä¸ªæ ¸ä¸ redis å¨å­å¨å°æ°æ®æ¶æ¯ memcached æ§è½æ´é«ãèå¨ 100k ä»¥ä¸çæ°æ®ä¸­ï¼memcached æ§è½è¦é«äº redisãè½ç¶ redis æè¿ä¹å¨å­å¨å¤§æ°æ®çæ§è½ä¸è¿è¡ä¼åï¼ä½æ¯æ¯èµ· memcachedï¼è¿æ¯ç¨æéè²ã\n\n\n# ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«ï¼\n\n\n# redis ççº¿ç¨æ¨¡å\n\nredis åé¨ä½¿ç¨æä»¶äºä»¶å¤çå¨ file event handlerï¼è¿ä¸ªæä»¶äºä»¶å¤çå¨æ¯åçº¿ç¨çï¼æä»¥ redis æå«ååçº¿ç¨çæ¨¡åãå®éç¨ io å¤è·¯å¤ç¨æºå¶åæ¶çå¬å¤ä¸ª socketï¼å°äº§çäºä»¶ç socket åå¥åå­éåä¸­ï¼äºä»¶åæ´¾å¨æ ¹æ® socket ä¸çäºä»¶ç±»åæ¥éæ©å¯¹åºçäºä»¶å¤çå¨è¿è¡å¤çã\n\næä»¶äºä»¶å¤çå¨çç»æåå« 4 ä¸ªé¨åï¼\n\n * å¤ä¸ª socket\n * io å¤è·¯å¤ç¨ç¨åº\n * æä»¶äºä»¶åæ´¾å¨\n * äºä»¶å¤çå¨ï¼è¿æ¥åºç­å¤çå¨ãå½ä»¤è¯·æ±å¤çå¨ãå½ä»¤åå¤å¤çå¨ï¼\n\nå¤ä¸ª socket å¯è½ä¼å¹¶åäº§çä¸åçæä½ï¼æ¯ä¸ªæä½å¯¹åºä¸åçæä»¶äºä»¶ï¼ä½æ¯ io å¤è·¯å¤ç¨ç¨åºä¼çå¬å¤ä¸ª socketï¼ä¼å°äº§çäºä»¶ç socket æ¾å¥éåä¸­æéï¼äºä»¶åæ´¾å¨æ¯æ¬¡ä»éåä¸­ååºä¸ä¸ª socketï¼æ ¹æ® socket çäºä»¶ç±»åäº¤ç»å¯¹åºçäºä»¶å¤çå¨è¿è¡å¤çã\n\næ¥çå®¢æ·ç«¯ä¸ redis çä¸æ¬¡éä¿¡è¿ç¨ï¼\n\n\n\nè¦æç½ï¼éä¿¡æ¯éè¿ socket æ¥å®æçï¼ä¸æçåå­¦å¯ä»¥åå»çä¸ç socket ç½ç»ç¼ç¨ã\n\né¦åï¼redis æå¡ç«¯è¿ç¨åå§åçæ¶åï¼ä¼å° server socket ç ae_readable äºä»¶ä¸è¿æ¥åºç­å¤çå¨å³èã\n\nå®¢æ·ç«¯ socket01 å redis è¿ç¨ç server socket è¯·æ±å»ºç«è¿æ¥ï¼æ­¤æ¶ server socket ä¼äº§çä¸ä¸ª ae_readable äºä»¶ï¼io å¤è·¯å¤ç¨ç¨åºçå¬å° server socket äº§ççäºä»¶åï¼å°è¯¥ socket åå¥éåä¸­ãæä»¶äºä»¶åæ´¾å¨ä»éåä¸­è·å socketï¼äº¤ç»è¿æ¥åºç­å¤çå¨ãè¿æ¥åºç­å¤çå¨ä¼åå»ºä¸ä¸ªè½ä¸å®¢æ·ç«¯éä¿¡ç socket01ï¼å¹¶å°è¯¥ socket01 ç ae_readable äºä»¶ä¸å½ä»¤è¯·æ±å¤çå¨å³èã\n\nåè®¾æ­¤æ¶å®¢æ·ç«¯åéäºä¸ä¸ª set key value è¯·æ±ï¼æ­¤æ¶ redis ä¸­ç socket01 ä¼äº§ç ae_readable äºä»¶ï¼io å¤è·¯å¤ç¨ç¨åºå° socket01 åå¥éåï¼æ­¤æ¶äºä»¶åæ´¾å¨ä»éåä¸­è·åå° socket01 äº§çç ae_readable äºä»¶ï¼ç±äºåé¢ socket01 ç ae_readable äºä»¶å·²ç»ä¸å½ä»¤è¯·æ±å¤çå¨å³èï¼å æ­¤äºä»¶åæ´¾å¨å°äºä»¶äº¤ç»å½ä»¤è¯·æ±å¤çå¨æ¥å¤çãå½ä»¤è¯·æ±å¤çå¨è¯»å socket01 ç key value å¹¶å¨èªå·±åå­ä¸­å®æ key value çè®¾ç½®ãæä½å®æåï¼å®ä¼å° socket01 ç ae_writable äºä»¶ä¸å½ä»¤åå¤å¤çå¨å³èã\n\nå¦ææ­¤æ¶å®¢æ·ç«¯åå¤å¥½æ¥æ¶è¿åç»æäºï¼é£ä¹ redis ä¸­ç socket01 ä¼äº§çä¸ä¸ª ae_writable äºä»¶ï¼åæ ·åå¥éåä¸­ï¼äºä»¶åæ´¾å¨æ¾å°ç¸å³èçå½ä»¤åå¤å¤çå¨ï¼ç±å½ä»¤åå¤å¤çå¨å¯¹ socket01 è¾å¥æ¬æ¬¡æä½çä¸ä¸ªç»æï¼æ¯å¦ okï¼ä¹åè§£é¤ socket01 ç ae_writable äºä»¶ä¸å½ä»¤åå¤å¤çå¨çå³èã\n\nè¿æ ·ä¾¿å®æäºä¸æ¬¡éä¿¡ã\n\n\n# ä¸ºå¥ redis åçº¿ç¨æ¨¡åä¹è½æçè¿ä¹é«?\n\n * çº¯åå­æä½ã\n * æ ¸å¿æ¯åºäºéé»å¡ç io å¤è·¯å¤ç¨æºå¶ã\n * c è¯­è¨å®ç°ï¼ä¸è¬æ¥è¯´ï¼c è¯­è¨å®ç°çç¨åºâè·ç¦»âæä½ç³»ç»æ´è¿ï¼æ§è¡éåº¦ç¸å¯¹ä¼æ´å¿«ã\n * åçº¿ç¨åèé¿åäºå¤çº¿ç¨çé¢ç¹ä¸ä¸æåæ¢é®é¢ï¼é¢é²äºå¤çº¿ç¨å¯è½äº§ççç«äºé®é¢ã\n\n\n# redis æåªäºæ°æ®ç±»å\n\nredis ä¸»è¦æä»¥ä¸å ç§æ°æ®ç±»åï¼\n\n * string\n * hash\n * list\n * set\n * sorted set\n\n\n# string\n\nè¿æ¯æç®åçç±»åï¼å°±æ¯æ®éç set å getï¼åç®åç kv ç¼å­ã\n\nset college szu\n\n\n\n# hash\n\nè¿ä¸ªæ¯ç±»ä¼¼ map çä¸ç§ç»æï¼è¿ä¸ªä¸è¬å°±æ¯å¯ä»¥å°ç»æåçæ°æ®ï¼æ¯å¦ä¸ä¸ªå¯¹è±¡ï¼åææ¯è¿ä¸ªå¯¹è±¡æ²¡åµå¥å¶ä»çå¯¹è±¡ï¼ç»ç¼å­å¨ redis éï¼ç¶åæ¯æ¬¡è¯»åç¼å­çæ¶åï¼å¯ä»¥å°±æä½ hash éçæä¸ªå­æ®µã\n\nhset person name bingo\nhset person age 20\nhset person id 1\nhget person name\nperson = {\n    "name": "bingo",\n    "age": 20,\n    "id": 1\n}\n\n\n\n# list\n\nlist æ¯æåºåè¡¨ï¼è¿ä¸ªå¯ä»¥ç©å¿åºå¾å¤è±æ ·ã\n\næ¯å¦å¯ä»¥éè¿ list å­å¨ä¸äºåè¡¨åçæ°æ®ç»æï¼ç±»ä¼¼ç²ä¸åè¡¨ãæç« çè¯è®ºåè¡¨ä¹ç±»çä¸è¥¿ã\n\næ¯å¦å¯ä»¥éè¿ lrange å½ä»¤ï¼è¯»åæä¸ªé­åºé´åçåç´ ï¼å¯ä»¥åºäº list å®ç°åé¡µæ¥è¯¢ï¼è¿ä¸ªæ¯å¾æ£çä¸ä¸ªåè½ï¼åºäº redis å®ç°ç®åçé«æ§è½åé¡µï¼å¯ä»¥åç±»ä¼¼å¾®åé£ç§ä¸æä¸æ­åé¡µçä¸è¥¿ï¼æ§è½é«ï¼å°±ä¸é¡µä¸é¡µèµ°ã\n\n# 0å¼å§ä½ç½®ï¼-1ç»æä½ç½®ï¼ç»æä½ç½®ä¸º-1æ¶ï¼è¡¨ç¤ºåè¡¨çæåä¸ä¸ªä½ç½®ï¼å³æ¥çææã\nlrange mylist 0 -1\n\n\næ¯å¦å¯ä»¥æä¸ªç®åçæ¶æ¯éåï¼ä» list å¤´æ¼è¿å»ï¼ä» list å°¾å·´é£éå¼åºæ¥ã\n\nlpush mylist 1\nlpush mylist 2\nlpush mylist 3 4 5\n\n# 1\nrpop mylist\n\n\n\n# set\n\nset æ¯æ åºéåï¼èªå¨å»éã\n\nç´æ¥åºäº set å°ç³»ç»ééè¦å»éçæ°æ®æè¿å»ï¼èªå¨å°±ç»å»éäºï¼å¦æä½ éè¦å¯¹ä¸äºæ°æ®è¿è¡å¿«éçå¨å±å»éï¼ä½ å½ç¶ä¹å¯ä»¥åºäº jvm åå­éç hashset è¿è¡å»éï¼ä½æ¯å¦æä½ çæä¸ªç³»ç»é¨ç½²å¨å¤å°æºå¨ä¸å¢ï¼å¾åºäº redis è¿è¡å¨å±ç set å»éã\n\nå¯ä»¥åºäº set ç©å¿äº¤éãå¹¶éãå·®éçæä½ï¼æ¯å¦äº¤éå§ï¼å¯ä»¥æä¸¤ä¸ªäººçç²ä¸åè¡¨æ´ä¸ä¸ªäº¤éï¼ççä¿©äººçå±åå¥½åæ¯è°ï¼å¯¹å§ã\n\næä¸¤ä¸ªå¤§ v çç²ä¸é½æ¾å¨ä¸¤ä¸ª set ä¸­ï¼å¯¹ä¸¤ä¸ª set åäº¤éã\n\n#-------æä½ä¸ä¸ªset-------\n# æ·»å åç´ \nsadd myset 1\n\n# æ¥çå¨é¨åç´ \nsmembers myset\n\n# å¤æ­æ¯å¦åå«æä¸ªå¼\nsismember myset 3\n\n# å é¤æä¸ª/äºåç´ \nsrem myset 1\nsrem myset 2 4\n\n# æ¥çåç´ ä¸ªæ°\nscard myset\n\n# éæºå é¤ä¸ä¸ªåç´ \nspop myset\n\n#-------æä½å¤ä¸ªset-------\n# å°ä¸ä¸ªsetçåç´ ç§»å¨å°å¦å¤ä¸ä¸ªset\nsmove yourset myset 2\n\n# æ±ä¸¤setçäº¤é\nsinter yourset myset\n\n# æ±ä¸¤setçå¹¶é\nsunion yourset myset\n\n# æ±å¨yoursetä¸­èä¸å¨mysetä¸­çåç´ \nsdiff yourset myset\n\n\n\n# sorted set\n\nsorted set æ¯æåºç setï¼å»éä½å¯ä»¥æåºï¼åè¿å»çæ¶åç»ä¸ä¸ªåæ°ï¼èªå¨æ ¹æ®åæ°æåºã\n\nzadd board 85 zhangsan\nzadd board 72 lisi\nzadd board 96 wangwu\nzadd board 63 zhaoliu\n\n# è·åæååä¸çç¨æ·ï¼é»è®¤æ¯ååºï¼æä»¥éè¦ rev æ¹ä¸ºéåºï¼\nzrevrange board 0 3\n\n# è·åæç¨æ·çæå\nzrank board zhaoliu\n\n\n\n# å¦ä½ä¿è¯ redis çé«å¹¶ååé«å¯ç¨ï¼redis çä¸»ä»å¤å¶åçè½ä»ç»ä¸ä¸ä¹ï¼redis çå¨åµåçè½ä»ç»ä¸ä¸ä¹ï¼\n\nå¦æä½ ç¨ redis ç¼å­ææ¯çè¯ï¼è¯å®è¦èèå¦ä½ç¨ redis æ¥å å¤å°æºå¨ï¼ä¿è¯ redis æ¯é«å¹¶åçï¼è¿æå°±æ¯å¦ä½è®© redis ä¿è¯èªå·±ä¸æ¯ææä»¥åå°±ç´æ¥æ­»æäºï¼å³ redis é«å¯ç¨ã\n\nç±äºæ­¤èåå®¹è¾å¤ï¼å æ­¤ï¼ä¼åä¸ºä¸¤ä¸ªå°èè¿è¡è®²è§£ã\n\n * redis ä¸»ä»æ¶æ\n * redis åºäºå¨åµå®ç°é«å¯ç¨\n\nredis å®ç°é«å¹¶åä¸»è¦ä¾é ä¸»ä»æ¶æï¼ä¸ä¸»å¤ä»ï¼ä¸è¬æ¥è¯´ï¼å¾å¤é¡¹ç®å¶å®å°±è¶³å¤äºï¼åä¸»ç¨æ¥åå¥æ°æ®ï¼åæºå ä¸ qpsï¼å¤ä»ç¨æ¥æ¥è¯¢æ°æ®ï¼å¤ä¸ªä»å®ä¾å¯ä»¥æä¾æ¯ç§ 10w ç qpsã\n\nå¦ææ³è¦å¨å®ç°é«å¹¶åçåæ¶ï¼å®¹çº³å¤§éçæ°æ®ï¼é£ä¹å°±éè¦ redis éç¾¤ï¼ä½¿ç¨ redis éç¾¤ä¹åï¼å¯ä»¥æä¾æ¯ç§å åä¸çè¯»åå¹¶åã\n\nredis é«å¯ç¨ï¼å¦ææ¯åä¸»ä»æ¶æé¨ç½²ï¼é£ä¹å ä¸å¨åµå°±å¯ä»¥äºï¼å°±å¯ä»¥å®ç°ï¼ä»»ä½ä¸ä¸ªå®ä¾å®æºï¼å¯ä»¥è¿è¡ä¸»å¤åæ¢ã\n\n\n# redis çè¿æç­ç¥é½æåªäºï¼åå­æ·æ±°æºå¶é½æåªäºï¼æåä¸ä¸ lru ä»£ç å®ç°ï¼\n\n\n# redis è¿æç­ç¥\n\nredis è¿æç­ç¥æ¯ï¼å®æå é¤+æ°æ§å é¤ã\n\næè°å®æå é¤ï¼æçæ¯ redis é»è®¤æ¯æ¯é 100ms å°±éæºæ½åä¸äºè®¾ç½®äºè¿ææ¶é´ç keyï¼æ£æ¥å¶æ¯å¦è¿æï¼å¦æè¿æå°±å é¤ã\n\nåè®¾ redis éæ¾äº 10w ä¸ª keyï¼é½è®¾ç½®äºè¿ææ¶é´ï¼ä½ æ¯éå ç¾æ¯«ç§ï¼å°±æ£æ¥ 10w ä¸ª keyï¼é£ redis åºæ¬ä¸å°±æ­»äºï¼cpu è´è½½ä¼å¾é«çï¼æ¶èå¨ä½ çæ£æ¥è¿æ key ä¸äºãæ³¨æï¼è¿éå¯ä¸æ¯æ¯é 100ms å°±éåææçè®¾ç½®è¿ææ¶é´ç keyï¼é£æ ·å°±æ¯ä¸åºæ§è½ä¸çç¾é¾ãå®éä¸ redis æ¯æ¯é 100ms éæºæ½åä¸äº key æ¥æ£æ¥åå é¤çã\n\nä½æ¯é®é¢æ¯ï¼å®æå é¤å¯è½ä¼å¯¼è´å¾å¤è¿æ key å°äºæ¶é´å¹¶æ²¡æè¢«å é¤æï¼é£åæ´å¢ï¼æä»¥å°±æ¯æ°æ§å é¤äºãè¿å°±æ¯è¯´ï¼å¨ä½ è·åæä¸ª key çæ¶åï¼redis ä¼æ£æ¥ä¸ä¸ ï¼è¿ä¸ª key å¦æè®¾ç½®äºè¿ææ¶é´é£ä¹æ¯å¦è¿æäºï¼å¦æè¿æäºæ­¤æ¶å°±ä¼å é¤ï¼ä¸ä¼ç»ä½ è¿åä»»ä½ä¸è¥¿ã\n\n> è·å key çæ¶åï¼å¦ææ­¤æ¶ key å·²ç»è¿æï¼å°±å é¤ï¼ä¸ä¼è¿åä»»ä½ä¸è¥¿ã\n\nä½æ¯å®éä¸è¿è¿æ¯æé®é¢çï¼å¦æå®æå é¤æ¼æäºå¾å¤è¿æ keyï¼ç¶åä½ ä¹æ²¡åæ¶å»æ¥ï¼ä¹å°±æ²¡èµ°æ°æ§å é¤ï¼æ­¤æ¶ä¼æä¹æ ·ï¼å¦æå¤§éè¿æ key å ç§¯å¨åå­éï¼å¯¼è´ redis åå­åèå°½äºï¼åæ´ï¼\n\nç­æ¡æ¯ï¼èµ°åå­æ·æ±°æºå¶ã\n\n\n# åå­æ·æ±°æºå¶\n\nredis åå­æ·æ±°æºå¶æä»¥ä¸å ä¸ªï¼\n\n * noeviction: å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼æ°åå¥æä½ä¼æ¥éï¼è¿ä¸ªä¸è¬æ²¡äººç¨å§ï¼å®å¨æ¯å¤ªæ¶å¿äºã\n * allkeys-lruï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼ç§»é¤æè¿æå°ä½¿ç¨ç keyï¼è¿ä¸ªæ¯æå¸¸ç¨çï¼ã\n * allkeys-randomï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyï¼è¿ä¸ªä¸è¬æ²¡äººç¨å§ï¼ä¸ºå¥è¦éæºï¼è¯å®æ¯ææè¿æå°ä½¿ç¨ç key ç»å¹²æåã\n * volatile-lruï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼ç§»é¤æè¿æå°ä½¿ç¨ç keyï¼è¿ä¸ªä¸è¬ä¸å¤ªåéï¼ã\n * volatile-randomï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyã\n * volatile-ttlï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼ææ´æ©è¿ææ¶é´ç key ä¼åç§»é¤ã\n\n\n# æåä¸ä¸ª lru ç®æ³\n\nä½ å¯ä»¥ç°åºæåæåå§ç lru ç®æ³ï¼é£ä¸ªä»£ç éå¤ªå¤§äºï¼ä¼¼ä¹ä¸å¤ªç°å®ã\n\nä¸æ±èªå·±çº¯æå·¥ä»åºå±å¼å§æé åºèªå·±ç lruï¼ä½æ¯èµ·ç è¦ç¥éå¦ä½å©ç¨å·²æç jdk æ°æ®ç»æå®ç°ä¸ä¸ª java çç lruã\n\nclass lrucache<k, v> extends linkedhashmap<k, v> {\n    private final int cache_size;\n\n    /**\n     * ä¼ éè¿æ¥æå¤è½ç¼å­å¤å°æ°æ®\n     *\n     * @param cachesize ç¼å­å¤§å°\n     */\n    public lrucache(int cachesize) {\n        // true è¡¨ç¤ºè®© linkedhashmap æç§è®¿é®é¡ºåºæ¥è¿è¡æåºï¼æè¿è®¿é®çæ¾å¨å¤´é¨ï¼æèè®¿é®çæ¾å¨å°¾é¨ã\n        super((int) math.ceil(cachesize / 0.75) + 1, 0.75f, true);\n        cache_size = cachesize;\n    }\n\n    @override\n    protected boolean removeeldestentry(map.entry<k, v> eldest) {\n        // å½ mapä¸­çæ°æ®éå¤§äºæå®çç¼å­ä¸ªæ°çæ¶åï¼å°±èªå¨å é¤æèçæ°æ®ã\n        return size() > cache_size;\n    }\n}\n\n\n\n# redis éç¾¤æ¨¡å¼çå·¥ä½åçè½è¯´ä¸ä¸ä¹ï¼å¨éç¾¤æ¨¡å¼ä¸ï¼redis ç key æ¯å¦ä½å¯»åçï¼åå¸å¼å¯»åé½æåªäºç®æ³ï¼äºè§£ä¸è´æ§ hash ç®æ³åï¼\n\nå¨åå å¹´ï¼redis å¦æè¦æå ä¸ªèç¹ï¼æ¯ä¸ªèç¹å­å¨ä¸é¨åçæ°æ®ï¼å¾åå©ä¸äºä¸­é´ä»¶æ¥å®ç°ï¼æ¯å¦è¯´æ codisï¼æè twemproxyï¼é½æãæä¸äº redis ä¸­é´ä»¶ï¼ä½ è¯»å redis ä¸­é´ä»¶ï¼redis ä¸­é´ä»¶è´è´£å°ä½ çæ°æ®åå¸å¼å­å¨å¨å¤å°æºå¨ä¸ç redis å®ä¾ä¸­ã\n\nè¿ä¸¤å¹´ï¼redis ä¸æ­å¨åå±ï¼redis ä¹ä¸æ­ææ°ççæ¬ï¼ç°å¨ç redis éç¾¤æ¨¡å¼ï¼å¯ä»¥åå°å¨å¤å°æºå¨ä¸ï¼é¨ç½²å¤ä¸ª redis å®ä¾ï¼æ¯ä¸ªå®ä¾å­å¨ä¸é¨åçæ°æ®ï¼åæ¶æ¯ä¸ª redis ä¸»å®ä¾å¯ä»¥æ redis ä»å®ä¾ï¼èªå¨ç¡®ä¿è¯´ï¼å¦æ redis ä¸»å®ä¾æäºï¼ä¼èªå¨åæ¢å° redis ä»å®ä¾ä¸æ¥ã\n\nç°å¨ redis çæ°çæ¬ï¼å¤§å®¶é½æ¯ç¨ redis cluster çï¼ä¹å°±æ¯ redis åçæ¯æç redis éç¾¤æ¨¡å¼ï¼é£ä¹é¢è¯å®è¯å®ä¼å°± redis cluster å¯¹ä½ æ¥ä¸ªå è¿ç®ãè¦æ¯ä½ æ²¡ç¨è¿ redis clusterï¼æ­£å¸¸ï¼ä»¥åå¾å¤äººç¨ codis ä¹ç±»çå®¢æ·ç«¯æ¥æ¯æéç¾¤ï¼ä½æ¯èµ·ç ä½ å¾ç ç©¶ä¸ä¸ redis cluster å§ã\n\nå¦æä½ çæ°æ®éå¾å°ï¼ä¸»è¦æ¯æ¿è½½é«å¹¶åé«æ§è½çåºæ¯ï¼æ¯å¦ä½ çç¼å­ä¸è¬å°±å ä¸ª gï¼åæºå°±è¶³å¤äºï¼å¯ä»¥ä½¿ç¨ replicationï¼ä¸ä¸ª master å¤ä¸ª slavesï¼è¦å ä¸ª slave è·ä½ è¦æ±çè¯»ååéæå³ï¼ç¶åèªå·±æ­å»ºä¸ä¸ª sentinel éç¾¤å»ä¿è¯ redis ä¸»ä»æ¶æçé«å¯ç¨æ§ã\n\nredis clusterï¼ä¸»è¦æ¯éå¯¹æµ·éæ°æ®+é«å¹¶å+é«å¯ç¨çåºæ¯ãredis cluster æ¯æ n ä¸ª redis master nodeï¼æ¯ä¸ª master node é½å¯ä»¥æè½½å¤ä¸ª slave nodeãè¿æ ·æ´ä¸ª redis å°±å¯ä»¥æ¨ªåæ©å®¹äºãå¦æä½ è¦æ¯ææ´å¤§æ°æ®éçç¼å­ï¼é£å°±æ¨ªåæ©å®¹æ´å¤ç master èç¹ï¼æ¯ä¸ª master èç¹å°±è½å­æ¾æ´å¤çæ°æ®äºã\n\n\n# é¢è¯é¢åæ\n\n\n# redis cluster ä»ç»\n\n * èªå¨å°æ°æ®è¿è¡åçï¼æ¯ä¸ª master ä¸æ¾ä¸é¨åæ°æ®\n * æä¾åç½®çé«å¯ç¨æ¯æï¼é¨å master ä¸å¯ç¨æ¶ï¼è¿æ¯å¯ä»¥ç»§ç»­å·¥ä½ç\n\nå¨ redis cluster æ¶æä¸ï¼æ¯ä¸ª redis è¦æ¾å¼ä¸¤ä¸ªç«¯å£å·ï¼æ¯å¦ä¸ä¸ªæ¯ 6379ï¼å¦å¤ä¸ä¸ªå°±æ¯ å  1w çç«¯å£å·ï¼æ¯å¦ 16379ã\n\n16379 ç«¯å£å·æ¯ç¨æ¥è¿è¡èç¹é´éä¿¡çï¼ä¹å°±æ¯ cluster bus çä¸è¥¿ï¼cluster bus çéä¿¡ï¼ç¨æ¥è¿è¡æéæ£æµãéç½®æ´æ°ãæéè½¬ç§»ææãcluster bus ç¨äºå¦å¤ä¸ç§äºè¿å¶çåè®®ï¼gossip åè®®ï¼ç¨äºèç¹é´è¿è¡é«æçæ°æ®äº¤æ¢ï¼å ç¨æ´å°çç½ç»å¸¦å®½åå¤çæ¶é´ã\n\n\n# èç¹é´çåé¨éä¿¡æºå¶\n\n# åºæ¬éä¿¡åç\n\néç¾¤åæ°æ®çç»´æ¤æä¸¤ç§æ¹å¼ï¼éä¸­å¼ãgossip åè®®ãredis cluster èç¹é´éç¨ gossip åè®®è¿è¡éä¿¡ã\n\néä¸­å¼æ¯å°éç¾¤åæ°æ®ï¼èç¹ä¿¡æ¯ãæéç­ç­ï¼å ç§å­å¨å¨æä¸ªèç¹ä¸ãéä¸­å¼åæ°æ®éä¸­å­å¨çä¸ä¸ªå¸åä»£è¡¨ï¼å°±æ¯å¤§æ°æ®é¢åç stormãå®æ¯åå¸å¼çå¤§æ°æ®å®æ¶è®¡ç®å¼æï¼æ¯éä¸­å¼çåæ°æ®å­å¨çç»æï¼åºå±åºäº zookeeperï¼åå¸å¼åè°çä¸­é´ä»¶ï¼å¯¹ææåæ°æ®è¿è¡å­å¨ç»´æ¤ã\n\n\n\nredis ç»´æ¤éç¾¤åæ°æ®éç¨å¦ä¸ä¸ªæ¹å¼ï¼ gossip åè®®ï¼ææèç¹é½ææä¸ä»½åæ°æ®ï¼ä¸åçèç¹å¦æåºç°äºåæ°æ®çåæ´ï¼å°±ä¸æ­å°åæ°æ®åéç»å¶å®çèç¹ï¼è®©å¶å®èç¹ä¹è¿è¡åæ°æ®çåæ´ã\n\n\n\néä¸­å¼çå¥½å¤å¨äºï¼åæ°æ®çè¯»ååæ´æ°ï¼æ¶ææ§éå¸¸å¥½ï¼ä¸æ¦åæ°æ®åºç°äºåæ´ï¼å°±ç«å³æ´æ°å°éä¸­å¼çå­å¨ä¸­ï¼å¶å®èç¹è¯»åçæ¶åå°±å¯ä»¥æç¥å°ï¼ä¸å¥½å¨äºï¼ææçåæ°æ®çæ´æ°ååå¨é¨éä¸­å¨ä¸ä¸ªå°æ¹ï¼å¯è½ä¼å¯¼è´åæ°æ®çå­å¨æååã\n\ngossip å¥½å¤å¨äºï¼åæ°æ®çæ´æ°æ¯è¾åæ£ï¼ä¸æ¯éä¸­å¨ä¸ä¸ªå°æ¹ï¼æ´æ°è¯·æ±ä¼ééç»­ç»­æå°ææèç¹ä¸å»æ´æ°ï¼éä½äºååï¼ä¸å¥½å¨äºï¼åæ°æ®çæ´æ°æå»¶æ¶ï¼å¯è½å¯¼è´éç¾¤ä¸­çä¸äºæä½ä¼æä¸äºæ»åã\n\n * 10000 ç«¯å£ï¼æ¯ä¸ªèç¹é½æä¸ä¸ªä¸é¨ç¨äºèç¹é´éä¿¡çç«¯å£ï¼å°±æ¯èªå·±æä¾æå¡çç«¯å£å·+10000ï¼æ¯å¦ 7001ï¼é£ä¹ç¨äºèç¹é´éä¿¡çå°±æ¯ 17001 ç«¯å£ãæ¯ä¸ªèç¹æ¯éä¸æ®µæ¶é´é½ä¼å¾å¦å¤å ä¸ªèç¹åé ping æ¶æ¯ï¼åæ¶å¶å®å ä¸ªèç¹æ¥æ¶å° ping ä¹åè¿å pongã\n * äº¤æ¢çä¿¡æ¯ï¼ä¿¡æ¯åæ¬æéä¿¡æ¯ï¼èç¹çå¢å åå é¤ï¼hash slot ä¿¡æ¯ç­ç­ã\n\n# gossip åè®®\n\ngossip åè®®åå«å¤ç§æ¶æ¯ï¼åå« ping,pong,meet,fail ç­ç­ã\n\n * meetï¼æä¸ªèç¹åé meet ç»æ°å å¥çèç¹ï¼è®©æ°èç¹å å¥éç¾¤ä¸­ï¼ç¶åæ°èç¹å°±ä¼å¼å§ä¸å¶å®èç¹è¿è¡éä¿¡ã\n\nredis-trib.rb add-node\n\n\nå¶å®åé¨å°±æ¯åéäºä¸ä¸ª gossip meet æ¶æ¯ç»æ°å å¥çèç¹ï¼éç¥é£ä¸ªèç¹å»å å¥æä»¬çéç¾¤ã\n\n * pingï¼æ¯ä¸ªèç¹é½ä¼é¢ç¹ç»å¶å®èç¹åé pingï¼å¶ä¸­åå«èªå·±çç¶æè¿æèªå·±ç»´æ¤çéç¾¤åæ°æ®ï¼äºç¸éè¿ ping äº¤æ¢åæ°æ®ã\n * pongï¼è¿å ping å meeetï¼åå«èªå·±çç¶æåå¶å®ä¿¡æ¯ï¼ä¹ç¨äºä¿¡æ¯å¹¿æ­åæ´æ°ã\n * failï¼æä¸ªèç¹å¤æ­å¦ä¸ä¸ªèç¹ fail ä¹åï¼å°±åé fail ç»å¶å®èç¹ï¼éç¥å¶å®èç¹è¯´ï¼æä¸ªèç¹å®æºå¦ã\n\n# ping æ¶æ¯æ·±å¥\n\nping æ¶è¦æºå¸¦ä¸äºåæ°æ®ï¼å¦æå¾é¢ç¹ï¼å¯è½ä¼å éç½ç»è´æã\n\næ¯ä¸ªèç¹æ¯ç§ä¼æ§è¡ 10 æ¬¡ pingï¼æ¯æ¬¡ä¼éæ© 5 ä¸ªæä¹æ²¡æéä¿¡çå¶å®èç¹ãå½ç¶å¦æåç°æä¸ªèç¹éä¿¡å»¶æ¶è¾¾å°äº cluster_node_timeout / 2ï¼é£ä¹ç«å³åé pingï¼é¿åæ°æ®äº¤æ¢å»¶æ¶è¿é¿ï¼è½åçæ¶é´å¤ªé¿äºãæ¯å¦è¯´ï¼ä¸¤ä¸ªèç¹ä¹é´é½ 10 åéæ²¡æäº¤æ¢æ°æ®äºï¼é£ä¹æ´ä¸ªéç¾¤å¤äºä¸¥éçåæ°æ®ä¸ä¸è´çæåµï¼å°±ä¼æé®é¢ãæä»¥ cluster_node_timeout å¯ä»¥è°èï¼å¦æè°å¾æ¯è¾å¤§ï¼é£ä¹ä¼éä½ ping çé¢çã\n\næ¯æ¬¡ pingï¼ä¼å¸¦ä¸èªå·±èç¹çä¿¡æ¯ï¼è¿æå°±æ¯å¸¦ä¸ 1/10 å¶å®èç¹çä¿¡æ¯ï¼åéåºå»ï¼è¿è¡äº¤æ¢ãè³å°åå« 3 ä¸ªå¶å®èç¹çä¿¡æ¯ï¼æå¤åå« æ»èç¹æ°å 2 ä¸ªå¶å®èç¹çä¿¡æ¯ã\n\n\n# åå¸å¼å¯»åç®æ³\n\n * hash ç®æ³ï¼å¤§éç¼å­éå»ºï¼\n * ä¸è´æ§ hash ç®æ³ï¼èªå¨ç¼å­è¿ç§»ï¼+ èæèç¹ï¼èªå¨è´è½½åè¡¡ï¼\n * redis cluster ç hash slot ç®æ³\n\n# hash ç®æ³\n\næ¥äºä¸ä¸ª keyï¼é¦åè®¡ç® hash å¼ï¼ç¶åå¯¹èç¹æ°åæ¨¡ãç¶åæå¨ä¸åç master èç¹ä¸ãä¸æ¦æä¸ä¸ª master èç¹å®æºï¼ææè¯·æ±è¿æ¥ï¼é½ä¼åºäºææ°çå©ä½ master èç¹æ°å»åæ¨¡ï¼å°è¯å»åæ°æ®ãè¿ä¼å¯¼è´å¤§é¨åçè¯·æ±è¿æ¥ï¼å¨é¨æ æ³æ¿å°ææçç¼å­ï¼å¯¼è´å¤§éçæµéæ¶å¥æ°æ®åºã\n\n\n\n# ä¸è´æ§ hash ç®æ³\n\nä¸è´æ§ hash ç®æ³å°æ´ä¸ª hash å¼ç©ºé´ç»ç»æä¸ä¸ªèæçåç¯ï¼æ´ä¸ªç©ºé´æé¡ºæ¶éæ¹åç»ç»ï¼ä¸ä¸æ­¥å°åä¸ª master èç¹ï¼ä½¿ç¨æå¡å¨ç ip æä¸»æºåï¼è¿è¡ hashãè¿æ ·å°±è½ç¡®å®æ¯ä¸ªèç¹å¨å¶åå¸ç¯ä¸çä½ç½®ã\n\næ¥äºä¸ä¸ª keyï¼é¦åè®¡ç® hash å¼ï¼å¹¶ç¡®å®æ­¤æ°æ®å¨ç¯ä¸çä½ç½®ï¼ä»æ­¤ä½ç½®æ²¿ç¯é¡ºæ¶éâè¡èµ°âï¼éå°çç¬¬ä¸ä¸ª master èç¹å°±æ¯ key æå¨ä½ç½®ã\n\nå¨ä¸è´æ§åå¸ç®æ³ä¸­ï¼å¦æä¸ä¸ªèç¹æäºï¼åå½±åçæ°æ®ä»ä»æ¯æ­¤èç¹å°ç¯ç©ºé´åä¸ä¸ªèç¹ï¼æ²¿çéæ¶éæ¹åè¡èµ°éå°çç¬¬ä¸ä¸ªèç¹ï¼ä¹é´çæ°æ®ï¼å¶å®ä¸åå½±åãå¢å ä¸ä¸ªèç¹ä¹åçã\n\nçé¹ï¼ä¸è´æ§åå¸ç®æ³å¨èç¹å¤ªå°æ¶ï¼å®¹æå ä¸ºèç¹åå¸ä¸ååèé æç¼å­ç­ç¹çé®é¢ãä¸ºäºè§£å³è¿ç§ç­ç¹é®é¢ï¼ä¸è´æ§ hash ç®æ³å¼å¥äºèæèç¹æºå¶ï¼å³å¯¹æ¯ä¸ä¸ªèç¹è®¡ç®å¤ä¸ª hashï¼æ¯ä¸ªè®¡ç®ç»æä½ç½®é½æ¾ç½®ä¸ä¸ªèæèç¹ãè¿æ ·å°±å®ç°äºæ°æ®çåååå¸ï¼è´è½½åè¡¡ã\n\n\n\n# redis cluster ç hash slot ç®æ³\n\nredis cluster æåºå®ç 16384 ä¸ª hash slotï¼å¯¹æ¯ä¸ª key è®¡ç® crc16 å¼ï¼ç¶åå¯¹ 16384 åæ¨¡ï¼å¯ä»¥è·å key å¯¹åºç hash slotã\n\nredis cluster ä¸­æ¯ä¸ª master é½ä¼ææé¨å slotï¼æ¯å¦æ 3 ä¸ª masterï¼é£ä¹å¯è½æ¯ä¸ª master ææ 5000 å¤ä¸ª hash slotãhash slot è®© node çå¢å åç§»é¤å¾ç®åï¼å¢å ä¸ä¸ª masterï¼å°±å°å¶ä» master ç hash slot ç§»å¨é¨åè¿å»ï¼åå°ä¸ä¸ª masterï¼å°±å°å®ç hash slot ç§»å¨å°å¶ä» master ä¸å»ãç§»å¨ hash slot çææ¬æ¯éå¸¸ä½çãå®¢æ·ç«¯ç apiï¼å¯ä»¥å¯¹æå®çæ°æ®ï¼è®©ä»ä»¬èµ°åä¸ä¸ª hash slotï¼éè¿ hash tag æ¥å®ç°ã\n\nä»»ä½ä¸å°æºå¨å®æºï¼å¦å¤ä¸¤ä¸ªèç¹ï¼ä¸å½±åçãå ä¸º key æ¾çæ¯ hash slotï¼ä¸æ¯æºå¨ã\n\n\n\n\n# redis cluster çé«å¯ç¨ä¸ä¸»å¤åæ¢åç\n\nredis cluster çé«å¯ç¨çåçï¼å ä¹è·å¨åµæ¯ç±»ä¼¼çã\n\n# å¤æ­èç¹å®æº\n\nå¦æä¸ä¸ªèç¹è®¤ä¸ºå¦å¤ä¸ä¸ªèç¹å®æºï¼é£ä¹å°±æ¯ pfailï¼ä¸»è§å®æºãå¦æå¤ä¸ªèç¹é½è®¤ä¸ºå¦å¤ä¸ä¸ªèç¹å®æºäºï¼é£ä¹å°±æ¯ failï¼å®¢è§å®æºï¼è·å¨åµçåçå ä¹ä¸æ ·ï¼sdownï¼odownã\n\nå¨ cluster-node-timeout åï¼æä¸ªèç¹ä¸ç´æ²¡æè¿å pongï¼é£ä¹å°±è¢«è®¤ä¸º pfailã\n\nå¦æä¸ä¸ªèç¹è®¤ä¸ºæä¸ªèç¹ pfail äºï¼é£ä¹ä¼å¨ gossip ping æ¶æ¯ä¸­ï¼ping ç»å¶ä»èç¹ï¼å¦æè¶è¿åæ°çèç¹é½è®¤ä¸º pfail äºï¼é£ä¹å°±ä¼åæ failã\n\n# ä»èç¹è¿æ»¤\n\nå¯¹å®æºç master nodeï¼ä»å¶ææç slave node ä¸­ï¼éæ©ä¸ä¸ªåæ¢æ master nodeã\n\næ£æ¥æ¯ä¸ª slave node ä¸ master node æ­å¼è¿æ¥çæ¶é´ï¼å¦æè¶è¿äº cluster-node-timeout * cluster-slave-validity-factorï¼é£ä¹å°±æ²¡æèµæ ¼åæ¢æ masterã\n\n# ä»èç¹éä¸¾\n\næ¯ä¸ªä»èç¹ï¼é½æ ¹æ®èªå·±å¯¹ master å¤å¶æ°æ®ç offsetï¼æ¥è®¾ç½®ä¸ä¸ªéä¸¾æ¶é´ï¼offset è¶å¤§ï¼å¤å¶æ°æ®è¶å¤ï¼çä»èç¹ï¼éä¸¾æ¶é´è¶é åï¼ä¼åè¿è¡éä¸¾ã\n\nææç master node å¼å§ slave éä¸¾æç¥¨ï¼ç»è¦è¿è¡éä¸¾ç slave è¿è¡æç¥¨ï¼å¦æå¤§é¨å master nodeï¼n/2 + 1ï¼é½æç¥¨ç»äºæä¸ªä»èç¹ï¼é£ä¹éä¸¾éè¿ï¼é£ä¸ªä»èç¹å¯ä»¥åæ¢æ masterã\n\nä»èç¹æ§è¡ä¸»å¤åæ¢ï¼ä»èç¹åæ¢ä¸ºä¸»èç¹ã\n\n# ä¸å¨åµæ¯è¾\n\næ´ä¸ªæµç¨è·å¨åµç¸æ¯ï¼éå¸¸ç±»ä¼¼ï¼æä»¥è¯´ï¼redis cluster åè½å¼ºå¤§ï¼ç´æ¥éæäº replication å sentinel çåè½ã\n\n\n# å¦ä½ä¿è¯ç¼å­ä¸æ°æ®åºçååä¸è´æ§ï¼\n\nä¸è¬æ¥è¯´ï¼å¦æåè®¸ç¼å­å¯ä»¥ç¨å¾®çè·æ°æ®åºå¶å°æä¸ä¸è´çæåµï¼ä¹å°±æ¯è¯´å¦æä½ çç³»ç»ä¸æ¯ä¸¥æ ¼è¦æ± âç¼å­+æ°æ®åºâ å¿é¡»ä¿æä¸è´æ§çè¯ï¼æå¥½ä¸è¦åè¿ä¸ªæ¹æ¡ï¼å³ï¼è¯»è¯·æ±ååè¯·æ±ä¸²è¡åï¼ä¸²å°ä¸ä¸ªåå­éåéå»ã\n\nä¸²è¡åå¯ä»¥ä¿è¯ä¸å®ä¸ä¼åºç°ä¸ä¸è´çæåµï¼ä½æ¯å®ä¹ä¼å¯¼è´ç³»ç»çååéå¤§å¹åº¦éä½ï¼ç¨æ¯æ­£å¸¸æåµä¸å¤å åçæºå¨å»æ¯æçº¿ä¸çä¸ä¸ªè¯·æ±ã\n\n\n# cache aside pattern\n\næç»å¸çç¼å­+æ°æ®åºè¯»åçæ¨¡å¼ï¼å°±æ¯ cache aside patternã\n\n * è¯»çæ¶åï¼åè¯»ç¼å­ï¼ç¼å­æ²¡æçè¯ï¼å°±è¯»æ°æ®åºï¼ç¶åååºæ°æ®åæ¾å¥ç¼å­ï¼åæ¶è¿åååºã\n * æ´æ°çæ¶åï¼åæ´æ°æ°æ®åºï¼ç¶ååå é¤ç¼å­ã\n\nä¸ºä»ä¹æ¯å é¤ç¼å­ï¼èä¸æ¯æ´æ°ç¼å­ï¼\n\nåå å¾ç®åï¼å¾å¤æ¶åï¼å¨å¤æç¹çç¼å­åºæ¯ï¼ç¼å­ä¸ååæ¯æ°æ®åºä¸­ç´æ¥ååºæ¥çå¼ã\n\næ¯å¦å¯è½æ´æ°äºæä¸ªè¡¨çä¸ä¸ªå­æ®µï¼ç¶åå¶å¯¹åºçç¼å­ï¼æ¯éè¦æ¥è¯¢å¦å¤ä¸¤ä¸ªè¡¨çæ°æ®å¹¶è¿è¡è¿ç®ï¼æè½è®¡ç®åºç¼å­ææ°çå¼çã\n\nå¦å¤æ´æ°ç¼å­çä»£ä»·ææ¶åæ¯å¾é«çãæ¯ä¸æ¯è¯´ï¼æ¯æ¬¡ä¿®æ¹æ°æ®åºçæ¶åï¼é½ä¸å®è¦å°å¶å¯¹åºçç¼å­æ´æ°ä¸ä»½ï¼ä¹è®¸æçåºæ¯æ¯è¿æ ·ï¼ä½æ¯å¯¹äºæ¯è¾å¤æçç¼å­æ°æ®è®¡ç®çåºæ¯ï¼å°±ä¸æ¯è¿æ ·äºãå¦æä½ é¢ç¹ä¿®æ¹ä¸ä¸ªç¼å­æ¶åçå¤ä¸ªè¡¨ï¼ç¼å­ä¹é¢ç¹æ´æ°ãä½æ¯é®é¢å¨äºï¼è¿ä¸ªç¼å­å°åºä¼ä¸ä¼è¢«é¢ç¹è®¿é®å°ï¼\n\nä¸¾ä¸ªæ å­ï¼ä¸ä¸ªç¼å­æ¶åçè¡¨çå­æ®µï¼å¨ 1 åéåå°±ä¿®æ¹äº 20 æ¬¡ï¼æèæ¯ 100 æ¬¡ï¼é£ä¹ç¼å­æ´æ° 20 æ¬¡ã100 æ¬¡ï¼ä½æ¯è¿ä¸ªç¼å­å¨ 1 åéååªè¢«è¯»åäº 1 æ¬¡ï¼æå¤§éçå·æ°æ®ãå®éä¸ï¼å¦æä½ åªæ¯å é¤ç¼å­çè¯ï¼é£ä¹å¨ 1 åéåï¼è¿ä¸ªç¼å­ä¸è¿å°±éæ°è®¡ç®ä¸æ¬¡èå·²ï¼å¼éå¤§å¹åº¦éä½ãç¨å°ç¼å­æå»ç®ç¼å­ã\n\nå¶å®å é¤ç¼å­ï¼èä¸æ¯æ´æ°ç¼å­ï¼å°±æ¯ä¸ä¸ª lazy è®¡ç®çææ³ï¼ä¸è¦æ¯æ¬¡é½éæ°åå¤æçè®¡ç®ï¼ä¸ç®¡å®ä¼ä¸ä¼ç¨å°ï¼èæ¯è®©å®å°éè¦è¢«ä½¿ç¨çæ¶ååéæ°è®¡ç®ãå mybatisï¼hibernateï¼é½ææå è½½ææ³ãæ¥è¯¢ä¸ä¸ªé¨é¨ï¼é¨é¨å¸¦äºä¸ä¸ªåå·¥ç listï¼æ²¡æå¿è¦è¯´æ¯æ¬¡æ¥è¯¢é¨é¨ï¼é½éé¢ç 1000 ä¸ªåå·¥çæ°æ®ä¹åæ¶æ¥åºæ¥åã80% çæåµï¼æ¥è¿ä¸ªé¨é¨ï¼å°±åªæ¯è¦è®¿é®è¿ä¸ªé¨é¨çä¿¡æ¯å°±å¯ä»¥äºãåæ¥é¨é¨ï¼åæ¶è¦è®¿é®éé¢çåå·¥ï¼é£ä¹è¿ä¸ªæ¶ååªæå¨ä½ è¦è®¿é®éé¢çåå·¥çæ¶åï¼æä¼å»æ°æ®åºéé¢æ¥è¯¢ 1000 ä¸ªåå·¥ã\n\n\n# æåçº§çç¼å­ä¸ä¸è´é®é¢åè§£å³æ¹æ¡\n\né®é¢ï¼åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ãå¦æå é¤ç¼å­å¤±è´¥äºï¼é£ä¹ä¼å¯¼è´æ°æ®åºä¸­æ¯æ°æ°æ®ï¼ç¼å­ä¸­æ¯æ§æ°æ®ï¼æ°æ®å°±åºç°äºä¸ä¸è´ã\n\n\n\nè§£å³æè·¯ï¼åå é¤ç¼å­ï¼åæ´æ°æ°æ®åºãå¦ææ°æ®åºæ´æ°å¤±è´¥äºï¼é£ä¹æ°æ®åºä¸­æ¯æ§æ°æ®ï¼ç¼å­ä¸­æ¯ç©ºçï¼é£ä¹æ°æ®ä¸ä¼ä¸ä¸è´ãå ä¸ºè¯»çæ¶åç¼å­æ²¡æï¼æä»¥å»è¯»äºæ°æ®åºä¸­çæ§æ°æ®ï¼ç¶åæ´æ°å°ç¼å­ä¸­ã\n\n\n# æ¯è¾å¤æçæ°æ®ä¸ä¸è´é®é¢åæ\n\næ°æ®åçäºåæ´ï¼åå é¤äºç¼å­ï¼ç¶åè¦å»ä¿®æ¹æ°æ®åºï¼æ­¤æ¶è¿æ²¡ä¿®æ¹ãä¸ä¸ªè¯·æ±è¿æ¥ï¼å»è¯»ç¼å­ï¼åç°ç¼å­ç©ºäºï¼å»æ¥è¯¢æ°æ®åºï¼æ¥å°äºä¿®æ¹åçæ§æ°æ®ï¼æ¾å°äºç¼å­ä¸­ãéåæ°æ®åæ´çç¨åºå®æäºæ°æ®åºçä¿®æ¹ãå®äºï¼æ°æ®åºåç¼å­ä¸­çæ°æ®ä¸ä¸æ ·äº...\n\nä¸ºä»ä¹ä¸äº¿æµéé«å¹¶ååºæ¯ä¸ï¼ç¼å­ä¼åºç°è¿ä¸ªé®é¢ï¼\n\nåªæå¨å¯¹ä¸ä¸ªæ°æ®å¨å¹¶åçè¿è¡è¯»åçæ¶åï¼æå¯è½ä¼åºç°è¿ç§é®é¢ãå¶å®å¦æè¯´ä½ çå¹¶åéå¾ä½çè¯ï¼ç¹å«æ¯è¯»å¹¶åå¾ä½ï¼æ¯å¤©è®¿é®éå°± 1 ä¸æ¬¡ï¼é£ä¹å¾å°çæåµä¸ï¼ä¼åºç°åææè¿°çé£ç§ä¸ä¸è´çåºæ¯ãä½æ¯é®é¢æ¯ï¼å¦ææ¯å¤©çæ¯ä¸äº¿çæµéï¼æ¯ç§å¹¶åè¯»æ¯å ä¸ï¼æ¯ç§åªè¦ææ°æ®æ´æ°çè¯·æ±ï¼å°±å¯è½ä¼åºç°ä¸è¿°çæ°æ®åº+ç¼å­ä¸ä¸è´çæåµã\n\nè§£å³æ¹æ¡å¦ä¸ï¼\n\næ´æ°æ°æ®çæ¶åï¼æ ¹æ®æ°æ®çå¯ä¸æ è¯ï¼å°æä½è·¯ç±ä¹åï¼åéå°ä¸ä¸ª jvm åé¨éåä¸­ãè¯»åæ°æ®çæ¶åï¼å¦æåç°æ°æ®ä¸å¨ç¼å­ä¸­ï¼é£ä¹å°éæ°è¯»åæ°æ®+æ´æ°ç¼å­çæä½ï¼æ ¹æ®å¯ä¸æ è¯è·¯ç±ä¹åï¼ä¹åéåä¸ä¸ª jvm åé¨éåä¸­ã\n\nä¸ä¸ªéåå¯¹åºä¸ä¸ªå·¥ä½çº¿ç¨ï¼æ¯ä¸ªå·¥ä½çº¿ç¨ä¸²è¡æ¿å°å¯¹åºçæä½ï¼ç¶åä¸æ¡ä¸æ¡çæ§è¡ãè¿æ ·çè¯ï¼ä¸ä¸ªæ°æ®åæ´çæä½ï¼åå é¤ç¼å­ï¼ç¶ååå»æ´æ°æ°æ®åºï¼ä½æ¯è¿æ²¡å®ææ´æ°ãæ­¤æ¶å¦æä¸ä¸ªè¯»è¯·æ±è¿æ¥ï¼æ²¡æè¯»å°ç¼å­ï¼é£ä¹å¯ä»¥åå°ç¼å­æ´æ°çè¯·æ±åéå°éåä¸­ï¼æ­¤æ¶ä¼å¨éåä¸­ç§¯åï¼ç¶ååæ­¥ç­å¾ç¼å­æ´æ°å®æã\n\nè¿éæä¸ä¸ªä¼åç¹ï¼ä¸ä¸ªéåä¸­ï¼å¶å®å¤ä¸ªæ´æ°ç¼å­è¯·æ±ä¸²å¨ä¸èµ·æ¯æ²¡æä¹çï¼å æ­¤å¯ä»¥åè¿æ»¤ï¼å¦æåç°éåä¸­å·²ç»æä¸ä¸ªæ´æ°ç¼å­çè¯·æ±äºï¼é£ä¹å°±ä¸ç¨åæ¾ä¸ªæ´æ°è¯·æ±æä½è¿å»äºï¼ç´æ¥ç­å¾åé¢çæ´æ°æä½è¯·æ±å®æå³å¯ã\n\nå¾é£ä¸ªéåå¯¹åºçå·¥ä½çº¿ç¨å®æäºä¸ä¸ä¸ªæä½çæ°æ®åºçä¿®æ¹ä¹åï¼æä¼å»æ§è¡ä¸ä¸ä¸ªæä½ï¼ä¹å°±æ¯ç¼å­æ´æ°çæä½ï¼æ­¤æ¶ä¼ä»æ°æ®åºä¸­è¯»åææ°çå¼ï¼ç¶ååå¥ç¼å­ä¸­ã\n\nå¦æè¯·æ±è¿å¨ç­å¾æ¶é´èå´åï¼ä¸æ­è½®è¯¢åç°å¯ä»¥åå°å¼äºï¼é£ä¹å°±ç´æ¥è¿åï¼å¦æè¯·æ±ç­å¾çæ¶é´è¶è¿ä¸å®æ¶é¿ï¼é£ä¹è¿ä¸æ¬¡ç´æ¥ä»æ°æ®åºä¸­è¯»åå½åçæ§å¼ã\n\né«å¹¶åçåºæ¯ä¸ï¼è¯¥è§£å³æ¹æ¡è¦æ³¨æçé®é¢ï¼\n\n * è¯»è¯·æ±é¿æ¶é»å¡\n\nç±äºè¯»è¯·æ±è¿è¡äºéå¸¸è½»åº¦çå¼æ­¥åï¼æä»¥ä¸å®è¦æ³¨æè¯»è¶æ¶çé®é¢ï¼æ¯ä¸ªè¯»è¯·æ±å¿é¡»å¨è¶æ¶æ¶é´èå´åè¿åã\n\nè¯¥è§£å³æ¹æ¡ï¼æå¤§çé£é©ç¹å¨äºè¯´ï¼å¯è½æ°æ®æ´æ°å¾é¢ç¹ï¼å¯¼è´éåä¸­ç§¯åäºå¤§éæ´æ°æä½å¨éé¢ï¼ç¶åè¯»è¯·æ±ä¼åçå¤§éçè¶æ¶ï¼æåå¯¼è´å¤§éçè¯·æ±ç´æ¥èµ°æ°æ®åºãå¡å¿éè¿ä¸äºæ¨¡æçå®çæµè¯ï¼ççæ´æ°æ°æ®çé¢çæ¯ææ ·çã\n\nå¦å¤ä¸ç¹ï¼å ä¸ºä¸ä¸ªéåä¸­ï¼å¯è½ä¼ç§¯åéå¯¹å¤ä¸ªæ°æ®é¡¹çæ´æ°æä½ï¼å æ­¤éè¦æ ¹æ®èªå·±çä¸å¡æåµè¿è¡æµè¯ï¼å¯è½éè¦é¨ç½²å¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡åæä¸äºæ°æ®çæ´æ°æä½ãå¦æä¸ä¸ªåå­éåéå±ç¶ä¼æ¤å 100 ä¸ªååçåºå­ä¿®æ¹æä½ï¼æ¯éåºå­ä¿®æ¹æä½è¦èè´¹ 10ms å»å®æï¼é£ä¹æåä¸ä¸ªååçè¯»è¯·æ±ï¼å¯è½ç­å¾ 10 * 100 = 1000ms = 1s åï¼æè½å¾å°æ°æ®ï¼è¿ä¸ªæ¶åå°±å¯¼è´è¯»è¯·æ±çé¿æ¶é»å¡ã\n\nä¸å®è¦åæ ¹æ®å®éä¸å¡ç³»ç»çè¿è¡æåµï¼å»è¿è¡ä¸äºååæµè¯ï¼åæ¨¡æçº¿ä¸ç¯å¢ï¼å»ççæç¹å¿çæ¶åï¼åå­éåå¯è½ä¼æ¤åå¤å°æ´æ°æä½ï¼å¯è½ä¼å¯¼è´æåä¸ä¸ªæ´æ°æä½å¯¹åºçè¯»è¯·æ±ï¼ä¼ hang å¤å°æ¶é´ï¼å¦æè¯»è¯·æ±å¨ 200ms è¿åï¼å¦æä½ è®¡ç®è¿åï¼åªææ¯æç¹å¿çæ¶åï¼ç§¯å 10 ä¸ªæ´æ°æä½ï¼æå¤ç­å¾ 200msï¼é£è¿å¯ä»¥çã\n\nå¦æä¸ä¸ªåå­éåä¸­å¯è½ç§¯åçæ´æ°æä½ç¹å«å¤ï¼é£ä¹ä½ å°±è¦å æºå¨ï¼è®©æ¯ä¸ªæºå¨ä¸é¨ç½²çæå¡å®ä¾å¤çæ´å°çæ°æ®ï¼é£ä¹æ¯ä¸ªåå­éåä¸­ç§¯åçæ´æ°æä½å°±ä¼è¶å°ã\n\nå¶å®æ ¹æ®ä¹åçé¡¹ç®ç»éªï¼ä¸è¬æ¥è¯´ï¼æ°æ®çåé¢çæ¯å¾ä½çï¼å æ­¤å®éä¸æ­£å¸¸æ¥è¯´ï¼å¨éåä¸­ç§¯åçæ´æ°æä½åºè¯¥æ¯å¾å°çãåè¿ç§éå¯¹è¯»é«å¹¶åãè¯»ç¼å­æ¶æçé¡¹ç®ï¼ä¸è¬æ¥è¯´åè¯·æ±æ¯éå¸¸å°çï¼æ¯ç§ç qps è½å°å ç¾å°±ä¸éäºã\n\næä»¬æ¥å®éç²ç¥æµç®ä¸ä¸ã\n\nå¦æä¸ç§æ 500 çåæä½ï¼å¦æåæ 5 ä¸ªæ¶é´çï¼æ¯ 200ms å°± 100 ä¸ªåæä½ï¼æ¾å° 20 ä¸ªåå­éåä¸­ï¼æ¯ä¸ªåå­éåï¼å¯è½å°±ç§¯å 5 ä¸ªåæä½ãæ¯ä¸ªåæä½æ§è½æµè¯åï¼ä¸è¬æ¯å¨ 20ms å·¦å³å°±å®æï¼é£ä¹éå¯¹æ¯ä¸ªåå­éåçæ°æ®çè¯»è¯·æ±ï¼ä¹å°±æå¤ hang ä¸ä¼å¿ï¼200ms ä»¥åè¯å®è½è¿åäºã\n\nç»è¿åæç®åçæµç®ï¼æä»¬ç¥éï¼åæºæ¯æçå qps å¨å ç¾æ¯æ²¡é®é¢çï¼å¦æå qps æ©å¤§äº 10 åï¼é£ä¹å°±æ©å®¹æºå¨ï¼æ©å®¹ 10 åçæºå¨ï¼æ¯ä¸ªæºå¨ 20 ä¸ªéåã\n\n * è¯»è¯·æ±å¹¶åéè¿é«\n\nè¿éè¿å¿é¡»åå¥½ååæµè¯ï¼ç¡®ä¿æ°å·§ç¢°ä¸ä¸è¿°æåµçæ¶åï¼è¿æä¸ä¸ªé£é©ï¼å°±æ¯çªç¶é´å¤§éè¯»è¯·æ±ä¼å¨å åæ¯«ç§çå»¶æ¶ hang å¨æå¡ä¸ï¼çæå¡è½ä¸è½æçä½ï¼éè¦å¤å°æºå¨æè½æä½æå¤§çæéæåµçå³°å¼ã\n\nä½æ¯å ä¸ºå¹¶ä¸æ¯ææçæ°æ®é½å¨åä¸æ¶é´æ´æ°ï¼ç¼å­ä¹ä¸ä¼åä¸æ¶é´å¤±æï¼æä»¥æ¯æ¬¡å¯è½ä¹å°±æ¯å°æ°æ°æ®çç¼å­å¤±æäºï¼ç¶åé£äºæ°æ®å¯¹åºçè¯»è¯·æ±è¿æ¥ï¼å¹¶åéåºè¯¥ä¹ä¸ä¼ç¹å«å¤§ã\n\n * å¤æå¡å®ä¾é¨ç½²çè¯·æ±è·¯ç±\n\nå¯è½è¿ä¸ªæå¡é¨ç½²äºå¤ä¸ªå®ä¾ï¼é£ä¹å¿é¡»ä¿è¯è¯´ï¼æ§è¡æ°æ®æ´æ°æä½ï¼ä»¥åæ§è¡ç¼å­æ´æ°æä½çè¯·æ±ï¼é½éè¿ nginx æå¡å¨è·¯ç±å°ç¸åçæå¡å®ä¾ä¸ã\n\næ¯å¦è¯´ï¼å¯¹åä¸ä¸ªååçè¯»åè¯·æ±ï¼å¨é¨è·¯ç±å°åä¸å°æºå¨ä¸ãå¯ä»¥èªå·±å»åæå¡é´çæç§æä¸ªè¯·æ±åæ°ç hash è·¯ç±ï¼ä¹å¯ä»¥ç¨ nginx ç hash è·¯ç±åè½ç­ç­ã\n\n * ç­ç¹ååçè·¯ç±é®é¢ï¼å¯¼è´è¯·æ±çå¾æ\n\nä¸ä¸æä¸ªååçè¯»åè¯·æ±ç¹å«é«ï¼å¨é¨æå°ç¸åçæºå¨çç¸åçéåéé¢å»äºï¼å¯è½ä¼é ææå°æºå¨çååè¿å¤§ãå°±æ¯è¯´ï¼å ä¸ºåªæå¨ååæ°æ®æ´æ°çæ¶åæä¼æ¸ç©ºç¼å­ï¼ç¶åæä¼å¯¼è´è¯»åå¹¶åï¼æä»¥å¶å®è¦æ ¹æ®ä¸å¡ç³»ç»å»çï¼å¦ææ´æ°é¢çä¸æ¯å¤ªé«çè¯ï¼è¿ä¸ªé®é¢çå½±åå¹¶ä¸æ¯ç¹å«å¤§ï¼ä½æ¯çç¡®å¯è½æäºæºå¨çè´è½½ä¼é«ä¸äºã\n\n\n# äºè§£ä»ä¹æ¯ redis çéªå´©ãç©¿éåå»ç©¿ï¼redis å´©æºä¹åä¼æä¹æ ·ï¼ç³»ç»è¯¥å¦ä½åºå¯¹è¿ç§æåµï¼å¦ä½å¤ç redis çç©¿éï¼\n\n\n# ç¼å­éªå´©\n\nå¯¹äºç³»ç» aï¼åè®¾æ¯å¤©é«å³°ææ¯ç§ 5000 ä¸ªè¯·æ±ï¼æ¬æ¥ç¼å­å¨é«å³°æå¯ä»¥æä½æ¯ç§ 4000 ä¸ªè¯·æ±ï¼ä½æ¯ç¼å­æºå¨æå¤åçäºå¨çå®æºãç¼å­æäºï¼æ­¤æ¶ 1 ç§ 5000 ä¸ªè¯·æ±å¨é¨è½æ°æ®åºï¼æ°æ®åºå¿ç¶æä¸ä½ï¼å®ä¼æ¥ä¸ä¸è­¦ï¼ç¶åå°±æäºãæ­¤æ¶ï¼å¦ææ²¡æéç¨ä»ä¹ç¹å«çæ¹æ¡æ¥å¤çè¿ä¸ªæéï¼dba å¾çæ¥ï¼éå¯æ°æ®åºï¼ä½æ¯æ°æ®åºç«é©¬åè¢«æ°çæµéç»ææ­»äºã\n\nè¿å°±æ¯ç¼å­éªå´©ã\n\n\n\nå¤§çº¦å¨ 3 å¹´åï¼å½åæ¯è¾ç¥åçä¸ä¸ªäºèç½å¬å¸ï¼æ¾å ä¸ºç¼å­äºæï¼å¯¼è´éªå´©ï¼åå°ç³»ç»å¨é¨å´©æºï¼äºæä»å½å¤©ä¸åæç»­å°æä¸åæ¨ 3~4 ç¹ï¼å¬å¸æå¤±äºå åä¸ã\n\nç¼å­éªå´©çäºåäºä¸­äºåçè§£å³æ¹æ¡å¦ä¸ã\n\n * äºåï¼redis é«å¯ç¨ï¼ä¸»ä»+å¨åµï¼redis clusterï¼é¿åå¨çå´©æºã\n * äºä¸­ï¼æ¬å° ehcache ç¼å­ + hystrix éæµ&éçº§ï¼é¿å mysql è¢«ææ­»ã\n * äºåï¼redis æä¹åï¼ä¸æ¦éå¯ï¼èªå¨ä»ç£çä¸å è½½æ°æ®ï¼å¿«éæ¢å¤ç¼å­æ°æ®ã\n\n\n\nç¨æ·åéä¸ä¸ªè¯·æ±ï¼ç³»ç» a æ¶å°è¯·æ±åï¼åæ¥æ¬å° ehcache ç¼å­ï¼å¦ææ²¡æ¥å°åæ¥ redisãå¦æ ehcache å redis é½æ²¡æï¼åæ¥æ°æ®åºï¼å°æ°æ®åºä¸­çç»æï¼åå¥ ehcache å redis ä¸­ã\n\néæµç»ä»¶ï¼å¯ä»¥è®¾ç½®æ¯ç§çè¯·æ±ï¼æå¤å°è½éè¿ç»ä»¶ï¼å©ä½çæªéè¿çè¯·æ±ï¼æä¹åï¼èµ°éçº§ï¼å¯ä»¥è¿åä¸äºé»è®¤çå¼ï¼æèåææç¤ºï¼æèç©ºç½çå¼ã\n\nå¥½å¤ï¼\n\n * æ°æ®åºç»å¯¹ä¸ä¼æ­»ï¼éæµç»ä»¶ç¡®ä¿äºæ¯ç§åªæå¤å°ä¸ªè¯·æ±è½éè¿ã\n * åªè¦æ°æ®åºä¸æ­»ï¼å°±æ¯è¯´ï¼å¯¹ç¨æ·æ¥è¯´ï¼2/5 çè¯·æ±é½æ¯å¯ä»¥è¢«å¤ççã\n * åªè¦æ 2/5 çè¯·æ±å¯ä»¥è¢«å¤çï¼å°±æå³çä½ çç³»ç»æ²¡æ­»ï¼å¯¹ç¨æ·æ¥è¯´ï¼å¯è½å°±æ¯ç¹å»å æ¬¡å·ä¸åºæ¥é¡µé¢ï¼ä½æ¯å¤ç¹å æ¬¡ï¼å°±å¯ä»¥å·åºæ¥ä¸æ¬¡ã\n\n\n# ç¼å­ç©¿é\n\nå¯¹äºç³»ç» aï¼åè®¾ä¸ç§ 5000 ä¸ªè¯·æ±ï¼ç»æå¶ä¸­ 4000 ä¸ªè¯·æ±æ¯é»å®¢ååºçæ¶ææ»å»ã\n\né»å®¢ååºçé£ 4000 ä¸ªæ»å»ï¼ç¼å­ä¸­æ¥ä¸å°ï¼æ¯æ¬¡ä½ å»æ°æ®åºéæ¥ï¼ä¹æ¥ä¸å°ã\n\nä¸¾ä¸ªæ å­ãæ°æ®åº id æ¯ä» 1 å¼å§çï¼ç»æé»å®¢åè¿æ¥çè¯·æ± id å¨é¨é½æ¯è´æ°ãè¿æ ·çè¯ï¼ç¼å­ä¸­ä¸ä¼æï¼è¯·æ±æ¯æ¬¡é½âè§ç¼å­äºæ ç©âï¼ç´æ¥æ¥è¯¢æ°æ®åºãè¿ç§æ¶ææ»å»åºæ¯çç¼å­ç©¿éå°±ä¼ç´æ¥ææ°æ®åºç»ææ­»ã\n\n\n\nè§£å³æ¹å¼å¾ç®åï¼æ¯æ¬¡ç³»ç» a ä»æ°æ®åºä¸­åªè¦æ²¡æ¥å°ï¼å°±åä¸ä¸ªç©ºå¼å°ç¼å­éå»ï¼æ¯å¦ set -999 unknownãç¶åè®¾ç½®ä¸ä¸ªè¿ææ¶é´ï¼è¿æ ·çè¯ï¼ä¸æ¬¡æç¸åç key æ¥è®¿é®çæ¶åï¼å¨ç¼å­å¤±æä¹åï¼é½å¯ä»¥ç´æ¥ä»ç¼å­ä¸­åæ°æ®ã\n\n\n# ç¼å­å»ç©¿\n\nç¼å­å»ç©¿ï¼å°±æ¯è¯´æä¸ª key éå¸¸ç­ç¹ï¼è®¿é®éå¸¸é¢ç¹ï¼å¤äºéä¸­å¼é«å¹¶åè®¿é®çæåµï¼å½è¿ä¸ª key å¨å¤±æçç¬é´ï¼å¤§éçè¯·æ±å°±å»ç©¿äºç¼å­ï¼ç´æ¥è¯·æ±æ°æ®åºï¼å°±åæ¯å¨ä¸éå±éä¸å¿å¼äºä¸ä¸ªæ´ã\n\nè§£å³æ¹å¼ä¹å¾ç®åï¼å¯ä»¥å°ç­ç¹æ°æ®è®¾ç½®ä¸ºæ°¸è¿ä¸è¿æï¼æèåºäº redis or zookeeper å®ç°äºæ¥éï¼ç­å¾ç¬¬ä¸ä¸ªè¯·æ±æå»ºå®ç¼å­ä¹åï¼åéæ¾éï¼è¿èå¶å®è¯·æ±æè½éè¿è¯¥ key è®¿é®æ°æ®ã\n\n\n# redis çå¹¶åç«äºé®é¢æ¯ä»ä¹ï¼å¦ä½è§£å³è¿ä¸ªé®é¢ï¼äºè§£ redis äºå¡ç cas æ¹æ¡åï¼\n\næä¸ªæ¶å»ï¼å¤ä¸ªç³»ç»å®ä¾é½å»æ´æ°æä¸ª keyãå¯ä»¥åºäº zookeeper å®ç°åå¸å¼éãæ¯ä¸ªç³»ç»éè¿ zookeeper è·ååå¸å¼éï¼ç¡®ä¿åä¸æ¶é´ï¼åªè½æä¸ä¸ªç³»ç»å®ä¾å¨æä½æä¸ª keyï¼å«äººé½ä¸åè®¸è¯»ååã\n\n\n\nä½ è¦åå¥ç¼å­çæ°æ®ï¼é½æ¯ä» mysql éæ¥åºæ¥çï¼é½å¾åå¥ mysql ä¸­ï¼åå¥ mysql ä¸­çæ¶åå¿é¡»ä¿å­ä¸ä¸ªæ¶é´æ³ï¼ä» mysql æ¥åºæ¥çæ¶åï¼æ¶é´æ³ä¹æ¥åºæ¥ã\n\næ¯æ¬¡è¦åä¹åï¼åå¤æ­ä¸ä¸å½åè¿ä¸ª value çæ¶é´æ³æ¯å¦æ¯ç¼å­éç value çæ¶é´æ³è¦æ°ãå¦ææ¯çè¯ï¼é£ä¹å¯ä»¥åï¼å¦åï¼å°±ä¸è½ç¨æ§çæ°æ®è¦çæ°çæ°æ®ã\n\n\n# çäº§ç¯å¢ä¸­ç redis æ¯æä¹é¨ç½²çï¼\n\nredis clusterï¼10 å°æºå¨ï¼5 å°æºå¨é¨ç½²äº redis ä¸»å®ä¾ï¼å¦å¤ 5 å°æºå¨é¨ç½²äº redis çä»å®ä¾ï¼æ¯ä¸ªä¸»å®ä¾æäºä¸ä¸ªä»å®ä¾ï¼5 ä¸ªèç¹å¯¹å¤æä¾è¯»åæå¡ï¼æ¯ä¸ªèç¹çè¯»åé«å³° qps å¯è½å¯ä»¥è¾¾å°æ¯ç§ 5 ä¸ï¼5 å°æºå¨æå¤æ¯ 25 ä¸è¯»åè¯·æ±/sã\n\næºå¨æ¯ä»ä¹éç½®ï¼32g åå­+ 8 æ ¸ cpu + 1t ç£çï¼ä½æ¯åéç» redis è¿ç¨çæ¯ 10g åå­ï¼ä¸è¬çº¿ä¸çäº§ç¯å¢ï¼redis çåå­å°½éä¸è¦è¶è¿ 10gï¼è¶è¿ 10g å¯è½ä¼æé®é¢ã\n\n5 å°æºå¨å¯¹å¤æä¾è¯»åï¼ä¸å±æ 50g åå­ã\n\nå ä¸ºæ¯ä¸ªä¸»å®ä¾é½æäºä¸ä¸ªä»å®ä¾ï¼æä»¥æ¯é«å¯ç¨çï¼ä»»ä½ä¸ä¸ªä¸»å®ä¾å®æºï¼é½ä¼èªå¨æéè¿ç§»ï¼redis ä»å®ä¾ä¼èªå¨åæä¸»å®ä¾ç»§ç»­æä¾è¯»åæå¡ã\n\nä½ å¾åå­éåçæ¯ä»ä¹æ°æ®ï¼æ¯æ¡æ°æ®çå¤§å°æ¯å¤å°ï¼ååæ°æ®ï¼æ¯æ¡æ°æ®æ¯ 10kbã100 æ¡æ°æ®æ¯ 1mbï¼10 ä¸æ¡æ°æ®æ¯ 1gãå¸¸é©»åå­çæ¯ 200 ä¸æ¡ååæ°æ®ï¼å ç¨åå­æ¯ 20gï¼ä»ä»ä¸å°æ»åå­ç 50%ãç®åé«å³°ææ¯ç§å°±æ¯ 3500 å·¦å³çè¯·æ±éã\n\nå¶å®å¤§åçå¬å¸ï¼ä¼æåºç¡æ¶æç team è´è´£ç¼å­éç¾¤çè¿ç»´ã',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java ç¼å­ä¸­é´ä»¶",frontmatter:{title:"Java ç¼å­ä¸­é´ä»¶",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["Java","ä¸­é´ä»¶","ç¼å­"],abbrlink:"e87a26e9",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/970fa6/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/02.Java%E7%BC%93%E5%AD%98%E4%B8%AD%E9%97%B4%E4%BB%B6.html",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/02.Javaç¼å­ä¸­é´ä»¶.md",key:"v-47099c49",path:"/pages/970fa6/",headers:[{level:2,title:"ä¸ ãJSR 107",slug:"ä¸-ãjsr-107",normalizedTitle:"ä¸ ãjsr 107",charIndex:54},{level:2,title:"äºãSpring Cache",slug:"äºãspring-cache",normalizedTitle:"äºãspring cache",charIndex:608},{level:3,title:"å¼å¯ç¼å­æ³¨è§£",slug:"å¼å¯ç¼å­æ³¨è§£",normalizedTitle:"å¼å¯ç¼å­æ³¨è§£",charIndex:936},{level:3,title:"spring ç¼å­æ³¨è§£ API",slug:"spring-ç¼å­æ³¨è§£-api",normalizedTitle:"spring ç¼å­æ³¨è§£ api",charIndex:1180},{level:4,title:"@Cacheable",slug:"cacheable",normalizedTitle:"@cacheable",charIndex:1293},{level:4,title:"@CachePut",slug:"cacheput",normalizedTitle:"@cacheput",charIndex:1482},{level:4,title:"@CacheEvict",slug:"cacheevict",normalizedTitle:"@cacheevict",charIndex:1587},{level:4,title:"@Caching",slug:"caching",normalizedTitle:"@caching",charIndex:2483},{level:4,title:"@CacheConfig",slug:"cacheconfig",normalizedTitle:"@cacheconfig",charIndex:2737},{level:2,title:"ä¸ãSpring Boot Cache",slug:"ä¸ãspring-boot-cache",normalizedTitle:"ä¸ãspring boot cache",charIndex:2987},{level:3,title:"Spring Boot Cache å¿«éå¥é¨",slug:"spring-boot-cache-å¿«éå¥é¨",normalizedTitle:"spring boot cache å¿«éå¥é¨",charIndex:3096},{level:2,title:"åãJetCache",slug:"åãjetcache",normalizedTitle:"åãjetcache",charIndex:3926},{level:3,title:"jetcache å¿«éå¥é¨",slug:"jetcache-å¿«éå¥é¨",normalizedTitle:"jetcache å¿«éå¥é¨",charIndex:4221},{level:2,title:"äºãj2cache",slug:"äºãj2cache",normalizedTitle:"äºãj2cache",charIndex:6371},{level:2,title:"å­ãæ»ç»",slug:"å­ãæ»ç»",normalizedTitle:"å­ãæ»ç»",charIndex:6385},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:6542}],headersStr:"ä¸ ãJSR 107 äºãSpring Cache å¼å¯ç¼å­æ³¨è§£ spring ç¼å­æ³¨è§£ API @Cacheable @CachePut @CacheEvict @Caching @CacheConfig ä¸ãSpring Boot Cache Spring Boot Cache å¿«éå¥é¨ åãJetCache jetcache å¿«éå¥é¨ äºãj2cache å­ãæ»ç» åèèµæ",content:'# Java ç¼å­ä¸­é´ä»¶\n\n> å³é®è¯ï¼Spring CacheãJ2CacheãJetCache\n\n\n# ä¸ ãJSR 107\n\nJSR107 ä¸­å¶è®¢äº Java ç¼å­çè§èã\n\nå æ­¤ï¼å¨å¾å¤ç¼å­æ¡æ¶ãç¼å­åºä¸­ï¼å¶ API é½åèäº JSR 107 è§èã\n\n\n\nJava Caching å®ä¹äº 5 ä¸ªæ ¸å¿æ¥å£\n\n * CachingProvider - å®ä¹äºåå»ºãéç½®ãè·åãç®¡çåæ§å¶å¤ä¸ª CacheManagerãä¸ä¸ªåºç¨å¯ä»¥å¨è¿è¡æè®¿é®å¤ä¸ª CachingProviderã\n * CacheManager - å®ä¹äºåå»ºãéç½®ãè·åãç®¡çåæ§å¶å¤ä¸ªå¯ä¸å½åç Cacheï¼è¿äº Cache å­å¨äº CacheManager çä¸ä¸æä¸­ãä¸ä¸ª CacheManager ä»è¢«ä¸ä¸ª CachingProvider ææ¥æã\n * Cache - æ¯ä¸ä¸ªç±»ä¼¼ Map çæ°æ®ç»æå¹¶ä¸´æ¶å­å¨ä»¥ Key ä¸ºç´¢å¼çå¼ãä¸ä¸ª Cache ä»è¢«ä¸ä¸ª CacheManager ææ¥æã\n * Entry - æ¯ä¸ä¸ªå­å¨å¨ Cache ä¸­ç key-value å¯¹ã\n * Expiry - æ¯ä¸ä¸ªå­å¨å¨ Cache ä¸­çæ¡ç®æä¸ä¸ªå®ä¹çæææï¼å³ Expiry Durationãä¸æ¦è¶è¿è¿ä¸ªæ¶é´ï¼æ¡ç®ä¸ºè¿æçç¶æãä¸æ¦è¿æï¼æ¡ç®å°ä¸å¯è®¿é®ãæ´æ°åå é¤ãç¼å­æææå¯ä»¥éè¿ ExpiryPolicy è®¾ç½®ã\n\n\n# äºãSpring Cache\n\n> è¯¦è§ï¼Spring Cache å®æ¹ææ¡£\n\nSpring ä½ä¸º Java å¼åæèåçæ¡æ¶ï¼ä¹æä¾äºç¼å­åè½çæ¡æ¶ââ Spring Cacheã\n\nSpring æ¯æåºäºæ³¨éï¼annotationï¼çç¼å­ï¼cacheï¼ææ¯ï¼å®æ¬è´¨ä¸ä¸æ¯ä¸ä¸ªå·ä½çç¼å­å®ç°æ¹æ¡ï¼ä¾å¦ï¼EHCache æ OSCacheï¼ï¼èæ¯ä¸ä¸ªå¯¹ç¼å­ä½¿ç¨çæ½è±¡ï¼éè¿å¨æ¢æä»£ç ä¸­æ·»å å°éå®å®ä¹çåç§ annotationï¼å³è½å¤è¾¾å°ç¼å­æ¹æ³çè¿åå¯¹è±¡çææã\n\nSpring Cache çç¹ç¹ï¼\n\n * éè¿ç¼å­æ³¨è§£å³å¯æ¯æç¼å­åè½\n * æ¯æ Spring EL è¡¨è¾¾å¼\n * æ¯æ AspectJ\n * æ¯æèªå®ä¹ key åç¼å­ç®¡ç\n\n\n# å¼å¯ç¼å­æ³¨è§£\n\nSpring ä¸ºç¼å­åè½æä¾äºæ³¨è§£åè½ï¼ä½æ¯ä½ å¿é¡»å¯å¨æ³¨è§£ã\n\næä¸¤ç§æ¹å¼ï¼\n\nï¼ä¸ï¼ä½¿ç¨æ è®°æ³¨è§£ @EnableCaching\n\nè¿ç§æ¹å¼å¯¹äº Spring æ Spring Boot é¡¹ç®é½éç¨ã\n\n@Configuration\n@EnableCaching\npublic class AppConfig {\n}\n\n\nï¼äºï¼å¨ xml ä¸­å£°æ\n\n<cache:annotation-driven cache-manager="cacheManager"/>\n\n\n\n# spring ç¼å­æ³¨è§£ API\n\nSpring å¯¹ç¼å­çæ¯æç±»ä¼¼äºå¯¹äºå¡çæ¯æã\n\né¦åä½¿ç¨æ³¨è§£æ è®°æ¹æ³ï¼ç¸å½äºå®ä¹äºåç¹ï¼ç¶åä½¿ç¨ Aop ææ¯å¨è¿ä¸ªæ¹æ³çè°ç¨åãè°ç¨åè·åæ¹æ³çå¥ååè¿åå¼ï¼è¿èå®ç°äºç¼å­çé»è¾ã\n\n# @Cacheable\n\n@Cacheable ç¨äºè§¦åç¼å­ã\n\nè¡¨ææä¿®é¥°çæ¹æ³æ¯å¯ä»¥ç¼å­çï¼å½ç¬¬ä¸æ¬¡è°ç¨è¿ä¸ªæ¹æ³æ¶ï¼å®çç»æä¼è¢«ç¼å­ä¸æ¥ï¼å¨ç¼å­çæææ¶é´åï¼ä»¥åè®¿é®è¿ä¸ªæ¹æ³é½ç´æ¥è¿åç¼å­ç»æï¼ä¸åæ§è¡æ¹æ³ä¸­çä»£ç æ®µã\n\nè¿ä¸ªæ³¨è§£å¯ä»¥ç¨conditionå±æ§æ¥è®¾ç½®æ¡ä»¶ï¼å¦æä¸æ»¡è¶³æ¡ä»¶ï¼å°±ä¸ä½¿ç¨ç¼å­è½åï¼ç´æ¥æ§è¡æ¹æ³ã\n\nå¯ä»¥ä½¿ç¨keyå±æ§æ¥æå® key ççæè§åã\n\n# @CachePut\n\n@CachePut ç¨äºæ´æ°ç¼å­ã\n\nä¸@Cacheableä¸åï¼@CachePutä¸ä»ä¼ç¼å­æ¹æ³çç»æï¼è¿ä¼æ§è¡æ¹æ³çä»£ç æ®µã\n\nå®æ¯æçå±æ§åç¨æ³é½ä¸@Cacheableä¸è´ã\n\n# @CacheEvict\n\n@CacheEvict ç¨äºæ¸é¤ç¼å­ã\n\nä¸@Cacheableåè½ç¸åï¼@CacheEvictè¡¨ææä¿®é¥°çæ¹æ³æ¯ç¨æ¥å é¤å¤±æææ ç¨çç¼å­æ°æ®ã\n\nä¸é¢æ¯@Cacheableã@CacheEvictå@CachePutåºæ¬ä½¿ç¨æ¹æ³çä¸ä¸ªéä¸­å±ç¤ºï¼\n\n@Service\npublic class UserService {\n    // @Cacheableå¯ä»¥è®¾ç½®å¤ä¸ªç¼å­ï¼å½¢å¼å¦ï¼@Cacheable({"books", "isbns"})\n    @Cacheable(value={"users"}, key="#user.id")\n    public User findUser(User user) {\n        return findUserInDB(user.getId());\n    }\n\n    @Cacheable(value = "users", condition = "#user.getId() <= 2")\n    public User findUserInLimit(User user) {\n        return findUserInDB(user.getId());\n    }\n\n    @CachePut(value = "users", key = "#user.getId()")\n    public void updateUser(User user) {\n        updateUserInDB(user);\n    }\n\n    @CacheEvict(value = "users")\n    public void removeUser(User user) {\n        removeUserInDB(user.getId());\n    }\n\n    @CacheEvict(value = "users", allEntries = true)\n    public void clear() {\n        removeAllInDB();\n    }\n}\n\n\n# @Caching\n\n@Caching ç¨äºç»åå®ä¹å¤ç§ç¼å­åè½ã\n\nå¦æéè¦ä½¿ç¨åä¸ä¸ªç¼å­æ³¨è§£ï¼@Cacheableã@CacheEvictæ@CachePutï¼å¤æ¬¡ä¿®é¥°ä¸ä¸ªæ¹æ³ï¼å°±éè¦ç¨å°@Cachingã\n\n@Caching(evict = { @CacheEvict("primary"), @CacheEvict(cacheNames="secondary", key="#p0") })\npublic Book importBooks(String deposit, Date date)\n\n\n# @CacheConfig\n\n@CacheConfig ç¨äºå®ä¹å¬å±ç¼å­éç½®ã\n\nä¸åé¢çç¼å­æ³¨è§£ä¸åï¼è¿æ¯ä¸ä¸ªç±»çº§å«çæ³¨è§£ã\n\nå¦æç±»çæææä½é½æ¯ç¼å­æä½ï¼ä½ å¯ä»¥ä½¿ç¨@CacheConfigæ¥æå®ç±»ï¼çå»ä¸äºéç½®ã\n\n@CacheConfig("books")\npublic class BookRepositoryImpl implements BookRepository {\n @Cacheable\n public Book findBook(ISBN isbn) {...}\n}\n\n\n\n# ä¸ãSpring Boot Cache\n\n> è¯¦è§ï¼Spring Boot Cache ç¹æ§å®æ¹ææ¡£\n\nSpring Boot Cache æ¯å¨ Spring Cache çåºç¡ä¸åäºå°è£ï¼ä½¿å¾ä½¿ç¨æ´ä¸ºä¾¿æ·ã\n\n\n# Spring Boot Cache å¿«éå¥é¨\n\nï¼1ï¼å¼å¥ä¾èµ\n\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-cache</artifactId>\n</dependency>\n\n\x3c!-- æåºå¼å¥éè¦çç¼å­åº --\x3e\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n\n\nï¼2ï¼ç¼å­éç½®\n\nä¾å¦ï¼éç¨ç¼å­ä¸º redisï¼åéè¦éç½® redis ç¸å³çéç½®é¡¹ï¼å¦ï¼æ°æ®æºãè¿æ¥æ± ç­éç½®ä¿¡æ¯ï¼\n\n# ç¼å­ç±»åï¼æ¯æç±»åï¼GENERICãJCACHEãEHCACHEãHAZELCASTãINFINISPANãCOUCHBASEãREDISãCAFFEINEãSIMPLE\nspring.cache.type = redis\n# å¨å±ç¼å­æ¶é´\nspring.cache.redis.time-to-live = 60s\n\n# Redis éç½®\nspring.redis.database = 0\nspring.redis.host = localhost\nspring.redis.port = 6379\nspring.redis.password =\n\n\nï¼3ï¼ä½¿ç¨ @EnableCaching å¼å¯ç¼å­\n\n@EnableCaching\n@SpringBootApplication\npublic class Application {\n    // ...\n}\n\n\nï¼4ï¼ç¼å­æ³¨è§£ï¼@Cacheableã@CachePutã@CacheEvit ç­ï¼ä½¿ç¨æ¹å¼ä¸ Spring Cache å®å¨ä¸æ ·\n\n\n# åãJetCache\n\n> JetCache æ¯ä¸ä¸ªåºäº Java çç¼å­ç³»ç»å°è£ï¼æä¾ç»ä¸ç API åæ³¨è§£æ¥ç®åç¼å­çä½¿ç¨ã JetCache æä¾äºæ¯ SpringCache æ´å å¼ºå¤§çæ³¨è§£ï¼å¯ä»¥åççæ¯æ TTLãä¸¤çº§ç¼å­ãåå¸å¼èªå¨å·æ°ï¼è¿æä¾äºCacheæ¥å£ç¨äºæå·¥ç¼å­æä½ã å½åæåä¸ªå®ç°ï¼RedisCacheãTairCacheï¼æ­¤é¨åæªå¨ github å¼æºï¼ãCaffeineCache(in memory)åä¸ä¸ªç®æçLinkedHashMapCache(in memory)ï¼è¦æ·»å æ°çå®ç°ä¹æ¯éå¸¸ç®åçã\n> \n> è¯¦è§ï¼jetcache Github\n\n\n# jetcache å¿«éå¥é¨\n\nå¦æä½¿ç¨ Spring Bootï¼å¯ä»¥æå¦ä¸çæ¹å¼éç½®ï¼è¿éä½¿ç¨äº jedis å®¢æ·ç«¯è¿æ¥ redisï¼å¦æéè¦éç¾¤ãè¯»ååç¦»ãå¼æ­¥ç­ç¹æ§æ¯æè¯·ä½¿ç¨lettuceå®¢æ·ç«¯ï¼ã\n\nï¼1ï¼å¼å¥ POM\n\n<dependency>\n    <groupId>com.alicp.jetcache</groupId>\n    <artifactId>jetcache-starter-redis</artifactId>\n    <version>2.5.14</version>\n</dependency>\n\n\nï¼2ï¼éç½®\n\néç½®ä¸ä¸ª spring boot é£æ ¼ç application.yml æä»¶ï¼æä»æ¾å°èµæºç®å½ä¸­\n\njetcache:\n  statIntervalMinutes: 15\n  areaInCacheName: false\n  local:\n    default:\n      type: linkedhashmap\n      keyConvertor: fastjson\n  remote:\n    default:\n      type: redis\n      keyConvertor: fastjson\n      valueEncoder: java\n      valueDecoder: java\n      poolConfig:\n        minIdle: 5\n        maxIdle: 20\n        maxTotal: 50\n      host: 127.0.0.1\n      port: 6379\n\n\nï¼3ï¼å¼å¯ç¼å­\n\nç¶ååå»ºä¸ä¸ª App ç±»æ¾å¨ä¸å¡åçæ ¹ä¸ï¼EnableMethodCacheï¼EnableCreateCacheAnnotation è¿ä¸¤ä¸ªæ³¨è§£åå«æ¿æ´» Cached å CreateCache æ³¨è§£ï¼å¶ä»åæ åç Spring Boot ç¨åºæ¯ä¸æ ·çãè¿ä¸ªç±»å¯ä»¥ç´æ¥ main æ¹æ³è¿è¡ã\n\npackage com.company.mypackage;\n\nimport com.alicp.jetcache.anno.config.EnableCreateCacheAnnotation;\nimport com.alicp.jetcache.anno.config.EnableMethodCache;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\n@EnableMethodCache(basePackages = "com.company.mypackage")\n@EnableCreateCacheAnnotation\npublic class MySpringBootApp {\n    public static void main(String[] args) {\n        SpringApplication.run(MySpringBootApp.class);\n    }\n}\n\n\nï¼4ï¼API åºæ¬ä½¿ç¨\n\nåå»ºç¼å­å®ä¾\n\néè¿ @CreateCache æ³¨è§£åå»ºä¸ä¸ªç¼å­å®ä¾ï¼é»è®¤è¶æ¶æ¶é´æ¯ 100 ç§\n\n@CreateCache(expire = 100)\nprivate Cache<Long, UserDO> userCache;\n\n\nç¨èµ·æ¥å°±å map ä¸æ ·\n\nUserDO user = userCache.get(123L);\nuserCache.put(123L, user);\nuserCache.remove(123L);\n\n\nåå»ºä¸ä¸ªä¸¤çº§ï¼åå­+è¿ç¨ï¼çç¼å­ï¼åå­ä¸­çåç´ ä¸ªæ°éå¶å¨ 50 ä¸ªã\n\n@CreateCache(name = "UserService.userCache", expire = 100, cacheType = CacheType.BOTH, localLimit = 50)\nprivate Cache<Long, UserDO> userCache;\n\n\nname å±æ§ä¸æ¯å¿é¡»çï¼ä½æ¯èµ·ä¸ªåå­æ¯ä¸ªå¥½ä¹ æ¯ï¼å±ç¤ºç»è®¡æ°æ®çä½¿ç¨ï¼ä¼ä½¿ç¨è¿ä¸ªåå­ãå¦æåä¸ä¸ª area ä¸¤ä¸ª @CreateCache ç name éç½®ä¸æ ·ï¼å®ä»¬çæç Cache å°æååä¸ä¸ªå®ä¾ã\n\nåå»ºæ¹æ³ç¼å­\n\nä½¿ç¨ @Cached æ¹æ³å¯ä»¥ä¸ºä¸ä¸ªæ¹æ³æ·»å ä¸ç¼å­ãJetCache éè¿ Spring AOP çæä»£çï¼æ¥æ¯æç¼å­åè½ãæ³¨è§£å¯ä»¥å å¨æ¥å£æ¹æ³ä¸ä¹å¯ä»¥å å¨ç±»æ¹æ³ä¸ï¼ä½éè¦ä¿è¯æ¯ä¸ª Spring beanã\n\npublic interface UserService {\n    @Cached(name="UserService.getUserById", expire = 3600)\n    User getUserById(long userId);\n}\n\n\n\n# äºãj2cache\n\n\n# å­ãæ»ç»\n\nä½¿ç¨ç¼å­æ¡æ¶ï¼ä½¿å¾å¼åç¼å­åè½éå¸¸ä¾¿æ·ã\n\nå¦æä½ çç³»ç»åªéè¦ä½¿ç¨ä¸ç§ç¼å­ï¼é£ä¹æ¨èä½¿ç¨ Spring Boot CacheãSpring Boot Cache å¨ Spring Cache åºç¡ä¸åäºå°è£ï¼ä½¿ç¨æ´ç®åãæ¹ä¾¿ã\n\nå¦æä½ çç³»ç»éè¦ä½¿ç¨å¤çº§ç¼å­ï¼é£ä¹æ¨èä½¿ç¨ jetcacheã\n\n\n# åèèµæ\n\n * JSR107\n * Spring Cache å®æ¹ææ¡£\n * Spring Boot Cache ç¹æ§å®æ¹ææ¡£\n * J2Cache Gitee\n * jetcache Github\n * jetcache wiki',normalizedContent:'# java ç¼å­ä¸­é´ä»¶\n\n> å³é®è¯ï¼spring cacheãj2cacheãjetcache\n\n\n# ä¸ ãjsr 107\n\njsr107 ä¸­å¶è®¢äº java ç¼å­çè§èã\n\nå æ­¤ï¼å¨å¾å¤ç¼å­æ¡æ¶ãç¼å­åºä¸­ï¼å¶ api é½åèäº jsr 107 è§èã\n\n\n\njava caching å®ä¹äº 5 ä¸ªæ ¸å¿æ¥å£\n\n * cachingprovider - å®ä¹äºåå»ºãéç½®ãè·åãç®¡çåæ§å¶å¤ä¸ª cachemanagerãä¸ä¸ªåºç¨å¯ä»¥å¨è¿è¡æè®¿é®å¤ä¸ª cachingproviderã\n * cachemanager - å®ä¹äºåå»ºãéç½®ãè·åãç®¡çåæ§å¶å¤ä¸ªå¯ä¸å½åç cacheï¼è¿äº cache å­å¨äº cachemanager çä¸ä¸æä¸­ãä¸ä¸ª cachemanager ä»è¢«ä¸ä¸ª cachingprovider ææ¥æã\n * cache - æ¯ä¸ä¸ªç±»ä¼¼ map çæ°æ®ç»æå¹¶ä¸´æ¶å­å¨ä»¥ key ä¸ºç´¢å¼çå¼ãä¸ä¸ª cache ä»è¢«ä¸ä¸ª cachemanager ææ¥æã\n * entry - æ¯ä¸ä¸ªå­å¨å¨ cache ä¸­ç key-value å¯¹ã\n * expiry - æ¯ä¸ä¸ªå­å¨å¨ cache ä¸­çæ¡ç®æä¸ä¸ªå®ä¹çæææï¼å³ expiry durationãä¸æ¦è¶è¿è¿ä¸ªæ¶é´ï¼æ¡ç®ä¸ºè¿æçç¶æãä¸æ¦è¿æï¼æ¡ç®å°ä¸å¯è®¿é®ãæ´æ°åå é¤ãç¼å­æææå¯ä»¥éè¿ expirypolicy è®¾ç½®ã\n\n\n# äºãspring cache\n\n> è¯¦è§ï¼spring cache å®æ¹ææ¡£\n\nspring ä½ä¸º java å¼åæèåçæ¡æ¶ï¼ä¹æä¾äºç¼å­åè½çæ¡æ¶ââ spring cacheã\n\nspring æ¯æåºäºæ³¨éï¼annotationï¼çç¼å­ï¼cacheï¼ææ¯ï¼å®æ¬è´¨ä¸ä¸æ¯ä¸ä¸ªå·ä½çç¼å­å®ç°æ¹æ¡ï¼ä¾å¦ï¼ehcache æ oscacheï¼ï¼èæ¯ä¸ä¸ªå¯¹ç¼å­ä½¿ç¨çæ½è±¡ï¼éè¿å¨æ¢æä»£ç ä¸­æ·»å å°éå®å®ä¹çåç§ annotationï¼å³è½å¤è¾¾å°ç¼å­æ¹æ³çè¿åå¯¹è±¡çææã\n\nspring cache çç¹ç¹ï¼\n\n * éè¿ç¼å­æ³¨è§£å³å¯æ¯æç¼å­åè½\n * æ¯æ spring el è¡¨è¾¾å¼\n * æ¯æ aspectj\n * æ¯æèªå®ä¹ key åç¼å­ç®¡ç\n\n\n# å¼å¯ç¼å­æ³¨è§£\n\nspring ä¸ºç¼å­åè½æä¾äºæ³¨è§£åè½ï¼ä½æ¯ä½ å¿é¡»å¯å¨æ³¨è§£ã\n\næä¸¤ç§æ¹å¼ï¼\n\nï¼ä¸ï¼ä½¿ç¨æ è®°æ³¨è§£ @enablecaching\n\nè¿ç§æ¹å¼å¯¹äº spring æ spring boot é¡¹ç®é½éç¨ã\n\n@configuration\n@enablecaching\npublic class appconfig {\n}\n\n\nï¼äºï¼å¨ xml ä¸­å£°æ\n\n<cache:annotation-driven cache-manager="cachemanager"/>\n\n\n\n# spring ç¼å­æ³¨è§£ api\n\nspring å¯¹ç¼å­çæ¯æç±»ä¼¼äºå¯¹äºå¡çæ¯æã\n\né¦åä½¿ç¨æ³¨è§£æ è®°æ¹æ³ï¼ç¸å½äºå®ä¹äºåç¹ï¼ç¶åä½¿ç¨ aop ææ¯å¨è¿ä¸ªæ¹æ³çè°ç¨åãè°ç¨åè·åæ¹æ³çå¥ååè¿åå¼ï¼è¿èå®ç°äºç¼å­çé»è¾ã\n\n# @cacheable\n\n@cacheable ç¨äºè§¦åç¼å­ã\n\nè¡¨ææä¿®é¥°çæ¹æ³æ¯å¯ä»¥ç¼å­çï¼å½ç¬¬ä¸æ¬¡è°ç¨è¿ä¸ªæ¹æ³æ¶ï¼å®çç»æä¼è¢«ç¼å­ä¸æ¥ï¼å¨ç¼å­çæææ¶é´åï¼ä»¥åè®¿é®è¿ä¸ªæ¹æ³é½ç´æ¥è¿åç¼å­ç»æï¼ä¸åæ§è¡æ¹æ³ä¸­çä»£ç æ®µã\n\nè¿ä¸ªæ³¨è§£å¯ä»¥ç¨conditionå±æ§æ¥è®¾ç½®æ¡ä»¶ï¼å¦æä¸æ»¡è¶³æ¡ä»¶ï¼å°±ä¸ä½¿ç¨ç¼å­è½åï¼ç´æ¥æ§è¡æ¹æ³ã\n\nå¯ä»¥ä½¿ç¨keyå±æ§æ¥æå® key ççæè§åã\n\n# @cacheput\n\n@cacheput ç¨äºæ´æ°ç¼å­ã\n\nä¸@cacheableä¸åï¼@cacheputä¸ä»ä¼ç¼å­æ¹æ³çç»æï¼è¿ä¼æ§è¡æ¹æ³çä»£ç æ®µã\n\nå®æ¯æçå±æ§åç¨æ³é½ä¸@cacheableä¸è´ã\n\n# @cacheevict\n\n@cacheevict ç¨äºæ¸é¤ç¼å­ã\n\nä¸@cacheableåè½ç¸åï¼@cacheevictè¡¨ææä¿®é¥°çæ¹æ³æ¯ç¨æ¥å é¤å¤±æææ ç¨çç¼å­æ°æ®ã\n\nä¸é¢æ¯@cacheableã@cacheevictå@cacheputåºæ¬ä½¿ç¨æ¹æ³çä¸ä¸ªéä¸­å±ç¤ºï¼\n\n@service\npublic class userservice {\n    // @cacheableå¯ä»¥è®¾ç½®å¤ä¸ªç¼å­ï¼å½¢å¼å¦ï¼@cacheable({"books", "isbns"})\n    @cacheable(value={"users"}, key="#user.id")\n    public user finduser(user user) {\n        return finduserindb(user.getid());\n    }\n\n    @cacheable(value = "users", condition = "#user.getid() <= 2")\n    public user finduserinlimit(user user) {\n        return finduserindb(user.getid());\n    }\n\n    @cacheput(value = "users", key = "#user.getid()")\n    public void updateuser(user user) {\n        updateuserindb(user);\n    }\n\n    @cacheevict(value = "users")\n    public void removeuser(user user) {\n        removeuserindb(user.getid());\n    }\n\n    @cacheevict(value = "users", allentries = true)\n    public void clear() {\n        removeallindb();\n    }\n}\n\n\n# @caching\n\n@caching ç¨äºç»åå®ä¹å¤ç§ç¼å­åè½ã\n\nå¦æéè¦ä½¿ç¨åä¸ä¸ªç¼å­æ³¨è§£ï¼@cacheableã@cacheevictæ@cacheputï¼å¤æ¬¡ä¿®é¥°ä¸ä¸ªæ¹æ³ï¼å°±éè¦ç¨å°@cachingã\n\n@caching(evict = { @cacheevict("primary"), @cacheevict(cachenames="secondary", key="#p0") })\npublic book importbooks(string deposit, date date)\n\n\n# @cacheconfig\n\n@cacheconfig ç¨äºå®ä¹å¬å±ç¼å­éç½®ã\n\nä¸åé¢çç¼å­æ³¨è§£ä¸åï¼è¿æ¯ä¸ä¸ªç±»çº§å«çæ³¨è§£ã\n\nå¦æç±»çæææä½é½æ¯ç¼å­æä½ï¼ä½ å¯ä»¥ä½¿ç¨@cacheconfigæ¥æå®ç±»ï¼çå»ä¸äºéç½®ã\n\n@cacheconfig("books")\npublic class bookrepositoryimpl implements bookrepository {\n @cacheable\n public book findbook(isbn isbn) {...}\n}\n\n\n\n# ä¸ãspring boot cache\n\n> è¯¦è§ï¼spring boot cache ç¹æ§å®æ¹ææ¡£\n\nspring boot cache æ¯å¨ spring cache çåºç¡ä¸åäºå°è£ï¼ä½¿å¾ä½¿ç¨æ´ä¸ºä¾¿æ·ã\n\n\n# spring boot cache å¿«éå¥é¨\n\nï¼1ï¼å¼å¥ä¾èµ\n\n<dependency>\n  <groupid>org.springframework.boot</groupid>\n  <artifactid>spring-boot-starter-cache</artifactid>\n</dependency>\n\n\x3c!-- æåºå¼å¥éè¦çç¼å­åº --\x3e\n<dependency>\n  <groupid>org.springframework.boot</groupid>\n  <artifactid>spring-boot-starter-data-redis</artifactid>\n</dependency>\n\n\nï¼2ï¼ç¼å­éç½®\n\nä¾å¦ï¼éç¨ç¼å­ä¸º redisï¼åéè¦éç½® redis ç¸å³çéç½®é¡¹ï¼å¦ï¼æ°æ®æºãè¿æ¥æ± ç­éç½®ä¿¡æ¯ï¼\n\n# ç¼å­ç±»åï¼æ¯æç±»åï¼genericãjcacheãehcacheãhazelcastãinfinispanãcouchbaseãredisãcaffeineãsimple\nspring.cache.type = redis\n# å¨å±ç¼å­æ¶é´\nspring.cache.redis.time-to-live = 60s\n\n# redis éç½®\nspring.redis.database = 0\nspring.redis.host = localhost\nspring.redis.port = 6379\nspring.redis.password =\n\n\nï¼3ï¼ä½¿ç¨ @enablecaching å¼å¯ç¼å­\n\n@enablecaching\n@springbootapplication\npublic class application {\n    // ...\n}\n\n\nï¼4ï¼ç¼å­æ³¨è§£ï¼@cacheableã@cacheputã@cacheevit ç­ï¼ä½¿ç¨æ¹å¼ä¸ spring cache å®å¨ä¸æ ·\n\n\n# åãjetcache\n\n> jetcache æ¯ä¸ä¸ªåºäº java çç¼å­ç³»ç»å°è£ï¼æä¾ç»ä¸ç api åæ³¨è§£æ¥ç®åç¼å­çä½¿ç¨ã jetcache æä¾äºæ¯ springcache æ´å å¼ºå¤§çæ³¨è§£ï¼å¯ä»¥åççæ¯æ ttlãä¸¤çº§ç¼å­ãåå¸å¼èªå¨å·æ°ï¼è¿æä¾äºcacheæ¥å£ç¨äºæå·¥ç¼å­æä½ã å½åæåä¸ªå®ç°ï¼rediscacheãtaircacheï¼æ­¤é¨åæªå¨ github å¼æºï¼ãcaffeinecache(in memory)åä¸ä¸ªç®æçlinkedhashmapcache(in memory)ï¼è¦æ·»å æ°çå®ç°ä¹æ¯éå¸¸ç®åçã\n> \n> è¯¦è§ï¼jetcache github\n\n\n# jetcache å¿«éå¥é¨\n\nå¦æä½¿ç¨ spring bootï¼å¯ä»¥æå¦ä¸çæ¹å¼éç½®ï¼è¿éä½¿ç¨äº jedis å®¢æ·ç«¯è¿æ¥ redisï¼å¦æéè¦éç¾¤ãè¯»ååç¦»ãå¼æ­¥ç­ç¹æ§æ¯æè¯·ä½¿ç¨lettuceå®¢æ·ç«¯ï¼ã\n\nï¼1ï¼å¼å¥ pom\n\n<dependency>\n    <groupid>com.alicp.jetcache</groupid>\n    <artifactid>jetcache-starter-redis</artifactid>\n    <version>2.5.14</version>\n</dependency>\n\n\nï¼2ï¼éç½®\n\néç½®ä¸ä¸ª spring boot é£æ ¼ç application.yml æä»¶ï¼æä»æ¾å°èµæºç®å½ä¸­\n\njetcache:\n  statintervalminutes: 15\n  areaincachename: false\n  local:\n    default:\n      type: linkedhashmap\n      keyconvertor: fastjson\n  remote:\n    default:\n      type: redis\n      keyconvertor: fastjson\n      valueencoder: java\n      valuedecoder: java\n      poolconfig:\n        minidle: 5\n        maxidle: 20\n        maxtotal: 50\n      host: 127.0.0.1\n      port: 6379\n\n\nï¼3ï¼å¼å¯ç¼å­\n\nç¶ååå»ºä¸ä¸ª app ç±»æ¾å¨ä¸å¡åçæ ¹ä¸ï¼enablemethodcacheï¼enablecreatecacheannotation è¿ä¸¤ä¸ªæ³¨è§£åå«æ¿æ´» cached å createcache æ³¨è§£ï¼å¶ä»åæ åç spring boot ç¨åºæ¯ä¸æ ·çãè¿ä¸ªç±»å¯ä»¥ç´æ¥ main æ¹æ³è¿è¡ã\n\npackage com.company.mypackage;\n\nimport com.alicp.jetcache.anno.config.enablecreatecacheannotation;\nimport com.alicp.jetcache.anno.config.enablemethodcache;\nimport org.springframework.boot.springapplication;\nimport org.springframework.boot.autoconfigure.springbootapplication;\n\n@springbootapplication\n@enablemethodcache(basepackages = "com.company.mypackage")\n@enablecreatecacheannotation\npublic class myspringbootapp {\n    public static void main(string[] args) {\n        springapplication.run(myspringbootapp.class);\n    }\n}\n\n\nï¼4ï¼api åºæ¬ä½¿ç¨\n\nåå»ºç¼å­å®ä¾\n\néè¿ @createcache æ³¨è§£åå»ºä¸ä¸ªç¼å­å®ä¾ï¼é»è®¤è¶æ¶æ¶é´æ¯ 100 ç§\n\n@createcache(expire = 100)\nprivate cache<long, userdo> usercache;\n\n\nç¨èµ·æ¥å°±å map ä¸æ ·\n\nuserdo user = usercache.get(123l);\nusercache.put(123l, user);\nusercache.remove(123l);\n\n\nåå»ºä¸ä¸ªä¸¤çº§ï¼åå­+è¿ç¨ï¼çç¼å­ï¼åå­ä¸­çåç´ ä¸ªæ°éå¶å¨ 50 ä¸ªã\n\n@createcache(name = "userservice.usercache", expire = 100, cachetype = cachetype.both, locallimit = 50)\nprivate cache<long, userdo> usercache;\n\n\nname å±æ§ä¸æ¯å¿é¡»çï¼ä½æ¯èµ·ä¸ªåå­æ¯ä¸ªå¥½ä¹ æ¯ï¼å±ç¤ºç»è®¡æ°æ®çä½¿ç¨ï¼ä¼ä½¿ç¨è¿ä¸ªåå­ãå¦æåä¸ä¸ª area ä¸¤ä¸ª @createcache ç name éç½®ä¸æ ·ï¼å®ä»¬çæç cache å°æååä¸ä¸ªå®ä¾ã\n\nåå»ºæ¹æ³ç¼å­\n\nä½¿ç¨ @cached æ¹æ³å¯ä»¥ä¸ºä¸ä¸ªæ¹æ³æ·»å ä¸ç¼å­ãjetcache éè¿ spring aop çæä»£çï¼æ¥æ¯æç¼å­åè½ãæ³¨è§£å¯ä»¥å å¨æ¥å£æ¹æ³ä¸ä¹å¯ä»¥å å¨ç±»æ¹æ³ä¸ï¼ä½éè¦ä¿è¯æ¯ä¸ª spring beanã\n\npublic interface userservice {\n    @cached(name="userservice.getuserbyid", expire = 3600)\n    user getuserbyid(long userid);\n}\n\n\n\n# äºãj2cache\n\n\n# å­ãæ»ç»\n\nä½¿ç¨ç¼å­æ¡æ¶ï¼ä½¿å¾å¼åç¼å­åè½éå¸¸ä¾¿æ·ã\n\nå¦æä½ çç³»ç»åªéè¦ä½¿ç¨ä¸ç§ç¼å­ï¼é£ä¹æ¨èä½¿ç¨ spring boot cacheãspring boot cache å¨ spring cache åºç¡ä¸åäºå°è£ï¼ä½¿ç¨æ´ç®åãæ¹ä¾¿ã\n\nå¦æä½ çç³»ç»éè¦ä½¿ç¨å¤çº§ç¼å­ï¼é£ä¹æ¨èä½¿ç¨ jetcacheã\n\n\n# åèèµæ\n\n * jsr107\n * spring cache å®æ¹ææ¡£\n * spring boot cache ç¹æ§å®æ¹ææ¡£\n * j2cache gitee\n * jetcache github\n * jetcache wiki',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Memcached å¿«éå¥é¨",frontmatter:{title:"Memcached å¿«éå¥é¨",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["Java","ä¸­é´ä»¶","ç¼å­","é¢è¯"],abbrlink:"2e7f2a78",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/25a710/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/03.Memcached.html",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/03.Memcached.md",key:"v-d302b38c",path:"/pages/25a710/",headers:[{level:2,title:"ä¸ãMemcached ç®ä»",slug:"ä¸ãmemcached-ç®ä»",normalizedTitle:"ä¸ãmemcached ç®ä»",charIndex:21},{level:3,title:"Memcached ç¹æ§",slug:"memcached-ç¹æ§",normalizedTitle:"memcached ç¹æ§",charIndex:261},{level:2,title:"äºãMemcached å½ä»¤",slug:"äºãmemcached-å½ä»¤",normalizedTitle:"äºãmemcached å½ä»¤",charIndex:379},{level:2,title:"ä¸ãJava è¿æ¥ Memcached",slug:"ä¸ãjava-è¿æ¥-memcached",normalizedTitle:"ä¸ãjava è¿æ¥ memcached",charIndex:1080},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:1779}],headersStr:"ä¸ãMemcached ç®ä» Memcached ç¹æ§ äºãMemcached å½ä»¤ ä¸ãJava è¿æ¥ Memcached åèèµæ",content:'# Memcached å¿«éå¥é¨\n\n\n# ä¸ãMemcached ç®ä»\n\nMemcached æ¯ä¸ä¸ªèªç±å¼æºçï¼é«æ§è½ï¼åå¸å¼åå­å¯¹è±¡ç¼å­ç³»ç»ã\n\nMemcached æ¯ä¸ç§åºäºåå­ç key-value å­å¨ï¼ç¨æ¥å­å¨å°åçä»»ææ°æ®ï¼å­ç¬¦ä¸²ãå¯¹è±¡ï¼ãè¿äºæ°æ®å¯ä»¥æ¯æ°æ®åºè°ç¨ãAPI è°ç¨æèæ¯é¡µé¢æ¸²æçç»æã\n\nMemcached ç®æ´èå¼ºå¤§ãå®çç®æ´è®¾è®¡ä¾¿äºå¿«éå¼åï¼åè½»å¼åé¾åº¦ï¼è§£å³äºå¤§æ°æ®éç¼å­çå¾å¤é®é¢ãå®ç API å¼å®¹å¤§é¨åæµè¡çå¼åè¯­è¨ãæ¬è´¨ä¸ï¼å®æ¯ä¸ä¸ªç®æ´ç key-value å­å¨ç³»ç»ã\n\n\n# Memcached ç¹æ§\n\nmemcached ä½ä¸ºé«éè¿è¡çåå¸å¼ç¼å­æå¡å¨ï¼å·æä»¥ä¸çç¹ç¹ã\n\n * åè®®ç®å\n * åºäº libevent çäºä»¶å¤ç\n * åç½®åå­å­å¨æ¹å¼\n * memcached ä¸äºç¸éä¿¡çåå¸å¼\n\n\n# äºãMemcached å½ä»¤\n\nå¯ä»¥éè¿ telnet å½ä»¤å¹¶æå®ä¸»æº ip åç«¯å£æ¥è¿æ¥ Memcached æå¡ã\n\ntelnet 127.0.0.1 11211\n\nTrying 127.0.0.1...\nConnected to 127.0.0.1.\nEscape character is \'^]\'.\nset foo 0 0 3                                                   ä¿å­å½ä»¤\nbar                                                             æ°æ®\nSTORED                                                          ç»æ\nget foo                                                         åå¾å½ä»¤\nVALUE foo 0 3                                                   æ°æ®\nbar                                                             æ°æ®\nEND                                                             ç»æè¡\nquit                                                            éåº\n\n\n\n# ä¸ãJava è¿æ¥ Memcached\n\nä½¿ç¨ Java ç¨åºè¿æ¥ Memcachedï¼éè¦å¨ä½ ç classpath ä¸­æ·»å  Memcached jar åã\n\næ¬ç« jar åä¸è½½å°åï¼spymemcached-2.10.3.jarã\n\nGoogle Code jar åä¸è½½å°åï¼spymemcached-2.10.3.jarï¼éè¦ç§å­¦ä¸ç½ï¼ã\n\nä»¥ä¸ç¨åºåå® Memcached æå¡çä¸»æºä¸º 127.0.0.1ï¼ç«¯å£ä¸º 11211ã\n\nimport net.spy.memcached.MemcachedClient;\nimport java.net.*;\n\n\npublic class MemcachedJava {\n   public static void main(String[] args) {\n      try{\n         // æ¬å°è¿æ¥ Memcached æå¡\n         MemcachedClient mcc = new MemcachedClient(new InetSocketAddress("127.0.0.1", 11211));\n         System.out.println("Connection to server sucessful.");\n\n         // å³é­è¿æ¥\n         mcc.shutdown();\n\n      }catch(Exception ex){\n         System.out.println( ex.getMessage() );\n      }\n   }\n}\n\n\n\n# åèèµæ\n\n * Memcached å®ç½\n * Memcached Github\n * Memcached æç¨',normalizedContent:'# memcached å¿«éå¥é¨\n\n\n# ä¸ãmemcached ç®ä»\n\nmemcached æ¯ä¸ä¸ªèªç±å¼æºçï¼é«æ§è½ï¼åå¸å¼åå­å¯¹è±¡ç¼å­ç³»ç»ã\n\nmemcached æ¯ä¸ç§åºäºåå­ç key-value å­å¨ï¼ç¨æ¥å­å¨å°åçä»»ææ°æ®ï¼å­ç¬¦ä¸²ãå¯¹è±¡ï¼ãè¿äºæ°æ®å¯ä»¥æ¯æ°æ®åºè°ç¨ãapi è°ç¨æèæ¯é¡µé¢æ¸²æçç»æã\n\nmemcached ç®æ´èå¼ºå¤§ãå®çç®æ´è®¾è®¡ä¾¿äºå¿«éå¼åï¼åè½»å¼åé¾åº¦ï¼è§£å³äºå¤§æ°æ®éç¼å­çå¾å¤é®é¢ãå®ç api å¼å®¹å¤§é¨åæµè¡çå¼åè¯­è¨ãæ¬è´¨ä¸ï¼å®æ¯ä¸ä¸ªç®æ´ç key-value å­å¨ç³»ç»ã\n\n\n# memcached ç¹æ§\n\nmemcached ä½ä¸ºé«éè¿è¡çåå¸å¼ç¼å­æå¡å¨ï¼å·æä»¥ä¸çç¹ç¹ã\n\n * åè®®ç®å\n * åºäº libevent çäºä»¶å¤ç\n * åç½®åå­å­å¨æ¹å¼\n * memcached ä¸äºç¸éä¿¡çåå¸å¼\n\n\n# äºãmemcached å½ä»¤\n\nå¯ä»¥éè¿ telnet å½ä»¤å¹¶æå®ä¸»æº ip åç«¯å£æ¥è¿æ¥ memcached æå¡ã\n\ntelnet 127.0.0.1 11211\n\ntrying 127.0.0.1...\nconnected to 127.0.0.1.\nescape character is \'^]\'.\nset foo 0 0 3                                                   ä¿å­å½ä»¤\nbar                                                             æ°æ®\nstored                                                          ç»æ\nget foo                                                         åå¾å½ä»¤\nvalue foo 0 3                                                   æ°æ®\nbar                                                             æ°æ®\nend                                                             ç»æè¡\nquit                                                            éåº\n\n\n\n# ä¸ãjava è¿æ¥ memcached\n\nä½¿ç¨ java ç¨åºè¿æ¥ memcachedï¼éè¦å¨ä½ ç classpath ä¸­æ·»å  memcached jar åã\n\næ¬ç« jar åä¸è½½å°åï¼spymemcached-2.10.3.jarã\n\ngoogle code jar åä¸è½½å°åï¼spymemcached-2.10.3.jarï¼éè¦ç§å­¦ä¸ç½ï¼ã\n\nä»¥ä¸ç¨åºåå® memcached æå¡çä¸»æºä¸º 127.0.0.1ï¼ç«¯å£ä¸º 11211ã\n\nimport net.spy.memcached.memcachedclient;\nimport java.net.*;\n\n\npublic class memcachedjava {\n   public static void main(string[] args) {\n      try{\n         // æ¬å°è¿æ¥ memcached æå¡\n         memcachedclient mcc = new memcachedclient(new inetsocketaddress("127.0.0.1", 11211));\n         system.out.println("connection to server sucessful.");\n\n         // å³é­è¿æ¥\n         mcc.shutdown();\n\n      }catch(exception ex){\n         system.out.println( ex.getmessage() );\n      }\n   }\n}\n\n\n\n# åèèµæ\n\n * memcached å®ç½\n * memcached github\n * memcached æç¨',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Ehcache å¿«éå¥é¨",frontmatter:{title:"Ehcache å¿«éå¥é¨",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["Java","ä¸­é´ä»¶","ç¼å­","Ehcache"],abbrlink:"2720adf1",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/c4647d/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/04.Ehcache.html",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/04.Ehcache.md",key:"v-16f33bda",path:"/pages/c4647d/",headers:[{level:2,title:"ä¸ãç®ä»",slug:"ä¸ãç®ä»",normalizedTitle:"ä¸ãç®ä»",charIndex:94},{level:3,title:"Ehcache ç¹æ§",slug:"ehcache-ç¹æ§",normalizedTitle:"ehcache ç¹æ§",charIndex:157},{level:3,title:"Ehcache éç¾¤",slug:"ehcache-éç¾¤",normalizedTitle:"ehcache éç¾¤",charIndex:450},{level:4,title:"RMI",slug:"rmi",normalizedTitle:"rmi",charIndex:271},{level:4,title:"JMS",slug:"jms",normalizedTitle:"jms",charIndex:493},{level:4,title:"Cache Server",slug:"cache-server",normalizedTitle:"cache server",charIndex:676},{level:2,title:"äºãå¿«éå¥é¨",slug:"äºãå¿«éå¥é¨",normalizedTitle:"äºãå¿«éå¥é¨",charIndex:695},{level:3,title:"å¼å¥ Ehcache",slug:"å¼å¥-ehcache",normalizedTitle:"å¼å¥ ehcache",charIndex:706},{level:3,title:"æ·»å éç½®æä»¶",slug:"æ·»å éç½®æä»¶",normalizedTitle:"æ·»å éç½®æä»¶",charIndex:1254},{level:3,title:"Ehcache å·¥ä½ç¤ºä¾",slug:"ehcache-å·¥ä½ç¤ºä¾",normalizedTitle:"ehcache å·¥ä½ç¤ºä¾",charIndex:2120},{level:2,title:"ä¸ãEhcache API",slug:"ä¸ãehcache-api",normalizedTitle:"ä¸ãehcache api",charIndex:3136},{level:3,title:"åå»º CacheManager",slug:"åå»º-cachemanager",normalizedTitle:"åå»º cachemanager",charIndex:3405},{level:3,title:"æ·»å ç¼å­",slug:"æ·»å ç¼å­",normalizedTitle:"æ·»å ç¼å­",charIndex:4557},{level:3,title:"å é¤ç¼å­",slug:"å é¤ç¼å­",normalizedTitle:"å é¤ç¼å­",charIndex:5716},{level:3,title:"åºæ¬ç¼å­æä½",slug:"åºæ¬ç¼å­æä½",normalizedTitle:"åºæ¬ç¼å­æä½",charIndex:5868},{level:2,title:"åãEhcache éç½®",slug:"åãehcache-éç½®",normalizedTitle:"åãehcache éç½®",charIndex:7607},{level:3,title:"xml éç½®æ¹å¼",slug:"xml-éç½®æ¹å¼",normalizedTitle:"xml éç½®æ¹å¼",charIndex:7692},{level:3,title:"API éç½®æ¹å¼",slug:"api-éç½®æ¹å¼",normalizedTitle:"api éç½®æ¹å¼",charIndex:8641},{level:2,title:"äºãSpring éæ Ehcache",slug:"äºãspring-éæ-ehcache",normalizedTitle:"äºãspring éæ ehcache",charIndex:9106},{level:3,title:"ç»å® Ehcache",slug:"ç»å®-ehcache",normalizedTitle:"ç»å® ehcache",charIndex:9304},{level:3,title:"ä½¿ç¨ Spring çç¼å­æ³¨è§£",slug:"ä½¿ç¨-spring-çç¼å­æ³¨è§£",normalizedTitle:"ä½¿ç¨ spring çç¼å­æ³¨è§£",charIndex:10476},{level:4,title:"å¼å¯æ³¨è§£",slug:"å¼å¯æ³¨è§£",normalizedTitle:"å¼å¯æ³¨è§£",charIndex:10495},{level:3,title:"æ³¨è§£åºæ¬ä½¿ç¨æ¹æ³",slug:"æ³¨è§£åºæ¬ä½¿ç¨æ¹æ³",normalizedTitle:"æ³¨è§£åºæ¬ä½¿ç¨æ¹æ³",charIndex:10785},{level:4,title:"@Cacheable",slug:"cacheable",normalizedTitle:"@cacheable",charIndex:10904},{level:4,title:"@CachePut",slug:"cacheput",normalizedTitle:"@cacheput",charIndex:11071},{level:4,title:"@CacheEvict",slug:"cacheevict",normalizedTitle:"@cacheevict",charIndex:11156},{level:4,title:"@Caching",slug:"caching",normalizedTitle:"@caching",charIndex:12030},{level:4,title:"@CacheConfig",slug:"cacheconfig",normalizedTitle:"@cacheconfig",charIndex:12260},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:12483}],headersStr:"ä¸ãç®ä» Ehcache ç¹æ§ Ehcache éç¾¤ RMI JMS Cache Server äºãå¿«éå¥é¨ å¼å¥ Ehcache æ·»å éç½®æä»¶ Ehcache å·¥ä½ç¤ºä¾ ä¸ãEhcache API åå»º CacheManager æ·»å ç¼å­ å é¤ç¼å­ åºæ¬ç¼å­æä½ åãEhcache éç½® xml éç½®æ¹å¼ API éç½®æ¹å¼ äºãSpring éæ Ehcache ç»å® Ehcache ä½¿ç¨ Spring çç¼å­æ³¨è§£ å¼å¯æ³¨è§£ æ³¨è§£åºæ¬ä½¿ç¨æ¹æ³ @Cacheable @CachePut @CacheEvict @Caching @CacheConfig åèèµæ",content:'# Ehcache å¿«éå¥é¨\n\n> EhCache æ¯ä¸ä¸ªçº¯ Java çè¿ç¨åç¼å­æ¡æ¶ï¼å·æå¿«éãç²¾å¹²ç­ç¹ç¹ï¼æ¯ Hibernate ä¸­é»è®¤ç CacheProviderã\n\n\n\n\n# ä¸ãç®ä»\n\n> Ehcache è½ç¶ä¹æ¯æåå¸å¼æ¨¡å¼ï¼ä½æ¯åå¸å¼æ¹æ¡ä¸æ¯å¾å¥½å¥½ï¼å»ºè®®åªå°å¶ä½ä¸ºåæºçè¿ç¨åç¼å­ä½¿ç¨ã\n\n\n# Ehcache ç¹æ§\n\nä¼ç¹\n\n * å¿«éãç®å\n * æ¯æå¤ç§ç¼å­ç­ç¥ï¼LRUãLFUãFIFO æ·æ±°ç®æ³\n * ç¼å­æ°æ®æä¸¤çº§ï¼åå­åç£çï¼å æ­¤æ éæå¿å®¹éé®é¢\n * ç¼å­æ°æ®ä¼å¨èææºéå¯çè¿ç¨ä¸­åå¥ç£ç\n * å¯ä»¥éè¿ RMIãå¯æå¥ API ç­æ¹å¼è¿è¡åå¸å¼ç¼å­\n * å·æç¼å­åç¼å­ç®¡çå¨çä¾¦å¬æ¥å£\n * æ¯æå¤ç¼å­ç®¡çå¨å®ä¾ï¼ä»¥åä¸ä¸ªå®ä¾çå¤ä¸ªç¼å­åºå\n * æä¾ Hibernate çç¼å­å®ç°\n\nç¼ºç¹\n\n * ä½¿ç¨ç£ç Cache çæ¶åéå¸¸å ç¨ç£çç©ºé´\n * ä¸ä¿è¯æ°æ®çå®å¨\n * è½ç¶æ¯æåå¸å¼ç¼å­ï¼ä½æçä¸é«ï¼éè¿ç»æ­æ¹å¼ï¼å¨ä¸åèç¹ä¹é´åæ­¥æ°æ®ï¼ã\n\n\n# Ehcache éç¾¤\n\nEhcache ç®åæ¯æäºç§éç¾¤æ¹å¼ï¼\n\n * RMI\n * JMS\n * JGroup\n * Terracotta\n * Ehcache Server\n\n# RMI\n\nä½¿ç¨ç»æ­æ¹å¼éç¥ææèç¹åæ­¥æ°æ®ã\n\nå¦æç½ç»æé®é¢ï¼ææå°æå¡å®æºï¼åå­å¨æ°æ®æ æ³åæ­¥çå¯è½ï¼å¯¼è´æ°æ®ä¸ä¸è´ã\n\n\n\n# JMS\n\nJMS ç±»ä¼¼ MQï¼ææèç¹è®¢éæ¶æ¯ï¼å½æèç¹ç¼å­åçååï¼å°±å JMS åæ¶æ¯ï¼å¶ä»èç¹æç¥åååï¼åæ­¥æ°æ®ã\n\n\n\n# Cache Server\n\n\n\n\n# äºãå¿«éå¥é¨\n\n\n# å¼å¥ Ehcache\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ maven ç®¡çï¼æ·»å ä»¥ä¸ä¾èµå°ä½ ç pom.xml ä¸­ã\n\n<dependency>\n  <groupId>net.sf.ehcache</groupId>\n  <artifactId>ehcache</artifactId>\n  <version>2.10.2</version>\n  <type>pom</type>\n</dependency>\n\n\nå¦æä½ çé¡¹ç®ä¸ä½¿ç¨ maven ç®¡çï¼è¯·å¨ Ehcache å®ç½ä¸è½½å°å ä¸è½½ jar åã\n\nSpring æä¾äºå¯¹äº Ehcache æ¥å£çå°è£ï¼å¯ä»¥æ´ç®ä¾¿çä½¿ç¨å¶åè½ãæ¥å¥æ¹å¼å¦ä¸ï¼\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ maven ç®¡çï¼æ·»å ä»¥ä¸ä¾èµå°ä½ çpom.xmlä¸­ã\n\nspring-context-supportè¿ä¸ª jar åä¸­å«æ Spring å¯¹äºç¼å­åè½çæ½è±¡å°è£æ¥å£ã\n\n<dependency>\n  <groupId>org.springframework</groupId>\n  <artifactId>spring-context-support</artifactId>\n  <version>4.1.4.RELEASE</version>\n</dependency>\n\n\n\n# æ·»å éç½®æä»¶\n\nï¼1ï¼å¨ classpath ä¸æ·»å  ehcache.xml æ·»å ä¸ä¸ªåä¸º helloworld çç¼å­ã\n\n<?xml version="1.0" encoding="UTF-8"?>\n<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd">\n\n  \x3c!-- ç£çç¼å­ä½ç½® --\x3e\n  <diskStore path="java.io.tmpdir/ehcache"/>\n\n  \x3c!-- é»è®¤ç¼å­ --\x3e\n  <defaultCache\n          maxEntriesLocalHeap="10000"\n          eternal="false"\n          timeToIdleSeconds="120"\n          timeToLiveSeconds="120"\n          maxEntriesLocalDisk="10000000"\n          diskExpiryThreadIntervalSeconds="120"\n          memoryStoreEvictionPolicy="LRU"/>\n\n  \x3c!-- helloworldç¼å­ --\x3e\n  <cache name="helloworld"\n         maxElementsInMemory="1000"\n         eternal="false"\n         timeToIdleSeconds="5"\n         timeToLiveSeconds="5"\n         overflowToDisk="false"\n         memoryStoreEvictionPolicy="LRU"/>\n</ehcache>\n\n\n\n# Ehcache å·¥ä½ç¤ºä¾\n\nEhcache ä¼èªå¨å è½½ classpath æ ¹ç®å½ä¸åä¸º ehcache.xml æä»¶ã\n\nEhcacheDemo çå·¥ä½æ­¥éª¤å¦ä¸ï¼\n\n 1. å¨ EhcacheDemo ä¸­ï¼æä»¬å¼ç¨ ehcache.xml å£°æçåä¸º helloworld çç¼å­æ¥åå»ºCacheå¯¹è±¡ï¼\n 2. ç¶åæä»¬ç¨ä¸ä¸ªé®å¼å¯¹æ¥å®ä¾åElementå¯¹è±¡ï¼\n 3. å°Elementå¯¹è±¡æ·»å å°Cacheï¼\n 4. ç¶åç¨Cacheç get æ¹æ³è·åElementå¯¹è±¡ã\n\npublic class EhcacheDemo {\n    public static void main(String[] args) throws Exception {\n        // Create a cache manager\n        final CacheManager cacheManager = new CacheManager();\n\n        // create the cache called "helloworld"\n        final Cache cache = cacheManager.getCache("helloworld");\n\n        // create a key to map the data to\n        final String key = "greeting";\n\n        // Create a data element\n        final Element putGreeting = new Element(key, "Hello, World!");\n\n        // Put the element into the data store\n        cache.put(putGreeting);\n\n        // Retrieve the data element\n        final Element getGreeting = cache.get(key);\n\n        // Print the value\n        System.out.println(getGreeting.getObjectValue());\n    }\n}\n\n\nè¾åº\n\nHello, World!\n\n\n\n# ä¸ãEhcache API\n\nElementãCacheãCacheManageræ¯ Ehcache æéè¦ç APIã\n\n * Element - ç¼å­çåç´ ï¼å®ç»´æ¤çä¸ä¸ªé®å¼å¯¹ã\n * Cache - å®æ¯ Ehcache çæ ¸å¿ç±»ï¼å®æå¤ä¸ªElementï¼å¹¶è¢«CacheManagerç®¡çãå®å®ç°äºå¯¹ç¼å­çé»è¾è¡ä¸ºã\n * CacheManager - Cacheçå®¹å¨å¯¹è±¡ï¼å¹¶ç®¡ççCacheççå½å¨æãCacheManager æ¯æä¸¤ç§åå»ºæ¨¡å¼ï¼åä¾ï¼Singleton modeï¼åå®ä¾ï¼InstanceModeï¼ã\n\n\n# åå»º CacheManager\n\nä¸é¢çä»£ç åä¸¾äºåå»º CacheManager çäºç§æ¹å¼ã\n\nä½¿ç¨éææ¹æ³create()ä¼ä»¥é»è®¤éç½®æ¥åå»ºåä¾çCacheManagerå®ä¾ã\n\nnewInstance()æ¹æ³æ¯ä¸ä¸ªå·¥åæ¹æ³ï¼ä»¥é»è®¤éç½®åå»ºä¸ä¸ªæ°çCacheManagerå®ä¾ã\n\næ­¤å¤ï¼newInstance()è¿æå ä¸ªéè½½å½æ°ï¼åå«å¯ä»¥éè¿ä¼ å¥StringãURLãInputStreamåæ°æ¥å è½½éç½®æä»¶ï¼ç¶ååå»ºCacheManagerå®ä¾ã\n\n// ä½¿ç¨Ehcacheé»è®¤éç½®è·ååä¾çCacheManagerå®ä¾\nCacheManager.create();\nString[] cacheNames = CacheManager.getInstance().getCacheNames();\n\n// ä½¿ç¨Ehcacheé»è®¤éç½®æ°å»ºä¸ä¸ªCacheManagerå®ä¾\nCacheManager.newInstance();\nString[] cacheNames = manager.getCacheNames();\n\n// ä½¿ç¨ä¸åçéç½®æä»¶åå«åå»ºä¸ä¸ªCacheManagerå®ä¾\nCacheManager manager1 = CacheManager.newInstance("src/config/ehcache1.xml");\nCacheManager manager2 = CacheManager.newInstance("src/config/ehcache2.xml");\nString[] cacheNamesForManager1 = manager1.getCacheNames();\nString[] cacheNamesForManager2 = manager2.getCacheNames();\n\n// åºäºclasspathä¸çéç½®æä»¶åå»ºCacheManagerå®ä¾\nURL url = getClass().getResource("/anotherconfigurationname.xml");\nCacheManager manager = CacheManager.newInstance(url);\n\n// åºäºæä»¶æµå¾å°éç½®æä»¶ï¼å¹¶åå»ºCacheManagerå®ä¾\nInputStream fis = new FileInputStream(new File\n("src/config/ehcache.xml").getAbsolutePath());\ntry {\n CacheManager manager = CacheManager.newInstance(fis);\n} finally {\n fis.close();\n}\n\n\n\n# æ·»å ç¼å­\n\néè¦å¼ºè°ä¸ç¹ï¼Cacheå¯¹è±¡å¨ç¨addCacheæ¹æ³æ·»å å°CacheManagerä¹åï¼æ¯æ æçã\n\nä½¿ç¨ CacheManager ç addCache æ¹æ³å¯ä»¥æ ¹æ®ç¼å­åå° ehcache.xml ä¸­å£°æç cache æ·»å å°å®¹å¨ä¸­ï¼å®ä¹å¯ä»¥ç´æ¥å° Cache å¯¹è±¡æ·»å å°ç¼å­å®¹å¨ä¸­ã\n\nCacheæå¤ä¸ªæé å½æ°ï¼æä¾äºä¸åæ¹å¼å»å è½½ç¼å­çéç½®åæ°ã\n\nææ¶åï¼ä½ å¯è½éè¦ä½¿ç¨ API æ¥å¨æçæ·»å ç¼å­ï¼ä¸é¢çä¾å­å°±æä¾äºè¿æ ·çèä¾ã\n\n// é¤äºå¯ä»¥ä½¿ç¨xmlæä»¶ä¸­éç½®çç¼å­ï¼ä½ ä¹å¯ä»¥ä½¿ç¨APIå¨æå¢å ç¼å­\n// æ·»å ç¼å­\nmanager.addCache(cacheName);\n\n// ä½¿ç¨é»è®¤éç½®æ·»å ç¼å­\nCacheManager singletonManager = CacheManager.create();\nsingletonManager.addCache("testCache");\nCache test = singletonManager.getCache("testCache");\n\n// ä½¿ç¨èªå®ä¹éç½®æ·»å ç¼å­ï¼æ³¨æç¼å­æªæ·»å è¿CacheManagerä¹åå¹¶ä¸å¯ç¨\nCacheManager singletonManager = CacheManager.create();\nCache memoryOnlyCache = new Cache("testCache", 5000, false, false, 5, 2);\nsingletonManager.addCache(memoryOnlyCache);\nCache test = singletonManager.getCache("testCache");\n\n// ä½¿ç¨ç¹å®çéç½®æ·»å ç¼å­\nCacheManager manager = CacheManager.create();\nCache testCache = new Cache(\n new CacheConfiguration("testCache", maxEntriesLocalHeap)\n .memoryStoreEvictionPolicy(MemoryStoreEvictionPolicy.LFU)\n .eternal(false)\n .timeToLiveSeconds(60)\n .timeToIdleSeconds(30)\n .diskExpiryThreadIntervalSeconds(0)\n .persistence(new PersistenceConfiguration().strategy(Strategy.LOCALTEMPSWAP)));\n manager.addCache(testCache);\n\n\n\n# å é¤ç¼å­\n\nå é¤ç¼å­æ¯è¾ç®åï¼ä½ åªéè¦å°æå®çç¼å­åä¼ å¥removeCacheæ¹æ³å³å¯ã\n\nCacheManager singletonManager = CacheManager.create();\nsingletonManager.removeCache("sampleCache1");\n\n\n\n# åºæ¬ç¼å­æä½\n\nCache æéè¦çä¸¤ä¸ªæ¹æ³å°±æ¯ put å getï¼åå«ç¨æ¥æ·»å  Element åè·å Elementã\n\nCache è¿æä¾äºä¸ç³»åç getãset æ¹æ³æ¥è®¾ç½®æè·åç¼å­åæ°ï¼è¿éä¸ä¸ä¸åä¸¾ï¼æ´å¤ API æä½å¯åèå®æ¹ API å¼åæåã\n\n/**\n * æµè¯ï¼ä½¿ç¨é»è®¤éç½®æä½¿ç¨æå®éç½®æ¥åå»ºCacheManager\n *\n * @author Zhang Peng\n */\npublic class CacheOperationTest {\n    private final Logger log = LoggerFactory.getLogger(CacheOperationTest.class);\n\n    /**\n     * ä½¿ç¨Ehcacheé»è®¤éç½®(classpathä¸çehcache.xml)è·ååä¾çCacheManagerå®ä¾\n     */\n    @Test\n    public void operation() {\n        CacheManager manager = CacheManager.newInstance("src/test/resources/ehcache/ehcache.xml");\n\n        // è·å¾Cacheçå¼ç¨\n        Cache cache = manager.getCache("userCache");\n\n        // å°ä¸ä¸ªElementæ·»å å°Cache\n        cache.put(new Element("key1", "value1"));\n\n        // è·åElementï¼Elementç±»æ¯æåºååï¼æä»¥ä¸é¢ä¸¤ç§æ¹æ³é½å¯ä»¥ç¨\n        Element element1 = cache.get("key1");\n        // è·åéåºååçå¼\n        log.debug("key:{}, value:{}", element1.getObjectKey(), element1.getObjectValue());\n        // è·ååºååçå¼\n        log.debug("key:{}, value:{}", element1.getKey(), element1.getValue());\n\n        // æ´æ°Cacheä¸­çElement\n        cache.put(new Element("key1", "value2"));\n        Element element2 = cache.get("key1");\n        log.debug("key:{}, value:{}", element2.getObjectKey(), element2.getObjectValue());\n\n        // è·åCacheçåç´ æ°\n        log.debug("cache size:{}", cache.getSize());\n\n        // è·åMemoryStoreçåç´ æ°\n        log.debug("MemoryStoreSize:{}", cache.getMemoryStoreSize());\n\n        // è·åDiskStoreçåç´ æ°\n        log.debug("DiskStoreSize:{}", cache.getDiskStoreSize());\n\n        // ç§»é¤Element\n        cache.remove("key1");\n        log.debug("cache size:{}", cache.getSize());\n\n        // å³é­å½åCacheManagerå¯¹è±¡\n        manager.shutdown();\n\n        // å³é­CacheManageråä¾å®ä¾\n        CacheManager.getInstance().shutdown();\n    }\n}\n\n\n\n# åãEhcache éç½®\n\n> Ehcache æ¯æéè¿ xml æä»¶å API ä¸¤ç§æ¹å¼è¿è¡éç½®ã\n> \n> è¯¦æåèï¼Ehcache å®æ¹ XML éç½®æå\n\n\n# xml éç½®æ¹å¼\n\nEhcache çCacheManageræé å½æ°æå·¥åæ¹æ³è¢«è°ç¨æ¶ï¼ä¼é»è®¤å è½½ classpath ä¸åä¸ºehcache.xmlçéç½®æä»¶ãå¦æå è½½å¤±è´¥ï¼ä¼å è½½ Ehcache jar åä¸­çehcache-failsafe.xmlæä»¶ï¼è¿ä¸ªæä»¶ä¸­å«æç®åçé»è®¤éç½®ã ehcache.xml éç½®åæ°è¯´æï¼\n\n * nameï¼ç¼å­åç§°ã\n * maxElementsInMemoryï¼ç¼å­æå¤§ä¸ªæ°ã\n * eternalï¼ç¼å­ä¸­å¯¹è±¡æ¯å¦ä¸ºæ°¸ä¹çï¼å¦ææ¯ï¼è¶æ¶è®¾ç½®å°è¢«å¿½ç¥ï¼å¯¹è±¡ä»ä¸è¿æã\n * timeToIdleSecondsï¼ç½®å¯¹è±¡å¨å¤±æåçåè®¸é²ç½®æ¶é´ï¼åä½ï¼ç§ï¼ãä»å½ eternal=false å¯¹è±¡ä¸æ¯æ°¸ä¹æææ¶ä½¿ç¨ï¼å¯éå±æ§ï¼é»è®¤å¼æ¯ 0ï¼ä¹å°±æ¯å¯é²ç½®æ¶é´æ ç©·å¤§ã\n * timeToLiveSecondsï¼ç¼å­æ°æ®ççå­æ¶é´ï¼TTLï¼ï¼ä¹å°±æ¯ä¸ä¸ªåç´ ä»æå»ºå°æ¶äº¡çæå¤§æ¶é´é´éå¼ï¼è¿åªè½å¨åç´ ä¸æ¯æ°¸ä¹é©»çæ¶ææï¼å¦æè¯¥å¼æ¯ 0 å°±æå³çåç´ å¯ä»¥åé¡¿æ ç©·é¿çæ¶é´ã\n * maxEntriesLocalDiskï¼å½åå­ä¸­å¯¹è±¡æ°éè¾¾å° maxElementsInMemory æ¶ï¼Ehcache å°ä¼å¯¹è±¡åå°ç£çä¸­ã\n * overflowToDiskï¼åå­ä¸è¶³æ¶ï¼æ¯å¦å¯ç¨ç£çç¼å­ã\n * diskSpoolBufferSizeMBï¼è¿ä¸ªåæ°è®¾ç½® DiskStoreï¼ç£çç¼å­ï¼çç¼å­åºå¤§å°ãé»è®¤æ¯ 30MBãæ¯ä¸ª Cache é½åºè¯¥æèªå·±çä¸ä¸ªç¼å²åºã\n * maxElementsOnDiskï¼ç¡¬çæå¤§ç¼å­ä¸ªæ°ã\n * diskPersistentï¼æ¯å¦å¨ VM éå¯æ¶å­å¨ç¡¬ççç¼å­æ°æ®ãé»è®¤å¼æ¯ falseã\n * diskExpiryThreadIntervalSecondsï¼ç£çå¤±æçº¿ç¨è¿è¡æ¶é´é´éï¼é»è®¤æ¯ 120 ç§ã\n * memoryStoreEvictionPolicyï¼å½è¾¾å° maxElementsInMemory éå¶æ¶ï¼Ehcache å°ä¼æ ¹æ®æå®çç­ç¥å»æ¸çåå­ãé»è®¤ç­ç¥æ¯ LRUï¼æè¿æå°ä½¿ç¨ï¼ãä½ å¯ä»¥è®¾ç½®ä¸º FIFOï¼åè¿ååºï¼ææ¯ LFUï¼è¾å°ä½¿ç¨ï¼ã\n * clearOnFlushï¼åå­æ°éæå¤§æ¶æ¯å¦æ¸é¤ã\n\n\n# API éç½®æ¹å¼\n\nxml éç½®çåæ°ä¹å¯ä»¥ç´æ¥éè¿ç¼ç¨æ¹å¼æ¥å¨æçè¿è¡éç½®ï¼dynamicConfig æ²¡æè®¾ä¸º falseï¼ã\n\nCache cache = manager.getCache("sampleCache");\nCacheConfiguration config = cache.getCacheConfiguration();\nconfig.setTimeToIdleSeconds(60);\nconfig.setTimeToLiveSeconds(120);\nconfig.setmaxEntriesLocalHeap(10000);\nconfig.setmaxEntriesLocalDisk(1000000);\n\n\nä¹å¯ä»¥éè¿disableDynamicFeatures()æ¹å¼å³é­å¨æéç½®å¼å³ãéç½®ä»¥åä½ å°æ æ³åä»¥ç¼ç¨æ¹å¼éç½®åæ°ã\n\nCache cache = manager.getCache("sampleCache");\ncache.disableDynamicFeatures();\n\n\n\n# äºãSpring éæ Ehcache\n\nSpring3.1 å¼å§æ·»å äºå¯¹ç¼å­çæ¯æãåäºå¡åè½çæ¯ææ¹å¼ç±»ä¼¼ï¼ç¼å­æ½è±¡åè®¸åºå±ä½¿ç¨ä¸åçç¼å­è§£å³æ¹æ¡æ¥è¿è¡æ´åã\n\nSpring4.1 å¼å§æ¯æ JSR-107 æ³¨è§£ã\n\n> æ³¨ï¼ææ¬äººä½¿ç¨ç Spring çæ¬ä¸º 4.1.4.RELEASEï¼ç®å Spring çæ¬ä»æ¯æ Ehcache2.5 ä»¥ä¸çæ¬ï¼ä½ä¸æ¯æ Ehcache3ã\n\n\n# ç»å® Ehcache\n\norg.springframework.cache.ehcache.EhCacheManagerFactoryBeanè¿ä¸ªç±»çä½ç¨æ¯å è½½ Ehcache éç½®æä»¶ã org.springframework.cache.ehcache.EhCacheCacheManagerè¿ä¸ªç±»çä½ç¨æ¯æ¯æ net.sf.ehcache.CacheManagerã\n\nspring-ehcache.xmlçéç½®\n\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:cache="http://www.springframework.org/schema/cache"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n        http://www.springframework.org/schema/cache\n        http://www.springframework.org/schema/cache/spring-cache-3.2.xsd">\n\n  <description>ehcacheç¼å­éç½®ç®¡çæä»¶</description>\n\n  <bean id="ehcache" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">\n    <property name="configLocation" value="classpath:ehcache/ehcache.xml"/>\n  </bean>\n\n  <bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheCacheManager">\n    <property name="cacheManager" ref="ehcache"/>\n  </bean>\n\n  \x3c!-- å¯ç¨ç¼å­æ³¨è§£å¼å³ --\x3e\n  <cache:annotation-driven cache-manager="cacheManager"/>\n</beans>\n\n\n\n# ä½¿ç¨ Spring çç¼å­æ³¨è§£\n\n# å¼å¯æ³¨è§£\n\nSpring ä¸ºç¼å­åè½æä¾äºæ³¨è§£åè½ï¼ä½æ¯ä½ å¿é¡»å¯å¨æ³¨è§£ã ä½ æä¸¤ä¸ªéæ©ï¼ (1) å¨ xml ä¸­å£°æ åä¸ä¸è spring-ehcache.xml ä¸­çåæ³ä¸æ ·ï¼ä½¿ç¨<cache:annotation-driven/>\n\n<cache:annotation-driven cache-manager="cacheManager"/>\n\n\n(2) ä½¿ç¨æ è®°æ³¨è§£ ä½ ä¹å¯ä»¥éè¿å¯¹ä¸ä¸ªç±»è¿è¡æ³¨è§£ä¿®é¥°çæ¹å¼å¨è¿ä¸ªç±»ä¸­ä½¿ç¨ç¼å­æ³¨è§£ã èä¾å¦ä¸ï¼\n\n@Configuration\n@EnableCaching\npublic class AppConfig {\n}\n\n\n\n# æ³¨è§£åºæ¬ä½¿ç¨æ¹æ³\n\nSpring å¯¹ç¼å­çæ¯æç±»ä¼¼äºå¯¹äºå¡çæ¯æã é¦åä½¿ç¨æ³¨è§£æ è®°æ¹æ³ï¼ç¸å½äºå®ä¹äºåç¹ï¼ç¶åä½¿ç¨ Aop ææ¯å¨è¿ä¸ªæ¹æ³çè°ç¨åãè°ç¨åè·åæ¹æ³çå¥ååè¿åå¼ï¼è¿èå®ç°äºç¼å­çé»è¾ã ä¸é¢ä¸ä¸ªæ³¨è§£é½æ¯æ¹æ³çº§å«ï¼\n\n# @Cacheable\n\nè¡¨ææä¿®é¥°çæ¹æ³æ¯å¯ä»¥ç¼å­çï¼å½ç¬¬ä¸æ¬¡è°ç¨è¿ä¸ªæ¹æ³æ¶ï¼å®çç»æä¼è¢«ç¼å­ä¸æ¥ï¼å¨ç¼å­çæææ¶é´åï¼ä»¥åè®¿é®è¿ä¸ªæ¹æ³é½ç´æ¥è¿åç¼å­ç»æï¼ä¸åæ§è¡æ¹æ³ä¸­çä»£ç æ®µã è¿ä¸ªæ³¨è§£å¯ä»¥ç¨conditionå±æ§æ¥è®¾ç½®æ¡ä»¶ï¼å¦æä¸æ»¡è¶³æ¡ä»¶ï¼å°±ä¸ä½¿ç¨ç¼å­è½åï¼ç´æ¥æ§è¡æ¹æ³ã å¯ä»¥ä½¿ç¨keyå±æ§æ¥æå® key ççæè§åã\n\n# @CachePut\n\nä¸@Cacheableä¸åï¼@CachePutä¸ä»ä¼ç¼å­æ¹æ³çç»æï¼è¿ä¼æ§è¡æ¹æ³çä»£ç æ®µã å®æ¯æçå±æ§åç¨æ³é½ä¸@Cacheableä¸è´ã\n\n# @CacheEvict\n\nä¸@Cacheableåè½ç¸åï¼@CacheEvictè¡¨ææä¿®é¥°çæ¹æ³æ¯ç¨æ¥å é¤å¤±æææ ç¨çç¼å­æ°æ®ã ä¸é¢æ¯@Cacheableã@CacheEvictå@CachePutåºæ¬ä½¿ç¨æ¹æ³çä¸ä¸ªéä¸­å±ç¤ºï¼\n\n@Service\npublic class UserService {\n    // @Cacheableå¯ä»¥è®¾ç½®å¤ä¸ªç¼å­ï¼å½¢å¼å¦ï¼@Cacheable({"books", "isbns"})\n    @Cacheable(value={"users"}, key="#user.id")\n    public User findUser(User user) {\n        return findUserInDB(user.getId());\n    }\n\n    @Cacheable(value = "users", condition = "#user.getId() <= 2")\n    public User findUserInLimit(User user) {\n        return findUserInDB(user.getId());\n    }\n\n    @CachePut(value = "users", key = "#user.getId()")\n    public void updateUser(User user) {\n        updateUserInDB(user);\n    }\n\n    @CacheEvict(value = "users")\n    public void removeUser(User user) {\n        removeUserInDB(user.getId());\n    }\n\n    @CacheEvict(value = "users", allEntries = true)\n    public void clear() {\n        removeAllInDB();\n    }\n}\n\n\n# @Caching\n\nå¦æéè¦ä½¿ç¨åä¸ä¸ªç¼å­æ³¨è§£ï¼@Cacheableã@CacheEvictæ@CachePutï¼å¤æ¬¡ä¿®é¥°ä¸ä¸ªæ¹æ³ï¼å°±éè¦ç¨å°@Cachingã\n\n@Caching(evict = { @CacheEvict("primary"), @CacheEvict(cacheNames="secondary", key="#p0") })\npublic Book importBooks(String deposit, Date date)\n\n\n# @CacheConfig\n\nä¸åé¢çç¼å­æ³¨è§£ä¸åï¼è¿æ¯ä¸ä¸ªç±»çº§å«çæ³¨è§£ã å¦æç±»çæææä½é½æ¯ç¼å­æä½ï¼ä½ å¯ä»¥ä½¿ç¨@CacheConfigæ¥æå®ç±»ï¼çå»ä¸äºéç½®ã\n\n@CacheConfig("books")\npublic class BookRepositoryImpl implements BookRepository {\n @Cacheable\n public Book findBook(ISBN isbn) {...}\n}\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * Ehcache å®ç½\n   * Ehcache Github\n * æç« \n   * Ehcache ä¼ç¼ºç¹ä»¥ååå¸å¼è¯¦è§£\n   * Ehcache è¯¦ç»è§£è¯»\n   * æ³¨éé©±å¨ç Spring cache ç¼å­ä»ç»\n   * Spring å®æ¹ææ¡£ç¬¬ 36 ç« ç¼å­æ½è±¡',normalizedContent:'# ehcache å¿«éå¥é¨\n\n> ehcache æ¯ä¸ä¸ªçº¯ java çè¿ç¨åç¼å­æ¡æ¶ï¼å·æå¿«éãç²¾å¹²ç­ç¹ç¹ï¼æ¯ hibernate ä¸­é»è®¤ç cacheproviderã\n\n\n\n\n# ä¸ãç®ä»\n\n> ehcache è½ç¶ä¹æ¯æåå¸å¼æ¨¡å¼ï¼ä½æ¯åå¸å¼æ¹æ¡ä¸æ¯å¾å¥½å¥½ï¼å»ºè®®åªå°å¶ä½ä¸ºåæºçè¿ç¨åç¼å­ä½¿ç¨ã\n\n\n# ehcache ç¹æ§\n\nä¼ç¹\n\n * å¿«éãç®å\n * æ¯æå¤ç§ç¼å­ç­ç¥ï¼lruãlfuãfifo æ·æ±°ç®æ³\n * ç¼å­æ°æ®æä¸¤çº§ï¼åå­åç£çï¼å æ­¤æ éæå¿å®¹éé®é¢\n * ç¼å­æ°æ®ä¼å¨èææºéå¯çè¿ç¨ä¸­åå¥ç£ç\n * å¯ä»¥éè¿ rmiãå¯æå¥ api ç­æ¹å¼è¿è¡åå¸å¼ç¼å­\n * å·æç¼å­åç¼å­ç®¡çå¨çä¾¦å¬æ¥å£\n * æ¯æå¤ç¼å­ç®¡çå¨å®ä¾ï¼ä»¥åä¸ä¸ªå®ä¾çå¤ä¸ªç¼å­åºå\n * æä¾ hibernate çç¼å­å®ç°\n\nç¼ºç¹\n\n * ä½¿ç¨ç£ç cache çæ¶åéå¸¸å ç¨ç£çç©ºé´\n * ä¸ä¿è¯æ°æ®çå®å¨\n * è½ç¶æ¯æåå¸å¼ç¼å­ï¼ä½æçä¸é«ï¼éè¿ç»æ­æ¹å¼ï¼å¨ä¸åèç¹ä¹é´åæ­¥æ°æ®ï¼ã\n\n\n# ehcache éç¾¤\n\nehcache ç®åæ¯æäºç§éç¾¤æ¹å¼ï¼\n\n * rmi\n * jms\n * jgroup\n * terracotta\n * ehcache server\n\n# rmi\n\nä½¿ç¨ç»æ­æ¹å¼éç¥ææèç¹åæ­¥æ°æ®ã\n\nå¦æç½ç»æé®é¢ï¼ææå°æå¡å®æºï¼åå­å¨æ°æ®æ æ³åæ­¥çå¯è½ï¼å¯¼è´æ°æ®ä¸ä¸è´ã\n\n\n\n# jms\n\njms ç±»ä¼¼ mqï¼ææèç¹è®¢éæ¶æ¯ï¼å½æèç¹ç¼å­åçååï¼å°±å jms åæ¶æ¯ï¼å¶ä»èç¹æç¥åååï¼åæ­¥æ°æ®ã\n\n\n\n# cache server\n\n\n\n\n# äºãå¿«éå¥é¨\n\n\n# å¼å¥ ehcache\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ maven ç®¡çï¼æ·»å ä»¥ä¸ä¾èµå°ä½ ç pom.xml ä¸­ã\n\n<dependency>\n  <groupid>net.sf.ehcache</groupid>\n  <artifactid>ehcache</artifactid>\n  <version>2.10.2</version>\n  <type>pom</type>\n</dependency>\n\n\nå¦æä½ çé¡¹ç®ä¸ä½¿ç¨ maven ç®¡çï¼è¯·å¨ ehcache å®ç½ä¸è½½å°å ä¸è½½ jar åã\n\nspring æä¾äºå¯¹äº ehcache æ¥å£çå°è£ï¼å¯ä»¥æ´ç®ä¾¿çä½¿ç¨å¶åè½ãæ¥å¥æ¹å¼å¦ä¸ï¼\n\nå¦æä½ çé¡¹ç®ä½¿ç¨ maven ç®¡çï¼æ·»å ä»¥ä¸ä¾èµå°ä½ çpom.xmlä¸­ã\n\nspring-context-supportè¿ä¸ª jar åä¸­å«æ spring å¯¹äºç¼å­åè½çæ½è±¡å°è£æ¥å£ã\n\n<dependency>\n  <groupid>org.springframework</groupid>\n  <artifactid>spring-context-support</artifactid>\n  <version>4.1.4.release</version>\n</dependency>\n\n\n\n# æ·»å éç½®æä»¶\n\nï¼1ï¼å¨ classpath ä¸æ·»å  ehcache.xml æ·»å ä¸ä¸ªåä¸º helloworld çç¼å­ã\n\n<?xml version="1.0" encoding="utf-8"?>\n<ehcache xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n         xsi:nonamespaceschemalocation="http://ehcache.org/ehcache.xsd">\n\n  \x3c!-- ç£çç¼å­ä½ç½® --\x3e\n  <diskstore path="java.io.tmpdir/ehcache"/>\n\n  \x3c!-- é»è®¤ç¼å­ --\x3e\n  <defaultcache\n          maxentrieslocalheap="10000"\n          eternal="false"\n          timetoidleseconds="120"\n          timetoliveseconds="120"\n          maxentrieslocaldisk="10000000"\n          diskexpirythreadintervalseconds="120"\n          memorystoreevictionpolicy="lru"/>\n\n  \x3c!-- helloworldç¼å­ --\x3e\n  <cache name="helloworld"\n         maxelementsinmemory="1000"\n         eternal="false"\n         timetoidleseconds="5"\n         timetoliveseconds="5"\n         overflowtodisk="false"\n         memorystoreevictionpolicy="lru"/>\n</ehcache>\n\n\n\n# ehcache å·¥ä½ç¤ºä¾\n\nehcache ä¼èªå¨å è½½ classpath æ ¹ç®å½ä¸åä¸º ehcache.xml æä»¶ã\n\nehcachedemo çå·¥ä½æ­¥éª¤å¦ä¸ï¼\n\n 1. å¨ ehcachedemo ä¸­ï¼æä»¬å¼ç¨ ehcache.xml å£°æçåä¸º helloworld çç¼å­æ¥åå»ºcacheå¯¹è±¡ï¼\n 2. ç¶åæä»¬ç¨ä¸ä¸ªé®å¼å¯¹æ¥å®ä¾åelementå¯¹è±¡ï¼\n 3. å°elementå¯¹è±¡æ·»å å°cacheï¼\n 4. ç¶åç¨cacheç get æ¹æ³è·åelementå¯¹è±¡ã\n\npublic class ehcachedemo {\n    public static void main(string[] args) throws exception {\n        // create a cache manager\n        final cachemanager cachemanager = new cachemanager();\n\n        // create the cache called "helloworld"\n        final cache cache = cachemanager.getcache("helloworld");\n\n        // create a key to map the data to\n        final string key = "greeting";\n\n        // create a data element\n        final element putgreeting = new element(key, "hello, world!");\n\n        // put the element into the data store\n        cache.put(putgreeting);\n\n        // retrieve the data element\n        final element getgreeting = cache.get(key);\n\n        // print the value\n        system.out.println(getgreeting.getobjectvalue());\n    }\n}\n\n\nè¾åº\n\nhello, world!\n\n\n\n# ä¸ãehcache api\n\nelementãcacheãcachemanageræ¯ ehcache æéè¦ç apiã\n\n * element - ç¼å­çåç´ ï¼å®ç»´æ¤çä¸ä¸ªé®å¼å¯¹ã\n * cache - å®æ¯ ehcache çæ ¸å¿ç±»ï¼å®æå¤ä¸ªelementï¼å¹¶è¢«cachemanagerç®¡çãå®å®ç°äºå¯¹ç¼å­çé»è¾è¡ä¸ºã\n * cachemanager - cacheçå®¹å¨å¯¹è±¡ï¼å¹¶ç®¡ççcacheççå½å¨æãcachemanager æ¯æä¸¤ç§åå»ºæ¨¡å¼ï¼åä¾ï¼singleton modeï¼åå®ä¾ï¼instancemodeï¼ã\n\n\n# åå»º cachemanager\n\nä¸é¢çä»£ç åä¸¾äºåå»º cachemanager çäºç§æ¹å¼ã\n\nä½¿ç¨éææ¹æ³create()ä¼ä»¥é»è®¤éç½®æ¥åå»ºåä¾çcachemanagerå®ä¾ã\n\nnewinstance()æ¹æ³æ¯ä¸ä¸ªå·¥åæ¹æ³ï¼ä»¥é»è®¤éç½®åå»ºä¸ä¸ªæ°çcachemanagerå®ä¾ã\n\næ­¤å¤ï¼newinstance()è¿æå ä¸ªéè½½å½æ°ï¼åå«å¯ä»¥éè¿ä¼ å¥stringãurlãinputstreamåæ°æ¥å è½½éç½®æä»¶ï¼ç¶ååå»ºcachemanagerå®ä¾ã\n\n// ä½¿ç¨ehcacheé»è®¤éç½®è·ååä¾çcachemanagerå®ä¾\ncachemanager.create();\nstring[] cachenames = cachemanager.getinstance().getcachenames();\n\n// ä½¿ç¨ehcacheé»è®¤éç½®æ°å»ºä¸ä¸ªcachemanagerå®ä¾\ncachemanager.newinstance();\nstring[] cachenames = manager.getcachenames();\n\n// ä½¿ç¨ä¸åçéç½®æä»¶åå«åå»ºä¸ä¸ªcachemanagerå®ä¾\ncachemanager manager1 = cachemanager.newinstance("src/config/ehcache1.xml");\ncachemanager manager2 = cachemanager.newinstance("src/config/ehcache2.xml");\nstring[] cachenamesformanager1 = manager1.getcachenames();\nstring[] cachenamesformanager2 = manager2.getcachenames();\n\n// åºäºclasspathä¸çéç½®æä»¶åå»ºcachemanagerå®ä¾\nurl url = getclass().getresource("/anotherconfigurationname.xml");\ncachemanager manager = cachemanager.newinstance(url);\n\n// åºäºæä»¶æµå¾å°éç½®æä»¶ï¼å¹¶åå»ºcachemanagerå®ä¾\ninputstream fis = new fileinputstream(new file\n("src/config/ehcache.xml").getabsolutepath());\ntry {\n cachemanager manager = cachemanager.newinstance(fis);\n} finally {\n fis.close();\n}\n\n\n\n# æ·»å ç¼å­\n\néè¦å¼ºè°ä¸ç¹ï¼cacheå¯¹è±¡å¨ç¨addcacheæ¹æ³æ·»å å°cachemanagerä¹åï¼æ¯æ æçã\n\nä½¿ç¨ cachemanager ç addcache æ¹æ³å¯ä»¥æ ¹æ®ç¼å­åå° ehcache.xml ä¸­å£°æç cache æ·»å å°å®¹å¨ä¸­ï¼å®ä¹å¯ä»¥ç´æ¥å° cache å¯¹è±¡æ·»å å°ç¼å­å®¹å¨ä¸­ã\n\ncacheæå¤ä¸ªæé å½æ°ï¼æä¾äºä¸åæ¹å¼å»å è½½ç¼å­çéç½®åæ°ã\n\nææ¶åï¼ä½ å¯è½éè¦ä½¿ç¨ api æ¥å¨æçæ·»å ç¼å­ï¼ä¸é¢çä¾å­å°±æä¾äºè¿æ ·çèä¾ã\n\n// é¤äºå¯ä»¥ä½¿ç¨xmlæä»¶ä¸­éç½®çç¼å­ï¼ä½ ä¹å¯ä»¥ä½¿ç¨apiå¨æå¢å ç¼å­\n// æ·»å ç¼å­\nmanager.addcache(cachename);\n\n// ä½¿ç¨é»è®¤éç½®æ·»å ç¼å­\ncachemanager singletonmanager = cachemanager.create();\nsingletonmanager.addcache("testcache");\ncache test = singletonmanager.getcache("testcache");\n\n// ä½¿ç¨èªå®ä¹éç½®æ·»å ç¼å­ï¼æ³¨æç¼å­æªæ·»å è¿cachemanagerä¹åå¹¶ä¸å¯ç¨\ncachemanager singletonmanager = cachemanager.create();\ncache memoryonlycache = new cache("testcache", 5000, false, false, 5, 2);\nsingletonmanager.addcache(memoryonlycache);\ncache test = singletonmanager.getcache("testcache");\n\n// ä½¿ç¨ç¹å®çéç½®æ·»å ç¼å­\ncachemanager manager = cachemanager.create();\ncache testcache = new cache(\n new cacheconfiguration("testcache", maxentrieslocalheap)\n .memorystoreevictionpolicy(memorystoreevictionpolicy.lfu)\n .eternal(false)\n .timetoliveseconds(60)\n .timetoidleseconds(30)\n .diskexpirythreadintervalseconds(0)\n .persistence(new persistenceconfiguration().strategy(strategy.localtempswap)));\n manager.addcache(testcache);\n\n\n\n# å é¤ç¼å­\n\nå é¤ç¼å­æ¯è¾ç®åï¼ä½ åªéè¦å°æå®çç¼å­åä¼ å¥removecacheæ¹æ³å³å¯ã\n\ncachemanager singletonmanager = cachemanager.create();\nsingletonmanager.removecache("samplecache1");\n\n\n\n# åºæ¬ç¼å­æä½\n\ncache æéè¦çä¸¤ä¸ªæ¹æ³å°±æ¯ put å getï¼åå«ç¨æ¥æ·»å  element åè·å elementã\n\ncache è¿æä¾äºä¸ç³»åç getãset æ¹æ³æ¥è®¾ç½®æè·åç¼å­åæ°ï¼è¿éä¸ä¸ä¸åä¸¾ï¼æ´å¤ api æä½å¯åèå®æ¹ api å¼åæåã\n\n/**\n * æµè¯ï¼ä½¿ç¨é»è®¤éç½®æä½¿ç¨æå®éç½®æ¥åå»ºcachemanager\n *\n * @author zhang peng\n */\npublic class cacheoperationtest {\n    private final logger log = loggerfactory.getlogger(cacheoperationtest.class);\n\n    /**\n     * ä½¿ç¨ehcacheé»è®¤éç½®(classpathä¸çehcache.xml)è·ååä¾çcachemanagerå®ä¾\n     */\n    @test\n    public void operation() {\n        cachemanager manager = cachemanager.newinstance("src/test/resources/ehcache/ehcache.xml");\n\n        // è·å¾cacheçå¼ç¨\n        cache cache = manager.getcache("usercache");\n\n        // å°ä¸ä¸ªelementæ·»å å°cache\n        cache.put(new element("key1", "value1"));\n\n        // è·åelementï¼elementç±»æ¯æåºååï¼æä»¥ä¸é¢ä¸¤ç§æ¹æ³é½å¯ä»¥ç¨\n        element element1 = cache.get("key1");\n        // è·åéåºååçå¼\n        log.debug("key:{}, value:{}", element1.getobjectkey(), element1.getobjectvalue());\n        // è·ååºååçå¼\n        log.debug("key:{}, value:{}", element1.getkey(), element1.getvalue());\n\n        // æ´æ°cacheä¸­çelement\n        cache.put(new element("key1", "value2"));\n        element element2 = cache.get("key1");\n        log.debug("key:{}, value:{}", element2.getobjectkey(), element2.getobjectvalue());\n\n        // è·åcacheçåç´ æ°\n        log.debug("cache size:{}", cache.getsize());\n\n        // è·åmemorystoreçåç´ æ°\n        log.debug("memorystoresize:{}", cache.getmemorystoresize());\n\n        // è·ådiskstoreçåç´ æ°\n        log.debug("diskstoresize:{}", cache.getdiskstoresize());\n\n        // ç§»é¤element\n        cache.remove("key1");\n        log.debug("cache size:{}", cache.getsize());\n\n        // å³é­å½åcachemanagerå¯¹è±¡\n        manager.shutdown();\n\n        // å³é­cachemanageråä¾å®ä¾\n        cachemanager.getinstance().shutdown();\n    }\n}\n\n\n\n# åãehcache éç½®\n\n> ehcache æ¯æéè¿ xml æä»¶å api ä¸¤ç§æ¹å¼è¿è¡éç½®ã\n> \n> è¯¦æåèï¼ehcache å®æ¹ xml éç½®æå\n\n\n# xml éç½®æ¹å¼\n\nehcache çcachemanageræé å½æ°æå·¥åæ¹æ³è¢«è°ç¨æ¶ï¼ä¼é»è®¤å è½½ classpath ä¸åä¸ºehcache.xmlçéç½®æä»¶ãå¦æå è½½å¤±è´¥ï¼ä¼å è½½ ehcache jar åä¸­çehcache-failsafe.xmlæä»¶ï¼è¿ä¸ªæä»¶ä¸­å«æç®åçé»è®¤éç½®ã ehcache.xml éç½®åæ°è¯´æï¼\n\n * nameï¼ç¼å­åç§°ã\n * maxelementsinmemoryï¼ç¼å­æå¤§ä¸ªæ°ã\n * eternalï¼ç¼å­ä¸­å¯¹è±¡æ¯å¦ä¸ºæ°¸ä¹çï¼å¦ææ¯ï¼è¶æ¶è®¾ç½®å°è¢«å¿½ç¥ï¼å¯¹è±¡ä»ä¸è¿æã\n * timetoidlesecondsï¼ç½®å¯¹è±¡å¨å¤±æåçåè®¸é²ç½®æ¶é´ï¼åä½ï¼ç§ï¼ãä»å½ eternal=false å¯¹è±¡ä¸æ¯æ°¸ä¹æææ¶ä½¿ç¨ï¼å¯éå±æ§ï¼é»è®¤å¼æ¯ 0ï¼ä¹å°±æ¯å¯é²ç½®æ¶é´æ ç©·å¤§ã\n * timetolivesecondsï¼ç¼å­æ°æ®ççå­æ¶é´ï¼ttlï¼ï¼ä¹å°±æ¯ä¸ä¸ªåç´ ä»æå»ºå°æ¶äº¡çæå¤§æ¶é´é´éå¼ï¼è¿åªè½å¨åç´ ä¸æ¯æ°¸ä¹é©»çæ¶ææï¼å¦æè¯¥å¼æ¯ 0 å°±æå³çåç´ å¯ä»¥åé¡¿æ ç©·é¿çæ¶é´ã\n * maxentrieslocaldiskï¼å½åå­ä¸­å¯¹è±¡æ°éè¾¾å° maxelementsinmemory æ¶ï¼ehcache å°ä¼å¯¹è±¡åå°ç£çä¸­ã\n * overflowtodiskï¼åå­ä¸è¶³æ¶ï¼æ¯å¦å¯ç¨ç£çç¼å­ã\n * diskspoolbuffersizembï¼è¿ä¸ªåæ°è®¾ç½® diskstoreï¼ç£çç¼å­ï¼çç¼å­åºå¤§å°ãé»è®¤æ¯ 30mbãæ¯ä¸ª cache é½åºè¯¥æèªå·±çä¸ä¸ªç¼å²åºã\n * maxelementsondiskï¼ç¡¬çæå¤§ç¼å­ä¸ªæ°ã\n * diskpersistentï¼æ¯å¦å¨ vm éå¯æ¶å­å¨ç¡¬ççç¼å­æ°æ®ãé»è®¤å¼æ¯ falseã\n * diskexpirythreadintervalsecondsï¼ç£çå¤±æçº¿ç¨è¿è¡æ¶é´é´éï¼é»è®¤æ¯ 120 ç§ã\n * memorystoreevictionpolicyï¼å½è¾¾å° maxelementsinmemory éå¶æ¶ï¼ehcache å°ä¼æ ¹æ®æå®çç­ç¥å»æ¸çåå­ãé»è®¤ç­ç¥æ¯ lruï¼æè¿æå°ä½¿ç¨ï¼ãä½ å¯ä»¥è®¾ç½®ä¸º fifoï¼åè¿ååºï¼ææ¯ lfuï¼è¾å°ä½¿ç¨ï¼ã\n * clearonflushï¼åå­æ°éæå¤§æ¶æ¯å¦æ¸é¤ã\n\n\n# api éç½®æ¹å¼\n\nxml éç½®çåæ°ä¹å¯ä»¥ç´æ¥éè¿ç¼ç¨æ¹å¼æ¥å¨æçè¿è¡éç½®ï¼dynamicconfig æ²¡æè®¾ä¸º falseï¼ã\n\ncache cache = manager.getcache("samplecache");\ncacheconfiguration config = cache.getcacheconfiguration();\nconfig.settimetoidleseconds(60);\nconfig.settimetoliveseconds(120);\nconfig.setmaxentrieslocalheap(10000);\nconfig.setmaxentrieslocaldisk(1000000);\n\n\nä¹å¯ä»¥éè¿disabledynamicfeatures()æ¹å¼å³é­å¨æéç½®å¼å³ãéç½®ä»¥åä½ å°æ æ³åä»¥ç¼ç¨æ¹å¼éç½®åæ°ã\n\ncache cache = manager.getcache("samplecache");\ncache.disabledynamicfeatures();\n\n\n\n# äºãspring éæ ehcache\n\nspring3.1 å¼å§æ·»å äºå¯¹ç¼å­çæ¯æãåäºå¡åè½çæ¯ææ¹å¼ç±»ä¼¼ï¼ç¼å­æ½è±¡åè®¸åºå±ä½¿ç¨ä¸åçç¼å­è§£å³æ¹æ¡æ¥è¿è¡æ´åã\n\nspring4.1 å¼å§æ¯æ jsr-107 æ³¨è§£ã\n\n> æ³¨ï¼ææ¬äººä½¿ç¨ç spring çæ¬ä¸º 4.1.4.releaseï¼ç®å spring çæ¬ä»æ¯æ ehcache2.5 ä»¥ä¸çæ¬ï¼ä½ä¸æ¯æ ehcache3ã\n\n\n# ç»å® ehcache\n\norg.springframework.cache.ehcache.ehcachemanagerfactorybeanè¿ä¸ªç±»çä½ç¨æ¯å è½½ ehcache éç½®æä»¶ã org.springframework.cache.ehcache.ehcachecachemanagerè¿ä¸ªç±»çä½ç¨æ¯æ¯æ net.sf.ehcache.cachemanagerã\n\nspring-ehcache.xmlçéç½®\n\n<?xml version="1.0" encoding="utf-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n       xmlns:cache="http://www.springframework.org/schema/cache"\n       xsi:schemalocation="http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n        http://www.springframework.org/schema/cache\n        http://www.springframework.org/schema/cache/spring-cache-3.2.xsd">\n\n  <description>ehcacheç¼å­éç½®ç®¡çæä»¶</description>\n\n  <bean id="ehcache" class="org.springframework.cache.ehcache.ehcachemanagerfactorybean">\n    <property name="configlocation" value="classpath:ehcache/ehcache.xml"/>\n  </bean>\n\n  <bean id="cachemanager" class="org.springframework.cache.ehcache.ehcachecachemanager">\n    <property name="cachemanager" ref="ehcache"/>\n  </bean>\n\n  \x3c!-- å¯ç¨ç¼å­æ³¨è§£å¼å³ --\x3e\n  <cache:annotation-driven cache-manager="cachemanager"/>\n</beans>\n\n\n\n# ä½¿ç¨ spring çç¼å­æ³¨è§£\n\n# å¼å¯æ³¨è§£\n\nspring ä¸ºç¼å­åè½æä¾äºæ³¨è§£åè½ï¼ä½æ¯ä½ å¿é¡»å¯å¨æ³¨è§£ã ä½ æä¸¤ä¸ªéæ©ï¼ (1) å¨ xml ä¸­å£°æ åä¸ä¸è spring-ehcache.xml ä¸­çåæ³ä¸æ ·ï¼ä½¿ç¨<cache:annotation-driven/>\n\n<cache:annotation-driven cache-manager="cachemanager"/>\n\n\n(2) ä½¿ç¨æ è®°æ³¨è§£ ä½ ä¹å¯ä»¥éè¿å¯¹ä¸ä¸ªç±»è¿è¡æ³¨è§£ä¿®é¥°çæ¹å¼å¨è¿ä¸ªç±»ä¸­ä½¿ç¨ç¼å­æ³¨è§£ã èä¾å¦ä¸ï¼\n\n@configuration\n@enablecaching\npublic class appconfig {\n}\n\n\n\n# æ³¨è§£åºæ¬ä½¿ç¨æ¹æ³\n\nspring å¯¹ç¼å­çæ¯æç±»ä¼¼äºå¯¹äºå¡çæ¯æã é¦åä½¿ç¨æ³¨è§£æ è®°æ¹æ³ï¼ç¸å½äºå®ä¹äºåç¹ï¼ç¶åä½¿ç¨ aop ææ¯å¨è¿ä¸ªæ¹æ³çè°ç¨åãè°ç¨åè·åæ¹æ³çå¥ååè¿åå¼ï¼è¿èå®ç°äºç¼å­çé»è¾ã ä¸é¢ä¸ä¸ªæ³¨è§£é½æ¯æ¹æ³çº§å«ï¼\n\n# @cacheable\n\nè¡¨ææä¿®é¥°çæ¹æ³æ¯å¯ä»¥ç¼å­çï¼å½ç¬¬ä¸æ¬¡è°ç¨è¿ä¸ªæ¹æ³æ¶ï¼å®çç»æä¼è¢«ç¼å­ä¸æ¥ï¼å¨ç¼å­çæææ¶é´åï¼ä»¥åè®¿é®è¿ä¸ªæ¹æ³é½ç´æ¥è¿åç¼å­ç»æï¼ä¸åæ§è¡æ¹æ³ä¸­çä»£ç æ®µã è¿ä¸ªæ³¨è§£å¯ä»¥ç¨conditionå±æ§æ¥è®¾ç½®æ¡ä»¶ï¼å¦æä¸æ»¡è¶³æ¡ä»¶ï¼å°±ä¸ä½¿ç¨ç¼å­è½åï¼ç´æ¥æ§è¡æ¹æ³ã å¯ä»¥ä½¿ç¨keyå±æ§æ¥æå® key ççæè§åã\n\n# @cacheput\n\nä¸@cacheableä¸åï¼@cacheputä¸ä»ä¼ç¼å­æ¹æ³çç»æï¼è¿ä¼æ§è¡æ¹æ³çä»£ç æ®µã å®æ¯æçå±æ§åç¨æ³é½ä¸@cacheableä¸è´ã\n\n# @cacheevict\n\nä¸@cacheableåè½ç¸åï¼@cacheevictè¡¨ææä¿®é¥°çæ¹æ³æ¯ç¨æ¥å é¤å¤±æææ ç¨çç¼å­æ°æ®ã ä¸é¢æ¯@cacheableã@cacheevictå@cacheputåºæ¬ä½¿ç¨æ¹æ³çä¸ä¸ªéä¸­å±ç¤ºï¼\n\n@service\npublic class userservice {\n    // @cacheableå¯ä»¥è®¾ç½®å¤ä¸ªç¼å­ï¼å½¢å¼å¦ï¼@cacheable({"books", "isbns"})\n    @cacheable(value={"users"}, key="#user.id")\n    public user finduser(user user) {\n        return finduserindb(user.getid());\n    }\n\n    @cacheable(value = "users", condition = "#user.getid() <= 2")\n    public user finduserinlimit(user user) {\n        return finduserindb(user.getid());\n    }\n\n    @cacheput(value = "users", key = "#user.getid()")\n    public void updateuser(user user) {\n        updateuserindb(user);\n    }\n\n    @cacheevict(value = "users")\n    public void removeuser(user user) {\n        removeuserindb(user.getid());\n    }\n\n    @cacheevict(value = "users", allentries = true)\n    public void clear() {\n        removeallindb();\n    }\n}\n\n\n# @caching\n\nå¦æéè¦ä½¿ç¨åä¸ä¸ªç¼å­æ³¨è§£ï¼@cacheableã@cacheevictæ@cacheputï¼å¤æ¬¡ä¿®é¥°ä¸ä¸ªæ¹æ³ï¼å°±éè¦ç¨å°@cachingã\n\n@caching(evict = { @cacheevict("primary"), @cacheevict(cachenames="secondary", key="#p0") })\npublic book importbooks(string deposit, date date)\n\n\n# @cacheconfig\n\nä¸åé¢çç¼å­æ³¨è§£ä¸åï¼è¿æ¯ä¸ä¸ªç±»çº§å«çæ³¨è§£ã å¦æç±»çæææä½é½æ¯ç¼å­æä½ï¼ä½ å¯ä»¥ä½¿ç¨@cacheconfigæ¥æå®ç±»ï¼çå»ä¸äºéç½®ã\n\n@cacheconfig("books")\npublic class bookrepositoryimpl implements bookrepository {\n @cacheable\n public book findbook(isbn isbn) {...}\n}\n\n\n\n# åèèµæ\n\n * å®æ¹\n   * ehcache å®ç½\n   * ehcache github\n * æç« \n   * ehcache ä¼ç¼ºç¹ä»¥ååå¸å¼è¯¦è§£\n   * ehcache è¯¦ç»è§£è¯»\n   * æ³¨éé©±å¨ç spring cache ç¼å­ä»ç»\n   * spring å®æ¹ææ¡£ç¬¬ 36 ç« ç¼å­æ½è±¡',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java è¿ç¨åç¼å­",frontmatter:{title:"Java è¿ç¨åç¼å­",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["Java","ä¸­é´ä»¶","ç¼å­"],abbrlink:"bd2603d3",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/9632fd/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/05.Java%E8%BF%9B%E7%A8%8B%E5%86%85%E7%BC%93%E5%AD%98.html",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/05.Javaè¿ç¨åç¼å­.md",key:"v-1f77f9ec",path:"/pages/9632fd/",headers:[{level:2,title:"ä¸ãConcurrentHashMap",slug:"ä¸ãconcurrenthashmap",normalizedTitle:"ä¸ãconcurrenthashmap",charIndex:82},{level:2,title:"äºãLRUHashMap",slug:"äºãlruhashmap",normalizedTitle:"äºãlruhashmap",charIndex:203},{level:2,title:"ä¸ãGuava Cache",slug:"ä¸ãguava-cache",normalizedTitle:"ä¸ãguava cache",charIndex:1310},{level:3,title:"Guava Cache ç¼å­åæ¶",slug:"guava-cache-ç¼å­åæ¶",normalizedTitle:"guava cache ç¼å­åæ¶",charIndex:1735},{level:3,title:"åºäºå®¹éåæ¶",slug:"åºäºå®¹éåæ¶",normalizedTitle:"åºäºå®¹éåæ¶",charIndex:1785},{level:3,title:"åºäºå®æ¶åæ¶",slug:"åºäºå®æ¶åæ¶",normalizedTitle:"åºäºå®æ¶åæ¶",charIndex:1836},{level:3,title:"åºäºå¼ç¨åæ¶",slug:"åºäºå¼ç¨åæ¶",normalizedTitle:"åºäºå¼ç¨åæ¶",charIndex:1415},{level:3,title:"Guava Cache æ ¸å¿ API",slug:"guava-cache-æ ¸å¿-api",normalizedTitle:"guava cache æ ¸å¿ api",charIndex:2274},{level:4,title:"CacheBuilder",slug:"cachebuilder",normalizedTitle:"cachebuilder",charIndex:1455},{level:4,title:"LocalManualCache",slug:"localmanualcache",normalizedTitle:"localmanualcache",charIndex:2475},{level:4,title:"LocalLoadingCache",slug:"localloadingcache",normalizedTitle:"localloadingcache",charIndex:2581},{level:4,title:"LocalCache",slug:"localcache",normalizedTitle:"localcache",charIndex:1497},{level:2,title:"åãCaffeine",slug:"åãcaffeine",normalizedTitle:"åãcaffeine",charIndex:2876},{level:2,title:"äºãEhcache",slug:"äºãehcache",normalizedTitle:"äºãehcache",charIndex:3030},{level:2,title:"å­ãè¿ç¨åç¼å­å¯¹æ¯",slug:"å­ãè¿ç¨åç¼å­å¯¹æ¯",normalizedTitle:"å­ãè¿ç¨åç¼å­å¯¹æ¯",charIndex:3058},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:4513}],headersStr:"ä¸ãConcurrentHashMap äºãLRUHashMap ä¸ãGuava Cache Guava Cache ç¼å­åæ¶ åºäºå®¹éåæ¶ åºäºå®æ¶åæ¶ åºäºå¼ç¨åæ¶ Guava Cache æ ¸å¿ API CacheBuilder LocalManualCache LocalLoadingCache LocalCache åãCaffeine äºãEhcache å­ãè¿ç¨åç¼å­å¯¹æ¯ åèèµæ",content:"# Java è¿ç¨åç¼å­\n\n> å³é®è¯ï¼ConcurrentHashMapãLRUHashMapãGuava CacheãCaffeineãEhcache\n\n\n# ä¸ãConcurrentHashMap\n\næç®åçè¿ç¨åç¼å­å¯ä»¥éè¿ JDK èªå¸¦ç HashMap æ ConcurrentHashMap å®ç°ã\n\néç¨åºæ¯ï¼ä¸éè¦æ·æ±°çç¼å­æ°æ®ã\n\nç¼ºç¹ï¼æ æ³è¿è¡ç¼å­æ·æ±°ï¼åå­ä¼æ éå¶çå¢é¿ã\n\n\n# äºãLRUHashMap\n\nå¯ä»¥éè¿ç»§æ¿ LinkedHashMap æ¥å®ç°ä¸ä¸ªç®åç LRUHashMapï¼å³å¯å®æä¸ä¸ªç®åç **LRU ï¼æè¿æå°ä½¿ç¨ï¼**ç®æ³ã\n\nç¼ºç¹ï¼\n\n * éç«äºä¸¥éï¼æ§è½æ¯è¾ä½ã\n * ä¸æ¯æè¿ææ¶é´\n * ä¸æ¯æèªå¨å·æ°\n\nãç¤ºä¾ãLRUHashMap çç®åå®ç°\n\nclass LRUCache extends LinkedHashMap {\n\n    private final int max;\n    private Object lock;\n\n    public LRUCache(int max) {\n        //æ éæ©å®¹\n        super((int) (max * 1.4f), 0.75f, true);\n        this.max = max;\n        this.lock = new Object();\n    }\n\n    /**\n     * éåLinkedHashMapçremoveEldestEntryæ¹æ³å³å¯ å¨Putçæ¶åå¤æ­ï¼å¦æä¸ºtrueï¼å°±ä¼å é¤æèç\n     *\n     * @param eldest\n     * @return\n     */\n    @Override\n    protected boolean removeEldestEntry(Map.Entry eldest) {\n        return size() > max;\n    }\n\n    public Object getValue(Object key) {\n        synchronized (lock) {\n            return get(key);\n        }\n    }\n\n    public void putValue(Object key, Object value) {\n        synchronized (lock) {\n            put(key, value);\n        }\n    }\n\n    public boolean removeValue(Object key) {\n        synchronized (lock) {\n            return remove(key) != null;\n        }\n    }\n\n    public boolean removeAll() {\n        clear();\n        return true;\n    }\n\n}\n\n\n\n# ä¸ãGuava Cache\n\nGuava Cache è§£å³äº LRUHashMap ä¸­çå ä¸ªç¼ºç¹ã\n\nGuava Cache æä¾äºåºäºå®¹éï¼æ¶é´åå¼ç¨çç¼å­åæ¶æ¹å¼ãåºäºå®¹éçæ¹å¼åé¨å®ç°éç¨ LRU ç®æ³ï¼åºäºå¼ç¨åæ¶å¾å¥½çå©ç¨äº Java èææºçåå¾åæ¶æºå¶ã\n\nå¶ä¸­çç¼å­æé å¨ CacheBuilder éç¨æå»ºèæ¨¡å¼æä¾äºè®¾ç½®å¥½åç§åæ°çç¼å­å¯¹è±¡ãç¼å­æ ¸å¿ç±» LocalCache éé¢çåé¨ç±» Segment ä¸ jdk1.7 åä»¥åç ConcurrentHashMap éå¸¸ç¸ä¼¼ï¼åæ®µå éï¼åå°éç«äºï¼å¹¶ä¸é½ç»§æ¿äº ReetrantLockï¼è¿æå­ä¸ªéåï¼ä»¥å®ç°ä¸°å¯çæ¬å°ç¼å­æ¹æ¡ãGuava Cache å¯¹äºè¿æç Entry å¹¶æ²¡æé©¬ä¸è¿æ(ä¹å°±æ¯å¹¶æ²¡æåå°çº¿ç¨ä¸ç´å¨æ«)ï¼èæ¯éè¿è¿è¡è¯»åæä½çæ¶åè¿è¡è¿æå¤çï¼è¿æ ·åçå¥½å¤æ¯é¿ååå°çº¿ç¨æ«æçæ¶åè¿è¡å¨å±å éã\n\nç´æ¥éè¿æ¥è¯¢ï¼å¤æ­å¶æ¯å¦æ»¡è¶³å·æ°æ¡ä»¶ï¼è¿è¡å·æ°ã\n\n\n# Guava Cache ç¼å­åæ¶\n\nGuava Cache æä¾äºä¸ç§åºæ¬çç¼å­åæ¶æ¹å¼ã\n\n\n# åºäºå®¹éåæ¶\n\nmaximumSize(long)ï¼å½ç¼å­ä¸­çåç´ æ°éè¶è¿æå®å¼æ¶è§¦ååæ¶ã\n\n\n# åºäºå®æ¶åæ¶\n\n * expireAfterAccess(long, TimeUnit)ï¼ç¼å­é¡¹å¨ç»å®æ¶é´åæ²¡æè¢«è¯»/åè®¿é®ï¼ååæ¶ãè¯·æ³¨æè¿ç§ç¼å­çåæ¶é¡ºåºååºäºå¤§å°åæ¶ä¸æ ·ã\n * expireAfterWrite(long, TimeUnit)ï¼ç¼å­é¡¹å¨ç»å®æ¶é´åæ²¡æè¢«åè®¿é®ï¼åå»ºæè¦çï¼ï¼ååæ¶ãå¦æè®¤ä¸ºç¼å­æ°æ®æ»æ¯å¨åºå®æ¶åååå¾éæ§ä¸å¯ç¨ï¼è¿ç§åæ¶æ¹å¼æ¯å¯åçã\n\nå¦ä¸ææè®¨è®ºï¼å®æ¶åæ¶å¨ææ§å°å¨åæä½ä¸­æ§è¡ï¼å¶å°å¨è¯»æä½ä¸­æ§è¡ã\n\n\n# åºäºå¼ç¨åæ¶\n\n * CacheBuilder.weakKeys()ï¼ä½¿ç¨å¼±å¼ç¨å­å¨é®ãå½é®æ²¡æå¶å®ï¼å¼ºæè½¯ï¼å¼ç¨æ¶ï¼ç¼å­é¡¹å¯ä»¥è¢«åå¾åæ¶ã\n * CacheBuilder.weakValues()ï¼ä½¿ç¨å¼±å¼ç¨å­å¨å¼ãå½å¼æ²¡æå¶å®ï¼å¼ºæè½¯ï¼å¼ç¨æ¶ï¼ç¼å­é¡¹å¯ä»¥è¢«åå¾åæ¶ã\n * CacheBuilder.softValues()ï¼ä½¿ç¨è½¯å¼ç¨å­å¨å¼ãè½¯å¼ç¨åªæå¨ååºåå­éè¦æ¶ï¼ææç§å¨å±æè¿æå°ä½¿ç¨çé¡ºåºåæ¶ã\n\n\n# Guava Cache æ ¸å¿ API\n\n# CacheBuilder\n\nç¼å­æå»ºå¨ãæå»ºç¼å­çå¥å£ï¼æå®ç¼å­éç½®åæ°å¹¶åå§åæ¬å°ç¼å­ã ä¸»è¦éç¨ builder çæ¨¡å¼ï¼CacheBuilder çæ¯ä¸ä¸ªæ¹æ³é½è¿åè¿ä¸ª CacheBuilder ç¥é build æ¹æ³çè°ç¨ã æ³¨æ build æ¹æ³æéè½½ï¼å¸¦æåæ°çä¸ºæå»ºä¸ä¸ªå·ææ°æ®å è½½åè½çç¼å­ï¼ä¸å¸¦åæ°çæå»ºä¸ä¸ªæ²¡ææ°æ®å è½½åè½çç¼å­ã\n\n# LocalManualCache\n\nä½ä¸º LocalCache çä¸ä¸ªåé¨ç±»ï¼å¨æé æ¹æ³éé¢ä¼æ LocalCache ç±»åçåéä¼ å¥ï¼å¹¶ä¸è°ç¨æ¹æ³æ¶é½ç´æ¥æèé´æ¥è°ç¨ LocalCache éé¢çæ¹æ³ã\n\n# LocalLoadingCache\n\nå¯ä»¥çå°è¯¥ç±»ç»§æ¿äº LocalManualCache å¹¶å®ç°æ¥å£ LoadingCacheã è¦çäº getï¼getUnchecked ç­æ¹æ³ã\n\n# LocalCache\n\nGuava Cache ä¸­çæ ¸å¿ç±»ï¼éç¹äºè§£ã\n\nLocalCache çæ°æ®ç»æä¸ ConcurrentHashMap å¾ç¸ä¼¼ï¼é½ç±å¤ä¸ª segment ç»æï¼ä¸å segment ç¸å¯¹ç¬ç«ï¼äºä¸å½±åï¼æä»¥è½æ¯æå¹¶è¡æä½ãæ¯ä¸ª segment ç±ä¸ä¸ª table åè¥å¹²éåç»æãç¼å­æ°æ®å­å¨å¨ table ä¸­ï¼å¶ç±»åä¸º AtomicReferenceArrayã\n\n\n# åãCaffeine\n\n> caffeine æ¯ä¸ä¸ªä½¿ç¨ JDK8 æ¹è¿ Guava ç¼å­çé«æ§è½ç¼å­åºã\n\nCaffeine å®ç°äº W-TinyLFU(LFU + LRU ç®æ³çåç§)ï¼å¶å½ä¸­çåè¯»åååéå¤§å¤§ä¼äº Guava Cacheã\n\nå¶å®ç°åçè¾å¤æï¼å¯ä»¥åèä½ åºè¯¥ç¥éçç¼å­è¿åå²ã\n\n\n# äºãEhcache\n\n> åèï¼Ehcache\n\n\n# å­ãè¿ç¨åç¼å­å¯¹æ¯\n\nå¸¸ç¨è¿ç¨åç¼å­ææ¯å¯¹æ¯ï¼\n\næ¯è¾é¡¹      CONCURRENTHASHMAP   LRUMAP                EHCACHE                 GUAVA CACHE             CAFFEINE\nè¯»åæ§è½     å¾å¥½ï¼åæ®µé              ä¸è¬ï¼å¨å±å é               å¥½                       å¥½ï¼éè¦åæ·æ±°æä½               å¾å¥½\næ·æ±°ç®æ³     æ                    LRUï¼ä¸è¬                æ¯æå¤ç§æ·æ±°ç®æ³,LRU,LFU,FIFO   LRUï¼ä¸è¬                  W-TinyLFU, å¾å¥½\nåè½ä¸°å¯ç¨åº¦   åè½æ¯è¾ç®å              åè½æ¯è¾åä¸                åè½å¾ä¸°å¯                   åè½å¾ä¸°å¯ï¼æ¯æå·æ°åèå¼ç¨ç­         åè½å Guava Cache ç±»ä¼¼\nå·¥å·å¤§å°     jdk èªå¸¦ç±»ï¼å¾å°          åºäº LinkedHashMapï¼è¾å°   å¾å¤§ï¼ææ°çæ¬ 1.4MB           æ¯ Guava å·¥å·ç±»ä¸­çä¸ä¸ªå°é¨åï¼è¾å°   ä¸è¬ï¼ææ°çæ¬ 644KB\næ¯å¦æä¹å    å¦                   å¦                     æ¯                       å¦                       å¦\næ¯å¦æ¯æéç¾¤   å¦                   å¦                     æ¯                       å¦                       å¦\n\n * ConcurrentHashMap - æ¯è¾éåç¼å­æ¯è¾åºå®ä¸åçåç´ ï¼ä¸ç¼å­çæ°éè¾å°çãè½ç¶ä»ä¸é¢è¡¨æ ¼ä¸­æ¯èµ·æ¥æç¹éè²ï¼ä½æ¯å¶ç±äºæ¯ JDK èªå¸¦çç±»ï¼å¨åç§æ¡æ¶ä¸­ä¾ç¶æå¤§éçä½¿ç¨ï¼æ¯å¦æä»¬å¯ä»¥ç¨æ¥ç¼å­æä»¬åå°ç Methodï¼Field ç­ç­ï¼ä¹å¯ä»¥ç¼å­ä¸äºé¾æ¥ï¼é²æ­¢å¶éå¤å»ºç«ãå¨ Caffeine ä¸­ä¹æ¯ä½¿ç¨ç ConcurrentHashMap æ¥å­å¨åç´ ã\n * LRUMap - å¦æä¸æ³å¼å¥ç¬¬ä¸æ¹åï¼åæ³ä½¿ç¨æ·æ±°ç®æ³æ·æ±°æ°æ®ï¼å¯ä»¥ä½¿ç¨è¿ä¸ªã\n * Ehcache - ç±äºå¶ jar åå¾å¤§ï¼è¾ééçº§ãå¯¹äºéè¦æä¹ååéç¾¤çä¸äºåè½çï¼å¯ä»¥éæ© Ehcacheãéè¦æ³¨æçæ¯ï¼è½ç¶ Ehcache ä¹æ¯æåå¸å¼ç¼å­ï¼ä½æ¯ç±äºå¶èç¹é´éä¿¡æ¹å¼ä¸º rmiï¼è¡¨ç°ä¸å¦ Redisï¼æä»¥ä¸è¬ä¸å»ºè®®ç¨å®æ¥ä½ä¸ºåå¸å¼ç¼å­ã\n * Guava Cache - Guava è¿ä¸ª jar åå¨å¾å¤ Java åºç¨ç¨åºä¸­é½æå¤§éçå¼å¥ï¼æä»¥å¾å¤æ¶åå¶å®æ¯ç´æ¥ç¨å°±å¥½äºï¼å¹¶ä¸å¶æ¬èº«æ¯è½»éçº§çèä¸åè½è¾ä¸ºä¸°å¯ï¼å¨ä¸äºè§£ Caffeine çæåµä¸å¯ä»¥éæ© Guava Cacheã\n * Caffeine - å¶å¨å½ä¸­çï¼è¯»åæ§è½ä¸é½æ¯ Guava Cache å¥½å¾å¤ï¼å¹¶ä¸å¶ API å Guava cache åºæ¬ä¸è´ï¼çè³ä¼å¤ä¸ç¹ãå¨çå®ç¯å¢ä¸­ä½¿ç¨ Caffeineï¼åå¾è¿ä¸éçææã\n\næ»ç»ä¸ä¸ï¼å¦æä¸éè¦æ·æ±°ç®æ³åéæ© ConcurrentHashMapï¼å¦æéè¦æ·æ±°ç®æ³åä¸äºä¸°å¯ç APIï¼æ¨èéæ© Caffeineã\n\n\n# åèèµæ\n\n * caffeine github\n * æ·±å¥è§£å¯æ¥èªæªæ¥çç¼å­-Caffeine\n * Caffeine ç¼å­\n * Google Guava å®æ¹æç¨ï¼ä¸­æçï¼\n * Google Guava Cache å¨è§£æ\n * æ³¨éé©±å¨ç Spring cache ç¼å­ä»ç»",normalizedContent:"# java è¿ç¨åç¼å­\n\n> å³é®è¯ï¼concurrenthashmapãlruhashmapãguava cacheãcaffeineãehcache\n\n\n# ä¸ãconcurrenthashmap\n\næç®åçè¿ç¨åç¼å­å¯ä»¥éè¿ jdk èªå¸¦ç hashmap æ concurrenthashmap å®ç°ã\n\néç¨åºæ¯ï¼ä¸éè¦æ·æ±°çç¼å­æ°æ®ã\n\nç¼ºç¹ï¼æ æ³è¿è¡ç¼å­æ·æ±°ï¼åå­ä¼æ éå¶çå¢é¿ã\n\n\n# äºãlruhashmap\n\nå¯ä»¥éè¿ç»§æ¿ linkedhashmap æ¥å®ç°ä¸ä¸ªç®åç lruhashmapï¼å³å¯å®æä¸ä¸ªç®åç **lru ï¼æè¿æå°ä½¿ç¨ï¼**ç®æ³ã\n\nç¼ºç¹ï¼\n\n * éç«äºä¸¥éï¼æ§è½æ¯è¾ä½ã\n * ä¸æ¯æè¿ææ¶é´\n * ä¸æ¯æèªå¨å·æ°\n\nãç¤ºä¾ãlruhashmap çç®åå®ç°\n\nclass lrucache extends linkedhashmap {\n\n    private final int max;\n    private object lock;\n\n    public lrucache(int max) {\n        //æ éæ©å®¹\n        super((int) (max * 1.4f), 0.75f, true);\n        this.max = max;\n        this.lock = new object();\n    }\n\n    /**\n     * éålinkedhashmapçremoveeldestentryæ¹æ³å³å¯ å¨putçæ¶åå¤æ­ï¼å¦æä¸ºtrueï¼å°±ä¼å é¤æèç\n     *\n     * @param eldest\n     * @return\n     */\n    @override\n    protected boolean removeeldestentry(map.entry eldest) {\n        return size() > max;\n    }\n\n    public object getvalue(object key) {\n        synchronized (lock) {\n            return get(key);\n        }\n    }\n\n    public void putvalue(object key, object value) {\n        synchronized (lock) {\n            put(key, value);\n        }\n    }\n\n    public boolean removevalue(object key) {\n        synchronized (lock) {\n            return remove(key) != null;\n        }\n    }\n\n    public boolean removeall() {\n        clear();\n        return true;\n    }\n\n}\n\n\n\n# ä¸ãguava cache\n\nguava cache è§£å³äº lruhashmap ä¸­çå ä¸ªç¼ºç¹ã\n\nguava cache æä¾äºåºäºå®¹éï¼æ¶é´åå¼ç¨çç¼å­åæ¶æ¹å¼ãåºäºå®¹éçæ¹å¼åé¨å®ç°éç¨ lru ç®æ³ï¼åºäºå¼ç¨åæ¶å¾å¥½çå©ç¨äº java èææºçåå¾åæ¶æºå¶ã\n\nå¶ä¸­çç¼å­æé å¨ cachebuilder éç¨æå»ºèæ¨¡å¼æä¾äºè®¾ç½®å¥½åç§åæ°çç¼å­å¯¹è±¡ãç¼å­æ ¸å¿ç±» localcache éé¢çåé¨ç±» segment ä¸ jdk1.7 åä»¥åç concurrenthashmap éå¸¸ç¸ä¼¼ï¼åæ®µå éï¼åå°éç«äºï¼å¹¶ä¸é½ç»§æ¿äº reetrantlockï¼è¿æå­ä¸ªéåï¼ä»¥å®ç°ä¸°å¯çæ¬å°ç¼å­æ¹æ¡ãguava cache å¯¹äºè¿æç entry å¹¶æ²¡æé©¬ä¸è¿æ(ä¹å°±æ¯å¹¶æ²¡æåå°çº¿ç¨ä¸ç´å¨æ«)ï¼èæ¯éè¿è¿è¡è¯»åæä½çæ¶åè¿è¡è¿æå¤çï¼è¿æ ·åçå¥½å¤æ¯é¿ååå°çº¿ç¨æ«æçæ¶åè¿è¡å¨å±å éã\n\nç´æ¥éè¿æ¥è¯¢ï¼å¤æ­å¶æ¯å¦æ»¡è¶³å·æ°æ¡ä»¶ï¼è¿è¡å·æ°ã\n\n\n# guava cache ç¼å­åæ¶\n\nguava cache æä¾äºä¸ç§åºæ¬çç¼å­åæ¶æ¹å¼ã\n\n\n# åºäºå®¹éåæ¶\n\nmaximumsize(long)ï¼å½ç¼å­ä¸­çåç´ æ°éè¶è¿æå®å¼æ¶è§¦ååæ¶ã\n\n\n# åºäºå®æ¶åæ¶\n\n * expireafteraccess(long, timeunit)ï¼ç¼å­é¡¹å¨ç»å®æ¶é´åæ²¡æè¢«è¯»/åè®¿é®ï¼ååæ¶ãè¯·æ³¨æè¿ç§ç¼å­çåæ¶é¡ºåºååºäºå¤§å°åæ¶ä¸æ ·ã\n * expireafterwrite(long, timeunit)ï¼ç¼å­é¡¹å¨ç»å®æ¶é´åæ²¡æè¢«åè®¿é®ï¼åå»ºæè¦çï¼ï¼ååæ¶ãå¦æè®¤ä¸ºç¼å­æ°æ®æ»æ¯å¨åºå®æ¶åååå¾éæ§ä¸å¯ç¨ï¼è¿ç§åæ¶æ¹å¼æ¯å¯åçã\n\nå¦ä¸ææè®¨è®ºï¼å®æ¶åæ¶å¨ææ§å°å¨åæä½ä¸­æ§è¡ï¼å¶å°å¨è¯»æä½ä¸­æ§è¡ã\n\n\n# åºäºå¼ç¨åæ¶\n\n * cachebuilder.weakkeys()ï¼ä½¿ç¨å¼±å¼ç¨å­å¨é®ãå½é®æ²¡æå¶å®ï¼å¼ºæè½¯ï¼å¼ç¨æ¶ï¼ç¼å­é¡¹å¯ä»¥è¢«åå¾åæ¶ã\n * cachebuilder.weakvalues()ï¼ä½¿ç¨å¼±å¼ç¨å­å¨å¼ãå½å¼æ²¡æå¶å®ï¼å¼ºæè½¯ï¼å¼ç¨æ¶ï¼ç¼å­é¡¹å¯ä»¥è¢«åå¾åæ¶ã\n * cachebuilder.softvalues()ï¼ä½¿ç¨è½¯å¼ç¨å­å¨å¼ãè½¯å¼ç¨åªæå¨ååºåå­éè¦æ¶ï¼ææç§å¨å±æè¿æå°ä½¿ç¨çé¡ºåºåæ¶ã\n\n\n# guava cache æ ¸å¿ api\n\n# cachebuilder\n\nç¼å­æå»ºå¨ãæå»ºç¼å­çå¥å£ï¼æå®ç¼å­éç½®åæ°å¹¶åå§åæ¬å°ç¼å­ã ä¸»è¦éç¨ builder çæ¨¡å¼ï¼cachebuilder çæ¯ä¸ä¸ªæ¹æ³é½è¿åè¿ä¸ª cachebuilder ç¥é build æ¹æ³çè°ç¨ã æ³¨æ build æ¹æ³æéè½½ï¼å¸¦æåæ°çä¸ºæå»ºä¸ä¸ªå·ææ°æ®å è½½åè½çç¼å­ï¼ä¸å¸¦åæ°çæå»ºä¸ä¸ªæ²¡ææ°æ®å è½½åè½çç¼å­ã\n\n# localmanualcache\n\nä½ä¸º localcache çä¸ä¸ªåé¨ç±»ï¼å¨æé æ¹æ³éé¢ä¼æ localcache ç±»åçåéä¼ å¥ï¼å¹¶ä¸è°ç¨æ¹æ³æ¶é½ç´æ¥æèé´æ¥è°ç¨ localcache éé¢çæ¹æ³ã\n\n# localloadingcache\n\nå¯ä»¥çå°è¯¥ç±»ç»§æ¿äº localmanualcache å¹¶å®ç°æ¥å£ loadingcacheã è¦çäº getï¼getunchecked ç­æ¹æ³ã\n\n# localcache\n\nguava cache ä¸­çæ ¸å¿ç±»ï¼éç¹äºè§£ã\n\nlocalcache çæ°æ®ç»æä¸ concurrenthashmap å¾ç¸ä¼¼ï¼é½ç±å¤ä¸ª segment ç»æï¼ä¸å segment ç¸å¯¹ç¬ç«ï¼äºä¸å½±åï¼æä»¥è½æ¯æå¹¶è¡æä½ãæ¯ä¸ª segment ç±ä¸ä¸ª table åè¥å¹²éåç»æãç¼å­æ°æ®å­å¨å¨ table ä¸­ï¼å¶ç±»åä¸º atomicreferencearrayã\n\n\n# åãcaffeine\n\n> caffeine æ¯ä¸ä¸ªä½¿ç¨ jdk8 æ¹è¿ guava ç¼å­çé«æ§è½ç¼å­åºã\n\ncaffeine å®ç°äº w-tinylfu(lfu + lru ç®æ³çåç§)ï¼å¶å½ä¸­çåè¯»åååéå¤§å¤§ä¼äº guava cacheã\n\nå¶å®ç°åçè¾å¤æï¼å¯ä»¥åèä½ åºè¯¥ç¥éçç¼å­è¿åå²ã\n\n\n# äºãehcache\n\n> åèï¼ehcache\n\n\n# å­ãè¿ç¨åç¼å­å¯¹æ¯\n\nå¸¸ç¨è¿ç¨åç¼å­ææ¯å¯¹æ¯ï¼\n\næ¯è¾é¡¹      concurrenthashmap   lrumap                ehcache                 guava cache             caffeine\nè¯»åæ§è½     å¾å¥½ï¼åæ®µé              ä¸è¬ï¼å¨å±å é               å¥½                       å¥½ï¼éè¦åæ·æ±°æä½               å¾å¥½\næ·æ±°ç®æ³     æ                    lruï¼ä¸è¬                æ¯æå¤ç§æ·æ±°ç®æ³,lru,lfu,fifo   lruï¼ä¸è¬                  w-tinylfu, å¾å¥½\nåè½ä¸°å¯ç¨åº¦   åè½æ¯è¾ç®å              åè½æ¯è¾åä¸                åè½å¾ä¸°å¯                   åè½å¾ä¸°å¯ï¼æ¯æå·æ°åèå¼ç¨ç­         åè½å guava cache ç±»ä¼¼\nå·¥å·å¤§å°     jdk èªå¸¦ç±»ï¼å¾å°          åºäº linkedhashmapï¼è¾å°   å¾å¤§ï¼ææ°çæ¬ 1.4mb           æ¯ guava å·¥å·ç±»ä¸­çä¸ä¸ªå°é¨åï¼è¾å°   ä¸è¬ï¼ææ°çæ¬ 644kb\næ¯å¦æä¹å    å¦                   å¦                     æ¯                       å¦                       å¦\næ¯å¦æ¯æéç¾¤   å¦                   å¦                     æ¯                       å¦                       å¦\n\n * concurrenthashmap - æ¯è¾éåç¼å­æ¯è¾åºå®ä¸åçåç´ ï¼ä¸ç¼å­çæ°éè¾å°çãè½ç¶ä»ä¸é¢è¡¨æ ¼ä¸­æ¯èµ·æ¥æç¹éè²ï¼ä½æ¯å¶ç±äºæ¯ jdk èªå¸¦çç±»ï¼å¨åç§æ¡æ¶ä¸­ä¾ç¶æå¤§éçä½¿ç¨ï¼æ¯å¦æä»¬å¯ä»¥ç¨æ¥ç¼å­æä»¬åå°ç methodï¼field ç­ç­ï¼ä¹å¯ä»¥ç¼å­ä¸äºé¾æ¥ï¼é²æ­¢å¶éå¤å»ºç«ãå¨ caffeine ä¸­ä¹æ¯ä½¿ç¨ç concurrenthashmap æ¥å­å¨åç´ ã\n * lrumap - å¦æä¸æ³å¼å¥ç¬¬ä¸æ¹åï¼åæ³ä½¿ç¨æ·æ±°ç®æ³æ·æ±°æ°æ®ï¼å¯ä»¥ä½¿ç¨è¿ä¸ªã\n * ehcache - ç±äºå¶ jar åå¾å¤§ï¼è¾ééçº§ãå¯¹äºéè¦æä¹ååéç¾¤çä¸äºåè½çï¼å¯ä»¥éæ© ehcacheãéè¦æ³¨æçæ¯ï¼è½ç¶ ehcache ä¹æ¯æåå¸å¼ç¼å­ï¼ä½æ¯ç±äºå¶èç¹é´éä¿¡æ¹å¼ä¸º rmiï¼è¡¨ç°ä¸å¦ redisï¼æä»¥ä¸è¬ä¸å»ºè®®ç¨å®æ¥ä½ä¸ºåå¸å¼ç¼å­ã\n * guava cache - guava è¿ä¸ª jar åå¨å¾å¤ java åºç¨ç¨åºä¸­é½æå¤§éçå¼å¥ï¼æä»¥å¾å¤æ¶åå¶å®æ¯ç´æ¥ç¨å°±å¥½äºï¼å¹¶ä¸å¶æ¬èº«æ¯è½»éçº§çèä¸åè½è¾ä¸ºä¸°å¯ï¼å¨ä¸äºè§£ caffeine çæåµä¸å¯ä»¥éæ© guava cacheã\n * caffeine - å¶å¨å½ä¸­çï¼è¯»åæ§è½ä¸é½æ¯ guava cache å¥½å¾å¤ï¼å¹¶ä¸å¶ api å guava cache åºæ¬ä¸è´ï¼çè³ä¼å¤ä¸ç¹ãå¨çå®ç¯å¢ä¸­ä½¿ç¨ caffeineï¼åå¾è¿ä¸éçææã\n\næ»ç»ä¸ä¸ï¼å¦æä¸éè¦æ·æ±°ç®æ³åéæ© concurrenthashmapï¼å¦æéè¦æ·æ±°ç®æ³åä¸äºä¸°å¯ç apiï¼æ¨èéæ© caffeineã\n\n\n# åèèµæ\n\n * caffeine github\n * æ·±å¥è§£å¯æ¥èªæªæ¥çç¼å­-caffeine\n * caffeine ç¼å­\n * google guava å®æ¹æç¨ï¼ä¸­æçï¼\n * google guava cache å¨è§£æ\n * æ³¨éé©±å¨ç spring cache ç¼å­ä»ç»",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"http-cache",frontmatter:{title:"http-cache",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["ç¼å­","Http"],abbrlink:"74d07b78",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/c09100/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/06.Http%E7%BC%93%E5%AD%98.html",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/06.Httpç¼å­.md",key:"v-94737480",path:"/pages/c09100/",headers:[{level:2,title:"Http å¼ºç¼å­",slug:"http-å¼ºç¼å­",normalizedTitle:"http å¼ºç¼å­",charIndex:85},{level:3,title:"Expires",slug:"expires",normalizedTitle:"expires",charIndex:240},{level:3,title:"Cache-Control",slug:"cache-control",normalizedTitle:"cache-control",charIndex:248},{level:3,title:"Pragma",slug:"pragma",normalizedTitle:"pragma",charIndex:264},{level:2,title:"ååç¼å­",slug:"ååç¼å­",normalizedTitle:"ååç¼å­",charIndex:36},{level:3,title:"ETag/If-None-Match",slug:"etag-if-none-match",normalizedTitle:"etag/if-none-match",charIndex:1066},{level:3,title:"Last-Modified/If-Modified-Since",slug:"last-modified-if-modified-since",normalizedTitle:"last-modified/if-modified-since",charIndex:1411},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2076}],headersStr:"Http å¼ºç¼å­ Expires Cache-Control Pragma ååç¼å­ ETag/If-None-Match Last-Modified/If-Modified-Since åèèµæ",content:"# Http ç¼å­\n\nHTTP ç¼å­åä¸º 2 ç§ï¼ä¸ç§æ¯å¼ºç¼å­ï¼å¦ä¸ç§æ¯ååç¼å­ãä¸»è¦ä½ç¨æ¯å¯ä»¥å å¿«èµæºè·åéåº¦ï¼æåç¨æ·ä½éªï¼åå°ç½ç»ä¼ è¾ï¼ç¼è§£æå¡ç«¯çååã\n\n\n# Http å¼ºç¼å­\n\nä¸éè¦åéè¯·æ±å°æå¡ç«¯ï¼ç´æ¥è¯»åæµè§å¨æ¬å°ç¼å­ï¼å¨ Chrome ç Network ä¸­æ¾ç¤ºç HTTP ç¶æç æ¯ 200 ï¼å¨ Chrome ä¸­ï¼å¼ºç¼å­ååä¸º Disk Cache (å­æ¾å¨ç¡¬çä¸­)å Memory Cache (å­æ¾å¨åå­ä¸­)ï¼å­æ¾çä½ç½®æ¯ç±æµè§å¨æ§å¶çãæ¯å¦å¼ºç¼å­ç± ExpiresãCache-Control å Pragma 3 ä¸ª Header å±æ§å±åæ¥æ§å¶ã\n\n\n# Expires\n\nExpires çå¼æ¯ä¸ä¸ª HTTP æ¥æï¼å¨æµè§å¨åèµ·è¯·æ±æ¶ï¼ä¼æ ¹æ®ç³»ç»æ¶é´å Expires çå¼è¿è¡æ¯è¾ï¼å¦æç³»ç»æ¶é´è¶è¿äº Expires çå¼ï¼ç¼å­å¤±æãç±äºåç³»ç»æ¶é´è¿è¡æ¯è¾ï¼æä»¥å½ç³»ç»æ¶é´åæå¡å¨æ¶é´ä¸ä¸è´çæ¶åï¼ä¼æç¼å­æææä¸åçé®é¢ãExpires çä¼åçº§å¨ä¸ä¸ª Header å±æ§ä¸­æ¯æä½çã\n\n\n# Cache-Control\n\nCache-Control æ¯ HTTP/1.1 ä¸­æ°å¢çå±æ§ï¼å¨è¯·æ±å¤´åååºå¤´ä¸­é½å¯ä»¥ä½¿ç¨ï¼å¸¸ç¨çå±æ§å¼å¦æï¼\n\n * max-ageï¼åä½æ¯ç§ï¼ç¼å­æ¶é´è®¡ç®çæ¹å¼æ¯è·ç¦»åèµ·çæ¶é´çç§æ°ï¼è¶è¿é´éçç§æ°ç¼å­å¤±æ\n * no-cacheï¼ä¸ä½¿ç¨å¼ºç¼å­ï¼éè¦ä¸æå¡å¨éªè¯ç¼å­æ¯å¦æ°é²\n * no-storeï¼ç¦æ­¢ä½¿ç¨ç¼å­ï¼åæ¬ååç¼å­ï¼ï¼æ¯æ¬¡é½åæå¡å¨è¯·æ±ææ°çèµæº\n * privateï¼ä¸ç¨äºä¸ªäººçç¼å­ï¼ä¸­é´ä»£çãCDN ç­ä¸è½ç¼å­æ­¤ååº\n * publicï¼ååºå¯ä»¥è¢«ä¸­é´ä»£çãCDN ç­ç¼å­\n * must-revalidateï¼å¨ç¼å­è¿æåå¯ä»¥ä½¿ç¨ï¼è¿æåå¿é¡»åæå¡å¨éªè¯\n\n\n# Pragma\n\nPragma åªæä¸ä¸ªå±æ§å¼ï¼å°±æ¯ no-cache ï¼ææå Cache-Control ä¸­ç no-cache ä¸è´ï¼ä¸ä½¿ç¨å¼ºç¼å­ï¼éè¦ä¸æå¡å¨éªè¯ç¼å­æ¯å¦æ°é²ï¼å¨ 3 ä¸ªå¤´é¨å±æ§ä¸­çä¼åçº§æé«ã\n\n\n# ååç¼å­\n\nå½æµè§å¨çå¼ºç¼å­å¤±æçæ¶åæèè¯·æ±å¤´ä¸­è®¾ç½®äºä¸èµ°å¼ºç¼å­ï¼å¹¶ä¸å¨è¯·æ±å¤´ä¸­è®¾ç½®äº If-Modified-Since æè If-None-Match çæ¶åï¼ä¼å°è¿ä¸¤ä¸ªå±æ§å¼å°æå¡ç«¯å»éªè¯æ¯å¦å½ä¸­ååç¼å­ï¼å¦æå½ä¸­äºååç¼å­ï¼ä¼è¿å 304 ç¶æï¼å è½½æµè§å¨ç¼å­ï¼å¹¶ä¸ååºå¤´ä¼è®¾ç½® Last-Modified æè ETag å±æ§ã\n\n\n# ETag/If-None-Match\n\nEtagï¼ æå¡å¨ååºè¯·æ±æ¶ï¼éè¿æ­¤å­æ®µåè¯æµè§å¨å½åèµæºå¨æå¡å¨çæçå¯ä¸æ è¯ï¼çæè§åç±æå¡å¨å³å®ï¼\n\nIf-None-Matchï¼ åæ¬¡è¯·æ±æå¡å¨æ¶ï¼æµè§å¨çè¯·æ±æ¥æå¤´é¨ä¼åå«æ­¤å­æ®µï¼åé¢çå¼ä¸ºå¨ç¼å­ä¸­è·åçæ è¯ãæå¡å¨æ¥æ¶å°æ¬¡æ¥æååç° If-None-Match åä¸è¢«è¯·æ±èµæºçå¯ä¸æ è¯è¿è¡å¯¹æ¯ã\n\n 1. ä¸åï¼è¯´æèµæºè¢«æ¹å¨è¿ï¼åååºæ´ä¸ªèµæºåå®¹ï¼è¿åç¶æç  200ã\n 2. ç¸åï¼è¯´æèµæºæ å¿ä¿®æ¹ï¼åååº headerï¼æµè§å¨ç´æ¥ä»ç¼å­ä¸­è·åæ°æ®ä¿¡æ¯ãè¿åç¶æç  304.\n\nä½æ¯å®éåºç¨ä¸­ç±äº Etag çè®¡ç®æ¯ä½¿ç¨ç®æ³æ¥å¾åºçï¼èç®æ³ä¼å ç¨æå¡ç«¯è®¡ç®çèµæºï¼æææå¡ç«¯çèµæºé½æ¯å®è´µçï¼æä»¥å°±å¾å°ä½¿ç¨ Etag äºã\n\n\n# Last-Modified/If-Modified-Since\n\nLast-Modifiedï¼ æå¡å¨å¨ååºè¯·æ±æ¶ï¼ä¼åè¯æµè§å¨èµæºçæåä¿®æ¹æ¶é´ã\n\nif-Modified-Since: æµè§å¨åæ¬¡è¯·æ±æå¡å¨çæ¶åï¼è¯·æ±å¤´ä¼åå«æ­¤å­æ®µï¼åé¢è·çå¨ç¼å­ä¸­è·å¾çæåä¿®æ¹æ¶é´ãæå¡ç«¯æ¶å°æ­¤è¯·æ±å¤´åç°æ if-Modified-Sinceï¼åä¸è¢«è¯·æ±èµæºçæåä¿®æ¹æ¶é´è¿è¡å¯¹æ¯ï¼å¦æä¸è´åè¿å 304 åååºæ¥æå¤´ï¼æµè§å¨åªéè¦ä»ç¼å­ä¸­è·åä¿¡æ¯å³å¯ã ä»å­é¢ä¸çï¼å°±æ¯è¯´ï¼ä»æä¸ªæ¶é´èç¹ç®èµ·ï¼æ¯å¦æä»¶è¢«ä¿®æ¹äº\n\n 1. å¦æççè¢«ä¿®æ¹ï¼é£ä¹å¼å§ä¼ è¾ååºä¸ä¸ªæ´ä½ï¼æå¡å¨è¿åï¼200 OK\n 2. å¦ææ²¡æè¢«ä¿®æ¹ï¼é£ä¹åªéä¼ è¾ååº headerï¼æå¡å¨è¿åï¼304 Not Modified\n\nif-Unmodified-Since: ä»å­é¢ä¸ç, å°±æ¯è¯´: ä»æä¸ªæ¶é´ç¹ç®èµ·, æ¯å¦æä»¶æ²¡æè¢«ä¿®æ¹\n\n 1. å¦ææ²¡æè¢«ä¿®æ¹:åå¼å§`ç»§ç»­'ä¼ éæä»¶: æå¡å¨è¿å: 200 OK\n 2. å¦ææä»¶è¢«ä¿®æ¹:åä¸ä¼ è¾,æå¡å¨è¿å: 412 Precondition failed (é¢å¤çéè¯¯)\n\nè¿ä¸¤ä¸ªçåºå«æ¯ä¸ä¸ªæ¯ä¿®æ¹äºæä¸è½½ä¸ä¸ªæ¯æ²¡ä¿®æ¹æä¸è½½ã Last-Modified è¯´å¥½å´ä¹ä¸æ¯ç¹å«å¥½ï¼å ä¸ºå¦æå¨æå¡å¨ä¸ï¼ä¸ä¸ªèµæºè¢«ä¿®æ¹äºï¼ä½å¶å®éåå®¹æ ¹æ¬æ²¡åçæ¹åï¼ä¼å ä¸º Last-Modified æ¶é´å¹éä¸ä¸èè¿åäºæ´ä¸ªå®ä½ç»å®¢æ·ç«¯ï¼å³ä½¿å®¢æ·ç«¯ç¼å­éæä¸ªä¸æ¨¡ä¸æ ·çèµæºï¼ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼HTTP1.1 æ¨åºäº Etagã\n\n\n# åèèµæ\n\n * å¾è§£ HTTP ç¼å­\n * HTTP----HTTP ç¼å­æºå¶\n * ç¼å­è¯¦è§£",normalizedContent:"# http ç¼å­\n\nhttp ç¼å­åä¸º 2 ç§ï¼ä¸ç§æ¯å¼ºç¼å­ï¼å¦ä¸ç§æ¯ååç¼å­ãä¸»è¦ä½ç¨æ¯å¯ä»¥å å¿«èµæºè·åéåº¦ï¼æåç¨æ·ä½éªï¼åå°ç½ç»ä¼ è¾ï¼ç¼è§£æå¡ç«¯çååã\n\n\n# http å¼ºç¼å­\n\nä¸éè¦åéè¯·æ±å°æå¡ç«¯ï¼ç´æ¥è¯»åæµè§å¨æ¬å°ç¼å­ï¼å¨ chrome ç network ä¸­æ¾ç¤ºç http ç¶æç æ¯ 200 ï¼å¨ chrome ä¸­ï¼å¼ºç¼å­ååä¸º disk cache (å­æ¾å¨ç¡¬çä¸­)å memory cache (å­æ¾å¨åå­ä¸­)ï¼å­æ¾çä½ç½®æ¯ç±æµè§å¨æ§å¶çãæ¯å¦å¼ºç¼å­ç± expiresãcache-control å pragma 3 ä¸ª header å±æ§å±åæ¥æ§å¶ã\n\n\n# expires\n\nexpires çå¼æ¯ä¸ä¸ª http æ¥æï¼å¨æµè§å¨åèµ·è¯·æ±æ¶ï¼ä¼æ ¹æ®ç³»ç»æ¶é´å expires çå¼è¿è¡æ¯è¾ï¼å¦æç³»ç»æ¶é´è¶è¿äº expires çå¼ï¼ç¼å­å¤±æãç±äºåç³»ç»æ¶é´è¿è¡æ¯è¾ï¼æä»¥å½ç³»ç»æ¶é´åæå¡å¨æ¶é´ä¸ä¸è´çæ¶åï¼ä¼æç¼å­æææä¸åçé®é¢ãexpires çä¼åçº§å¨ä¸ä¸ª header å±æ§ä¸­æ¯æä½çã\n\n\n# cache-control\n\ncache-control æ¯ http/1.1 ä¸­æ°å¢çå±æ§ï¼å¨è¯·æ±å¤´åååºå¤´ä¸­é½å¯ä»¥ä½¿ç¨ï¼å¸¸ç¨çå±æ§å¼å¦æï¼\n\n * max-ageï¼åä½æ¯ç§ï¼ç¼å­æ¶é´è®¡ç®çæ¹å¼æ¯è·ç¦»åèµ·çæ¶é´çç§æ°ï¼è¶è¿é´éçç§æ°ç¼å­å¤±æ\n * no-cacheï¼ä¸ä½¿ç¨å¼ºç¼å­ï¼éè¦ä¸æå¡å¨éªè¯ç¼å­æ¯å¦æ°é²\n * no-storeï¼ç¦æ­¢ä½¿ç¨ç¼å­ï¼åæ¬ååç¼å­ï¼ï¼æ¯æ¬¡é½åæå¡å¨è¯·æ±ææ°çèµæº\n * privateï¼ä¸ç¨äºä¸ªäººçç¼å­ï¼ä¸­é´ä»£çãcdn ç­ä¸è½ç¼å­æ­¤ååº\n * publicï¼ååºå¯ä»¥è¢«ä¸­é´ä»£çãcdn ç­ç¼å­\n * must-revalidateï¼å¨ç¼å­è¿æåå¯ä»¥ä½¿ç¨ï¼è¿æåå¿é¡»åæå¡å¨éªè¯\n\n\n# pragma\n\npragma åªæä¸ä¸ªå±æ§å¼ï¼å°±æ¯ no-cache ï¼ææå cache-control ä¸­ç no-cache ä¸è´ï¼ä¸ä½¿ç¨å¼ºç¼å­ï¼éè¦ä¸æå¡å¨éªè¯ç¼å­æ¯å¦æ°é²ï¼å¨ 3 ä¸ªå¤´é¨å±æ§ä¸­çä¼åçº§æé«ã\n\n\n# ååç¼å­\n\nå½æµè§å¨çå¼ºç¼å­å¤±æçæ¶åæèè¯·æ±å¤´ä¸­è®¾ç½®äºä¸èµ°å¼ºç¼å­ï¼å¹¶ä¸å¨è¯·æ±å¤´ä¸­è®¾ç½®äº if-modified-since æè if-none-match çæ¶åï¼ä¼å°è¿ä¸¤ä¸ªå±æ§å¼å°æå¡ç«¯å»éªè¯æ¯å¦å½ä¸­ååç¼å­ï¼å¦æå½ä¸­äºååç¼å­ï¼ä¼è¿å 304 ç¶æï¼å è½½æµè§å¨ç¼å­ï¼å¹¶ä¸ååºå¤´ä¼è®¾ç½® last-modified æè etag å±æ§ã\n\n\n# etag/if-none-match\n\netagï¼ æå¡å¨ååºè¯·æ±æ¶ï¼éè¿æ­¤å­æ®µåè¯æµè§å¨å½åèµæºå¨æå¡å¨çæçå¯ä¸æ è¯ï¼çæè§åç±æå¡å¨å³å®ï¼\n\nif-none-matchï¼ åæ¬¡è¯·æ±æå¡å¨æ¶ï¼æµè§å¨çè¯·æ±æ¥æå¤´é¨ä¼åå«æ­¤å­æ®µï¼åé¢çå¼ä¸ºå¨ç¼å­ä¸­è·åçæ è¯ãæå¡å¨æ¥æ¶å°æ¬¡æ¥æååç° if-none-match åä¸è¢«è¯·æ±èµæºçå¯ä¸æ è¯è¿è¡å¯¹æ¯ã\n\n 1. ä¸åï¼è¯´æèµæºè¢«æ¹å¨è¿ï¼åååºæ´ä¸ªèµæºåå®¹ï¼è¿åç¶æç  200ã\n 2. ç¸åï¼è¯´æèµæºæ å¿ä¿®æ¹ï¼åååº headerï¼æµè§å¨ç´æ¥ä»ç¼å­ä¸­è·åæ°æ®ä¿¡æ¯ãè¿åç¶æç  304.\n\nä½æ¯å®éåºç¨ä¸­ç±äº etag çè®¡ç®æ¯ä½¿ç¨ç®æ³æ¥å¾åºçï¼èç®æ³ä¼å ç¨æå¡ç«¯è®¡ç®çèµæºï¼æææå¡ç«¯çèµæºé½æ¯å®è´µçï¼æä»¥å°±å¾å°ä½¿ç¨ etag äºã\n\n\n# last-modified/if-modified-since\n\nlast-modifiedï¼ æå¡å¨å¨ååºè¯·æ±æ¶ï¼ä¼åè¯æµè§å¨èµæºçæåä¿®æ¹æ¶é´ã\n\nif-modified-since: æµè§å¨åæ¬¡è¯·æ±æå¡å¨çæ¶åï¼è¯·æ±å¤´ä¼åå«æ­¤å­æ®µï¼åé¢è·çå¨ç¼å­ä¸­è·å¾çæåä¿®æ¹æ¶é´ãæå¡ç«¯æ¶å°æ­¤è¯·æ±å¤´åç°æ if-modified-sinceï¼åä¸è¢«è¯·æ±èµæºçæåä¿®æ¹æ¶é´è¿è¡å¯¹æ¯ï¼å¦æä¸è´åè¿å 304 åååºæ¥æå¤´ï¼æµè§å¨åªéè¦ä»ç¼å­ä¸­è·åä¿¡æ¯å³å¯ã ä»å­é¢ä¸çï¼å°±æ¯è¯´ï¼ä»æä¸ªæ¶é´èç¹ç®èµ·ï¼æ¯å¦æä»¶è¢«ä¿®æ¹äº\n\n 1. å¦æççè¢«ä¿®æ¹ï¼é£ä¹å¼å§ä¼ è¾ååºä¸ä¸ªæ´ä½ï¼æå¡å¨è¿åï¼200 ok\n 2. å¦ææ²¡æè¢«ä¿®æ¹ï¼é£ä¹åªéä¼ è¾ååº headerï¼æå¡å¨è¿åï¼304 not modified\n\nif-unmodified-since: ä»å­é¢ä¸ç, å°±æ¯è¯´: ä»æä¸ªæ¶é´ç¹ç®èµ·, æ¯å¦æä»¶æ²¡æè¢«ä¿®æ¹\n\n 1. å¦ææ²¡æè¢«ä¿®æ¹:åå¼å§`ç»§ç»­'ä¼ éæä»¶: æå¡å¨è¿å: 200 ok\n 2. å¦ææä»¶è¢«ä¿®æ¹:åä¸ä¼ è¾,æå¡å¨è¿å: 412 precondition failed (é¢å¤çéè¯¯)\n\nè¿ä¸¤ä¸ªçåºå«æ¯ä¸ä¸ªæ¯ä¿®æ¹äºæä¸è½½ä¸ä¸ªæ¯æ²¡ä¿®æ¹æä¸è½½ã last-modified è¯´å¥½å´ä¹ä¸æ¯ç¹å«å¥½ï¼å ä¸ºå¦æå¨æå¡å¨ä¸ï¼ä¸ä¸ªèµæºè¢«ä¿®æ¹äºï¼ä½å¶å®éåå®¹æ ¹æ¬æ²¡åçæ¹åï¼ä¼å ä¸º last-modified æ¶é´å¹éä¸ä¸èè¿åäºæ´ä¸ªå®ä½ç»å®¢æ·ç«¯ï¼å³ä½¿å®¢æ·ç«¯ç¼å­éæä¸ªä¸æ¨¡ä¸æ ·çèµæºï¼ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼http1.1 æ¨åºäº etagã\n\n\n# åèèµæ\n\n * å¾è§£ http ç¼å­\n * http----http ç¼å­æºå¶\n * ç¼å­è¯¦è§£",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java ç¼å­",frontmatter:{title:"Java ç¼å­",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","ç¼å­"],tags:["Java","ä¸­é´ä»¶","ç¼å­"],abbrlink:"ad7f7d3",date:"2022-02-17T22:34:30.000Z",hidden:!0,permalink:"/pages/71104f/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.%E7%BC%93%E5%AD%98/",relativePath:"14.ä¸­é´ä»¶/02.ç¼å­/README.md",key:"v-c4a07c5e",path:"/pages/71104f/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:113},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:203},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:407}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# Java ç¼å­\n\n> ç¼å­å¯ä»¥è¯´æ¯ä¼åç³»ç»æ§è½çç¬¬ä¸ææ®µï¼å¨åç§ææ¯ä¸­é½ä¼æç¼å­çåºç¨ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ ç¼å­ï¼å»ºè®®åäºè§£ä¸ä¸ ç¼å­åºæ¬åçï¼æå©äºçè§£ç¼å­çç¹æ§ãåçï¼ä½¿ç¨ç¼å­å¸¸è§çé®é¢åè§£å³æ¹æ¡ã\n\n\n\n\n# ð åå®¹\n\n * ç¼å­é¢è¯é¢\n * Java ç¼å­æ¡æ¶\n * Memcached å¿«éå¥é¨\n * Ehcache å¿«éå¥é¨\n * Java ç¼å­åº\n * Http ç¼å­\n\n\n# ð èµæ\n\n * JSR107\n * Spring Cache å®æ¹ææ¡£\n * Spring Boot Cache ç¹æ§å®æ¹ææ¡£\n * J2Cache Gitee\n * JetCache Github\n * JetCache wiki\n * Memcached å®ç½\n * Memcached Github\n * Redis å®ç½\n * Redis github\n * Redis å®æ¹ææ¡£ä¸­æç\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java ç¼å­\n\n> ç¼å­å¯ä»¥è¯´æ¯ä¼åç³»ç»æ§è½çç¬¬ä¸ææ®µï¼å¨åç§ææ¯ä¸­é½ä¼æç¼å­çåºç¨ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ ç¼å­ï¼å»ºè®®åäºè§£ä¸ä¸ ç¼å­åºæ¬åçï¼æå©äºçè§£ç¼å­çç¹æ§ãåçï¼ä½¿ç¨ç¼å­å¸¸è§çé®é¢åè§£å³æ¹æ¡ã\n\n\n\n\n# ð åå®¹\n\n * ç¼å­é¢è¯é¢\n * java ç¼å­æ¡æ¶\n * memcached å¿«éå¥é¨\n * ehcache å¿«éå¥é¨\n * java ç¼å­åº\n * http ç¼å­\n\n\n# ð èµæ\n\n * jsr107\n * spring cache å®æ¹ææ¡£\n * spring boot cache ç¹æ§å®æ¹ææ¡£\n * j2cache gitee\n * jetcache github\n * jetcache wiki\n * memcached å®ç½\n * memcached github\n * redis å®ç½\n * redis github\n * redis å®æ¹ææ¡£ä¸­æç\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Hystrix å¿«éå¥é¨",frontmatter:{title:"Hystrix å¿«éå¥é¨",categories:["ç¼ç¨","Java","ä¸­é´ä»¶","æµéæ§å¶"],tags:["Java","ä¸­é´ä»¶","æµéæ§å¶","Hystrix"],abbrlink:"eea3b9ff",date:"2022-02-17T22:34:30.000Z",permalink:"/pages/f2ebed/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/03.%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6/01.Hystrix.html",relativePath:"14.ä¸­é´ä»¶/03.æµéæ§å¶/01.Hystrix.md",key:"v-a9382712",path:"/pages/f2ebed/",headers:[{level:2,title:"ä¸ãHystrix ç®ä»",slug:"ä¸ãhystrix-ç®ä»",normalizedTitle:"ä¸ãhystrix ç®ä»",charIndex:19},{level:3,title:"Hystrix æ¯ä»ä¹",slug:"hystrix-æ¯ä»ä¹",normalizedTitle:"hystrix æ¯ä»ä¹",charIndex:36},{level:3,title:"ä¸ºä»ä¹éè¦ Hystrix",slug:"ä¸ºä»ä¹éè¦-hystrix",normalizedTitle:"ä¸ºä»ä¹éè¦ hystrix",charIndex:172},{level:3,title:"Hystrix çåè½",slug:"hystrix-çåè½",normalizedTitle:"hystrix çåè½",charIndex:730},{level:2,title:"Hystrix æ ¸å¿æ¦å¿µ",slug:"hystrix-æ ¸å¿æ¦å¿µ",normalizedTitle:"hystrix æ ¸å¿æ¦å¿µ",charIndex:1202},{level:2,title:"äºãHystrix å·¥ä½æµç¨",slug:"äºãhystrix-å·¥ä½æµç¨",normalizedTitle:"äºãhystrix å·¥ä½æµç¨",charIndex:1219},{level:3,title:"ï¼ä¸ï¼åè£å½ä»¤",slug:"ä¸-åè£å½ä»¤",normalizedTitle:"ï¼ä¸ï¼åè£å½ä»¤",charIndex:1274},{level:3,title:"ï¼äºï¼æ§è¡å½ä»¤",slug:"äº-æ§è¡å½ä»¤",normalizedTitle:"ï¼äºï¼æ§è¡å½ä»¤",charIndex:1858},{level:3,title:"ï¼ä¸ï¼æ¯å¦ç¼å­",slug:"ä¸-æ¯å¦ç¼å­",normalizedTitle:"ï¼ä¸ï¼æ¯å¦ç¼å­",charIndex:2978},{level:3,title:"ï¼åï¼æ¯å¦å¼å¯æ­è·¯å¨",slug:"å-æ¯å¦å¼å¯æ­è·¯å¨",normalizedTitle:"ï¼åï¼æ¯å¦å¼å¯æ­è·¯å¨",charIndex:3066},{level:3,title:"ï¼äºï¼ä¿¡å·éãçº¿ç¨æ± æ¯å¦æç»",slug:"äº-ä¿¡å·éãçº¿ç¨æ± æ¯å¦æç»",normalizedTitle:"ï¼äºï¼ä¿¡å·éãçº¿ç¨æ± æ¯å¦æç»",charIndex:3224},{level:3,title:"ï¼å­ï¼construct() æ run()",slug:"å­-construct-æ-run",normalizedTitle:"ï¼å­ï¼construct() æ run()",charIndex:3374},{level:3,title:"ï¼ä¸ï¼å¥åº·æ£æ¥",slug:"ä¸-å¥åº·æ£æ¥",normalizedTitle:"ï¼ä¸ï¼å¥åº·æ£æ¥",charIndex:4388},{level:3,title:"ï¼å«ï¼è·å Fallback",slug:"å«-è·å-fallback",normalizedTitle:"ï¼å«ï¼è·å fallback",charIndex:4591},{level:3,title:"ï¼ä¹ï¼è¿åç»æ",slug:"ä¹-è¿åç»æ",normalizedTitle:"ï¼ä¹ï¼è¿åç»æ",charIndex:4743},{level:2,title:"ä¸ãæ­è·¯å¨å·¥ä½åç",slug:"ä¸ãæ­è·¯å¨å·¥ä½åç",normalizedTitle:"ä¸ãæ­è·¯å¨å·¥ä½åç",charIndex:5151},{level:3,title:"ç³»ç»ææ ",slug:"ç³»ç»ææ ",normalizedTitle:"ç³»ç»ææ ",charIndex:7335},{level:2,title:"åãèµæºéç¦»ææ¯",slug:"åãèµæºéç¦»ææ¯",normalizedTitle:"åãèµæºéç¦»ææ¯",charIndex:7635},{level:3,title:"çº¿ç¨æ± éç¦»",slug:"çº¿ç¨æ± éç¦»",normalizedTitle:"çº¿ç¨æ± éç¦»",charIndex:87},{level:3,title:"ä¿¡å·ééç¦»",slug:"ä¿¡å·ééç¦»",normalizedTitle:"ä¿¡å·ééç¦»",charIndex:93},{level:2,title:"äºãHystrix åºç¨",slug:"äºãhystrix-åºç¨",normalizedTitle:"äºãhystrix åºç¨",charIndex:11064},{level:3,title:"Spring Cloud + Hystrix",slug:"spring-cloud-hystrix",normalizedTitle:"spring cloud + hystrix",charIndex:11081},{level:2,title:"Hystrix éç½®",slug:"hystrix-éç½®",normalizedTitle:"hystrix éç½®",charIndex:11108},{level:3,title:"æ§è¡éç½®",slug:"æ§è¡éç½®",normalizedTitle:"æ§è¡éç½®",charIndex:12225},{level:3,title:"æ­è·¯éç½®",slug:"æ­è·¯éç½®",normalizedTitle:"æ­è·¯éç½®",charIndex:12639},{level:3,title:"ææ éç½®",slug:"ææ éç½®",normalizedTitle:"ææ éç½®",charIndex:13154},{level:3,title:"çº¿ç¨æ± éç½®",slug:"çº¿ç¨æ± éç½®",normalizedTitle:"çº¿ç¨æ± éç½®",charIndex:14025},{level:2,title:"å­ãå¶ä»éæµææ¯",slug:"å­ãå¶ä»éæµææ¯",normalizedTitle:"å­ãå¶ä»éæµææ¯",charIndex:14863},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:15608}],headersStr:"ä¸ãHystrix ç®ä» Hystrix æ¯ä»ä¹ ä¸ºä»ä¹éè¦ Hystrix Hystrix çåè½ Hystrix æ ¸å¿æ¦å¿µ äºãHystrix å·¥ä½æµç¨ ï¼ä¸ï¼åè£å½ä»¤ ï¼äºï¼æ§è¡å½ä»¤ ï¼ä¸ï¼æ¯å¦ç¼å­ ï¼åï¼æ¯å¦å¼å¯æ­è·¯å¨ ï¼äºï¼ä¿¡å·éãçº¿ç¨æ± æ¯å¦æç» ï¼å­ï¼construct() æ run() ï¼ä¸ï¼å¥åº·æ£æ¥ ï¼å«ï¼è·å Fallback ï¼ä¹ï¼è¿åç»æ ä¸ãæ­è·¯å¨å·¥ä½åç ç³»ç»ææ  åãèµæºéç¦»ææ¯ çº¿ç¨æ± éç¦» ä¿¡å·ééç¦» äºãHystrix åºç¨ Spring Cloud + Hystrix Hystrix éç½® æ§è¡éç½® æ­è·¯éç½® ææ éç½® çº¿ç¨æ± éç½® å­ãå¶ä»éæµææ¯ åèèµæ",content:'# Hystrix å¿«éå¥é¨\n\n\n# ä¸ãHystrix ç®ä»\n\n\n# Hystrix æ¯ä»ä¹\n\nHystrix æ¯ Netflix å¼æºçä¸æ¬¾å®¹éæ¡æ¶ï¼åå«å¸¸ç¨çå®¹éæ¹æ³ï¼çº¿ç¨æ± éç¦»ãä¿¡å·ééç¦»ãçæ­ãéçº§ã\n\nHystrix å®æ¹å®£å¸ä¸ååå¸æ°çæ¬ã\n\nä½æ¯ Hystrix çå®¢æ·ç«¯çæ­ä¿æ¤ï¼æ­è·¯å¨è®¾è®¡çå¿µï¼æéå¸¸é«çå­¦ä¹ ä»·å¼ã\n\n\n# ä¸ºä»ä¹éè¦ Hystrix\n\nå¤æçåå¸å¼ç³»ç»æ¶æä¸­çåºç¨ç¨åºå¾å¾å·ææ°åä¸ªä¾èµé¡¹ï¼æ¯ä¸ªä¾èµé¡¹é½ä¼ä¸å¯é¿åå°å¨æä¸ªæ¶å»å¤±è´¥ã å¦æä¸»æºåºç¨ç¨åºæªä¸è¿äºå¤é¨æééç¦»å¼æ¥ï¼åå¯è½ä¼è¢«æ³¢åã\n\nä¾å¦ï¼å¯¹äºä¾èµäº 30 ä¸ªæå¡çåºç¨ç¨åºï¼åè®¾æ¯ä¸ªæå¡çæ­£å¸¸è¿è¡æ¶é´ä¸º 99.99ï¼ï¼åå¯ä»¥ææï¼\n\n> 99.9930 = 99.7ï¼ çæ­£å¸¸è¿è¡æ¶é´\n> \n> 10 äº¿ä¸ªè¯·æ±ä¸­ç 0.3ï¼= 3,000,000 ä¸ªå¤±è´¥\n> \n> å³ä½¿ææä¾èµé¡¹é½å·æåºè²çæ­£å¸¸è¿è¡æ¶é´ï¼æ¯æä¹ä¼æ 2 ä¸ªå°æ¶ä»¥ä¸çåæºæ¶é´ã\n> \n> ç¶èï¼ç°å®æåµä¸è¬æ¯è¿ç§ä¼°éæåµæ´ç³ç³ã\n\n----------------------------------------\n\nå½ä¸åæ­£å¸¸æ¶ï¼æ´ä½ç³»ç»å¦ä¸æç¤ºï¼\n\n\n\nå¨é«å¹¶ååºæ¯ï¼è¿äºä¾èµçç¨³å®æ§ä¸å¦å¯¹ç³»ç»çå½±åéå¸¸å¤§ï¼ä½æ¯ä¾èµæå¾å¤ä¸å¯æ§é®é¢ï¼å¦ç½ç»è¿æ¥ãèµæºç¹å¿ãæå¡å®æºç­ãä¾å¦ï¼ä¸å¾ä¸­æä¸ä¸ª QPS ä¸º 50 çä¾èµ I åºç°ä¸å¯ç¨ï¼ä½æ¯å¶ä»ä¾èµæå¡æ¯å¯ç¨çã\n\n\n\nä½æ¯ï¼å¨é«å¹¶ååºæ¯ä¸ï¼å½ä¾èµ I é»å¡æ¶ï¼å¤§å¤æ°æå¡å¨ççº¿ç¨æ± å°±åºç°é»å¡(BLOCK)ãå½è¿ç§çº§èæéææ¼æçï¼å°±å¯è½é ææ´ä¸ªçº¿ä¸æå¡ä¸å¯ç¨çéªå´©æåºï¼å¦ä¸å¾ï¼\n\n\n\nHystrix å°±æ¯ä¸ºäºè§£å³è¿ç±»é®é¢èåºè¿èçã\n\n\n# Hystrix çåè½\n\nHystrix å·æä»¥ä¸åè½ï¼\n\n * é¿åèµæºèå°½ï¼é»æ­¢ä»»ä½ä¸ä¸ªä¾èµæå¡èå°½ææçèµæºï¼æ¯å¦ tomcat ä¸­çææçº¿ç¨èµæºã\n * é¿åè¯·æ±æéåç§¯åï¼éç¨éæµå fail fast æ¥æ§å¶æéã\n * æ¯æéçº§ï¼æä¾ fallback éçº§æºå¶æ¥åºå¯¹æéã\n * èµæºéç¦»ï¼æ¯å¦ bulkheadï¼è±å£éç¦»ææ¯ï¼ãswimlaneï¼æ³³éææ¯ï¼ãcircuit breakerï¼æ­è·¯ææ¯ï¼æ¥éå¶ä»»ä½ä¸ä¸ªä¾èµæå¡çæéçå½±åã\n * ç»è®¡/çæ§/æ¥è­¦ï¼éè¿è¿å®æ¶çç»è®¡/çæ§/æ¥è­¦åè½ï¼æ¥æé«æéåç°çéåº¦ã\n * éè¿è¿å®æ¶çå±æ§åéç½®ç­ä¿®æ¹åè½ï¼æ¥æé«æéå¤çåæ¢å¤çéåº¦ã\n * ä¿æ¤ä¾èµæå¡è°ç¨çæææéæåµï¼èä¸ä»ä»åªæ¯ç½ç»æéæåµã\n\nå¦æä½¿ç¨ Hystrix å¯¹æ¯ä¸ªåºç¡ä¾èµæå¡è¿è¡è¿è½½ä¿æ¤ï¼åæ´ä¸ªç³»ç»æ¶æå°ä¼ç±»ä¼¼ä¸å¾æç¤ºï¼æ¯ä¸ªä¾èµé¡¹å½¼æ­¤éç¦»ï¼åå°å»¶è¿æ¶åçé¥±åçèµæºçè¢«éå¶è®¿é®ï¼å¹¶åå« fallback é»è¾ï¼ç¨äºéçº§å¤çï¼ï¼è¯¥é»è¾å³å®äºå¨ä¾èµé¡¹ä¸­åçä»»ä½ç±»åçæéæ¶ååºå¯¹åºçå¤çã\n\n\n\n\n# Hystrix æ ¸å¿æ¦å¿µ\n\n\n# äºãHystrix å·¥ä½æµç¨\n\nå¦ä¸å¾æç¤ºï¼Hystrix çå·¥ä½æµç¨å¤§è´å¯ä»¥åä¸º 9 ä¸ªæ­¥éª¤ã\n\n\n\n\n# ï¼ä¸ï¼åè£å½ä»¤\n\nx æ¯æèµæºéç¦»ã\n\nèµæºéç¦»ï¼å°±æ¯è¯´ï¼ä½ å¦æè¦æå¯¹æä¸ä¸ªä¾èµæå¡çææè°ç¨è¯·æ±ï¼å¨é¨éç¦»å¨åä¸ä»½èµæºæ± åï¼ä¸ä¼å»ç¨å¶å®èµæºäºï¼è¿å°±å«èµæºéç¦»ãåªæå¯¹è¿ä¸ªä¾èµæå¡ï¼æ¯å¦è¯´ååæå¡ï¼ç°å¨åæ¶åèµ·çè°ç¨éå·²ç»å°äº 1000ï¼ä½æ¯åéç»ååæå¡çº¿ç¨æ± åå°± 10 ä¸ªçº¿ç¨ï¼æå¤å°±åªä¼ç¨è¿ 10 ä¸ªçº¿ç¨å»æ§è¡ãä¸ä¼å ä¸ºå¯¹ååæå¡è°ç¨çå»¶è¿ï¼å° Tomcat åé¨ææççº¿ç¨èµæºå¨é¨èå°½ã\n\nHystrix è¿è¡èµæºéç¦»ï¼å¶å®æ¯æä¾äºä¸ä¸ªæ½è±¡ï¼å«åå½ä»¤æ¨¡å¼ãè¿ä¹æ¯ Hystrix ææåºæ¬çèµæºéç¦»ææ¯ã\n\nå¨ä½¿ç¨ Hystrix çè¿ç¨ä¸­ï¼ä¼å¯¹ä¾èµæå¡çè°ç¨è¯·æ±å°è£æå½ä»¤å¯¹è±¡ï¼Hystrix å¯¹ å½ä»¤å¯¹è±¡æ½è±¡äºä¸¤ä¸ªæ½è±¡ç±»ï¼HystrixCommand åHystrixObservableCommand ã\n\n * HystrixCommand è¡¨ç¤ºçå½ä»¤å¯¹è±¡ä¼è¿åä¸ä¸ªå¯ä¸è¿åå¼ã\n * HystrixObservableCommand è¡¨ç¤ºçå½ä»¤å¯¹è±¡ ä¼è¿åå¤ä¸ªè¿åå¼ã\n\nHystrixCommand command = new HystrixCommand(arg1, arg2);\nHystrixObservableCommand command = new HystrixObservableCommand(arg1, arg2);\n\n\n\n# ï¼äºï¼æ§è¡å½ä»¤\n\nHystrix ä¸­å±æ 4 ç§æ¹å¼æ§è¡å½ä»¤ï¼å¦ä¸æç¤ºï¼\n\næ§è¡æ¹å¼           è¯´æ                                               å¯ç¨å¯¹è±¡\nexecute()      é»å¡å¼åæ­¥æ§è¡ï¼è¿åä¾èµæå¡çåä¸è¿åç»æ(æèæåºå¼å¸¸)                    HystrixCommand\nqueue()        åºäº Future çå¼æ­¥æ¹å¼æ§è¡ï¼è¿åä¾èµæå¡çåä¸è¿åç»æ(æèæåºå¼å¸¸)          HystrixCommand\nobserve()      åºäº Rxjava ç Observable æ¹å¼ï¼è¿åéè¿ Observable        HystrixObservableCommand\n               è¡¨ç¤ºçä¾èµæå¡è¿åç»æ,ä»£è°ç¨ä»£ç åæ§è¡(Hot Obserable)\ntoObvsevable   åºäº Rxjava ç Observable æ¹å¼ï¼è¿åéè¿ Observable        HystrixObservableCommand\n               è¡¨ç¤ºçä¾èµæå¡è¿åç»æ,æ§è¡ä»£ç ç­å°çæ­£è®¢éçæ¶åæä¼æ§è¡(cold observable)\n\nè¿åç§å½ä»¤ä¸­ï¼exeucte()ãqueue()ãobserve()çè¡¨ç¤ºä¹æ¯éè¿toObservable()å®ç°çï¼å¶è½¬æ¢å³ç³»å¦ä¸å¾æç¤ºï¼\n\n\n\nHystrixCommand æ§è¡æ¹å¼\n\nK value   = command.execute();\n// ç­ä»·è¯­å¥ï¼\nK value = command.execute().queue().get();\n\n\nFuture<K> fValue  = command.queue();\n//ç­ä»·è¯­å¥ï¼\nFuture<K> fValue = command.toObservable().toBlocking().toFuture();\n\n\nObservable<K> ohValue = command.observe(); //hot observableï¼ç«å»è®¢éï¼å½ä»¤ç«å»æ§è¡\n//ç­ä»·è¯­å¥ï¼\nObservable<K> ohValue = command.toObservable().subscribe(subject);\n\n// ä¸è¿°æ§è¡æç»å®ç°è¿æ¯åºäº toObservable()\nObservable<K> ocValue = command.toObservable(); //cold observableï¼å»¶åè®¢éï¼è®¢éåçåï¼æ§è¡æçæ­£æ§è¡\n\n\n\n# ï¼ä¸ï¼æ¯å¦ç¼å­\n\nå¦æå½åå½ä»¤å¯¹è±¡éç½®äºåè®¸ä»ç»æç¼å­ä¸­åè¿åç»æï¼å¹¶ä¸å¨ç»æç¼å­ä¸­å·²ç»ç¼å­äºè¯·æ±ç»æï¼åç¼å­çè¯·æ±ç»æä¼ç«å»éè¿ Observable çæ ¼å¼è¿åã\n\n\n# ï¼åï¼æ¯å¦å¼å¯æ­è·¯å¨\n\nå¦æç¬¬ä¸æ­¥æ²¡æç¼å­æ²¡æå½ä¸­ï¼åå¤æ­ä¸ä¸å½åæ­è·¯å¨çæ­è·¯ç¶ææ¯å¦æå¼ãå¦ææ­è·¯å¨ç¶æä¸ºæå¼ç¶æï¼å Hystrix å°ä¸ä¼æ§è¡æ­¤ Command å½ä»¤ï¼ç´æ¥æ§è¡æ­¥éª¤ 8 è°ç¨ Fallbackï¼\n\nå¦ææ­è·¯å¨ç¶ææ¯å³é­ï¼åæ§è¡ æ­¥éª¤ 5 æ£æ¥æ¯å¦æè¶³å¤çèµæºè¿è¡ Command å½ä»¤\n\n\n# ï¼äºï¼ä¿¡å·éãçº¿ç¨æ± æ¯å¦æç»\n\nå¦æå½åè¦æ§è¡ç Command å½ä»¤ åå³è¿ççº¿ç¨æ±  åéå(æèä¿¡å·é)èµæºå·²ç»æ»¡äºï¼Hystrix å°ä¸ä¼è¿è¡ Command å½ä»¤ï¼ç´æ¥æ§è¡ æ­¥éª¤ 8ç Fallback éçº§å¤çï¼å¦ææªæ»¡ï¼è¡¨ç¤ºæå©ä½çèµæºæ§è¡ Command å½ä»¤ï¼åæ§è¡æ­¥éª¤ 6\n\n\n# ï¼å­ï¼construct() æ run()\n\nå½ç»è¿æ­¥éª¤ 5 å¤æ­ï¼æè¶³å¤çèµæºæ§è¡ Command å½ä»¤æ¶ï¼æ¬æ­¥éª¤å°è°ç¨ Command å½ä»¤è¿è¡æ¹æ³ï¼åºäºä¸åç±»åç Commandï¼æå¦ä¸ä¸¤ç§ä¸¤ç§è¿è¡æ¹å¼ï¼\n\nè¿è¡æ¹å¼                                   è¯´æ\nHystrixCommand.run()                   è¿åä¸ä¸ªå¤çç»ææèæåºä¸ä¸ªå¼å¸¸\nHystrixObservableCommand.construct()   è¿åä¸ä¸ª Observable è¡¨ç¤ºçç»æ(å¯è½å¤ä¸ª)ï¼æè åºäºonErrorçéè¯¯éç¥\n\nå¦ærun() æèconstruct()æ¹æ³ ççå®æ§è¡æ¶é´è¶è¿äº Command è®¾ç½®çè¶æ¶æ¶é´éå¼, åå½ååæ§è¡çº¿ç¨ï¼æèæ¯ç¬ç«çå®æ¶å¨çº¿ç¨ï¼å°ä¼æåºTimeoutExceptionãæåºè¶æ¶å¼å¸¸ TimeoutExceptionï¼åï¼å°æ§è¡æ­¥éª¤ 8ç Fallback éçº§å¤çãå³ä½¿run()æèconstruct()æ§è¡æ²¡æè¢«åæ¶æä¸­æ­ï¼æç»è½å¤å¤çè¿åç»æï¼ä½å¨éçº§å¤çé»è¾ä¸­ï¼å°ä¼æå¼run()æconstruct()æ¹æ³çè¿åç»æï¼èè¿å Fallback éçº§å¤çç»æã\n\n> æ³¨æäºé¡¹ éè¦æ³¨æçæ¯ï¼Hystrix æ æ³å¼ºå¶ å°æ­£å¨è¿è¡ççº¿ç¨åæ­¢æ--Hystrix è½å¤åçæå¥½çæ¹å¼å°±æ¯å¨ JVM ä¸­æåºä¸ä¸ªInterruptedExceptionãå¦æ Hystrix åè£çå·¥ä½ä¸æåºä¸­æ­å¼å¸¸InterruptedException, åå¨ Hystrix çº¿ç¨æ± ä¸­ççº¿ç¨å°ä¼ç»§ç»­æ§è¡ï¼å°½ç®¡è°ç¨çå®¢æ·ç«¯å·²ç»æ¥æ¶å°äºTimeoutExceptionãè¿ç§æ¹å¼ä¼ä½¿ Hystrix ççº¿ç¨æ± å¤äºé¥±åç¶æãå¤§é¨åç Java Http Client å¼æºåºå¹¶ä¸ä¼è§£æ InterruptedExceptionãæä»¥ç¡®è®¤ HTTP client ç¸å³çè¿æ¥åè¯»/åç¸å³çè¶æ¶æ¶é´è®¾ç½®ã å¦æ Command å½ä»¤æ²¡ææåºä»»ä½å¼å¸¸ï¼å¹¶ä¸æè¿åç»æï¼å Hystrix å°ä¼å¨åå®æ¥å¿è®°å½åç»è®¡ä¹åä¼å°ç»æè¿åã å¦ææ¯éè¿run()æ¹å¼è¿è¡ï¼åè¿åä¸ä¸ªObserableå¯¹è±¡ï¼åå«ä¸ä¸ªå¯ä¸å¼ï¼å¹¶ä¸åéä¸ä¸ªonCompletedéç¥ï¼å¦ææ¯éè¿consturct()æ¹å¼è¿è¡ ï¼åè¿åä¸ä¸ªObservableå¯¹è±¡ã\n\n\n# ï¼ä¸ï¼å¥åº·æ£æ¥\n\nHystrix ä¼ç»è®¡ Command å½ä»¤æ§è¡æ§è¡è¿ç¨ä¸­çæåæ°ãå¤±è´¥æ°ãæç»æ°åè¶æ¶æ°,å°è¿äºä¿¡æ¯è®°å½å°æ­è·¯å¨(Circuit Breaker)ä¸­ãæ­è·¯å¨å°ä¸è¿°ç»è®¡æç§æ¶é´çªçå½¢å¼è®°å½å°ä¸ä¸ªå®é¿æ°ç»ä¸­ãæ­è·¯å¨æ ¹æ®æ¶é´çªåçç»è®¡æ°æ®å»å¤å®è¯·æ±ä»ä¹æ¶åå¯ä»¥è¢«çæ­ï¼çæ­åï¼å¨æ¥ä¸æ¥ä¸æ®µæ¢å¤å¨æåï¼ç¸åçè¯·æ±è¿æ¥åä¼ç´æ¥è¢«çæ­ãå½åæ¬¡æ ¡éªï¼å¦æå¥åº·çæµéè¿åï¼çæ­å¼å³å°ä¼è¢«å³é­ã\n\n\n# ï¼å«ï¼è·å Fallback\n\nå½ä»¥ä¸åºæ¯åºç°åï¼Hystrix å°ä¼å°è¯è§¦å Fallback:\n\n>  * æ­¥éª¤ 6 Command æ§è¡æ¶æåºäºä»»ä½å¼å¸¸ï¼\n>  * æ­¥éª¤ 4 æ­è·¯å¨å·²ç»è¢«æå¼\n>  * æ­¥éª¤ 5 æ§è¡å½ä»¤ççº¿ç¨æ± ãéåæèä¿¡å·éèµæºå·²æ»¡\n>  * å½ä»¤æ§è¡çæ¶é´è¶è¿éå¼\n\n\n# ï¼ä¹ï¼è¿åç»æ\n\nå¦æ Hystrix å½ä»¤å¯¹è±¡æ§è¡æåï¼å°ä¼è¿åç»æï¼æèä»¥Observableå½¢å¼åè£çç»æãæ ¹æ®æ­¥éª¤ 2ç command è°ç¨æ¹å¼ï¼è¿åçObservable ä¼æç§å¦ä¸å¾è¯´æ¯çè½¬æ¢å³ç³»è¿è¡è¿åï¼\n\n\n\n * execute() â ç¨å .queue() ç¸åçæ¹å¼è·å Futureï¼ç¶åè°ç¨ Future ç get() ä»¥è·å Observable çåä¸ªå¼ã\n * queue() âå° Observable è½¬æ¢ä¸º BlockingObservableï¼ä»¥ä¾¿å¯ä»¥å°å¶è½¬æ¢ä¸º Future å¹¶è¿åã\n * watch() âè®¢é Observable å¹¶å¼å§æ§è¡å½ä»¤çæµç¨ï¼ è¿åä¸ä¸ª Observableï¼å½è®¢éè¯¥ Observable æ¶ï¼å®ä¼éæ°éç¥ã\n * toObservable() âè¿åä¸åç Observableï¼ å¿é¡»è®¢éå®æè½çæ­£å¼å§æ§è¡å½ä»¤çæµç¨ã\n\n\n# ä¸ãæ­è·¯å¨å·¥ä½åç\n\n\n\n 1. æ­è·¯å¨æ¶é´çªåçè¯·æ±æ° æ¯å¦è¶è¿äºè¯·æ±æ°æ­è·¯å¨çæéå¼circuitBreaker.requestVolumeThreshold,å¦æè¶è¿äºéå¼ï¼åå°ä¼è§¦åæ­è·¯ï¼æ­è·¯ç¶æä¸ºå¼å¯ ä¾å¦ï¼å¦æå½åéå¼è®¾ç½®çæ¯20,åå½æ¶é´çªåç»è®¡çè¯·æ±æ°å±è®¡ 19 ä¸ªï¼å³ä½¿ 19 ä¸ªå¨é¨å¤±è´¥äºï¼é½ä¸ä¼è§¦åæ­è·¯å¨ã\n 2. å¹¶ä¸è¯·æ±éè¯¯çè¶è¿äºè¯·æ±éè¯¯çéå¼errorThresholdPercentage\n 3. å¦æä¸¤ä¸ªé½æ»¡è¶³ï¼åå°æ­è·¯å¨ç±å³é­è¿ç§»å°å¼å¯\n 4. å¦ææ­è·¯å¨å¼å¯ï¼ååç»­çææç¸åè¯·æ±å°ä¼è¢«æ­è·¯æï¼\n 5. ç´å°è¿äºæ²ç¡æ¶é´çªsleepWindowInMillisecondsåï¼ååèµ·è¯·æ±æ¶ï¼åè®¸å¶éè¿ï¼æ­¤æ¶çç¶æä¸ºåå¼èµ·ç¶æï¼ãå¦æè¯·æ±å¤±è´¥äºï¼åä¿ææ­è·¯å¨ç¶æä¸ºå¼å¯ç¶æï¼å¹¶æ´æ°æ²ç¡æ¶é´çªãå¦æè¯·æ±æåäºï¼åå°æ­è·¯å¨ç¶ææ¹ä¸ºå³é­ç¶æï¼\n\næ ¸å¿çé»è¾å¦ä¸ï¼\n\n @Override\n                        public void onNext(HealthCounts hc) {\n                            // check if we are past the statisticalWindowVolumeThreshold\n                            if (hc.getTotalRequests() < properties.circuitBreakerRequestVolumeThreshold().get()) {\n                                // we are not past the minimum volume threshold for the stat window,\n                                // so no change to circuit status.\n                                // if it was CLOSED, it stays CLOSED\n                                // if it was half-open, we need to wait for a successful command execution\n                                // if it was open, we need to wait for sleep window to elapse\n                            } else {\n                                if (hc.getErrorPercentage() < properties.circuitBreakerErrorThresholdPercentage().get()) {\n                                    //we are not past the minimum error threshold for the stat window,\n                                    // so no change to circuit status.\n                                    // if it was CLOSED, it stays CLOSED\n                                    // if it was half-open, we need to wait for a successful command execution\n                                    // if it was open, we need to wait for sleep window to elapse\n                                } else {\n                                    // our failure rate is too high, we need to set the state to OPEN\n                                    if (status.compareAndSet(Status.CLOSED, Status.OPEN)) {\n                                        circuitOpened.set(System.currentTimeMillis());\n                                    }\n                                }\n                            }\n                        }\n\n\n\n# ç³»ç»ææ \n\nHystrix å¯¹ç³»ç»ææ çç»è®¡æ¯åºäºæ¶é´çªæ¨¡å¼çï¼\n\n> æ¶é´çªï¼æè¿çä¸ä¸ªæ¶é´åºé´åï¼æ¯å¦åä¸å°æ¶å°ç°å¨ï¼é£ä¹æ¶é´çªçé¿åº¦å°±æ¯1å°æ¶ï¼ æ¡¶ï¼æ¡¶æ¯å¨ç¹å®çæ¶é´çªåï¼ç­åçææ æ¶éçç»è®¡éåï¼æ¯å¦æ¶é´çªçé¿åº¦ä¸º1å°æ¶ï¼èæ¡¶çæ°éä¸º10,é£ä¹æ¯ä¸ªæ¡¶å¨æ¶é´è½´ä¸ä¾æ¬¡æå¼ï¼æ¶é´ç±è¿åè¿ï¼æ¯ä¸ªæ¡¶ç»è®¡çæ¶é´åçä¸º 1h / 10 = 6 min 6 åéãä¸ä¸ªæ¡¶ä¸­ï¼åå«äºæåæ°ãå¤±è´¥æ°ãè¶æ¶æ°ãæç»æ° åä¸ªææ ã\n\nå¨ç³»ç»åï¼æ¶é´çªä¼éçç³»ç»çè¿è¡éæ¸ååç§»å¨ï¼èæ¶é´çªçé¿åº¦åæ¡¶çæ°éæ¯åºå®ä¸åçï¼é£ä¹éçæ¶é´çç§»å¨ï¼ä¼åºç°è¾ä¹çè¿æçæ¡¶è¢«ç§»é¤åºå»ï¼æ°çæ¡¶è¢«æ·»å è¿æ¥ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\n\n# åãèµæºéç¦»ææ¯\n\n\n# çº¿ç¨æ± éç¦»\n\nå¦ä¸å¾æç¤ºï¼ç±äºè®¡ç®æºç³»ç»çåºæ¬æ§è¡åä½å°±æ¯çº¿ç¨ï¼çº¿ç¨å·å¤ç¬ç«çæ§è¡è½åï¼æä»¥ï¼ä¸ºäºåå°èµæºä¿æ¤ï¼éè¦å¯¹ç³»ç»ççº¿ç¨æ± è¿è¡ååï¼å¯¹äºå¤é¨è°ç¨æ¹\n\nUser Request\n\n\nçè¯·æ±ï¼è°ç¨åä¸ªçº¿ç¨æ± çæå¡ï¼åä¸ªçº¿ç¨æ± ç¬ç«å®æè°ç¨ï¼ç¶åå°ç»æè¿å\n\nè°ç¨æ¹\n\n\nãå¨è°ç¨æå¡çè¿ç¨ä¸­ï¼å¦æ\n\næå¡æä¾æ¹\n\n\næ§è¡æ¶é´è¿é¿ï¼å\n\nè°ç¨æ¹\n\n\nå¯ä»¥ç´æ¥ä»¥è¶æ¶çæ¹å¼ç´æ¥è¿åï¼å¿«éå¤±è´¥ã\n\n\n\nçº¿ç¨æ± éç¦»çå ç¹å¥½å¤\n\n>  1. ä½¿ç¨è¶æ¶è¿åçæºå¶ï¼é¿ååæ­¥è°ç¨æå¡æ¶ï¼è°ç¨æ¶é´è¿é¿ï¼æ æ³éæ¾ï¼å¯¼è´èµæºèå°½çæåµ\n>  2. æå¡æ¹å¯ä»¥æ§å¶è¯·æ±æ°éï¼è¯·æ±è¿å¤ï¼å¯ä»¥ç´æ¥æç»,è¾¾å°å¿«éå¤±è´¥çç®çï¼\n>  3. è¯·æ±æéï¼çº¿ç¨æ± å¯ä»¥ç»´æ¤æ§è¡éåï¼å°è¯·æ±åå°éåä¸­å¤ç\n\nä¸¾ä¸ªä¾å­ï¼å¦ä¸ä»£ç æ®µï¼æ¨¡æäºåæ­¥è°ç¨æå¡çè¿ç¨ï¼\n\n        //æå¡æä¾æ¹ï¼æ§è¡æå¡çæ¶åæ¨¡æ2åéçèæ¶\n        Callable<String> callableService  = ()->{\n            long start = System.currentTimeMillis();\n            while(System.currentTimeMillis()-start> 1000 * 60 *2){\n               //æ¨¡ææå¡æ§è¡æ¶é´è¿é¿çæåµ\n            }\n            return "OK";\n        };\n\n        //æ¨¡æ10ä¸ªå®¢æ·ç«¯è°ç¨æå¡\n        ExecutorService clients = Executors.newFixedThreadPool(10);\n        //æ¨¡æç»10ä¸ªå®¢æ·ç«¯æäº¤å¤çè¯·æ±\n        for (int i = 0; i < 20; i++) {\n            clients.execute(()->{\n                //åæ­¥è°ç¨\n                try {\n                    String result = callableService.call();\n                    System.out.println("å½åå®¢æ·ç«¯ï¼"+Thread.currentThread().getName()+"è°ç¨æå¡å®æï¼å¾å°ç»æï¼"+result);\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n            });\n        }\n\n\nå¨æ­¤ç¯èä¸­ï¼å®¢æ·ç«¯ clientså¿é¡»ç­å¾æå¡æ¹è¿åç»æä¹åï¼æè½æ¥æ¶æ°çè¯·æ±ãå¦æç¨ååéæ¥è¡¡éç³»ç»çè¯ï¼ä¼åç°ç³»ç»çå¤çè½åæ¯è¾ä½ãä¸ºäºæé«ç¸åºæ¶é´ï¼å¯ä»¥åå©çº¿ç¨æ± çæ¹å¼ï¼è®¾ç½®è¶æ¶æ¶é´ï¼è¿æ ·çè¯ï¼å®¢æ·ç«¯å°±ä¸éè¦å¿é¡»ç­å¾æå¡æ¹è¿åï¼å¦ææ¶é´è¿é¿ï¼å¯ä»¥æåè¿å,æ¹é åçä»£ç å¦ä¸æç¤ºï¼\n\n //æå¡æä¾æ¹ï¼æ§è¡æå¡çæ¶åæ¨¡æ2åéçèæ¶\n        Callable<String> callableService  = ()->{\n            long start = System.currentTimeMillis();\n            while(System.currentTimeMillis()-start> 1000 * 60 *2){\n               //æ¨¡ææå¡æ§è¡æ¶é´è¿é¿çæåµ\n            }\n            return "OK";\n        };\n\n        //åå»ºçº¿ç¨æ± ä½ä¸ºæå¡æ¹\n        ExecutorService executorService = Executors.newFixedThreadPool(30);\n\n\n        //æ¨¡æ10ä¸ªå®¢æ·ç«¯è°ç¨æå¡\n        ExecutorService clients = Executors.newFixedThreadPool(10);\n        for (int i = 0; i < 10; i++) {\n            clients.execute(()->{\n                //åæ­¥è°ç¨\n                    //å°è¯·æ±æäº¤ç»çº¿ç¨æ± æ§è¡ï¼Callable å Runnableå¨æç§æä¹ä¸ï¼ä¹æ¯Commandå¯¹è±¡\n                    Future<String> future = executorService.submit(callableService::call);\n                    //å¨æå®çæ¶é´åè·åç»æï¼å¦æè¶æ¶ï¼è°ç¨æ¹å¯ä»¥ç´æ¥è¿å\n                    try {\n                        String result = future.get(1000, TimeUnit.SECONDS);\n                        //å®¢æ·ç«¯ç­å¾æ¶é´ä¹åï¼å¿«éè¿å\n                        System.out.println("å½åå®¢æ·ç«¯ï¼"+Thread.currentThread().getName()+"è°ç¨æå¡å®æï¼å¾å°ç»æï¼"+result);\n                    }catch (TimeoutException timeoutException){\n                        System.out.println("æå¡è°ç¨è¶æ¶ï¼è¿åå¤ç");\n                    } catch (InterruptedException e) {\n\n                    } catch (ExecutionException e) {\n                    }\n            });\n        }\n\n\nå¦ææä»¬å°æå¡æ¹ççº¿ç¨æ± è®¾ç½®ä¸ºï¼\n\nThreadPoolExecutor executorService = new ThreadPoolExecutor(10,1000,TimeUnit.SECONDS,\nnew ArrayBlockingQueue<>(100),\nnew ThreadPoolExecutor.DiscardPolicy() // æäº¤è¯·æ±è¿å¤æ¶ï¼å¯ä»¥ä¸¢å¼è¯·æ±ï¼é¿åæ­»ç­é»å¡çæåµã\n)\n\n\nçº¿ç¨æ± éç¦»æ¨¡å¼çå¼ç«¯\n\n> çº¿ç¨æ± éç¦»æ¨¡å¼ï¼ä¼æ ¹æ®æå¡åååºç¬ç«ççº¿ç¨æ± ï¼ç³»ç»èµæºççº¿ç¨å¹¶åæ°æ¯æéçï¼å½çº¿ç¨æ°è¿å¤ï¼ç³»ç»è¯è´¹å¤§éç CPU æ¶é´æ¥åçº¿ç¨ä¸ä¸æåæ¢çæ ç¨æä½ï¼åèéä½ç³»ç»æ§è½ï¼å¦æçº¿ç¨æ± éç¦»çè¿å¤ï¼ä¼å¯¼è´çæ­£ç¨äºæ¥æ¶ç¨æ·è¯·æ±ççº¿ç¨å°±ç¸åºå°åå°ï¼ç³»ç»ååéåèä¸éï¼ å¨å®è·µä¸ï¼åºå½å¯¹åè¿ç¨æ¹æ³è°ç¨ï¼ç½ç»èµæºè¯·æ±è¿ç§æå¡æ¶é´ä¸å¤ªå¯æ§çåºæ¯ä¸ä½¿ç¨çº¿ç¨æ± éç¦»æ¨¡å¼å¤ç å¦ä¸å¾æç¤ºï¼æ¯çº¿ç¨æ± éç¦»æ¨¡å¼çä¸ç§åºæ¯ï¼\n\n\n\n\n# ä¿¡å·ééç¦»\n\nç±äºåºäºçº¿ç¨æ± éç¦»çæ¨¡å¼å ç¨ç³»ç»çº¿ç¨æ± èµæºï¼Hystrix è¿æä¾äºå¦å¤ä¸ä¸ªéç¦»ææ¯ï¼åºäºä¿¡å·éçéç¦»ã\n\nåºäºä¿¡å·éçéç¦»æ¹å¼éå¸¸å°ç®åï¼å¶æ ¸å¿å°±æ¯ä½¿ç¨å±ç¨åé\n\nsemaphore\n\n\nè¿è¡åå­æä½ï¼æ§å¶çº¿ç¨çå¹¶åéï¼å½å¹¶åéè¾¾å°ä¸å®éçº§æ¶ï¼æå¡ç¦æ­¢è°ç¨ãå¦ä¸å¾æç¤ºï¼ä¿¡å·éæ¬èº«ä¸ä¼æ¶èå¤ä½ççº¿ç¨èµæºï¼æä»¥å°±éå¸¸è½»éã\n\n\n\nåºäºä¿¡å·ééç¦»çå©å¼\n\n> å©ï¼åºäºä¿¡å·éçéç¦»ï¼å©ç¨ JVM çåå­æ§ CAS æä½ï¼é¿åäºèµæºéçç«äºï¼çå»äºçº¿ç¨æ± å¼éï¼æçéå¸¸é«ï¼ å¼ï¼æ¬è´¨ä¸åºäºä¿¡å·éçéç¦»æ¯åæ­¥è¡ä¸ºï¼æä»¥æ æ³åå°è¶æ¶çæ­ï¼æä»¥æå¡æ¹èªèº«è¦æ§å¶ä½æ§è¡æ¶é´ï¼é¿åè¶æ¶ã åºç¨åºæ¯ï¼ä¸å¡æå¡ä¸ï¼æå¹¶åä¸ééå¶æ¶ï¼å¯ä»¥èèæ­¤æ¹å¼ > Alibaba Sentinelå¼æºæ¡æ¶ï¼å°±æ¯åºäºä¿¡å·éççæ­åæ­è·¯å¨æ¡æ¶ã\n\n\n# äºãHystrix åºç¨\n\n\n# Spring Cloud + Hystrix\n\n * Hystrix éç½®æ æ³å¨æè°èçæãHystrix æ¡æ¶æ¬èº«æ¯ä½¿ç¨çArchaiusæ¡æ¶å®æçéç½®å è½½åå·æ°ï¼ä½æ¯éæèª Spring Cloud ä¸ï¼æ æ³ææå°æ ¹æ®å®æ¶çæ§ç»æï¼å¨æè°æ´çæ­åç³»ç»åæ°\n * çº¿ç¨æ± å Command ä¹é´çéç½®æ¯è¾å¤æ,å¨ Spring Cloud å¨å feigin-hystrix éæçæ¶åï¼è¿æäº BUGï¼å¯¹ command çé»è®¤éç½®æ²¡æå¤çå¥½ï¼å¯¼è´ææ command å ç¨å¬å±ç command çº¿ç¨æ± ï¼æ²¡æç»ç²åº¦æ§å¶ï¼è¿éè¦åæ¡æ¶ééè°æ´\n\npublic interface SetterFactory {\n\n  /**\n   * Returns a hystrix setter appropriate for the given target and method\n   */\n  HystrixCommand.Setter create(Target<?> target, Method method);\n\n  /**\n   * Default behavior is to derive the group key from {@link Target#name()} and the command key from\n   * {@link Feign#configKey(Class, Method)}.\n   */\n  final class Default implements SetterFactory {\n\n    @Override\n    public HystrixCommand.Setter create(Target<?> target, Method method) {\n      String groupKey = target.name();\n      String commandKey = Feign.configKey(target.type(), method);\n      return HystrixCommand.Setter\n          .withGroupKey(HystrixCommandGroupKey.Factory.asKey(groupKey))\n          .andCommandKey(HystrixCommandKey.Factory.asKey(commandKey));\n          //æ²¡æå¤çå¥½defaultéç½®é¡¹çå è½½\n    }\n  }\n}\n\n\n\n# Hystrix éç½®\n\n> è¯¦ç»éç½®å¯ä»¥åè Hystrix å®æ¹éç½®æåï¼è¿éä»ä»ç»æ¯è¾æ ¸å¿çéç½®\n\n\n# æ§è¡éç½®\n\nä»¥ä¸éç½®ç¨äºæ§å¶ HystrixCommand.run() å¦ä½æ§è¡ã\n\néç½®é¡¹                                                   è¯´æ                              é»è®¤å¼\nexecution.isolation.strategy                          çº¿ç¨éç¦»ï¼THREADï¼æä¿¡å·ééç¦»ï¼SEMAPHOREï¼   THREAD\nexecution.isolation.thread.timeoutInMilliseconds      æ¹æ³æ§è¡è¶æ¶æ¶é´                        1000(ms)\nexecution.isolation.semaphore.maxConcurrentRequests   ä¿¡å·ééç¦»æå¤§å¹¶åæ°                      10\n\n\n# æ­è·¯éç½®\n\nä»¥ä¸éç½®ç¨äºæ§å¶ HystrixCircuitBreaker çæ­è·¯å¤çã\n\néç½®é¡¹                                        è¯´æ                é»è®¤å¼\ncircuitBreaker.enabled                     æ¯å¦å¼å¯æ­è·¯å¨           true\ncircuitBreaker.requestVolumeThreshold      æ­è·¯å¨å¯ç¨è¯·æ±æ°éå¼        20\ncircuitBreaker.sleepWindowInMilliseconds   æ­è·¯å¨å¯ç¨åçä¼ç æ¶é´       5000(ms)\ncircuitBreaker.errorThresholdPercentage    æ­è·¯å¨å¯ç¨å¤±è´¥çéå¼        50(%)\ncircuitBreaker.forceOpen                   æ¯å¦å¼ºå¶å°æ­è·¯å¨è®¾ç½®æå¼å¯ç¶æ   false\ncircuitBreaker.forceClosed                 æ¯å¦å¼ºå¶å°æ­è·¯å¨è®¾ç½®æå³é­ç¶æ   false\n\n\n# ææ éç½®\n\nä»¥ä¸éç½®ç¨äºä» HystrixCommand å HystrixObservableCommand æ§è¡ä¸­æè·ç¸å³ææ ã\n\néç½®é¡¹                                             è¯´æ                                            é»è®¤å¼\nmetrics.rollingStats.timeInMilliseconds         æ¶é´çªçé¿åº¦                                        10000(ms)\nmetrics.rollingStats.numBuckets                 æ¡¶çæ°éï¼éè¦ä¿è¯timeInMilliseconds % numBuckets =0   10\nmetrics.rollingPercentile.enabled               æ¯å¦ç»è®¡è¿è¡å»¶è¿çå æ¯                                   true\nmetrics.rollingPercentile.timeInMilliseconds    è¿è¡å»¶è¿å æ¯ç»è®¡çæ¶é´çª                                  60000(ms)\nmetrics.rollingPercentile.numBuckets            è¿è¡å»¶è¿å æ¯ç»è®¡çæ¡¶æ°                                   6\nmetrics.rollingPercentile.bucketSize            ç¾åæ¯ç»è®¡æ¡¶çå®¹éï¼æ¡¶åæå¤ä¿å­çè¿è¡æ¶é´ç»è®¡                       100\nmetrics.healthSnapshot.intervalInMilliseconds   ç»è®¡å¿«ç§å·æ°é´é                                      500 (ms)\n\n\n# çº¿ç¨æ± éç½®\n\nä»¥ä¸éç½®ç¨äºæ§å¶ Hystrix Command æ§è¡æä½¿ç¨ççº¿ç¨æ± ã\n\néç½®é¡¹                                     è¯´æ                                                           é»è®¤å¼\ncoreSize                                çº¿ç¨æ± æ ¸å¿çº¿ç¨æ°                                                     10\nmaximumSize                             çº¿ç¨æ± æå¤§çº¿ç¨æ°                                                     10\nmaxQueueSize                            æå¤§ LinkedBlockingQueue çå¤§å°ï¼-1 è¡¨ç¤ºç¨ SynchronousQueue           -1\nqueueSizeRejectionThreshold             éåå¤§å°éå¼ï¼è¶è¿åæç»                                                 5\nallowMaximumSizeToDivergeFromCoreSize   æ­¤å±æ§åè®¸ maximumSize çéç½®çæãè¯¥å¼å¯ä»¥ç­äºæå¤§äº coreSizeãè®¾ç½® coreSize       false\n                                        <maximumSize ä½¿å¾çº¿ç¨æ± å¯ä»¥ç»´æ maximumSize å¹¶åæ§ï¼ä½æ¯ä¼å¨ç¸å¯¹ç©ºé²æ¶å°çº¿ç¨åæ¶ãï¼åå³äº\n                                        keepAliveTimeInMinutesï¼\n\n\n# å­ãå¶ä»éæµææ¯\n\n * resilience4j Hystrix è½ç¶å®æ¹å®£å¸ä¸åç»´æ¤ï¼å¶æ¨èå¦å¤ä¸ä¸ªæ¡æ¶ï¼resilience4j, è¿ä¸ªæ¡æ¶æ¯æ¯ä¸º Java 8 å å½æ°å¼ç¼ç¨è®¾è®¡çä¸ä¸ªè½»éçº§çå®¹éæ¡æ¶ï¼è¯¥æ¡æ¶ååå©ç¨å½æ°å¼ç¼ç¨çæ¦å¿µï¼ä¸ºå½æ°å¼æ¥å£ãlamdaè¡¨è¾¾å¼ãæ¹æ³å¼ç¨é«é¶å½æ°è¿è¡åè£ï¼(æ¬è´¨ä¸æ¯è£é¥°èæ¨¡å¼çæ¦å¿µ)ï¼éè¿åè£å®ç°æ­è·¯ãéæµãéè¯ãè±å£åè½ã è¿ä¸ªæ¡æ¶æ´ä½èè¨æ¯è¾è½»éï¼æ²¡ææ§å¶å°ï¼ä¸å¤ªå¥½åç³»ç»çº§çæ§ï¼\n\n * Alibaba Sentinel\n   \n   Sentinel\n   \n   \n   æ¯ é¿éå·´å·´å¼æºçè½»éçº§çæµéæ§å¶ãçæ­éçº§ Java åºï¼è¯¥åºçæ ¸å¿æ¯ä½¿ç¨çæ¯ä¿¡å·ééç¦»çæ¹å¼åæµéæ§å¶åçæ­ï¼å¶ä¼ç¹æ¯å¶éææ§åæç¨æ§ï¼å ä¹è½åå½åä¸»æµç Spring Cloud, dubbo ,grpc ,nacos, zookeeper åéæï¼å¦ä¸å¾æç¤ºï¼\n   \n   \n   \n   sentinel-features-overview-en.png\n   \n   Sentinel\n   \n   \n   çç®æ çæåï¼\n   \n   \n   \n   sentinel\n   \n   \n   ä¸ä¸ªå¼ºå¤§çåè½ï¼å°±æ¯å®æä¸ä¸ªæµæ§ç®¡çæ§å¶å°ï¼ä½ å¯ä»¥å®æ¶å°çæ§æ¯ä¸ªæå¡çæµæ§æåµï¼å¹¶ä¸å¯ä»¥å®æ¶ç¼è¾åç§æµæ§ãçæ­è§åï¼ææå°ä¿è¯äºæå¡ä¿æ¤çåæ¶æ§ãä¸å¾æ¯åé¨è¯ç¨ç sentinel æ§å¶å°ï¼\n   \n   å¦å¤ï¼\n   \n   sentinel\n   \n   \n   è¿å¯ä»¥å\n   \n   ctrip apollo\n   \n   \n   åå¸å¼éç½®ç³»ç»è¿è¡éæï¼å°æµæ§è§éçº§ç­åç§è§ååéç½®å¨ apollo ä¸­ï¼ç¶åæå¡å¯å¨èªå¨å è½½æµæ§è§åã\n\n\n# åèèµæ\n\n * Hystrix Github\n * Spring Cloud Hystrix è®¾è®¡åç\n * Hystrix é½åæ´äºï¼æä¸ºä»ä¹è¿è¦å­¦ï¼',normalizedContent:'# hystrix å¿«éå¥é¨\n\n\n# ä¸ãhystrix ç®ä»\n\n\n# hystrix æ¯ä»ä¹\n\nhystrix æ¯ netflix å¼æºçä¸æ¬¾å®¹éæ¡æ¶ï¼åå«å¸¸ç¨çå®¹éæ¹æ³ï¼çº¿ç¨æ± éç¦»ãä¿¡å·ééç¦»ãçæ­ãéçº§ã\n\nhystrix å®æ¹å®£å¸ä¸ååå¸æ°çæ¬ã\n\nä½æ¯ hystrix çå®¢æ·ç«¯çæ­ä¿æ¤ï¼æ­è·¯å¨è®¾è®¡çå¿µï¼æéå¸¸é«çå­¦ä¹ ä»·å¼ã\n\n\n# ä¸ºä»ä¹éè¦ hystrix\n\nå¤æçåå¸å¼ç³»ç»æ¶æä¸­çåºç¨ç¨åºå¾å¾å·ææ°åä¸ªä¾èµé¡¹ï¼æ¯ä¸ªä¾èµé¡¹é½ä¼ä¸å¯é¿åå°å¨æä¸ªæ¶å»å¤±è´¥ã å¦æä¸»æºåºç¨ç¨åºæªä¸è¿äºå¤é¨æééç¦»å¼æ¥ï¼åå¯è½ä¼è¢«æ³¢åã\n\nä¾å¦ï¼å¯¹äºä¾èµäº 30 ä¸ªæå¡çåºç¨ç¨åºï¼åè®¾æ¯ä¸ªæå¡çæ­£å¸¸è¿è¡æ¶é´ä¸º 99.99ï¼ï¼åå¯ä»¥ææï¼\n\n> 99.9930 = 99.7ï¼ çæ­£å¸¸è¿è¡æ¶é´\n> \n> 10 äº¿ä¸ªè¯·æ±ä¸­ç 0.3ï¼= 3,000,000 ä¸ªå¤±è´¥\n> \n> å³ä½¿ææä¾èµé¡¹é½å·æåºè²çæ­£å¸¸è¿è¡æ¶é´ï¼æ¯æä¹ä¼æ 2 ä¸ªå°æ¶ä»¥ä¸çåæºæ¶é´ã\n> \n> ç¶èï¼ç°å®æåµä¸è¬æ¯è¿ç§ä¼°éæåµæ´ç³ç³ã\n\n----------------------------------------\n\nå½ä¸åæ­£å¸¸æ¶ï¼æ´ä½ç³»ç»å¦ä¸æç¤ºï¼\n\n\n\nå¨é«å¹¶ååºæ¯ï¼è¿äºä¾èµçç¨³å®æ§ä¸å¦å¯¹ç³»ç»çå½±åéå¸¸å¤§ï¼ä½æ¯ä¾èµæå¾å¤ä¸å¯æ§é®é¢ï¼å¦ç½ç»è¿æ¥ãèµæºç¹å¿ãæå¡å®æºç­ãä¾å¦ï¼ä¸å¾ä¸­æä¸ä¸ª qps ä¸º 50 çä¾èµ i åºç°ä¸å¯ç¨ï¼ä½æ¯å¶ä»ä¾èµæå¡æ¯å¯ç¨çã\n\n\n\nä½æ¯ï¼å¨é«å¹¶ååºæ¯ä¸ï¼å½ä¾èµ i é»å¡æ¶ï¼å¤§å¤æ°æå¡å¨ççº¿ç¨æ± å°±åºç°é»å¡(block)ãå½è¿ç§çº§èæéææ¼æçï¼å°±å¯è½é ææ´ä¸ªçº¿ä¸æå¡ä¸å¯ç¨çéªå´©æåºï¼å¦ä¸å¾ï¼\n\n\n\nhystrix å°±æ¯ä¸ºäºè§£å³è¿ç±»é®é¢èåºè¿èçã\n\n\n# hystrix çåè½\n\nhystrix å·æä»¥ä¸åè½ï¼\n\n * é¿åèµæºèå°½ï¼é»æ­¢ä»»ä½ä¸ä¸ªä¾èµæå¡èå°½ææçèµæºï¼æ¯å¦ tomcat ä¸­çææçº¿ç¨èµæºã\n * é¿åè¯·æ±æéåç§¯åï¼éç¨éæµå fail fast æ¥æ§å¶æéã\n * æ¯æéçº§ï¼æä¾ fallback éçº§æºå¶æ¥åºå¯¹æéã\n * èµæºéç¦»ï¼æ¯å¦ bulkheadï¼è±å£éç¦»ææ¯ï¼ãswimlaneï¼æ³³éææ¯ï¼ãcircuit breakerï¼æ­è·¯ææ¯ï¼æ¥éå¶ä»»ä½ä¸ä¸ªä¾èµæå¡çæéçå½±åã\n * ç»è®¡/çæ§/æ¥è­¦ï¼éè¿è¿å®æ¶çç»è®¡/çæ§/æ¥è­¦åè½ï¼æ¥æé«æéåç°çéåº¦ã\n * éè¿è¿å®æ¶çå±æ§åéç½®ç­ä¿®æ¹åè½ï¼æ¥æé«æéå¤çåæ¢å¤çéåº¦ã\n * ä¿æ¤ä¾èµæå¡è°ç¨çæææéæåµï¼èä¸ä»ä»åªæ¯ç½ç»æéæåµã\n\nå¦æä½¿ç¨ hystrix å¯¹æ¯ä¸ªåºç¡ä¾èµæå¡è¿è¡è¿è½½ä¿æ¤ï¼åæ´ä¸ªç³»ç»æ¶æå°ä¼ç±»ä¼¼ä¸å¾æç¤ºï¼æ¯ä¸ªä¾èµé¡¹å½¼æ­¤éç¦»ï¼åå°å»¶è¿æ¶åçé¥±åçèµæºçè¢«éå¶è®¿é®ï¼å¹¶åå« fallback é»è¾ï¼ç¨äºéçº§å¤çï¼ï¼è¯¥é»è¾å³å®äºå¨ä¾èµé¡¹ä¸­åçä»»ä½ç±»åçæéæ¶ååºå¯¹åºçå¤çã\n\n\n\n\n# hystrix æ ¸å¿æ¦å¿µ\n\n\n# äºãhystrix å·¥ä½æµç¨\n\nå¦ä¸å¾æç¤ºï¼hystrix çå·¥ä½æµç¨å¤§è´å¯ä»¥åä¸º 9 ä¸ªæ­¥éª¤ã\n\n\n\n\n# ï¼ä¸ï¼åè£å½ä»¤\n\nx æ¯æèµæºéç¦»ã\n\nèµæºéç¦»ï¼å°±æ¯è¯´ï¼ä½ å¦æè¦æå¯¹æä¸ä¸ªä¾èµæå¡çææè°ç¨è¯·æ±ï¼å¨é¨éç¦»å¨åä¸ä»½èµæºæ± åï¼ä¸ä¼å»ç¨å¶å®èµæºäºï¼è¿å°±å«èµæºéç¦»ãåªæå¯¹è¿ä¸ªä¾èµæå¡ï¼æ¯å¦è¯´ååæå¡ï¼ç°å¨åæ¶åèµ·çè°ç¨éå·²ç»å°äº 1000ï¼ä½æ¯åéç»ååæå¡çº¿ç¨æ± åå°± 10 ä¸ªçº¿ç¨ï¼æå¤å°±åªä¼ç¨è¿ 10 ä¸ªçº¿ç¨å»æ§è¡ãä¸ä¼å ä¸ºå¯¹ååæå¡è°ç¨çå»¶è¿ï¼å° tomcat åé¨ææççº¿ç¨èµæºå¨é¨èå°½ã\n\nhystrix è¿è¡èµæºéç¦»ï¼å¶å®æ¯æä¾äºä¸ä¸ªæ½è±¡ï¼å«åå½ä»¤æ¨¡å¼ãè¿ä¹æ¯ hystrix ææåºæ¬çèµæºéç¦»ææ¯ã\n\nå¨ä½¿ç¨ hystrix çè¿ç¨ä¸­ï¼ä¼å¯¹ä¾èµæå¡çè°ç¨è¯·æ±å°è£æå½ä»¤å¯¹è±¡ï¼hystrix å¯¹ å½ä»¤å¯¹è±¡æ½è±¡äºä¸¤ä¸ªæ½è±¡ç±»ï¼hystrixcommand åhystrixobservablecommand ã\n\n * hystrixcommand è¡¨ç¤ºçå½ä»¤å¯¹è±¡ä¼è¿åä¸ä¸ªå¯ä¸è¿åå¼ã\n * hystrixobservablecommand è¡¨ç¤ºçå½ä»¤å¯¹è±¡ ä¼è¿åå¤ä¸ªè¿åå¼ã\n\nhystrixcommand command = new hystrixcommand(arg1, arg2);\nhystrixobservablecommand command = new hystrixobservablecommand(arg1, arg2);\n\n\n\n# ï¼äºï¼æ§è¡å½ä»¤\n\nhystrix ä¸­å±æ 4 ç§æ¹å¼æ§è¡å½ä»¤ï¼å¦ä¸æç¤ºï¼\n\næ§è¡æ¹å¼           è¯´æ                                               å¯ç¨å¯¹è±¡\nexecute()      é»å¡å¼åæ­¥æ§è¡ï¼è¿åä¾èµæå¡çåä¸è¿åç»æ(æèæåºå¼å¸¸)                    hystrixcommand\nqueue()        åºäº future çå¼æ­¥æ¹å¼æ§è¡ï¼è¿åä¾èµæå¡çåä¸è¿åç»æ(æèæåºå¼å¸¸)          hystrixcommand\nobserve()      åºäº rxjava ç observable æ¹å¼ï¼è¿åéè¿ observable        hystrixobservablecommand\n               è¡¨ç¤ºçä¾èµæå¡è¿åç»æ,ä»£è°ç¨ä»£ç åæ§è¡(hot obserable)\ntoobvsevable   åºäº rxjava ç observable æ¹å¼ï¼è¿åéè¿ observable        hystrixobservablecommand\n               è¡¨ç¤ºçä¾èµæå¡è¿åç»æ,æ§è¡ä»£ç ç­å°çæ­£è®¢éçæ¶åæä¼æ§è¡(cold observable)\n\nè¿åç§å½ä»¤ä¸­ï¼exeucte()ãqueue()ãobserve()çè¡¨ç¤ºä¹æ¯éè¿toobservable()å®ç°çï¼å¶è½¬æ¢å³ç³»å¦ä¸å¾æç¤ºï¼\n\n\n\nhystrixcommand æ§è¡æ¹å¼\n\nk value   = command.execute();\n// ç­ä»·è¯­å¥ï¼\nk value = command.execute().queue().get();\n\n\nfuture<k> fvalue  = command.queue();\n//ç­ä»·è¯­å¥ï¼\nfuture<k> fvalue = command.toobservable().toblocking().tofuture();\n\n\nobservable<k> ohvalue = command.observe(); //hot observableï¼ç«å»è®¢éï¼å½ä»¤ç«å»æ§è¡\n//ç­ä»·è¯­å¥ï¼\nobservable<k> ohvalue = command.toobservable().subscribe(subject);\n\n// ä¸è¿°æ§è¡æç»å®ç°è¿æ¯åºäº toobservable()\nobservable<k> ocvalue = command.toobservable(); //cold observableï¼å»¶åè®¢éï¼è®¢éåçåï¼æ§è¡æçæ­£æ§è¡\n\n\n\n# ï¼ä¸ï¼æ¯å¦ç¼å­\n\nå¦æå½åå½ä»¤å¯¹è±¡éç½®äºåè®¸ä»ç»æç¼å­ä¸­åè¿åç»æï¼å¹¶ä¸å¨ç»æç¼å­ä¸­å·²ç»ç¼å­äºè¯·æ±ç»æï¼åç¼å­çè¯·æ±ç»æä¼ç«å»éè¿ observable çæ ¼å¼è¿åã\n\n\n# ï¼åï¼æ¯å¦å¼å¯æ­è·¯å¨\n\nå¦æç¬¬ä¸æ­¥æ²¡æç¼å­æ²¡æå½ä¸­ï¼åå¤æ­ä¸ä¸å½åæ­è·¯å¨çæ­è·¯ç¶ææ¯å¦æå¼ãå¦ææ­è·¯å¨ç¶æä¸ºæå¼ç¶æï¼å hystrix å°ä¸ä¼æ§è¡æ­¤ command å½ä»¤ï¼ç´æ¥æ§è¡æ­¥éª¤ 8 è°ç¨ fallbackï¼\n\nå¦ææ­è·¯å¨ç¶ææ¯å³é­ï¼åæ§è¡ æ­¥éª¤ 5 æ£æ¥æ¯å¦æè¶³å¤çèµæºè¿è¡ command å½ä»¤\n\n\n# ï¼äºï¼ä¿¡å·éãçº¿ç¨æ± æ¯å¦æç»\n\nå¦æå½åè¦æ§è¡ç command å½ä»¤ åå³è¿ççº¿ç¨æ±  åéå(æèä¿¡å·é)èµæºå·²ç»æ»¡äºï¼hystrix å°ä¸ä¼è¿è¡ command å½ä»¤ï¼ç´æ¥æ§è¡ æ­¥éª¤ 8ç fallback éçº§å¤çï¼å¦ææªæ»¡ï¼è¡¨ç¤ºæå©ä½çèµæºæ§è¡ command å½ä»¤ï¼åæ§è¡æ­¥éª¤ 6\n\n\n# ï¼å­ï¼construct() æ run()\n\nå½ç»è¿æ­¥éª¤ 5 å¤æ­ï¼æè¶³å¤çèµæºæ§è¡ command å½ä»¤æ¶ï¼æ¬æ­¥éª¤å°è°ç¨ command å½ä»¤è¿è¡æ¹æ³ï¼åºäºä¸åç±»åç commandï¼æå¦ä¸ä¸¤ç§ä¸¤ç§è¿è¡æ¹å¼ï¼\n\nè¿è¡æ¹å¼                                   è¯´æ\nhystrixcommand.run()                   è¿åä¸ä¸ªå¤çç»ææèæåºä¸ä¸ªå¼å¸¸\nhystrixobservablecommand.construct()   è¿åä¸ä¸ª observable è¡¨ç¤ºçç»æ(å¯è½å¤ä¸ª)ï¼æè åºäºonerrorçéè¯¯éç¥\n\nå¦ærun() æèconstruct()æ¹æ³ ççå®æ§è¡æ¶é´è¶è¿äº command è®¾ç½®çè¶æ¶æ¶é´éå¼, åå½ååæ§è¡çº¿ç¨ï¼æèæ¯ç¬ç«çå®æ¶å¨çº¿ç¨ï¼å°ä¼æåºtimeoutexceptionãæåºè¶æ¶å¼å¸¸ timeoutexceptionï¼åï¼å°æ§è¡æ­¥éª¤ 8ç fallback éçº§å¤çãå³ä½¿run()æèconstruct()æ§è¡æ²¡æè¢«åæ¶æä¸­æ­ï¼æç»è½å¤å¤çè¿åç»æï¼ä½å¨éçº§å¤çé»è¾ä¸­ï¼å°ä¼æå¼run()æconstruct()æ¹æ³çè¿åç»æï¼èè¿å fallback éçº§å¤çç»æã\n\n> æ³¨æäºé¡¹ éè¦æ³¨æçæ¯ï¼hystrix æ æ³å¼ºå¶ å°æ­£å¨è¿è¡ççº¿ç¨åæ­¢æ--hystrix è½å¤åçæå¥½çæ¹å¼å°±æ¯å¨ jvm ä¸­æåºä¸ä¸ªinterruptedexceptionãå¦æ hystrix åè£çå·¥ä½ä¸æåºä¸­æ­å¼å¸¸interruptedexception, åå¨ hystrix çº¿ç¨æ± ä¸­ççº¿ç¨å°ä¼ç»§ç»­æ§è¡ï¼å°½ç®¡è°ç¨çå®¢æ·ç«¯å·²ç»æ¥æ¶å°äºtimeoutexceptionãè¿ç§æ¹å¼ä¼ä½¿ hystrix ççº¿ç¨æ± å¤äºé¥±åç¶æãå¤§é¨åç java http client å¼æºåºå¹¶ä¸ä¼è§£æ interruptedexceptionãæä»¥ç¡®è®¤ http client ç¸å³çè¿æ¥åè¯»/åç¸å³çè¶æ¶æ¶é´è®¾ç½®ã å¦æ command å½ä»¤æ²¡ææåºä»»ä½å¼å¸¸ï¼å¹¶ä¸æè¿åç»æï¼å hystrix å°ä¼å¨åå®æ¥å¿è®°å½åç»è®¡ä¹åä¼å°ç»æè¿åã å¦ææ¯éè¿run()æ¹å¼è¿è¡ï¼åè¿åä¸ä¸ªobserableå¯¹è±¡ï¼åå«ä¸ä¸ªå¯ä¸å¼ï¼å¹¶ä¸åéä¸ä¸ªoncompletedéç¥ï¼å¦ææ¯éè¿consturct()æ¹å¼è¿è¡ ï¼åè¿åä¸ä¸ªobservableå¯¹è±¡ã\n\n\n# ï¼ä¸ï¼å¥åº·æ£æ¥\n\nhystrix ä¼ç»è®¡ command å½ä»¤æ§è¡æ§è¡è¿ç¨ä¸­çæåæ°ãå¤±è´¥æ°ãæç»æ°åè¶æ¶æ°,å°è¿äºä¿¡æ¯è®°å½å°æ­è·¯å¨(circuit breaker)ä¸­ãæ­è·¯å¨å°ä¸è¿°ç»è®¡æç§æ¶é´çªçå½¢å¼è®°å½å°ä¸ä¸ªå®é¿æ°ç»ä¸­ãæ­è·¯å¨æ ¹æ®æ¶é´çªåçç»è®¡æ°æ®å»å¤å®è¯·æ±ä»ä¹æ¶åå¯ä»¥è¢«çæ­ï¼çæ­åï¼å¨æ¥ä¸æ¥ä¸æ®µæ¢å¤å¨æåï¼ç¸åçè¯·æ±è¿æ¥åä¼ç´æ¥è¢«çæ­ãå½åæ¬¡æ ¡éªï¼å¦æå¥åº·çæµéè¿åï¼çæ­å¼å³å°ä¼è¢«å³é­ã\n\n\n# ï¼å«ï¼è·å fallback\n\nå½ä»¥ä¸åºæ¯åºç°åï¼hystrix å°ä¼å°è¯è§¦å fallback:\n\n>  * æ­¥éª¤ 6 command æ§è¡æ¶æåºäºä»»ä½å¼å¸¸ï¼\n>  * æ­¥éª¤ 4 æ­è·¯å¨å·²ç»è¢«æå¼\n>  * æ­¥éª¤ 5 æ§è¡å½ä»¤ççº¿ç¨æ± ãéåæèä¿¡å·éèµæºå·²æ»¡\n>  * å½ä»¤æ§è¡çæ¶é´è¶è¿éå¼\n\n\n# ï¼ä¹ï¼è¿åç»æ\n\nå¦æ hystrix å½ä»¤å¯¹è±¡æ§è¡æåï¼å°ä¼è¿åç»æï¼æèä»¥observableå½¢å¼åè£çç»æãæ ¹æ®æ­¥éª¤ 2ç command è°ç¨æ¹å¼ï¼è¿åçobservable ä¼æç§å¦ä¸å¾è¯´æ¯çè½¬æ¢å³ç³»è¿è¡è¿åï¼\n\n\n\n * execute() â ç¨å .queue() ç¸åçæ¹å¼è·å futureï¼ç¶åè°ç¨ future ç get() ä»¥è·å observable çåä¸ªå¼ã\n * queue() âå° observable è½¬æ¢ä¸º blockingobservableï¼ä»¥ä¾¿å¯ä»¥å°å¶è½¬æ¢ä¸º future å¹¶è¿åã\n * watch() âè®¢é observable å¹¶å¼å§æ§è¡å½ä»¤çæµç¨ï¼ è¿åä¸ä¸ª observableï¼å½è®¢éè¯¥ observable æ¶ï¼å®ä¼éæ°éç¥ã\n * toobservable() âè¿åä¸åç observableï¼ å¿é¡»è®¢éå®æè½çæ­£å¼å§æ§è¡å½ä»¤çæµç¨ã\n\n\n# ä¸ãæ­è·¯å¨å·¥ä½åç\n\n\n\n 1. æ­è·¯å¨æ¶é´çªåçè¯·æ±æ° æ¯å¦è¶è¿äºè¯·æ±æ°æ­è·¯å¨çæéå¼circuitbreaker.requestvolumethreshold,å¦æè¶è¿äºéå¼ï¼åå°ä¼è§¦åæ­è·¯ï¼æ­è·¯ç¶æä¸ºå¼å¯ ä¾å¦ï¼å¦æå½åéå¼è®¾ç½®çæ¯20,åå½æ¶é´çªåç»è®¡çè¯·æ±æ°å±è®¡ 19 ä¸ªï¼å³ä½¿ 19 ä¸ªå¨é¨å¤±è´¥äºï¼é½ä¸ä¼è§¦åæ­è·¯å¨ã\n 2. å¹¶ä¸è¯·æ±éè¯¯çè¶è¿äºè¯·æ±éè¯¯çéå¼errorthresholdpercentage\n 3. å¦æä¸¤ä¸ªé½æ»¡è¶³ï¼åå°æ­è·¯å¨ç±å³é­è¿ç§»å°å¼å¯\n 4. å¦ææ­è·¯å¨å¼å¯ï¼ååç»­çææç¸åè¯·æ±å°ä¼è¢«æ­è·¯æï¼\n 5. ç´å°è¿äºæ²ç¡æ¶é´çªsleepwindowinmillisecondsåï¼ååèµ·è¯·æ±æ¶ï¼åè®¸å¶éè¿ï¼æ­¤æ¶çç¶æä¸ºåå¼èµ·ç¶æï¼ãå¦æè¯·æ±å¤±è´¥äºï¼åä¿ææ­è·¯å¨ç¶æä¸ºå¼å¯ç¶æï¼å¹¶æ´æ°æ²ç¡æ¶é´çªãå¦æè¯·æ±æåäºï¼åå°æ­è·¯å¨ç¶ææ¹ä¸ºå³é­ç¶æï¼\n\næ ¸å¿çé»è¾å¦ä¸ï¼\n\n @override\n                        public void onnext(healthcounts hc) {\n                            // check if we are past the statisticalwindowvolumethreshold\n                            if (hc.gettotalrequests() < properties.circuitbreakerrequestvolumethreshold().get()) {\n                                // we are not past the minimum volume threshold for the stat window,\n                                // so no change to circuit status.\n                                // if it was closed, it stays closed\n                                // if it was half-open, we need to wait for a successful command execution\n                                // if it was open, we need to wait for sleep window to elapse\n                            } else {\n                                if (hc.geterrorpercentage() < properties.circuitbreakererrorthresholdpercentage().get()) {\n                                    //we are not past the minimum error threshold for the stat window,\n                                    // so no change to circuit status.\n                                    // if it was closed, it stays closed\n                                    // if it was half-open, we need to wait for a successful command execution\n                                    // if it was open, we need to wait for sleep window to elapse\n                                } else {\n                                    // our failure rate is too high, we need to set the state to open\n                                    if (status.compareandset(status.closed, status.open)) {\n                                        circuitopened.set(system.currenttimemillis());\n                                    }\n                                }\n                            }\n                        }\n\n\n\n# ç³»ç»ææ \n\nhystrix å¯¹ç³»ç»ææ çç»è®¡æ¯åºäºæ¶é´çªæ¨¡å¼çï¼\n\n> æ¶é´çªï¼æè¿çä¸ä¸ªæ¶é´åºé´åï¼æ¯å¦åä¸å°æ¶å°ç°å¨ï¼é£ä¹æ¶é´çªçé¿åº¦å°±æ¯1å°æ¶ï¼ æ¡¶ï¼æ¡¶æ¯å¨ç¹å®çæ¶é´çªåï¼ç­åçææ æ¶éçç»è®¡éåï¼æ¯å¦æ¶é´çªçé¿åº¦ä¸º1å°æ¶ï¼èæ¡¶çæ°éä¸º10,é£ä¹æ¯ä¸ªæ¡¶å¨æ¶é´è½´ä¸ä¾æ¬¡æå¼ï¼æ¶é´ç±è¿åè¿ï¼æ¯ä¸ªæ¡¶ç»è®¡çæ¶é´åçä¸º 1h / 10 = 6 min 6 åéãä¸ä¸ªæ¡¶ä¸­ï¼åå«äºæåæ°ãå¤±è´¥æ°ãè¶æ¶æ°ãæç»æ° åä¸ªææ ã\n\nå¨ç³»ç»åï¼æ¶é´çªä¼éçç³»ç»çè¿è¡éæ¸ååç§»å¨ï¼èæ¶é´çªçé¿åº¦åæ¡¶çæ°éæ¯åºå®ä¸åçï¼é£ä¹éçæ¶é´çç§»å¨ï¼ä¼åºç°è¾ä¹çè¿æçæ¡¶è¢«ç§»é¤åºå»ï¼æ°çæ¡¶è¢«æ·»å è¿æ¥ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\n\n# åãèµæºéç¦»ææ¯\n\n\n# çº¿ç¨æ± éç¦»\n\nå¦ä¸å¾æç¤ºï¼ç±äºè®¡ç®æºç³»ç»çåºæ¬æ§è¡åä½å°±æ¯çº¿ç¨ï¼çº¿ç¨å·å¤ç¬ç«çæ§è¡è½åï¼æä»¥ï¼ä¸ºäºåå°èµæºä¿æ¤ï¼éè¦å¯¹ç³»ç»ççº¿ç¨æ± è¿è¡ååï¼å¯¹äºå¤é¨è°ç¨æ¹\n\nuser request\n\n\nçè¯·æ±ï¼è°ç¨åä¸ªçº¿ç¨æ± çæå¡ï¼åä¸ªçº¿ç¨æ± ç¬ç«å®æè°ç¨ï¼ç¶åå°ç»æè¿å\n\nè°ç¨æ¹\n\n\nãå¨è°ç¨æå¡çè¿ç¨ä¸­ï¼å¦æ\n\næå¡æä¾æ¹\n\n\næ§è¡æ¶é´è¿é¿ï¼å\n\nè°ç¨æ¹\n\n\nå¯ä»¥ç´æ¥ä»¥è¶æ¶çæ¹å¼ç´æ¥è¿åï¼å¿«éå¤±è´¥ã\n\n\n\nçº¿ç¨æ± éç¦»çå ç¹å¥½å¤\n\n>  1. ä½¿ç¨è¶æ¶è¿åçæºå¶ï¼é¿ååæ­¥è°ç¨æå¡æ¶ï¼è°ç¨æ¶é´è¿é¿ï¼æ æ³éæ¾ï¼å¯¼è´èµæºèå°½çæåµ\n>  2. æå¡æ¹å¯ä»¥æ§å¶è¯·æ±æ°éï¼è¯·æ±è¿å¤ï¼å¯ä»¥ç´æ¥æç»,è¾¾å°å¿«éå¤±è´¥çç®çï¼\n>  3. è¯·æ±æéï¼çº¿ç¨æ± å¯ä»¥ç»´æ¤æ§è¡éåï¼å°è¯·æ±åå°éåä¸­å¤ç\n\nä¸¾ä¸ªä¾å­ï¼å¦ä¸ä»£ç æ®µï¼æ¨¡æäºåæ­¥è°ç¨æå¡çè¿ç¨ï¼\n\n        //æå¡æä¾æ¹ï¼æ§è¡æå¡çæ¶åæ¨¡æ2åéçèæ¶\n        callable<string> callableservice  = ()->{\n            long start = system.currenttimemillis();\n            while(system.currenttimemillis()-start> 1000 * 60 *2){\n               //æ¨¡ææå¡æ§è¡æ¶é´è¿é¿çæåµ\n            }\n            return "ok";\n        };\n\n        //æ¨¡æ10ä¸ªå®¢æ·ç«¯è°ç¨æå¡\n        executorservice clients = executors.newfixedthreadpool(10);\n        //æ¨¡æç»10ä¸ªå®¢æ·ç«¯æäº¤å¤çè¯·æ±\n        for (int i = 0; i < 20; i++) {\n            clients.execute(()->{\n                //åæ­¥è°ç¨\n                try {\n                    string result = callableservice.call();\n                    system.out.println("å½åå®¢æ·ç«¯ï¼"+thread.currentthread().getname()+"è°ç¨æå¡å®æï¼å¾å°ç»æï¼"+result);\n                } catch (exception e) {\n                    e.printstacktrace();\n                }\n            });\n        }\n\n\nå¨æ­¤ç¯èä¸­ï¼å®¢æ·ç«¯ clientså¿é¡»ç­å¾æå¡æ¹è¿åç»æä¹åï¼æè½æ¥æ¶æ°çè¯·æ±ãå¦æç¨ååéæ¥è¡¡éç³»ç»çè¯ï¼ä¼åç°ç³»ç»çå¤çè½åæ¯è¾ä½ãä¸ºäºæé«ç¸åºæ¶é´ï¼å¯ä»¥åå©çº¿ç¨æ± çæ¹å¼ï¼è®¾ç½®è¶æ¶æ¶é´ï¼è¿æ ·çè¯ï¼å®¢æ·ç«¯å°±ä¸éè¦å¿é¡»ç­å¾æå¡æ¹è¿åï¼å¦ææ¶é´è¿é¿ï¼å¯ä»¥æåè¿å,æ¹é åçä»£ç å¦ä¸æç¤ºï¼\n\n //æå¡æä¾æ¹ï¼æ§è¡æå¡çæ¶åæ¨¡æ2åéçèæ¶\n        callable<string> callableservice  = ()->{\n            long start = system.currenttimemillis();\n            while(system.currenttimemillis()-start> 1000 * 60 *2){\n               //æ¨¡ææå¡æ§è¡æ¶é´è¿é¿çæåµ\n            }\n            return "ok";\n        };\n\n        //åå»ºçº¿ç¨æ± ä½ä¸ºæå¡æ¹\n        executorservice executorservice = executors.newfixedthreadpool(30);\n\n\n        //æ¨¡æ10ä¸ªå®¢æ·ç«¯è°ç¨æå¡\n        executorservice clients = executors.newfixedthreadpool(10);\n        for (int i = 0; i < 10; i++) {\n            clients.execute(()->{\n                //åæ­¥è°ç¨\n                    //å°è¯·æ±æäº¤ç»çº¿ç¨æ± æ§è¡ï¼callable å runnableå¨æç§æä¹ä¸ï¼ä¹æ¯commandå¯¹è±¡\n                    future<string> future = executorservice.submit(callableservice::call);\n                    //å¨æå®çæ¶é´åè·åç»æï¼å¦æè¶æ¶ï¼è°ç¨æ¹å¯ä»¥ç´æ¥è¿å\n                    try {\n                        string result = future.get(1000, timeunit.seconds);\n                        //å®¢æ·ç«¯ç­å¾æ¶é´ä¹åï¼å¿«éè¿å\n                        system.out.println("å½åå®¢æ·ç«¯ï¼"+thread.currentthread().getname()+"è°ç¨æå¡å®æï¼å¾å°ç»æï¼"+result);\n                    }catch (timeoutexception timeoutexception){\n                        system.out.println("æå¡è°ç¨è¶æ¶ï¼è¿åå¤ç");\n                    } catch (interruptedexception e) {\n\n                    } catch (executionexception e) {\n                    }\n            });\n        }\n\n\nå¦ææä»¬å°æå¡æ¹ççº¿ç¨æ± è®¾ç½®ä¸ºï¼\n\nthreadpoolexecutor executorservice = new threadpoolexecutor(10,1000,timeunit.seconds,\nnew arrayblockingqueue<>(100),\nnew threadpoolexecutor.discardpolicy() // æäº¤è¯·æ±è¿å¤æ¶ï¼å¯ä»¥ä¸¢å¼è¯·æ±ï¼é¿åæ­»ç­é»å¡çæåµã\n)\n\n\nçº¿ç¨æ± éç¦»æ¨¡å¼çå¼ç«¯\n\n> çº¿ç¨æ± éç¦»æ¨¡å¼ï¼ä¼æ ¹æ®æå¡åååºç¬ç«ççº¿ç¨æ± ï¼ç³»ç»èµæºççº¿ç¨å¹¶åæ°æ¯æéçï¼å½çº¿ç¨æ°è¿å¤ï¼ç³»ç»è¯è´¹å¤§éç cpu æ¶é´æ¥åçº¿ç¨ä¸ä¸æåæ¢çæ ç¨æä½ï¼åèéä½ç³»ç»æ§è½ï¼å¦æçº¿ç¨æ± éç¦»çè¿å¤ï¼ä¼å¯¼è´çæ­£ç¨äºæ¥æ¶ç¨æ·è¯·æ±ççº¿ç¨å°±ç¸åºå°åå°ï¼ç³»ç»ååéåèä¸éï¼ å¨å®è·µä¸ï¼åºå½å¯¹åè¿ç¨æ¹æ³è°ç¨ï¼ç½ç»èµæºè¯·æ±è¿ç§æå¡æ¶é´ä¸å¤ªå¯æ§çåºæ¯ä¸ä½¿ç¨çº¿ç¨æ± éç¦»æ¨¡å¼å¤ç å¦ä¸å¾æç¤ºï¼æ¯çº¿ç¨æ± éç¦»æ¨¡å¼çä¸ç§åºæ¯ï¼\n\n\n\n\n# ä¿¡å·ééç¦»\n\nç±äºåºäºçº¿ç¨æ± éç¦»çæ¨¡å¼å ç¨ç³»ç»çº¿ç¨æ± èµæºï¼hystrix è¿æä¾äºå¦å¤ä¸ä¸ªéç¦»ææ¯ï¼åºäºä¿¡å·éçéç¦»ã\n\nåºäºä¿¡å·éçéç¦»æ¹å¼éå¸¸å°ç®åï¼å¶æ ¸å¿å°±æ¯ä½¿ç¨å±ç¨åé\n\nsemaphore\n\n\nè¿è¡åå­æä½ï¼æ§å¶çº¿ç¨çå¹¶åéï¼å½å¹¶åéè¾¾å°ä¸å®éçº§æ¶ï¼æå¡ç¦æ­¢è°ç¨ãå¦ä¸å¾æç¤ºï¼ä¿¡å·éæ¬èº«ä¸ä¼æ¶èå¤ä½ççº¿ç¨èµæºï¼æä»¥å°±éå¸¸è½»éã\n\n\n\nåºäºä¿¡å·ééç¦»çå©å¼\n\n> å©ï¼åºäºä¿¡å·éçéç¦»ï¼å©ç¨ jvm çåå­æ§ cas æä½ï¼é¿åäºèµæºéçç«äºï¼çå»äºçº¿ç¨æ± å¼éï¼æçéå¸¸é«ï¼ å¼ï¼æ¬è´¨ä¸åºäºä¿¡å·éçéç¦»æ¯åæ­¥è¡ä¸ºï¼æä»¥æ æ³åå°è¶æ¶çæ­ï¼æä»¥æå¡æ¹èªèº«è¦æ§å¶ä½æ§è¡æ¶é´ï¼é¿åè¶æ¶ã åºç¨åºæ¯ï¼ä¸å¡æå¡ä¸ï¼æå¹¶åä¸ééå¶æ¶ï¼å¯ä»¥èèæ­¤æ¹å¼ > alibaba sentinelå¼æºæ¡æ¶ï¼å°±æ¯åºäºä¿¡å·éççæ­åæ­è·¯å¨æ¡æ¶ã\n\n\n# äºãhystrix åºç¨\n\n\n# spring cloud + hystrix\n\n * hystrix éç½®æ æ³å¨æè°èçæãhystrix æ¡æ¶æ¬èº«æ¯ä½¿ç¨çarchaiusæ¡æ¶å®æçéç½®å è½½åå·æ°ï¼ä½æ¯éæèª spring cloud ä¸ï¼æ æ³ææå°æ ¹æ®å®æ¶çæ§ç»æï¼å¨æè°æ´çæ­åç³»ç»åæ°\n * çº¿ç¨æ± å command ä¹é´çéç½®æ¯è¾å¤æ,å¨ spring cloud å¨å feigin-hystrix éæçæ¶åï¼è¿æäº bugï¼å¯¹ command çé»è®¤éç½®æ²¡æå¤çå¥½ï¼å¯¼è´ææ command å ç¨å¬å±ç command çº¿ç¨æ± ï¼æ²¡æç»ç²åº¦æ§å¶ï¼è¿éè¦åæ¡æ¶ééè°æ´\n\npublic interface setterfactory {\n\n  /**\n   * returns a hystrix setter appropriate for the given target and method\n   */\n  hystrixcommand.setter create(target<?> target, method method);\n\n  /**\n   * default behavior is to derive the group key from {@link target#name()} and the command key from\n   * {@link feign#configkey(class, method)}.\n   */\n  final class default implements setterfactory {\n\n    @override\n    public hystrixcommand.setter create(target<?> target, method method) {\n      string groupkey = target.name();\n      string commandkey = feign.configkey(target.type(), method);\n      return hystrixcommand.setter\n          .withgroupkey(hystrixcommandgroupkey.factory.askey(groupkey))\n          .andcommandkey(hystrixcommandkey.factory.askey(commandkey));\n          //æ²¡æå¤çå¥½defaultéç½®é¡¹çå è½½\n    }\n  }\n}\n\n\n\n# hystrix éç½®\n\n> è¯¦ç»éç½®å¯ä»¥åè hystrix å®æ¹éç½®æåï¼è¿éä»ä»ç»æ¯è¾æ ¸å¿çéç½®\n\n\n# æ§è¡éç½®\n\nä»¥ä¸éç½®ç¨äºæ§å¶ hystrixcommand.run() å¦ä½æ§è¡ã\n\néç½®é¡¹                                                   è¯´æ                              é»è®¤å¼\nexecution.isolation.strategy                          çº¿ç¨éç¦»ï¼threadï¼æä¿¡å·ééç¦»ï¼semaphoreï¼   thread\nexecution.isolation.thread.timeoutinmilliseconds      æ¹æ³æ§è¡è¶æ¶æ¶é´                        1000(ms)\nexecution.isolation.semaphore.maxconcurrentrequests   ä¿¡å·ééç¦»æå¤§å¹¶åæ°                      10\n\n\n# æ­è·¯éç½®\n\nä»¥ä¸éç½®ç¨äºæ§å¶ hystrixcircuitbreaker çæ­è·¯å¤çã\n\néç½®é¡¹                                        è¯´æ                é»è®¤å¼\ncircuitbreaker.enabled                     æ¯å¦å¼å¯æ­è·¯å¨           true\ncircuitbreaker.requestvolumethreshold      æ­è·¯å¨å¯ç¨è¯·æ±æ°éå¼        20\ncircuitbreaker.sleepwindowinmilliseconds   æ­è·¯å¨å¯ç¨åçä¼ç æ¶é´       5000(ms)\ncircuitbreaker.errorthresholdpercentage    æ­è·¯å¨å¯ç¨å¤±è´¥çéå¼        50(%)\ncircuitbreaker.forceopen                   æ¯å¦å¼ºå¶å°æ­è·¯å¨è®¾ç½®æå¼å¯ç¶æ   false\ncircuitbreaker.forceclosed                 æ¯å¦å¼ºå¶å°æ­è·¯å¨è®¾ç½®æå³é­ç¶æ   false\n\n\n# ææ éç½®\n\nä»¥ä¸éç½®ç¨äºä» hystrixcommand å hystrixobservablecommand æ§è¡ä¸­æè·ç¸å³ææ ã\n\néç½®é¡¹                                             è¯´æ                                            é»è®¤å¼\nmetrics.rollingstats.timeinmilliseconds         æ¶é´çªçé¿åº¦                                        10000(ms)\nmetrics.rollingstats.numbuckets                 æ¡¶çæ°éï¼éè¦ä¿è¯timeinmilliseconds % numbuckets =0   10\nmetrics.rollingpercentile.enabled               æ¯å¦ç»è®¡è¿è¡å»¶è¿çå æ¯                                   true\nmetrics.rollingpercentile.timeinmilliseconds    è¿è¡å»¶è¿å æ¯ç»è®¡çæ¶é´çª                                  60000(ms)\nmetrics.rollingpercentile.numbuckets            è¿è¡å»¶è¿å æ¯ç»è®¡çæ¡¶æ°                                   6\nmetrics.rollingpercentile.bucketsize            ç¾åæ¯ç»è®¡æ¡¶çå®¹éï¼æ¡¶åæå¤ä¿å­çè¿è¡æ¶é´ç»è®¡                       100\nmetrics.healthsnapshot.intervalinmilliseconds   ç»è®¡å¿«ç§å·æ°é´é                                      500 (ms)\n\n\n# çº¿ç¨æ± éç½®\n\nä»¥ä¸éç½®ç¨äºæ§å¶ hystrix command æ§è¡æä½¿ç¨ççº¿ç¨æ± ã\n\néç½®é¡¹                                     è¯´æ                                                           é»è®¤å¼\ncoresize                                çº¿ç¨æ± æ ¸å¿çº¿ç¨æ°                                                     10\nmaximumsize                             çº¿ç¨æ± æå¤§çº¿ç¨æ°                                                     10\nmaxqueuesize                            æå¤§ linkedblockingqueue çå¤§å°ï¼-1 è¡¨ç¤ºç¨ synchronousqueue           -1\nqueuesizerejectionthreshold             éåå¤§å°éå¼ï¼è¶è¿åæç»                                                 5\nallowmaximumsizetodivergefromcoresize   æ­¤å±æ§åè®¸ maximumsize çéç½®çæãè¯¥å¼å¯ä»¥ç­äºæå¤§äº coresizeãè®¾ç½® coresize       false\n                                        <maximumsize ä½¿å¾çº¿ç¨æ± å¯ä»¥ç»´æ maximumsize å¹¶åæ§ï¼ä½æ¯ä¼å¨ç¸å¯¹ç©ºé²æ¶å°çº¿ç¨åæ¶ãï¼åå³äº\n                                        keepalivetimeinminutesï¼\n\n\n# å­ãå¶ä»éæµææ¯\n\n * resilience4j hystrix è½ç¶å®æ¹å®£å¸ä¸åç»´æ¤ï¼å¶æ¨èå¦å¤ä¸ä¸ªæ¡æ¶ï¼resilience4j, è¿ä¸ªæ¡æ¶æ¯æ¯ä¸º java 8 å å½æ°å¼ç¼ç¨è®¾è®¡çä¸ä¸ªè½»éçº§çå®¹éæ¡æ¶ï¼è¯¥æ¡æ¶ååå©ç¨å½æ°å¼ç¼ç¨çæ¦å¿µï¼ä¸ºå½æ°å¼æ¥å£ãlamdaè¡¨è¾¾å¼ãæ¹æ³å¼ç¨é«é¶å½æ°è¿è¡åè£ï¼(æ¬è´¨ä¸æ¯è£é¥°èæ¨¡å¼çæ¦å¿µ)ï¼éè¿åè£å®ç°æ­è·¯ãéæµãéè¯ãè±å£åè½ã è¿ä¸ªæ¡æ¶æ´ä½èè¨æ¯è¾è½»éï¼æ²¡ææ§å¶å°ï¼ä¸å¤ªå¥½åç³»ç»çº§çæ§ï¼\n\n * alibaba sentinel\n   \n   sentinel\n   \n   \n   æ¯ é¿éå·´å·´å¼æºçè½»éçº§çæµéæ§å¶ãçæ­éçº§ java åºï¼è¯¥åºçæ ¸å¿æ¯ä½¿ç¨çæ¯ä¿¡å·ééç¦»çæ¹å¼åæµéæ§å¶åçæ­ï¼å¶ä¼ç¹æ¯å¶éææ§åæç¨æ§ï¼å ä¹è½åå½åä¸»æµç spring cloud, dubbo ,grpc ,nacos, zookeeper åéæï¼å¦ä¸å¾æç¤ºï¼\n   \n   \n   \n   sentinel-features-overview-en.png\n   \n   sentinel\n   \n   \n   çç®æ çæåï¼\n   \n   \n   \n   sentinel\n   \n   \n   ä¸ä¸ªå¼ºå¤§çåè½ï¼å°±æ¯å®æä¸ä¸ªæµæ§ç®¡çæ§å¶å°ï¼ä½ å¯ä»¥å®æ¶å°çæ§æ¯ä¸ªæå¡çæµæ§æåµï¼å¹¶ä¸å¯ä»¥å®æ¶ç¼è¾åç§æµæ§ãçæ­è§åï¼ææå°ä¿è¯äºæå¡ä¿æ¤çåæ¶æ§ãä¸å¾æ¯åé¨è¯ç¨ç sentinel æ§å¶å°ï¼\n   \n   å¦å¤ï¼\n   \n   sentinel\n   \n   \n   è¿å¯ä»¥å\n   \n   ctrip apollo\n   \n   \n   åå¸å¼éç½®ç³»ç»è¿è¡éæï¼å°æµæ§è§éçº§ç­åç§è§ååéç½®å¨ apollo ä¸­ï¼ç¶åæå¡å¯å¨èªå¨å è½½æµæ§è§åã\n\n\n# åèèµæ\n\n * hystrix github\n * spring cloud hystrix è®¾è®¡åç\n * hystrix é½åæ´äºï¼æä¸ºä»ä¹è¿è¦å­¦ï¼',charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Java ä¸­é´ä»¶",frontmatter:{title:"Java ä¸­é´ä»¶",categories:["ç¼ç¨","Java","ä¸­é´ä»¶"],tags:["ç¼ç¨","Java","ä¸­é´ä»¶"],abbrlink:"8b30e720",date:"2022-04-09T15:11:37.000Z",permalink:"/pages/3cbcff/"},regularPath:"/14.%E4%B8%AD%E9%97%B4%E4%BB%B6/",relativePath:"14.ä¸­é´ä»¶/README.md",key:"v-9e9dd666",path:"/pages/3cbcff/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:15},{level:4,title:"æ¶æ¯éå",slug:"æ¶æ¯éå",normalizedTitle:"æ¶æ¯éå",charIndex:24},{level:4,title:"ç¼å­",slug:"ç¼å­",normalizedTitle:"ç¼å­",charIndex:258},{level:4,title:"æµéæ§å¶",slug:"æµéæ§å¶",normalizedTitle:"æµéæ§å¶",charIndex:443},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:464},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:762}],headersStr:"ð åå®¹ æ¶æ¯éå ç¼å­ æµéæ§å¶ ð èµæ ðª ä¼ é",content:"# Java ä¸­é´ä»¶\n\n\n# ð åå®¹\n\n# æ¶æ¯éå\n\n> æ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åå¸å¼åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ åç§æ¶æ¯éåäº§åï¼å»ºè®®åäºè§£ä¸ä¸ æ¶æ¯éååºæ¬åç ï¼æå©äºçè§£æ¶æ¯éåç¹æ§çå®ç°åè®¾è®¡æè·¯ã\n\n * æ¶æ¯éåé¢è¯\n * æ¶æ¯éååºæ¬åç\n * RocketMQ\n * ActiveMQ\n\n# ç¼å­\n\n> ç¼å­å¯ä»¥è¯´æ¯ä¼åç³»ç»æ§è½çç¬¬ä¸ææ®µï¼å¨åç§ææ¯ä¸­é½ä¼æç¼å­çåºç¨ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ ç¼å­ï¼å»ºè®®åäºè§£ä¸ä¸ ç¼å­åºæ¬åçï¼æå©äºçè§£ç¼å­çç¹æ§ãåçï¼ä½¿ç¨ç¼å­å¸¸è§çé®é¢åè§£å³æ¹æ¡ã\n\n * ç¼å­é¢è¯é¢\n * Java ç¼å­æ¡æ¶\n * Memcached å¿«éå¥é¨\n * Ehcache å¿«éå¥é¨\n * Java è¿ç¨åç¼å­\n * Http ç¼å­\n\n# æµéæ§å¶\n\n * Hystrix\n\n\n# ð èµæ\n\n * Mybatis\n   * Mybatis Github\n   * Mybatis å®ç½\n   * MyBatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * MyBatis å®æ¹éæ Springï¼mybatis-springï¼\n   * Mybatis å®æ¹éæ Spring Bootï¼mybatis-spring-bootï¼\n   * MyBatis-Plus - CRUD æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * Mapper - CRUD æ©å±æä»¶\n   * Mybatis-PageHelper - Mybatis éç¨åé¡µæä»¶\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# java ä¸­é´ä»¶\n\n\n# ð åå®¹\n\n# æ¶æ¯éå\n\n> æ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åå¸å¼åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ åç§æ¶æ¯éåäº§åï¼å»ºè®®åäºè§£ä¸ä¸ æ¶æ¯éååºæ¬åç ï¼æå©äºçè§£æ¶æ¯éåç¹æ§çå®ç°åè®¾è®¡æè·¯ã\n\n * æ¶æ¯éåé¢è¯\n * æ¶æ¯éååºæ¬åç\n * rocketmq\n * activemq\n\n# ç¼å­\n\n> ç¼å­å¯ä»¥è¯´æ¯ä¼åç³»ç»æ§è½çç¬¬ä¸ææ®µï¼å¨åç§ææ¯ä¸­é½ä¼æç¼å­çåºç¨ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ ç¼å­ï¼å»ºè®®åäºè§£ä¸ä¸ ç¼å­åºæ¬åçï¼æå©äºçè§£ç¼å­çç¹æ§ãåçï¼ä½¿ç¨ç¼å­å¸¸è§çé®é¢åè§£å³æ¹æ¡ã\n\n * ç¼å­é¢è¯é¢\n * java ç¼å­æ¡æ¶\n * memcached å¿«éå¥é¨\n * ehcache å¿«éå¥é¨\n * java è¿ç¨åç¼å­\n * http ç¼å­\n\n# æµéæ§å¶\n\n * hystrix\n\n\n# ð èµæ\n\n * mybatis\n   * mybatis github\n   * mybatis å®ç½\n   * mybatis å®æ¹ä»£ç çæï¼mybatis-generatorï¼\n   * mybatis å®æ¹éæ springï¼mybatis-springï¼\n   * mybatis å®æ¹éæ spring bootï¼mybatis-spring-bootï¼\n   * mybatis-plus - crud æ©å±æä»¶ãä»£ç çæå¨ãåé¡µå¨ç­å¤åè½\n   * mapper - crud æ©å±æä»¶\n   * mybatis-pagehelper - mybatis éç¨åé¡µæä»¶\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"å½æ¡£",frontmatter:{archivesPage:!0,title:"å½æ¡£",permalink:"/archives/",article:!1},regularPath:"/@pages/archivesPage.html",relativePath:"@pages/archivesPage.md",key:"v-04cda89e",path:"/archives/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"åç±»",frontmatter:{categoriesPage:!0,title:"åç±»",permalink:"/categories/",article:!1},regularPath:"/@pages/categoriesPage.html",relativePath:"@pages/categoriesPage.md",key:"v-5d493111",path:"/categories/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"æ ç­¾",frontmatter:{tagsPage:!0,title:"æ ç­¾",permalink:"/tags/",article:!1},regularPath:"/@pages/tagsPage.html",relativePath:"@pages/tagsPage.md",key:"v-26877d31",path:"/tags/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3},{title:"Home",frontmatter:{home:!0,heroImage:"img/bg.gif",heroText:"JAVA-TUTORIAL",tagline:"â java-tutorial æ¯ä¸ä¸ª Java æç¨ï¼æ±éä¸ä¸ªèå¸æºå¨ Java é¢åçåå¹´ç§¯ç´¯ã",bannerBg:"none",postList:"none",footer:"CC-BY-SA-4.0 Licensed | Copyright Â© 2018-Now Dunwu"},regularPath:"/",relativePath:"README.md",key:"v-10d1fe8a",path:"/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:221},{level:3,title:"JavaSE",slug:"javase",normalizedTitle:"javase",charIndex:231},{level:3,title:"JavaEE",slug:"javaee",normalizedTitle:"javaee",charIndex:321},{level:4,title:"JavaWeb",slug:"javaweb",normalizedTitle:"javaweb",charIndex:331},{level:4,title:"Java æå¡å¨",slug:"java-æå¡å¨",normalizedTitle:"java æå¡å¨",charIndex:462},{level:3,title:"Java è½¯ä»¶",slug:"java-è½¯ä»¶",normalizedTitle:"java è½¯ä»¶",charIndex:633},{level:4,title:"Java æå»º",slug:"java-æå»º",normalizedTitle:"java æå»º",charIndex:644},{level:4,title:"Java IDE",slug:"java-ide",normalizedTitle:"java ide",charIndex:1054},{level:4,title:"Java çæ§è¯æ­",slug:"java-çæ§è¯æ­",normalizedTitle:"java çæ§è¯æ­",charIndex:1339},{level:3,title:"Java å·¥å·",slug:"java-å·¥å·",normalizedTitle:"java å·¥å·",charIndex:1478},{level:4,title:"Java IO",slug:"java-io",normalizedTitle:"java io",charIndex:306},{level:4,title:"JavaBean å·¥å·",slug:"javabean-å·¥å·",normalizedTitle:"javabean å·¥å·",charIndex:1582},{level:4,title:"Java æ¨¡æ¿å¼æ",slug:"java-æ¨¡æ¿å¼æ",normalizedTitle:"java æ¨¡æ¿å¼æ",charIndex:1617},{level:4,title:"Java æµè¯å·¥å·",slug:"java-æµè¯å·¥å·",normalizedTitle:"java æµè¯å·¥å·",charIndex:1668},{level:4,title:"å¶ä»",slug:"å¶ä»",normalizedTitle:"å¶ä»",charIndex:1719},{level:3,title:"Java æ¡æ¶",slug:"java-æ¡æ¶",normalizedTitle:"java æ¡æ¶",charIndex:1812},{level:4,title:"ORM",slug:"orm",normalizedTitle:"orm",charIndex:1823},{level:4,title:"Spring",slug:"spring",normalizedTitle:"spring",charIndex:1861},{level:4,title:"Spring Boot",slug:"spring-boot",normalizedTitle:"spring boot",charIndex:1908},{level:4,title:"å®å¨",slug:"å®å¨",normalizedTitle:"å®å¨",charIndex:1964},{level:4,title:"IO",slug:"io",normalizedTitle:"io",charIndex:311},{level:4,title:"å¾®æå¡",slug:"å¾®æå¡",normalizedTitle:"å¾®æå¡",charIndex:2215},{level:3,title:"Java ä¸­é´ä»¶",slug:"java-ä¸­é´ä»¶",normalizedTitle:"java ä¸­é´ä»¶",charIndex:2233},{level:4,title:"MQ",slug:"mq",normalizedTitle:"mq",charIndex:2245},{level:4,title:"ç¼å­",slug:"ç¼å­",normalizedTitle:"ç¼å­",charIndex:2477},{level:4,title:"æµéæ§å¶",slug:"æµéæ§å¶",normalizedTitle:"æµéæ§å¶",charIndex:2663},{level:3,title:"å¤§æ°æ®",slug:"å¤§æ°æ®",normalizedTitle:"å¤§æ°æ®",charIndex:2684},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:2834},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:3756}],headersStr:"ð åå®¹ JavaSE JavaEE JavaWeb Java æå¡å¨ Java è½¯ä»¶ Java æå»º Java IDE Java çæ§è¯æ­ Java å·¥å· Java IO JavaBean å·¥å· Java æ¨¡æ¿å¼æ Java æµè¯å·¥å· å¶ä» Java æ¡æ¶ ORM Spring Spring Boot å®å¨ IO å¾®æå¡ Java ä¸­é´ä»¶ MQ ç¼å­ æµéæ§å¶ å¤§æ°æ® ð èµæ ðª ä¼ é",content:"> â java-tutorial æ¯ä¸ä¸ª Java æç¨ï¼æ±éä¸ä¸ªèå¸æºå¨ Java é¢åçåå¹´ç§¯ç´¯ã\n> \n>  * ð é¡¹ç®åæ­¥ç»´æ¤ï¼Github | Gitee\n>  * ð çµå­ä¹¦éè¯»ï¼Github Pages | Gitee Pages\n> \n> è¯´æï¼\n> \n>  * ä¸é¢çåå®¹æ¸åä¸­ï¼å¡æ¯æ ð æ è®°çææ¯ï¼é½å·²æ´çæè¯¦ç»çæç¨ã\n>  * é¨åææ¯å ä¸ºå¯ä»¥åºç¨äºä¸åé¢åï¼æä»¥å¯è½ä¼åæ¶åºç°å¨ä¸åçç±»å«ä¸ã\n\n\n# ð åå®¹\n\n\n# JavaSE\n\n> ð javacore æ¯ä¸ä¸ª Java æ ¸å¿ææ¯æç¨ãåå®¹åå«ï¼Java åºç¡ç¹æ§ãJava é«çº§ç¹æ§ãJava å¹¶åãJVMãJava IO ç­ã\n\n\n# JavaEE\n\n# JavaWeb\n\n * JavaWeb é¢ç»\n * JavaWeb ä¹ Servlet æå\n * JavaWeb ä¹ Jsp æå\n * JavaWeb ä¹ Filter å Listener\n * JavaWeb ä¹ Cookie å Session\n\n# Java æå¡å¨\n\n> Tomcat å Jetty é½æ¯ Java æ¯è¾æµè¡çè½»éçº§æå¡å¨ã\n> \n> Nginx æ¯ç®åææµè¡çååä»£çæå¡å¨ï¼ä¹å¸¸ç¨äºè´è½½åè¡¡ã\n\n * Tomcat å¿«éå¥é¨\n * Tomcat è¿æ¥å¨\n * Tomcat å®¹å¨\n * Tomcat ä¼å\n * Tomcat å Jetty\n * Jetty\n\n\n# Java è½¯ä»¶\n\n# Java æå»º\n\n> Java é¡¹ç®éè¦éè¿ æå»ºå·¥å· æ¥ç®¡çé¡¹ç®ä¾èµï¼å®æç¼è¯ãæåãåå¸ãçæ JavaDoc ç­ä»»å¡ã\n> \n>  * ç®åæä¸»æµçæå»ºå·¥å·æ¯ Mavenï¼å®çåè½éå¸¸å¼ºå¤§ã\n>  * Gradle å·ç§°æ¯è¦æ¿ä»£ Maven ç­æä»¶å·¥å·ï¼å®ççæ¬ç®¡çç¡®å®ç®æ´ï¼ä½æ¯éè¦å­¦ä¹  Groovyï¼å­¦ä¹ ææ¬æ¯ Maven é«ã\n>  * Ant åè½æ¯ Maven å Gradle è¦å¼±ï¼ç°ä»£ Java é¡¹ç®åºæ¬ä¸ç¨äºï¼ä½ä¹æä¸äºä¼ ç»ç Java é¡¹ç®è¿å¨ä½¿ç¨ã\n\n * Maven ð\n   * Maven å¿«éå¥é¨\n   * Maven æç¨ä¹ pom.xml è¯¦è§£\n   * Maven æç¨ä¹ settings.xml è¯¦è§£\n   * Maven å®æé®é¢åæä½³å®è·µ\n   * Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n   * Maven æä»¶ä¹ä»£ç æ£æ¥\n * Ant ç®ææç¨\n\n# Java IDE\n\n> èªä»æäº IDEï¼åä»£ç ä»æ­¤å°±åå«äºåèç«ç§çè®èæ¶ä»£ã\n> \n>  * Eclipse æ¯ä¹è´çåçå¼æº Java IDEï¼æçå­¦çæ¶ä»£ä¸ç´ä½¿ç¨å®å Javaã\n>  * æ¾ç»ææä»è½¬ Intellij Idea ï¼ä½åæ¥åç°çé¦ï¼ä¸å¾ä¸è¯´ï¼ç¡®å®æ¯ç®åæä¼ç§ç Java IDEã\n>  * ä½ å¯ä»¥å¨ vscode ä¸­ååç§è¯­è¨ï¼åªè¦å®è£ç¸åºæä»¶å³å¯ãå¦æä½ çé¡¹ç®ä¸­ä½¿ç¨äºå¾å¤ç§ç¼ç¨è¯­è¨ï¼åæå¾å¨å¤ä¸ª IDE ä¹é´åæ¢ï¼é£ä¹å°±ç¨ vscode æ¥ä¸ç½æå°½å§ã\n\n * Intellij Idea\n * Eclipse\n * vscode\n\n# Java çæ§è¯æ­\n\n> çæ§/è¯æ­ å·¥å·ä¸»è¦ç¨äº Java åºç¨çè¿ç»´ãéè¿ééãåæãå­å¨ãå¯è§ååºç¨çæææ°æ®ï¼å¸®å©å¼åèãä½¿ç¨èå¿«éå®ä½é®é¢ï¼æ¾å°æ§è½ç¶é¢ã\n\n * çæ§å·¥å·å¯¹æ¯\n * CAT\n * Zipkin\n * SkyWalking\n * Arthas\n\n\n# Java å·¥å·\n\n# Java IO\n\n * JSON åºåå - fastjsonãJacksonãGson\n * äºè¿å¶åºåå - ProtobufãThriftãHessianãKryoãFST\n\n# JavaBean å·¥å·\n\n * Lombok\n * Dozer\n\n# Java æ¨¡æ¿å¼æ\n\n * Freemark\n * Velocity\n * Thymeleaf\n\n# Java æµè¯å·¥å·\n\n * Junit\n * Mockito\n * Jmeter\n * JMH\n\n# å¶ä»\n\n * Java æ¥å¿\n * Java å·¥å·å\n * Reflections\n * JavaMail\n * Jsoup\n * Thumbnailator\n * Zxing\n\n\n# Java æ¡æ¶\n\n# ORM\n\n * Mybatis å¿«éå¥é¨\n * Mybatis åç\n\n# Spring\n\nð spring-tutorial æ¯ä¸ä¸ª Spring å®ææç¨ã\n\n# Spring Boot\n\nð Spring Boot æç¨ æ¯ä¸ä¸ª Spring Boot å®ææç¨ã\n\n# å®å¨\n\n> Java é¢åæ¯è¾æµè¡çå®å¨æ¡æ¶å°±æ¯ shiro å spring-securityã\n> \n> shiro æ´ä¸ºç®åãè½»ä¾¿ï¼å®¹æçè§£ï¼è½æ»¡è¶³å¤§å¤æ°åºæ¬å®å¨åºæ¯ä¸çéè¦ã\n> \n> spring-security åè½æ´ä¸°å¯ï¼ä¹æ¯ shiro æ´å¤æãå¼å¾ä¸æçæ¯ç±äº spring-security æ¯ spring å¢éå¼åï¼æä»¥éæ spring å spring-boot æ¡æ¶æ´å®¹æã\n\n * Shiro\n * SpringSecurity\n\n# IO\n\n * Shiro\n\n# å¾®æå¡\n\n * Dubbo\n\n\n# Java ä¸­é´ä»¶\n\n# MQ\n\n> æ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åå¸å¼åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ åç§æ¶æ¯éåäº§åï¼å»ºè®®åäºè§£ä¸ä¸ æ¶æ¯éååºæ¬åç ï¼æå©äºçè§£æ¶æ¯éåç¹æ§çå®ç°åè®¾è®¡æè·¯ã\n\n * æ¶æ¯éåé¢è¯\n * æ¶æ¯éååºæ¬åç\n * RocketMQ\n * ActiveMQ\n\n# ç¼å­\n\n> ç¼å­å¯ä»¥è¯´æ¯ä¼åç³»ç»æ§è½çç¬¬ä¸ææ®µï¼å¨åç§ææ¯ä¸­é½ä¼æç¼å­çåºç¨ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ ç¼å­ï¼å»ºè®®åäºè§£ä¸ä¸ ç¼å­åºæ¬åçï¼æå©äºçè§£ç¼å­çç¹æ§ãåçï¼ä½¿ç¨ç¼å­å¸¸è§çé®é¢åè§£å³æ¹æ¡ã\n\n * ç¼å­é¢è¯é¢\n * Java ç¼å­ä¸­é´ä»¶\n * Memcached å¿«éå¥é¨\n * Ehcache å¿«éå¥é¨\n * Java è¿ç¨åç¼å­\n * Http ç¼å­\n\n# æµéæ§å¶\n\n * Hystrix\n\n\n# å¤§æ°æ®\n\n> å¤§æ°æ®ææ¯ç¹ä»¥å½æ¡£å¨ï¼bigdata-tutorial\n\n * Hdfs ð\n * Hbase ð\n * Hive ð\n * MapReduce\n * Yarn\n * ZooKeeper ð\n * Kafka ð\n * Spark\n * Storm\n * Flink\n\n\n# ð èµæ\n\n * Java ç»å¸ä¹¦ç±\n   * ãEffective Java ä¸­æçã - æ¬ä¹¦ä»ç»äºå¨ Java ç¼ç¨ä¸­ 78 æ¡æå·å®ç¨ä»·å¼çç»éªè§åï¼è¿äºç»éªè§åæ¶µçäºå¤§å¤æ°å¼åäººåæ¯å¤©æé¢ä¸´çé®é¢çè§£å³æ¹æ¡ãåæ¨èãéæ : æ¹åæ¢æä»£ç çè®¾è®¡ãããä»£ç æ´æ´ä¹éãããä»£ç å¤§å¨ãï¼æä¸å®çåå®¹éå ã\n   * ãJava å¹¶åç¼ç¨å®æã - æ¬ä¹¦æ·±å¥æµåºå°ä»ç»äº Java çº¿ç¨åå¹¶åï¼æ¯ä¸æ¬å®ç¾ç Java å¹¶ååèæåã\n   * ãæ·±å¥çè§£ Java èææºã - ä¸å»äºè§£ JVM çå·¥ç¨å¸ï¼åå¸é±¼æä»ä¹åº\n   * ãMaven å®æã - å½åææå¨ç Maven ä¸å®¶çåä½ï¼å¯ä¸ä¸æ¬å¦ï¼\n * å¶ä»é¢åä¹¦ç±\n   * ãRedis è®¾è®¡ä¸å®ç°ã - ç³»ç»èå¨é¢å°æè¿°äº Redis åé¨è¿è¡æºå¶ãå¾ç¤ºä¸°å¯ï¼æè¿°æ¸æ°ï¼å¹¶ç»åºå¤§éåèä¿¡æ¯ï¼æ¯ NoSQL æ°æ®åºå¼åäººåæ¡å¤´å¿å¤ã\n   * ãé¸å¥ç Linux ç§æ¿è ï¼åºç¡å­¦ä¹ ç¯ï¼ã - æ¬ä¹¦æ¯æå·ç¥ååº¦ç Linux å¥é¨ä¹¦ãé¸å¥ç Linux ç§æ¿èåºç¡å­¦ä¹ ç¯ãçææ°çï¼å¨é¢èè¯¦ç»å°ä»ç»äº Linux æä½ç³»ç»ãåå®¹éå¸¸å¨é¢ï¼å»ºè®®æéåèªå·±å®éå·¥ä½ç¸å³åº¦è¾é«çï¼å¶ä»é¨åæéè¦åéè¯»ã\n   * ãHead First è®¾è®¡æ¨¡å¼ã - ãHead First è®¾è®¡æ¨¡å¼ã(ä¸­æç)å±æ 14 ç« ï¼æ¯ç« é½ä»ç»äºå ä¸ªè®¾è®¡æ¨¡å¼ï¼å®æ´å°æ¶µçäºåäººç»çæ¬å¨é¨ 23 ä¸ªè®¾è®¡æ¨¡å¼ã\n   * ãHTTP æå¨æåã - æ¬ä¹¦å°è¯çå° HTTP ä¸­ä¸äºäºç¸å³èä¸å¸¸è¢«è¯¯è§£çè§åæ¢³çæ¸æ¥ï¼å¹¶ç¼åäºä¸ç³»ååºäºåç§ä¸»é¢çç« èï¼å¯¹ HTTP åæ¹é¢çç¹æ§è¿è¡äºä»ç»ãçºµè§å¨ä¹¦ï¼å¯¹ HTTPâä¸ºä»ä¹âè¿æ ·åè¿è¡äºè¯¦ç»çè§£éï¼èä¸ä»ä»åçå¨å®æ¯âæä¹åâçã\n   * ãTCP/IP è¯¦è§£ ç³»åã - å®æ´èè¯¦ç»ç TCP/IP åè®®æåãéå¯¹ä»»ä½å¸æçè§£ TCP/IP åè®®æ¯å¦ä½å®ç°çè¯»èè®¾è®¡ã\n   * ãåæ Offerï¼åä¼é¢è¯å®ç²¾è®²å¸åç¼ç¨é¢ã - åæäº 80 ä¸ªå¸åçç¼ç¨é¢è¯é¢ï¼ç³»ç»æ´çåºç¡ç¥è¯ãä»£ç è´¨éãè§£é¢æè·¯ãä¼åæçåç»¼åè½åè¿ 5 ä¸ªé¢è¯è¦ç¹ã\n\n\n# ðª ä¼ é\n\nâ¾ ð  JAVA-TUTORIAL é¦é¡µ â¾ ð¯ æçåå®¢ â¾\n\n> ä½ å¯è½ä¼æå´è¶£ï¼\n\n * Java æç¨ ð\n * JavaCore æç¨ ð\n * Spring æç¨ ð\n * Spring Boot æç¨ ð\n * æ°æ®åºæç¨ ð\n * æ°æ®ç»æåç®æ³æç¨ ð\n * Linux æç¨ ð\n * Nginx æç¨ ð",normalizedContent:"> â java-tutorial æ¯ä¸ä¸ª java æç¨ï¼æ±éä¸ä¸ªèå¸æºå¨ java é¢åçåå¹´ç§¯ç´¯ã\n> \n>  * ð é¡¹ç®åæ­¥ç»´æ¤ï¼github | gitee\n>  * ð çµå­ä¹¦éè¯»ï¼github pages | gitee pages\n> \n> è¯´æï¼\n> \n>  * ä¸é¢çåå®¹æ¸åä¸­ï¼å¡æ¯æ ð æ è®°çææ¯ï¼é½å·²æ´çæè¯¦ç»çæç¨ã\n>  * é¨åææ¯å ä¸ºå¯ä»¥åºç¨äºä¸åé¢åï¼æä»¥å¯è½ä¼åæ¶åºç°å¨ä¸åçç±»å«ä¸ã\n\n\n# ð åå®¹\n\n\n# javase\n\n> ð javacore æ¯ä¸ä¸ª java æ ¸å¿ææ¯æç¨ãåå®¹åå«ï¼java åºç¡ç¹æ§ãjava é«çº§ç¹æ§ãjava å¹¶åãjvmãjava io ç­ã\n\n\n# javaee\n\n# javaweb\n\n * javaweb é¢ç»\n * javaweb ä¹ servlet æå\n * javaweb ä¹ jsp æå\n * javaweb ä¹ filter å listener\n * javaweb ä¹ cookie å session\n\n# java æå¡å¨\n\n> tomcat å jetty é½æ¯ java æ¯è¾æµè¡çè½»éçº§æå¡å¨ã\n> \n> nginx æ¯ç®åææµè¡çååä»£çæå¡å¨ï¼ä¹å¸¸ç¨äºè´è½½åè¡¡ã\n\n * tomcat å¿«éå¥é¨\n * tomcat è¿æ¥å¨\n * tomcat å®¹å¨\n * tomcat ä¼å\n * tomcat å jetty\n * jetty\n\n\n# java è½¯ä»¶\n\n# java æå»º\n\n> java é¡¹ç®éè¦éè¿ æå»ºå·¥å· æ¥ç®¡çé¡¹ç®ä¾èµï¼å®æç¼è¯ãæåãåå¸ãçæ javadoc ç­ä»»å¡ã\n> \n>  * ç®åæä¸»æµçæå»ºå·¥å·æ¯ mavenï¼å®çåè½éå¸¸å¼ºå¤§ã\n>  * gradle å·ç§°æ¯è¦æ¿ä»£ maven ç­æä»¶å·¥å·ï¼å®ççæ¬ç®¡çç¡®å®ç®æ´ï¼ä½æ¯éè¦å­¦ä¹  groovyï¼å­¦ä¹ ææ¬æ¯ maven é«ã\n>  * ant åè½æ¯ maven å gradle è¦å¼±ï¼ç°ä»£ java é¡¹ç®åºæ¬ä¸ç¨äºï¼ä½ä¹æä¸äºä¼ ç»ç java é¡¹ç®è¿å¨ä½¿ç¨ã\n\n * maven ð\n   * maven å¿«éå¥é¨\n   * maven æç¨ä¹ pom.xml è¯¦è§£\n   * maven æç¨ä¹ settings.xml è¯¦è§£\n   * maven å®æé®é¢åæä½³å®è·µ\n   * maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº\n   * maven æä»¶ä¹ä»£ç æ£æ¥\n * ant ç®ææç¨\n\n# java ide\n\n> èªä»æäº ideï¼åä»£ç ä»æ­¤å°±åå«äºåèç«ç§çè®èæ¶ä»£ã\n> \n>  * eclipse æ¯ä¹è´çåçå¼æº java ideï¼æçå­¦çæ¶ä»£ä¸ç´ä½¿ç¨å®å javaã\n>  * æ¾ç»ææä»è½¬ intellij idea ï¼ä½åæ¥åç°çé¦ï¼ä¸å¾ä¸è¯´ï¼ç¡®å®æ¯ç®åæä¼ç§ç java ideã\n>  * ä½ å¯ä»¥å¨ vscode ä¸­ååç§è¯­è¨ï¼åªè¦å®è£ç¸åºæä»¶å³å¯ãå¦æä½ çé¡¹ç®ä¸­ä½¿ç¨äºå¾å¤ç§ç¼ç¨è¯­è¨ï¼åæå¾å¨å¤ä¸ª ide ä¹é´åæ¢ï¼é£ä¹å°±ç¨ vscode æ¥ä¸ç½æå°½å§ã\n\n * intellij idea\n * eclipse\n * vscode\n\n# java çæ§è¯æ­\n\n> çæ§/è¯æ­ å·¥å·ä¸»è¦ç¨äº java åºç¨çè¿ç»´ãéè¿ééãåæãå­å¨ãå¯è§ååºç¨çæææ°æ®ï¼å¸®å©å¼åèãä½¿ç¨èå¿«éå®ä½é®é¢ï¼æ¾å°æ§è½ç¶é¢ã\n\n * çæ§å·¥å·å¯¹æ¯\n * cat\n * zipkin\n * skywalking\n * arthas\n\n\n# java å·¥å·\n\n# java io\n\n * json åºåå - fastjsonãjacksonãgson\n * äºè¿å¶åºåå - protobufãthriftãhessianãkryoãfst\n\n# javabean å·¥å·\n\n * lombok\n * dozer\n\n# java æ¨¡æ¿å¼æ\n\n * freemark\n * velocity\n * thymeleaf\n\n# java æµè¯å·¥å·\n\n * junit\n * mockito\n * jmeter\n * jmh\n\n# å¶ä»\n\n * java æ¥å¿\n * java å·¥å·å\n * reflections\n * javamail\n * jsoup\n * thumbnailator\n * zxing\n\n\n# java æ¡æ¶\n\n# orm\n\n * mybatis å¿«éå¥é¨\n * mybatis åç\n\n# spring\n\nð spring-tutorial æ¯ä¸ä¸ª spring å®ææç¨ã\n\n# spring boot\n\nð spring boot æç¨ æ¯ä¸ä¸ª spring boot å®ææç¨ã\n\n# å®å¨\n\n> java é¢åæ¯è¾æµè¡çå®å¨æ¡æ¶å°±æ¯ shiro å spring-securityã\n> \n> shiro æ´ä¸ºç®åãè½»ä¾¿ï¼å®¹æçè§£ï¼è½æ»¡è¶³å¤§å¤æ°åºæ¬å®å¨åºæ¯ä¸çéè¦ã\n> \n> spring-security åè½æ´ä¸°å¯ï¼ä¹æ¯ shiro æ´å¤æãå¼å¾ä¸æçæ¯ç±äº spring-security æ¯ spring å¢éå¼åï¼æä»¥éæ spring å spring-boot æ¡æ¶æ´å®¹æã\n\n * shiro\n * springsecurity\n\n# io\n\n * shiro\n\n# å¾®æå¡\n\n * dubbo\n\n\n# java ä¸­é´ä»¶\n\n# mq\n\n> æ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åå¸å¼åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ åç§æ¶æ¯éåäº§åï¼å»ºè®®åäºè§£ä¸ä¸ æ¶æ¯éååºæ¬åç ï¼æå©äºçè§£æ¶æ¯éåç¹æ§çå®ç°åè®¾è®¡æè·¯ã\n\n * æ¶æ¯éåé¢è¯\n * æ¶æ¯éååºæ¬åç\n * rocketmq\n * activemq\n\n# ç¼å­\n\n> ç¼å­å¯ä»¥è¯´æ¯ä¼åç³»ç»æ§è½çç¬¬ä¸ææ®µï¼å¨åç§ææ¯ä¸­é½ä¼æç¼å­çåºç¨ã\n> \n> å¦ææ³æ·±å¥å­¦ä¹ ç¼å­ï¼å»ºè®®åäºè§£ä¸ä¸ ç¼å­åºæ¬åçï¼æå©äºçè§£ç¼å­çç¹æ§ãåçï¼ä½¿ç¨ç¼å­å¸¸è§çé®é¢åè§£å³æ¹æ¡ã\n\n * ç¼å­é¢è¯é¢\n * java ç¼å­ä¸­é´ä»¶\n * memcached å¿«éå¥é¨\n * ehcache å¿«éå¥é¨\n * java è¿ç¨åç¼å­\n * http ç¼å­\n\n# æµéæ§å¶\n\n * hystrix\n\n\n# å¤§æ°æ®\n\n> å¤§æ°æ®ææ¯ç¹ä»¥å½æ¡£å¨ï¼bigdata-tutorial\n\n * hdfs ð\n * hbase ð\n * hive ð\n * mapreduce\n * yarn\n * zookeeper ð\n * kafka ð\n * spark\n * storm\n * flink\n\n\n# ð èµæ\n\n * java ç»å¸ä¹¦ç±\n   * ãeffective java ä¸­æçã - æ¬ä¹¦ä»ç»äºå¨ java ç¼ç¨ä¸­ 78 æ¡æå·å®ç¨ä»·å¼çç»éªè§åï¼è¿äºç»éªè§åæ¶µçäºå¤§å¤æ°å¼åäººåæ¯å¤©æé¢ä¸´çé®é¢çè§£å³æ¹æ¡ãåæ¨èãéæ : æ¹åæ¢æä»£ç çè®¾è®¡ãããä»£ç æ´æ´ä¹éãããä»£ç å¤§å¨ãï¼æä¸å®çåå®¹éå ã\n   * ãjava å¹¶åç¼ç¨å®æã - æ¬ä¹¦æ·±å¥æµåºå°ä»ç»äº java çº¿ç¨åå¹¶åï¼æ¯ä¸æ¬å®ç¾ç java å¹¶ååèæåã\n   * ãæ·±å¥çè§£ java èææºã - ä¸å»äºè§£ jvm çå·¥ç¨å¸ï¼åå¸é±¼æä»ä¹åº\n   * ãmaven å®æã - å½åææå¨ç maven ä¸å®¶çåä½ï¼å¯ä¸ä¸æ¬å¦ï¼\n * å¶ä»é¢åä¹¦ç±\n   * ãredis è®¾è®¡ä¸å®ç°ã - ç³»ç»èå¨é¢å°æè¿°äº redis åé¨è¿è¡æºå¶ãå¾ç¤ºä¸°å¯ï¼æè¿°æ¸æ°ï¼å¹¶ç»åºå¤§éåèä¿¡æ¯ï¼æ¯ nosql æ°æ®åºå¼åäººåæ¡å¤´å¿å¤ã\n   * ãé¸å¥ç linux ç§æ¿è ï¼åºç¡å­¦ä¹ ç¯ï¼ã - æ¬ä¹¦æ¯æå·ç¥ååº¦ç linux å¥é¨ä¹¦ãé¸å¥ç linux ç§æ¿èåºç¡å­¦ä¹ ç¯ãçææ°çï¼å¨é¢èè¯¦ç»å°ä»ç»äº linux æä½ç³»ç»ãåå®¹éå¸¸å¨é¢ï¼å»ºè®®æéåèªå·±å®éå·¥ä½ç¸å³åº¦è¾é«çï¼å¶ä»é¨åæéè¦åéè¯»ã\n   * ãhead first è®¾è®¡æ¨¡å¼ã - ãhead first è®¾è®¡æ¨¡å¼ã(ä¸­æç)å±æ 14 ç« ï¼æ¯ç« é½ä»ç»äºå ä¸ªè®¾è®¡æ¨¡å¼ï¼å®æ´å°æ¶µçäºåäººç»çæ¬å¨é¨ 23 ä¸ªè®¾è®¡æ¨¡å¼ã\n   * ãhttp æå¨æåã - æ¬ä¹¦å°è¯çå° http ä¸­ä¸äºäºç¸å³èä¸å¸¸è¢«è¯¯è§£çè§åæ¢³çæ¸æ¥ï¼å¹¶ç¼åäºä¸ç³»ååºäºåç§ä¸»é¢çç« èï¼å¯¹ http åæ¹é¢çç¹æ§è¿è¡äºä»ç»ãçºµè§å¨ä¹¦ï¼å¯¹ httpâä¸ºä»ä¹âè¿æ ·åè¿è¡äºè¯¦ç»çè§£éï¼èä¸ä»ä»åçå¨å®æ¯âæä¹åâçã\n   * ãtcp/ip è¯¦è§£ ç³»åã - å®æ´èè¯¦ç»ç tcp/ip åè®®æåãéå¯¹ä»»ä½å¸æçè§£ tcp/ip åè®®æ¯å¦ä½å®ç°çè¯»èè®¾è®¡ã\n   * ãåæ offerï¼åä¼é¢è¯å®ç²¾è®²å¸åç¼ç¨é¢ã - åæäº 80 ä¸ªå¸åçç¼ç¨é¢è¯é¢ï¼ç³»ç»æ´çåºç¡ç¥è¯ãä»£ç è´¨éãè§£é¢æè·¯ãä¼åæçåç»¼åè½åè¿ 5 ä¸ªé¢è¯è¦ç¹ã\n\n\n# ðª ä¼ é\n\nâ¾ ð  java-tutorial é¦é¡µ â¾ ð¯ æçåå®¢ â¾\n\n> ä½ å¯è½ä¼æå´è¶£ï¼\n\n * java æç¨ ð\n * javacore æç¨ ð\n * spring æç¨ ð\n * spring boot æç¨ ð\n * æ°æ®åºæç¨ ð\n * æ°æ®ç»æåç®æ³æç¨ ð\n * linux æç¨ ð\n * nginx æç¨ ð",charsets:{cjk:!0},lastUpdated:"2022/07/08, 19:00:16",lastUpdatedTimestamp:1657278016e3}],themeConfig:{nav:[{text:"JavaEE",items:[{text:"JavaWeb",link:"/02.JavaEE/01.JavaWeb/"},{text:"æå¡å¨",link:"/02.JavaEE/02.æå¡å¨/"}]},{text:"Javaè½¯ä»¶",link:"/11.è½¯ä»¶/",items:[{text:"Javaæå»º",link:"/11.è½¯ä»¶/01.æå»º/"},{text:"Java IDE",link:"/11.è½¯ä»¶/02.IDE/"},{text:"Javaçæ§è¯æ­",link:"/11.è½¯ä»¶/03.çæ§è¯æ­/"}]},{text:"Javaå·¥å·",link:"/12.å·¥å·/"},{text:"Javaæ¡æ¶",link:"/13.æ¡æ¶/"},{text:"Javaä¸­é´ä»¶",link:"/14.ä¸­é´ä»¶/"},{text:"â¨ Javaç³»å",ariaLabel:"Java",items:[{text:"Java æç¨ ð",link:"https://dunwu.github.io/java-tutorial/",target:"_blank"},{text:"JavaCore æç¨ ð",link:"https://dunwu.github.io/javacore/",target:"_blank"}]}],sidebarDepth:2,logo:"https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo.png",repo:"dunwu/java-tutorial",searchMaxSuggestions:10,lastUpdated:"ä¸æ¬¡æ´æ°",docsDir:"docs",editLinks:!0,editLinkText:"ð å¸®å©æ¹åæ­¤é¡µé¢ï¼",sidebar:{"/02.JavaEE/":[{title:"JavaWeb",collapsable:!1,children:[["01.JavaWeb/01.JavaWebä¹Servletæå.md","JavaWeb ä¹ Servlet æå","/pages/be093b/"],["01.JavaWeb/02.JavaWebä¹Jspæå.md","JavaWeb ä¹ Jsp æå","/pages/6bbb16/"],["01.JavaWeb/03.JavaWebä¹FilteråListener.md","JavaWeb ä¹ Filter å Listener","/pages/5ecb29/"],["01.JavaWeb/04.JavaWebä¹CookieåSession.md","JavaWeb ä¹ Cookie å Session","/pages/e61883/"],["01.JavaWeb/99.JavaWebé¢ç».md","JavaWeb é¢ç»","/pages/1933b3/"]]},{title:"æå¡å¨",collapsable:!1,children:[{title:"Tomcat",collapsable:!1,children:[["02.æå¡å¨/01.Tomcat/01.Tomcatå¿«éå¥é¨.md","Tomcat å¿«éå¥é¨","/pages/c50d2b/"],["02.æå¡å¨/01.Tomcat/02.Tomcatè¿æ¥å¨.md","Tomcatè¿æ¥å¨","/pages/3c954b/"],["02.æå¡å¨/01.Tomcat/03.Tomcatå®¹å¨.md","Tomcatå®¹å¨","/pages/2fea08/"],["02.æå¡å¨/01.Tomcat/04.Tomcatä¼å.md","Tomcatä¼å","/pages/6c22f4/"],["02.æå¡å¨/01.Tomcat/05.TomcatåJetty.md","Tomcat å Jetty","/pages/f1bba6/"]]},["02.æå¡å¨/02.Jetty.md","Jetty å¿«éå¥é¨","/pages/9ecdc1/"]]}],catalogue:{},"/11.è½¯ä»¶/":[{title:"æå»º",collapsable:!1,children:[{title:"Maven",collapsable:!1,children:[["01.æå»º/01.Maven/01.Mavenå¿«éå¥é¨.md","Maven å¿«éå¥é¨","/pages/6b8149/"],["01.æå»º/01.Maven/02.Mavenæç¨ä¹pom.xmlè¯¦è§£.md","Maven æç¨ä¹ pom.xml è¯¦è§£","/pages/f594fa/"],["01.æå»º/01.Maven/03.Mavenæç¨ä¹settings.xmlè¯¦è§£.md","Maven æç¨ä¹ settings.xml è¯¦è§£","/pages/d05c38/"],["01.æå»º/01.Maven/04.Mavenå®æé®é¢åæä½³å®è·µ.md","Maven å®æé®é¢åæä½³å®è·µ","/pages/7908f2/"],["01.æå»º/01.Maven/05.Mavenæç¨ä¹åå¸jarå°ç§ææä¸­å¤®ä»åº.md","Maven æç¨ä¹åå¸ jar å°ç§ææä¸­å¤®ä»åº","/pages/2ddf04/"],["01.æå»º/01.Maven/06.Mavenæä»¶ä¹ä»£ç æ£æ¥.md","Maven æä»¶ä¹ä»£ç æ£æ¥","/pages/149013/"]]},["01.æå»º/02.Ant.md","Ant ç®ææç¨","/pages/e2af3a/"]]},{title:"IDE",collapsable:!1,children:[["02.IDE/01.Intellij.md","Intellij IDEA å¿«éå¥é¨","/pages/ea83ee/"],["02.IDE/02.Eclipse.md","Eclipse å¿«éå¥é¨","/pages/a897a9/"],["02.IDE/03.VsCode.md","Vscode å¿«éå¥é¨","/pages/a537c7/"]]},{title:"çæ§è¯æ­",collapsable:!1,children:[["03.çæ§è¯æ­/01.çæ§å·¥å·å¯¹æ¯.md","çæ§å·¥å·å¯¹æ¯","/pages/c7c5ec/"],["03.çæ§è¯æ­/02.CAT.md","CAT å¿«éå¥é¨","/pages/83e684/"],["03.çæ§è¯æ­/03.Zipkin.md","Zipkin å¿«éå¥é¨","/pages/82c168/"],["03.çæ§è¯æ­/04.Skywalking.md","SkyWalking å¿«éå¥é¨","/pages/d82d3c/"],["03.çæ§è¯æ­/05.Arthas.md","Arthas å¿«éå¥é¨","/pages/b6a542/"]]}],"/12.å·¥å·/":[{title:"IO",collapsable:!1,children:[["01.IO/01.JSONåºåå.md","Java å JSON åºåå","/pages/a14952/"],["01.IO/02.äºè¿å¶åºåå.md","Java äºè¿å¶åºåå","/pages/95f25b/"]]},{title:"JavaBean",collapsable:!1,children:[["02.JavaBean/01.Lombok.md","Lombok å¿«éå¥é¨","/pages/0d31cd/"],["02.JavaBean/02.Dozer.md","Dozer å¿«éå¥é¨","/pages/596174/"]]},{title:"æ¨¡æ¿å¼æ",collapsable:!1,children:[["03.æ¨¡æ¿å¼æ/01.Freemark.md","Freemark å¿«éå¥é¨","/pages/34ec25/"],["03.æ¨¡æ¿å¼æ/02.Thymeleaf.md","Thymeleaf å¿«éå¥é¨","/pages/2263fb/"],["03.æ¨¡æ¿å¼æ/03.Velocity.md","Velocity å¿«éå¥é¨","/pages/7ecb81/"]]},{title:"æµè¯",collapsable:!1,children:[["04.æµè¯/01.Junit.md","JUnit5 å¿«éå¥é¨","/pages/06533c/"],["04.æµè¯/02.Mockito.md","Mockito å¿«éå¥é¨","/pages/ab18ad/"],["04.æµè¯/03.Jmeter.md","JMeter å¿«éå¥é¨","/pages/d99171/"],["04.æµè¯/04.JMH.md","JMH å¿«éå¥é¨","/pages/747d3e/"]]},{title:"å¶ä»",collapsable:!1,children:[["99.å¶ä»/01.Javaæ¥å¿.md","javalib-log","/pages/337701/"],["99.å¶ä»/02.Javaå·¥å·å.md","javalib-util","/pages/14e432/"],["99.å¶ä»/03.Reflections.md","Reflections å¿«éå¥é¨","/pages/ea4914/"],["99.å¶ä»/04.JavaMail.md","JavaMail å¿«éå¥é¨","/pages/da3f07/"],["99.å¶ä»/05.Jsoup.md","Jsoup å¿«éå¥é¨","/pages/c516cc/"],["99.å¶ä»/06.Thumbnailator.md","Thumbnailator å¿«éå¥é¨","/pages/aa9f61/"],["99.å¶ä»/07.Zxing.md","ZXing å¿«éå¥é¨","/pages/cc8ce5/"]]}],"/13.æ¡æ¶/":[{title:"ORM",collapsable:!1,children:[["11.ORM/01.Mybatiså¿«éå¥é¨.md","Mybatiså¿«éå¥é¨","/pages/538358/"],["11.ORM/02.Mybatisåç.md","Mybatisåç","/pages/3f3dba/"]]},{title:"å®å¨",collapsable:!1,children:[["12.å®å¨/01.Shiro.md","Shiro å¿«éå¥é¨","/pages/cd25bf/"],["12.å®å¨/02.SpringSecurity.md","Spring Security å¿«éå¥é¨","/pages/a6cc5f/"]]},{title:"IO",collapsable:!1,children:[["13.IO/01.Netty.md","Netty å¿«éå¥é¨","/pages/520c52/"]]},{title:"å¾®æå¡",collapsable:!1,children:[["14.å¾®æå¡/01.Dubbo.md","Dubbo å¿«éå¥é¨","/pages/e79b77/"]]}],"/14.ä¸­é´ä»¶/":[{title:"MQ",collapsable:!1,children:[["01.MQ/01.æ¶æ¯éåé¢è¯.md","æ¶æ¯éåé¢è¯","/pages/5a6cf3/"],["01.MQ/02.æ¶æ¯éååºæ¬åç.md","æ¶æ¯éååºæ¬åç","/pages/055069/"],["01.MQ/03.RocketMQ.md","RocketMQ å¿«éå¥é¨","/pages/f56a96/"],["01.MQ/04.ActiveMQ.md","ActiveMQ å¿«éå¥é¨","/pages/3f7c49/"]]},{title:"ç¼å­",collapsable:!1,children:[["02.ç¼å­/01.ç¼å­é¢è¯é¢.md","ç¼å­å¤ºå½è¿ç¯é®","/pages/eb30d6/"],["02.ç¼å­/02.Javaç¼å­ä¸­é´ä»¶.md","Java ç¼å­ä¸­é´ä»¶","/pages/970fa6/"],["02.ç¼å­/03.Memcached.md","Memcached å¿«éå¥é¨","/pages/25a710/"],["02.ç¼å­/04.Ehcache.md","Ehcache å¿«éå¥é¨","/pages/c4647d/"],["02.ç¼å­/05.Javaè¿ç¨åç¼å­.md","Java è¿ç¨åç¼å­","/pages/9632fd/"],["02.ç¼å­/06.Httpç¼å­.md","http-cache","/pages/c09100/"]]},{title:"æµéæ§å¶",collapsable:!1,children:[["03.æµéæ§å¶/01.Hystrix.md","Hystrix å¿«éå¥é¨","/pages/f2ebed/"]]}]},updateBar:{showToArticle:!0},category:!0,tag:!0,archive:!0,author:{name:"dunwu",href:"https://github.com/dunwu"},social:{icons:[{iconClass:"icon-youjian",title:"åé®ä»¶",link:"mailto:forbreak@163.com"},{iconClass:"icon-github",title:"GitHub",link:"https://github.com/dunwu"}]},footer:{createYear:2019,copyrightInfo:"éæï¼dunwuï¼ | CC-BY-SA-4.0"},htmlModules:{pageB:'\n  <div class="wwads-cn wwads-horizontal pageB" data-id="136" style="width:100%;max-height:80px;min-height:auto;"></div>\n  <style>\n    .pageB img{width:80px!important;}\n    .wwads-horizontal .wwads-text, .wwads-content .wwads-text{line-height:1;}\n  </style>\n  ',windowRB:'\n    <div class="wwads-cn wwads-vertical windowRB" data-id="136" style="max-width:160px;\n    min-width: auto;min-height:auto;"></div>\n    <style>\n      .windowRB{ padding: 0;}\n      .windowRB .wwads-img{margin-top: 10px;}\n      .windowRB .wwads-content{margin: 0 10px 10px 10px;}\n      .custom-html-window-rb .close-but{\n        display: none;\n      }\n    </style>\n  '}}};function fl(n){const e=document.createElement("link");e.href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css",e.rel="stylesheet",document.body.appendChild(e);const t=document.createElement("script");function a(n){let e=document.getElementById("gitalk-container");e||(e=document.createElement("div"),e.id="gitalk-container",e.classList.add("content"));const t=document.querySelector(".page");t&&(t.appendChild(e),"undefined"!=typeof Gitalk&&Gitalk instanceof Function&&function(n){console.info(n);new Gitalk({clientID:"1ba9606d18aec7c070d4",clientSecret:"57c7e5e3611840efe117ccbad4d87fb60cb364cc",repo:"java-tutorial",owner:"dunwu",admin:["dunwu"],id:"comment",distractionFreeMode:!1,language:"zh-CN"}).render("gitalk-container")}(n.fullPath))}t.src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js",document.body.appendChild(t),n.afterEach(n=>{t.onload?a(n):t.onload=()=>{a(n)}})}var yl=t(92),xl=t(93),kl=t(11);var jl={computed:{$filterPosts(){return this.$site.pages.filter(n=>{const{frontmatter:{pageComponent:e,article:t,home:a}}=n;return!(e||!1===t||!0===a)})},$sortPosts(){return(n=this.$filterPosts).sort((n,e)=>{const t=n.frontmatter.sticky,a=e.frontmatter.sticky;return t&&a?t==a?Object(kl.a)(n,e):t-a:t&&!a?-1:!t&&a?1:Object(kl.a)(n,e)}),n;var n},$sortPostsByDate(){return(n=this.$filterPosts).sort((n,e)=>Object(kl.a)(n,e)),n;var n},$groupPosts(){return function(n){const e={},t={};for(let a=0,r=n.length;a<r;a++){const{frontmatter:{categories:r,tags:i}}=n[a];"array"===Object(kl.n)(r)&&r.forEach(t=>{t&&(e[t]||(e[t]=[]),e[t].push(n[a]))}),"array"===Object(kl.n)(i)&&i.forEach(e=>{e&&(t[e]||(t[e]=[]),t[e].push(n[a]))})}return{categories:e,tags:t}}(this.$sortPosts)},$categoriesAndTags(){return function(n){const e=[],t=[];for(let t in n.categories)e.push({key:t,length:n.categories[t].length});for(let e in n.tags)t.push({key:e,length:n.tags[e].length});return{categories:e,tags:t}}(this.$groupPosts)}}};Nt.component(yl.default),Nt.component(xl.default);function Sl(n){return n.toString().padStart(2,"0")}t(235);Nt.component("Badge",()=>Promise.all([t.e(0),t.e(3)]).then(t.bind(null,403))),Nt.component("CodeBlock",()=>Promise.resolve().then(t.bind(null,92))),Nt.component("CodeGroup",()=>Promise.resolve().then(t.bind(null,93)));t(236);var wl=[({Vue:n,options:e,router:t,siteData:a,isServer:r})=>{r||t.afterEach(()=>{var n;n=function(){},"complete"===document.readyState||"interactive"===document.readyState?setTimeout(n,1):document.addEventListener("DOMContentLoaded",n),setTimeout(()=>{const n=document.querySelector(".pageB");if(!n)return;const e=n.querySelector(".wwads-hide");e&&(e.onclick=()=>{n.style.display="none"}),n.style.display="flex",fl(t)},0)});try{document&&fl(t)}catch(n){console.error(n.message)}},({Vue:n,options:e,router:t,siteData:a})=>{a.pages.map(n=>{const{frontmatter:{date:e,author:t}}=n;"string"==typeof e&&"Z"===e.charAt(e.length-1)&&(n.frontmatter.date=function(n){n instanceof Date||(n=new Date(n));return`${n.getUTCFullYear()}-${Sl(n.getUTCMonth()+1)}-${Sl(n.getUTCDate())} ${Sl(n.getUTCHours())}:${Sl(n.getUTCMinutes())}:${Sl(n.getUTCSeconds())}`}(e)),t?n.author=t:a.themeConfig.author&&(n.author=a.themeConfig.author)}),n.mixin(jl)},{},({Vue:n})=>{n.mixin({computed:{$dataBlock(){return this.$options.__data__block__}}})},{},{},()=>{"undefined"!=typeof window&&function(n,e,t){function a(n){var t=e.createElement("div");t.className="heart",r.push({el:t,x:n.clientX-5,y:n.clientY-5,scale:1,alpha:1,color:"#11a8cd"}),e.body.appendChild(t)}var r=[];n.requestAnimationFrame=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(n){setTimeout(n,1e3/60)},function(n){var t=e.createElement("style");t.type="text/css";try{t.appendChild(e.createTextNode(n))}catch(e){t.styleSheet.cssText=n}e.getElementsByTagName("head")[0].appendChild(t)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),function(){var e="function"==typeof n.onclick&&n.onclick;n.onclick=function(n){let t=!0;n.path&&n.path.forEach(n=>{1===n.nodeType&&"string"==typeof n.className&&n.className.indexOf("theme-vdoing-content")>-1&&(t=!1)}),t&&(e&&e(),a(n))}}(),function n(){for(var t=0;t<r.length;t++)r[t].alpha<=0?(e.body.removeChild(r[t].el),r.splice(t,1)):(r[t].y--,r[t].scale+=.004,r[t].alpha-=.013,r[t].el.style.cssText="left:"+r[t].x+"px;top:"+r[t].y+"px;opacity:"+r[t].alpha+";transform:scale("+r[t].scale+","+r[t].scale+") rotate(45deg);background:"+r[t].color+";z-index:99999");requestAnimationFrame(n)}()}(window,document)}],Tl=[];class Il extends class{constructor(){this.store=new Nt({data:{state:{}}})}$get(n){return this.store.state[n]}$set(n,e){Nt.set(this.store.state,n,e)}$emit(...n){this.store.$emit(...n)}$on(...n){this.store.$on(...n)}}{}Object.assign(Il.prototype,{getPageAsyncComponent:as,getLayoutAsyncComponent:rs,getAsyncComponent:is,getVueComponent:os});var Cl={install(n){const e=new Il;n.$vuepress=e,n.prototype.$vuepress=e}};function Ml(n,e){const t=e.toLowerCase();return n.options.routes.some(n=>n.path.toLowerCase()===t)}var El={props:{pageKey:String,slotKey:{type:String,default:"default"}},render(n){const e=this.pageKey||this.$parent.$page.key;return ls("pageKey",e),Nt.component(e)||Nt.component(e,as(e)),Nt.component(e)?n(e):n("")}},Pl={functional:!0,props:{slotKey:String,required:!0},render:(n,{props:e,slots:t})=>n("div",{class:["content__"+e.slotKey]},t()[e.slotKey])},zl={computed:{openInNewWindowTitle(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},Al=(t(237),t(238),Object(hl.a)(zl,(function(){var n=this._self._c;return n("span",[n("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[n("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),n("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),n("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports),ql={functional:!0,render(n,{parent:e,children:t}){if(e._isMounted)return t;e.$once("hook:mounted",()=>{e.$forceUpdate()})}};Nt.config.productionTip=!1,Nt.use(Fo),Nt.use(Cl),Nt.mixin(function(n,e,t=Nt){!function(n){n.locales&&Object.keys(n.locales).forEach(e=>{n.locales[e].path=e});Object.freeze(n)}(e),t.$vuepress.$set("siteData",e);const a=new(n(t.$vuepress.$get("siteData"))),r=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(a)),i={};return Object.keys(r).reduce((n,e)=>(e.startsWith("$")&&(n[e]=r[e].get),n),i),{computed:i}}(n=>class{setPage(n){this.__page=n}get $site(){return n}get $themeConfig(){return this.$site.themeConfig}get $frontmatter(){return this.$page.frontmatter}get $localeConfig(){const{locales:n={}}=this.$site;let e,t;for(const a in n)"/"===a?t=n[a]:0===this.$page.path.indexOf(a)&&(e=n[a]);return e||t||{}}get $siteTitle(){return this.$localeConfig.title||this.$site.title||""}get $canonicalUrl(){const{canonicalUrl:n}=this.$page.frontmatter;return"string"==typeof n&&n}get $title(){const n=this.$page,{metaTitle:e}=this.$page.frontmatter;if("string"==typeof e)return e;const t=this.$siteTitle,a=n.frontmatter.home?null:n.frontmatter.title||n.title;return t?a?a+" | "+t:t:a||"VuePress"}get $description(){const n=function(n){if(n){const e=n.filter(n=>"description"===n.name)[0];if(e)return e.content}}(this.$page.frontmatter.meta);return n||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}get $lang(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}get $localePath(){return this.$localeConfig.path||"/"}get $themeLocaleConfig(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}get $page(){return this.__page?this.__page:function(n,e){for(let t=0;t<n.length;t++){const a=n[t];if(a.path.toLowerCase()===e.toLowerCase())return a}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}},bl)),Nt.component("Content",El),Nt.component("ContentSlotsDistributor",Pl),Nt.component("OutboundLink",Al),Nt.component("ClientOnly",ql),Nt.component("Layout",rs("Layout")),Nt.component("NotFound",rs("NotFound")),Nt.prototype.$withBase=function(n){const e=this.$site.base;return"/"===n.charAt(0)?e+n.slice(1):n},window.__VUEPRESS__={version:"1.9.2",hash:"68388af"},async function(n){const e="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:bl.routerBase||bl.base,t=new Fo({base:e,mode:"history",fallback:!1,routes:vl,scrollBehavior:(n,e,t)=>t||(n.hash?!Nt.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(n.hash)}:{x:0,y:0})});!function(n){n.beforeEach((e,t,a)=>{if(Ml(n,e.path))a();else if(/(\/|\.html)$/.test(e.path))if(/\/$/.test(e.path)){const t=e.path.replace(/\/$/,"")+".html";Ml(n,t)?a(t):a()}else a();else{const t=e.path+"/",r=e.path+".html";Ml(n,r)?a(r):Ml(n,t)?a(t):a()}})}(t);const a={};try{await Promise.all(wl.filter(n=>"function"==typeof n).map(e=>e({Vue:Nt,options:a,router:t,siteData:bl,isServer:n})))}catch(n){console.error(n)}return{app:new Nt(Object.assign(a,{router:t,render:n=>n("div",{attrs:{id:"app"}},[n("RouterView",{ref:"layout"}),n("div",{class:"global-ui"},Tl.map(e=>n(e)))])})),router:t}}(!1).then(({app:n,router:e})=>{e.onReady(()=>{n.$mount("#app")})})}]);